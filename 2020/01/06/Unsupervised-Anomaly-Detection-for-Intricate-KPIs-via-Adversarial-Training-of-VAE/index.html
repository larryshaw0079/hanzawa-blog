<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2D5BA6">
  <meta name="description" content="">
  <meta name="author" content="Hanzawa">
  <meta name="keywords" content="">
  <title>Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE - Hanzawa ã® éƒ¨å±‹</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/tomorrow.min.css" />


<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">




<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


<meta name="generator" content="Hexo 4.2.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Hanzawa</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/bg/Yosemite-Color-Block.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
                Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE
              
            </span>

            
              
                <div class="mt-3 post-meta">
                  <i class="iconfont icon-date-fill" aria-hidden="true"></i>
                  <time datetime="2020-01-06 13:09">
                    2020å¹´1æœˆ6æ—¥ ä¸‹åˆ
                  </time>
                </div>
              

              <div class="mt-1">
                
                  
                  <span class="post-meta mr-2">
                    <i class="iconfont icon-chart"></i>
                    2.6k å­—
                  </span>
                

                
                  
                  <span class="post-meta mr-2">
                      <i class="iconfont icon-clock-fill"></i>
                    
                    
                    38
                     åˆ†é’Ÿ
                  </span>
                

                
              </div>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p><a href="https://ieeexplore.ieee.org/abstract/document/8737430/" target="_blank" rel="noopener">è®ºæ–‡ğŸ“ƒ</a></p>
<p><a href="https://github.com/yantijin/Buzz" target="_blank" rel="noopener">ä»£ç ğŸ“¥</a></p>
<p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§åˆ©ç”¨å¯¹æŠ—è®­ç»ƒæ¥è¿›è¡Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„æ–¹æ³•<em>Buzz</em>ã€‚ä½œè€…è®¤ä¸ºåœ¨ç°å®ä¸­å¤æ‚çš„KPIæ•°æ®å¤§é‡å­˜åœ¨ï¼Œè¿™ç§æ•°æ®é€šå¸¸å¸¦æœ‰éé«˜æ–¯åˆ†å¸ƒçš„å™ªå£°ï¼ŒåŒæ—¶æ•°æ®åˆ†å¸ƒå¤æ‚ï¼Œå¯¼è‡´ä¸€èˆ¬çš„ç”Ÿæˆå¼æ¨¡å‹æ— æ³•å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„å»ºæ¨¡ï¼Œæ‰€ä»¥ä½œè€…æå‡ºäº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„æ¨¡å‹ã€‚åœ¨æ–‡ä¸­ï¼Œä½œè€…çš„åˆ›æ–°ç‚¹ä¸»è¦æœ‰ä¸‰ä¸ªï¼š</p>
<ol>
<li>ä¸ºäº†å¤„ç†å¤æ‚æ•°æ®ï¼Œå°†æ•°æ®ç©ºé—´åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼Œåœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šè¿›è¡Œè·ç¦»çš„åº¦é‡ï¼›</li>
<li>é‡‡ç”¨<em>Wasserstein</em>è·ç¦»åº¦é‡æ¨¡å‹å»ºæ¨¡çš„åˆ†å¸ƒå’ŒçœŸå®åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼›</li>
<li>å»ºç«‹äº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„<em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒVAEä¹‹é—´çš„å…³ç³»ã€‚</li>
</ol>
<img src="https://i.loli.net/2020/06/25/FwHi7y56njz8R4m.png" srcset="/img/loading.gif" style="zoom:67%;" />

<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><h2 id="Anomaly-Detection"><a href="#Anomaly-Detection" class="headerlink" title="Anomaly Detection"></a>Anomaly Detection</h2><p>å¯¹äºä»»æ„æ—¶é—´$t$ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼$x_{t-T+1},\cdots,x_t$ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º$y_t=1$)ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚$p(y_t=1|x_{t-T+1},\cdots,x_t)$ã€‚</p>
<h2 id="VAE"><a href="#VAE" class="headerlink" title="VAE"></a>VAE</h2><table>
<thead>
<tr>
<th><strong>Model</strong></th>
<th><strong>Latent</strong></th>
<th><strong>Data</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong><em>Auto-encoder (AE)</em></strong></td>
<td><code>None</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr>
<td><strong><em>Variational Auto-encoder (VAE)</em></strong></td>
<td><code>KL Divergence</code></td>
<td><code>Log Likelihood</code></td>
</tr>
<tr>
<td><strong><em>Adversarial Auto-encoder (AAE)</em></strong></td>
<td><code>Discriminator</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr>
<td><strong><em>Wasserstein Auto-encoder (WAE)</em></strong></td>
<td><code>MaxMeanDiscrepancy</code> or <code>Discriminator</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr>
<td><strong><em>AlphaGAN</em></strong></td>
<td><code>Discriminator</code></td>
<td><code>Discriminator</code>+<code>L1Loss</code></td>
</tr>
</tbody></table>
<h2 id="GAN-and-WGAN-GP"><a href="#GAN-and-WGAN-GP" class="headerlink" title="GAN and WGAN-GP"></a>GAN and WGAN-GP</h2><p>åŸå§‹GANç­‰ä»·äºä¼˜åŒ–ï¼š<br>$$<br>\mathbb{E}<em>{x\sim P_r}\log{\frac{P_r(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}+\mathbb{E}</em>{x\sim P_g}\log{\frac{P_g(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}<br>$$<br>æ ¹æ®KLæ•£åº¦å’ŒJSæ•£åº¦çš„å®šä¹‰ï¼š<br>$$<br>\text{KL}(P_1\parallel P_2)=\mathbb{E}_{x\sim P_1}\log{\frac{P_1}{P_2}}<br>$$</p>
<p>$$<br>\text{JS}(P_1\parallel P_2)=\frac{1}{2}\text{KL}(P_1\parallel \frac{P_1+P_2}{2})+\frac{1}{2}\text{KL}(P_2\parallel \frac{P_1+P_2}{2})<br>$$</p>
<p>å¯é‡å†™ä¸ºï¼š<br>$$<br>2\text{JS}(P_r\parallel P_g)-2\log 2<br>$$<br>å½“$P_r$ä¸$P_g$çš„æ”¯æ’‘é›†ï¼ˆsupportï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­çš„ä½ç»´æµå½¢ï¼ˆmanifoldï¼‰æ—¶ï¼Œ$P_r$ä¸$P_g$é‡å éƒ¨åˆ†æµ‹åº¦ï¼ˆmeasureï¼‰ä¸º0çš„æ¦‚ç‡ä¸º1ã€‚</p>
<ul>
<li>æ”¯æ’‘é›†ï¼ˆsupportï¼‰å…¶å®å°±æ˜¯å‡½æ•°çš„éé›¶éƒ¨åˆ†å­é›†ï¼Œæ¯”å¦‚<code>ReLU</code>å‡½æ•°çš„æ”¯æ’‘é›†å°±æ˜¯[å…¬å¼]ï¼Œä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„æ”¯æ’‘é›†å°±æ˜¯æ‰€æœ‰æ¦‚ç‡å¯†åº¦éé›¶éƒ¨åˆ†çš„é›†åˆã€‚</li>
<li>æµå½¢ï¼ˆmanifoldï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­æ›²çº¿ã€æ›²é¢æ¦‚å¿µçš„æ‹“å¹¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä½ç»´ä¸Šç›´è§‚ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œæ¯”å¦‚æˆ‘ä»¬è¯´ä¸‰ç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªæ›²é¢æ˜¯ä¸€ä¸ªäºŒç»´æµå½¢ï¼Œå› ä¸ºå®ƒçš„æœ¬è´¨ç»´åº¦ï¼ˆintrinsic dimensionï¼‰åªæœ‰2ï¼Œä¸€ä¸ªç‚¹åœ¨è¿™ä¸ªäºŒç»´æµå½¢ä¸Šç§»åŠ¨åªæœ‰ä¸¤ä¸ªæ–¹å‘çš„è‡ªç”±åº¦ã€‚åŒç†ï¼Œä¸‰ç»´ç©ºé—´æˆ–è€…äºŒç»´ç©ºé—´ä¸­çš„ä¸€æ¡æ›²çº¿éƒ½æ˜¯ä¸€ä¸ªä¸€ç»´æµå½¢ã€‚</li>
<li>æµ‹åº¦ï¼ˆmeasureï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­é•¿åº¦ã€é¢ç§¯ã€ä½“ç§¯æ¦‚å¿µçš„æ‹“å¹¿ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œè¶…ä½“ç§¯â€ã€‚</li>
</ul>
<p><em>Wasserstein</em>è·ç¦»å®šä¹‰å¦‚ä¸‹ï¼š<br>$$<br>W(P_r,P_g)=\inf\limits_{\gamma\sim\prod(P_r,P_g)}\mathbb{E}<em>{(x,y)\sim \gamma}\left[\parallel x-y\parallel\right]<br>$$<br>ä¸‹ç¡®ç•Œ$\inf$æ²¡æ³•ç›´æ¥æ±‚è§£ï¼Œä¸è¿‡æ ¹æ®ç›¸å…³å®šç†å…¶ç­‰ä»·äºï¼š<br>$$<br>W(P_r,P_g)=\frac{1}{K}\sup\limits</em>{\parallel f\parallel_L\leq K}\mathbb{E}<em>{x\sim P_r}[f(x)]-\mathbb{E}</em>{x\sim P_g}[f(x)]<br>$$<br><em>Lipschitz</em>è¿ç»­æ˜¯æŒ‡å­˜åœ¨ä¸€ä¸ªå¸¸æ•°$K\geq 0$ä½¿å¾—å®šä¹‰åŸŸå†…ä»»æ„ä¸¤ä¸ªå…ƒç´ $x_1$å’Œ$x_2$éƒ½æ»¡è¶³ï¼š<br>$$<br>|f(x_1)-f(x_2)|\leq K|x_1-x_2|<br>$$<br>WANçš„æŸå¤±å‡½æ•°ï¼š<br>$$<br>\mathcal{L}=\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}<em>g}\left[D({\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits</em>{\mathbf{x}\sim\mathbb{P}<em>r}\left[D(\mathbf{x})\right]<br>$$<br>WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>\mathcal{L}=\mathop{\mathbb{E}}\limits</em>{\tilde{\mathbf{x}}\sim\mathbb{P}<em>g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits</em>{\mathbf{x}\sim\mathbb{P}<em>r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits</em>{\hat{\mathbf{x}}\sim\mathbb{P}<em>{\hat{\mathbf{x}}}}\left[(\parallel\nabla</em>{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]<br>$$</p>
<h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1><p>ä¸‹å›¾ä¸º<em>Buzz</em>çš„æ€»ä½“æµç¨‹ï¼š</p>
<img src="https://i.loli.net/2020/06/25/aGPdzq8TVS6fetJ.png" srcset="/img/loading.gif" style="zoom:67%;" />

<p>æ•°æ®ä¼šé¦–å…ˆè¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼Œä¹‹åè¿›è¡Œè®­ç»ƒã€‚åœ¨æ£€æµ‹é˜¶æ®µä¼šæ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥åˆ¤å®šå¼‚å¸¸ã€‚</p>
<h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2><p>åœ¨æ–‡ä¸­ï¼Œæœ€å…³é”®çš„ä¸¤ä¸ªåˆ›æ–°ç‚¹åˆ†åˆ«æ˜¯<em>Wasserstein</em>è·ç¦»å’Œå¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œåˆ†åŒºçš„æ–¹æ³•ã€‚</p>
<ul>
<li><p>åœ¨ä½¿ç”¨è·ç¦»åº¦é‡æ–¹é¢ï¼Œ å› ä¸º<em>Wasserstein</em>åœ¨WGANä¸­å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœï¼Œæ˜¯ä¸€ç§é²æ£’çš„è·ç¦»åº¦é‡ï¼Œæ‰€ä»¥ä½œè€…åœ¨æ–‡ä¸­é‡‡ç”¨äº†<em>Wasserstein</em>è·ç¦»æ¥è¡¡é‡ç”Ÿæˆçš„åˆ†å¸ƒå’ŒçœŸå®çš„åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå¹¶ç”±æ­¤å¼•å…¥äº†å¯¹æŠ—è®­ç»ƒï¼›</p>
</li>
<li><p>åœ¨åˆ†åŒºæ–¹æ³•æ–¹é¢ï¼Œä½œè€…è®¤ä¸ºåŸå§‹æ•°æ®è¿‡äºå¤æ‚ï¼Œæ‰€ä»¥å°†æ•°æ®ç©ºé—´$\mathcal{X}$è¿›è¡Œåˆ’åˆ†ï¼Œç„¶ååœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šä½¿ç”¨<em>Wasserstein</em>åº¦é‡è·ç¦»ï¼Œè€Œæ€»ä½“çš„è·ç¦»ç”±æ¯ä¸ªåˆ†åŒºçš„è·ç¦»çš„æœŸæœ›æ±‚å¾—ã€‚</p>
</li>
</ul>
<p>ä½œè€…è¿˜å‘ç°ï¼Œå½“åˆ’åˆ†åœ°è¶Šæ¥è¶Šç»†æ—¶ï¼Œæ€»ä½“è·ç¦»æ¥è¿‘äºç‰¹å®šå½¢å¼çš„VAEçš„é‡æ„è¯¯å·®é¡¹ã€‚</p>
<img src="https://i.loli.net/2020/06/25/knzq4yPaBrXWgeI.png" srcset="/img/loading.gif" style="zoom:67%;" />

<h2 id="Network-Structure"><a href="#Network-Structure" class="headerlink" title="Network Structure"></a>Network Structure</h2><p>ä¸‹å›¾ä¸ºæ¨¡å‹çš„ç½‘ç»œç»“æ„ï¼š</p>
<img src="https://i.loli.net/2020/06/25/Qrgpuh4Iw7YTlny.png" srcset="/img/loading.gif" style="zoom:67%;" />



<h2 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h2><h3 id="Objective-Function"><a href="#Objective-Function" class="headerlink" title="Objective Function"></a>Objective Function</h3><p>å…ˆå®šä¹‰ä¸€äº›ç¬¦å·ï¼š</p>
<ul>
<li>$b$å’Œ$s$åˆ†åˆ«ä¸ºBatchçš„å¤§å°å’Œé‚»å±…çš„å¤§å°ï¼Œæ•°æ®é›†æŒ‰$s$è¿›è¡Œåˆ‡åˆ†ï¼Œç„¶åéšæœºæ‰“ä¹±ï¼Œæ¯ä¸ªBatchåŒ…å«$b$ä¸ª$s$ï¼Œä¹‹å$s/=2,b*=2$ï¼›</li>
<li>$\mathcal{W}={w_1,w_2,\cdots,w_b}$ä¸ºä¸€ä¸ªBatchï¼Œä¸”æ»¡è¶³æ¯ä¸ª$w_i$æ˜¯$s$çš„å€æ•°ï¼›</li>
<li>$w\in\mathcal{W}$çš„é‚»åŸŸé›†(neighborhood set)ä¸ºä¸€ä¸ªæ—¶é—´ä¸Šçš„partitionï¼Œè®°ä¸º${w,w+1,\cdots,w+s-1}$</li>
<li>$\mathbf{x}^{(w)},\mathbf{x}^{(w+1)},\cdots,\mathbf{x}^{(w+s-1)}$ä¸ºåœ¨ç©ºé—´$\mathcal{X}$ä¸Šçš„ä¸€ä¸ªpartitionï¼Œè®°ä¸º$S_w$ï¼Œå…¶ä¸­$\mathbf{x}^{(w)}$è¡¨ç¤ºä»¥$w$ä¸ºç»“å°¾çš„æ—¶é—´çª—å£ã€‚</li>
</ul>
<p><em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒWGAN-GPç±»ä¼¼ï¼Œä½†åšäº†ä¸€äº›æ”¹è¿›ï¼Œç”±ä¸‹é¢å››éƒ¨åˆ†ç»„æˆï¼Œä¸‹é¢åˆ†åˆ«è§£é‡Šã€‚</p>
<p>ç¬¬ä¸€ä¸ªæ˜¯æ¯ä¸€ä¸ªpartitionçš„$\mathbf{z}$åéªŒçš„KLæ•£åº¦ï¼š<br>$$<br>\mathcal{K} = \frac{1}{bs}\sum\limits_{w\in\mathcal{W}}\sum\limits_{i=1}^{s-1}\text{KL}\left[q_\phi(\mathbf{z}|\mathbf{x})\parallel\mathcal{N}(\mathbf{0},\mathbf{1})\right]<br>$$</p>
<p>ç¬¬äºŒä¸ªåœ¨è®­ç»ƒæ—¶æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼š<br>$$<br>Z(\lambda) = \frac{\Gamma(W)}{\Gamma(\frac{W}{2})}2\pi^{\frac{W}{2}}\lambda^{-W}<br>$$</p>
<p>å…¶ä¸­$\Gamma$æ˜¯<em>Gamma</em>å‡½æ•°ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªæ˜¯<em>Wasserstein</em>è·ç¦»ï¼š<br>$$<br>\mathcal{T}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}_{q_\phi(\mathbf{z}|\mathbf{x}^{w+i})}\left[F(\mathbf{x}^{(w+i)})-F(G(\mathbf{z}))\right]<br>$$</p>
<p>ç¬¬å››ä¸ªæ˜¯<em>Gradient Penalty</em>ï¼š</p>
<p>$$<br>\mathcal{R}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}<em>{q_\phi(\mathbf{z}|\mathbf{x}^{(w+i)})}\left[\mathbb{E}</em>{\varepsilon\sim[0,1]}(\parallel\nabla_{\hat{\mathbf{x}}}(\hat{\mathbf{x}})\parallel-\mathbf{1})^2\right]<br>$$</p>
<p>å…¶ä¸­$\hat{\mathbf{x}}=\varepsilon \mathbf{x}^{w+i}+(1-\varepsilon)G(\mathbf{z})$ä¸ºç”Ÿæˆæ•°æ®ä¸çœŸå®æ•°æ®çš„æ’å€¼ã€‚</p>
<blockquote>
<p>åŸå§‹çš„WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>L=\mathop{\mathbb{E}}\limits_{\tilde{\mathbf{x}}\sim\mathbb{P}<em>g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits</em>{\mathbf{x}\sim\mathbb{P}<em>r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits</em>{\hat{\mathbf{x}}\sim\mathbb{P}<em>{\hat{\mathbf{x}}}}\left[(\parallel\nabla</em>{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]<br>$$<br>å…¶ä¸­$\mathbb{P}<em>g$ä¸ºç”Ÿæˆå™¨çš„åˆ†å¸ƒï¼Œ$\mathbb{P}_r$ä¸ºçœŸå®åˆ†å¸ƒï¼Œ$\mathbb{P}</em>{\hat{\mathbf{x}}}$ä¸ºçœŸå®æ•°æ®å’Œç”Ÿæˆæ•°æ®æ’å€¼å¾—åˆ°çš„åˆ†å¸ƒã€‚</p>
</blockquote>
<p>$$<br>\hat{\mathcal{L}}<em>{Buzz}=-\lambda\sup\limits_F\left[\sum\limits</em>{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)<br>$$</p>
<h3 id="Training-Procedure"><a href="#Training-Procedure" class="headerlink" title="Training Procedure"></a>Training Procedure</h3><p><em>Buzz</em>çš„è®­ç»ƒè¿‡ç¨‹ä¸WGAN-GPç±»ä¼¼ï¼Œ</p>
<h2 id="Detection"><a href="#Detection" class="headerlink" title="Detection"></a>Detection</h2><p>æ–‡ä¸­å‡è®¾è§£ç å™¨çš„è¾“å‡ºæœä»å¦‚ä¸‹åˆ†å¸ƒï¼š</p>
<p>$$<br>p_\theta(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel}<br>$$</p>
<p>ä½œè€…å®šä¹‰å¼‚å¸¸åˆ†æ•°ä¸ºï¼š<br>$$<br>\mathcal{S}=\log p_\theta(\mathbf{x})-\log p_\theta(\bar{\mathbf{x}})<br>$$<br>å…¶ä¸­$\bar{\mathbf{x}}$ä¸ºç»è¿‡MCMCå¡«å……åçš„æ ·æœ¬ã€‚</p>
<p>å¼‚å¸¸åˆ†æ•°ä¹Ÿå¯ä»¥å±•å¼€ä¸ºï¼š<br>$$<br>\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\mathbf{x}|\mathbf{z^{(l)}})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]-\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\bar{\mathbf{x}}|\mathbf{z}^{(l)})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]<br>$$</p>
<p>æœ€ç»ˆç®—æ³•æµç¨‹å›¾ä¸ºï¼š</p>
<img src="https://i.loli.net/2020/06/25/Y3NLjRiaWO5eHGT.png" srcset="/img/loading.gif" style="zoom:80%;" />



<h2 id="Theoretical-Analysis"><a href="#Theoretical-Analysis" class="headerlink" title="Theoretical Analysis"></a>Theoretical Analysis</h2><p>åœ¨ç†è®ºåˆ†æä¸­ï¼Œä½œè€…ä¸»è¦æ˜¯æƒ³å»ºç«‹$\mathcal{L}<em>{Buzz}$å’ŒVAEçš„æŸå¤±å‡½æ•°$\mathcal{L}</em>{vae}$ä¹‹é—´çš„è”ç³»ï¼ŒæŸå¤±å‡½æ•°$\mathcal{\hat{L}}_{Buzz}$ä¸ºï¼š</p>
<p>$$<br>\hat{\mathcal{L}}<em>{Buzz}=-\lambda\sup\limits_F\left[\sum\limits</em>{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)<br>$$</p>
<p>ä¸ºäº†ä¾¿äºåˆ†æï¼Œå»æ‰<em>Gradient Penalty</em>çš„éƒ¨åˆ†ï¼Œå…¬å¼å¯ç®€åŒ–ä¸ºï¼š</p>
<p>$$<br>\mathcal{L}<em>{Buzz}=-\lambda\mathbb{E}</em>{p(w)}W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]-\mathcal{K}-\log Z(\lambda)<br>$$</p>
<p>å®é™…ä¸Š$Z(\lambda)=\mathfrak{S}_W\Gamma(W)\lambda^{-W}$ï¼Œå…¶ä¸­$\mathfrak{S}_W$ä¸º$W$ç»´å•ä½çƒçš„è¡¨é¢ç§¯ã€‚</p>
<blockquote>
<p>$n$ç»´ç©ºé—´å•ä½çƒè¡¨é¢ç§¯å…¬å¼ï¼š<br>$$<br>\omega_n=\frac{2\pi^{\frac{n}{2}}}{\Gamma(\frac{n}{2})}<br>$$</p>
</blockquote>
<p>è€Œ$W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]$ä¸º<em>Wasserstein</em>è·ç¦»ï¼š<br>$$<br>W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]=\sup\limits_{Lip(f)\leq 1}\left{\int_\mathcal{X}f(\mathbf{x})p(\mathbf{x}|w)\mathrm{d}\mathbf{x}-\int_\mathcal{X}f(\mathbf{y})p(\mathbf{y}|w)\mathrm{d}\mathbf{y}\right}<br>$$</p>
<h3 id="Lemma-1"><a href="#Lemma-1" class="headerlink" title="Lemma 1"></a>Lemma 1</h3><p>é€šè¿‡è®¾å®šå…·ä½“å½¢å¼çš„åéªŒåˆ†å¸ƒï¼ŒVAEçš„æŸå¤±å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p>
<blockquote>
<p>è®¾$\mathbf{x}$çš„åéªŒåˆ†å¸ƒ$p(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel}$ï¼Œé‚£ä¹ˆVAEçš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>\mathcal{L}<em>{vae}=\lambda\mathbb{E}</em>{p(w)}\left[\mathbb{E}<em>{p(\mathbf{x}|w)}\mathbb{E}</em>{p_G(\mathbf{y}|\mathbf{x})}-\parallel\mathbf{x}-\mathbf{y}\parallel\right]-\mathcal{K}-\log{Z(\lambda)}<br>$$</p>
</blockquote>
<p>åéªŒåˆ†å¸ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªLaplaceåˆ†å¸ƒï¼š</p>
<blockquote>
<p><strong>Laplace Distribution</strong>:<br>$$<br>f(x|\theta,\lambda)=\frac{1}{2\lambda}\exp{\left(-\frac{|x-\theta|}{\lambda}\right)}<br>$$</p>
</blockquote>
<p>å¯ä»¥ç›´æ¥æŠŠåéªŒåˆ†å¸ƒå¸¦å…¥VAEçš„æŸå¤±å‡½æ•°å°±å¾—åˆ°äº†ã€‚</p>
<h3 id="Lemma-2"><a href="#Lemma-2" class="headerlink" title="Lemma 2"></a>Lemma 2</h3><p>$S_w$å®šä¹‰ä¸ºæ•°æ®ç©ºé—´$\mathcal{X}$çš„ä¸€ä¸ªpartitionï¼Œè€Œ$S={(\mathbf{x}_1,\mathbf{x}_2)| \exists w, \mathbf{x}_1\in S_w,\mathbf{x}_2\in S_w}$ã€‚</p>
<blockquote>
<p>å½“$G,\phi,\lambda$å›ºå®šæ—¶ï¼Œ$S\downarrow$æœ‰$\mathcal{L}_{Buzz}\downarrow$</p>
</blockquote>
<h3 id="Lemma-3"><a href="#Lemma-3" class="headerlink" title="Lemma 3"></a>Lemma 3</h3><blockquote>
<p>$\max\mathcal{L}<em>{Buzz}\geq\max{\mathcal{L}</em>{vae}}$ï¼ŒåŒæ—¶ï¼Œå½“$S\downarrow\text{diag}{\mathcal{X}}$æ—¶$\max\mathcal{L}<em>{Buzz}\downarrow\max\mathcal{L}</em>{vae}$</p>
</blockquote>
<img src="https://i.loli.net/2020/06/25/XM2xwBbOLzikhoc.png" srcset="/img/loading.gif" style="zoom:67%;" />

<h3 id="Lemma-4"><a href="#Lemma-4" class="headerlink" title="Lemma 4"></a>Lemma 4</h3><blockquote>
<p>ä»¤$p^\prime_G(\mathbf{y}|\mathbf{x})$è¡¨ç¤º$\mathbb{E}<em>{q</em>{\phi^\prime}}\left[p_G(\mathbf{y}|\mathbf{z})\right]$ã€‚å¦‚æœ$(G,\phi,\lambda)$æ˜¯ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆå­˜åœ¨$(G,\phi^\prime,\lambda)$ä½¿å¾—ï¼š<br>$$<br>\mathbb{E}<em>{p(\mathbf{x}|w)}\mathbb{E}</em>{p_G^\prime(\mathbf{y}|\mathbf{x})}\parallel\mathbf{x}-\mathbf{y}\parallel=W^1\left[P(\mathbf{x}|w)\parallel P_G(\mathbf{y}|w)\right]<br>$$<br>æ­¤æ—¶$\mathcal{L}<em>{Buzz}-\mathcal{L}</em>{vae}^\prime=\mathcal{K}^\prime-\mathcal{K}$ï¼Œå…¶ä¸­$\mathcal{L}^\prime,\mathcal{K}^\prime$åˆ†åˆ«ä¸º$(G,\phi^\prime,\lambda)$æ—¶çš„$\mathcal{L}$å’Œ$\mathcal{K}$ã€‚</p>
</blockquote>
<p>$$<br>\mathcal{L}^\dagger_{Buzz}=\mathbb{E}<em>{p(\mathbf{x})}\left[\mathbb{E}</em>{q_{\phi^\prime}(\mathbf{z}|\mathbf{x})}\log_{p_\theta}(\mathbf{x}|\mathbf{z})\right]-\min\limits_{\bar{\phi}\sim\phi^\prime}\bar{\mathcal{K}}<br>$$</p>
<h3 id="Lemma-5"><a href="#Lemma-5" class="headerlink" title="Lemma 5"></a>Lemma 5</h3><p>è¿™é‡Œä¸»è¦æ˜¯æƒ³è¯æ˜</p>
<blockquote>
<p>å¯¹äºå›ºå®šçš„$w$ï¼Œä»¤ï¼š<br>$$<br>\mathcal{F}={f|Lip(f)\leq 1}, \space \mathcal{F}^<em>=\left{f|<em>{S_w}\bigg|Lip(f|</em>{S_w})\leq 1\right}<br>$$<br>æœ‰$\sup_{f\in\mathcal{F}}\mathcal{T}(f)=\sup_{f|_{S_w}\in\mathcal{F}^</em>}\mathcal{T}^*\left(f|_{S_w}\right)$ã€‚</p>
</blockquote>
<h3 id="Theorem-6"><a href="#Theorem-6" class="headerlink" title="Theorem 6"></a>Theorem 6</h3><blockquote>
<p>$\mathcal{L}<em>{Buzz}$çš„å¯¹å¶å½¢å¼ä¸ºï¼š<br>$$<br>\mathcal{L}</em>{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}^*(F)-\mathcal{K}-\log Z(\lambda)<br>$$</p>
</blockquote>
<p>è¿‘ä¼¼çš„$\mathcal{L}<em>{Buzz}$çš„å¯¹å¶å½¢å¼ä¸ºï¼š<br>$$<br>\bar{\mathcal{L}}</em>{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}(F)-\mathcal{K}-\log Z(\lambda)<br>$$</p>
<h1 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h1><img src="https://i.loli.net/2020/06/25/GEi3zfeAgXVsvBN.png" srcset="/img/loading.gif" style="zoom:67%;" />



<img src="https://i.loli.net/2020/06/25/7EkhRGNvIsSmwn6.png" srcset="/img/loading.gif" style="zoom:67%;" />



<img src="https://i.loli.net/2020/06/25/yTIhoZb1kVOf4Mv.png" srcset="/img/loading.gif" style="zoom:67%;" />
            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Research/">Research</a>
                    
                      <a class="hover-with-bg" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Time-Series/">Time Series</a>
                    
                      <a class="hover-with-bg" href="/tags/Anomaly-Detection/">Anomaly Detection</a>
                    
                      <a class="hover-with-bg" href="/tags/Machine-Learning/">Machine Learning</a>
                    
                      <a class="hover-with-bg" href="/tags/Deep-Learning/">Deep Learning</a>
                    
                      <a class="hover-with-bg" href="/tags/VAE/">VAE</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2020/01/08/Time-Series-Anomaly-Detection-Paper-List/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Time Series Anomaly Detection Paper List</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/">
                        <span class="hidden-mobile">Variational Approaches for Auto-Encoding Generative Adversarial Networks</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
              <!-- Comments -->
              <div class="comments" id="comments">
                
                
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'http://qfxiao.me/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/';
        this.page.identifier = '/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/';
      };
      var oldLoadDq = window.onload;
      window.onload = function () {
        oldLoadDq && oldLoadDq();

        var d = document, s = d.createElement('script');
        s.type = 'text/javascript';
        s.src = '//' + 'http-larryshaw0079-coding-me-blog' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      };
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener noopener">comments
        powered by Disqus.</a></noscript>
  </div>


              </div>
            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    
  <div>
    
      <!-- ä¸è’œå­ç»Ÿè®¡PV -->
      
      <span id="busuanzi_container_site_pv" style="display: none">
      æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv"></span> æ¬¡
    </span>
    
    
      <!-- ä¸è’œå­ç»Ÿè®¡UV -->
      
      <span id="busuanzi_container_site_uv" style="display: none">
      æ€»è®¿å®¢æ•° <span id="busuanzi_value_site_uv"></span> äºº
    </span>
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




<!-- Plugins -->





  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.staticfile.org/mathjax/3.0.5/es5/tex-svg.js" ></script>

  














</body>
</html>
