<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>åˆ†ç±»: Research - Hanzawa ã® éƒ¨å±‹</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hanzawa ã® éƒ¨å±‹"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hanzawa ã® éƒ¨å±‹"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="website"><meta property="og:title" content="Hanzawa ã® éƒ¨å±‹"><meta property="og:url" content="https://larryshaw0079.github.io/hanzawa-blog"><meta property="og:site_name" content="Hanzawa ã® éƒ¨å±‹"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://larryshaw0079.github.io/img/og_image.png"><meta property="article:author" content="Hanzawa"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://larryshaw0079.github.io/hanzawa-blog"},"headline":"Hanzawa ã® éƒ¨å±‹","image":["https://larryshaw0079.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Hanzawa"},"publisher":{"@type":"Organization","name":"Hanzawa ã® éƒ¨å±‹","logo":{"@type":"ImageObject"}},"description":null}</script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Hanzawa ã® éƒ¨å±‹" type="application/atom+xml">
</head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Hanzawa ã® éƒ¨å±‹</a></div><div class="navbar-menu"><div class="navbar-end"></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">åˆ†ç±»</a></li><li class="is-active"><a href="#" aria-current="page">Research</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-05-06T03:05:37.000Z" title="2020-5-6 11:05:37 â”œF10: AMâ”¤">2020-05-06</time>å‘è¡¨</span><span class="level-item"><time dateTime="2020-06-25T08:15:23.573Z" title="2020-6-25 4:15:23 â”œF10: PMâ”¤">2020-06-25</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/05/06/Learning-Representations-of-Ultrahigh-dimensional-Data-for-Random-Distance-based-Outlier-Detection/">Learning Representations of Ultrahigh-dimensional Data for Random Distance-based Outlier Detection</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡æå‡ºäº†ä¸€ç§é’ˆå¯¹é«˜ç»´æ•°æ®å¼‚å¸¸æ£€æµ‹çš„è¡¨ç¤ºå­¦ä¹ æ–¹æ³•ã€‚æ–‡ä¸­æå‡ºäº†<strong>RAMODO</strong>æ¡†æ¶ï¼Œä¸€ç§åŸºäºæ’åºçš„ç»“åˆè¡¨ç¤ºå­¦ä¹ å’Œå¼‚å¸¸æ£€æµ‹çš„æ— ç›‘ç£æ¡†æ¶ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒåŸºäº<strong>RAMODO</strong>ï¼Œæ–‡ä¸­è¿˜æå‡ºäº†åŸºäºæ­¤æ¡†æ¶çš„æ¨¡å‹<strong>REPEN</strong>ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1806.04808">PaperğŸ“°</a></p>
<h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1><h2 id="The-Proposed-Framework-RAMODO"><a href="#The-Proposed-Framework-RAMODO" class="headerlink" title="The Proposed Framework: RAMODO"></a>The Proposed Framework: <strong>RAMODO</strong></h2><h3 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h3><p>æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºé«˜ç»´æ•°æ®å­¦ä¹ ä½ç»´è¡¨ç¤ºï¼ŒåŒæ—¶åœ¨å­¦åˆ°çš„ä½ç»´è¡¨ç¤ºä¸­èƒ½å¤Ÿæ›´å¥½åœ°è¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€‚è®¾æœ‰æ•°æ®é›†$\mathcal{X}={\mathbf x_1,\mathbf x_2,\cdots, \mathbf x_N}$ ($\mathbf x_i\in \mathbb{R}^D$) å’Œä¸€ä¸ªåŸºäºéšæœºè·ç¦»çš„å¼‚å¸¸æ£€æµ‹å™¨$\phi:\mathcal{X}\mapsto \mathbb{R}$ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªè¡¨ç¤ºå‡½æ•°$f:\mathcal{X}\mapsto\mathbb{R}^M (M\ll D)$ä½¿å¾—å¯¹äºæ‰€æœ‰å¼‚å¸¸æ ·æœ¬$\mathbf x_i$å’Œæ­£å¸¸æ ·æœ¬$\mathbf x_j$éƒ½æœ‰$\phi(f(\mathbf x_i))&gt;\phi(f(\mathbf x_j))$ã€‚</p>
<h3 id="Ranking-Model-based-Representation-Learning-Framework"><a href="#Ranking-Model-based-Representation-Learning-Framework" class="headerlink" title="Ranking Model-based Representation Learning Framework"></a>Ranking Model-based Representation Learning Framework</h3><p><strong>RAMODO</strong>åŸºäº<em>pairwise ranking model</em>ã€‚ç¬¬ä¸€æ­¥æ˜¯é€šè¿‡ä¸€å®šçš„é¢„å¤„ç†ç®—æ³•ï¼ˆåŸæ–‡ä¸­ç§°ä¸º<em>outlier thresholding</em>ï¼‰å°†æ•°æ®åˆ’åˆ†ä¸ºinlierå€™é€‰é›†å’Œoutlierå€™é€‰é›†ï¼›ç¬¬äºŒæ­¥é€šè¿‡éšæœºä»inlierå€™é€‰é›†é‡‡æ ·$n$ä¸ªæ ·æœ¬ç”Ÿæˆquery set $(\mathbf x_i,\cdots,\mathbf x_{i+n-1})$ï¼Œä»inlierå€™é€‰é›†é‡‡æ ·ä¸€ä¸ªæ ·æœ¬ç”Ÿæˆ<em>positive example</em> $(\mathbf x^+)$ï¼Œä»outlierå€™é€‰é›†é‡‡æ ·ä¸€ä¸ªæ ·æœ¬ç”Ÿæˆ<em>negative example</em> $(\mathbf x^-)$ï¼Œå°†ä¸‰è€…ç»„åˆç”Ÿæˆ <em>metatriplet</em> $T=(&lt;\mathbf x_i,\cdots,\mathbf x_{i+n-1}&gt;,\mathbf x^+,\mathbf x^-)$ï¼›ç¬¬ä¸‰æ­¥é€šè¿‡ç¥ç»ç½‘ç»œ$f$å­¦ä¹ è¡¨ç¤ºï¼›ç¬¬å››æ­¥é€šè¿‡<em>outlier score-based ranking loss</em> $L(\phi(f(\mathbf x^+)|&lt;f(\mathbf x_i),\cdots,f(\mathbf x_{i+n-1})&gt;),\phi(f(\mathbf x^-)|&lt;f(\mathbf x_i),\cdots,f(\mathbf x_{i+n-1})&gt;))$æ¥è¿›è¡Œä¼˜åŒ–ï¼Œå…¶ä¸­$\phi(\cdot|\cdot)$ä¸ºåŸºäºè·ç¦»çš„å¼‚å¸¸æ£€æµ‹å™¨ã€‚</p>
<p><img src="https://i.loli.net/2020/06/25/4I7fx5ZjBhueUDz.png"></p>
<h2 id="A-RAMODO-Instance-REPEN"><a href="#A-RAMODO-Instance-REPEN" class="headerlink" title="A RAMODO Instance: REPEN"></a>A <strong>RAMODO</strong> Instance: <strong>REPEN</strong></h2><p><strong>REPEN</strong>ä¸º<strong>RAMODO</strong>çš„å®ä¾‹æ¨¡å‹ï¼Œä½¿ç”¨Spä½œä¸ºå¼‚å¸¸æ£€æµ‹å™¨ã€‚</p>
<h3 id="Outlier-Thresholding-Using-State-of-the-art-Detectors-and-Cantelliâ€™s-Inequality"><a href="#Outlier-Thresholding-Using-State-of-the-art-Detectors-and-Cantelliâ€™s-Inequality" class="headerlink" title="Outlier Thresholding Using State-of-the-art Detectors and Cantelliâ€™s Inequality"></a>Outlier Thresholding Using State-of-the-art Detectors and Cantelliâ€™s Inequality</h3><p>ç¬¬ä¸€æ­¥ä½¿ç”¨Spä½œä¸ºåŸºç¡€è·å¾—åˆå§‹anomaly scoreï¼š</p>
<blockquote>
<p><strong>Definition 1</strong> (<em>Sp-based Outlier Scoring</em>). ç»™å®šæ ·æœ¬$x_i$ï¼ŒSp ä»¥ä»¥ä¸‹æ–¹å¼å®šä¹‰è¯¥æ ·æœ¬çš„å¼‚å¸¸ç¨‹åº¦ï¼š<br>$$<br>r_i=\frac{1}{m}\sum\limits_{j=1}^m nn_dist(\mathbf x_i|\mathcal{S}_j)<br>$$<br>å…¶ä¸­$\mathcal S_j\subset \mathcal X$ä¸ºæ•°æ®é›†éšæœºé‡‡æ ·çš„å­é›†ï¼Œ$m$ä¸ºé›†æˆå¤§å°ï¼Œ$nn_dist(\cdot|\cdot)$ä¸º$\mathcal S_j$ä¸­æœ€è¿‘é‚»å±…çš„è·ç¦»ã€‚</p>
</blockquote>
<p>æ¥ç€é€šè¿‡<em>Cantelliâ€™s Inequality</em>æ¥å®šä¹‰<em>Pseudo Outlier</em>ï¼š</p>
<blockquote>
<p>*<em>Definition 2 **(<em>Cantelliâ€™s Inequality-based Outlier Thresholding</em>). ç»™å®šå¼‚å¸¸åˆ†æ•°å‘é‡$\mathbf r\in\mathbb R^N$ï¼Œæ›´é«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ›´é«˜çš„å¯èƒ½æ€§ä¸ºå¼‚å¸¸ï¼Œè®¾$\mu$å’Œ$\delta^2$åˆ†åˆ«ä¸ºå‡å€¼å’Œæ–¹å·®ï¼Œ</em>Outlier*å€™é€‰é›†ç”±ä»¥ä¸‹æ–¹å¼ç¡®å®šï¼š<br>$$<br>\mathcal{O}={\mathbf x_i|r_i \geq \mu + \alpha\delta}, \space\forall \mathbf x_i\in\mathcal X, \space r_i\in\mathbf r<br>$$<br>å…¶ä¸­$\alpha\geq 0$ä¸ºè‡ªå®šä¹‰çš„é˜ˆå€¼ã€‚</p>
</blockquote>
<p><em>Inlier</em>å€™é€‰é›†$\mathcal I=\mathcal X\backslash \mathcal O$ã€‚</p>
<h3 id="Triplet-Sampling-Based-on-Outlier-Scores"><a href="#Triplet-Sampling-Based-on-Outlier-Scores" class="headerlink" title="Triplet Sampling Based on Outlier Scores"></a>Triplet Sampling Based on Outlier Scores</h3><p>é¦–å…ˆï¼Œä»$\mathcal I$é‡‡æ ·ä¸€å®šæ•°é‡çš„æ ·æœ¬ç»„æˆ<em>query set</em>ï¼Œæ¯ä¸ªæ ·æœ¬è¢«é‡‡æ ·çš„æ¦‚ç‡ä¸å…¶å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°æœ‰å…³ï¼š</p>
<p>$$<br>p(\mathbf x_i)=\frac{\mathbb Z-r_i}{\sum_{t=1}^{|\mathcal I|}[\mathbb Z-r_t]}<br>$$</p>
<p>å…¶ä¸­$\mathbb Z=\sum_{t=1}^{|\mathcal I|}r_t$ã€‚</p>
<p>ä¹‹åä»<em>inlier set</em>ä¸­å‡åŒ€éšæœºé‡‡æ ·ä¸€ä¸ª<em>positive sample</em> $\mathbf x^+$ã€‚æœ€åä»<em>outlier set</em>ä¸­æ ¹æ®ä»¥ä¸‹æ¦‚ç‡é‡‡æ ·ä¸€ä¸ª<em>negative sample</em> $\mathbf x^-$ï¼š<br>$$<br>p(\mathbf x_j)=\frac{r_j}{\sum_{t=1}^{|\mathcal O|}r_t}<br>$$</p>
<h3 id="A-Shallow-Data-Representation"><a href="#A-Shallow-Data-Representation" class="headerlink" title="A Shallow Data Representation"></a>A Shallow Data Representation</h3><p>å•å±‚ç¥ç»ç½‘ç»œç”¨æ¥è·å¾—æµ…å±‚çš„è¡¨ç¤ºï¼š</p>
<blockquote>
<p>**Definition 3 **(<em>Single-layer Fully-connected Representations</em>) ç»™å®šè¾“å…¥$x$ï¼Œ<br>$$<br>f_\Theta(\mathbf x)={\psi(\mathbf w_1^\top\mathbf x),\psi(\mathbf w_2^\top\mathbf x),\cdots,\psi(\mathbf w_M^\top\mathbf x)}<br>$$<br>å…¶ä¸­$\psi(\cdot)$ä¸ºæ¿€æ´»å‡½æ•°ï¼Œ$\mathbf w$ä¸ºæƒé‡çŸ©é˜µã€‚</p>
</blockquote>
<h3 id="Ranking-Loss-Using-Random-Nearest-Neighbor-Distance-based-Outlier-Scores"><a href="#Ranking-Loss-Using-Random-Nearest-Neighbor-Distance-based-Outlier-Scores" class="headerlink" title="Ranking Loss Using Random Nearest Neighbor Distance-based Outlier Scores"></a>Ranking Loss Using Random Nearest Neighbor Distance-based Outlier Scores</h3><p>è®¾$\mathcal{Q}=&lt;f_\Theta(\mathbf x_i),\cdots,f_\Theta(\mathbf x_{i+n-1})&gt;$ä¸º<em>query set</em>ï¼Œç»™å®šæ ·æœ¬$\mathbf x$ï¼Œ<strong>REPEN</strong>æ ¹æ®æœ€è¿‘é‚»è·ç¦»å®šä¹‰äº†$f_\Theta(\mathbf x)$çš„å¼‚å¸¸ç¨‹åº¦ï¼š<br>$$<br>\phi(f_\Theta(\mathbf x)|\mathcal{Q})=nn_dist(f_\Theta(\mathbf x)|\mathcal Q)<br>$$<br>å› æ­¤ï¼Œç»™å®šä¸‰å…ƒç»„$T=(\mathcal Q,f_\Theta(\mathbf x^+),f_\Theta(\mathbf x^-))$ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦å¾—è¡¨ç¤º$f(\cdot)$ä½¿å¾—ï¼š<br>$$<br>nn_dist(f_\Theta(\mathbf x^+)|\mathcal Q)&lt;nn_dist(f_\Theta(\mathbf x^-)|\mathcal Q)<br>$$<br>æŸå¤±å‡½æ•°ï¼š<br>$$<br>J(\Theta;T)=L(\phi(f_\Theta(\mathbf x^+)|\mathcal Q),\phi(f_\Theta(\mathbf x^-)|\mathcal Q))=\\max{0, c+nn_dist(f_\Theta(\mathbf x^+)|\mathcal Q)-nn_dist(f_\Theta(\mathbf x^-)|\mathcal Q)}<br>$$<br>å…¶ä¸­$c$ä¸ºè¾¹ç•Œå‚æ•°ã€‚ç»™å®šä¸€ç³»åˆ—ä¸‰å…ƒç»„ï¼Œæœ€ç»ˆä¼˜åŒ–ç›®æ ‡å¦‚ä¸‹ï¼š<br>$$<br>\mathop{\text{arg min}}\limits_{\Theta}\frac{1}{|\mathcal{T}|}\sum\limits_{i=1}^{|\mathcal T|}J(\Theta;T_i)<br>$$</p>
<h3 id="The-Algorithm-and-Its-Time-Complexity"><a href="#The-Algorithm-and-Its-Time-Complexity" class="headerlink" title="The Algorithm and Its Time Complexity"></a>The Algorithm and Its Time Complexity</h3><p><img src="https://i.loli.net/2020/06/25/eYtKHBJ7szCgjNa.png"></p>
<h3 id="Leveraging-A-Few-Labeled-Outliers-to-Improve-Triplet-Sampling"><a href="#Leveraging-A-Few-Labeled-Outliers-to-Improve-Triplet-Sampling" class="headerlink" title="Leveraging A Few Labeled Outliers to Improve Triplet Sampling"></a>Leveraging A Few Labeled Outliers to Improve Triplet Sampling</h3><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Datasets"><a href="#Datasets" class="headerlink" title="Datasets"></a>Datasets</h2><ul>
<li>ADï¼šç½‘ç»œå¹¿å‘Šæ£€æµ‹</li>
<li>LCï¼šè‚ºç™Œç–¾ç—…ç›‘æµ‹</li>
<li>p53ï¼šå¼‚å¸¸è›‹ç™½è´¨æ´»åŠ¨æ£€æµ‹</li>
<li>R8ï¼šæ–‡æœ¬åˆ†ç±»</li>
<li>News20ï¼šæ–‡æœ¬åˆ†ç±»</li>
<li>URLï¼šå¼‚å¸¸ç½‘å€æ£€æµ‹</li>
<li>Webspamï¼šPascal Large Scale LearningChallenge</li>
</ul>
<h2 id="Effectiveness-in-Real-world-Data-with-Thousands-to-Millions-of-Features"><a href="#Effectiveness-in-Real-world-Data-with-Thousands-to-Millions-of-Features" class="headerlink" title="Effectiveness in Real-world Data with Thousands to Millions of Features"></a>Effectiveness in Real-world Data with Thousands to Millions of Features</h2><p>ä½œè€…åˆ†åˆ«ä½¿ç”¨åŸå§‹ç‰¹å¾å’Œ<em>REPEN</em>å­¦åˆ°çš„ç‰¹å¾è¿›è¡Œå¼‚å¸¸æ£€æµ‹ï¼ŒIMPä»£è¡¨æ€§èƒ½æå‡æ¯”ä¾‹ï¼ŒSUä»£è¡¨åŠ é€Ÿæ¯”ä¾‹ã€‚</p>
<p><img src="https://i.loli.net/2020/06/25/mvUiE1NzyTwOgV8.png"></p>
<h2 id="Comparing-to-State-of-the-art-Representation-Learning-Competitors"><a href="#Comparing-to-State-of-the-art-Representation-Learning-Competitors" class="headerlink" title="Comparing to State-of-the-art Representation Learning Competitors"></a>Comparing to State-of-the-art Representation Learning Competitors</h2><ul>
<li>**AE: **è‡ªç¼–ç å™¨</li>
<li>**HLLE: ** <em>Hessian Locally Linear Embedding</em></li>
<li>**SRP: ** <em>Sparse Random Projection</em></li>
<li>**CoP: ** <em>Coherent Pursuit</em></li>
</ul>
<p><img src="https://i.loli.net/2020/06/25/yQumCRNrHAheJ34.png"></p>
<h2 id="The-Capability-of-Leveraging-Labeled-Outliers-as-Prior-Knowledge"><a href="#The-Capability-of-Leveraging-Labeled-Outliers-as-Prior-Knowledge" class="headerlink" title="The Capability of Leveraging Labeled Outliers as Prior Knowledge"></a>The Capability of Leveraging Labeled Outliers as Prior Knowledge</h2><p><img src="https://i.loli.net/2020/06/25/NOLfKQd2u1JMPtp.png"></p>
<h2 id="Sensitivity-Test-w-r-t-the-Representation-Dimension"><a href="#Sensitivity-Test-w-r-t-the-Representation-Dimension" class="headerlink" title="Sensitivity Test w.r.t. the Representation Dimension"></a>Sensitivity Test w.r.t. the Representation Dimension</h2><p><img src="https://i.loli.net/2020/06/25/BoGjY5SEu6vrK3X.png"></p>
<p><img src="https://i.loli.net/2020/06/25/Rlx7Df9Hvsjp2Eg.png"></p>
<p>æ–‡ä¸­æåˆ°äº†å¯¹äºR8ã€URLã€News20è¿™ä¸‰ä¸ªæ•°æ®é›†åœ¨ç»´åº¦$M=1$çš„æ—¶å€™è¡¨ç°å’Œå…¶ä»–ç»´åº¦ä¸€æ ·å¥½ï¼Œä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯åœ¨è¿™å‡ ä¸ªæ•°æ®é›†ä¸­å¼‚å¸¸éƒ¨åˆ†æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œæ‰€ä»¥1ç»´å°±è¶³å¤Ÿäº†ï¼Œå¦ä¸€ä¸ªè§£é‡Šæ˜¯ä¼˜åŒ–é—®é¢˜ã€‚</p>
<h2 id="Scalability-Test"><a href="#Scalability-Test" class="headerlink" title="Scalability Test"></a>Scalability Test</h2><p><img src="https://i.loli.net/2020/06/25/1JfUclWyFYgLdNp.png"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-03-29T16:17:24.000Z" title="2020-3-30 12:17:24 â”œF10: AMâ”¤">2020-03-30</time>å‘è¡¨</span><span class="level-item"><time dateTime="2020-06-25T05:33:35.419Z" title="2020-6-25 1:33:35 â”œF10: PMâ”¤">2020-06-25</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/03/30/Deep-Weakly-supervised-Anomaly-Detection/">Deep Weakly-supervised Anomaly Detection</a></h1><div class="content"><h1 id="introduction">Introduction</h1>
<p>åœ¨æ–‡çŒ®ä¸­ï¼Œå› ä¸ºæ ‡æ³¨æˆæœ¬çš„æ˜‚è´µï¼Œæ— ç›‘ç£æ–¹æ³•å æ®äº†å¼‚å¸¸æ£€æµ‹çš„ä¸»è¦ä½ç½®ã€‚ç„¶è€Œï¼Œåœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰å°‘é‡æ ‡ç­¾ï¼Œå¦‚ä½•åˆ©ç”¨è¿™éƒ¨åˆ†æ ‡ç­¾ä¿¡æ¯å°±æˆä¸ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œä½œè€…å°†å…¶ç§°ä¹‹ä¸º<em>anomaly-informed modeling</em>ã€‚ä½œè€…æå‡ºäº†ä¸¤ç‚¹æŒ‘æˆ˜ï¼š</p>
<ol type="1">
<li>å°‘é‡æ ‡ç­¾å¯èƒ½æ— æ³•æä¾›æ‰€æœ‰ç±»å‹å¼‚å¸¸çš„ä¿¡æ¯ï¼›</li>
<li>å¤§éƒ¨åˆ†æ— æ ‡ç­¾æ•°æ®ä¸ºæ­£å¸¸æ ·æœ¬ï¼Œä½†å…¶ä¸­åŒ…å«å°‘éƒ¨åˆ†å¼‚å¸¸ï¼ˆæ±¡æŸ“ï¼‰ã€‚</li>
</ol>
<p>ä½œè€…æå‡ºäº†åŸºäºpairwise relation learningçš„æ–¹æ³•æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚æ–‡ç« çš„ä¸»è¦è´¡çŒ®å¦‚ä¸‹ï¼š</p>
<ol type="1">
<li>æå‡ºäº†ä¸€ç§åŸºäºpairing-based data augmentationå’Œordinal regressionæ¥è¿›è¡Œå¼±ç›‘ç£å¼‚å¸¸æ£€æµ‹çš„æ¡†æ¶</li>
<li>åŸºäºè¯¥æ¡†æ¶æå‡ºäº†PReNetï¼Œä¸€ç§åŸºäºåŒæµordinal regressionçš„ç½‘ç»œ</li>
<li>ä»ç†è®ºå’Œå®è·µè§’åº¦åˆ†æäº†æ–¹æ³•çš„æœ‰æ•ˆæ€§</li>
<li>åœ¨40ä¸ªçœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®Œå–„çš„å®éªŒ</li>
</ol>
<h1 id="proposed-method">Proposed Method</h1>
<h2 id="learning-anomaly-scores-by-predicting-pairwise-relation">Learning Anomaly Scores by Predicting Pairwise Relation</h2>
<h3 id="problem-formulation">Problem Formulation</h3>
<p>ç»™å®šæ•°æ®é›†<span class="math inline">\(\mathcal{X}=\{\mathbf{x}_1,\mathbf {x}_2,\cdots,\mathbf{x}_N,\mathbf{x}_{N+1},\cdots,\mathbf{x}_{N+K}\}\)</span>ï¼ŒåŒ…å«ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯äº”æ ‡ç­¾æ•°æ®<span class="math inline">\(\mathcal{U}=\{\mathbf{x}_1,\mathbf {x}_2,\cdots,\mathbf{x}_N\}\)</span>ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æœ‰æ ‡ç­¾å¼‚å¸¸æ•°æ®<span class="math inline">\(\mathcal{A}=\{\mathbf{x}_{N+1},\cdots,\mathbf{x}_{N+K}\}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(K\ll N\)</span>ã€‚æˆ‘ä»¬çš„ä»»åŠ¡ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªæ‰“åˆ†å‡½æ•°<span class="math inline">\(\phi:\mathcal{X}\mapsto \mathbb{R}\)</span>ï¼Œä½¿å¾—å¯¹ä»»ä»»æ„å¼‚å¸¸æ ·æœ¬çš„æ‰“åˆ†é«˜äºä»»æ„æ­£å¸¸æ ·æœ¬ã€‚</p>
<p>åœ¨è¿™ä¸ªFormulationé‡Œï¼Œä½œè€…å°†å…³ç³»å­¦ä¹ å’Œå¼‚å¸¸æ‰“åˆ†ç»Ÿä¸€äº†èµ·æ¥ã€‚é¦–å…ˆï¼Œè¾“å…¥çš„æ•°æ®é›†ä¸å†æ˜¯åŸå§‹æ ·æœ¬ï¼Œè€Œæ˜¯æ ·æœ¬å¯¹ã€‚æ ·æœ¬å¯¹åŒ…å«ä¸‰ç§ï¼š<em>anomaly-anomaly</em>ï¼Œ<em>anomaly-unlabeled</em>ï¼Œ<em>unlabeled-unlabeled</em>ï¼Œè®°ä¸º<span class="math inline">\(C_{\{\mathbf{a},\mathbf{a}\}}\)</span>ï¼Œ<span class="math inline">\(C_{\{\mathbf{a},\mathbf{u}\}}\)</span>ï¼Œ<span class="math inline">\(C_{\{\mathbf{u},\mathbf{u}\}}\)</span>ã€‚æ¯ä¸€ä¸ªæ ·æœ¬å¯¹åŒ…å«ä¸€ä¸ªæ ‡ç­¾<span class="math inline">\(y\)</span>ï¼Œè¡¨ç¤ºè¯¥pairå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°ï¼Œæ•´ä¸ªè¾“å…¥æ•°æ®é›†<span class="math inline">\(\mathcal{P}=\{\{\mathbf{x}_i,\mathbf{x}_j,y_{ij}\}|\mathbf{x}_i,\mathbf{x}_j\in\mathcal{X} \space\text{and}\space y_{ij}\in\mathbb{N}\}\)</span>ã€‚å› ä¸ºæœ‰<span class="math inline">\(y_{\{\mathbf a,\mathbf a\}}&gt;y_{\{\mathbf a,\mathbf u\}}&gt;y_{\{\mathbf u,\mathbf u\}}\)</span>ï¼Œæ‰€ä»¥å¯¹å…³ç³»çš„å­¦ä¹ ä¹Ÿæ˜¯å¯¹å¼‚å¸¸æ‰“åˆ†çš„å­¦ä¹ ã€‚</p>
<h3 id="the-instantiated-model-prenet">The Instantiated Model: PReNET</h3>
<p>ä¸‹å›¾ä¸ºæ¨¡å‹ç¤ºæ„å›¾ï¼Œ<strong>Data Augmentation</strong>æ¨¡å—è´Ÿè´£äº§ç”Ÿpairæ•°æ®ï¼Œ<strong>End-to-End Anomaly Score Learner <span class="math inline">\(\phi\)</span></strong> æ¨¡å—è´Ÿè´£å…³ç³»å­¦ä¹ ï¼ˆå¼‚å¸¸æ‰“åˆ†ï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2020/06/25/6ZF3w9v1Lux5t4Q.png" style="zoom:67%;" /></p>
<h4 id="data-argumentation-by-pairing">Data Argumentation by Pairing</h4>
<p>æ•°æ®çš„äº§ç”Ÿåˆ†ä¸ºä¸¤æ­¥ï¼š</p>
<ol type="1">
<li>ä»<span class="math inline">\(\mathcal{A}\)</span>å’Œ<span class="math inline">\(\mathcal{U}\)</span>ä¸Šéšæœºé‡‡æ ·ï¼Œç»„æˆpairï¼›</li>
<li>å¯¹æ¯ä¸ªpairæ‰“ä¸Šæ¬¡åº(ordinal class feature) æ ‡ç­¾<span class="math inline">\(\mathbf{y}\)</span>ã€‚</li>
</ol>
<p>éƒ¨åˆ†<span class="math inline">\(C_{\{\mathbf{a},\mathbf{u}\}}\)</span>å’Œ<span class="math inline">\(C_{\{\mathbf{u},\mathbf{u}\}}\)</span>å¯èƒ½åŒ…å«å¼‚å¸¸æ±¡æŸ“ï¼Œå› ä¸ºåœ¨<span class="math inline">\(\mathcal{U}\)</span>ä¸­å¯èƒ½ä¼šæœ‰æœªæ ‡è®°çš„å¼‚å¸¸æ ·æœ¬ã€‚</p>
<h4 id="end-to-end-anomaly-score-learner">End-to-End Anomaly Score Learner</h4>
<p>ä»¤<span class="math inline">\(\mathcal{Z}\in\mathbb{R}^M\)</span>ä¸ºä¸­é—´è¡¨ç¤ºç©ºé—´ï¼Œé‚£ä¹ˆ<strong>Score Learner</strong>å¯ä»¥æ‹†è§£ä¸ºç‰¹å¾å­¦ä¹ <span class="math inline">\(\psi(\cdot;\Theta_r):\mathcal{X}\mapsto \mathcal{Z}\)</span>å’Œæ‰“åˆ†å‡½æ•°<span class="math inline">\(\eta((\cdot,\cdot);\Theta_s):(\mathcal{Z},\mathcal{Z})\mapsto\mathbb{R}\)</span>ä¸¤éƒ¨åˆ†ï¼Œä¸¤éƒ¨åˆ†éƒ½ç”±ç¥ç»ç½‘ç»œç»„æˆã€‚</p>
<h4 id="ordinal-regression">Ordinal Regression</h4>
<p>æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š <span class="math display">\[
L\left(\phi((\mathbf x_i,\mathbf x_j);\Theta),y_{ij}\right)=|y_{ij}-\phi((\mathbf x_i,\mathbf x_j);\Theta)|
\]</span> é‡‡ç”¨ç»å¯¹å€¼è€Œä¸æ˜¯å‡æ–¹è¯¯å·®çš„åŸå› æ˜¯ä¸ºäº†å‡å°‘å¼‚å¸¸æ±¡æŸ“çš„å½±å“ã€‚é»˜è®¤<span class="math inline">\(y_{\{\mathbf a,\mathbf a\}}=8\)</span>ï¼Œ<span class="math inline">\(y_{\{\mathbf a,\mathbf u\}}=4\)</span>ï¼Œ<span class="math inline">\(y_{\{\mathbf u,\mathbf u\}}=0\)</span>ã€‚æœ€åçš„ä¼˜åŒ–å‡½æ•°å¯ä»¥å†™ä¸ºï¼š <span class="math display">\[
\mathop{\text{argmin}}\limits_{\Theta}\frac{1}{|\mathcal{B}|}\sum\limits_{\{\mathbf x_i,\mathbf x_j, y_{ij}\}\in\mathcal{B}}|y_{ij}-\phi((\mathbf x_i,\mathbf x_j);\Theta)|+\lambda R(\Theta)
\]</span> <span class="math inline">\(\mathcal{B}\)</span>ä¸ºä¸€ä¸ªbatchï¼Œ<span class="math inline">\(R(\Theta)\)</span>ä¸ºæ­£åˆ™é¡¹ã€‚</p>
<h3 id="anomaly-detection-using-prenet">Anomaly Detection Using PReNet</h3>
<h4 id="training-stage">Training Stage</h4>
<p>è®­ç»ƒæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/oR6uTL3c7HMpwD4.png" style="zoom: 80%;" /></p>
<p>ä¸ºäº†ä¿è¯è®­ç»ƒæ ·æœ¬ç±»åˆ«çš„å¹³è¡¡ï¼Œ<span class="math inline">\(\frac{|\mathcal{B}|}{2}\)</span>çš„æ ·æœ¬é‡‡æ ·è‡ª<span class="math inline">\(C_{\{\mathbf u,\mathbf u\}}\)</span>ï¼Œé‡‡æ ·è‡ª<span class="math inline">\(C_{\{\mathbf a,\mathbf u\}}\)</span>å’Œ<span class="math display">\[C_{\{\mathbf a,\mathbf a\}}\]</span>çš„æ ·æœ¬éƒ½å <span class="math inline">\(\frac{|\mathcal{B}|}{4}\)</span>ã€‚</p>
<h4 id="anomaly-scoring-stage">Anomaly Scoring Stage</h4>
<p>åœ¨æµ‹è¯•é˜¶æ®µï¼Œç»™å®šæµ‹è¯•æ ·æœ¬<span class="math inline">\(\mathbf{x}_k\)</span>ï¼Œå…ˆåˆ†åˆ«ä»<span class="math inline">\(\mathcal{A}\)</span>å’Œ<span class="math inline">\(\mathcal{U}\)</span>é‡‡æ ·ï¼Œç„¶åå®šä¹‰ä»¥ä¸‹<em>anomaly score</em>ï¼š <span class="math display">\[
s_{\mathbf{x}_k}=\frac{1}{2E}\left[\sum\limits_{i=1}^E\phi((\mathbf a_i,\mathbf x_k);\Theta^*)+\sum\limits_{j=1}^E\phi((\mathbf x_k,\mathbf u_j);\Theta^*)\right]
\]</span> <span class="math inline">\(\mathbf a_i\)</span>å’Œ<span class="math inline">\(\mathbf u_j\)</span>ä¸ºéšæœºé‡‡æ ·å¾—åˆ°çš„å¼‚å¸¸æ ·æœ¬å’Œæ­£å¸¸æ ·æœ¬ï¼Œé‡‡æ ·å¤§å°<span class="math inline">\(E\)</span>é»˜è®¤ä¸º30ã€‚</p>
<h1 id="experiments">Experiments</h1>
<p>å®éªŒéƒ¨åˆ†ä¸»è¦æ˜¯å›ç­”ä»¥ä¸‹å››ä¸ªé—®é¢˜ï¼š</p>
<ol type="1">
<li>åœ¨æœ‰é™çš„æ ‡ç­¾å¼‚å¸¸æƒ…å†µä¸‹ï¼ŒPReNetèƒ½å¦æœ‰æ•ˆåœ°æ£€æµ‹å·²çŸ¥å’ŒæœªçŸ¥çš„å¼‚å¸¸ï¼›</li>
<li>åœ¨ä¸åŒæ•°é‡æ ‡ç­¾å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼ŒPReNetçš„è¡¨ç°å¦‚ä½•ï¼›</li>
<li>PReNetå¯¹å¼‚å¸¸æ±¡æŸ“çš„é²æ£’æ€§å¦‚ä½•ï¼›</li>
<li>PReNetä¸åŒç»„ä»¶çš„é‡è¦æ€§å¦‚ä½•ã€‚</li>
</ol>
<h2 id="datasets">Datasets</h2>
<p>å®éªŒä¸€å…±ç”¨åˆ°äº†40ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­12ä¸ªç”¨æ¥è¯„æµ‹ç®—æ³•æ£€æµ‹å·²çŸ¥çš„å¼‚å¸¸çš„èƒ½åŠ›ï¼ˆå¦‚Table 2æ‰€ç¤ºï¼‰ï¼Œ28ä¸ªç”¨æ¥è¯„æµ‹ç®—æ³•æ£€æµ‹æœªçŸ¥çš„å¼‚å¸¸çš„èƒ½åŠ›ï¼ˆå¦‚Table 3æ‰€ç¤ºï¼‰ã€‚</p>
<h2 id="competing-methods-and-parameter-settings">Competing Methods and Parameter Settings</h2>
<p>ç”¨åˆ°çš„baselineæœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ul>
<li>DevNetï¼šåŒä¸€ä½œè€…åœ¨KDD2019æå‡ºçš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶</li>
<li>Deep support vector data description (DSVDD)ï¼šæ·±åº¦æ”¯æŒå‘é‡æ•°æ®æè¿°</li>
<li>Prototypical networkï¼š few-shot classificationä¸­çš„ä¸€ç§æ¨¡å‹</li>
<li>iForestï¼šå­¤ç«‹æ£®æ—</li>
</ul>
<h2 id="performance-evaluation-metrics">Performance Evaluation Metrics</h2>
<p>ç”¨åˆ°çš„Metricsä¸ºAUC-ROCå’ŒAUC-PRã€‚</p>
<h2 id="detection-of-known-anomalies">Detection of Known Anomalies</h2>
<p>åœ¨æœ¬å®éªŒä¸­ï¼Œå¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹ï¼ˆ2%ï¼‰å’Œæœ‰æ ‡è®°å¼‚å¸¸æ ·æœ¬çš„æ•°é‡ï¼ˆ60ï¼‰æ˜¯å›ºå®šçš„ï¼Œä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/BfhVE9z8DWipAM6.png" style="zoom: 80%;" /></p>
<h2 id="detection-of-unknown-anomalies">Detection of Unknown Anomalies</h2>
<p>åœ¨æœ¬å®éªŒä¸­ï¼Œå¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹ï¼ˆ2%ï¼‰å’Œæœ‰æ ‡è®°å¼‚å¸¸æ ·æœ¬çš„æ•°é‡ï¼ˆ60ï¼‰åŒæ ·æ˜¯å›ºå®šçš„ï¼Œä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/9GM8XTYiSLUn2Ar.png" style="zoom:80%;" /></p>
<p><img src="https://i.loli.net/2020/06/25/4RxrGZWLqHNnXco.png" style="zoom:80%;" /></p>
<h2 id="availability-of-known-anomalies">Availability of Known Anomalies</h2>
<p>æœ¬å®éªŒä¸»è¦æ˜¯ç ”ç©¶ä¸åŒæ•°é‡æ ‡æ³¨å¼‚å¸¸æ ·æœ¬çš„æ¡ä»¶ä¸‹ï¼Œç®—æ³•çš„æ€§èƒ½å¦‚ä½•ã€‚å¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹å›ºå®šï¼ˆ2%ï¼‰ï¼Œæ ‡æ³¨å¼‚å¸¸çš„æ•°é‡ä»15åˆ°120å˜åŒ–ã€‚å®éªŒç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/x4Hf3lU5JO71bvo.png" style="zoom:80%;" /></p>
<h2 id="further-analysis-of-prenet">Further Analysis of PReNet</h2>
<h3 id="tolerance-to-anomaly-contamination-in-unlabeled-data">Tolerance to Anomaly Contamination in Unlabeled Data</h3>
<p>æœ¬å®éªŒä¸»è¦ç ”ç©¶ä¸åŒå¼‚å¸¸æ±¡æŸ“æ¯”ä¾‹ä¸‹ï¼Œç®—æ³•çš„æ€§èƒ½ï¼Œå³æ¢ç©¶ç®—æ³•å¯¹å¼‚å¸¸æ±¡æŸ“çš„é²æ£’æ€§ã€‚æ ‡æ³¨å¼‚å¸¸æ ·æœ¬çš„æ•°é‡æ’å®šï¼ˆ60ï¼‰ï¼Œå¼‚å¸¸æ±¡æŸ“æ¯”ä¾‹åœ¨<span class="math inline">\(\{0\%,2\%,5\%,10\%\}\)</span>ä¸­å˜åŒ–ã€‚å®éªŒç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/TGYCJUs8LlmreNV.png" style="zoom:80%;" /></p>
<h3 id="ablation-study">Ablation Study</h3>
<p>è¿™ä¸€èŠ‚æ˜¯æ¶ˆèå®éªŒï¼Œåˆ†åˆ«è®¾ç½®äº†å››ä¸ªå˜ä½“ï¼š</p>
<ul>
<li><strong>BOR: </strong>æŸå¤±å‡½æ•°æ›¿æ¢æˆäº†äºŒå€¼å›å½’<em>Binary Ordinal Regression</em>ï¼›</li>
<li><strong>OSNet: </strong>å°†åŒæµç»“æ„ç®€åŒ–ä¸ºå•æµï¼›</li>
<li><strong>LDM: </strong>å°†ç½‘ç»œä¸­çš„éšè—å±‚å»é™¤ï¼›</li>
<li><strong>A2H: </strong>åŠ å…¥äº†é¢å¤–çš„éšè—å±‚ï¼Œå¹¶ä¸”åŠ å…¥äº†<span class="math inline">\(\ell_2\)</span>-normé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</li>
</ul>
<p><img src="https://i.loli.net/2020/06/25/oR7qlZWfepFT8jK.png" style="zoom:80%;" /></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-03-01T14:55:02.000Z" title="2020-3-1 10:55:02 â”œF10: PMâ”¤">2020-03-01</time>å‘è¡¨</span><span class="level-item"><time dateTime="2020-06-25T05:35:20.215Z" title="2020-6-25 1:35:20 â”œF10: PMâ”¤">2020-06-25</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Misc/">Misc</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/">Discovering Physical Concepts with Neural Networks</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>å¦‚é¢˜ç›®æ‰€ç¤ºï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥å‘æ˜ç‰©ç†æ¦‚å¿µã€‚å…¶æ€è·¯æ˜¯ä»å®éªŒæ•°æ®å­¦åˆ°è¡¨ç¤ºï¼Œç„¶åç”¨å­¦åˆ°çš„è¡¨ç¤ºæ¥å›ç­”ç‰©ç†é—®é¢˜ï¼Œç”±æ­¤ç‰©ç†æ¦‚å¿µå¯ä»¥ä»å­¦åˆ°çš„è¡¨ç¤ºæ¥æå–å‡ºã€‚ä½œè€…è¿›è¡Œäº†4ä¸ªå®éªŒï¼š</p>
<ol>
<li>åœ¨é˜»å°¼æŒ¯åŠ¨å®éªŒä¸­ï¼Œæ¨¡å‹å­¦åˆ°äº†ç›¸å…³çš„ç‰©ç†å‚æ•°ï¼›</li>
<li>åœ¨è§’åŠ¨é‡å®ˆæ’å®éªŒä¸­ï¼Œæ¨¡å‹é¢„æµ‹äº†è´¨ç‚¹çš„è¿åŠ¨ï¼›</li>
<li>ç»™å®šé‡å­ç³»ç»Ÿçš„è§‚æµ‹æ•°æ®ï¼Œæ¨¡å‹æ­£ç¡®çš„è¯†åˆ«å‡ºäº†é‡å­çŠ¶æ€çš„è‡ªç”±åº¦ï¼›</li>
<li>ç»™å®šä»åœ°çƒè§‚æµ‹çš„å¤ªé˜³å’Œç«æ˜Ÿçš„ä½ç½®æ—¶é—´åºåˆ—æ•°æ®ï¼Œæ¨¡å‹å‘ç°äº†æ—¥å¿ƒè¯´æ¨¡å‹ã€‚</li>
</ol>
<h1 id="Preliminaries"><a href="#Preliminaries" class="headerlink" title="Preliminaries"></a>Preliminaries</h1><p>ä½œè€…åœ¨é™„å½•ä¸­å¯¹ç¥ç»ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†è¿›è¡Œäº†ä»‹ç»ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œåªæˆªå–äº†ä¸€äº›ç›¸å¯¹å‰æ²¿çš„å†…å®¹ã€‚</p>
<img src="https://i.loli.net/2020/06/25/yh5Wj9AQmd6nsFC.png" style="zoom:67%;" />

<h2 id="Variational-Autoencoders"><a href="#Variational-Autoencoders" class="headerlink" title="Variational Autoencoders"></a>Variational Autoencoders</h2><p>æœ¬æ–‡ç”¨åˆ°çš„æ¨¡å‹åŸºç¡€æ˜¯VAEï¼š</p>
<img src="https://i.loli.net/2020/06/25/zCnYjVEZHdbqAD3.png" style="zoom:67%;" />

<h3 id="Representation-Learning"><a href="#Representation-Learning" class="headerlink" title="Representation Learning"></a>Representation Learning</h3><p><em>Representation learning</em>çš„ä¸»è¦ç›®æ ‡æ˜¯å°†æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªéšå‘é‡ (encoder)ï¼Œä¸ºäº†ä¿è¯éšå‘é‡åŒ…å«äº†æ‰€æœ‰ç›¸å…³ä¿¡æ¯ï¼Œ é‚£ä¹ˆåº”è¯¥èƒ½å¤Ÿä»éšå‘é‡è¿˜åŸåŸæ•°æ® (decoder)ã€‚ä¼ ç»Ÿçš„Autoencoderæ˜¯è¿™ä¸ªæ€æƒ³çš„æœ€ç®€å•å®ç°ï¼Œè€ŒVAEåˆ™å°†AEå’Œ<em>Variational Inference</em>ç»“åˆäº†èµ·æ¥ï¼Œæ˜¯ä¸€ç§ç»å…¸çš„ç”Ÿæˆå¼æ¨¡å‹ã€‚ç°åœ¨å¾ˆå¤šç ”ç©¶å…³æ³¨<em>Disentangled Representation Learning</em>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿæ— ç›‘ç£åœ°å­¦ä¹ æ•°æ®ï¼Œä»ä¸­å­¦åˆ°æœ‰æ„ä¹‰çš„è¡¨ç¤ºã€‚</p>
<h3 id="boldsymbol-beta-VAE"><a href="#boldsymbol-beta-VAE" class="headerlink" title="$\boldsymbol \beta$-VAE"></a>$\boldsymbol \beta$-VAE</h3><p>$\beta$-VAEæ˜¯ä¸€ç§ç‰¹æ®Šçš„VAEï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç»å…¸çš„<em>Disentangled Representation Learning</em>æ¨¡å‹ï¼Œå®ƒå’ŒVAEä¸»è¦çš„åŒºåˆ«æ˜¯å¯¹KLæ•£åº¦ä¸€é¡¹åŠ ä¸Šäº†æƒé‡$\beta$è¿›è¡Œè°ƒèŠ‚ï¼š<br>$$<br>C_\beta(x)=-\left[\mathbb{E}_{z\sim p_\phi(z|x)}\log p_\theta(x|z)\right] + \beta D_\text{KL}\left[p_\phi(z|x)\parallel h(z)\right]<br>$$<br>å¦‚æœå‡è®¾$p_\phi(z|x)=\mathcal{N}(\mu,\sigma)$ï¼Œé‚£ä¹ˆæŸå¤±å‡½æ•°å¯ä»¥è¿›è¡Œç®€åŒ–ï¼š<br>$$<br>C_\beta(x)=\parallel \hat{x} - x \parallel^2_2-\frac{\beta}{2}\left(\sum\limits_i\log(\sigma_i^2)-\mu_i^2-\sigma_i^2\right)+C<br>$$</p>
<h1 id="Network-Structure"><a href="#Network-Structure" class="headerlink" title="Network Structure"></a>Network Structure</h1><h2 id="Network-Structure-SciNet"><a href="#Network-Structure-SciNet" class="headerlink" title="Network Structure: SciNet"></a>Network Structure: <em>SciNet</em></h2><p>æ¨¡ä»¿ç‰©ç†å­¦å®¶å»ºæ¨¡ç‰©ç†é—®é¢˜çš„è¿‡ç¨‹ï¼Œä½œè€…æå‡ºäº†<em>SciNet</em>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="https://i.loli.net/2020/06/25/uWd1lOUFxXgQJ7f.png" style="zoom:67%;" />

<p>ç‰©ç†å­¦å®¶åœ¨å»ºæ¨¡ç‰©ç†é—®é¢˜çš„æ—¶å€™ï¼Œå¾€å¾€æ˜¯ä»ä¸€äº›å®éªŒæ•°æ®å‡ºå‘ï¼Œæ ¹æ®ç‰©ç†å¸¸è¯†æå–æ›´åŠ ç²¾ç»ƒçš„è¡¨ç¤ºï¼Œç„¶åç”¨å­¦åˆ°çš„è¡¨ç¤ºæ¥å›ç­”ç‰©ç†é—®é¢˜ã€‚</p>
<p>å¯¹äºå•çº¯çš„è¾“å…¥è¾“å‡ºé—®é¢˜ï¼Œ<em>SciNet</em>å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ˜ å°„ï¼Œ$F:\mathcal{O}\times\mathcal{Q}\rightarrow\mathcal{A}$ã€‚$\mathcal{O}$æ˜¯å¯èƒ½çš„å®éªŒæ•°æ®é›†åˆï¼Œ$\mathcal{Q}$æ˜¯å¯èƒ½çš„é—®é¢˜é›†åˆï¼Œ$\mathcal{A}$æ˜¯å¯èƒ½çš„ç­”æ¡ˆé›†åˆã€‚å¯ä»¥å°†å…¶åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼šç¼–ç è¿‡ç¨‹$E:\mathcal{O}\rightarrow\mathcal{R}$ä»å®éªŒæ•°æ®å­¦åˆ°è¡¨ç¤ºï¼Œè§£ç è¿‡ç¨‹$D:\mathcal{R}\times \mathcal{Q}\rightarrow \mathcal{A}$æ ¹æ®ç»™å®šçš„é—®é¢˜ä»è¡¨ç¤ºæ¥å›ç­”é—®é¢˜ã€‚ç”±æ­¤ï¼Œ$F(o,q)=D(E(o),q)$ã€‚åœ¨å®ç°æ–¹é¢ï¼Œ<em>SciNet</em>é‡‡ç”¨çš„æ˜¯å…¨è¿æ¥ç½‘ç»œã€‚</p>
<h2 id="Training-and-Testing-SciNet"><a href="#Training-and-Testing-SciNet" class="headerlink" title="Training and Testing SciNet"></a>Training and Testing <em>SciNet</em></h2><p>ç”¨æ¥è®­ç»ƒçš„æ•°æ®å½¢å¼ä¸º$(o,q,a_{cor}(o,q))$ï¼Œè§‚æµ‹$o$å’Œé—®é¢˜$q$åˆ†åˆ«ä»è§‚æµ‹é›†$\mathcal{O}$å’Œé—®é¢˜é›†$\mathcal{Q}$é€‰å‡ºï¼Œ$a_{cor}(o,q)$ä¸ºå¯¹åº”çš„æ­£ç¡®ç­”æ¡ˆã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å‡†ç¡®åº¦å°½é‡é«˜ï¼Œå¹¶ä¸”å­¦åˆ°<em>minimal uncorrelated representations</em>ã€‚ä¸ºæ­¤ï¼Œä½œè€…é‡‡ç”¨<em>disentangling variational autoencoder</em>ä½œä¸ºæ¨¡å‹ã€‚</p>
<h1 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h1><p>åœ¨æ–‡ä¸­ï¼Œä½œè€…è¿›è¡Œäº†4ä¸ªå®éªŒæ¥éªŒè¯æ¨¡å‹çš„æœ‰æ•ˆæ€§ã€‚</p>
<h2 id="Damped-Pendulum"><a href="#Damped-Pendulum" class="headerlink" title="Damped Pendulum"></a>Damped Pendulum</h2><p>é˜»å°¼æŒ¯åŠ¨å®éªŒï¼š</p>
<ul>
<li><p>ä»»åŠ¡ï¼šé¢„æµ‹ä¸€ç»´é˜»å°¼æŒ¯åŠ¨åœ¨ä¸åŒæ—¶é—´çš„ä½ç½®ã€‚</p>
</li>
<li><p>ç‰©ç†æ¨¡å‹ï¼š$-kx-b\dot{x}=m\ddot{x}$ï¼Œ$k$ä¸ºå¼¹æ€§æ¨¡é‡ï¼Œ$b$ä¸ºé˜»å°¼ç³»æ•°ï¼Œé€šè§£ä¸º$x(t)=A_0e^{-\frac{b}{2m}t}\cos(\omega t+\delta_0), \space \omega=\sqrt{\frac{k}{m}}\sqrt{1-\frac{b^2}{4mk}}$</p>
</li>
<li><p>è§‚æµ‹æ•°æ®ï¼šä½ç½®æ—¶é—´åºåˆ—æ•°æ®$o=[x(t_i)]_{i\in{1,\cdots,50}}\in\mathbb{R}^{50}$ï¼Œæ—¶é—´é—´éš”ç›¸ç­‰ï¼Œè´¨é‡$m=1\text{kg}$ï¼ŒæŒ¯å¹…$A_0=1\text{m}$ï¼Œç›¸ä½$\delta_0=0$ï¼Œå¼¹æ€§æ¨¡é‡$k\in[5,10]\text{kg}/\text{s}^2$ï¼Œé˜»å°¼ç³»æ•°$b\in[0.5,1]\text{kg}/\text{s}$ã€‚</p>
</li>
<li><p>é—®é¢˜ï¼šé¢„æµ‹$q=t_\text{pred}\in\mathbb{R}$</p>
</li>
</ul>
<p><img src="https://i.loli.net/2020/06/25/yWGzxo4eFKmABul.png"></p>
<p>éšå˜é‡å¤§å°è®¾ç½®ä¸º3ï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="https://i.loli.net/2020/06/25/Q4PKa3pm2htekqd.png" style="zoom:67%;" />

<p>(b)ä¸­çš„ä¸‰å¹…å›¾åˆ†åˆ«æ˜¯å­¦åˆ°çš„ä¸‰ä¸ªéšå˜é‡å’Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„å‚æ•°$k$å’Œ$b$çš„å…³ç³»å›¾ã€‚ç¬¬ä¸€å¹…å›¾ä¸­å˜é‡$1$ä¸$b$å‡ ä¹å®Œå…¨çº¿æ€§ç›¸å…³ï¼Œä¸$k$åŸºäºçº¿æ€§æ— å…³ï¼Œå˜é‡$2$åªå’Œ$k$ç›¸å…³ã€‚å˜é‡$3$å‡ ä¹ä¸ºä¸€ä¸ªå¸¸æ•°ï¼Œæ•…ä¸æä¾›é¢å¤–çš„ä¿¡æ¯ã€‚ç”±æ­¤ä½œè€…è®¤ä¸º<em>SciNet</em>å­¦åˆ°äº†æˆ‘ä»¬å…³å¿ƒçš„ä¸¤ä¸ªå‚æ•°çš„çŸ¥è¯†ã€‚</p>
<h2 id="Conservation-of-Angular-Momentum"><a href="#Conservation-of-Angular-Momentum" class="headerlink" title="Conservation of Angular Momentum"></a>Conservation of Angular Momentum</h2><p>è§’åŠ¨é‡å®ˆæ’å®éªŒï¼š</p>
<ul>
<li>ä»»åŠ¡ï¼šé¢„æµ‹ä¸€ä¸ªç”±é•¿åº¦ä¸º$r$çš„ç»³å­æ†ç»‘ç€çš„æ—‹è½¬è´¨ç‚¹åœ¨ä½ç½®$(0,r)$ç»ä¸€ä¸ªè‡ªç”±è´¨ç‚¹æ’å‡»åçš„ä½ç½®</li>
<li>ç‰©ç†æ¨¡å‹ï¼šç»™å®šæ’å‡»ä¹‹å‰çš„è§’åŠ¨é‡ï¼Œè‡ªç”±è´¨ç‚¹æ’å‡»ä¹‹åçš„é€Ÿåº¦ï¼Œæ—‹è½¬è´¨ç‚¹åœ¨æ’å‡»ä¹‹ååœ¨æ—¶é—´$t_\text{pred}^\prime$çš„ä½ç½®å¯ä»¥ç”±è§’åŠ¨é‡å®ˆæ’å®šå¾‹ç»™å‡ºï¼š</li>
</ul>
<p>$$<br>J=m_\text{rot}r^2\omega-rm_\text{free}(\mathbf{v}_\text{free})_x=m_\text{rot}r^2\omega^\prime-rm_\text{free}(\mathbf{v}^\prime_\text{free})_x=J^\prime<br>$$</p>
<ul>
<li>è§‚æµ‹æ•°æ®ï¼šåœ¨æ’å‡»ä¹‹å‰ä¸¤ä¸ªè´¨ç‚¹çš„ä½ç½®æ•°æ®$o=[(t_i^\text{rot},q_\text{rot}(t_i^\text{rot})),(t_i^\text{free},q_\text{free}(t_i^\text{free}))]_{i\in{1,\cdots,5}}$ï¼Œè´¨é‡ä¸ºå›ºå®šå€¼ï¼ŒåŠå¾„$r$ä¹Ÿä¸ºå›ºå®šå€¼ã€‚æ•°æ®æ·»åŠ é«˜æ–¯å™ªå£°ã€‚</li>
<li>é—®é¢˜ï¼šé¢„æµ‹æ’å‡»ä¹‹åè‡ªç”±è´¨ç‚¹åœ¨æ—¶é—´$t_\text{pred}^\prime$çš„ä½ç½®</li>
</ul>
<p><img src="https://i.loli.net/2020/06/25/SKfJLxl1QmuzFt9.png"></p>
<p>å®éªŒå®¤æ„å›¾å¦‚ä¸‹ï¼š</p>
<img src="https://i.loli.net/2020/06/25/qimk9ZYBe7UPs3z.png" style="zoom:67%;" />

<p>å®éªŒç»“æœè¡¨æ˜<em>SciNet</em>èƒ½å¤Ÿæ­£ç¡®é¢„æµ‹è´¨ç‚¹æ’å‡»ä¹‹åçš„ä½ç½®ï¼ŒåŒæ—¶å¯¹å™ªéŸ³é²æ£’ã€‚æ ¹æ®(b)ï¼Œéšå˜é‡å’Œè§’åŠ¨é‡å­˜åœ¨çº¿æ€§ç›¸å…³å…³ç³»ï¼Œä½œè€…è®¤ä¸º<em>SciNet</em>å­¦åˆ°äº†å®ˆæ’çš„åŠ¨é‡è¿™ä¸€æ¦‚å¿µã€‚</p>
<h2 id="Representation-of-Qubits"><a href="#Representation-of-Qubits" class="headerlink" title="Representation of Qubits"></a>Representation of Qubits</h2><p>é‡å­æ¯”ç‰¹å®éªŒï¼š</p>
<ul>
<li>ä»»åŠ¡ï¼šé¢„æµ‹åœ¨$n=1,2$çš„çº¯$n$é‡å­ä½çŠ¶æ€$\psi\in\mathbb{C}^{2^n}$ä¸‹ä»»ä½•äºŒè¿›åˆ¶æŠ•å½±æµ‹é‡$\omega\in\mathbb{C}^{2^n}$çš„æµ‹é‡æ¦‚ç‡ã€‚</li>
<li>ç‰©ç†æ¨¡å‹ï¼šåœ¨æ‰§è¡Œæµ‹é‡$\omega\in\mathbb{C}^{2^n}$çš„çŠ¶æ€$\psi\in\mathbb{C}^{2^n}$ä¸‹æµ‹é‡0çš„æ¦‚ç‡$p(\omega,\psi)$ç”±$p(\omega,\psi)=|\left&lt;\omega,\psi\right&gt;|^2$ç»™å®š</li>
<li>è§‚æµ‹æ•°æ®ï¼šçŠ¶æ€$\psi: o=[p(\alpha_i,\psi)]_{i\in{i,\cdots,n_1}}$çš„æ“ä½œå‚æ•°åŒ–ï¼šè¡¨ç¤ºä¸€ç»„å›ºå®šçš„éšæœºäºŒå…ƒå°„å½±æµ‹é‡å€¼$\mathcal{M}_1={\alpha_1,\cdots,\alpha_{n_1}}$ï¼ˆä¸€ä¸ªé‡å­ä½$n_1 = 10$ï¼Œä¸¤ä¸ªé‡å­ä½$n_1 = 30$ï¼‰</li>
<li>é—®é¢˜ï¼šå¯¹äºå›ºå®šçš„ä¸€ç»„éšæœºäºŒå…ƒå°„å½±æµ‹é‡$\mathcal{M}<em>2={\beta_1,\cdots,\beta_{n_2}}$ï¼Œæµ‹é‡$\omega:q=[p(\beta_i,\omega)]</em>{i\in{1,\cdots,n_2}}$çš„Operationalå‚æ•°åŒ–ï¼ˆä¸€ä¸ªé‡å­ä½$n_2 = 10$ï¼Œä¸¤ä¸ªé‡å­ä½$n_2 = 30$ï¼‰</li>
</ul>
<p><img src="https://i.loli.net/2020/06/25/8lY1LBsQCZUwX2I.png"></p>
<p>å®éªŒç»“æœå¦‚ä¸‹ï¼š</p>
<img src="https://i.loli.net/2020/06/25/ZTRKfzb63Jrvk5C.png" style="zoom:67%;" />

<p>é€šè¿‡å®éªŒå‘ç°ï¼Œ<em>SciNet</em>å¯ä»¥åœ¨ä¸æä¾›å…ˆéªŒç‰©ç†çŸ¥è¯†çš„æ¡ä»¶ä¸‹ç¡®å®šè¡¨è¿°çŠ¶æ€$\psi$æœ€å°çš„å‚æ•°æ•°é‡ã€‚åŒæ—¶ï¼Œ<em>SciNet</em>è¿˜èƒ½åˆ†è¾¨<em>tomographically complete</em>å’Œ<em>tomographically incomplete</em>ã€‚</p>
<h2 id="Heliocentric-Model-of-the-Solar-System"><a href="#Heliocentric-Model-of-the-Solar-System" class="headerlink" title="Heliocentric Model of the Solar System"></a>Heliocentric Model of the Solar System</h2><p>æ—¥å¿ƒè¯´æ¨¡å‹ï¼š</p>
<ul>
<li>é—®é¢˜ï¼šåœ¨ç»™å®šåˆå§‹æ¡ä»¶ä¸‹é¢„æµ‹ç›¸å¯¹ä¸åœ°çƒçš„å¤ªé˜³å’Œç«æ˜Ÿçš„è§’åº¦$\theta_M(t)$å’Œ$\theta_S(t)$</li>
<li>ç‰©ç†æ¨¡å‹ï¼šåœ°çƒå’Œç«æ˜Ÿå›´ç»•å¤ªé˜³ä»¥ä¸€å®šè§’é€Ÿåº¦åšè¿‘ä¼¼åœ†å‘¨è¿åŠ¨</li>
<li>è§‚æµ‹æ•°æ®ï¼šç»™å®šåˆå§‹è§’åº¦ï¼Œéšæœºé€‰æ‹©å‘¨å‘¨æœŸçš„å“¥ç™½å°¼çš„è§‚æµ‹æ•°æ®</li>
</ul>
<p><img src="https://i.loli.net/2020/06/25/vXl3Ae4RpzibrmY.png"></p>
<p>æ¨¡å‹çš„å®ç°ç¨æœ‰å˜åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="https://i.loli.net/2020/06/25/XnsYqcRS6izZGEm.png" style="zoom:67%;" />

<p>è¿™æ ·ï¼Œå¯¹äºä¸åŒæ—¶é—´éƒ½å¯¹åº”ä¸€ä¸ªéšå˜é‡$r(t_i)$ï¼Œè€Œä¸”éšå˜é‡æ˜¯æ—¶é—´ä¾èµ–çš„ï¼Œå¯¹äºä¸€ä¸ªéšå˜é‡$r(t_i)$æœ‰ä¸€ä¸ªè§£ç å™¨æ¥è¾“å‡ºç­”æ¡ˆã€‚</p>
<img src="https://i.loli.net/2020/06/25/az3UmkchyFWevP7.png" style="zoom:67%;" />

<p>å®éªŒç»“æœè¡¨ç¤ºï¼Œ<em>SciNet</em>ä¸ä»…æ­£ç¡®é¢„æµ‹äº†å¤ªé˜³å’Œç«æ˜Ÿç›¸å¯¹åœ°çƒçš„è§’åº¦ï¼ŒåŒæ—¶éšå˜é‡æ­ç¤ºäº†ç«æ˜Ÿå’Œåœ°çƒç›¸å¯¹å¤ªé˜³çš„è§’åº¦ã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-02-27T12:02:18.000Z" title="2020-2-27 8:02:18 â”œF10: PMâ”¤">2020-02-27</time>å‘è¡¨</span><span class="level-item"><time dateTime="2020-06-25T09:01:35.786Z" title="2020-6-25 5:01:35 â”œF10: PMâ”¤">2020-06-25</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/">Transfer Anomaly Detection by Inferring Latent Domain Representations</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>ä½œè€…æå‡ºäº†ä¸€ç§åˆ©ç”¨è¿ç§»å­¦ä¹ æå‡target domainå¼‚å¸¸æ£€æµ‹æ€§èƒ½çš„ç®—æ³•ã€‚æ–‡ä¸­æŒ‡å‡ºç°æœ‰çš„åŸºäºè¿ç§»å­¦ä¹ çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•éœ€è¦å¯¹æ¯ä¸ª target domain è¿›è¡Œå•ç‹¬è®­ç»ƒï¼Œè¿™æ ·åšä¼šå¸¦æ¥å¾ˆå¤§çš„è®¡ç®—å¼€é”€ã€‚æœ¬æ–‡é€šè¿‡<em>latent domain vectors</em>æ¥å®ç°æ— éœ€é‡æ–°è®­ç»ƒçš„å¼‚å¸¸æ£€æµ‹ã€‚<em>latent domain vectors</em>æ˜¯domainçš„ä¸€ç§éšå«è¡¨ç¤ºï¼Œé€šè¿‡è¯¥domainä¸­çš„æ­£å¸¸æ ·æœ¬å¾—åˆ°ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œ<em>anomaly score function</em>é€šè¿‡Auto-encoderå¾—åˆ°ã€‚</p>
<h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1><h2 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h2><p>ä»¤$\mathbf{X}<em>d^+:={\mathbf{x}^+</em>{dn}}^{N^+<em>d}</em>{n=1}$ä¸ºç¬¬$d$ä¸ªdomainçš„å¼‚å¸¸æ ·æœ¬é›†ï¼Œ$\mathbf{x}_{dn}^+\in\mathbb{R}^M$ä¸ºå…¶ä¸­ç¬¬$n$ä¸ªæ ·æœ¬çš„$M$ç»´ç‰¹å¾å‘é‡ï¼Œ$N^+_d$ä¸ºç¬¬$d$ä¸ªdomainå¼‚å¸¸æ ·æœ¬çš„æ•°é‡ã€‚</p>
<p>ç±»ä¼¼çš„ï¼Œä»¤$\mathbf{X}<em>d^-:={\mathbf{x}^-</em>{dn}}^{N^-<em>d}</em>{n=1}$ä¸ºç¬¬$d$ä¸ªdomainçš„æ­£å¸¸æ ·æœ¬é›†ã€‚æˆ‘ä»¬å‡è®¾å¯¹äºæ¯ä¸ªdomainéƒ½æœ‰$N^+_d\ll N^-_d$ï¼Œä¸”ç‰¹å¾å‘é‡ç»´åº¦éƒ½ä¸º$M$ã€‚</p>
<p>å‡è®¾åœ¨ source domain $D_S$éƒ½æœ‰æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬ï¼Œè®°ä¸º${\mathbf{X}^+<em>d\cup\mathbf{X}_d^-}^{D_S}</em>{d=1}$ï¼Œåœ¨ target domain $D_T$åªæœ‰æ­£å¸¸æ ·æœ¬${\mathbf{X}<em>d^-}^{D_S+D_T}</em>{d=D_S+1}$ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¾—åˆ°ä¸€ä¸ªå¯¹äº target domain åˆé€‚çš„ domain-specific çš„å¼‚å¸¸æ‰“åˆ†å‡½æ•°ã€‚</p>
<img src="https://i.loli.net/2020/06/25/KW2YgScfVZN7Fjz.png" style="zoom:67%;" />

<h2 id="Domain-specific-Anomaly-Score-Function"><a href="#Domain-specific-Anomaly-Score-Function" class="headerlink" title="Domain-specific Anomaly Score Function"></a>Domain-specific Anomaly Score Function</h2><p>æˆ‘ä»¬åŸºäºAuto-encoderå®šä¹‰å¼‚å¸¸æ‰“åˆ†å‡½æ•°ã€‚å¯¹äºæ¯ä¸ªdomainï¼Œæˆ‘ä»¬å‡è®¾å­˜åœ¨ä¸€ä¸ª$K$ç»´çš„éšå˜é‡$\mathbf{z}<em>d\in\mathbb{R}^K$ã€‚å¯¹äºç¬¬$d$ä¸ª domainï¼Œå¼‚å¸¸æ‰“åˆ†å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š<br>$$<br>s_\theta(\mathbf{x}_{dn}|\mathbf{z}<em>d):=\parallel\mathbf{x}</em>{dn}-G</em>{\theta_G}(F_{\theta_F}(\mathbf{x}_{dn},\mathbf{z}_d))\parallel^2<br>$$<br>å…¶ä¸­å‚æ•°$\theta:=(\theta_G,\theta_F)$åœ¨æ‰€æœ‰ domain ä¹‹é—´å…±äº«ã€‚</p>
<h2 id="Models-for-Latent-Domain-Vectors"><a href="#Models-for-Latent-Domain-Vectors" class="headerlink" title="Models for Latent Domain Vectors"></a>Models for Latent Domain Vectors</h2><p>éšå˜é‡$\mathbf{z}_d$æ˜¯æ— æ³•è§‚æµ‹åˆ°çš„ï¼Œåªèƒ½é€šè¿‡æ•°æ®æ¥ä¼°è®¡ã€‚é¦–å…ˆ$\mathbf{z}_d$åœ¨$\mathbf{X}_d^-$æ¡ä»¶ä¸‹çš„æ¡ä»¶åˆ†å¸ƒå‡è®¾ä¸ºé«˜æ–¯åˆ†å¸ƒï¼š</p>
<p>$$<br>q_\theta(\mathbf{z}<em>d|\mathbf{X}_d^-):=\mathcal{N}(\mathbf{z}_d|\mu_\phi(\mathbf{X}_d^-),\text{diag}(\sigma_\phi^2(\mathbf{X}_d^-)))<br>$$<br>å…¶ä¸­å‡å€¼$\mu_\phi(\mathbf{X}_d^-)\in\mathbb{R}^K$å’Œæ–¹å·®$\sigma^2_\phi(\mathbf{X}_d^-)\in\mathbb{R}^K</em>+$ç”±ç¥ç»ç½‘ç»œå»ºæ¨¡ï¼Œä¸”åœ¨æ‰€æœ‰ domain ä¹‹é—´å…±äº«ã€‚åœ¨$\mathbf{X}_d^-$ç»™å®šçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¾¿èƒ½å¤Ÿæ¨æ–­å‡ºè¯¥ domain å¯¹åº”çš„éšå˜é‡ï¼Œ</p>
<p>$q_\phi$çš„è¾“å…¥ä¸ºæ­£å¸¸æ ·æœ¬çš„é›†åˆï¼Œæ•…ç¥ç»ç½‘ç»œéœ€è¦æ»¡è¶³<em>permutation invariant</em>ã€‚$\tau(\mathbf{X}<em>d^-)=\rho(\sum</em>{n=1}^{N_d^-}\eta(\mathbf{x}_{dn}^-))$ï¼Œå…¶ä¸­$\tau(\mathbf{X}_d^-)$è¡¨ç¤º$\mu_\phi(\mathbf{X_d^-})$æˆ–$\ln\sigma_\phi^2(\mathbf{X}_d^-)$ï¼Œ$\rho$å’Œ$\eta$ä¸ºç¥ç»ç½‘ç»œï¼Œ</p>
<h2 id="Objective-Function"><a href="#Objective-Function" class="headerlink" title="Objective Function"></a>Objective Function</h2><p>ç›®æ ‡å‡½æ•°ç”±anomaly scoreå‡½æ•°å’Œéšå˜é‡ç»„æˆã€‚ç¬¬$d$ä¸ªdomainåœ¨å¯¹åº”çš„éšå˜é‡$\mathbf{z}_d$æ¡ä»¶ä¸‹çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p>
<p>$$<br>L_d(\theta|\mathbf{z}<em>d):=\frac{1}{N_d^-}\sum\limits_{n=1}^{N_d^-}s_\theta(\mathbf{x}</em>{dn}^-|\mathbf{z}<em>d)-\frac{\lambda}{N_d^-N_d^+}\sum\limits</em>{n,m=1}^{N_d^-,N_d^+}f(s_\theta(\mathbf{x}<em>{dm}^+|\mathbf{z}_d)-s_\theta(\mathbf{x}</em>{dn}^-|\mathbf{z}_d))<br>$$</p>
<p>å…¶ä¸­$\lambda\geq 0$ä¸ºè¶…å‚æ•°ï¼Œ$f$ä¸ºsigmoidå‡½æ•°ã€‚å…¬å¼çš„ç¬¬ä¸€é¡¹è¡¨ç¤ºç¬¬$d$ä¸ªdomainæ­£å¸¸æ ·æœ¬å¯¹åº”çš„<em>anomaly score</em>ã€‚ç¬¬äºŒé¡¹ä¸ºå¯å¾®åˆ†çš„AUCã€‚å¼‚å¸¸æ ·æœ¬çš„<em>anomaly score</em>åº”å½“å¤§äºæ­£å¸¸æ ·æœ¬ï¼Œæ‰€ä»¥å¯¹ä»»ä½•$\mathbf x_{dm}^+\in\mathbf X_d^+, \mathbf x_{dn}^-\in\mathbf X_d^-$æœ‰$s_\theta(\mathbf x_{dm}^+|\mathbf z_d)&gt;s_\theta(\mathbf x_{dn}^-|\mathbf z_d)$ã€‚ç¬¬äºŒé¡¹$\frac{\lambda}{N_d^-N_d^+}\sum\limits_{n,m=1}^{N_d^-,N_d^+}f(s_\theta(\mathbf{x}<em>{dm}^+|\mathbf{z}_d)-s_\theta(\mathbf{x}</em>{dn}^-|\mathbf{z}<em>d))$çš„å–å€¼èŒƒå›´æ˜¯$[0,1]$ï¼Œå½“æ‰€æœ‰çš„$s_\theta(\mathbf{x}_{dm}^+|\mathbf{z}_d)\gg s_\theta(\mathbf{x}</em>{dm}^-|\mathbf{z}<em>d)$æ—¶è¯¥é¡¹ä¸º1ï¼Œå½“æ‰€æœ‰çš„$s_\theta(\mathbf{x}_{dm}^+|\mathbf{z}_d)\ll s_\theta(\mathbf{x}</em>{dm}^-|\mathbf{z}<em>d)$æ—¶è¯¥é¡¹ä¸º0ï¼Œæ‰€ä»¥æœ€å°åŒ–è¯¥é¡¹çš„ç›¸åæ•°ç›¸å½“äºé¼“åŠ±$s_\theta(\mathbf{x}_{dm}^+|\mathbf{z}_d)\gg s_\theta(\mathbf{x}</em>{dm}^-|\mathbf{z}_d)$ã€‚</p>
<p>å› ä¸ºéšå˜é‡$\mathbf z_d$åŒ…å«ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ç›®æ ‡å‡½æ•°é‡Œè€ƒè™‘è¿™ä¸€ç‚¹ï¼š<br>$$<br>\mathcal{L}<em>d(\theta,\phi):=\mathbb{E}</em>{q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)}\left[L_d(\theta|\mathbf{z}_d)\right]+\beta D_\text{KL}(q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)\parallel p(\mathbf{z_d}))<br>$$</p>
<p>ç¬¬ä¸€é¡¹æ˜¯$L_d(\theta|\mathbf z_d)$å…³äº$q_\phi(\mathbf z_d|\mathbf X_d^-)$çš„æœŸæœ›ï¼Œç¬¬äºŒé¡¹æ˜¯$q_\phi(\mathbf z_d|\mathbf X_d^-)$å’Œ$p(\mathbf z_d):=\mathcal{N}(\boldsymbol 0,\boldsymbol I)$çš„KLæ•£åº¦ã€‚ç¬¬ä¸€é¡¹å¯ä»¥ç”¨<em>monte carlo</em>ä¼°è®¡$\mathbb{E}_{q_\phi(\mathbf{z}_d|\mathbf{X}<em>d^-)}\left[L_d(\theta|\mathbf{z}_d)\right]\approx\frac{1}{L}\sum</em>{\ell=1}^L L_d(\theta|\mathbf z_d^{(\ell)})$ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜éœ€è¦ç”¨åˆ°<em>reparametrization trick</em>ã€‚</p>
<p>å¯¹äºç¬¬$d$ä¸ªtarget domainï¼Œå› ä¸ºæ²¡æœ‰å¼‚å¸¸æ ·æœ¬ï¼ˆå‡è®¾ï¼‰ï¼Œæ‰€ä»¥$L_d(\theta|\mathbf{z}<em>d):=\frac{1}{N_d^-}\sum\limits_{n=1}^{N_d^-}s_\theta(\mathbf{x}</em>{dn}^-|\mathbf{z}<em>d)$ï¼Œæœ‰ï¼š<br>$$<br>\mathcal{L}<em>d(\theta,\phi):=\mathbb{E}</em>{q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)}\left[\frac{1}{N_d^-}\sum\limits</em>{n=1}^{N_d^-}s_\theta(\mathbf{x}_{dn}^-|\mathbf{z}_d)\right]+\beta D_\text{KL}(q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)\parallel p(\mathbf{z}_d))<br>$$</p>
<p>æ‰€ä»¥æ€»çš„æŸå¤±å‡½æ•°ä¸ºå„domainå¯¹åº”çš„æŸå¤±å‡½æ•°ä¹‹å’Œ$\mathcal{L}(\theta,\phi):=\sum_{d=1}^{D_S+D_T}\alpha_d\mathcal{L}_d(\theta,\phi)$ã€‚</p>
<h2 id="Inference"><a href="#Inference" class="headerlink" title="Inference"></a>Inference</h2><p>è®­ç»ƒå¥½ä¹‹åï¼Œdomain-specificçš„<em>anomaly score</em>å¯ä»¥ç”±ä¸‹å¼è®¡ç®—å‡ºï¼š</p>
<p>$$<br>s(\mathbf{x}<em>{d^\prime}):=\int s</em>{\theta_*}(\mathbf{x_{d^\prime}}|\mathbf{z}<em>{d^\prime})q</em>{\phi_*}(\mathbf{z}<em>{d^\prime}|\mathbf{X}</em>{d^\prime}^-)\mathrm{d}\mathbf{z}<em>{d^\prime}\approx\frac{1}{L}\sum\limits</em>{\ell=1}^L s_{\theta_*}(\mathbf{x}<em>{d^\prime}|\mathbf{z}</em>{d^\prime}^{(\ell)})<br>$$</p>
<h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h2><p>å®éªŒåŒ…å«äº”ä¸ªæ•°æ®é›†ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆæˆæ•°æ®é›†ã€‚å¦‚ä¸‹å›¾(a)æ‰€ç¤ºï¼Œå›´ç»•$(0,0)$æœ‰$8$ä¸ªåœˆï¼Œæ¯ä¸ªåœˆåŒ…å«äº†ä¸€ä¸ªå†…åœˆä½œä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œç¬¬$7$ä¸ªåœˆè¢«é€‰ä¸ºtarget domainï¼Œå…¶ä½™çš„ä¸ºsource domainã€‚ç¬¬äºŒä¸ªæ˜¯MNIST-rï¼Œæ˜¯åŠ å…¥æ—‹è½¬çš„MNISTï¼ŒåŒ…å«6ä¸ªdomainï¼Œå…¶ä¸­æ•°å­—â€œ4â€è¢«é€‰ä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œå…¶ä½™ä¸ºæ­£å¸¸ã€‚ç¬¬ä¸‰ä¸ªä¸ºAnuran Callsï¼ŒåŒ…å«5ä¸ªdomainã€‚ç¬¬å››ä¸ªæ˜¯Landmineï¼Œä¸»è¦ç”¨åœ¨å¤šä»»åŠ¡å­¦ä¹ ä¸­ã€‚ç¬¬äº”ä¸ªæ˜¯IoTï¼Œç½‘ç»œæµé‡æ•°æ®ï¼ŒåŒ…å«8ä¸ªdomainã€‚</p>
<img src="https://i.loli.net/2020/06/25/6WLAfMwJPuN5Ov9.png" style="zoom:50%;" />

<h2 id="Comparison-Methods"><a href="#Comparison-Methods" class="headerlink" title="Comparison Methods"></a>Comparison Methods</h2><p>å¯¹æ¯”çš„baselineåŒ…æ‹¬NNï¼ˆæ™®é€šå¤šå±‚ç¥ç»ç½‘ç»œï¼‰ï¼ŒNNAUCï¼ˆåŠ å…¥å¯å¾®åˆ†AUCä½œä¸ºæŸå¤±å‡½æ•°ï¼‰ï¼ŒAEï¼ˆæ™®é€šAutoencoerï¼‰ï¼ŒAEAUCï¼ˆåŠ å…¥å¯å¾®åˆ†AUCçš„AEï¼‰ï¼ŒOSVMï¼ˆå•ç±»æ”¯æŒå‘é‡æœºï¼‰ï¼ŒCCSAï¼ŒTOSVMå’ŒOTLã€‚</p>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>4ä¸ªçœŸå®æ•°æ®é›†çš„ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="https://i.loli.net/2020/06/25/nfkwTVexRNqyFMY.png" style="zoom:50%;" />

<img src="https://i.loli.net/2020/06/25/QaMskTZALyeiFI1.png" style="zoom:50%;" />

<img src="https://i.loli.net/2020/06/25/F7VTyeHMz8mK2uJ.png" style="zoom:50%;" />

<img src="https://i.loli.net/2020/06/25/B32UmgXcwGhZYk1.png" style="zoom:50%;" />

<p>è¡¨5ä¸ºè€ƒè™‘éšå˜é‡ä¸ç¡®å®šæ€§çš„ablation studyã€‚å°†åŸæ¥çš„å…¬å¼$\mathcal{L}<em>d(\theta,\phi):=\mathbb{E}</em>{q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)}\left[L_d(\theta|\mathbf{z}_d)\right]+\beta D_\text{KL}(q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)\parallel p(\mathbf{z_d}))$ä¸­$q_\phi(\mathbf z_d|\mathbf X_d^-)$ç”¨è¿ªåˆ©å…‹é›·åˆ†å¸ƒ$q_\phi(\mathbf z_d|\mathbf X_d^-)=\delta(\mathbf z_d-\mu_\phi(\mathbf X_d^-))$ä»£æ›¿å¹¶ä¸”å»æ‰KLæ•£åº¦ã€‚</p>
<img src="https://i.loli.net/2020/06/25/yUHcTBzixsMlY7f.png" style="zoom: 50%;" />

<p>è¡¨6å±•ç¤ºäº†ä¸åŒå¼‚å¸¸æ¯”ä¾‹å¯¹æ•ˆæœçš„å½±å“ã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-02-24T02:45:08.000Z" title="2020-2-24 10:45:08 â”œF10: AMâ”¤">2020-02-24</time>å‘è¡¨</span><span class="level-item"><time dateTime="2020-06-25T05:30:55.514Z" title="2020-6-25 1:30:55 â”œF10: PMâ”¤">2020-06-25</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/">Deep Anomaly Detection with Deviation Networks</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡å…³æ³¨<code>Deep Anomaly Detection</code>ï¼Œä¹Ÿå°±æ˜¯ç”¨æ·±åº¦å­¦ä¹ çš„æ–¹æ³•æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€‚æ–‡ä¸­æåˆ°ç°æœ‰çš„<code>Deep Anomaly Detection</code>å­˜åœ¨ä¸¤ä¸ªå¼Šç«¯ï¼šä¸€ä¸ªæ˜¯é‡‡ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•æ¥è¿›è¡Œç‰¹å¾å­¦ä¹ ï¼Œç„¶åé€šè¿‡ä¸‹æ¸¸ä»»åŠ¡å¾—åˆ°<code>Anomaly Score</code>ï¼Œç›¸æ¯”æ–‡ä¸­End-to-Endçš„<code>Anomaly Score</code>å­¦ä¹ ï¼Œå­˜åœ¨ä¼˜åŒ–ä¸å……åˆ†çš„é£é™©ï¼›å¦ä¸€ä¸ªæ˜¯ç°æœ‰çš„æ–¹æ³•ä¸»è¦æ˜¯æ— ç›‘ç£å­¦ä¹ ï¼Œæ— æ³•åˆ©ç”¨å·²çŸ¥çš„ä¿¡æ¯ï¼ˆå¦‚å°‘é‡æ ‡ç­¾ï¼‰ã€‚ä¸ºæ­¤ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œæ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p>
<p>æœ¬æ–‡çš„ä¸»è¦è´¡çŒ®å¦‚ä¸‹ï¼š</p>
<ul>
<li>æå‡ºäº†ä¸€ç§ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œç›´æ¥å­¦ä¹ <code>Anomaly Score</code>å¹¶ä¸”å¯ä»¥åˆ©ç”¨å·²çŸ¥ä¿¡æ¯ï¼›</li>
<li>åŸºäºæå‡ºçš„æ¡†æ¶ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ç§å®ä¾‹æ–¹æ³• (DevNet)ã€‚</li>
</ul>
<img src="https://i.loli.net/2020/06/25/XT7fqQRWEOuocgy.png" style="zoom:67%;" />

<h1 id="Proposed-Model"><a href="#Proposed-Model" class="headerlink" title="Proposed Model"></a>Proposed Model</h1><h2 id="End-To-End-Anomaly-Score-Learning"><a href="#End-To-End-Anomaly-Score-Learning" class="headerlink" title="End-To-End Anomaly Score Learning"></a>End-To-End Anomaly Score Learning</h2><h3 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h3><p>ä¸ºäº†åŒºåˆ«äºä¼ ç»Ÿçš„ä¸¤é˜¶æ®µå¼‚å¸¸æ£€æµ‹ï¼ˆå…ˆå­¦ä¹ ç‰¹å¾è¡¨ç¤ºï¼Œç„¶ååœ¨å­¦åˆ°çš„ç‰¹å¾ä¸Šå®šä¹‰ä¸€ä¸ª<code>anomaly measure</code>æ¥å¾—åˆ°<code>anomaly score</code>ï¼‰ï¼Œä½œè€…å¯¹ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜é‡æ–°è¿›è¡Œå½¢å¼åŒ–ã€‚</p>
<p>ç»™å®š$N+K$ä¸ªæ ·æœ¬$\mathcal{X}={\boldsymbol x_1,\boldsymbol x_2,\cdots,\boldsymbol x_N,\boldsymbol x_{N+1},\cdots,\boldsymbol x_{N+K}}$ï¼Œå…¶ä¸­$\boldsymbol x_i\in\mathbb{R}^D$ï¼Œæ— æ ‡ç­¾æ ·æœ¬é›†$\mathcal{U}={\boldsymbol x_1,\boldsymbol x_2,\cdots,\boldsymbol x_N}$ï¼Œæœ‰æ ‡ç­¾æ ·æœ¬é›†$\mathcal{K}={\boldsymbol x_{N+1},\cdots,\boldsymbol x_{N+K}}$ï¼Œä¸”$K\ll N$ã€‚å¼‚å¸¸æ£€æµ‹çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ª<code>anomaly scoring function</code>$\phi:\mathcal{X}\mapsto\mathbb{R}$ä½¿å¾—$\phi(\boldsymbol x_i)&gt;\phi(\boldsymbol x_j)$ï¼Œå…¶ä¸­$\boldsymbol x_i$ä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œ$\boldsymbol x_j$ä¸ºæ­£å¸¸æ ·æœ¬ã€‚</p>
<h3 id="The-Proposed-Framework"><a href="#The-Proposed-Framework" class="headerlink" title="The Proposed Framework"></a>The Proposed Framework</h3><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ç§é€šç”¨å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œæ¨¡å‹æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p>æ¨¡å‹æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="https://i.loli.net/2020/06/25/ZuE1mb2Ytv6Jdl7.png" style="zoom:50%;" />

<p>ä¸»è¦åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li><em>anomaly scoring network</em>. å›¾ä¸­å·¦è¾¹çš„éƒ¨åˆ†ï¼Œä¸€ä¸ªå‡½æ•°$\phi$ï¼Œè¾“å…¥æ ·æœ¬$\mathbf{x}$ï¼Œè¾“å‡º<code>anomaly score</code></li>
<li><em>reference score generator</em>. å›¾ä¸­å³è¾¹çš„éƒ¨åˆ†ã€‚åªæœ‰ä¸€ä¸ª<em>anomaly scoring network</em>å¹¶ä¸èƒ½è¿›è¡Œè®­ç»ƒï¼Œéœ€è¦è®­ç»ƒçš„ç›®æ ‡ã€‚ä¸ºæ­¤åŠ å…¥<em>reference score generator</em>ï¼Œè¾“å…¥ä¸ºéšæœºé€‰æ‹©çš„$l$ä¸ªæ­£å¸¸æ ·æœ¬ï¼Œè¾“å‡º<code>reference score</code>ï¼ˆè¿™$l$ä¸ªæ­£å¸¸æ ·æœ¬<code>anomaly score</code>çš„å‡å€¼ï¼Œè®°ä¸º$\mu_\mathcal{R}$ï¼‰</li>
<li><em>deviation loss</em>. $\phi(\mathbf{x})$ï¼Œ$\mu_\mathcal{R}$åŠå¯¹åº”çš„æ ‡å‡†å·®$\sigma_\mathcal{R}$ä½œä¸º<code>deviation loss</code>å‡½æ•°çš„è¾“å…¥ã€‚å› ä¸º$\mu_\mathcal{R}$å’Œ$\sigma_\mathcal{R}$å¯¹åº”æ­£å¸¸æ ·æœ¬é›†çš„å‡å€¼å’Œæ–¹å·®ï¼Œé‚£ä¹ˆå¼‚å¸¸æ ·æœ¬çš„<code>anomaly score</code>åº”è¯¥å’Œ$\mu_\mathcal{R}$å·®åˆ«æ¯”è¾ƒå¤§ï¼Œè€Œæ­£å¸¸æ ·æœ¬åˆ™åº”è¯¥æ¥è¿‘$\mu_\mathcal{R}$ã€‚</li>
</ol>
<h2 id="Deviation-Networks"><a href="#Deviation-Networks" class="headerlink" title="Deviation Networks"></a>Deviation Networks</h2><p>ä¸‹é¢æ˜¯ä¸Šè¿°ä¸‰ä¸ªéƒ¨ä»¶çš„å…·ä½“å®ç°ã€‚</p>
<h3 id="End-To-End-Anomaly-Scoring-Network"><a href="#End-To-End-Anomaly-Scoring-Network" class="headerlink" title="End-To-End Anomaly Scoring Network"></a>End-To-End Anomaly Scoring Network</h3><p>è®°$\mathcal{Q}\in\mathbb{R}^M$ä¸ºä¸­é—´è¡¨ç¤ºç©ºé—´ï¼Œ<code>anomaly scoring network</code>$\phi(\cdot;\Theta):\mathcal{X}\mapsto\mathbb{R}$å¯ä»¥å®šä¹‰ä¸ºæ•°æ®è¡¨ç¤ºå­¦ä¹ $\psi(\cdot;\Theta_t):\mathcal{X}\mapsto\mathcal{Q}$å’Œå¼‚å¸¸åˆ†æ•°å­¦ä¹ $\eta(\cdot;\Theta_s):\mathcal{Q}\mapsto\mathbb{R}$ä¸¤é˜¶æ®µçš„ç»„åˆï¼Œå…¶ä¸­$\Theta={\Theta_t,\Theta_s}$ã€‚</p>
<p>$\psi(\cdot;\Theta_t)$å¯ä»¥ç”¨ä¸€ä¸ª$H$å±‚ç¥ç»ç½‘ç»œæ¥å®ç°ï¼š<br>$$<br>\mathrm{q}=\psi(\mathbf{x};\Theta_t)<br>$$<br>å…¶ä¸­$\mathbf{x}\in\mathcal{X}$ï¼Œ$\mathrm{q}\in\mathcal{Q}$ã€‚</p>
<p>$\eta(\cdot;\Theta_s)$å¯ä»¥ç”¨ä¸€ä¸ªå•å±‚çš„ç¥ç»ç½‘ç»œæ¥å®ç°ï¼š<br>$$<br>\eta(\mathrm q;\Theta_s)=\sum\limits_{i=1}^M w_i^oq_i+w_{M+1}^o<br>$$<br>å…¶ä¸­$\mathrm q\in\mathcal Q$ï¼Œ$\Theta_s={\mathbf{w}^o}$ã€‚</p>
<p>æ‰€ä»¥æœ‰ï¼š<br>$$<br>\phi(\mathbf{x};\Theta)=\eta(\psi(\mathbf{x};\Theta_t);\Theta_s)<br>$$</p>
<h3 id="Gaussian-Prior-based-Reference-Scores"><a href="#Gaussian-Prior-based-Reference-Scores" class="headerlink" title="Gaussian Prior-based Reference Scores"></a>Gaussian Prior-based Reference Scores</h3><p>æœ‰ä¸¤ç§æ–¹æ³•æ¥è·å¾—$\mu_\mathcal{R}$ï¼Œä¸€ç§æ˜¯data-drivenï¼Œä¸€ç§æ˜¯prior-drivenã€‚å¦‚æœæ˜¯data-drivençš„è¯åˆ™é‡‡ç”¨å¦ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œæ–‡ä¸­è¡¨ç¤ºä¸ºäº†æ›´å¥½çš„è§£é‡Šæ€§å’Œè®¡ç®—æ•ˆç‡ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ˜¯prior-drivenã€‚<br>$$<br>\begin{align}<br>r_1,r_2,\cdots,r_l\sim \mathcal{N}(\mu,\sigma^2),\<br>\mu_\mathcal{R}=\frac{1}{l}\sum\limits_{i=1}^l r_i<br>\end{align}<br>$$<br>åœ¨æ–‡ä¸­ï¼Œé‡‡ç”¨çš„prioræ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒã€‚</p>
<h2 id="Z-Score-Based-Deviation-Loss"><a href="#Z-Score-Based-Deviation-Loss" class="headerlink" title="Z-Score Based Deviation Loss"></a>Z-Score Based Deviation Loss</h2><p><em>anomaly scoring network</em>çš„ä¼˜åŒ–ç›®æ ‡å¯ä»¥å®šä¹‰ä¸ºZ-Scoreçš„æ–¹å¼ï¼š<br>$$<br>dev(\boldsymbol x)=\frac{\phi(\boldsymbol x;\Theta)-\mu_{\mathcal{R}}}{\sigma_{\mathcal{R}}}<br>$$<br>$dev(\boldsymbol x)$å¯ä»¥çœ‹ä½œæ˜¯æ ·æœ¬åç¦»æ ‡å‡†çš„ç¨‹åº¦ï¼Œè€Œæˆ‘ä»¬è‚¯å®šå¸Œæœ›å¼‚å¸¸æ ·æœ¬åç¦»æ ‡å‡†è¶Šå¤§ï¼Œæ­£å¸¸æ ·æœ¬è¶Šæ¥è¿‘æ ‡å‡†ã€‚æ–‡ä¸­é‡‡ç”¨çš„æŸå¤±å‡½æ•°æ˜¯<code>Contrastive Loss</code>ï¼š<br>$$<br>L(\phi(\boldsymbol x;\Theta),\mu_\mathcal{R},\sigma_\mathcal{R})=(1-y)|dev(\boldsymbol x)| + y \max(0, a - dev(\boldsymbol x))<br>$$<br><code>Contrastive Loss</code>çš„ç›´è§‚è§£é‡Šå¯ä»¥çœ‹ä¸‹å›¾ï¼š</p>
<img src="https://i.loli.net/2020/06/25/aPbSipCsk2JwNcD.png" style="zoom: 33%;" />

<p>å¯¹äºè´Ÿä¾‹ï¼ˆæ­£å¸¸ï¼‰ï¼Œä¼˜åŒ–è¿‡ç¨‹å°†ä»–ä»¬å°½é‡å‘åŸç‚¹é è¿‘ï¼Œå¯¹äºæ­£ä¾‹ï¼ˆå¼‚å¸¸ï¼‰ï¼Œä¼˜åŒ–è¿‡ç¨‹å°†ä»–ä»¬æ‹‰å‘è¾¹ç•Œã€‚</p>
<h2 id="The-DevNet-Algorithm"><a href="#The-DevNet-Algorithm" class="headerlink" title="The DevNet Algorithm"></a>The DevNet Algorithm</h2><p><code>DevNet</code>çš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p>
<img src="https://i.loli.net/2020/06/25/km9H5DoNRbOQ784.png" style="zoom:67%;" />

<h2 id="Interpretability-of-Anomaly-Scores"><a href="#Interpretability-of-Anomaly-Scores" class="headerlink" title="Interpretability of Anomaly Scores"></a>Interpretability of Anomaly Scores</h2><p>å› ä¸º<em>reference score generator</em>é€‰æ‹©çš„æ˜¯ç¡®å®šçš„é«˜æ–¯åˆ†å¸ƒï¼Œäºæ˜¯å¯ä»¥ç”¨æ¦‚ç‡è®ºç»™å‡ºä¸€äº›è§£é‡Šæ€§ã€‚ä½œè€…ç»™å‡ºäº†ä¸€ä¸ªç»“è®ºï¼Œ</p>
<blockquote>
<p><strong>PROPOSITION</strong>ï¼š è®¾$\boldsymbol x\in\mathcal{X}$ï¼Œ$z_p$ä¸º$\mathcal{N}(\mu,\sigma^2)$çš„åˆ†ä½æ•°ï¼Œé‚£ä¹ˆ$\phi(\boldsymbol x)$åœ¨åŒºé—´$\mu\pm z_p\sigma$çš„æ¦‚ç‡ä¸º$2(1-p)$ã€‚</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œå‡è®¾$p=0.95$ï¼Œé‚£ä¹ˆ$z_{0.95}=1.96$ï¼Œè¡¨ç¤ºå¼‚å¸¸åˆ†æ•°é«˜äº1.96çš„æ ·æœ¬å°†ä»¥0.95çš„ç½®ä¿¡åº¦ä¸ºå¼‚å¸¸ã€‚</p>
<h1 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h1><p>å®éªŒç”¨åˆ°äº†9ä¸ªæ•°æ®é›†ï¼Œ4ä¸ªBaseline (REPENï¼ŒDSVDDï¼ŒFSNETï¼ŒiForest)ï¼Œä»¥åŠROCå’ŒPRæ›²çº¿ä¸¤ç§è¯„æµ‹æ ‡å‡†ã€‚</p>
<h2 id="Effectiveness-in-Real-world-Data-Sets"><a href="#Effectiveness-in-Real-world-Data-Sets" class="headerlink" title="Effectiveness in Real-world Data Sets"></a>Effectiveness in Real-world Data Sets</h2><h3 id="Experiment-Settings"><a href="#Experiment-Settings" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h3><p>è¿™ä¸€ä¸ªå®éªŒä¸»è¦æ˜¯ä¸ºäº†éªŒè¯ç®—æ³•åœ¨çœŸå®åœºæ™¯ä¸‹çš„æ•ˆæœï¼Œå³å¤§é‡æ— æ ‡ç­¾æ•°æ®å’Œæå°‘é‡æ ‡ç­¾æ•°æ®ã€‚è®­ç»ƒé›†åŒ…å«ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯æ— æ ‡ç­¾æ•°æ®$\mathcal{U}$,åŒ…å«$2%$çš„å¼‚å¸¸æ ·æœ¬ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æœ‰æ ‡ç­¾æ•°æ®$\mathcal{K}$ï¼Œç”±éšæœºé‡‡æ ·$0.005%-1%$çš„è®­ç»ƒæ•°æ®å’Œ$0.08%-6%$çš„å¼‚å¸¸æ ·æœ¬ç»„æˆã€‚</p>
<h3 id="Findings"><a href="#Findings" class="headerlink" title="Findings"></a>Findings</h3><p>å®éªŒç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<img src="https://i.loli.net/2020/06/25/DKqxJROngML8IS2.png" style="zoom: 50%;" />

<p>ä»ç»“æœä¸Šçœ‹æ¥ï¼Œæœ¬æ–‡æå‡ºçš„æ–¹æ³•åœ¨æ‰€æœ‰æ•°æ®é›†ä¸Šéƒ½æ¯”Baselineå¥½ï¼Œè¯´æ˜<code>DevNet</code>ç«¯åˆ°ç«¯ç›´æ¥ä¼˜åŒ–<code>Anomaly Score</code>çš„æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<h2 id="Data-Efficiency"><a href="#Data-Efficiency" class="headerlink" title="Data Efficiency"></a>Data Efficiency</h2><h3 id="Experiment-Settings-1"><a href="#Experiment-Settings-1" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h3><p>è¿™ä¸€ä¸ªå®éªŒä¸»è¦æ˜¯ä¸ºäº†æ¢ç©¶åŸºäºæ·±åº¦çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„<em>data efficiency</em>ã€‚å’Œä¸Šä¸€ä¸ªå®éªŒä¸€æ ·ï¼Œæ— æ ‡ç­¾æ•°æ®é›†åŒ…å«$2%$çš„å¼‚å¸¸ï¼Œè€Œæœ‰æ ‡ç­¾çš„å¼‚å¸¸æ•°é‡ä»$5$åˆ°$120$ä¸ç­‰ã€‚æœ¬å®éªŒè¯•å›¾å›ç­”ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li><code>DevNet</code>çš„<em>data efficiency</em>å¦‚ä½•ï¼Ÿ</li>
<li>åŸºäºæ·±åº¦çš„æ–¹æ³•åœ¨å¤šå¤§ç¨‹åº¦ä¸Šèƒ½å¤Ÿåˆ©ç”¨æ ‡ç­¾ä¿¡æ¯ï¼Ÿ</li>
</ul>
<h3 id="Findings-1"><a href="#Findings-1" class="headerlink" title="Findings"></a>Findings</h3><p>åœ¨å‡ ä¸ªåŸºäºæ·±åº¦çš„Baselineä¸­ï¼Œ<code>DevNet</code>çš„æ•ˆæœæ˜¯æœ€å¥½çš„ï¼ŒåŒæ—¶åœ¨æœ‰æ ‡ç­¾å¼‚å¸¸éå¸¸æœ‰é™çš„æƒ…å†µä¸‹ï¼Œ<code>DevNet</code>ä¹Ÿèƒ½å¾ˆå¥½çš„åˆ©ç”¨æ ‡ç­¾ä¿¡æ¯ï¼Œè¾¾åˆ°æ›´å¥½çš„æ•ˆæœã€‚</p>
<img src="https://i.loli.net/2020/06/25/iIWGBPosKCuxbRF.png" style="zoom:67%;" />

<h2 id="Robustness-w-r-t-Anomaly-Contamination"><a href="#Robustness-w-r-t-Anomaly-Contamination" class="headerlink" title="Robustness w.r.t. Anomaly Contamination"></a>Robustness w.r.t. Anomaly Contamination</h2><h3 id="Experiment-Settings-2"><a href="#Experiment-Settings-2" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h3><p>åœ¨ç¬¬ä¸€ä¸ªå®éªŒä¸­ï¼Œæ— æ ‡ç­¾æ•°æ®é›†$\mathcal{U}$åŒ…å«çš„æ˜¯å›ºå®šçš„å¼‚å¸¸æ¯”ä¾‹$2%$ï¼Œè€Œåœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½œè€…æµ‹è¯•äº†ä»$0%$åˆ°$20%$ä¹‹é—´ä¸åŒå¼‚å¸¸æ¯”ä¾‹æ¥æµ‹è¯•ç®—æ³•çš„é²æ£’æ€§ï¼ˆå³ä½¿$\mathcal{U}$ä¸­åŒ…å«å¼‚å¸¸ï¼Œç”±äºæ²¡æœ‰æ ‡ç­¾ï¼Œåœ¨è®­ç»ƒçš„æ—¶å€™ä»ç„¶å‡è®¾éƒ½ä¸ºæ­£å¸¸æ¥è¿›è¡Œè®­ç»ƒï¼‰ã€‚æœ¬å®éªŒè¯•å›¾å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>åŸºäºæ·±åº¦çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„é²æ£’æ€§å¦‚ä½•ï¼Ÿ</li>
<li>å½“è®­ç»ƒé›†ä¸­å¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹è¾ƒé«˜çš„æ—¶å€™åŸºäºæ·±åº¦çš„æ–¹æ³•èƒ½å¦æ‰“è´¥æ— ç›‘ç£çš„æ–¹æ³•ï¼Ÿ</li>
</ul>
<h3 id="Findings-2"><a href="#Findings-2" class="headerlink" title="Findings"></a>Findings</h3><p>ä¸‹å›¾ä¸ºå®éªŒç»“æœï¼š</p>
<img src="https://i.loli.net/2020/06/25/JCnIjLOc84RFP2V.png" style="zoom:67%;" />

<p>ä»ç»“æœä¸Šæ¥çœ‹ï¼Œ<code>DevNet</code>æ¯”å…¶ä»–åŸºäºæ·±åº¦çš„æ–¹æ³•é²æ£’æ€§æ›´å¥½ï¼ŒåŒæ—¶åœ¨é«˜å¼‚å¸¸æ±¡æŸ“çš„æƒ…å†µä¸‹ä»ç„¶æ¯”çº¯æ— ç›‘ç£æ–¹æ³•æ•ˆæœè¦å¥½ã€‚</p>
<h2 id="Ablation-Study"><a href="#Ablation-Study" class="headerlink" title="Ablation Study"></a>Ablation Study</h2><p>æœ¬å®éªŒè®¾ç½®äº†<code>DevNet</code>çš„ä¸‰ä¸ªå˜ä½“ï¼ˆé»˜è®¤çš„<code>DevNet-Def</code>ä¸ºå•å±‚éšå±‚åŠ ä¸Šä¸€ä¸ªè¾“å‡ºå±‚ï¼‰æ¥è¿›è¡Œæ¶ˆèå®éªŒï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li><code>DevNet-Rep</code>ï¼Œå»æ‰äº†<em>anomaly scoring network</em>ç½‘ç»œçš„è¾“å‡ºå±‚ï¼Œå¯¹åº”<em>end-to-end learning of anomaly scores</em>å’Œ<em>deviation loss</em>ï¼›</li>
<li><code>DevNet-Linear</code>ï¼Œå»æ‰äº†ç½‘ç»œä¸­çš„éçº¿æ€§å±‚ï¼Œå¯¹åº”<em>learning of non-linear features</em>ï¼›</li>
<li><code>DevNet-3HL</code>ï¼Œéšå±‚æ•°é‡ä¸º3å±‚ã€‚</li>
</ul>
<p>å¯¹æ¯”ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="https://i.loli.net/2020/06/25/5LcyAwGMB8gb2UP.png" style="zoom:67%;" />

<p>é€šè¿‡å®éªŒå¯ä»¥å‘ç°ï¼Œ<code>DevNet-Rep</code>è¯´æ˜äº†<em>end-to-end learning of anomaly scores</em>å’Œ<em>deviation loss</em>çš„æœ‰æ•ˆæ€§ï¼Œè€Œ<code>DevNet-Linear</code>è¯´æ˜äº†<em>learning of non-linear features</em>çš„é‡è¦æ€§ã€‚<code>DevNet-3HL</code>è¯´æ˜äº†åŠ æ·±ç½‘ç»œå¹¶ä¸æ€»èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ã€‚</p>
<h2 id="Scalability-Test"><a href="#Scalability-Test" class="headerlink" title="Scalability Test"></a>Scalability Test</h2><p>è¿™ä¸€ä¸ªå®éªŒä½¿ç”¨åˆæˆçš„æ•°æ®æ¥æµ‹è¯•ç®—æ³•å¯¹å¤§è§„æ¨¡æ•°æ®çš„å¤„ç†èƒ½åŠ›ï¼Œåˆ†åˆ«ä»<em>Data Size</em>å’Œ<em>Data Dimensionality</em>ä¸¤æ–¹é¢æ¥æµ‹è¯•ã€‚ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="https://i.loli.net/2020/06/25/5gbPdJkB47e3FsV.png" style="zoom:67%;" />

<p>å¯ä»¥çœ‹å‡ºï¼Œ<code>DevNet</code>å¯¹<em>Data Size</em>å¹¶ä¸æ•æ„Ÿï¼ŒåŒæ—¶ï¼Œé¢å¯¹é«˜ç»´æ•°æ®ï¼Œ<code>DevNet</code>ä¹Ÿæ²¡æœ‰è¡¨ç°å‡ºåŠ£åŠ¿ã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-01-09T02:15:03.000Z" title="2020-1-9 10:15:03 â”œF10: AMâ”¤">2020-01-09</time>å‘è¡¨</span><span class="level-item"><time dateTime="2020-06-25T05:25:53.385Z" title="2020-6-25 1:25:53 â”œF10: PMâ”¤">2020-06-25</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/">Complementary Set Variational Autoencoder for Supervised Anomaly Detection</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>å¯¹äºå¼‚å¸¸æ£€æµ‹é—®é¢˜ï¼Œå¼‚å¸¸çš„æ¨¡å¼æ˜¯å¤šç§å¤šæ ·çš„ã€‚æœ‰ç›‘ç£æ¨¡å‹èƒ½å¤Ÿè¾ƒå¥½åœ°å¤„ç†è®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„æ¨¡å¼ï¼Œæ— ç›‘ç£æ¨¡å‹èƒ½å¤Ÿå¤„ç†è®­ç»ƒé›†ä¸­æœªå‡ºç°è¿‡çš„æ¨¡å¼ï¼Œä½†å¯¹äºè®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å‹å¹¶æ²¡æœ‰å­¦ä¹ ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§æ—¢èƒ½å­¦ä¹ è®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å¼ï¼ŒåŒæ—¶èƒ½å¤„ç†æœªå‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å¼çš„æ–¹æ³•ã€‚</p>
<h1 id="Proposed-Model"><a href="#Proposed-Model" class="headerlink" title="Proposed Model"></a>Proposed Model</h1><h2 id="Conventional-VAE"><a href="#Conventional-VAE" class="headerlink" title="Conventional VAE"></a>Conventional VAE</h2><p>é¦–å…ˆå›é¡¾ä¸€ä¸‹åŸå§‹çš„VAEã€‚</p>
<p>åŸå§‹VAEä¸­çš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})=\mathbb{E}<em>{q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})}[\log p(\boldsymbol{x}|\boldsymbol{z};\boldsymbol{\theta})]-\text{KL}[q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi}\parallel p(\boldsymbol{z}))]<br>$$<br>åŸæ–‡ä¸­ä½œè€…è¯æ˜äº†$\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\leq\log p(\boldsymbol{x};\boldsymbol{\theta})$ï¼Œæ‰€ä»¥$\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})$å¯ä»¥çœ‹ä½œæ˜¯æ•°æ®åˆ†å¸ƒ$p(\boldsymbol{x})$å¯¹æ•°ä¼¼ç„¶çš„ä¸€ä¸ªä¸‹ç•Œã€‚$\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})$åˆè¢«ç§°ä¸ºè¯æ®ä¸‹ç•Œ (ELBO)ã€‚$\mathbb{E}</em>{q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})}[\log p(\boldsymbol{x}|\boldsymbol{z};\boldsymbol{\theta})]$ä¸­çš„æœŸæœ›ä¸€èˆ¬ç”¨è’™ç‰¹å¡æ´›æ¥è¿›è¡Œä¼°è®¡ï¼š<br>$$<br>\begin{align}<br>\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\simeq&amp; \frac{1}{L}\sum\limits_l\log p(\boldsymbol{x}|\boldsymbol{z}^{(l)};\boldsymbol{\theta})-\text{KL}[q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})\parallel p(\boldsymbol{z})],\<br>\boldsymbol{z}^{(l)}&amp;\sim q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi}), \space l\in{1,2,\cdots,L}<br>\end{align}<br>$$<br>å¯¹äºéšå˜é‡$\boldsymbol{z}$ï¼Œä¸€èˆ¬å‡è®¾å…ˆéªŒæœä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼ŒåéªŒæœä»å‡å€¼ä¸º$\mu$ï¼Œæ–¹å·®ä¸º$\sigma^2$çš„é«˜æ–¯åˆ†å¸ƒï¼Œæ•…KLæ•£åº¦èƒ½ç›´æ¥å†™å‡ºè§£æå¼ï¼š<br>$$<br>\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\simeq \frac{1}{L}\sum\limits_l\log p(\boldsymbol{x}|\boldsymbol{z}^{(l)};\boldsymbol{\theta})-C(-\frac{1}{2}-\log\sigma+\frac{1}{2}\sigma^2+\frac{1}{2}\mu^2)<br>$$<br>ä½¿ç”¨VAEæ¥åšå¼‚å¸¸æ£€æµ‹é€šå¸¸æ˜¯åœ¨æ­£å¸¸æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼Œåœ¨æ£€æµ‹é˜¶æ®µï¼Œå¦‚æœæ˜¯å¼‚å¸¸æ ·æœ¬ï¼Œé‚£ä¹ˆVAEä¸èƒ½å¾ˆå¥½åœ°é‡æ„å®ƒï¼Œè¿™æ ·ä¼šå¯¼è‡´è¾ƒå¤§çš„é‡æ„è¯¯å·®ã€‚</p>
<h2 id="Prior-Distribution-for-Anomalies"><a href="#Prior-Distribution-for-Anomalies" class="headerlink" title="Prior Distribution for Anomalies"></a>Prior Distribution for Anomalies</h2><img src="https://i.loli.net/2020/06/25/vrxAzRVCtaE3oLc.png" style="zoom:67%;" />

<p>åœ¨åŸå§‹VAEå¼‚å¸¸æ£€æµ‹ä¸­ï¼Œæ— è®ºè¾“å…¥æ ·æœ¬$\boldsymbol{x}$æ˜¯å¦å¼‚å¸¸ï¼ŒVAEéƒ½ä¼šä½¿å¯¹åº”ç¼–ç çš„åéªŒ$p(\boldsymbol{z}|\boldsymbol{x})$æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸”æ–½åŠ æ ‡å‡†é«˜æ–¯åˆ†å¸ƒçš„çº¦æŸã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œä½œè€…å¯¹å¼‚å¸¸å’Œæ­£å¸¸æ ·æœ¬å¯¹åº”çš„éšå˜é‡çš„å…ˆéªŒåˆ†å¸ƒåšäº†ä¸åŒå‡è®¾ã€‚é¦–å…ˆï¼Œæ­£å¸¸å…ˆéªŒä¾ç„¶æ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼Œè®°ä¸º$p_n(\boldsymbol{z})$ã€‚è€Œå¯¹äºå¼‚å¸¸å…ˆéªŒï¼Œä½œè€…è®¤ä¸ºå¼‚å¸¸å³ä¸ºâ€œä¸æ­£å¸¸â€ï¼Œå’Œæ­£å¸¸æ˜¯è¡¥é›†çš„å…³ç³»ã€‚ä½œè€…åœ¨æ–‡ä¸­å®šä¹‰å¼‚å¸¸å…ˆéªŒåˆ†å¸ƒ$p_a(\boldsymbol{z})$ä¸ºï¼š<br>$$<br>p_a(\boldsymbol{z})=\frac{1}{Y^\prime}(\max\limits_{\boldsymbol{z}^\prime}p_n(\boldsymbol{z}^\prime)-p_n(\boldsymbol{z}))<br>$$</p>
<p>å…¶ä¸­$Y^\prime$ä¸ºä½¿$p_a(\boldsymbol{z})$æˆä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„è°ƒèŠ‚å› å­ã€‚å®é™…ä¸Šï¼Œ$Y^\prime$å¾€å¾€ä¼šæˆä¸ºæ— é™å¤§ï¼Œå› ä¸º$p(\boldsymbol z)$åœ¨æ•´ä¸ªå®šä¹‰åŸŸä¸Šéƒ½æœ‰å®šä¹‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…åŠ å…¥äº†$p_w(\boldsymbol z)$ï¼Œä¸€ä¸ªåœ¨æ¯ä¸ªç»´åº¦éƒ½è¶³å¤Ÿå®½çš„è¾…åŠ©åˆ†å¸ƒï¼š</p>
<p>$$<br>p_a(\boldsymbol z)=\frac{1}{Y}p_w(\boldsymbol z)\left(\max\limits_{\boldsymbol z^\prime}p_n(\boldsymbol z^\prime)-p_n(\boldsymbol z)\right)<br>$$</p>
<p>å…¶ä¸­$Y$ä¸ºæœ‰é™çš„å¸¸æ•°ã€‚åœ¨æ–‡ä¸­$p_n(\boldsymbol z)$å’Œ$p_w(\boldsymbol z)$éƒ½ä¸ºé«˜æ–¯åˆ†å¸ƒï¼Œé‚£ä¹ˆ$p_a(\boldsymbol z)$çš„å…·ä½“å½¢å¼ä¸ºï¼š</p>
<p>$$<br>p_a(\boldsymbol z)=\frac{1}{Y}\mathcal{N}(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2){\max\limits_{\boldsymbol z^\prime}\mathcal N(\boldsymbol z^\prime;\boldsymbol 0,\boldsymbol 1)-\mathcal N(\boldsymbol z;\boldsymbol 0,\boldsymbol 1)}<br>$$</p>
<p>å…¶ä¸­ï¼š</p>
<p>$$<br>\max\limits_{\boldsymbol z^\prime}\mathcal N(\boldsymbol z^\prime;\boldsymbol 0,\boldsymbol 1)=\frac{1}{\sqrt{2\pi}}<br>$$</p>
<p>$$<br>Y=\int_{-\infty}^{\infty}p_a(\boldsymbol z)\mathrm{d}\boldsymbol z=\frac{1}{\sqrt{2\pi}}\left{1-\frac{1}{\boldsymbol s^2+1}\right}<br>$$</p>
<p>$\boldsymbol s^2$ä¸ºè¶…å‚æ•°ï¼Œæ§åˆ¶åˆ†å¸ƒçš„å®½åº¦ã€‚ç”¨æ–‡ä¸­çš„å…ˆéªŒæ›¿æ¢VAEåŸå§‹çš„KLæ•£åº¦ï¼Œå¯å†™ä¸ºï¼š</p>
<p>$$<br>\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]=\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\frac{\mathcal N(\boldsymbol z;\boldsymbol\mu,\boldsymbol\sigma^2)}{\frac{1}{Y}\mathcal N(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2)\left{\frac{1}{2\pi}-\mathcal N(\boldsymbol z;\boldsymbol0,\boldsymbol 1)\right}}\mathrm{d}\boldsymbol z<br>$$</p>
<p>å±•å¼€åï¼š</p>
<p>$$<br>\begin{align}<br>\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]&amp;=<br>\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\mathcal{N}(\boldsymbol z;\boldsymbol\mu,\boldsymbol\sigma^2)\mathrm{d}\boldsymbol z\<br>&amp;+\log Y\<br>&amp;-\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\mathcal{N}(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2)\mathrm{d}\boldsymbol z\<br>&amp;-\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\left{\frac{1}{\sqrt{2\pi}}-\mathcal{N}(\boldsymbol z;\boldsymbol 0, \boldsymbol 1)\right}\mathrm{d}\boldsymbol z<br>\end{align}<br>$$</p>
<p>ä½¿ç”¨æ³°å‹’å±•å¼€ï¼Œ$\log (x+\frac{1}{2\pi})\simeq-\log 2\pi+2\pi x$ï¼ŒKLæ•£åº¦å¯ä»¥ç”¨ä¸‹å¼ä¼°è®¡ï¼š</p>
<p>$$<br>\begin{align}<br>\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]&amp;\simeq\sqrt{\frac{2\pi}{\boldsymbol\sigma^2+1}}\exp\left(\frac{-\boldsymbol\mu^2}{2(\boldsymbol\sigma^2+1)}\right)\<br>&amp;+\frac{\boldsymbol\mu^2+\boldsymbol\sigma^2}{2\boldsymbol s^2}-\log\boldsymbol\sigma+\log\boldsymbol s+\log\left(\sqrt{\boldsymbol s^2+1}-1\right)\<br>&amp;-\frac{\log(\boldsymbol s^2+1)}{2}+\frac{\log(2\pi)-1}{2}<br>\end{align}<br>$$</p>
<p>ä¸‹å›¾ä¸ºä¸€ç»´æ—¶$p_n(\boldsymbol z)$å’Œ$p_a(\boldsymbol z)$çš„ç¤ºä¾‹ï¼š</p>
<img src="https://i.loli.net/2020/06/25/QHXo24cKj9uRwzW.png" style="zoom:67%;" />

<h3 id="Implementation-of-proposed-method"><a href="#Implementation-of-proposed-method" class="headerlink" title="Implementation of proposed method"></a>Implementation of proposed method</h3><p>æ–‡ä¸­ä½¿ç”¨ç¼–ç å™¨è¾“å‡ºçš„åˆ†å¸ƒ$\mathcal{N}(\boldsymbol z;\boldsymbol \mu, \boldsymbol \sigma^2)$ä¸æ ‡å‡†æ­£æ€åˆ†å¸ƒä¹‹é—´çš„KLæ•£åº¦æ¥ä½œä¸ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨æ¯ä¸€è½®çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒåŠ å…¥ä¸€è½®ä½¿ç”¨Anomaly Priorçš„è®­ç»ƒã€‚</p>
<img src="https://i.loli.net/2020/06/25/wrmzADXtsyuJ6EZ.png" style="zoom:67%;" />

<h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="MNIST"><a href="#MNIST" class="headerlink" title="MNIST"></a>MNIST</h2><p>ä½œè€…è®¾è®¡äº†ä¸¤ä¸ªTaskï¼š</p>
<ol>
<li>Task 1. $N$ vs. $\bar{N}$. å°†æ‰‹å†™æ•°å­—ä¸­çš„ä¸€ä¸ªä½œä¸ºå·²çŸ¥å¼‚å¸¸ï¼Œå…¶ä»–ä½œä¸ºæ­£å¸¸ï¼Œå¹¶åŠ å…¥å‡åŒ€åˆ†å¸ƒä½œä¸ºæœªçŸ¥çš„å¼‚å¸¸ã€‚</li>
<li>Task 2. æ‰‹å†™æ•°å­—è¢«åˆ†ä¸º3ç»„ï¼šå·²çŸ¥å¼‚å¸¸ï¼Œæ­£å¸¸ï¼ŒæœªçŸ¥å¼‚å¸¸ã€‚</li>
</ol>
<p>ç»†èŠ‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<img src="https://i.loli.net/2020/06/25/ifcIxr9zOpEhksA.png" style="zoom:67%;" />

<p>åœ¨å®ç°ä¸Šï¼Œä½¿ç”¨Adamä¼˜åŒ–å™¨ï¼Œ<code>batch_size</code>ä¸º100ï¼Œ<code>epochs</code>ä¸º200ã€‚<code>Encoder</code>å’Œ<code>Decoder</code>éƒ½ç”±ä¸‰å±‚æ„ŸçŸ¥æœºç»„æˆï¼Œè¶…å‚æ•°$s^2$è®¾ç½®ä¸º400ã€‚è¯„æµ‹æ ‡å‡†ä½¿ç”¨AUC (area under the receiver characteristic curve)ã€‚</p>
<p>ä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š</p>
<img src="https://i.loli.net/2020/06/25/YTpO98y1ZPmAK3g.png" style="zoom:67%;" /></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-10-29T03:36:22.000Z" title="2019-10-29 11:36:22 â”œF10: AMâ”¤">2019-10-29</time>å‘è¡¨</span><span class="level-item"><time dateTime="2020-06-25T05:20:44.374Z" title="2020-6-25 1:20:44 â”œF10: PMâ”¤">2020-06-25</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/29/Anomaly-Detection-in-Streams-with-Extreme-Value-Theory/">Anomaly Detection in Streams with Extreme Value Theory</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡åŸºäº<strong>Extreme Value Theory</strong>æå‡ºäº†ä¸€ç§ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®é˜ˆå€¼ä¹Ÿä¸éœ€è¦å¯¹æ•°æ®åˆ†å¸ƒä½œä»»ä½•å‡è®¾çš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæœ¬æ–¹æ³•å¯ä»¥ç”¨åœ¨é€šç”¨çš„è‡ªåŠ¨é˜ˆå€¼é€‰æ‹©çš„åœºåˆä¸­ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.kdd.org/kdd2017/papers/view/anomaly-detection-in-streams-with-extreme-value-theory">åŸæ–‡</a></p>
<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚é˜ˆå€¼çš„é€‰æ‹©å¯ä»¥é€šè¿‡å®éªŒçš„æ–¹æ³•æˆ–è€…å¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œå‡è®¾çš„æ–¹æ³•æ¥å¾—åˆ°ï¼Œä¸è¿‡è¿™æ ·åšé€šå¸¸ä¸å‡†ç¡®ã€‚å€ŸåŠ©<strong>Extreme Value Theory</strong>æˆ‘ä»¬å¯ä»¥åœ¨ä¸éœ€è¦å¯¹åŸå§‹æ•°æ®çš„åˆ†å¸ƒä½œå¾ˆå¼ºçš„å‡è®¾çš„æƒ…å†µä¸‹ï¼Œæ¨æ–­æˆ‘ä»¬æƒ³è¦çš„æç«¯äº‹ä»¶çš„åˆ†å¸ƒï¼ˆåœ¨å¼‚å¸¸æ£€æµ‹ä¸­å°±æ˜¯å¼‚å¸¸å€¼ï¼‰ã€‚</p>
<p>ä¸‹é¢ç»™å‡ºä¸€äº›æ•°å­¦ç¬¦å·ï¼Œ$X$ä¸ºéšæœºå˜é‡ï¼Œ$F$ä¸ºç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œå³$F(x)=\mathbb{P}(X\leq x)$ã€‚è®°$F$çš„â€œæœ«å°¾â€åˆ†å¸ƒ$\bar{F}(x)=1-F(x)=\mathbb{P}(X&gt;x)$ã€‚å¯¹äºä¸€ä¸ªéšæœºå˜é‡$X$å’Œç»™å®šçš„æ¦‚ç‡$q$ï¼Œè®°$z_q$ä¸ºåœ¨$1-q$æ°´å¹³çš„åˆ†ä½æ•°ï¼Œå³$z_q$ä¸ºæ»¡è¶³$\mathbb{P}(X\leq z_q)\geq 1-q$æœ€å°çš„å€¼ã€‚</p>
<h2 id="Extreme-Value-Distributions"><a href="#Extreme-Value-Distributions" class="headerlink" title="Extreme Value Distributions"></a>Extreme Value Distributions</h2><p><strong>Extreme Value Theory</strong>ä¸»è¦æ˜¯ä¸ºäº†æ‰¾å‡ºæç«¯äº‹ä»¶å‘ç”Ÿçš„è§„å¾‹ï¼Œæœ‰å­¦è€…è¯æ˜ï¼Œåœ¨å¾ˆå¼±çš„æ¡ä»¶ä¸‹ï¼Œæ‰€æœ‰æç«¯äº‹ä»¶éƒ½æœä»ä¸€ä¸ªç‰¹å®šçš„åˆ†å¸ƒï¼Œè€Œä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ã€‚å…·ä½“å½¢å¼å¦‚ä¸‹ï¼š</p>
<p>$$<br>G_\gamma:x\mapsto \exp(-(1+\gamma x)^{-\frac{1}{\gamma}}), \space\space\space\space\space\gamma\in\mathbb{R}, \space\space\space\space\space 1+\gamma x&gt;0<br>$$</p>
<p>å…¶ä¸­$\gamma$ç§°ä¸º<strong>Extreme Value Index</strong>ï¼Œç”±åŸå§‹åˆ†å¸ƒå†³å®šã€‚</p>
<p>æ›´ä¸¥è°¨çš„è¯´æ³•æ˜¯Fisher-Tippett-Gnedenkoå®šç†ï¼ˆæå€¼ç†è®ºç¬¬ä¸€å®šç†ï¼‰ï¼š</p>
<blockquote>
<p>**THEOREM: **(Fisher-Tippett-Gnedenko). ä»¤$X_1,X_2,\cdots,X_n,\cdots$ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡åºåˆ—ï¼Œ$M_n=\max {X_1,\cdots,X_n}$ã€‚å¦‚æœå®æ•°å¯¹åºåˆ—$(a_n,b_n)$å­˜åœ¨ä¸”æ»¡è¶³$a_n&gt;0$å’Œ$\lim\limits_{n\rightarrow \infty}P\left(\frac{M_n-b_n}{a_n}\leq x\right)=F(x)$ï¼Œå…¶ä¸­$F$ä¸ºéé€€åŒ–åˆ†å¸ƒå‡½æ•°ï¼Œé‚£ä¹ˆ$F$å±äºGumbelã€FrÃ©chetæˆ–Weibullåˆ†å¸ƒæ—ï¼ˆæˆ–æ€»ç§°Generalized Extreme Value Distributionï¼‰ä¸­çš„ä¸€ç§ã€‚</p>
</blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªåç›´è§‰çš„ç»“è®ºï¼Œä½†æ˜¯æƒ³åˆ°å½“äº‹ä»¶å‘ç”Ÿå˜å¾—æç«¯æ—¶ï¼Œå³$\mathbb{P}(X&gt;x)\rightarrow 0$ï¼Œ$\bar{F}(x)=\mathbb{P}(X&gt;x)$åˆ†å¸ƒçš„å½¢çŠ¶å…¶å®å¹¶æ²¡æœ‰å¾ˆå¤šç§é€‰æ‹©ã€‚Table 1å±•ç¤ºäº†å‡ ç§ä¸åŒåˆ†å¸ƒå¯¹åº”çš„$\gamma$ï¼š</p>
<p><img src="https://i.loli.net/2020/06/24/jyhoWZGc2gFTrJv.png"></p>
<p>Figure 1å±•ç¤ºäº†å‡ ç§ä¸åŒ$\gamma$æƒ…å†µä¸‹çš„â€œæœ«å°¾â€åˆ†å¸ƒï¼š</p>
<p><img src="https://i.loli.net/2020/06/24/4rmZL1AMcBJ2Vzq.png"></p>
<h2 id="Power-of-EVT"><a href="#Power-of-EVT" class="headerlink" title="Power of EVT"></a>Power of EVT</h2><p>æ ¹æ®<strong>Extreme Value Theory</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸå§‹åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹è®¡ç®—æç«¯äº‹ä»¶çš„æ¦‚ç‡ã€‚ä½†æ˜¯$\bar{G}_\gamma$åˆ†å¸ƒä¸­å‚æ•°$\gamma$æ˜¯æœªçŸ¥çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§é«˜æ•ˆçš„æ–¹æ³•æ¥è¿›è¡Œä¼°è®¡ã€‚<strong>The Peaks-Over-Threshold</strong> (POT) æ–¹æ³•æ˜¯æœ¬æ–‡ä»‹ç»çš„ä¸€ç§æ–¹æ³•ã€‚</p>
<p><img src="https://i.loli.net/2020/06/24/hX2T1IkMAqfioZl.png"></p>
<h2 id="Peaks-Over-Threshold-Approach"><a href="#Peaks-Over-Threshold-Approach" class="headerlink" title="Peaks-Over-Threshold Approach"></a>Peaks-Over-Threshold Approach</h2><p>POTæ–¹æ³•ä¾èµ–äºPickands-Balkema-De Haanå®šç†ï¼ˆæå€¼ç†è®ºç¬¬äºŒå®šç†ï¼‰ï¼Œç»´åŸºç™¾ç§‘ç‰ˆï¼š</p>
<blockquote>
<p>è€ƒè™‘ä¸€ä¸ªæœªçŸ¥åˆ†å¸ƒ$F$å’Œéšæœºå˜é‡$X$ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡$X$åœ¨è¶…è¿‡ç¡®å®šé˜ˆå€¼$u$ä¸‹çš„æ¡ä»¶åˆ†å¸ƒ$F_u$ï¼Œå®šä¹‰ä¸ºï¼š<br>$$<br>F_u(y)=P(X-u\leq y|X&gt;u)=\frac{F(u+y)-F(u)}{1-F(u)}<br>$$<br>å…¶ä¸­$0\leq y\leq x_F-u$ï¼Œ$x_F$ä¸º$F$çš„å³ç«¯ç‚¹ã€‚$F_u$æè¿°äº†è¶…è¿‡ç‰¹å¾é˜ˆå€¼$u$çš„åˆ†å¸ƒï¼Œç§°ä¸º<strong>Conditional Excess Distribution Function</strong>ã€‚</p>
<p>**STATEMENT: **(Pickands-Balkema-De Haan). è®¾$(X_1,X_2,\cdots)$ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒéšæœºå˜é‡åºåˆ—ï¼Œ$F_u$ä¸ºç›¸åº”çš„Conditional Excess Distribution Functionã€‚å¯¹äºä¸€å¤§ç±»çš„$F$å’Œå¾ˆå¤§çš„$u$ï¼Œ$F_u$èƒ½å¤Ÿå¾ˆå¥½çš„è¢«Generalized Pareto Distributionæ‰€æ‹Ÿåˆï¼š<br>$$<br>F_u(y)\rightarrow G_{k,\sigma}(y),\space\space \text{as } u\rightarrow \infty<br>$$<br>å…¶ä¸­ï¼š<br>$$<br>G_{k,\sigma}(y)=<br>\begin{cases}<br>1-(1+ky/\sigma)^{-1/k}, &amp;\text{if }k\neq 0\<br>1-e^{-y/\sigma}, &amp;\text{if }k=0<br>\end{cases}<br>$$<br>å½“$k\geq 0$æ—¶$\sigma&gt;0, y\geq 0$ï¼Œ$k&lt;0$æ—¶$0\leq y\leq -\sigma/k$ã€‚</p>
</blockquote>
<p>è®ºæ–‡ä¸­ç»™å‡ºçš„å®šç†å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>**THEOREM: **(Pickands-Balkema-De Haan). ç´¯ç§¯æ¦‚ç‡å¯†åº¦å‡½æ•°$F\in\mathcal{D}<em>\gamma$å½“ä¸”ä»…å½“å‡½æ•°$\sigma$å­˜åœ¨æ—¶ï¼Œå¯¹æ‰€æœ‰$x\in\mathbb{R}$åœ¨$1+\gamma x&gt;0$çš„æ¡ä»¶ä¸‹æœ‰ï¼š<br>$$<br>\frac{\bar{F}(t+\sigma(t)x)}{\bar{F}(t)}\mathop{\rightarrow}\limits</em>{t\rightarrow\tau}(1+\gamma x)^{-\frac{1}{\gamma}}<br>$$</p>
</blockquote>
<p>ä¸Šå¼å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š<br>$$<br>\bar{F}<em>t(x)=\mathbb{P}(X-t&gt;x|X&gt;t)\mathop{\sim}\limits</em>{t\rightarrow\tau}\left(1+\frac{\gamma x}{\sigma(t)}\right)^{-\frac{1}{\gamma}}<br>$$<br>è¯¥å¼è¡¨æ˜$X$è¶…è¿‡é˜ˆå€¼$t$çš„æ¦‚ç‡ï¼ˆå†™ä¸º$X-t$ï¼‰æœä»<strong>Generalized Pareto Distribution</strong> (GPD)ï¼Œå‚æ•°ä¸º$\gamma$å’Œ$\sigma$ã€‚POTä¸»è¦æ˜¯æ‹ŸåˆGPDè€Œä¸æ˜¯EVTåˆ†å¸ƒã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è¦ä¼°è®¡å‚æ•°$\hat{\gamma}$å’Œ$\hat{\sigma}$ï¼Œåˆ†ä½æ•°å¯ä»¥é€šè¿‡ä¸‹å¼è®¡ç®—å¾—åˆ°ï¼š<br>$$<br>z_q\simeq t+\frac{\hat{\sigma}}{\hat{\gamma}}\left(\left(\frac{qn}{N_t}\right)^{-\hat{\gamma}}-1\right)<br>$$</p>
<p>å…¶ä¸­$t$æ˜¯ä¸€ä¸ªâ€œå¾ˆé«˜â€çš„é˜ˆå€¼ï¼Œ$q$æ˜¯ç»™å®šçš„æ¦‚ç‡å€¼ï¼Œ$n$æ˜¯æ‰€æœ‰è§‚æµ‹æ ·æœ¬çš„æ•°é‡ï¼Œ$N_t$æ˜¯peaksçš„æ•°é‡ï¼Œå³$X_i&gt;t$çš„æ•°é‡ã€‚ä¸ºäº†è¿›è¡Œé«˜æ•ˆçš„å‚æ•°ä¼°è®¡ï¼Œæ–‡ä¸­ä½¿ç”¨äº†æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p>
<h2 id="Maximum-Likelihood-Estimation"><a href="#Maximum-Likelihood-Estimation" class="headerlink" title="Maximum Likelihood Estimation"></a>Maximum Likelihood Estimation</h2><p>è®¾$X_1,\cdots,X_n$ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°è®°ä¸º$f_\theta$ï¼Œ$\theta$ä¸ºåˆ†å¸ƒä¸­çš„å‚æ•°ï¼Œé‚£ä¹ˆä¼¼ç„¶å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p>
<p>$$<br>\mathcal{L}(X_1,\cdots,X_n;\theta)=\prod\limits_{i=1}^n f_\theta(X_i)<br>$$</p>
<p>åœ¨æå¤§ä¼¼ç„¶ä¼°è®¡ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°åˆé€‚çš„å‚æ•°ä½¿å¾—ä¼¼ç„¶å‡½æ•°æœ€å¤§åŒ–ã€‚åœ¨æˆ‘ä»¬çš„é—®é¢˜ä¸­ï¼Œä¼¼ç„¶å‡½æ•°å¦‚ä¸‹ï¼š<br>$$<br>\log\mathcal{L}(\gamma,\sigma)=-N_t\log\sigma-\left(1+\frac{1}{\gamma}\right)\sum\limits_{i=1}^{N_t}\log\left(1+\frac{\gamma}{\sigma}Y_i\right)<br>$$<br>å…¶ä¸­$Y_i&gt;0$è¡¨ç¤º$X_i$è¶…è¿‡é˜ˆå€¼$t$çš„éƒ¨åˆ†ã€‚</p>
<p>æ–‡ä¸­ä½¿ç”¨äº†<strong>Grimshawâ€™s Trick</strong>æ¥å°†å«ä¸¤ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜è½¬æ¢ä¸ºåªå«ä¸€ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜ã€‚è®°$\ell(\gamma,\sigma)=\log\mathcal{L}(\gamma,\sigma)$ï¼Œå¯¹äºæ‰€æœ‰æå€¼æ¥è¯´æœ‰$\nabla \ell(\gamma, \sigma)=0$ã€‚Grimshawâ€™s Trickè¡¨æ˜å¯¹äºæ»¡è¶³$\nabla \ell(\gamma, \sigma)=0$çš„ä¸€å¯¹$(\gamma^*,\sigma^*)$ï¼Œ$x^*=\frac{\gamma^*}{\sigma^*}$ä¸ºç­‰å¼$u(X)v(X)=1$çš„è§£ï¼Œå…¶ä¸­ï¼š<br>$$<br>\begin{align}<br>u(x)&amp;=\frac{1}{N_t}\sum\limits_{i=1}^{N_t}\frac{1}{1+xY_i}\<br>v(x)&amp;=1+\frac{1}{N_t}\sum\limits_{i=1}^{N_t}\log(1+xY_i)<br>\end{align}<br>$$<br>åœ¨æ‰¾åˆ°æ»¡è¶³è¯¥ç­‰å¼çš„è§£$x^*$åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$\gamma^*=v(x^*)-1$å’Œ$\sigma^*=\gamma^*/x^*$ï¼Œäºæ˜¯é—®é¢˜å°±å˜æˆäº†å¦‚ä½•å¯»æ‰¾æ–¹ç¨‹çš„æ‰€æœ‰æ ¹ã€‚</p>
<p>å› ä¸º$\log$çš„å­˜åœ¨ï¼Œæ‰€ä»¥æœ‰$1+xY_i&gt;0$ã€‚è€Œ$Y_i$æ˜¯æ­£æ•°ï¼Œæ‰€ä»¥$x^*$çš„èŒƒå›´ä¸€å®šåœ¨$\left(-\frac{1}{Y^M},+\infty\right)$ï¼Œå…¶ä¸­$Y^M=\max Y_i$ã€‚</p>
<p>Grimshawï¼ˆä½œè€…å‚è€ƒçš„ä¸€ç¯‡<a target="_blank" rel="noopener" href="https://www.tandfonline.com/doi/abs/10.1080/00401706.1993.10485040">è®ºæ–‡</a>ï¼‰è¿˜ç»™å‡ºäº†ä¸€ä¸ªä¸Šç•Œï¼š<br>$$<br>x^*_{\text{max}}=2\frac{\bar{Y}-Y^m}{(Y^m)^2}<br>$$<br>å…¶ä¸­$Y^m=\min Y_i$ï¼Œ$\bar{Y}$ä¸º$Y_i$çš„å‡å€¼ã€‚è¯¦ç»†çš„ä¼˜åŒ–æ–¹æ³•ä¼šåœ¨ä¸‹æ–‡è®¨è®ºã€‚</p>
<p>èƒŒæ™¯éƒ¨åˆ†åˆ°æ­¤ç»“æŸï¼Œæ¥ä¸‹æ¥çš„éƒ¨åˆ†å°±æ˜¯ä½œè€…æå‡ºçš„æ–°æ–¹æ³•ã€‚</p>
<h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><p>Extreme Value Theoryç»™å‡ºäº†åœ¨å¯¹åŸå§‹åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡ä½¿å¾—$\mathbb{P}(X&gt;z_q)&lt;q$çš„$z_q$çš„æ–¹æ³•ã€‚</p>
<p>æœ¬æ–‡æ®æ­¤æå‡ºäº†æ—¶é—´åºåˆ—æµçš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚é¦–å…ˆæ ¹æ®å·²çŸ¥çš„è§‚æµ‹å€¼$X_1,\cdots,X_n$å¾—åˆ°é˜ˆå€¼$z_q$ï¼Œç„¶åæ ¹æ®æ•°æ®çš„ç‰¹æ€§è¿ç”¨ä¸¤ç§ä¸åŒæ–¹æ³•æ¥æ›´æ–°$z_q$ã€‚å¯¹äºå¹³ç¨³æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨SPOTï¼›å¯¹äºéå¹³ç¨³æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨DSPOTã€‚</p>
<h2 id="Initialization-Step"><a href="#Initialization-Step" class="headerlink" title="Initialization Step"></a>Initialization Step</h2><p>åœ¨è¿›è¡Œå¼‚å¸¸æ£€æµ‹ä¹‹å‰ï¼Œéœ€è¦æ ¹æ®å·²æœ‰çš„è§‚æµ‹æ•°æ®è¿›è¡Œ$z_q$çš„ä¼°è®¡ã€‚ç»™å®š$n$ä¸ªè§‚æµ‹å€¼$X_1,\cdots,X_n$å’Œä¸€ä¸ªå›ºå®šçš„æ¦‚ç‡å€¼$q$ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡é˜ˆå€¼$z_q$ä½¿å¾—$\mathbb{P}(X&gt;z_q)&lt;q$ã€‚å…¶ä¸»è¦æµç¨‹æ˜¯é¦–å…ˆè®¾å®šä¸€ä¸ªè¾ƒå¤§çš„é˜ˆå€¼$t$ï¼Œç„¶åé€šè¿‡æ‹ŸåˆGPDåˆ†å¸ƒæ¥è®¡ç®—$z_q$ã€‚è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/06/24/fzeC8vuDtA6mEdl.png"></p>
<p>ç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/06/24/AEQpnZPiW3C4mr7.png"></p>
<p>$Y_t$ä»£è¡¨å¤§äº$t$çš„è§‚æµ‹å€¼çš„é›†åˆï¼ŒGPDåˆ†å¸ƒçš„æ‹Ÿåˆä½¿ç”¨äº†å‰æ–‡æåˆ°çš„Grimshawâ€™s Trickã€‚</p>
<h2 id="Finding-Anomalies-in-a-Stream"><a href="#Finding-Anomalies-in-a-Stream" class="headerlink" title="Finding Anomalies in a Stream"></a>Finding Anomalies in a Stream</h2><p>é€šè¿‡Initialization Stepä½¿ç”¨POTç®—æ³•å¾—åˆ°çš„$z_q$ï¼Œæˆ‘ä»¬å®šä¹‰å…¶ä¸ºâ€Normality Boundâ€ï¼Œç”¨äºåé¢çš„æ£€æµ‹ã€‚åœ¨åé¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®æ–°å¾—åˆ°çš„è§‚æµ‹å€¼æ¥æ›´æ–°$z_q$ã€‚</p>
<h3 id="Stationary-Case"><a href="#Stationary-Case" class="headerlink" title="Stationary Case"></a>Stationary Case</h3><p>æˆ‘ä»¬é¦–å…ˆæ¥è®¨è®ºæ—¶é—´åºåˆ—æ²¡æœ‰æ—¶é—´ä¾èµ–æ€§çš„æƒ…å†µï¼ˆ$X_1,\cdots,X_n$ä¹‹é—´ç‹¬ç«‹åŒåˆ†å¸ƒï¼‰ã€‚é€šè¿‡POTç®—æ³•å¯¹æ‰€æœ‰è§‚æµ‹å€¼å¾—åˆ°$z_q$ä¹‹åï¼ŒStreaming POT (SPOT) ç®—æ³•ä¼šæ£€æŸ¥$X_n$ä¹‹åçš„å€¼ï¼ˆæ•°æ®æµåœºæ™¯ï¼Œ$X_1,\cdots,X_n$æ˜¯å†å²æ•°æ®ï¼Œè¿˜ä¼šæœ‰æ–°çš„æ•°æ®è¿›æ¥ï¼‰ï¼Œå¦‚æœå¤§äº$z_q$ï¼Œåˆ™å°†$X_i$åŠ å…¥å¼‚å¸¸ç‚¹é›†åˆä¸­ï¼›å¦‚æœå¤§äº$t$ä½†å°äº$z_q$ï¼Œåˆ™å°†$X_i$åŠ å…¥è§‚æµ‹å€¼é›†åˆä¸­ï¼Œæ›´æ–°$z_q$ï¼›å…¶ä»–æƒ…å†µæˆ‘ä»¬$X_i$æ˜¯æ­£å¸¸æƒ…å†µã€‚ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2020/06/24/h5yKnlCAYxbHu2R.png"></p>
<h3 id="Drifting-Case"><a href="#Drifting-Case" class="headerlink" title="Drifting Case"></a>Drifting Case</h3><p>SPOTç®—æ³•åªé€‚ç”¨äºå¹³ç¨³åˆ†å¸ƒçš„æƒ…å†µï¼Œä½†åœ¨ç°å®ç”Ÿæ´»ä¸­è¿™æ ·çš„å‡è®¾è¿‡å¼ºäº†ã€‚äºæ˜¯ä½œè€…æå‡ºäº†èƒ½å¤„ç†æ—¶é—´ä¾èµ–æ€§çš„Streaming POT with Drift (DSPOT) ç®—æ³•ã€‚</p>
<p><img src="https://i.loli.net/2020/06/25/O49XwQvVGH7k1ri.png"></p>
<p>åœ¨DSPOTä¸­ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨$X_i$çš„ç»å¯¹å€¼ï¼Œè€Œæ˜¯ç”¨ç›¸å¯¹å€¼$X^\prime_i=X_i-M_i$ï¼Œå…¶ä¸­$M_i$æ˜¯$i$æ—¶åˆ»çš„å±€éƒ¨ç‰¹å¾ï¼Œå¦‚Figure 4æ‰€ç¤ºã€‚æœ€ç®€å•çš„å®ç°æ˜¯ä½¿ç”¨å±€éƒ¨å‡å€¼ï¼Œå³$M_i=(1/d)\cdot\sum\limits_{k=1}^d X_{i-k}^*$ï¼Œ$X_{i-1}^*,\cdots,X_{i-d}^*$æ˜¯é•¿åº¦ä¸º$d$çš„çª—å£ã€‚æˆ‘ä»¬å‡è®¾$X^\prime_i$æœä»å¹³ç¨³åˆ†å¸ƒçš„å‡è®¾ã€‚</p>
<p>ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/P6hOsD9dnNIHvUV.png"></p>
<h2 id="Numerical-Optimization"><a href="#Numerical-Optimization" class="headerlink" title="Numerical Optimization"></a>Numerical Optimization</h2><p>ç°åœ¨å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯ä¼˜åŒ–äº†ï¼Œå‰æ–‡å·²ç»æåˆ°å¯¹GPDçš„æ‹Ÿåˆå·²ç»è¢«ä¼˜åŒ–æˆä¸€ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜ï¼Œä¸‹é¢å°†ä¼šè¯¦ç»†è®¨è®ºä¼˜åŒ–ç®—æ³•ã€‚</p>
<h3 id="Reduction-of-the-Optimal-Parameters-Search"><a href="#Reduction-of-the-Optimal-Parameters-Search" class="headerlink" title="Reduction of the Optimal Parameters Search"></a>Reduction of the Optimal Parameters Search</h3><p>å‰æ–‡å·²ç»å¾—åˆ°äº†ä¸€ä¸ªåˆæ­¥çš„$x^*$çš„Boundï¼Œå³$x^*&gt;-\frac{1}{Y^M}$å’Œ$x^*\leq 2\frac{\bar{Y}-Y^m}{(Y^m)^2}$ï¼Œä¸‹é¢å°†ç»™å‡ºä¸€ä¸ªæ›´ä¸¥æ ¼çš„Boundã€‚</p>
<blockquote>
<p>*<em>PROPOSITION: **å¦‚æœ$x^</em>$æ˜¯$u(x)v(x)=1$çš„è§£ï¼Œé‚£ä¹ˆï¼š<br>$$<br>x^<em>\leq 0 \text{ or } x^</em>\geq 2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m}<br>$$</p>
</blockquote>
<p>è¯æ˜è§è®ºæ–‡åŸæ–‡ã€‚</p>
<p>è¿™æ ·$x^*$çš„èŒƒå›´å°±è¿›ä¸€æ­¥ç¼©å°äº†ï¼Œäºæ˜¯æœ‰$u(x)v(X)=1$çš„è§£$x^*$åœ¨ä»¥ä¸‹èŒƒå›´ä¹‹å†…ï¼š<br>$$<br>\left(-\frac{1}{Y^M},0\right]\text{ and }\left[2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m},2\frac{\bar{Y}-Y^m}{(Y^m)^2}\right]<br>$$</p>
<h3 id="How-Can-We-Maximize-the-Likelihood-Function"><a href="#How-Can-We-Maximize-the-Likelihood-Function" class="headerlink" title="How Can We Maximize the Likelihood Function?"></a>How Can We Maximize the Likelihood Function?</h3><p>æ¥ä¸‹æ¥æ˜¯ä¼˜åŒ–çš„å…·ä½“å®ç°é—®é¢˜ã€‚æ–‡ä¸­é¦–å…ˆè®¾å®šäº†ä¸€ä¸ªå¾ˆå°çš„å€¼$\epsilon&gt;0\space(\sim 10^{-8})$ï¼Œç„¶ååœ¨ä¸‹é¢çš„èŒƒå›´å†…å¯»æ‰¾å‡½æ•°$w:x\mapsto u(x)v(x)-1$çš„æ ¹ï¼š<br>$$<br>\left[-\frac{1}{Y^M}+\epsilon,-\epsilon\right]\text{ and }\left[2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m},2\frac{\bar{Y}-Y^m}{(Y^m)^2}\right]<br>$$<br>ä½œè€…æ²¡æœ‰ä½¿ç”¨ç°æœ‰çš„å¯»æ‰¾å‡½æ•°æ ¹çš„ç®—æ³•ï¼Œè€Œæ˜¯è½¬æ¢ä¸ºå¦‚ä¸‹ä¼˜åŒ–é—®é¢˜ï¼š<br>$$<br>\min\limits_{x_1,\cdots,x_k\in I}\sum\limits_{i=1}^k w(x_k)^2<br>$$<br>å…¶ä¸­$I$å°±æ˜¯$x^*$çš„Boundã€‚è¯¥é—®é¢˜æ˜¯ä¸€ä¸ªå¾ˆå…¸å‹çš„ä¼˜åŒ–é—®é¢˜ï¼Œå¯ä»¥è¢«å¾ˆå¤šæˆç†Ÿçš„ç®—æ³•æ‰€è§£å†³ã€‚</p>
<h3 id="Initial-Threshold"><a href="#Initial-Threshold" class="headerlink" title="Initial Threshold"></a>Initial Threshold</h3><p>åœ¨ç®—æ³•çš„Initialization Stepï¼Œéœ€è¦äº‹å…ˆè®¾å®šä¸€ä¸ªé˜ˆå€¼$t$ï¼Œå¦‚æœè®¾å®šçš„å¤ªå¤§ï¼Œé‚£ä¹ˆ$Y_t$çš„æ•°é‡å°±ä¼šå¾ˆå°‘ã€‚ä½œè€…ç»™å‡ºçš„å»ºè®®æ˜¯ä¿è¯$t&lt;z_q$ï¼Œå³$t$å¯¹åº”çš„æ¦‚ç‡å€¼åº”è¯¥å°äº$1-q$ã€‚</p>
<h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><p>åœ¨å®éªŒéƒ¨åˆ†ï¼Œä½œè€…åœ¨åˆæˆæ•°æ®å’ŒçœŸå®æ•°æ®ä¸Šè¯•éªŒäº†SPOTç®—æ³•å’ŒDSPOTç®—æ³•çš„æœ‰æ•ˆæ€§ã€‚</p>
<h2 id="D-SPOT-Reliability"><a href="#D-SPOT-Reliability" class="headerlink" title="(D)SPOT Reliability"></a>(D)SPOT Reliability</h2><p>ä½œè€…é¦–å…ˆåœ¨åˆæˆæ•°æ®ä¸ŠéªŒè¯SPOTçš„æœ‰æ•ˆæ€§ã€‚å…·ä½“åšæ³•æ˜¯ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒç”Ÿæˆæ•°æ®ï¼ˆé«˜æ–¯åˆ†å¸ƒçš„åˆ†ä½æ•°èƒ½å¤Ÿç›´æ¥è®¡ç®—ï¼‰ï¼Œç„¶åå°†SPOTå¾—å‡ºçš„$z_q$å’Œç†è®ºå€¼è¿›è¡Œå¯¹æ¯”ã€‚è¯¯å·®å®šä¹‰å¦‚ä¸‹ï¼š<br>$$<br>\text{error rate}=\left|\frac{z^{\text{SPOT}}-z^{\text{th}}}{z^{\text{th}}}\right|<br>$$<br>ä¸‹å›¾æ˜¯é‡‡ç”¨ä¸åŒæ•°é‡è§‚æµ‹å€¼çš„ç»“æœï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/GXlu2MAJaoqxyd4.png"></p>
<h2 id="Finding-Anomalies-with-SPOT"><a href="#Finding-Anomalies-with-SPOT" class="headerlink" title="Finding Anomalies with SPOT"></a>Finding Anomalies with SPOT</h2><p>åœ¨è¿™ä¸€èŠ‚ä½œè€…åœ¨çœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒä»¥éªŒè¯SPOTç®—æ³•çš„æœ‰æ•ˆæ€§ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/wTkZxKarFVDOlp6.png"></p>
<p>åœ¨æ–‡ä¸­ä½œè€…è¯´ç®—æ³•çš„True Positiveè¾¾åˆ°äº†$86%$ï¼ŒFalse Positiveå°äº$4%$ã€‚</p>
<p><img src="https://i.loli.net/2020/06/25/RcUnwtHud7DjNXv.png"></p>
<h2 id="Finding-Anomalies-with-DSPOT"><a href="#Finding-Anomalies-with-DSPOT" class="headerlink" title="Finding Anomalies with DSPOT"></a>Finding Anomalies with DSPOT</h2><p>åœ¨è¿™ä¸€èŠ‚ä½œè€…ä½¿ç”¨DSPOTåœ¨çœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒã€‚çª—å£å¤§å°$d=450$ï¼Œé¢„è®¾çš„é£é™©æ¦‚ç‡å€¼$q=10^{-3}$ã€‚ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/lIxqpnGtL7feVKs.png"></p>
<p>åœ¨å›¾ä¸­å¯ä»¥çœ‹å‡ºåœ¨$8000$ Minutesä¹‹åä¸Šç•Œæ˜¾è‘—æé«˜ï¼Œä½œè€…åˆ†æäº†åŸå› ï¼Œè®¤ä¸ºæ˜¯å› ä¸ºè¶…è¿‡é˜ˆå€¼$t$çš„ç‚¹$Y_t$çš„å­˜å‚¨æ˜¯å…¨å±€çš„ï¼Œåœ¨å‰$8000$ Minutesç®—æ³•å­˜å‚¨äº†å¾ˆå¤šè¾ƒé«˜çš„$Y_t$å€¼ï¼Œè€Œåœ¨$8000$ Minutesä¹‹åï¼ŒçœŸå®æ•°æ®çš„è¶‹åŠ¿å¼€å§‹ä¸‹é™ï¼Œä½†ç®—æ³•ä»æ˜¯æ ¹æ®å…¨å±€çš„$Y_t$æ¥è¿›è¡Œ$z_q$çš„è®¡ç®—ï¼ˆè¿™ä¸€æ®µæ²¡æœ‰ç‰¹åˆ«æ˜ç™½ï¼‰ã€‚ä½œè€…ç»™å‡ºçš„ä¿®æ­£æ–¹æ³•æ˜¯åªä¿å­˜å›ºå®šæ•°é‡çš„Peaksã€‚</p>
<p>ä¸‹å›¾æ˜¯ä½œè€…åœ¨è‚¡ç¥¨æ•°æ®ä¸Šå¾—åˆ°çš„å®éªŒç»“æœï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/VeEo8OPbzyUxXrR.png"></p>
<h2 id="Performances"><a href="#Performances" class="headerlink" title="Performances"></a>Performances</h2><p>ä½œè€…è¿˜éªŒè¯äº†ç®—æ³•çš„æ—¶é—´æ•ˆç‡ã€‚</p>
<p><img src="https://i.loli.net/2020/06/25/Egh7CxsU2TtL6az.png"></p>
<p>è¡¨ä¸­Tä»£è¡¨çš„æ˜¯æ¯ä¸ªIterationçš„æ—¶é—´ï¼ŒMä»£è¡¨çš„æ˜¯Peaksçš„æ¯”ä¾‹ï¼Œâ€bi-â€œå‰ç¼€ä»£è¡¨çš„æ˜¯åŒæ—¶è®¡ç®—ä¸Šç•Œå’Œä¸‹ç•Œã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-10-22T07:14:26.000Z" title="2019-10-22 3:14:26 â”œF10: PMâ”¤">2019-10-22</time>å‘è¡¨</span><span class="level-item"><time dateTime="2020-06-24T08:16:51.584Z" title="2020-6-24 4:16:51 â”œF10: PMâ”¤">2020-06-24</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Tutorial/">Tutorial</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/22/An-Introduction-to-Variational-Autoencoders/">An Introduction to Variational Autoencoders</a></h1><div class="content"><h1 id="Deep-Generative-Models"><a href="#Deep-Generative-Models" class="headerlink" title="Deep Generative Models"></a>Deep Generative Models</h1><p>ç”Ÿæˆæ¨¡å‹æ˜¯æŒ‡ä¸€ç³»åˆ—ç”¨äºéšæœºç”Ÿæˆå¯è§‚æµ‹æ•°æ®çš„æ¨¡å‹ã€‚å‡è®¾åœ¨ä¸€ä¸ªé«˜ç»´ç©ºé—´$\mathcal{X}$ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªéšæœºå‘é‡$\mathbf{X}$æœä»ä¸€ä¸ªæœªçŸ¥çš„åˆ†å¸ƒ$p_r(x),x\in \mathcal{X}$ã€‚ç”Ÿæˆæ¨¡å‹å°±æ˜¯æ ¹æ®ä¸€äº›å¯è§‚æµ‹çš„æ ·æœ¬$x^{(1)},x^{(2)},\cdots,x^{(N)}$æ¥å­¦ä¹ ä¸€ä¸ªå‚æ•°åŒ–çš„æ¨¡å‹$p_\theta(x)$æ¥è¿‘ä¼¼æœªçŸ¥åˆ†å¸ƒ$p_r(x)$ã€‚</p>
<p>ç”Ÿæˆæ¨¡å‹ä¸»è¦ç”¨äºå¯†åº¦ä¼°è®¡å’Œæ ·æœ¬ç”Ÿæˆã€‚</p>
<hr>
<p>å¯†åº¦ä¼°è®¡å³ç»™å®šä¸€ç»„æ•°æ®$\mathcal{D}={x^{(i)}},1\leq i\leq N$ï¼Œå‡è®¾ä»–ä»¬éƒ½æ˜¯ä»ç›¸åŒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°$p_r(x)$ç‹¬ç«‹äº§ç”Ÿçš„ã€‚å¯†åº¦ä¼°è®¡å°±æ˜¯æ ¹æ®æ•°æ®é›†$\mathcal{D}$æ¥ä¼°è®¡å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°$p_r(x)$ã€‚</p>
<p>å¦‚æœå°†ç”Ÿæˆæ¨¡å‹ç”¨äºç›‘ç£å­¦ä¹ ï¼Œé‚£ä¹ˆå°±æ˜¯è¾“å‡ºæ ‡ç­¾çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(y|x)$ï¼Œæ ¹æ®è´å¶æ–¯å…¬å¼ï¼š</p>
<p>$$p(y|x)=\frac{p(x,y)}{\sum_y p(x,y)}$$</p>
<p>é—®é¢˜å°±å˜ä¸ºäº†è”åˆæ¦‚ç‡$p(x,y)$çš„å¯†åº¦ä¼°è®¡é—®é¢˜ã€‚</p>
<hr>
<p>æ ·æœ¬ç”Ÿæˆå³æ ¹æ®ç»™å®šçš„æ¦‚ç‡åˆ†å¸ƒ$p_\theta(x)$ç”Ÿæˆä¸€äº›æœä»è¿™ä¸ªåˆ†å¸ƒçš„æ ·æœ¬ï¼Œå³é‡‡æ ·ã€‚åœ¨å«éšå˜é‡çš„ç”Ÿæˆæ¨¡å‹ä¸­ï¼Œç”Ÿæˆ$x$çš„è¿‡ç¨‹ä¸€èˆ¬åŒ…å«ä¸¤æ­¥ï¼š</p>
<ol>
<li>æ ¹æ®éšå˜é‡çš„åˆ†å¸ƒ$p_\theta(z)$é‡‡æ ·å¾—åˆ°$z$ï¼›</li>
<li>æ ¹æ®æ¡ä»¶åˆ†å¸ƒ$p_\theta(x|z;\theta)$è¿›è¡Œé‡‡æ ·å¾—åˆ°$x$ã€‚</li>
</ol>
<p>æ‰€ä»¥åœ¨ç”Ÿæˆæ¨¡å‹ä¸­çš„é‡ç‚¹æ˜¯ä¼°è®¡æ¡ä»¶åˆ†å¸ƒ$p(x|z;\theta)$ã€‚</p>
<h1 id="Parameter-Estimation-for-Hidden-Variable-with-EM-Algorithm"><a href="#Parameter-Estimation-for-Hidden-Variable-with-EM-Algorithm" class="headerlink" title="Parameter Estimation for Hidden Variable with EM Algorithm"></a>Parameter Estimation for Hidden Variable with EM Algorithm</h1><p>å¦‚æœå›¾æ¨¡å‹ä¸­å­˜åœ¨éšå˜é‡ï¼Œå°±éœ€è¦ä½¿ç”¨EMç®—æ³•è¿›è¡Œå‚æ•°ä¼°è®¡ã€‚</p>
<p>åœ¨ä¸€ä¸ªåŒ…å«éšå˜é‡çš„å›¾æ¨¡å‹ä¸­ï¼Œä»¤$\mathbf{X}$ä¸ºå¯è§‚æµ‹å˜é‡é›†åˆï¼Œ$\mathbf{Z}$ä¸ºéšå˜é‡é›†åˆï¼Œåˆ™ä¸€ä¸ªæ ·æœ¬$x$çš„è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p>
<p>$$p(x;\theta)=\sum_z p(x,z;\theta)$$</p>
<p>ç»™å®šåŒ…å«$N$ä¸ªè®­ç»ƒæ ·æœ¬çš„è®­ç»ƒé›†$\mathcal{D}={x^{(n)}},1\leq i\leq N$ï¼Œåˆ™è®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¸ºï¼š</p>
<p>$$\begin{align}\mathcal{L}(\mathcal{D};\theta)&amp;=\frac{1}{N}\sum_{n=1}^N \log p(x^{(n)};\theta)\&amp;=\frac{1}{N}\sum_{n=1}^N \log \sum_z p(x^{(n)},z;\theta)\end{align}$$</p>
<hr>
<p>è¿™æ—¶ï¼Œåªè¦æœ€å¤§åŒ–æ•´ä¸ªè®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶$\mathcal{L}(\mathcal{D};\theta)$ï¼Œå³å¯ä¼°è®¡å‡ºæœ€ä¼˜çš„å‚æ•°$\theta^*$ã€‚ä¸è¿‡åœ¨è®¡ç®—æ¢¯åº¦çš„æ—¶å€™ï¼Œéœ€è¦åœ¨å¯¹æ•°å‡½æ•°å†…éƒ¨è¿›è¡Œæ±‚å’Œæˆ–ç§¯åˆ†è®¡ç®—ã€‚ä¸ºäº†æ›´å¥½çš„è®¡ç®—$\log p(x;\theta)$ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªé¢å¤–çš„å˜åˆ†å‡½æ•°$q(z)$ï¼Œ$q(z)$ä¸ºå®šä¹‰åœ¨éšå˜é‡$z$ä¸Šçš„åˆ†å¸ƒã€‚æ ·æœ¬$x$çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p>
<p>$$\begin{align}\log p(x;\theta)&amp;=\log \sum_z q(z)\frac{p(x,z;\theta)}{q(z)}\&amp;\geq\sum_z q(z)\log \frac{p(x,z;\theta)}{q(z)}\&amp;\triangleq ELBO(q,x;\theta)\end{align}$$</p>
<p>å…¶ä¸­$ELBO(q,x;\theta)$ä¸ºå¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°$\log p(x;\theta)$çš„ä¸‹ç•Œï¼Œç§°ä¸ºè¯æ®ä¸‹ç•Œã€‚å…¬å¼ä¸­ä½¿ç”¨äº†Jensenä¸ç­‰å¼(å³å¯¹äºå‡¹å‡½æ•°$g$ï¼Œæœ‰$g(\mathbb{E}[x])\geq\mathbb{E}[g(X)]$)ã€‚åœ¨è¿™é‡Œï¼Œ$\frac{p(x,z;\theta)}{q(z)}$å¯è§†ä¸º$q(z)$çš„å‡½æ•°ï¼Œè®°ä¸º$f(q(z))$ï¼Œé‚£ä¹ˆ$f(q(z))$çš„æœŸæœ›å³$\mathbb{E}[f(q(z))]=\sum_z q(z)f(q(z))=\sum_z q(z)\frac{p(x,z;\theta)}{q(z)}$ã€‚è€Œæ ¹æ®Jensenä¸ç­‰å¼ï¼Œæœ‰$g(\mathbb{E}[f(q(z))])\geq\mathbb{E}[g(f(q(z)))]\Leftrightarrow g(\sum_z q(z)\frac{p(x,z;\theta)}{q(z)})\geq \sum_z q(z)g(\frac{p(x,z;\theta)}{q(z)})$ï¼Œåœ¨è¿™é‡Œ$g$å°±æ˜¯å¯¹æ•°å‡½æ•°ã€‚</p>
<hr>
<p>æ ¹æ®Jensenä¸ç­‰å¼å–ç­‰çš„æ¡ä»¶ï¼š$\frac{p(x,z;\theta)}{q(z)}=c$ï¼Œ$c$ä¸ºå¸¸æ•°ï¼Œæœ‰ï¼š</p>
<p>$$\begin{align}\sum_z p(x,z;\theta)&amp;=c\sum_z q(z)\\Leftrightarrow\sum_z p(x,z;\theta)&amp;=c\cdot1\end{align}$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$\begin{align}q(z)&amp;=\frac{p(x,z;\theta)}{\sum_z p(x,z;\theta)}\&amp;=\frac{p(x,z;\theta)}{p(x;\theta)}\&amp;=p(z|x;\theta)\end{align}$$</p>
<p>æ‰€ä»¥ï¼Œå½“ä¸”ä»…å½“$q(z)=p(z|x;\theta)$æ—¶ï¼Œ$\log p(x;\theta)=ELBO(q,x;\theta)$ã€‚</p>
<hr>
<p>äºæ˜¯æœ€å¤§åŒ–å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°$\log p(x;\theta)$çš„è¿‡ç¨‹å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>å…ˆæ‰¾åˆ°è¿‘ä¼¼åˆ†å¸ƒ$q(z)$ä½¿å¾—$\log p(x;\theta)=ELBO(q,x;\theta)$ï¼›</li>
<li>å†å¯»æ‰¾å‚æ•°$\theta$æœ€å¤§åŒ–$ELBO(q,x;\theta)$ã€‚</li>
</ol>
<p>è¿™å°±æ˜¯æœŸæœ›æœ€å¤§åŒ–(Expectation-Maximum,EM)ç®—æ³•ã€‚</p>
<hr>
<p>EMç®—æ³•é€šè¿‡è¿­ä»£çš„æ–¹æ³•ï¼Œä¸æ–­é‡å¤ç›´åˆ°æ”¶æ•›åˆ°æŸä¸ªå±€éƒ¨æœ€ä¼˜è§£ã€‚åœ¨ç¬¬$t$æ­¥æ›´æ–°æ—¶ï¼ŒEæ­¥å’ŒMæ­¥åˆ†åˆ«ä¸ºï¼š</p>
<ol>
<li><p>Eæ­¥ï¼šå›ºå®šå‚æ•°$\theta_t$ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆ†å¸ƒä½¿$ELBO(q,x;\theta_t)$æœ€å¤§ï¼Œå³ç­‰äº$\log p(x;\theta_t)$ï¼š$q_{t+1}(z)=\text{arg}_q \max ELBO(q,x;\theta_t)$ï¼›</p>
</li>
<li><p>Mæ­¥ï¼šå›ºå®š$q_{t+1}(z)$ï¼Œæ‰¾åˆ°ä¸€ç»„å‚æ•°ä½¿å¾—è¯æ®ä¸‹ç•Œæœ€å¤§ï¼Œå³ï¼š$\theta_{t+1}=\text{arg}<em>\theta\max ELBO(q</em>{t+1},x;\theta)$ã€‚</p>
</li>
</ol>
<hr>
<p>å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ä¿¡æ¯è®ºçš„è§†è§’æ¥è¿›è¡Œåˆ†è§£ï¼š</p>
<p>$$\begin{align}\log p(x;\theta)&amp;=\sum_z q(z)\log p(x;\theta)\&amp;=\sum_z q(z)(\log p(x,z;\theta)-\log p(z|x;\theta))\&amp;=\sum_z q(z)\log\frac{p(x,z;\theta)}{q(z)}-\sum_z q(z)\log\frac{p(z|x;\theta)}{q(z)}\&amp;=ELBO(q,x;\theta)+D_{KL}(q(z)\parallel p(z|x;\theta))\end{align}$$</p>
<p>å…¶ä¸­$D_{KL}(q(z)\parallel p(z|x;\theta))$</p>
<h1 id="Generative-Model-with-Hidden-Variable"><a href="#Generative-Model-with-Hidden-Variable" class="headerlink" title="Generative Model with Hidden Variable"></a>Generative Model with Hidden Variable</h1><p>å‡è®¾ä¸€ä¸ªç”Ÿæˆæ¨¡å‹åŒ…å«ä¸å¯è§‚æµ‹çš„éšå˜é‡ï¼Œå…¶ä¸­å¯è§‚æµ‹å˜é‡$x$ä¸ºä¸€ä¸ªé«˜ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ï¼Œè€Œä¸å¯è§‚æµ‹çš„éšå˜é‡$z$ä¸ºä¸€ä¸ªç›¸å¯¹ä½ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ã€‚</p>
<p>è¿™ä¸ªç”Ÿæˆæ¨¡å‹çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å¯ä»¥è¡¨è¾¾ä¸ºï¼š</p>
<p>$$p(x,z;\theta)=p(x|z;\theta)p(z;\theta)$$</p>
<p>å…¶ä¸­$p(z;\theta)$ä¸ºéšå˜é‡$z$çš„å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒï¼›$p(x|z;\theta)$ä¸ºå·²çŸ¥$z$æ¡ä»¶ä¸‹$x$çš„æ¦‚ç‡åˆ†å¸ƒã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾$p(z;\theta)$å’Œ$p(x|z;\theta)$æœä»æŸç§å¸¦å‚çš„åˆ†å¸ƒæ—ï¼Œå…¶å½¢å¼å·²çŸ¥ï¼Œè€Œå‚æ•°å¯ä»¥é€šè¿‡æœ€å¤§ä¼¼ç„¶æ¥è¿›è¡Œä¼°è®¡ã€‚</p>
<p>ç»™å®šä¸€ä¸ªæ ·æœ¬$x$ï¼Œå…¶å¯¹æ•°è¾¹é™…ä¼¼ç„¶$\log p(x;\theta)$å¯ä»¥åˆ†è§£ä¸ºï¼š</p>
<p>$$\log p(x;\theta)=ELBO(q,x;\theta,\phi)+D_{KL}(q(z;\phi)\parallel p(z|x;\theta))$$</p>
<p>å…¶ä¸­$q(z;\phi)$ä¸ºé¢å¤–å¼•å…¥çš„å˜åˆ†å¯†åº¦å‡½æ•°ï¼Œ$ELBO(q,x;\theta,\phi)$ä¸ºè¯æ®ä¸‹ç•Œï¼š</p>
<p>$$ELBO(q,x;\theta,\phi)=\mathbb{E}_{z\sim q(z;\phi)}[\log{\frac{p(x,z;\theta)}{q(z;\phi)}}]$$</p>
<p>æœ€å¤§åŒ–$\log p(x;\theta)$å¯ä»¥ç”¨EMç®—æ³•æ¥æ±‚è§£ï¼š</p>
<ul>
<li><strong>E-step:</strong> å¯»æ‰¾ä¸€ä¸ªå¯†åº¦å‡½æ•°$q(z;\phi)$ä½¿å…¶ç­‰äºæˆ–æ¥è¿‘äºåéªŒå¯†åº¦å‡½æ•°$p(z|x;\theta)$;</li>
<li><strong>M-step:</strong> ä¿æŒ$q(z;\phi)$å›ºå®šï¼Œå¯»æ‰¾$\theta$æ¥æœ€å¤§åŒ–$ELBO(q,x;\theta,\phi)$ã€‚</li>
</ul>
<p>åœ¨EMç®—æ³•çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œç†è®ºä¸Šæœ€ä¼˜çš„$q(z;\phi)$ä¸ºéšå˜é‡çš„åéªŒæ¦‚ç‡å¯†åº¦å‡½æ•°$p(z|x;\theta)$ï¼š</p>
<p>$$p(z|x;\theta)=\frac{p(x|z;\theta)p(z;\theta)}{\int_z p(x|z;\theta)p(z;\theta)\text{d}z}$$</p>
<p>åéªŒå¯†åº¦å‡½æ•°$p(z|x;\theta)$çš„è®¡ç®—æ˜¯ä¸€ä¸ªç»Ÿè®¡æ¨æ–­çš„é—®é¢˜ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹$p(x|z;\theta)$ä¹Ÿæ¯”è¾ƒéš¾ä»¥è®¡ç®—ã€‚</p>
<h1 id="Variational-Autoencoder"><a href="#Variational-Autoencoder" class="headerlink" title="Variational Autoencoder"></a>Variational Autoencoder</h1><p>å˜åˆ†è‡ªç¼–ç å™¨(Variational Autoencoder, VAE)çš„ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥åˆ†åˆ«å»ºæ¨¡ä¸¤ä¸ªå¤æ‚çš„æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š</p>
<ol>
<li><p>ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿå˜åˆ†åˆ†å¸ƒ$q(z;\phi)$ï¼Œç§°ä¸ºæ¨æ–­ç½‘ç»œã€‚æ¨æ–­ç½‘ç»œçš„è¾“å…¥ä¸º$x$ï¼Œè¾“å‡ºä¸ºå˜åˆ†åˆ†å¸ƒ$q(z|x;\phi)$ï¼›</p>
</li>
<li><p>ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿæ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ï¼Œç§°ä¸ºç”Ÿæˆç½‘ç»œã€‚ç”Ÿæˆç½‘ç»œçš„è¾“å…¥ä¸º$z$ï¼Œè¾“å‡ºä¸ºæ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ã€‚</p>
<p><img src="https://i.loli.net/2020/06/24/B1d9UtTzNfjG6e2.png"></p>
</li>
</ol>
<p>VAEçš„å›¾æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/06/24/GAhy281seQ3tbZT.png"></p>
<h2 id="Variational-Network"><a href="#Variational-Network" class="headerlink" title="Variational Network"></a>Variational Network</h2><p>å‡è®¾$q(z|x;\phi)$æ˜¯æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼š</p>
<p>$$q(z|x;\phi)=\mathcal{N}(z;\mu_I,\sigma^2_I I)$$</p>
<p>å…¶ä¸­$\mu_I$å’Œ$\sigma_I^2$æ˜¯é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ï¼Œå¯ä»¥é€šè¿‡æ¨æ–­ç½‘ç»œ$f_I(x;\phi)$æ¥é¢„æµ‹ï¼š</p>
<p>$$<br>\left[\begin{matrix}\mu_I\\sigma_I\end{matrix}\right]=f_I(x;\phi)<br>$$<br>æ¨æ–­ç½‘ç»œ$f_I(x;\phi)$å¯ä»¥æ˜¯ä¸€èˆ¬çš„å…¨è¿æ¥ç½‘ç»œæˆ–å·ç§¯ç½‘ç»œï¼Œæ¯”å¦‚ä¸€ä¸ªä¸¤å±‚çš„ç¥ç»ç½‘ç»œï¼š</p>
<p>$$\begin{align}h&amp;=\sigma(W^{(1)}x+b^{(1)})\\mu_I&amp;=W^{(2)}h+b^{(2)}\\sigma_I&amp;=\text{softplus}(W^{(3)}h+b^{(3)})\end{align}$$</p>
<p>å…¶ä¸­æ‰€æœ‰ç½‘ç»œå‚æ•°${W^{(1)},W^{(2)},W^{(3)},b^{(1)},b^{(2)},b^{(3)}}$å³å¯¹åº”äº†å˜åˆ†å‚æ•°$\phi$ã€‚</p>
<hr>
<p>æ¨æ–­ç½‘ç»œçš„ç›®æ ‡æ˜¯ä½¿å¾—$q(z|x;\phi)$æ¥å°½å¯èƒ½æ¥è¿‘çœŸå®çš„åéªŒ$p(z|x;\theta)$ï¼Œéœ€è¦æ‰¾åˆ°å˜åˆ†å‚æ•°$\phi^*$æ¥æœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„KLæ•£åº¦ï¼š</p>
<p>$$\phi^*=\text{arg}<em>\phi\min{D</em>{KL}(q(z|x;\phi)\parallel p(z|x;\theta))}$$</p>
<p>ç”±äº$p(z|x;\theta)$æœªçŸ¥ï¼Œæ•…KLæ•£åº¦æ— æ³•ç›´æ¥è®¡ç®—ï¼Œä¸è¿‡ç”±äº$D_{KL}(q(z|x;\phi)\parallel p(z|x;\theta))=\log p(x;\theta)-ELBO(q,x;\theta,\phi)$ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œï¼Œæœ‰ï¼š</p>
<p>$$\phi^*=\text{arg}_\phi\max{ELBO(q,x;\theta,\phi)}$$</p>
<h2 id="Generative-Network"><a href="#Generative-Network" class="headerlink" title="Generative Network"></a>Generative Network</h2><p>ç”Ÿæˆæ¨¡å‹çš„è”åˆåˆ†å¸ƒå¯ä»¥åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†ï¼šéšå˜é‡$z$çš„å…ˆéªŒåˆ†å¸ƒ$p(z;\theta)$å’Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ã€‚ä¸ºç®€å•èµ·è§ï¼Œä¸€èˆ¬å‡è®¾éšå˜é‡$z$çš„å…ˆéªŒåˆ†å¸ƒä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ$\mathcal{N}(z|0,I)$ï¼Œéšå˜é‡æ¯ä¸€ç»´ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$å¯ä»¥é€šè¿‡ç”Ÿæˆç½‘ç»œæ¥å»ºæ¨¡ï¼Œæˆ‘ä»¬åŒæ ·ç”¨å‚æ•°åŒ–çš„åˆ†å¸ƒæ—æ¥è¡¨ç¤ºæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ï¼Œè¿™äº›åˆ†å¸ƒæ—çš„å‡½æ•°å¯ä»¥ç”¨ç”Ÿæˆç½‘ç»œè®¡ç®—å¾—åˆ°ã€‚æ ¹æ®å˜é‡$x$çš„ç±»å‹ä¸åŒï¼Œå¯ä»¥å‡è®¾$p(x|z;\theta)$æœä»ä¸åŒçš„åˆ†å¸ƒæ—ã€‚å¦‚æœ$x\in{0,1}^d$æ˜¯$d$ç»´çš„äºŒå€¼å‘é‡ï¼Œå¯ä»¥å‡è®¾$\log p(x|z;\theta)$æœä»å¤šå˜é‡çš„ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œå³ï¼š</p>
<p>$$\begin{align}p(x|z;\theta)&amp;=\prod\limits_{i=1}^d p(x_i|z;\theta)\&amp;=\prod\limits_{i=1}^d \gamma_i^{x_i}(1-\gamma_i)^{(1-x_i)}\end{align}$$</p>
<p>å¦‚æœ$x\in\mathbb{R}^d$æ˜¯$d$ç»´çš„è¿ç»­å‘é‡ï¼Œå¯ä»¥å‡è®¾$p(x|z;\theta)$æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼Œå³ï¼š</p>
<p>$$p(x|z;\theta)=\mathcal{N}(x;\mu_G,\sigma_G^2 I)$$</p>
<hr>
<p>ç”Ÿæˆç½‘ç»œçš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ç»„$\theta^*$æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œ$ELBO(q,x;\theta,\phi)$ï¼š</p>
<p>$$\theta^*=\text{arg}_\theta\max ELBO(q,x;\theta,\phi)$$</p>
<h2 id="Model-Combination"><a href="#Model-Combination" class="headerlink" title="Model Combination"></a>Model Combination</h2><p>æ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œçš„ç›®æ ‡éƒ½æ˜¯æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œå› æ­¤æ€»çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p>
<p>$$\begin{align}\max_{\theta,\phi}ELBO(q,x;\theta,\phi)&amp;=\max_{\theta,\phi}\mathbb{E}<em>{z\sim q(z;\phi)}[\log\frac{p(x|z;\theta)p(z;\theta)}{q(z;\theta)}]\&amp;=\max</em>{\theta,\phi}\mathbb{E}<em>{z\sim q(z|x;\phi)}[\log p(x|z;\theta)]-D</em>{KL}(q(z|x;\phi)\parallel p(z;\theta))\end{align}$$</p>
<p>å…¶ä¸­å…ˆéªŒåˆ†å¸ƒ$p(z;\theta)=\mathcal{N}(z|0,I)$ã€‚</p>
<p>å…¬å¼ä¸­$\mathbb{E}_{z\sim q(z|x;\phi)}[\log p(x|z;\theta)]$ä¸€èˆ¬é€šè¿‡é‡‡æ ·çš„æ–¹å¼è¿›è¡Œè®¡ç®—ï¼Œæœ€åå–å¹³å‡å€¼ã€‚</p>
<h2 id="Model-Training"><a href="#Model-Training" class="headerlink" title="Model Training"></a>Model Training</h2><p>ç»™å®šæ•°æ®é›†$\mathcal{D}$ï¼ŒåŒ…å«$N$ä¸ªä»æœªçŸ¥æ•°æ®åˆ†å¸ƒä¸­æŠ½å–çš„ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬$x^{(1)},x^{(2)},\cdots,x^{(N)}$ã€‚å˜åˆ†è‡ªç¼–ç å™¨çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p>
<p>$$\mathcal{J}(\phi,\theta|\mathcal{D})=\sum\limits_{n=1}^N(\frac{1}{M}\sum\limits_{m=1}^M\log p(x^{(n)}|z^{(n,m)};\theta)-D_{KL}(q(z|x^{(n)};\phi)\parallel\mathcal{N}(z;0,I)))$$</p>
<p>å¦‚æœé‡‡ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œæ¯æ¬¡ä»æ•°æ®é›†ä¸­é‡‡ä¸€ä¸ªæ ·æœ¬$x$ï¼Œç„¶åæ ¹æ®$q(z|x;\phi)$é‡‡ä¸€ä¸ªéšå˜é‡$z$ï¼Œåˆ™ç›®æ ‡å‡½æ•°å˜ä¸ºï¼š</p>
<p>$$\mathcal{J}(\phi,\theta|x)=\log p(x|z;\theta)-D_{KL}(q(z|x;\phi)\parallel\mathcal{N}(z;0,I))$$</p>
<p>å‡è®¾$q(z|x;\phi)$æ˜¯æ­£æ€åˆ†å¸ƒï¼ŒKLæ•£åº¦å¯ç›´æ¥ç®—å‡ºï¼š</p>
<p>$$D_{KL}(\mathcal{N}(\mu_1,\Sigma_1)\parallel\mathcal(\mu_2,\Sigma_2))\=\frac{1}{2}(\text{tr}(\sigma_I^2 I)+\mu_I^T\mu_I-d-\log(|\sigma_I^2 I|))$$</p>
<hr>
<p>å†å‚æ•°åŒ–æ˜¯å°†ä¸€ä¸ªå‚æ•°ä¸º$u$çš„å‡½æ•°$f(u)$ï¼Œé€šè¿‡ä¸€ä¸ªå‡½æ•°$u=g(v)$ï¼Œè½¬æ¢ä¸ºå‚æ•°ä¸º$v$çš„å‡½æ•°$\hat{f}(v)=f(g(v))$ã€‚åœ¨å˜åˆ†è‡ªç¼–ç å™¨ä¸­ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ±‚éšæœºå˜é‡$z$å…³äº$\phi$çš„å¯¼æ•°ã€‚ä½†ç”±äºæ˜¯é‡‡æ ·çš„æ–¹å¼ï¼Œæ— æ³•ç›´æ¥åˆ»ç”»$z$å’Œ$\phi$ä¹‹é—´çš„å‡½æ•°å…³ç³»ï¼Œå› æ­¤ä¹Ÿæ— æ³•è®¡ç®—å¯¼æ•°ã€‚</p>
<p>å¦‚æœ$z\sim q(z|x;\phi)$çš„éšæœºæ€§ç‹¬ç«‹äºå‚æ•°$\phi$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å†å‚æ•°åŒ–çš„æ–¹æ³•æ¥è®¡ç®—å¯¼æ•°ã€‚å‡è®¾$q(z|x;\phi)$ä¸ºæ­£æ€åˆ†å¸ƒ$\mathcal{N}(\mu_I,\sigma^2_I I)$ï¼Œå…¶ä¸­$\mu_I$å’Œ$\sigma_I$æ˜¯æ¨æ–­ç½‘ç»œ$f_I(x;\phi)$çš„è¾“å‡ºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼é‡‡æ ·$z$ï¼š</p>
<p>$$z=\mu_I+\sigma_I\odot \varepsilon$$</p>
<p>å…¶ä¸­$\varepsilon\sim\mathcal{N}(0,I)$ã€‚è¿™æ ·$z$å’Œ$\mu_I,\sigma_I$çš„å…³ç³»ä»é‡‡æ ·å…³ç³»å˜ä¸ºå‡½æ•°å…³ç³»ã€‚</p>
<hr>
<p>å¦‚æœè¿›ä¸€æ­¥å‡è®¾$p(x|z;\theta)$æœä»é«˜æ–¯åˆ†å¸ƒ$\mathcal{N}(x|\mu_G,I)$ï¼Œå…¶ä¸­$\mu_G=f_G(z;\theta)$æ˜¯ç”Ÿæˆç½‘ç»œçš„è¾“å‡ºï¼Œåˆ™ç›®æ ‡å‡½æ•°å¯ä»¥ç®€åŒ–ä¸ºï¼š</p>
<p>$$\mathcal{J}(\phi,\theta|x)=-\parallel x-\mu_G\parallel^2+D_{KL}(\mathcal{N}(\mu_I,\sigma_I)\parallel\mathcal{N}(0,I))$$</p>
<p>å…¶ä¸­ç¬¬ä¸€é¡¹å¯ä»¥è¿‘ä¼¼çœ‹ä½œæ˜¯è¾“å…¥$x$çš„é‡æ„æ­£ç¡®æ€§ï¼Œç¬¬äºŒé¡¹å¯ä»¥çœ‹ä½œæ˜¯æ­£åˆ™åŒ–é¡¹ã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-10-18T15:17:07.000Z" title="2019-10-18 11:17:07 â”œF10: PMâ”¤">2019-10-18</time>å‘è¡¨</span><span class="level-item"><time dateTime="2020-06-25T08:25:06.176Z" title="2020-6-25 4:25:06 â”œF10: PMâ”¤">2020-06-25</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/RNN/">RNN</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/18/Recurrent-Neural-Networks-for-Multivariate-Time-Series-with-Missing-Values/">Recurrent Neural Networks for Multivariate Time Series with Missing Values</a></h1><div class="content"><h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>æ–‡ä¸­æå‡ºäº†ä¸€ç§å¯ä»¥å¤„ç†å¸¦ç¼ºå¤±å€¼å¤šä¸ºæ—¶é—´åºåˆ—çš„GRUæ¨¡å‹ï¼š<strong>GRU-D</strong>ã€‚æœ¬æ¨¡å‹ä¸ä»…å¯ä»¥æ•æ‰æ—¶é—´åºåˆ—ä¸­çš„é•¿æœŸä¾èµ–æ¨¡å¼ï¼Œå¹¶ä¸”è¿˜èƒ½åˆ©ç”¨æ—¶é—´åºåˆ—ä¸­çš„ç¼ºå¤±æ¨¡å¼æ¥è¾¾åˆ°æ›´å¥½çš„æ—¶é—´åºåˆ—é¢„æµ‹æ•ˆæœã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.nature.com/articles/s41598-018-24271-9">åŸæ–‡</a></p>
<h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Notations"><a href="#Notations" class="headerlink" title="Notations"></a>Notations</h2><p>è®°åŒ…å«$D$ä¸ªå˜é‡çš„å¤šå˜é‡æ—¶é—´åºåˆ—ä¸º$X=(x_1,x_2,\cdots,x_T)^T\in\mathbb{R}^{T\times D}$ï¼Œå…¶ä¸­å¯¹äºæ¯ä¸ª$t\in{1,2,\cdots,T},x_t\in\mathbb{R}^D$è¡¨ç¤ºæ—¶é—´åºåˆ—åœ¨æ—¶é—´$t$çš„è§‚æµ‹å€¼ï¼Œ$x_t^d$è¡¨ç¤º$x_t$çš„ç¬¬$d$ä¸ªæˆåˆ†ã€‚è®°$s_t\in\mathbb{R}$ä¸º$t$æ—¶åˆ»çš„æ—¶é—´æˆ³ï¼Œå¹¶å‡è®¾ç¬¬ä¸€ä¸ªè§‚æµ‹å€¼çš„æ—¶é—´æˆ³ä¸º$0$ã€‚å¯¹äºåŒ…å«ç¼ºå¤±å€¼çš„æ—¶é—´åºåˆ—ï¼Œæˆ‘ä»¬ç”¨<strong>Masking Vector</strong> $m_t\in{0,1}$è¿›è¡Œæ ‡è®°ï¼ŒåŒæ—¶å¯¹æ¯ä¸ª$x_t^d$ç»´æŠ¤è·ç¦»ä¸Šä¸€ä¸ªè§‚æµ‹å€¼çš„<strong>Time Interval</strong> $\delta_t^d\in\mathbb{R}$ï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>m_t^d=\begin{cases}1, &amp;\text{if }x_t^d\text{ is observed}\0, &amp;\text{otherwise}\end{cases}<br>$$</p>
<p>$$<br>\delta_t^d=\begin{cases}s_t-s_{t-1}+\delta_{t-1}^d, &amp;t&gt;1,m_{t-1}^d=0\s_t-s_{t-1}, &amp;t&gt;1, m_{t-1}^d=1\0, &amp;t=1\end{cases}<br>$$</p>
<p>ä¸‹å›¾æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/C4FKQw2AZ9xkalo.png"></p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨æ—¶é—´åºåˆ—çš„åˆ†ç±»é—®é¢˜ï¼Œå³ç»™å®šæ•°æ®é›†$\mathcal{D}={(X_n,s_n,M_n)}_{n=1}^N$ï¼Œæˆ‘ä»¬è¦å¯¹æ¯ä¸ªæ ·æœ¬çš„ç±»åˆ«è¿›è¡Œé¢„æµ‹$l_n\in{1,\cdots,L}$ã€‚</p>
<h2 id="GRU-RNN-for-Time-Series-Classification"><a href="#GRU-RNN-for-Time-Series-Classification" class="headerlink" title="GRU-RNN for Time Series Classification"></a>GRU-RNN for Time Series Classification</h2><p>GRUæ˜¯ä¸€ç§æ”¹è¿›ç‰ˆæœ¬çš„RNNï¼Œå…¶æœ€å¤§ä¸åŒæ˜¯åŠ å…¥äº†é—¨æ§æœºåˆ¶ã€‚GRUå•å…ƒçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="https://i.loli.net/2020/06/25/wpKQsxEklizVTtm.png" style="zoom: 33%;" />

<p>GRUåŒ…å«äº†é‡ç½®é—¨å’Œæ›´æ–°é—¨ï¼Œå…¶ä¸­é‡ç½®é—¨$R_t$è´Ÿè´£æ§åˆ¶ä¸Šä¸€æ—¶é—´çš„éšçŠ¶æ€$h_{t-1}$æœ‰å¤šå°‘éƒ¨åˆ†éœ€è¦ä¿ç•™ï¼Œè€Œæ›´æ–°é—¨åˆ™å†³å®šç”±$R_t$è®¡ç®—å‡ºæ¥çš„å€™é€‰éšçŠ¶æ€$\tilde{h}<em>t$æœ‰å¤šå°‘éƒ¨åˆ†éœ€è¦ä¿ç•™ã€‚æœ€åå½“å‰æ—¶é—´çš„éšçŠ¶æ€ç”±$h</em>{t-1}$å’Œ$\tilde{h}<em>t$å…±åŒç®—å‡ºã€‚GRUçš„çŠ¶æ€æ›´æ–°å…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\begin{align}<br>R_t&amp;=\sigma(W_rx_t+U_rh</em>{t-1}+b_r)\<br>Z_t&amp;=\sigma(W_zx_t+U_zh_{t-1}+b_z)\<br>\tilde{h}<em>t&amp;=\text{tanh}(Wx_t+U(R_t\odot h</em>{t-1})+b)\<br>h_t&amp;=(1-Z_t)\odot h_{t-1}+Z_t\odot \tilde{h}_t<br>\end{align}<br>$$<br>æ–‡ä¸­æå‡ºäº†ä¸€äº›å¤„ç†ç¼ºå¤±å€¼çš„ç®€å•æ–¹æ³•ï¼š</p>
<ol>
<li>ç›´æ¥ç”¨å‡å€¼æ›¿ä»£ï¼š$x_t^d\leftarrow m_t^dx_t^d+(1-m_t^d)\tilde{x}^d$ï¼Œå…¶ä¸­$\tilde{x}^d=\frac{\sum_{n=1}^N\sum_{t=1}^{T_n}m_{t,n}^d x_{t,n}^d}{\sum_{n=1}^N\sum_{t=1}^{T_n}m_{t,n}^d\tilde{x}^d}$ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Mean</strong>ï¼›</li>
<li>ç”¨ä¸Šä¸€ä¸ªè§‚æµ‹å€¼æ›¿ä»£ï¼š$x_t^d\leftarrow m_t^d x_t^d+(1-m_t^d)x_{t^\prime}^d$ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Forward</strong>ï¼›</li>
<li>ä¸å¡«å……ï¼Œå°†æ˜¯å¦ç¼ºå¤±ï¼Œè·ç¦»ä¸Šä¸€ä¸ªè§‚æµ‹å€¼çš„æ—¶é—´ä½œä¸ºé¢å¤–ä¿¡æ¯è¾“å…¥ï¼š$x_t^{(n)}\leftarrow[x_t^{(n)};m_t^{(n)};\delta_t^{(n)}]$ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Simple</strong>ã€‚</li>
</ol>
<h3 id="GRU-D-Model-with-Trainable-Decays"><a href="#GRU-D-Model-with-Trainable-Decays" class="headerlink" title="GRU-D: Model with Trainable Decays"></a>GRU-D: Model with Trainable Decays</h3><p>æ–‡ä¸­æå‡ºäº†æ—¶é—´åºåˆ—ç¼ºå¤±å€¼çš„ä¸¤ä¸ªæ€§è´¨ï¼šä¸€ä¸ªæ˜¯åœ¨ä¸Šä¸€ä¸ªè§‚æµ‹å€¼è·ç¦»å¾ˆè¿œçš„æƒ…å†µä¸‹ç¼ºå¤±å€¼å€¾å‘äºæ¥è¿‘ä¸€ä¸ªé»˜è®¤çš„å€¼ï¼Œç¬¬äºŒä¸ªæ˜¯ç¼ºå¤±å€¼çš„å½±å“ä¼šéšç€æ—¶é—´å‡å¼±ã€‚ä¸ºäº†ä½“ç°ä¸Šè¿°ä¸¤ç‚¹ï¼Œæ–‡ä¸­æå‡ºäº†GPU-Dæ¨¡å‹ï¼Œæ¨¡å‹æ¡†æ¶å¦‚ä¸‹ï¼š</p>
<img src="https://i.loli.net/2020/06/25/aXbS4ADkLfeHPCR.png" style="zoom:67%;" />

<p>åœ¨æ¨¡å‹ä¸­ï¼Œ<strong>Decay Rates</strong>è¢«è®¾å®šä¸ºä¸€ä¸ªå¸¦å‚æ•°çš„å‡½æ•°å’ŒGRUä¸€èµ·è®­ç»ƒï¼š<br>$$<br>\gamma_t=\exp{-\max(0,W_\gamma\delta_t+b_\gamma)}<br>$$</p>
<p>$$<br>\hat{x}<em>t^d=m_t^dx_t^d+(1-m_t^d)(\gamma_{x_t}^dx_{t^\prime}^d+(1-\gamma</em>{x_t}^d)\tilde{x}^d)<br>$$<br>å…¶ä¸­$x_{t^\prime}^d$æ˜¯ç¬¬$d$ä¸ªå˜é‡çš„ä¸Šä¸€ä¸ªè§‚æµ‹å€¼ï¼Œ$\tilde{x}^d$æ˜¯ç¬¬$d$ä¸ªå˜é‡çš„ç»éªŒå‡å€¼ã€‚è¿™æ ·$\hat{x}_t^d$å°±ä»£è¡¨ç»è¿‡<strong>Input Decay</strong>çš„è¾“å…¥ã€‚</p>
<p>æ–‡ä¸­æåˆ°åªç”¨<strong>Input Decay</strong>æ˜¯ä¸å¤Ÿçš„ï¼Œé™¤æ­¤ä¹‹å¤–ä½œè€…è¿˜ä½¿ç”¨äº†<strong>Hidden State Decay</strong>ï¼Œå³å¯¹$h_{t-1}$è¿›è¡ŒDecayï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\hat{h}<em>{t-1}=\gamma</em>{h_t}\odot h_{t-1}<br>$$<br>ç”¨Decayä¹‹åçš„$\hat{x}<em>t$å’Œ$\hat{h}</em>{t-1}$æ›¿æ¢åŸå§‹çš„GRUå…¬å¼å°±å¾—åˆ°äº†GRU-Dæ¨¡å‹ï¼š<br>$$<br>\begin{align}<br>R_t&amp;=\sigma(W_r\hat{x}<em>t-U_r\hat{h}_{t-1}+V_rm_t+b_r)\<br>Z_t&amp;=\sigma(W_z\hat{x}_t+U_z\hat{h}_{t-1}+V_zm_t+b_z)\<br>\tilde{h}_t&amp;=\text{tanh}(W\hat{x}_t+U(R_t\odot \hat{h}</em>{t-1})+Vm_t+b)\<br>h_t&amp;=(1-z_t)\odot \hat{h}_{t-1}+z_t\odot\tilde{h}_t<br>\end{align}<br>$$</p>
<h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Baseline-Imputation-Methods"><a href="#Baseline-Imputation-Methods" class="headerlink" title="Baseline Imputation Methods"></a>Baseline Imputation Methods</h2><p>ä¸‹å›¾ä¸ºæ–‡ä¸­æ¯”è¾ƒä¸­ç”¨åˆ°çš„Baselineï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/BFQdwMOXLc15mnl.png"></p>
<h2 id="Baseline-Prediction-Methods"><a href="#Baseline-Prediction-Methods" class="headerlink" title="Baseline Prediction Methods"></a>Baseline Prediction Methods</h2><p>ä¸‹å›¾ä¸ºæ–‡ä¸­ç”¨åˆ°çš„ç”¨æ¥é¢„æµ‹çš„Baselineï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/qFxDRBLvNpAIjMs.png"></p>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>æ–‡ä¸­ç”¨åˆ°çš„æ•°æ®é›†å¦‚ä¸‹ï¼š</p>
<ul>
<li><em>Gesture phase segmentation dataset (Gesture)</em>. </li>
<li><em>PhysioNet Challenge 2012 dataset (PhysioNet)</em>.</li>
<li><em>MIMIC-â…¢ dataset (MIMIC-â…¢)</em>. </li>
</ul>
<p>ä¸‹å›¾å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨äººå·¥åˆæˆæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/6GVYuxoFP5yHAjf.png"></p>
<p>ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ¨¡å‹åœ¨é¢„æµ‹ä»»åŠ¡è¡¨ç°çš„å¯¹æ¯”ï¼š</p>
<img src="https://i.loli.net/2020/06/25/qTZsgtGewh19Y8V.png" style="zoom: 67%;" />

<p>ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨MIMIC-â…¢å’ŒPhysioNetæ•°æ®é›†ä¸Šçš„å¤šä»»åŠ¡è¡¨ç°ï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/dQiqebwYTCVfm5W.png"></p>
<p>ä¸‹å›¾åˆ†åˆ«å±•ç¤ºäº†æ¨¡å‹å­¦åˆ°çš„<strong>Input Decay</strong>å’Œ<strong>Hidden State Decay</strong>ï¼š</p>
<img src="https://i.loli.net/2020/06/25/2F7MrgOXA9nuZqC.png" style="zoom:67%;" />
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-10-18T15:00:57.000Z" title="2019-10-18 11:00:57 â”œF10: PMâ”¤">2019-10-18</time>å‘è¡¨</span><span class="level-item"><time dateTime="2020-09-12T02:54:14.061Z" title="2020-9-12 10:54:14 â”œF10: AMâ”¤">2020-09-12</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/">Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network</a></h1><div class="content"><h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>æœ¬æ–‡æå‡ºäº†<em>OmniAnomaly</em>ï¼šä¸€ç§é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—çš„éšæœºå¾ªç¯ç¥ç»ç½‘ç»œå¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚è¯¥æ¨¡å‹è¿ç”¨äº†ä¸€ç³»åˆ—æŠ€æœ¯æ¥æ•æ‰å¤šå˜é‡æ—¶é—´åºåˆ—çš„æ­£å¸¸æ¨¡å¼ï¼Œå¹¶åœ¨æ£€æµ‹é˜¶æ®µåŸºäºé‡æ„è¯¯å·®æ¥æ£€æµ‹å¼‚å¸¸ï¼ŒåŒæ—¶æœ¬æ–‡è¿˜æä¾›äº†ä¸€å®šçš„ç†è®ºè§£é‡Šã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.kdd.org/kdd2019/accepted-papers/view/robust-anomaly-detection-for-multivariate-time-series-through-stochastic-re">åŸæ–‡</a></p>
<h1 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h1><ol>
<li>æå‡ºäº†<em>OmniAnomaly</em>ï¼Œä¸€ç§åŸºäºéšæœºå¾ªç¯ç¥ç»ç½‘ç»œçš„å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼›</li>
<li>æå‡ºäº†é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„è§£é‡Šæ–¹æ³•ï¼›</li>
<li>é€šè¿‡å®éªŒè¯æ˜äº†<em>OmniAnomaly</em>ä¸­æ‰€ç”¨çš„å…³é”®æŠ€æœ¯çš„æœ‰æ•ˆæ€§ï¼ŒåŒ…æ‹¬GRUï¼Œplanar NF, stochastic variable connectionå’Œadjusted Peaks-Over-Threshold methodï¼›</li>
<li>é€šè¿‡å¤§é‡çš„å®éªŒæˆ‘ä»¬è¯æ˜äº†<em>OmniAnomaly</em>çš„æœ‰æ•ˆæ€§ï¼›</li>
<li>å‘å¸ƒäº†ä»£ç å’Œæ•°æ®é›†ã€‚</li>
</ol>
<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><h2 id="Linear-Gaussian-State-Space-Model"><a href="#Linear-Gaussian-State-Space-Model" class="headerlink" title="Linear Gaussian State Space Model"></a>Linear Gaussian State Space Model</h2><p>çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆState Space Model, SSMï¼‰çš„æ¦‚å¿µæ¥è‡ªäºæ§åˆ¶ç†è®ºï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®¨è®ºå…¶åœ¨æ—¶é—´åºåˆ—ä¸­çš„åº”ç”¨ã€‚å…¶å¤§æ¦‚æ€æƒ³æ˜¯æˆ‘ä»¬è®¤ä¸ºæ—¶é—´åºåˆ—åœ¨æ—¶åˆ»$t$çš„è§‚æµ‹å€¼$z_t$æ˜¯ä¸€ä¸ªéšå«çŠ¶æ€$\boldsymbol{l}<em>t$çš„æ¡ä»¶åˆ†å¸ƒ$p(z_t|\boldsymbol{l}_t)$ï¼Œè€Œè¿™ä¸ªéšå«çŠ¶æ€$\boldsymbol{l}_t$åˆ»ç”»äº†æ—¶é—´åºåˆ—çš„å†…åœ¨è§„å¾‹ï¼ŒåŒæ—¶éšå«çŠ¶æ€ä¼šéšç€æ—¶é—´æ›´æ–°ï¼Œå³æœä»æ¡ä»¶åˆ†å¸ƒ$p(\boldsymbol{l}_t|\boldsymbol{l}</em>{t-1})$ã€‚</p>
<p>åœ¨çº¿æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆLinear State Space Modelï¼‰ä¸­æˆ‘ä»¬ä»¥å¦‚ä¸‹çš„æ–¹å¼åˆ»ç”»éšå«çŠ¶æ€çš„æ›´æ–°ï¼š<br>$$<br>\boldsymbol{l}_t=\boldsymbol{F}<em>t\boldsymbol{l}</em>{t-1}+\boldsymbol{g}_t\varepsilon_t, \space\space\space\varepsilon_t\sim\mathcal{N}(0,1)<br>$$<br>$\boldsymbol{F}_t$ä¸ºç¡®å®šçš„çŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œè€Œ$\boldsymbol{g}_t\varepsilon_t$åˆ™è¡¨ç¤ºäº†çŠ¶æ€è½¬ç§»çš„éšæœºæ€§ã€‚</p>
<p>è§‚æµ‹å€¼$z_t$ä»éšå«çŠ¶æ€$\boldsymbol{l}<em>t$è®¡ç®—è€Œæ¥ï¼š<br>$$<br>\begin{align}<br>z_t&amp;=y_t+\sigma_t\epsilon_t,\<br>y_t&amp;=\boldsymbol{a}_t^\top\boldsymbol{l}</em>{t-1}+b_t,\<br>\epsilon_t&amp;\sim\mathcal{N}(0,1)<br>\end{align}<br>$$<br>å…¶ä¸­$\boldsymbol{a}_t\in\mathbb{R}^L,\sigma_t\in \mathbb{R},b_t\in\mathbb{R}$éƒ½æ˜¯é¢å¤–çš„å‚æ•°ã€‚åˆå§‹çŠ¶æ€$\boldsymbol{l}_0$åˆ™ä»ä¸€ä¸ªç‹¬ç«‹çš„é«˜æ–¯åˆ†å¸ƒå¾—æ¥ï¼Œå³$\boldsymbol{l}_0\sim N(\boldsymbol\mu_0,\text{diag}(\boldsymbol{\sigma}_0^2))$ã€‚</p>
<p>ä»¤å‚æ•°é›†åˆ$\Theta_t=(\boldsymbol{\mu}<em>0,\boldsymbol{\Sigma}<em>0,\boldsymbol{F}_t,\boldsymbol{g}_t,\boldsymbol{a}_t,b_t,\sigma_t),\forall t&gt;0$ï¼Œä¸€èˆ¬æ¥è¯´å‚æ•°é›†åˆä¸ä¼šéšç€æ—¶é—´å˜åŒ–ï¼Œå³æ¯ä¸ªæ—¶åˆ»$t$å…±äº«åŒæ ·çš„å‚æ•°$\Theta_t=\Theta,\forall t&gt;0$ã€‚å¯¹å‚æ•°çš„ä¼°è®¡å¯ä»¥é‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ï¼š<br>$$<br>\begin{align}<br>\Theta^*</em>{1:T}&amp;=\arg\max</em>{\Theta_{1:T}}p(z_{1:T}|\Theta_{1:T}),\<br>\end{align}<br>$$<br>å…¶ä¸­ï¼š<br>$$<br>\begin{align}<br>p(z_{1:T}|\Theta_{1:T})&amp;=p(z_1|\Theta_1)\prod\limits_{t=2}^T p(z_t|z_{1:t-1},\Theta_{1:t})\<br>&amp;=\int p(\boldsymbol{l}<em>0)\left[\prod\limits</em>{t=1}^T p(z_t|\boldsymbol{l}<em>t)p(\boldsymbol{l}<em>t|\boldsymbol{l}</em>{t-1})\right]\mathrm{d}\boldsymbol{l}</em>{0:T}<br>\end{align}<br>$$</p>
<h2 id="Planar-Normalizing-Flow"><a href="#Planar-Normalizing-Flow" class="headerlink" title="Planar Normalizing Flow"></a>Planar Normalizing Flow</h2><h3 id="Normalizing-Flows"><a href="#Normalizing-Flows" class="headerlink" title="Normalizing Flows"></a>Normalizing Flows</h3><p>VAEé‡‡ç”¨ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ$q_\phi(z|x)$æ¥è¿‘ä¼¼çœŸå®çš„åéªŒåˆ†å¸ƒ$p(z|x)$ï¼Œå¹¶æ¨å¯¼å‡º$\log p_\theta(x)$çš„ä¸‹ç•Œï¼ˆç§°ä¸ºELBOï¼‰æ¥ä½œä¸ºä¼˜åŒ–ç›®æ ‡å‡½æ•°ï¼š<br>$$<br>\begin{align}<br>\log p_\theta(x)&amp;=\log \int p_\theta(x|z)p(z)\mathrm{d}z\<br>&amp;=\log\int\frac{q_\phi(z|x)}{q_\phi(z|x)}p_\theta(x|z)p(z)\mathrm{d}z\<br>&amp;\geq-D_{KL}[q_\phi(z|x)\parallel p(z)]+\mathbb{E}<em>q[\log p_\theta(x|z)]<br>\end{align}<br>$$<br>$\log p_\theta(x)$ä¸ELBOå–ç­‰çš„æ¡ä»¶æ˜¯$D</em>{KL}[q_\phi(z|x)\parallel p(z)]$ï¼Œè¡¨æ˜å˜åˆ†åˆ†å¸ƒå®Œå…¨åŒ¹é…äº†çœŸå®çš„åéªŒåˆ†å¸ƒã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒçœŸå®çš„åéªŒåˆ†å¸ƒå¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œè€Œæˆ‘ä»¬çš„å˜åˆ†åˆ†å¸ƒé€šå¸¸æ˜¯ä¸€ä¸ªç¡®å®šçš„è¾ƒä¸ºç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚è¿™æ ·å˜åˆ†åˆ†å¸ƒå¯èƒ½å¾ˆéš¾å¯¹çœŸå®åéªŒåˆ†å¸ƒå¾—åˆ°ä¸€ä¸ªå¾ˆå¥½çš„æ‹Ÿåˆã€‚</p>
<p>ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ ‡å‡†åŒ–æµï¼ˆNormalizing Flowsï¼‰ã€‚æ ‡å‡†åŒ–æµæ˜¯ä»ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒå‡ºå‘ï¼Œæ‰§è¡Œä¸€ç³»åˆ—å¯é€†çš„æ˜ å°„ï¼Œå°†åŸå§‹ç®€å•çš„åˆ†å¸ƒè½¬åŒ–ä¸ºä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒã€‚</p>
<p>é¦–å…ˆè€ƒè™‘ä¸€ä¸ªå…‰æ»‘çš„ã€å¯é€†çš„æ˜ å°„$f:\mathbb{R}^d\mapsto \mathbb{R}^d$ï¼Œè®°$g=f^{-1}$ï¼Œé‚£ä¹ˆ$g\circ f(\mathbf{z})=\mathbf{z}$ã€‚ä»¤$\mathbf{z}^\prime=f(\mathbf{z})$ï¼Œé‚£ä¹ˆ$\mathbf{z}^\prime$çš„åˆ†å¸ƒä¸ºï¼š<br>$$<br>q(\mathbf{z}^\prime)=q(\mathbf{z})\left|\text{det}\frac{\partial f^{-1}}{\partial \mathbf{z}^\prime}\right|=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}<br>$$<br>å¼ä¸­$q(\mathbf{z}^\prime)=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}$è¯´æ˜äº†$\mathbf{z}^\prime$çš„åˆ†å¸ƒç­‰äº$\mathbf{z}$çš„åˆ†å¸ƒä¹˜ä¸Š$f$çš„JacobiançŸ©é˜µçš„è¡Œåˆ—å¼çš„å€’æ•°ã€‚é‚£ä¹ˆå¯¹äºæ˜ å°„å¤šæ¬¡çš„æƒ…å†µï¼š<br>$$<br>\mathbf{z}_K=f_K\circ\cdots\circ f_2\circ f_1(\mathbf{z}_0)<br>$$<br>$\mathbf{z}<em>K$çš„åˆ†å¸ƒå¯ä»¥é€šè¿‡é“¾å¼è®¡ç®—å¾—åˆ°ï¼š<br>$$<br>\ln q_K(\mathbf{z}_K)=\ln q_0(\mathbf{z}_0)-\sum\limits</em>{k=1}^K\ln\left|\text{det}\frac{\partial f_k}{\partial \mathbf{z}_{k-1}}\right|<br>$$</p>
<h3 id="Planar-Flows"><a href="#Planar-Flows" class="headerlink" title="Planar Flows"></a>Planar Flows</h3><p>è€ƒè™‘ä¸€ä¸ªå˜æ¢æ—ï¼š<br>$$<br>f(\mathbf{z})=\mathbf{z}+\mathbf{u}h(\mathbf{w}^\top\mathbf{z}+b)<br>$$<br>å…¶ä¸­$\lambda={\mathbf{w}\in \mathbb{R}^d,\mathbf{u}\in\mathbb{R}^d,b\in\mathbb{R}}$ä¸ºå‚æ•°é›†åˆï¼Œ$h(\cdot)$ä¸ºå…ƒç´ çº§çš„éçº¿æ€§å‡½æ•°ï¼ˆå¦‚å„ç§æ¿€æ´»å‡½æ•°ï¼‰ã€‚ä»¤$\psi(\mathbf{z})=h^\prime(\mathbf{w}^\top\mathbf{z}+b)\mathbf{w}$ï¼Œåˆ™$f$çš„JacobiançŸ©é˜µè¡Œåˆ—å¼ç»å¯¹å€¼ç­‰äºï¼š<br>$$<br>\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|=\left|\text{det}(\mathbf{I}+\mathbf{u}\psi(\mathbf{z})^\top)\right|=\left|1+\mathbf{u}^\top\psi(\mathbf{z})\right|<br>$$<br>ä½†æ˜¯$f$å¹¶ä¸ä¿è¯æ€»æ˜¯å¯é€†çš„ï¼Œå¦‚$h(x)=\tanh(x)$æ—¶ï¼Œ$f$å¯é€†çš„æ¡ä»¶æ˜¯$\mathbf{w}^\top \mathbf{u}\geq-1$ã€‚</p>
<p>ä¸‹é¢è®¨è®ºå¦‚ä½•ä¿è¯å¯é€†çš„æ¡ä»¶ã€‚è€ƒè™‘å°†$\mathbf{z}$åˆ†è§£ä¸º$\mathbf{z}=\mathbf{z}_\bot+\mathbf{z}_\parallel$ï¼Œå…¶ä¸­$\mathbf{z}_\bot$ä¸$\mathbf{w}$æ­£äº¤ï¼Œ$\mathbf{z}_\parallel$ä¸$\mathbf{w}$å¹³è¡Œï¼Œé‚£ä¹ˆï¼š<br>$$<br>f(z)=\mathbf{z}_\bot+\mathbf{z}_\parallel+\mathbf{u}h(\mathbf{w}^\top \mathbf{z}_\parallel +b)<br>$$<br>å®é™…ä¸Šå¾—åˆ°$\mathbf{z}_\parallel$ä¹‹åå¯ä»¥å¾ˆå®¹æ˜“çš„å¾—åˆ°$\mathbf{z}_\bot$ï¼Œä»¤$\mathbf{y}=f(\mathbf{z})$ï¼Œæœ‰ï¼š<br>$$<br>\mathbf{z}_\bot=\mathbf{y}-\mathbf{z}_\parallel-\mathbf{u}h(\mathbf{w}^\top\mathbf{z}_\parallel+b)<br>$$<br>è€Œ$\mathbf{z}_\parallel$ä¸$\mathbf{w}$å¹³è¡Œï¼Œæ˜“çŸ¥$\mathbf{z}_\parallel=\alpha\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}$ï¼Œå…¶ä¸­$\alpha\in\mathbb{R}$ã€‚</p>
<p>å¯¹å¼(16)ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥$\mathbf{w}^\top$å¯å¾—ï¼š<br>$$<br>\mathbf{w}^\top f(\mathbf{z})=\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)<br>$$<br>å½“$\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)$å¯¹äº$\alpha$æ˜¯éé€’å‡å‡½æ•°çš„æ—¶å€™ï¼Œ$f$æ˜¯å¯é€†çš„ã€‚å› ä¸º$\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)$æ˜¯éé€’å‡å‡½æ•°æ—¶æœ‰$1+\mathbf{w}^\top\mathbf{u}h^\prime(\alpha+b)\geq 0\equiv \mathbf{w}^\top \mathbf{u}\geq -\frac{1}{h^\prime(\alpha + b)}$ï¼Œè€Œ$0\leq h^\prime(\alpha + b) \leq 1$ï¼ˆ$\tanh$å‡½æ•°çš„æ€§è´¨ï¼‰ï¼Œæ‰€ä»¥æ€»æ˜¯æœ‰$\mathbf{w}^\top \mathbf{u}\geq-1$ã€‚</p>
<p>å¯¹äºä»»æ„ä¸€ä¸ª$\mathbf{u}$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ–¹å¼æ„é€ ä¸€ä¸ª$\hat{\mathbf{u}}$ä½¿å¾—$\mathbf{w}^\top\hat{\mathbf{u}}&gt;-1$ï¼Œå³ä»¤$\hat{\mathbf{u}}(\mathbf{w},\mathbf{u})=\mathbf{u}+[m(\mathbf{w}^\top\mathbf{u})-(\mathbf{w}^\top\mathbf{u})]\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}$ï¼Œå…¶ä¸­$m(x)=-1+\log(1+e^x)$ã€‚</p>
<p><img src="https://i.loli.net/2020/06/25/uPyplhWBazROEw4.png"></p>
<h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h2><p>æœ¬æ–‡é’ˆå¯¹çš„æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—$x={x_1,x_2,\cdots,x_N}\in R^{M\times N}$ï¼Œ$N$ä¸ºæ—¶é—´é•¿åº¦ï¼Œå…¶ä¸­æŸä¸€æ—¶åˆ»çš„è§‚æµ‹å€¼$x_t\in R^M$ä¸ºä¸€ä¸ª$M$ç»´çš„å‘é‡ã€‚ä½œè€…ä½¿ç”¨$x_{t-T:t}\in R^{M\times(T+1)}$æ¥è¡¨ç¤º$t-T$åˆ°$t$ä¹‹é—´çš„æ—¶é—´åºåˆ—ã€‚</p>
<p><img src="https://i.loli.net/2020/06/25/4eHhs82uOzI5tG3.png"></p>
<h2 id="Overall-Structure"><a href="#Overall-Structure" class="headerlink" title="Overall Structure"></a>Overall Structure</h2><p>ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/wd8maAoVb3Fk9vP.png"></p>
<p>é¢„å¤„ç†æ¨¡å—ä¸»è¦æ˜¯å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ä»¥åŠçª—å£åˆ‡åˆ†ã€‚è®­ç»ƒæ¨¡å—åˆ™æ ¹æ®è¾“å…¥çš„æ•°æ®å¯¹æ­£å¸¸æ¨¡å¼è¿›è¡Œæ•æ‰ï¼Œè¾“å‡ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨çº¿æ£€æµ‹æ¨¡å—åˆ™ä¼šå®šæœŸæ‰§è¡Œã€‚</p>
<h2 id="Network-Architecture"><a href="#Network-Architecture" class="headerlink" title="Network Architecture"></a>Network Architecture</h2><p>æ¨¡å‹çš„æ€»ä½“ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/06/25/Lp7D81EvxVsywXQ.png"></p>
<p>åœ¨qnetä¸­ï¼Œé¦–å…ˆGRUè¢«ç”¨æ¥å»ºæ¨¡æ ·æœ¬çš„æ—¶é—´ä¾èµ–å…³ç³»ï¼Œä¹‹åVAEå°†æ ·æœ¬$\mathbf{x}$æ˜ å°„åˆ°éšç©ºé—´$\mathbf{z}$ã€‚æ–‡ä¸­ä½¿ç”¨äº†Linear Gaussian State Space Modelæ¥å»ºæ¨¡éšå˜é‡ä¹‹é—´çš„æ—¶é—´ä¾èµ–å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜ä½¿ç”¨äº†Planar Normalizing Flowæ¥å°†éšå˜é‡æ˜ å°„åˆ°å¤æ‚çš„éé«˜æ–¯åˆ†å¸ƒã€‚åœ¨pnetä¸­ï¼Œéšå˜é‡$\mathbf{z}<em>{t-T:t}$è¢«ç”¨æ¥é‡å»º$\mathbf{x}</em>{t-T:t}$ï¼Œç›´è§‚ä¸Šæ¥è¯´ï¼Œå¯¹æ ·æœ¬çš„å¥½çš„éšå˜é‡è¡¨ç¤ºå¯ä»¥å¸¦æ¥æ›´å¥½çš„é‡æ„æ•ˆæœã€‚</p>
<p>ä»ç»†èŠ‚ä¸Šæ¥è¯´ï¼Œåœ¨æ—¶é—´$t$ï¼Œqnetçš„è¾“å…¥ä¸º$\mathbf{x}<em>t$å’Œ$\mathbf{e}</em>{t-1}$ï¼Œä¸¤è€…ç»è¿‡GRU Cellä¹‹åä¼šäº§ç”Ÿ$t$æ—¶é—´çš„$\mathbf{e_t}$ã€‚$\mathbf{e}<em>t$æ˜¯GRUæ•æ‰æ—¶é—´ä¾èµ–æ€§çš„å…³é”®ï¼Œå¯ä»¥è®¤ä¸ºå®ƒåŒ…å«äº†$\mathbf{x}</em>{1:t}$çš„ä¿¡æ¯ã€‚ä¹‹å$\mathbf{e}<em>t$ä¼šå’Œ$\mathbf{z}</em>{t-1}$è¿›è¡Œæ‹¼æ¥ï¼Œè¿›å…¥æ ‡å‡†çš„VAEå˜åˆ†ç½‘ç»œç»“æ„ï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„å‚æ•°$\mu_{z_t},\sigma_{z_t}$é‡‡æ ·å¾—åˆ°éšå˜é‡$\mathbf{z}_t^0$ï¼Œæ­¤æ—¶éšå˜é‡å¯ä»¥è¯´æ•æ‰äº†æ—¶é—´ä¾èµ–æ€§ã€‚</p>
<p>ç½‘ç»œä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>$$<br>\begin{align}<br>e_t&amp;=(1-c_t^e)\circ\text{tanh}(w^ex_t+u^e(r_t^e\circ e_{t-1})+b^e)+c_t^e\circ e_{t-1}\<br>\mu_{z_t}&amp;=w^{\mu_z}h^\phi([z_{t-1},e_t])+b^{\mu_z}\<br>\sigma_{z_t}&amp;=\text{softplus}(w^{\sigma_z}h^\phi([z_{t-1},e_t])+b^{\sigma_z})+\epsilon^{\sigma_z}<br>\end{align}<br>$$</p>
<p>å…¶ä¸­$r_t^e=\text{sigmoid}(\mathbf{w}^{r^e}\mathbf{x}<em>t+\mathbf{u}^{r^e}\mathbf{e}</em>{t-1}+b^{r^e})$æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ$c_t^e=\text{sigmoid}(\mathbf{w}^{c^e}\mathbf{x}<em>t+\mathbf{u}^{c^e}\mathbf{e}</em>{t-1}+b^{c^e})$æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p>
<p>æ­¤æ—¶$\mathbf{z}_t^0$æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸ºäº†æ‹Ÿåˆå¤æ‚çš„åéªŒåˆ†å¸ƒï¼Œæˆ‘ä»¬ä½¿ç”¨Planar Normalizing Flowæ¥å¯¹$\mathbf{z}_t^0$è¿›è¡Œå˜æ¢ï¼Œæœ€åå¾—åˆ°ç»$K$æ¬¡å˜æ¢åçš„éšæœºå˜é‡$\mathbf{z}_t^K$ã€‚</p>
<p>åœ¨æ—¶é—´$t$ï¼Œpnetè¯•å›¾é€šè¿‡$\mathbf{z}<em>t^K$æ¥é‡æ„$\mathbf{x}_t$ã€‚é¦–å…ˆ$\mathbf{z}$ç©ºé—´ä¸­çš„å˜é‡ä¼šæ ¹æ®Linear Gaussian State Space Modelæ¥è¿›è¡Œâ€œè¿æ¥â€œï¼Œå…¬å¼ä¸º$\mathbf{z}_t=\mathbf{O}_\theta(\mathbf{T}_\theta\mathbf{z}</em>{t-1}+\mathbf{v}<em>t)+\boldsymbol{\epsilon}_t$ï¼Œå…¶ä¸­$\mathbf{O}_\theta$å’Œ$\mathbf{T}_\theta$ä¸ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œ$\mathbf{v}_t$å’Œ$\boldsymbol{\epsilon}_t$ä¸ºéšæœºå™ªå£°ã€‚ä¹‹å$\mathbf{z}_t$å’Œ$\mathbf{d}</em>{t-1}$ä¼šä½œä¸ºGRUçš„è¾“å…¥ï¼Œäº§ç”Ÿ$\mathbf{d}<em>t$ã€‚ä¹‹å$\mathbf{d}<em>t$ä¼šç»è¿‡æ ‡å‡†VAEä¸­çš„ç”Ÿæˆç½‘ç»œï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„é«˜æ–¯åˆ†å¸ƒå‚æ•°$\mu</em>{x_t},\sigma_{x_t}$é‡‡æ ·å¾—åˆ°é‡æ„åçš„æ ·æœ¬$\mathbf{x}^\prime_t$ã€‚pnetä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š<br>$$<br>\begin{align}<br>d_t&amp;=(1-c_t^d)\circ\text{tanh}(w^dz_t+u^d(r_t^d\circ d</em>{t-1})+b^d)+c_t^d\circ d_{t-1}\<br>\mu_{x_t}&amp;=w^{\mu_x}h^\theta(d_t)+b^{\mu_x}\<br>\sigma_{x_t}&amp;=\text{softplus}(w^{\sigma_x}h^\theta(d_t)+b^{\sigma_x})+\epsilon^{\sigma_x}<br>\end{align}<br>$$</p>
<p>å…¶ä¸­$r_t^d=\text{sigmoid}(\mathbf{w}^{r^d}\mathbf{x}<em>t+\mathbf{u}^{r^d}\mathbf{d}</em>{t-1}+b^{r^d})$æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ$c_t^d=\text{sigmoid}(\mathbf{w}^{c^d}\mathbf{x}<em>t+\mathbf{u}^{c^d}\mathbf{d}</em>{t-1}+b^{c^d})$æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p>
<h2 id="Offline-Model-Training"><a href="#Offline-Model-Training" class="headerlink" title="Offline Model Training"></a>Offline Model Training</h2><p>å’Œä¼ ç»ŸVAEç±»ä¼¼ï¼Œæ¨¡å‹çš„è®­ç»ƒå¯ä»¥é€šè¿‡ä¼˜åŒ–ELBOæ¥å®Œæˆã€‚è®°é•¿åº¦ä¸º$T+1$çš„è¾“å…¥åºåˆ—ä¸º$\mathbf{x}<em>{t-T:t}$ï¼Œéšç©ºé—´å˜é‡é‡‡æ ·æ¬¡æ•°ä¸º$L$ï¼Œç¬¬$l$ä¸ªéšç©ºé—´å˜é‡ä¸º$\mathbf{l}^{(l)}</em>{t-T:t}$ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p>
<p>$$<br>\tilde{\mathcal{L}}(\mathbf{x}<em>{t-T:t})\approx\frac{1}{L}\sum</em>{t=1}^L[\log(p_\theta(\mathbf{x}<em>{t-T:t}|\mathbf{z}</em>{t-T:t}^{(l)}))+\log(p_\theta(\mathbf{z}<em>{t-T:t}^{(l)}))-\log(q_\phi(\mathbf{z}_{t-T:t}^{(l)}|\mathbf{x}</em>{t-T:t}))]<br>$$</p>
<p>ç¬¬ä¸€é¡¹$\log(p_\theta(\mathbf{x}<em>{t-T:t}|\mathbf{z}</em>{t-T:t}^{(l)}))$å¯ä»¥çœ‹ä½œæ˜¯é‡æ„è¯¯å·®ï¼›ç¬¬äºŒé¡¹$\log(p_\theta(\mathbf{z}<em>{t-T:t}))=\sum</em>{i=t-T}^t \log(p_\theta(\mathbf{z}<em>i|\mathbf{z}</em>{i-1}))$é€šè¿‡Linear Gaussian State Space Modelè®¡ç®—ï¼›ç¬¬ä¸‰é¡¹$-\log(q_\phi(\mathbf{z}<em>{t-T:t}|\mathbf{x}</em>{t-T:t}))=-\sum_{i=t-T}^t\log(q_\phi(\mathbf{z}<em>i|\mathbf{z}</em>{i-1},\mathbf{x}_{t-T:i}))$ä¸ºéšå˜é‡$\mathbf{z}$åéªŒåˆ†å¸ƒçš„ä¼°è®¡ï¼ŒåŒæ—¶$\mathbf{z}_i$æ˜¯ç»Planar Normalizing Flowè½¬æ¢è¿‡çš„ã€‚</p>
<h2 id="Online-Detection"><a href="#Online-Detection" class="headerlink" title="Online Detection"></a>Online Detection</h2><p>åœ¨è®­ç»ƒå¥½æ¨¡å‹ä¹‹åï¼Œå°±å¯ä»¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹äº†ã€‚åœ¨æ—¶é—´$t$ï¼Œæˆ‘ä»¬é€šè¿‡æ ¹æ®é•¿åº¦ä¸º$T+1$çš„åºåˆ—$\mathbf{x}<em>{t-T:t}$æ¥é‡æ„$\mathbf{x}<em>t$ï¼Œå¹¶æ ¹æ®é‡æ„æ¦‚ç‡$\log(p_\theta(\mathbf{x}_t|\mathbf{z}</em>{t-T:t}))$æ¥åˆ¤å®šå¼‚å¸¸ã€‚å®šä¹‰$\mathbf{x}_t$å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°$S_t=\log(p_\theta(\mathbf{x}_t|\mathbf{z}</em>{t-T:t}))$ï¼Œé«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ ·æœ¬$\mathbf{x}_t$èƒ½å¤Ÿä»¥å¤§æ¦‚ç‡é‡æ„ï¼ˆå› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è®­ç»ƒï¼Œå¯ä»¥è®¤ä¸ºæ¨¡å‹å»ºæ¨¡çš„æ˜¯æ­£å¸¸æ ·æœ¬çš„åˆ†å¸ƒï¼Œé‡æ„æ¦‚ç‡é«˜å°±ä»£è¡¨ç¬¦åˆæ­£å¸¸åˆ†å¸ƒï¼‰ã€‚ç»™å®šé˜ˆå€¼ä¹‹åä¾¿å¯æ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤å®šã€‚</p>
<h2 id="Automatic-Threshold-Selection"><a href="#Automatic-Threshold-Selection" class="headerlink" title="Automatic Threshold Selection"></a>Automatic Threshold Selection</h2><p>åœ¨å¼‚å¸¸æ£€æµ‹é˜¶æ®µï¼Œéœ€è¦æ ¹æ®è®¾å®šçš„é˜ˆå€¼å’Œæ¯ä¸ªæ ·æœ¬çš„å¼‚å¸¸åˆ†æ•°æ¥åˆ¤æ–­è¯¥æ ·æœ¬æ˜¯å¦ä¸ºå¼‚å¸¸ï¼Œæ‰€ä»¥é˜ˆå€¼çš„é€‰æ‹©ååˆ†é‡è¦ã€‚æ–‡ä¸­ç”¨åˆ°äº†ä¸€ç§æ ¹æ®<strong>Extreme Value Theory</strong>è‡ªåŠ¨é€‰æ‹©é˜ˆå€¼çš„ç®—æ³•ã€‚å¯¹äºä¸€ä¸ªåˆ†å¸ƒï¼Œå…¶ä¸­çš„æç«¯äº‹ä»¶å¾€å¾€ä½äºåˆ†å¸ƒçš„æœ«å°¾ï¼Œè€ŒExtreme Value Theoryç¬¬ä¸€å®šç†ç»™å‡ºä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ï¼Œè¿™äº›æç«¯äº‹ä»¶çš„åˆ†å¸ƒæœä»ä¸€ä¸ªå¸¦å‚çš„åˆ†å¸ƒæ—ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨å¯¹æ•°æ®åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡æç«¯äº‹ä»¶çš„åˆ†å¸ƒã€‚</p>
<p>é™¤äº†Extreme Value Theoryç¬¬ä¸€å®šç†ä¹‹å¤–ï¼ŒExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼$t$çš„åˆ†å¸ƒå¯ä»¥ç”¨Generalized Pareto Distributionæ¥æè¿°ã€‚ä½œè€…ä½¿ç”¨äº†åŸºäºExtreme Value Theoryç¬¬äºŒå®šç†çš„Peaks-Over-Thresholdç®—æ³•æ¥è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚å› ä¸ºExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼$t$çš„åˆ†å¸ƒï¼Œè€Œåœ¨æœ¬æ–‡çš„åœºæ™¯ä¸­æˆ‘ä»¬éœ€è¦åˆ»ç”»çš„å¼‚å¸¸ç‚¹çš„åˆ†å¸ƒåº”è¯¥æ˜¯å°äºä¸€ä¸ªç»™å®šé˜ˆå€¼çš„åˆ†å¸ƒï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹å…¬å¼ã€‚</p>
<p>å¯¹äºç»™å®šçš„æ•°æ®ï¼Œæ¨¡å‹ä¼šç»™å‡ºå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°åºåˆ—${S_1,S_2,\cdots,S_{N^\prime}}$ï¼Œç»™å®šé¢„å…ˆè®¾å®šçš„é˜ˆå€¼$th$ï¼Œ$S_i$æç«¯éƒ¨åˆ†ï¼ˆå³å°äº$th$çš„éƒ¨åˆ†ï¼‰çš„åˆ†å¸ƒç¬¦åˆGeneralized Pareto Distributionï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\bar{F}(s)=P(th-S&gt;s|S&lt;th)\sim(1+\frac{\gamma s}{\beta})^{-\frac{1}{\gamma}}<br>$$</p>
<p>å…¶ä¸­$\gamma$å’Œ$\beta$ä¸ºåˆ†å¸ƒçš„å½¢çŠ¶å‚æ•°ï¼Œæœ¬æ–‡ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ¥å¯¹å‚æ•°è¿›è¡Œä¼°è®¡ã€‚è®¾å‚æ•°çš„ä¼°è®¡å€¼åˆ†åˆ«ä¸º$\hat{\gamma}$å’Œ$\hat{\beta}$ï¼Œæœ€ç»ˆçš„é˜ˆå€¼$th_F$ç”±æ‹Ÿåˆå¾—åˆ°çš„åˆ†å¸ƒçš„åˆ†ä½æ•°ç¡®å®šï¼š</p>
<p>$$<br>th_F\simeq th-\frac{\hat{\beta}}{\hat{\gamma}}((\frac{qN^\prime}{N^\prime_{th}})^{-\hat{\gamma}}-1)<br>$$</p>
<p>å…¶ä¸­$q$ä¸ºæœŸæœ›$S&lt;th$çš„æ¦‚ç‡ï¼Œ$N^\prime$ä¸ºè§‚æµ‹å€¼çš„æ•°é‡ï¼Œ$N^\prime_{th}$ä¸º$S_i&lt;th$çš„ä¸ªæ•°ã€‚</p>
<h2 id="Anomaly-Interpretation"><a href="#Anomaly-Interpretation" class="headerlink" title="Anomaly Interpretation"></a>Anomaly Interpretation</h2><p>$$<br>\log(p_\theta(\mathbf{x}<em>t|\mathbf{z}</em>{t-T:t}))=\sum_{i=1}^M\log(p_\theta(x_t^i|\mathbf{z}_{t-T:t}))<br>$$</p>
<h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Datasets-and-Metrics"><a href="#Datasets-and-Metrics" class="headerlink" title="Datasets and Metrics"></a>Datasets and Metrics</h2><h2 id="Overall-Performance"><a href="#Overall-Performance" class="headerlink" title="Overall Performance"></a>Overall Performance</h2><p><img src="https://i.loli.net/2020/06/25/yYLiWfXBDQklbPU.png"></p>
<p><img src="https://i.loli.net/2020/06/25/HlORKBEu7ij6Vor.png"></p>
<h2 id="Effects-of-Major-Techniques"><a href="#Effects-of-Major-Techniques" class="headerlink" title="Effects of Major Techniques"></a>Effects of Major Techniques</h2><p><img src="https://i.loli.net/2020/06/25/eKXGJ9ZlSmq8r4Q.png"></p>
<p><img src="https://i.loli.net/2020/06/25/dlibhyOBXNmPrkw.png"></p>
<h2 id="Visualization-on-Z-Space-Representations"><a href="#Visualization-on-Z-Space-Representations" class="headerlink" title="Visualization on Z-Space Representations"></a>Visualization on Z-Space Representations</h2><p><img src="https://i.loli.net/2020/06/25/MQXv5pZAejgVJ9s.png"></p>
<p><img src="https://i.loli.net/2020/06/25/jCkovq2lWrP6KXy.png"></p>
<p><img src="https://i.loli.net/2020/06/25/JSZuUkzNyci41DA.png"></p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/categories/Research/">ä¸Šä¸€é¡µ</a></div><div class="pagination-next"><a href="/categories/Research/page/3/">ä¸‹ä¸€é¡µ</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/categories/Research/">1</a></li><li><a class="pagination-link is-current" href="/categories/Research/page/2/">2</a></li><li><a class="pagination-link" href="/categories/Research/page/3/">3</a></li></ul></nav></div><!--!--><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Hanzawa ã® éƒ¨å±‹</a><p class="is-size-7"><span>&copy; 2021 Hanzawa</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/main.js" defer></script><!--!--></body></html>