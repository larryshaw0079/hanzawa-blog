{"meta":{"title":"Hanzawa ã® éƒ¨å±‹","subtitle":null,"description":null,"author":"Hanzawa","url":"http://qfxiao.me","root":"/"},"pages":[{"title":"about","date":"2020-05-27T09:44:48.000Z","updated":"2020-11-12T03:52:50.052Z","comments":false,"path":"about/index.html","permalink":"http://qfxiao.me/about/index.html","excerpt":"","text":"About Me Hi there, I am Xiao Qinfeng (è‚–é’¦å³°)! ğŸ‘‹ ğŸ”­ Iâ€™m currently pursuing a Master degree in Computer Science at Beijing Jiaotong University. ğŸŒ± My research interests include: Anomaly Detection Temporal Data Mining Unsupervised Learning ğŸ“« You can contact me by: Email: qfxiao@bjtu.edu.cn Selected News Recent Research Publications"},{"title":"","date":"2020-05-27T10:57:23.346Z","updated":"2020-05-27T10:57:23.346Z","comments":false,"path":"css/custom.css","permalink":"http://qfxiao.me/css/custom.css","excerpt":"","text":"/* .navbar-custom { color: #f6ad8f } */"}],"posts":[{"title":"Recent Progress of Contrastive Learning in NeurIPS 2020","slug":"Recent-Progress-of-Contrastive-Learning-in-NeurIPS-2020","date":"2020-12-19T13:15:28.000Z","updated":"2020-12-19T13:16:46.740Z","comments":true,"path":"2020/12/19/Recent-Progress-of-Contrastive-Learning-in-NeurIPS-2020/","link":"","permalink":"http://qfxiao.me/2020/12/19/Recent-Progress-of-Contrastive-Learning-in-NeurIPS-2020/","excerpt":"","text":"","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Self-supervised Learning","slug":"Research/Self-supervised-Learning","permalink":"http://qfxiao.me/categories/Research/Self-supervised-Learning/"}],"tags":[{"name":"Representation Learning","slug":"Representation-Learning","permalink":"http://qfxiao.me/tags/Representation-Learning/"},{"name":"Self-supervised Learning","slug":"Self-supervised-Learning","permalink":"http://qfxiao.me/tags/Self-supervised-Learning/"}]},{"title":"Anomaly Detection Resource Collection","slug":"Anomaly-Detection-Resource-Collection","date":"2020-10-27T04:49:22.000Z","updated":"2020-10-27T04:49:15.799Z","comments":true,"path":"2020/10/27/Anomaly-Detection-Resource-Collection/","link":"","permalink":"http://qfxiao.me/2020/10/27/Anomaly-Detection-Resource-Collection/","excerpt":"","text":"Introduction å¼‚å¸¸æ£€æµ‹ï¼ˆAnomaly Detectionæˆ–Outlier Detectionæˆ–Novelty Detectionï¼‰æœ¬èº«åŒ…å«çš„ä¸œè¥¿å¾ˆå¤šï¼Œæœ‰æ—¶åºï¼ˆTime Seriesï¼‰çš„å¼‚å¸¸æ£€æµ‹ï¼Œå›¾åƒï¼ˆImageï¼‰çš„å¼‚å¸¸æ£€æµ‹ï¼Œè§†é¢‘ï¼ˆVideoï¼‰çš„å¼‚å¸¸æ£€æµ‹ï¼Œå›¾ï¼ˆGraphï¼‰çš„å¼‚å¸¸æ£€æµ‹ï¼Œè¡¨æ ¼æ•°æ®ï¼ˆCategorical Dataï¼‰çš„å¼‚å¸¸æ£€æµ‹ç­‰ç­‰ï¼Œä»–ä»¬ä¹‹é—´æœ‰å…±æ€§ä¹Ÿæœ‰å¾ˆå¤§çš„åŒºåˆ«ã€‚æœ¬æ–‡ä¸»è¦å…³æ³¨æ—¶åºçš„å¼‚å¸¸æ£€æµ‹ï¼Œä¹ŸåŒ…æ‹¬å›¾åƒå’Œè¡¨æ ¼æ•°æ®çš„å¼‚å¸¸æ£€æµ‹ã€‚å®é™…ä¸Šæ—¶åºå¼‚å¸¸æ£€æµ‹è¿˜å¯ä»¥ç»§ç»­ç»†åˆ†ï¼Œå¦‚æ£€æµ‹ä¸€æ¡æ—¶åºä¸Šé€ç‚¹çº§åˆ«çš„å¼‚å¸¸ï¼Œæˆ–è€…æ˜¯åœ¨æ—¶åºé›†åˆä¸­æ£€æµ‹å¼‚å¸¸çš„æ•´æ¡æ—¶åºã€‚è€Œè€ƒè™‘åˆ°å…·ä½“åº”ç”¨åœºæ™¯è¿˜ä¼šè¡ç”Ÿå‡ºæµå¼æ•°æ®çš„å¼‚å¸¸æ£€æµ‹å’Œåˆ†å¸ƒå¼å¼‚å¸¸æ£€æµ‹ç­‰ç­‰ã€‚ç°é˜¶æ®µå›¾åƒçš„å¼‚å¸¸æ£€æµ‹ä¸»è¦æ˜¯å°†å…³æ³¨çš„ä¸€ç±»ä½œä¸ºæ­£å¸¸ï¼Œè€Œå°†å…¶ä»–ç±»åˆ«çš„å›¾åƒä½œä¸ºå¼‚å¸¸ï¼Œç±»ä¼¼äºå•åˆ†ç±»ã€‚ æ›´æ–°ä¸­ã€‚ã€‚ã€‚ Literature Survey Title Conf/Journal Link Deep Learning for Anomaly Detection: A Survey CoRR20 ğŸ“ƒPaper Anomalous Instance Detection in Deep Learning: A Survey CoRR20 ğŸ“ƒPaper Outlier Detection: Methods, Models, and Classification ACM Comput. Surv.20 ğŸ“ƒPaper Outlier Analysis Springer ğŸ“•Book Outlier Detection for Temporal Data: A Survey TKDE14 ğŸ“ƒPaper Anomaly detection: A survey ACM Comput. Surv.09 ğŸ“ƒPaper A Survey of Outlier Detection Methodologies Artificial Intelligence Review04 ğŸ“ƒPaper Formalization æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹ \\[ \\{\\Theta^*,\\mathbf W^*\\}=\\mathop{\\arg\\min}\\limits_{\\Theta,\\mathbf W}\\sum_{\\mathbf x\\in\\mathcal X}\\ell\\left(\\psi(\\phi(\\mathbf x;\\Theta);\\mathbf W)\\right) \\] ç¬¬äºŒæ­¥æ˜¯Anomaly Scoringï¼š \\[ \\mathcal S(\\mathbf x)=f(\\mathbf x, \\phi_{\\Theta^*},\\psi_{\\mathbf W^*}) \\] Anomaly Detection for Temporal Data åœ¨å°æ ‡é¢˜é‡Œæ²¡ç”¨Time Seriesè¿™ä¸ªè¯è€Œæ˜¯ç”¨äº†Temporal Dataçš„åŸå› æ˜¯Temporal Dataçš„èŒƒå›´æ›´å¹¿æ³›ä¸€äº›ï¼Œå‡¡æ˜¯å…·æœ‰æ—¶é—´ä¾èµ–æ€§çš„æ•°æ®éƒ½å¯å½’ä¸ºTemporal Dataï¼Œè¿™åŒ…æ‹¬äº†æ—¶é—´åºåˆ—å’Œè§†é¢‘è¿™ç§å›ºå®šé¢‘ç‡é‡‡æ ·çš„è¿ç»­åºåˆ—ï¼Œä¹ŸåŒ…å«äº†äº‹ä»¶æµã€è½¨è¿¹ã€æ–‡æœ¬è¿™ç§ç¦»æ•£åºåˆ—ã€‚å½“ç„¶æœ¬æ–‡ä¸»è¦æ¢è®¨çš„æ˜¯æ—¶é—´åºåˆ—çš„å¼‚å¸¸æ£€æµ‹ï¼Œæ—¶é—´åºåˆ—å…·æœ‰å¾ˆå¼ºçš„æ—¶é—´ä¾èµ–æ€§ï¼ŒåŒæ—¶ä¹Ÿå…·æœ‰å¹¿æ³›çš„åº”ç”¨ï¼ŒåŒ…æ‹¬ï¼š é‡‘èå¸‚åœºï¼ˆFinancial Marketsï¼‰ï¼š è¿ç»´ï¼ˆOpsï¼‰ï¼š ç”Ÿç†æ•°æ®ï¼ˆBiological Dataï¼‰ï¼š Categorization Anomalies with a Given Time Series Title Conf/Journal Labels Link Opprentice: Towards Practical and Automatic Anomaly Detection Through Machine Learning ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection Generic and Scalable Framework for Automated Time-series Anomaly Detection KDD A unifying framework for detecting outliers and change points from non-stationary time series data KDD A Deep Neural Network for Unsupervised Anomaly Detection and Diagnosis in Multivariate Time Series Data AAAI19 Non-Parametric Outliers Detection in Multiple Time Series A Case Study: Power Grid Data Analysis AAA18 Time Series Anomaly Discovery with Grammar-based Compression EDBT15 A Self-Learning and Online Algorithm for Time Series Anomaly Detection, with Application in CPU Manufacturing CIKM16 Time-Series Aware Precision and Recall for Anomaly Detection: Considering Variety of Detection Result and Addressing Ambiguous Labeling CIKM19 Granger Causality for Time-Series Anomaly Detection ICDM12 Modeling Multiple Time Series for Anomaly Detection ICDM05 Outlier Detection for Time Series with Recurrent Autoencoder Ensembles IJCAI19 Stochastic Online Anomaly Analysis for Streaming Time Series IJCAI17 A Unifying Framework for Detecting Outliers and Change Points from Time Series TKDE06 PSOM: Periodic Self-Organizing Maps for Unsupervised Anomaly Detection in Periodic Time Series IWQoS17 Sparse Decomposition for Time Series Forecasting and Anomaly Detection SDM18 Time Series Anomaly Detection Based on Shapelet Learning Computational Statistics19 Anomaly Detection in Streams with Extreme Value Theory KDD17 Semi-Markov Switching Vector Autoregressive Model-Based Anomaly Detection in Aviation Systems KDD16 xStream: Outlier Deteâ€˜xâ€™ion in Feature-Evolving Data Streams KDD18 DILOF: Effective and Memory EfficientLocal Outlier Detection in Data Streams KDD18 Online Novelty Detection on Temporal Sequences KDD03 An Approach to Spacecraft Anomaly Detection ProblemUsing Kernel Feature Space KDD05 Reconstruction åŸºäºé‡æ„çš„å¼‚å¸¸æ£€æµ‹ \\[ \\begin{align} \\mathbf z=\\mathcal E(\\mathbf x;\\Theta_{\\mathcal E})\\\\ \\hat{\\mathbf x}=\\mathcal G(\\mathbf z;\\Theta_{\\mathcal G}) \\end{align} \\] ç›®æ ‡å‡½æ•° \\[ \\{\\Theta_{\\mathcal E}^*,\\Theta_{\\mathcal G}^*\\}=\\mathop{\\arg\\min}\\limits_{\\Theta_{\\mathcal E},\\Theta_{\\mathcal G}}\\sum_{\\mathbf x\\in\\mathcal X}f(\\mathbf x, \\hat{\\mathbf{x}}) \\] å¼‚å¸¸åˆ†æ•° \\[ \\mathcal S(\\mathbf x)=f(\\mathbf x, \\hat{\\mathbf{x}}) \\] å…¶ä¸­\\(f(\\mathbf x, \\hat{\\mathbf x})\\)ä¸ºé‡æ„è¯¯å·® Title Conf/Journal Labels Link Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network KDD19 VAE, Flow-based Model, RNN ğŸ“ƒPaper Supervised Learning Title Conf/Journal Labels Link KDD19 VAE, Flow-based Model, RNN ğŸ“ƒPaper Others Title Conf/Journal Labels Link Time-Series Anomaly Detection Service at Microsoft KDD19 Spectral Residual ğŸ“ƒPaper Anomaly Detection for Categorical Data å¯¹äºè¡¨æ ¼æ•°æ®ï¼Œå’Œæ—¶åºã€å›¾åƒæœ€å¤§çš„åŒºåˆ«åœ¨äºè¡¨æ ¼æ•°æ®çš„æ¯ä¸€ä¸ªç»´åº¦ï¼Œå¾€å¾€æ˜¯æœ‰å®é™…è¯­ä¹‰çš„ï¼Œæ¯”å¦‚å¹´é¾„ã€æ€§åˆ«ç­‰ç­‰ã€‚è€Œå›¾åƒã€æ—¶åºï¼ˆä¸€ç»´ä¿¡å·ï¼‰è¿™äº›å±äºRaw Dataï¼Œæœ¬èº«æ˜¯æ²¡æœ‰å®é™…è¯­ä¹‰çš„ï¼Œéœ€è¦å€ŸåŠ©äºç‰¹å¾æŠ½å–å™¨æ¥æå–è¯­ä¹‰ç‰¹å¾æ¥æœåŠ¡äºåé¢çš„ä»»åŠ¡ï¼Œè¿™ä¹Ÿæ˜¯è¡¨ç¤ºå­¦ä¹ ï¼ˆRepresentation Learningï¼‰çš„ä»»åŠ¡ã€‚ Categorization Representation Learning for Anomaly Detection Reconstrunction-based Anomaly Detection Predictability Modeling End-To-End Anomaly Scoring \\[ \\Theta^*=\\mathop{\\arg\\min}\\limits_{\\Theta}\\sum_{\\mathbf x\\in\\mathcal X}\\ell(\\tau(\\mathbf x;\\Theta)) \\] \\[ \\mathcal S(\\mathcal x)=\\tau(\\mathbf x; \\Theta) \\] Title Conf/Journal Labels Link Deep Anomaly Detection with Deviation Networks KDD19 Learning Representations of Ultrahigh-dimensional Data for Random Distance-based Outlier Detection KDD18 Anomaly Detection for an E-commerce Pricing System KDD19 Feedback-Guided Anomaly Discovery via Online Optimization KDD18 REMIX: Automated Exploration for Interactive Outlier Detection KDD17 Distributed Local Outlier Detection in Big Data KDD17 Scalable Top-n Local Outlier Detection KDD17 Outlier Detection by Active Learning KDD06 Feature Bagging for Outlier Detection KDD05 Anomaly Detection for Image åœ¨è¿‘å¹´æ¥çš„æœºå™¨å­¦ä¹ /æ·±åº¦å­¦ä¹ é¡¶ä¼šä¸­å‡ ä¹éƒ½ä¼šå‡ºç°å›¾åƒæ•°æ®çš„å¼‚å¸¸æ£€æµ‹ç›¸å…³çš„è®ºæ–‡ã€‚ Categorization Reconstruction Title Conf/Journal Labels Link Anomaly Detection with Robust Deep Autoencoders KDD17 Self-Supervised Dataset Benchmark Others CCFæ¨èå›½é™…å­¦æœ¯ä¼šè®®å’ŒæœŸåˆŠç›®å½•2019ç‰ˆğŸ“¥ ä¼šè€ƒè™‘çš„ä¼šè®®å’ŒæœŸåˆŠåˆ—è¡¨ï¼ˆä¸æ˜¯Aç±»æˆ–è€…å’Œå¼‚å¸¸æ£€æµ‹ç›¸å…³æ€§æ¯”è¾ƒå¼±çš„ä¼šç‰¹åˆ«æ ‡å‡ºï¼‰ï¼š TKDE TKDDï¼ˆBç±»ï¼‰ SIGMOD SIGKDD ICDE CIKMï¼ˆBç±»ï¼‰ WSDMï¼ˆBç±»ï¼‰ ECML-PKDDï¼ˆBç±»ï¼‰ ICDMï¼ˆBç±»ï¼‰ EDBTï¼ˆBç±»ï¼‰ SDMï¼ˆBç±»ï¼‰ PAKDDï¼ˆCç±»ï¼‰ JMLR AAAI NeurIPS ICML ICLR IJCAI WWW INFOCOMï¼ˆå¼±ç›¸å…³ï¼‰ IWQoSï¼ˆBç±»ï¼Œå¼±ç›¸å…³ï¼‰ ä½¿ç”¨çš„å­¦æœ¯æœç´¢ä¸ºDBLPï¼Œåœ¨æœç´¢çš„æ—¶å€™æ”¯æŒé€»è¾‘è¿æ¥è¯ï¼Œé»˜è®¤ç©ºç™½ä¸ºANDã€‚å¦‚æœè¦ç”¨åˆ°ORï¼Œæ¯”å¦‚å¼‚å¸¸æ£€æµ‹æœ‰çš„è®ºæ–‡ç”¨çš„æ˜¯\"anomaly detection\"ï¼Œæœ‰çš„ç”¨çš„æ˜¯\"outlier detectin\"ï¼Œè¿˜æœ‰çš„ç”¨çš„æ˜¯\"novelty detection\"ï¼Œé‚£å°±å¯ä»¥æœç´¢\"anomaly | outlier | novelty detection\"ã€‚ Feature Query Example prefix search default \"sig\" matches \"SIGIR\" as well as \"signal\" exact word append dollar sign (\\() | [&quot;graph\\)\"](http://dblp.org/search?q=graph$) matches \"graph\", but not \"graphics\" boolean AND separate words by space \"codd model\" matches \"Codd's Relational Model\" and \"A Model by Codd\" boolean OR connect words by pipe symbol (|) \"graph|network\" matches \"graph algorithm\" and \"Network Analysis\"","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"}]},{"title":"Must Read Papers: Applications of Self-supervised Learning in Biomedical Signals","slug":"Must-Read-Papers-Applications-of-Self-supervised-Learning-in-Biomedical-Signals","date":"2020-10-27T03:32:52.000Z","updated":"2020-10-27T07:46:52.152Z","comments":true,"path":"2020/10/27/Must-Read-Papers-Applications-of-Self-supervised-Learning-in-Biomedical-Signals/","link":"","permalink":"http://qfxiao.me/2020/10/27/Must-Read-Papers-Applications-of-Self-supervised-Learning-in-Biomedical-Signals/","excerpt":"","text":"Introduction Self-supervised Learning (SSL) æ›´æ–°ä¸­ã€‚ã€‚ã€‚ Self-supervised Learning Title Conf/Journal Link Unsupervised Feature Learning via Non-Parametric Instance Discrimination CVPR18 ğŸ“ƒPaper Momentum Contrast for Unsupervised Visual Representation Learning CVPR20 ğŸ“ƒPaper A Simple Framework for Contrastive Learning of Visual Representations ICML20 ğŸ“ƒPaper SSL in Video Representation Learning Title Conf/Journal Link Video Representation Learning by Dense Predictive Coding ICCVW19 ğŸ“ƒPaper Memory-augmented Dense Predictive Coding for Video Representation Learning ECCV20 ğŸ“ƒPaper SSL in Biomedical Signals Title Conf/Journal Link Uncovering the structure of clinical EEG signals with self-supervised learning CoRR20 ğŸ“ƒPaper Graph Neural Networks Title Conf/Journal Link Connecting the Dots: Multivariate Time Series Forecasting with Graph Neural Networks KDD20 ğŸ“ƒPaper","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Misc","slug":"Research/Misc","permalink":"http://qfxiao.me/categories/Research/Misc/"}],"tags":[{"name":"Papers","slug":"Papers","permalink":"http://qfxiao.me/tags/Papers/"}]},{"title":"Unsupervised Feature Learning via Non-Parametric Instance Discrimination","slug":"Unsupervised-Feature-Learning-via-Non-Parametric-Instance-Discrimination","date":"2020-09-23T12:36:57.000Z","updated":"2020-09-23T12:39:37.862Z","comments":true,"path":"2020/09/23/Unsupervised-Feature-Learning-via-Non-Parametric-Instance-Discrimination/","link":"","permalink":"http://qfxiao.me/2020/09/23/Unsupervised-Feature-Learning-via-Non-Parametric-Instance-Discrimination/","excerpt":"","text":"Introduction ç»†èŠ‚å¾…å®Œå–„ã€‚ã€‚ã€‚ æœ¬æ–‡åŸºäºæ ·æœ¬åˆ†ç±»å’Œå™ªå£°å¯¹æ¯”ä¼°è®¡æå‡ºäº†ä¸€ä¸ªæ— ç›‘ç£è¡¨ç¤ºå­¦ä¹ ç®—æ³•ã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªIntuition Exampleï¼š å¯¹äºä¸€ä¸ªæœ‰ç›‘ç£çš„åˆ†ç±»å™¨ï¼Œè¾“å…¥ä¸€å¼ å›¾ç‰‡ï¼Œä½œè€…è§‚å¯Ÿåˆ°åˆ†ç±»å™¨çš„Softmax Responseä¸­è¾ƒé«˜çš„é‚£äº›ç±»éƒ½æ˜¯åœ¨è§†è§‰ä¸Šçœ‹èµ·æ¥æ¯”è¾ƒæ¥è¿‘çš„ï¼ˆç¾æ´²è±¹Leopardï¼Œç¾æ´²è™Jaguarï¼Œå°åº¦è±¹Cheetahï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ç½‘ç»œæ•æ‰åˆ°äº†ç±»é—´çš„è§†è§‰ç›¸ä¼¼æ€§ï¼Œä¸è¿‡è¿™æ˜¯åœ¨æœ‰æ ‡ç­¾çš„æƒ…å†µä¸‹ã€‚å¯¹äºæ— ç›‘ç£è¡¨ç¤ºå­¦ä¹ ä»»åŠ¡ï¼Œä½œè€…å°†è¿™ä¸ªè§‚å¯Ÿæ¨å¹¿åˆ°äº†ä¸€ä¸ªæç«¯æƒ…å†µï¼Œå°±æ˜¯æŠŠæ¯ä¸€ä¸ªæ ·æœ¬éƒ½è§†ä½œä¸åŒçš„ç±»ï¼Œç„¶åè®©åˆ†ç±»å™¨æ¥å­¦ä¹ æ ·æœ¬ï¼ˆç±»ï¼‰é—´çš„è§†è§‰ç›¸ä¼¼æ€§ã€‚ä¸è¿‡ç›´æ¥è¿™ä¹ˆåšä¼šæœ‰ä¸¥é‡çš„æ•ˆç‡é—®é¢˜ï¼Œæ‰€ä»¥ä½œè€…è¿˜åˆ©ç”¨äº†Memory Bankæœºåˆ¶å’Œå™ªå£°å¯¹æ¯”ä¼°è®¡æ¥æé«˜æ•ˆç‡ã€‚ Proposed Method å­¦ä¹ ä¸€ä¸ªåµŒå…¥è¡¨ç¤ºå‡½æ•°\\(\\mathbf v=f_\\theta(x)\\)ã€‚åœ¨è¡¨ç¤ºç©ºé—´ä¸­\\(d_\\theta(x,y)=\\parallel f_\\theta(x)-f_\\theta(y)\\parallel\\) Non-Parametric Softmax Classifier Parametric Classifier åœ¨ç»è¿‡åµŒå…¥è¡¨ç¤ºå‡½æ•°ä¹‹åï¼Œå¾—åˆ°è¡¨ç¤ºå‘é‡\\(\\mathbf v_i=f_\\theta(\\mathbf x_i)\\)ã€‚è¦åŸºäºè¿™ä¸ªå‘é‡è¿›è¡Œåˆ†ç±»ï¼Œ \\[ P(i|\\mathbf v)=\\frac{\\exp(\\mathbf w_i^\\top\\mathbf v)}{\\sum_j\\exp(\\mathbf w_j^\\top\\mathbf v)} \\] ### Non-Parametric Classifier \\[ P(i|\\mathbf v)=\\frac{\\exp(\\mathbf v_i^\\top\\mathbf v/\\tau)}{\\sum_j\\exp(\\mathbf v_j^\\top\\mathbf v/\\tau)} \\] åŒæ—¶çº¦æŸ\\(\\parallel \\mathbf v\\parallel=1\\) æœ€åçš„æŸå¤±å‡½æ•°ä¸ºè´Ÿå¯¹æ•°ä¼¼ç„¶æŸå¤±ï¼ˆnegative log-likelihoodï¼‰ï¼š \\[ J(\\theta)=-\\sum_{i=1}^n\\log P(i|f_\\theta(x_i)) \\] åˆ°è¿™é‡Œï¼Œç®—æ³•çš„å¤§æ¡†æ¶å°±ç¡®å®šä¸‹æ¥äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯è§£å†³ä¸¤ä¸ªæ•ˆç‡ä¸Šçš„é—®é¢˜ã€‚ä¸€ä¸ªæ˜¯æŸå¤±å‡½æ•°çš„è®¡ç®—æ¯æ¬¡éƒ½éœ€è¦è®¡ç®—æ•´ä¸ªè®­ç»ƒé›†çš„è¡¨ç¤ºï¼ŒåŒæ—¶Softmaxå‡½æ•°ç”±äºåˆ†æ¯å¯¹åº”çš„é¡¹ç›®å¾ˆå¤šï¼ˆç­‰äºè®­ç»ƒé›†å¤§å°ï¼‰åœ¨æ•ˆç‡ä¸Šä¹Ÿæœ‰é—®é¢˜ã€‚ Learning with A Memory Bank è¿™é‡Œè§£å†³ç¬¬ä¸€ä¸ªæ•ˆç‡é—®é¢˜ã€‚è¦è®¡ç®—æŸå¤±å‡½æ•°ï¼Œéœ€è¦éå†æ•´ä¸ªè®­ç»ƒé›†è·å¾—å¯¹åº”çš„è¡¨ç¤ºï¼Œè€Œåœ¨è®­ç»ƒçš„æ—¶å€™æ˜¯ä¸€æ‰¹ä¸€æ‰¹çš„æ•°æ®ï¼Œæ¯æ¬¡é‡æ–°è®¡ç®—è¡¨ç¤ºæ•ˆç‡å¾ˆä½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…å¼•å…¥äº†ç¼“å­˜æœºåˆ¶ï¼Œå³åŠ å…¥ä¸€ä¸ªmemory bank \\(V\\)ï¼Œç”¨æ¥ä¿å­˜è®¡ç®—å¥½çš„è¡¨ç¤º\\(\\mathbf f_i=f_\\theta(x_i)\\)ã€‚ä¸€å¼€å§‹\\(V\\)é‡‡ç”¨å•ä½éšæœºå‘é‡åˆå§‹åŒ–ï¼Œä¹‹ååœ¨è®­ç»ƒçš„æ—¶å€™ä¸æ–­æ›´æ–°\\(\\mathbf f_i\\rightarrow \\mathbf v_i\\)ã€‚ Noise Contrastive Estimation ç¬¬äºŒä¸ªæ•ˆç‡é—®é¢˜å¾ˆå®¹æ˜“æƒ³åˆ°ä½¿ç”¨å™ªå£°å¯¹æ¯”ä¼°è®¡ï¼ˆNoise Contrastive Estimation, NCEï¼‰æ¥åšã€‚NCEä¸»è¦æ˜¯å°†è®¡ç®—å¤æ‚çš„åˆ†æ¯ä½œä¸ºä¸€ä¸ªå‚æ•°æ¥è¿›è¡Œä¼˜åŒ–ï¼š \\[ P(i|\\mathbf v)=\\frac{\\exp(\\mathbf v^\\top\\mathbf f_i/\\tau)}{Z_i} \\] å…¶ä¸­\\(Z_i=\\sum_{j=1}^n\\exp(\\mathbf v^\\top_j\\mathbf f_i/\\tau)\\)ï¼Œå™ªå£°åˆ†å¸ƒ\\(P_n=1/n\\)ï¼Œå¦‚æœå™ªå£°æ ·æœ¬æ•°é‡æ˜¯çœŸå®æ•°æ®çš„\\(m\\)å€ï¼Œé‚£ä¹ˆéšæ„ç»™å®šä¸€ä¸ªæ ·æœ¬ï¼Œå…¶å±äºçœŸå®æ ·æœ¬çš„åéªŒæ¦‚ç‡ä¸ºï¼š \\[ h(i,\\mathbf v)=P(D=1|i,\\mathbf v)=\\frac{P(i|\\mathbf v)}{P(i|\\mathbf v)+mP_n(i)}=\\sigma\\left(s(\\mathbf v)-\\log \\{m P_n(i)\\}\\right) \\] å…¶ä¸­\\(\\Delta s=s(\\mathbf v)-\\log [m P_n(i)]\\)ã€‚è¿™é‡Œçš„çœŸå®æ•°æ®åˆ†å¸ƒ\\(P_d\\)ä¸ºã€‚NCEçš„æŸå¤±å‡½æ•°å°±æ˜¯è¦æœ€å¤§åŒ–\\(h(i,\\mathbf v)\\)ï¼Œæœ€å°åŒ–\\(h(i,\\mathbf v^\\prime)\\) \\[ J_{NCE}(\\theta)=-E_{P_d}[\\log h(i,\\mathbf v)]-m\\cdot E_{P_n}[\\log(1-h(i,\\mathbf v^\\prime))] \\] ä¸ºäº†è®¡ç®—\\(Z_i\\) \\[ Z\\simeq Z_i\\simeq nE_j[\\exp(\\mathbf v_j^\\top\\mathbf f_i/\\tau)]=\\frac{n}{m}\\sum_{k=1}^m\\exp(\\mathbf v_{j_k}^\\top\\mathbf f_i/\\tau) \\] Proximal Regularization æ¯ä¸ªç±»åˆ«åªæœ‰ä¸€ä¸ªæ ·æœ¬ \\[ -\\log h(i,\\mathbf v_i^{(t-1)})+\\lambda\\parallel\\mathbf v_i^{(i)}-\\mathbf v_i^{(i-1)}\\parallel^2_2 \\] æœ€ç»ˆçš„æŸå¤±å‡½æ•°ï¼š \\[ J_{NCE}(\\theta)=-E_{P_d}\\left[\\log h(i,\\mathbf v_i^{(t-1)})-\\lambda\\parallel\\mathbf v_i^{(t)}-\\mathbf v_i^{(t-1)}\\parallel^2_2\\right]\\\\ -m\\cdot E_{P_n}\\left[\\log(1-h(i,\\mathbf v^{\\prime(t-1)}))\\right] \\] Weighted k-Nearest Neighbor Classifier \\(s_i=\\cos(\\mathbf v_i,\\hat{\\mathbf f})\\)ã€‚è®°\\(\\mathcal N_k\\)ã€‚\\(w_c=\\sum_{i\\in\\mathcal N_k}\\alpha_i\\cdot 1(c_i=c)\\)ã€‚ Experiments","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Self-supervised Learning","slug":"Research/Self-supervised-Learning","permalink":"http://qfxiao.me/categories/Research/Self-supervised-Learning/"}],"tags":[{"name":"Representation Learning","slug":"Representation-Learning","permalink":"http://qfxiao.me/tags/Representation-Learning/"},{"name":"Self-supervised Learning","slug":"Self-supervised-Learning","permalink":"http://qfxiao.me/tags/Self-supervised-Learning/"}]},{"title":"Representation Learning with Contrastive Predictive Coding","slug":"Representation-Learning-with-Contrastive-Predictive-Coding","date":"2020-09-17T12:08:53.000Z","updated":"2020-09-17T12:23:15.284Z","comments":true,"path":"2020/09/17/Representation-Learning-with-Contrastive-Predictive-Coding/","link":"","permalink":"http://qfxiao.me/2020/09/17/Representation-Learning-with-Contrastive-Predictive-Coding/","excerpt":"","text":"Introduction æœ¬æ–‡æå‡ºäº†ä¸€ç§è¡¨ç¤ºå­¦ä¹ æ¡†æ¶ï¼šContrastive Predictive Codingï¼ˆCPCï¼‰ã€‚To be finished... åŸæ–‡ Proposed Method Contrastive Predictive Coding N-pair Loss: \\[ \\mathcal L=-\\log\\frac{\\exp(f^+\\cdot f^\\top)}{\\exp(f^+\\cdot f^\\top)+\\sum_{f_j\\neq f^\\top}\\exp(f^+\\cdot f_j)} \\] ä½ æœ‰Nä¸ªæ ·æœ¬\\(\\{x_1,x_2,\\cdots,x_N\\}\\)ï¼Œç„¶åå¯¹åº”çš„è¡¨ç¤ºä¸º\\(f_j\\)ã€‚å‡è®¾å½“å‰æ ·æœ¬ä¸º\\(f^+\\)ï¼Œåœ¨æ‰€æœ‰çš„\\(f_j\\)ä¸­åªæœ‰ä¸€ä¸ªè¡¨ç¤ºä¸\\(f^+\\) matchï¼Œè®°ä¸º\\(f^\\top\\)ï¼ˆå¯ä»¥ç†è§£ä¸ºå±äºåŒä¸€ç±»ï¼Œæˆ–è€…ä¸¤ä¸ªç›¸ä¼¼ï¼‰ï¼Œå…¶ä»–çš„éƒ½æ˜¯è´Ÿæ ·æœ¬ã€‚æˆ‘ä»¬ä¼˜åŒ–ä¸Šé¢çš„ä¼˜åŒ–å…¬å¼å°±ä¼šæ‹‰è¿‘\\(f^+\\)å’Œ\\(f^\\top\\)ä¹‹é—´çš„è·ç¦»ï¼ˆæ‹‰è¿‘åŒç±»ï¼‰ï¼Œç–è¿œ\\(f^+\\)å’Œæ‰€æœ‰å…¶ä»–è´Ÿæ ·æœ¬\\(f_j\\)çš„è·ç¦»ï¼ˆç–è¿œå¼‚ç±»ï¼‰ã€‚ä¸è¿‡åœ¨N-pair Lossä¸­ï¼Œæ­£è´Ÿæ ·æœ¬æ˜¯æ ¹æ®æ ‡ç­¾æ¥é€‰å–çš„ï¼Œç„¶è€Œåœ¨è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰æ ‡ç­¾ã€‚ ä¸‹å›¾å±•ç¤ºäº†Contrastive Predictive Codingçš„ç»“æ„ï¼š å¯¹æ¯”å­¦ä¹  \\[ \\mathcal L(f_i)=-\\log\\frac{\\exp(f_i\\cdot f^\\top)}{\\sum_j\\exp(f_i\\cdot f_j)} \\] è®¾æ•°æ®é›†ï¼ˆä¸€ä¸ªBatchï¼‰ä¸º\\(\\mathbf X=\\{x_1,x_2,\\cdots,x_N\\}\\)ï¼Œæ­£æ ·æœ¬å¯¹ä¸ºï¼Œè´Ÿæ ·æœ¬å¯¹ã€‚ è‡³äº\\(f(\\cdot,\\cdot)\\)çš„å…·ä½“å½¢å¼ï¼Œå…¶å®\\(\\frac{p(x_{t+k}|c_t)}{p(x_{t+k})}\\)è¿™ä¸ªå¼å­æˆ‘ä»¬ä¹Ÿæ˜¯æ²¡æ³•ç›´æ¥ä¼˜åŒ–çš„ï¼Œå› ä¸ºè¿™ä¸ªDensity Ratioæ— æ³•ç›´æ¥ç®—å‡ºæ¥ã€‚åœ¨è¿™é‡Œï¼Œä½œè€…ä½¿ç”¨äº†ä¸€ä¸ªæ›¿ä»£çš„åŠæ³•ï¼Œå°±æ˜¯ç”¨\\(\\mathbf c_t\\)æ¥é¢„æµ‹æœªæ¥çš„éšå˜é‡\\(\\hat{\\mathbf z}_{t+1},\\hat{\\mathbf z}_{t+2},\\cdots\\)ï¼Œè€ŒçœŸå®çš„éšå˜é‡\\(\\mathbf z_{t+1},\\mathbf z_{t+2},\\cdots\\)æˆ‘ä»¬æ˜¯çŸ¥é“çš„ã€‚è¿™é‡Œé¢„æµ‹ç›´æ¥ä½¿ç”¨æƒé‡çŸ©é˜µå’Œ\\(\\mathbf c_t\\)ç›¸ä¹˜ï¼š \\[ f_k(\\mathbf x_{t+k},\\mathbf c_t)=\\exp\\left(\\mathbf z_{t+k}^T \\cdot \\mathbf W_k\\mathbf c_t\\right) \\] ä¸Šå¼æœ‰ç‚¹éš¾ä»¥ç†è§£ï¼Œå®é™…ä¸Šé¢„æµ‹å€¼\\(\\hat{\\mathbf z}_{t+k}=\\mathbf W_k\\mathbf c_t\\)ï¼Œè€Œ\\(\\mathbf z_{t+k}\\hat{\\mathbf z}_{t+k}\\)ç›¸å½“äºè®¡ç®—ä¸¤è€…çš„è·ç¦»ï¼Œå³ç›¸ä¼¼æ€§ã€‚æ‰€ä»¥\\(f_k(\\cdot,\\cdot)\\)å…¶å®æ˜¯åœ¨è®¡ç®—é¢„æµ‹å€¼å’ŒçœŸå®å€¼çš„ç›¸ä¼¼æ€§ã€‚ç°åœ¨å¤§å®¶å…ˆæ¥å—è¿™ä¸ª\\(f(\\cdot,\\cdot)\\)çš„å®šä¹‰ï¼Œå› ä¸ºåé¢ä¼šè¯æ˜ä¼˜åŒ–è¿™ä¸ª\\(f(\\cdot,\\cdot)\\)å°±ç›¸å½“äºåœ¨ä¼˜åŒ–Density Ratio \\(\\frac{p(x_{t+k}|c_t)}{p(x_{t+k})}\\)ã€‚ ä¸€ä¸ªæ¥è‡ª\\(p(x_{t+k}|c_t)\\)çš„æ­£ä¾‹å’Œ\\(N-1\\)ä¸ªæ¥è‡ª\\(p(x_{t+k})\\)çš„è´Ÿä¾‹ï¼Œç›®æ ‡å‡½æ•°ï¼ˆæ–‡ä¸­ç§°ä¸ºCPC Lossï¼‰ä¸ºï¼š \\[ \\mathcal L_N=-\\mathop{\\mathbb E}\\limits_X\\left[\\log\\frac{f_k(x_{t+k},c_t)}{\\sum_{x_j\\in X}f_k(x_j,c_t)}\\right] \\] è¿™é‡Œç›¸å½“äºåšäº†ä¸ª\\(N\\)åˆ†ç±»ï¼Œå› ä¸ºè¿™é‡ŒæŸå¤±å‡½æ•°ç­‰ä»·äº\\(N\\)åˆ†ç±»äº¤å‰ç†µæŸå¤±å‡½æ•°ã€‚ ä¸¤ä¸ªç¦»æ•£éšæœºå˜é‡çš„äº¤å‰ç†µçš„å®šä¹‰ä¸ºï¼š \\[ H(p,q) = -\\sum_{x\\in\\mathcal X}p(x)\\log q(x) \\] å¯¹äºäº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œè®¾\\(i\\)ä¸ºçœŸå®æ ‡ç­¾ï¼Œ\\(\\hat{\\boldsymbol y}\\)ä¸ºåˆ†ç±»å™¨çš„è¾“å‡ºã€‚\\(\\frac{\\exp(\\hat y_i)}{\\sum_j\\exp(\\hat y_j)}\\)ä¸ºç»è¿‡Softmaxå½’ä¸€åŒ–ä¹‹åçš„è¾“å‡ºï¼Œå…¶æ¯ä¸ªåˆ†é‡\\(\\hat y_j\\)ç›¸å½“äºè¾“å…¥æ ·æœ¬\\(x\\)çš„é¢„æµ‹ç±»åˆ«ä¸º\\(j\\)çš„æ¦‚ç‡ã€‚ä¸è¿‡ç”±äºå¯¹äºçœŸå®æ ‡ç­¾\\(y\\)æ¥è¯´ï¼Œåªæœ‰\\(y_i=1\\)ï¼Œå…¶ä»–çš„åˆ†é‡éƒ½ä¸º\\(0\\)ï¼Œæ‰€ä»¥æœ€åäº¤å‰ç†µåªå‰©ä¸‹ä¸€é¡¹ï¼š \\[ \\mathcal L=-\\log\\left(\\frac{\\exp(\\hat y_i)}{\\sum_j\\exp(\\hat y_j)}\\right) \\] \\[ I(x;c)=\\sum_{x,c}p(x,c)\\log\\frac{p(x|c)}{p(x)} \\] ç¼–ç å™¨\\(g_{enc}\\)å°†è§‚æµ‹å€¼\\(\\boldsymbol x_t\\)ç¼–ç åˆ°éšå˜é‡\\(\\boldsymbol z_t=g_\\text{enc}(\\boldsymbol x_t)\\)ï¼ˆå¯¹åº”äºå±€éƒ¨ä¿¡æ¯ï¼‰ï¼Œä¹‹åè‡ªå›å½’æ¨¡å‹\\(g_{ar}\\)å°†æ‰€æœ‰\\(t\\)ä¹‹å‰çš„ï¼ˆåŒ…æ‹¬\\(t\\)ï¼‰éšå˜é‡\\(z_{\\leq t}\\)å‹ç¼©åˆ°ä¸€ä¸ªä¸Šä¸‹æ–‡éšå˜é‡\\(\\boldsymbol c_t=g_\\text{ar}(\\boldsymbol z_{\\leq t})\\)ï¼ˆå¸Œæœ›å…·æœ‰é¢„æµ‹æ€§è´¨ï¼Œæ•è·äº†é•¿æ—¶ä¾èµ–æ€§ï¼‰ã€‚ä¸è¿‡æœ¬æ–‡å¹¶ä¸æ˜¯åŸºäº\\(\\boldsymbol c_t\\)æ¥é¢„æµ‹æœªæ¥çš„è§‚æµ‹å€¼\\(\\boldsymbol x_{t+k}\\)ï¼Œå³ä¼°è®¡åˆ†å¸ƒ\\(p_k(\\boldsymbol x_{t+k}|\\boldsymbol c_t)\\)ï¼Œè€Œè¿™æ ·çš„è¯åˆè¦ç”¨åˆ°MSEä¹‹ç±»çš„Lossã€‚æ–‡ä¸­åˆ©ç”¨çš„æ˜¯æœ€å¤§åŒ–\\(\\boldsymbol c_t\\)å’Œ\\(\\boldsymbol x_{t+k}\\)ä¹‹é—´çš„äº’ä¿¡æ¯\\(\\log \\frac{p(x_{t+k}|c_t)}{p(x_{t+k})}\\)ï¼ˆè¿™ç§å½¢å¼çš„äº’ä¿¡æ¯è¢«ç§°ä¸ºæ˜¯ç‚¹äº’ä¿¡æ¯ï¼Œè¯¦è§ç»´åŸºï¼‰ã€‚å®šä¹‰ä¸€ä¸ªåº¦é‡å‡½æ•°\\(f(\\cdot,\\cdot)\\)ï¼Œè¦æ±‚å…¶å…·æœ‰ä¸\\(\\frac{p(x_{t+k}|c_t)}{p(x_{t+k})}\\)æˆæ¯”ä¾‹çš„æ€§è´¨ï¼š \\[ f_k(x_{t+k},c_t)\\propto\\frac{p(x_{t+k}|c_t)}{p(x_{t+k})} \\] è¿™æ—¶æœ€å¤§åŒ–\\(f(\\cdot,\\cdot)\\)å°±ç›¸å½“äºæœ€å¤§åŒ–ä¸¤è€…çš„äº’ä¿¡æ¯ã€‚ Mutual Information Estimation Explanation ç°åœ¨å›åˆ°å…¬å¼\\(I(x;c)=\\sum_{x,c}p(x,c)\\log\\frac{p(x|c)}{p(x)}\\)ï¼Œ Multual Information äº’ä¿¡æ¯æ˜¯è¡¡é‡å·²çŸ¥ä¸€ä¸ªå˜é‡æ—¶ï¼Œå¦ä¸€ä¸ªå˜é‡ä¸ç¡®å®šæ€§çš„å‡å°‘ç¨‹åº¦çš„åº¦é‡ã€‚å¯¹äºç¦»æ•£éšæœºå˜é‡ï¼Œäº’ä¿¡æ¯çš„å®šä¹‰ä¸ºï¼š \\[ I(X,Y)=\\sum_{y\\in\\mathcal Y}\\sum_{x\\in\\mathcal X}p(x,y)\\log\\frac{p(x,y)}{p(x)p(y)}=\\sum_{y\\in\\mathcal Y}\\sum_{x\\in\\mathcal X}p(x,y)\\log\\frac{p(y|x)}{p(y)} \\] å¯¹äºè¿ç»­éšæœºå˜é‡ï¼Œäº’ä¿¡æ¯çš„å®šä¹‰ä¸ºï¼š \\[ I(X,Y)=\\int_{\\mathcal Y}\\int_{\\mathcal X}p(x,y)\\log\\frac{p(x,y)}{p(x)p(y)}\\mathrm dx\\mathrm d y=\\int_{\\mathcal Y}\\int_{\\mathcal X}p(x,y)\\log\\frac{p(y|x)}{p(y)}\\mathrm dx\\mathrm d y \\] äº’ä¿¡æ¯ä¸ç†µä¹‹é—´çš„å…³ç³»ï¼š \\[ \\begin{align} I(X,Y)&amp;=H(X)-H(X|Y)\\\\ &amp;=H(Y)-H(Y|X)\\\\ &amp;=H(X)+H(Y)-H(X,Y)\\\\ &amp;=H(X,Y)-H(X|Y)-H(Y|X) \\end{align} \\] äº’ä¿¡æ¯ä¸KLæ•£ä¹‹é—´çš„å…³ç³»ï¼š \\[ I(X,Y)=\\mathbb E_Y[D_{KL}(p(x|y)\\parallel p(x))] \\] ä»å›¾ä¸­å¯ä»¥å¾ˆå®¹æ˜“çœ‹å‡ºäº’ä¿¡æ¯ç›¸å½“äº\\(X\\)å’Œ\\(Y\\)ä¸¤è€…çš„ç†µçš„â€œé‡å â€çš„éƒ¨åˆ†ï¼š åœ¨è¡¨ç¤ºå­¦ä¹ ä¸­ï¼Œäº’ä¿¡æ¯çš„åº”ç”¨è¶Šæ¥è¶Šå¹¿æ³›ã€‚å¯¹äºè¾“å…¥çš„æ•°æ®\\(X\\)ï¼Œè¡¨ç¤ºå­¦ä¹ çš„ç›®çš„æ˜¯å°½å¯èƒ½å­¦åˆ°â€œå¥½â€œçš„è¡¨ç¤º\\(Z\\)ï¼Œä¿ç•™åŸå§‹æ•°æ®å°½å¯èƒ½å¤šçš„é‡è¦ä¿¡æ¯ã€‚å¦‚æœä½¿ç”¨åŸºäºé‡æ„çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å°±ä¼šè¦æ±‚æœ€å°åŒ–é‡æ„è¯¯å·®\\(\\parallel X-\\hat{X}\\parallel^2_2\\)ï¼Œä½†æ˜¯è¿™ç§â€é€åƒç´ â€œå¼çš„æŸå¤±å‡½æ•°è¿‡äºä¸¥è‹›ï¼Œä¸åˆ©äºæ¨¡å‹å­¦ä¹ é«˜å±‚è¯­ä¹‰ä¿¡æ¯ã€‚å¦‚æœåŠ å…¥ä¸€ä¸ªåˆ¤åˆ«å™¨æ¥è‡ªåŠ¨å­¦ä¹ ä¸€ä¸ªåº¦é‡ï¼Œé¦–å…ˆå¢å¤§äº†è®¡ç®—å¼€é”€ï¼ŒåŒæ—¶GANæœ¬èº«ä¹Ÿæœ‰è¯¸å¤šé—®é¢˜ã€‚ ç°é˜¶æ®µå¾ˆå¤šå·¥ä½œä½¿ç”¨äº’ä¿¡æ¯æ¥åˆ¤å®šå­¦åˆ°çš„è¡¨ç¤º\\(Z\\)çš„å¥½åï¼Œå³æœ€å¤§åŒ–åŸå§‹æ•°æ®\\(X\\)ä¸è¡¨ç¤º\\(Z\\)ä¹‹é—´çš„äº’ä¿¡æ¯ï¼š \\[ Z^*=\\mathop{\\arg\\max}_{p(z|x)}I(X,Z) \\] äº’ä¿¡æ¯è¶Šå¤§æ„å‘³ç€\\(\\log\\frac{p(z|x)}{p(z)}\\)è¶Šå¤§ï¼Œå³\\(p(z|x)\\)è¦å¤§äº\\(p(z)\\)ã€‚\\(p(z)\\)å¯ä»¥çœ‹ä½œæ˜¯\\(Z\\)çš„å…ˆéªŒï¼Œè€Œ\\(p(z|x)\\gg p(z)\\)å¯ä»¥ç†è§£ä¸ºåœ¨å¾—çŸ¥è¾“å…¥\\(X\\)ä¹‹åï¼Œæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸“å±\\(X\\)çš„é‚£ä¸ªç¼–ç \\(Z\\)ã€‚ æ¥ä¸‹æ¥ä½œè€…è¯æ˜ä¼˜åŒ–\\(\\mathcal L_N\\)ä¼šä½¿å¾—\\(f_k(\\mathbf x_{t+k},\\mathbf c_t)\\)å’Œäº’ä¿¡æ¯æ¥è¿‘ã€‚è¿™é‡Œçš„\\(p(\\mathbf x_{t+k}|\\mathbf c_t)\\)ã€‚è®¾\\(p(d=i|X,c_t)\\)ä¸ºç»™å®šæ•°æ®é›†ï¼ˆæˆ–è€…Batchï¼‰\\(X\\)å’Œcontextå‘é‡\\(c_t\\)çš„æ¡ä»¶ä¸‹ï¼Œæ ·æœ¬\\(x_i\\)ä¸ºæ­£æ ·æœ¬çš„æ¦‚ç‡ï¼Œæœ‰ï¼š \\[ \\begin{align} p(d=i|X,c_t)&amp;=\\frac{p(x_i|c_t)\\prod_{l\\neq i}p(x_l)}{\\sum^N_{j=1} p(x_j|c_t)\\prod_{l\\neq j}p(x_l)}\\\\ &amp;=\\frac{\\frac{p(x_i|c_t)}{p(x_i)}}{\\sum^N_{j=1}\\frac{p(x_j|c_t)}{p(x_j)}} \\end{align} \\] $$ \\[\\begin{align} \\mathcal L_\\text{N}^\\text{opt}&amp;=-\\mathop{\\mathbb E}\\limits_X\\log\\left[\\frac{\\frac{p(x_{t+k}|c_t)}{p(x_{t+k})}}{\\frac{p(x_{t+k}|c_t)}{p(x_{t+k})}+\\sum_{x_j\\in X_\\text{neg}}\\frac{p(x_j|c_t)}{x_j}}\\right]\\\\ \\end{align}\\] $$ \\[ I(x_{t+k},c_t)\\geq \\log(N)-\\mathcal L_N \\] å¯ä»¥è¯´\\(\\mathcal L_N\\)ä½œä¸ºäº’ä¿¡æ¯\\(I(x_{t+k},c_t)\\)çš„ä¸€ä¸ªä¸‹ç•Œã€‚ Implementation Details Experiments Audio Vision Natural Language Reinforcement Learning","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Self-supervised Learning","slug":"Research/Self-supervised-Learning","permalink":"http://qfxiao.me/categories/Research/Self-supervised-Learning/"}],"tags":[{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"},{"name":"Self-supervised Learning","slug":"Self-supervised-Learning","permalink":"http://qfxiao.me/tags/Self-supervised-Learning/"}]},{"title":"Bagging and Random Forest: Machine Learning Ensemble Algorithms 3","slug":"Bagging-and-Random-Forest-Machine-Learning-Ensemble-Algorithms-3","date":"2020-09-15T02:35:01.000Z","updated":"2020-09-15T03:07:06.012Z","comments":true,"path":"2020/09/15/Bagging-and-Random-Forest-Machine-Learning-Ensemble-Algorithms-3/","link":"","permalink":"http://qfxiao.me/2020/09/15/Bagging-and-Random-Forest-Machine-Learning-Ensemble-Algorithms-3/","excerpt":"","text":"Introduction Bagging Baggingçš„æ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ éšæœºé‡‡æ · (Bootstrap)ï¼ŒæŒ‰ç…§å›ºå®šçš„æ•°ç›®å¯¹æ•°æ®é›†åšæœ‰æ”¾å›é‡‡æ ·ï¼Œä¸€èˆ¬æƒ…å†µä¸‹é‡‡æ ·é›†çš„æ•°ç›®å’Œè®­ç»ƒé›†ä¸€æ ·ï¼Œè®¾ä¸º\\(N\\)ï¼Œé‚£ä¹ˆæ¯ä¸ªæ ·æœ¬è¢«é‡‡åˆ°çš„æœºç‡å°±æ˜¯\\(\\frac{1}{N}\\)ï¼Œé‡‡æ ·\\(N\\)æ¬¡éƒ½æ²¡é‡‡åˆ°çš„æœºç‡æ˜¯\\((1-\\frac{1}{N})^N\\)ï¼Œå½“é‡‡æ ·æ•°ç›®\\(N\\)æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œå³\\(N\\rightarrow \\infty\\)æœ‰\\((1-\\frac{1}{N})^N\\rightarrow \\frac{1}{e}\\approx 0.3679\\)ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨æ¯è½®é‡‡æ ·ä¸­ï¼Œé‡‡æ ·æ•°ç›®è¶³å¤Ÿå¤§çš„æƒ…å†µä¸‹ï¼Œå¤§æ¦‚æœ‰\\(36.79\\%\\)çš„æ ·æœ¬æ²¡æœ‰è¢«é‡‡æ ·ä¸­ï¼› ä½¿ç”¨åŸºæ¨¡å‹åœ¨é‡‡æ ·é›†ä¸Šè¿›è¡Œè®­ç»ƒ è¿›è¡Œæ¨¡å‹ç»„åˆçš„æ—¶å€™ï¼Œå¯¹äºåˆ†ç±»é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ç®€å•çš„æŠ•ç¥¨æ³•ï¼Œå¯¹äºå›å½’é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ç®€å•çš„å¹³å‡æ³• Random Forest éšæœºæ£®æ— (Random Forest) æ˜¯Baggingæ¨¡å‹çš„ä¸€ç§ï¼Œ è¿›è¡Œäº†è¯¸å¤šæ”¹è¿›ï¼š ä½¿ç”¨CARTå†³ç­–æ ‘ä½œä¸ºå¼±å­¦ä¹ å™¨ï¼Œ ä½¿ç”¨åˆ—é‡‡æ ·ç­–ç•¥ï¼Œå¯¹äºåˆ’åˆ†ç‰¹å¾çš„é€‰æ‹©è¿›è¡Œä¸‹é‡‡æ ·ï¼Œå³æœ‰\\(M\\)ä¸ªç‰¹å¾ï¼Œåªä¼šéšæœºé€‰å–è¿™\\(M\\)ä¸ªç‰¹å¾çš„ä¸€ä¸ªå­é›†è¿›è¡Œç‰¹å¾é€‰å–ï¼Œè¿›ä¸€æ­¥å‡å°æ–¹å·®","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Machine Learning","slug":"Technical-Notes/Machine-Learning","permalink":"http://qfxiao.me/categories/Technical-Notes/Machine-Learning/"}],"tags":[{"name":"Random Forest","slug":"Random-Forest","permalink":"http://qfxiao.me/tags/Random-Forest/"}]},{"title":"Unsupervised Anomaly Detection Algorithms Overview","slug":"Unsupervised-Anomaly-Detection-Algorithms-Overview","date":"2020-09-10T15:41:22.000Z","updated":"2020-09-18T05:42:24.211Z","comments":true,"path":"2020/09/10/Unsupervised-Anomaly-Detection-Algorithms-Overview/","link":"","permalink":"http://qfxiao.me/2020/09/10/Unsupervised-Anomaly-Detection-Algorithms-Overview/","excerpt":"","text":"Introduction æœªå®Œå¾…ç»­ï¼Œç¼“æ…¢å¡«å‘ä¸­ã€‚ã€‚ã€‚ LOF One-Class SVM Isolation Forest å­¤ç«‹æ£®æ— (Isolation Forest) çš„æ€è·¯å’Œéšæœºæ£®æ—æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼ˆéšæœºæ£®æ—å¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡åšæ–‡ï¼‰ï¼Œå­¤ç«‹æ£®æ—æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§æ ‘æ¨¡å‹ã€‚å­¤ç«‹æ£®æ—è¦è§£å†³çš„æ˜¯æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹é—®é¢˜ï¼Œå³ç»™å®šæ— æ ‡ç­¾çš„è®­ç»ƒé›†ï¼ŒæŠŠå…¶ä¸­çš„å¼‚å¸¸å€¼æŒ‘é€‰å‡ºæ¥ã€‚å­¤ç«‹æ£®æ—çš„åŸºæœ¬å‡è®¾æ˜¯æˆ‘ä¸æ–­é€‰æ‹©ç‰¹å¾è¿›è¡Œåˆ†è£‚ï¼Œè¾¾åˆ°åœæ­¢æ¡ä»¶åï¼Œæ¯ä¸ªå¶å­èŠ‚ç‚¹å°±å¯¹åº”ä¸€ä¸ª/å¤šä¸ªæ ·æœ¬ï¼Œæ­£å¸¸æ ·æœ¬ç”±äºæ¯”è¾ƒé›†ä¸­ï¼Œå¾€å¾€å¤„äºæ¯”è¾ƒæ·±çš„å¶å­èŠ‚ç‚¹ï¼Œè€Œå¼‚å¸¸æ ·æœ¬ç”±äºåç¦»æ­£å¸¸èŒƒå›´ï¼Œæ‰€ä»¥å¾€å¾€å¤„äºæ¯”è¾ƒæµ…çš„å¶å­èŠ‚ç‚¹ã€‚åœ¨æ­¤åŸºç¡€ä¹‹ä¸Šï¼Œå­¤ç«‹æ£®æ—å’Œéšæœºæ£®æ—ç±»ä¼¼ï¼Œé‡‡ç”¨äº†é›†æˆçš„æ–¹æ³•ï¼Œå³é‡‡æ ·å¤šä¸ªé‡‡æ ·é›†ï¼Œåˆ†åˆ«åœ¨é‡‡æ ·é›†ä¸Šè®­ç»ƒï¼Œæœ€åé›†æˆç»“æœã€‚å­¤ç«‹æ£®æ—çš„ä¸»è¦ç‰¹å¾å¦‚ä¸‹ï¼š é¦–å…ˆï¼Œå’Œéšæœºæ£®æ—ä¸€æ ·ï¼Œå­¤ç«‹æ£®æ—ä¹Ÿéœ€è¦å¯¹æ•°æ®é›†è¿›è¡Œé‡‡æ ·ï¼Œä¸è¿‡é‡‡æ ·é›†çš„æ•°é‡å¾€å¾€æ¯”è¾ƒå°ï¼› å¯¹äºæ¯ä¸€æ£µæ ‘çš„å»ºç«‹ï¼Œå­¤ç«‹æ£®æ—é‡‡ç”¨çš„æ˜¯éšæœºé€‰æ‹©ç‰¹å¾è¿›è¡Œåˆ’åˆ†ï¼Œåˆ’åˆ†ç‚¹ä¹Ÿæ˜¯éšæœºé€‰å–ï¼ˆæ‰€ä»¥å­¤ç«‹æ£®æ—çš„æ¯æ£µæ ‘éƒ½æ˜¯äºŒå‰æ ‘ï¼‰ï¼Œè¿™æ ·åšçš„åŸå› å¯èƒ½æ˜¯æˆ‘ä»¬çš„æ•°æ®æ²¡æœ‰æ ‡ç­¾ï¼Œå­¤ç«‹æ£®æ—å¯¹æ•°æ®åˆ†å¸ƒæ²¡æœ‰åšç‰¹å®šå‡è®¾ï¼Œæ‰€ä»¥é‡‡ç”¨éšæœºçš„æ–¹å¼ å¯¹äºå¼‚å¸¸ç‚¹çš„åˆ¤æ–­ï¼Œå­¤ç«‹æ£®æ—æ ¹æ®çš„æ˜¯è¯¥æ ·æœ¬åœ¨æ ‘ä¸Šçš„æ·±åº¦ã€‚å¯¹äºæ ·æœ¬\\(x\\)åœ¨æ ‘\\(T\\)ä¸Šçš„å¼‚å¸¸åˆ†æ•°ï¼Œä½¿ç”¨ä¸‹é¢çš„å…¬å¼è¿›è¡Œè®¡ç®—ï¼š \\[ h(x) = e + C(N_T) \\] å…¶ä¸­\\(e\\)ä¸ºè¯¥æ ·æœ¬åœ¨æ ‘ä¸Šçš„æ·±åº¦ï¼Œ\\(C(N_T)\\)ä¸ºç”¨\\(N_T\\)ä¸ªæ ·æœ¬æ„å»ºäºŒå‰æ ‘çš„ä¸€ä¸ªå¹³å‡æ·±åº¦çš„ä¼°è®¡å€¼ï¼Œå¯ä»¥ç”±ä¸‹å¼è®¡ç®—ï¼š \\[ C(n)=2H(n-1)-\\frac{2(n-1)}{n} \\] å…¶ä¸­\\(H(n-1)\\)å¯ä»¥ç”±\\(\\ln (n-1)+\\gamma\\)ä¼°ç®—ï¼Œ\\(\\gamma\\)ä¸ºæ¬§æ‹‰å¸¸æ•°ã€‚ æœ€åçš„å¼‚å¸¸åˆ†æ•°é‡‡ç”¨é›†æˆçš„æ–¹å¼ï¼š \\[ \\mathcal S(x) = 2^{-\\frac{E(h(x))}{C(\\psi)}} \\] \\(E(h(x))\\)ä»£è¡¨æ ·æœ¬\\(x\\)åœ¨ä¸åŒæ ‘ä¸Šåˆ†æ•°çš„å‡å€¼ï¼Œ\\(C(\\psi)\\)ä»£è¡¨ä¸»è¦ç”¨æ¥åšå½’ä¸€åŒ–ï¼Œ\\(\\psi\\)ä»£è¡¨ç”¨æ¥å»ºæ ‘çš„é‡‡æ ·é›†çš„æ ·æœ¬æ•°ã€‚","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Anomaly Detection","slug":"Technical-Notes/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Technical-Notes/Anomaly-Detection/"}],"tags":[{"name":"LOF","slug":"LOF","permalink":"http://qfxiao.me/tags/LOF/"},{"name":"OCSVM","slug":"OCSVM","permalink":"http://qfxiao.me/tags/OCSVM/"},{"name":"iForest","slug":"iForest","permalink":"http://qfxiao.me/tags/iForest/"}]},{"title":"Model Selection and Evaluation: Machine Learning Basics","slug":"Model-Selection-and-Evaluation-Machine-Learning-Basics","date":"2020-09-09T03:33:25.000Z","updated":"2020-09-10T05:46:03.870Z","comments":true,"path":"2020/09/09/Model-Selection-and-Evaluation-Machine-Learning-Basics/","link":"","permalink":"http://qfxiao.me/2020/09/09/Model-Selection-and-Evaluation-Machine-Learning-Basics/","excerpt":"","text":"Introduction Overfitting æˆ‘ä»¬å°†æ¨¡å‹è¾“å‡ºä¸çœŸå®å€¼ä¹‹é—´çš„å·®å¼‚ç§°ä¸ºè¯¯å·®ï¼Œå¦‚å¯¹äºåˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¨¡å‹åˆ†ç±»é”™è¯¯çš„æ ·æœ¬æ•°é‡å æ€»æ ·æœ¬æ•°çš„æ¯”ä¾‹ã€‚æ¨¡å‹åœ¨è®­ç»ƒé›†ï¼ˆæˆ‘ä»¬æ”¶é›†åˆ°çš„æ•°æ®ï¼‰ä¸Šçš„è¯¯å·®ç§°ä½œæ˜¯è®­ç»ƒè¯¯å·® (training error)ï¼Œè€Œåœ¨æ–°æ ·æœ¬ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯æ–°çš„æ ·æœ¬è€Œä¸æ˜¯æµ‹è¯•é›†ï¼Œè®­ç»ƒé›†æµ‹è¯•é›†æ˜¯ä»æˆ‘ä»¬æ”¶é›†åˆ°çš„æ•°æ®ä¸Šäººä¸ºåˆ’åˆ†å‡ºæ¥çš„ï¼‰ä¸Šçš„è¯¯å·®ç§°ä½œæ˜¯æ³›åŒ–è¯¯å·® (generalization error)ã€‚å¯¹äºæœºå™¨å­¦ä¹ ç®—æ³•ï¼Œæˆ‘ä»¬å¸Œæœ›ç®—æ³•èƒ½å­¦åˆ°æ•°æ®èƒŒåçš„æ™®éè§„å¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ€»æ˜¯å¸Œæœ›æ¨¡å‹çš„æ³›åŒ–è¯¯å·®è¶Šå°è¶Šå¥½ã€‚ ä¸è¿‡æµ‹è¯•é›†å¯¹è®­ç»ƒè¿‡ç¨‹æ¥è¯´æ˜¯æœªçŸ¥çš„ï¼Œæ‰€ä»¥æ¨¡å‹åªèƒ½å°½é‡ä»è®­ç»ƒé›†ä¸­å‘æ˜æ•°æ®çš„æ™®éè§„å¾‹ï¼Œè¦æ˜¯æ¨¡å‹æŠŠè®­ç»ƒé›†å­¦å¾—â€å¤ªå¥½â€œäº†ï¼Œå¾ˆå¯èƒ½æŠŠè®­ç»ƒé›†ä¸­ä¸å±äºæ™®éè§„å¾‹çš„éƒ¨åˆ†ç‰¹ç‚¹ä½œä¸ºäº†ä¸€èˆ¬æ€§è´¨ï¼Œè¿™å°±ä¼šå¯¼è‡´æ³›åŒ–æ€§èƒ½ä¸‹é™ï¼Œæˆ‘ä»¬ç§°è¿™ç§æƒ…å†µä¸ºè¿‡æ‹Ÿåˆ (overfitting)ã€‚åä¹‹ï¼Œæ¨¡å‹å¯¹è®­ç»ƒé›†çš„ç‰¹æ€§å­¦å¾—ä¸å¤Ÿï¼Œå°±ä¼šå‡ºç°æ¬ æ‹Ÿåˆ (underfitting)ã€‚å…³äºè¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆï¼Œå‘¨å¿—åè€å¸ˆçš„ã€Šæœºå™¨å­¦ä¹ ã€‹ä¸­æœ‰ä¸€å¼ å¾ˆå¥½çš„å›¾ï¼š ä¸€èˆ¬æ¥è¯´ï¼Œæ¬ æ‹Ÿåˆæ¯”è¾ƒå®¹æ˜“å…‹æœï¼Œå¯ä»¥é€šè¿‡å¢åŠ æ¨¡å‹çš„å¤æ‚åº¦æ¥å®ç°ã€‚è€Œè¿‡æ‹Ÿåˆåˆ™æ¯”è¾ƒéš¾è§£å†³ï¼Œä¸€èˆ¬è€Œè¨€å¯ä»¥é€šè¿‡å¢åŠ æ•°æ®é‡ã€åŠ æ­£åˆ™åŒ–çº¦æŸæ¥æ”¹å–„ã€‚ Model Selection å¯¹äºä¸€ä¸ªæœºå™¨å­¦ä¹ ä»»åŠ¡ï¼Œä¸€èˆ¬æˆ‘ä»¬æœ‰å¤šç§æ¨¡å‹ä¾›æˆ‘ä»¬é€‰æ‹©ï¼Œå¹¶ä¸”æ¨¡å‹ä¹Ÿæœ‰ä¸åŒçš„è¶…å‚æ•°ï¼Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°æ³›åŒ–æ€§èƒ½å°½å¯èƒ½é«˜çš„æ¨¡å‹ã€‚ä¸è¿‡æ ¹æ®å‰é¢çš„è®¨è®ºï¼Œæ–°æ ·æœ¬æ˜¯æœªçŸ¥çš„ï¼Œæ‰€ä»¥æ²¡æ³•ç›´æ¥å¾—åˆ°æ³›åŒ–è¯¯å·®ï¼Œè€Œè¿‡æ‹Ÿåˆçš„å­˜åœ¨ä½¿å¾—æˆ‘ä»¬ä¸èƒ½è´¸ç„¶çš„æ ¹æ®æ¨¡å‹åœ¨æˆ‘ä»¬æ”¶é›†åˆ°çš„æ•°æ®ä¸Šçš„è¡¨ç°æ¥é€‰æ‹©æ¨¡å‹ï¼ˆè®­ç»ƒè¯¯å·®ä½ä¸ä»£è¡¨æ³›åŒ–è¯¯å·®ä½ï¼‰ã€‚ æˆ‘ä»¬å‡è®¾æ— è®ºæ˜¯æˆ‘ä»¬æ”¶é›†åˆ°çš„æ•°æ®è¿˜æ˜¯æ–°æ ·æœ¬éƒ½æ˜¯ä»æ•°æ®çš„çœŸå®åˆ†å¸ƒä¸­ç‹¬ç«‹åŒåˆ†å¸ƒé‡‡æ ·å¾—æ¥ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥ä»æ•°æ®ä¸­åˆ’åˆ†å‡ºä¸€éƒ¨åˆ†â€æµ‹è¯•é›†â€œï¼Œç„¶åå°†æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„è¡¨ç°ä½œä¸ºæ³›åŒ–è¯¯å·®çš„è¿‘ä¼¼ï¼Œè€Œå‰©ä¸‹çš„éƒ¨åˆ†ç”¨æ¥æ¨¡å‹è®­ç»ƒã€‚ é‚£ä¹ˆå¦‚ä½•åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†å‘¢ï¼Ÿæ¯”è¾ƒå¸¸è§çš„æ–¹æ³•æ˜¯â€\\(k\\)æŠ˜äº¤å‰éªŒè¯æ³•â€œ (\\(k\\)-fold cross validation)ï¼Œä¸€èˆ¬\\(k\\)å¸¸å–\\(10\\)ï¼Œå…¶åŸºæœ¬æ€æƒ³å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š \\(k\\)æŠ˜äº¤å‰éªŒè¯æ³•é¦–å…ˆå°†æ•°æ®é›†å‡åŒ€åœ°åˆ’åˆ†ä¸º\\(k\\)ä¸ªéƒ¨åˆ†ï¼Œç„¶åè¿›è¡Œ\\(k\\)ä¸ªå¾ªç¯ï¼Œåœ¨æ¯ä¸ªå¾ªç¯ä¸­å°†ç¬¬\\(k\\)ä»½ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™çš„ä½œä¸ºè®­ç»ƒé›†ï¼Œæœ€åå¾—åˆ°çš„ç»“æœè¿›è¡Œå¹³å‡ã€‚ Evaluation Metrics å‰é¢æˆ‘ä»¬è®¨è®ºäº†è¯„æµ‹çš„æ¡†æ¶ï¼Œä½†æ˜¯æ²¡æœ‰è¯´å…·ä½“çš„è¯„æµ‹æŒ‡æ ‡ã€‚å®é™…ä¸Šè¯„æµ‹æŒ‡æ ‡è¦æ ¹æ®ä»»åŠ¡æ¥ç¡®å®šï¼Œå¹¶ä¸”ä¸åŒçš„è¯„æµ‹æŒ‡æ ‡ä¹Ÿæœ‰è‡ªå·±çš„ç‰¹ç‚¹ã€‚ Regression å›å½’ä»»åŠ¡æ¯”è¾ƒå¸¸ç”¨çš„è¯„æµ‹æ ‡å‡†æ˜¯å‡æ–¹è¯¯å·® (Mean Squared Error)ï¼š \\[ \\text{MSE}(f;D)=\\frac{1}{m}\\sum_{i=1}^m (f(x_i)-y_i)^2 \\] å’Œå¹³å‡ç»å¯¹è¯¯å·® (Mean Absolute Error)ï¼š \\[ \\text{MAE}(f;D)=\\frac{1}{m}\\sum_{i=1}^m |f(x_i)-y_i| \\] Classification Binary Classification å¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œæœ€ç®€å•çš„æƒ³æ³•æ˜¯ä½¿ç”¨æ¨¡å‹åˆ†ç±»æ­£ç¡®çš„æ¯”ä¾‹æ¥ä½œä¸ºè¯„æµ‹æ ‡å‡†ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå‡†ç¡®ç‡ (Accuracy)ï¼š \\[ \\text{ACC}(f;D)=\\frac{1}{m}\\sum_{i=1}^m \\mathbb{I}(f(x_i)=y_i) \\] ä½†å‡†ç¡®ç‡å¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„æ‰€æœ‰è¦æ±‚ï¼Œæ¯”å¦‚è¯´å¯¹äºæ–°å† ç—…æ¯’çš„åˆ†ç±»ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ›´å…³æ³¨äºå¯¹äºæ‰€æœ‰æ‚£æœ‰æ–°å† çš„ç—…äººï¼Œæ¨¡å‹åˆ°åº•æŸ¥å‡ºæ¥äº†å¤šå°‘ï¼Œè€Œå¯¹äºæ¨¡å‹è¯¯æŠŠæ­£å¸¸ç—…äººå½“ä½œæ˜¯æ‚£ç—…çš„æƒ…å†µæ²¡æœ‰é‚£ä¹ˆå…³æ³¨ã€‚å¯¹äºäºŒåˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ ·ä¾‹æ ¹æ®å…¶çœŸå®ç±»åˆ«ä¸æ¨¡å‹é¢„æµ‹çš„ç±»åˆ«åˆ’åˆ†ä¸ºçœŸæ­£ä¾‹ (true positive, TP)ã€å‡æ­£ä¾‹ (false positive, FP)ã€çœŸåä¾‹ (true negative, TN) å’Œå‡åä¾‹ (false negative, FN) å››ç§ï¼Œå½¢æˆæ··æ·†çŸ©é˜µ (Confusion Matrix)ï¼š ä¸‹é¢ç»™ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼š æ¯”å¦‚æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯é¢„æµ‹ä¸€å¼ æ‰‹å†™æ•°å­—å›¾ç‰‡æ˜¯ä¸æ˜¯\\(5\\)ï¼Œæ ¹æ®ä¸Šå›¾ï¼Œå³ä¸‹è§’å°±æ˜¯æˆ‘ä»¬æ­£ç¡®é¢„æµ‹çš„æ˜¯\\(5\\)çš„å›¾ç‰‡ï¼Œå·¦ä¸‹è§’å°±æ˜¯æœ¬æ¥æ˜¯\\(5\\)ï¼Œä½†è¢«é¢„æµ‹æˆä¸æ˜¯\\(5\\)çš„å›¾ç‰‡ï¼›å·¦ä¸Šè§’æ˜¯æœ¬æ¥ä¸æ˜¯\\(5\\)ï¼Œæˆ‘ä»¬ä¹Ÿæ­£ç¡®åœ°é¢„æµ‹å‡ºå…¶ä¸æ˜¯\\(5\\)çš„ï¼Œå³ä¸Šè§’æ˜¯æœ¬æ¥ä¸æ˜¯\\(5\\)å´è¢«é¢„æµ‹æˆæ˜¯\\(5\\)çš„ã€‚æ˜¯ä¸æ˜¯æœ‰ç‚¹è¢«ç»•æ™•äº†ğŸ˜€ï¼Œåªè¦è®°ä½Tå’ŒFä»£è¡¨çš„æ˜¯é¢„æµ‹ç»“æœå¯¹è¿˜æ˜¯ä¸å¯¹ï¼ŒPå’ŒNä»£è¡¨çš„æ˜¯æ¨¡å‹é¢„æµ‹å½“å‰æ ·æœ¬æ˜¯æ­£ä¾‹è¿˜æ˜¯è´Ÿä¾‹ã€‚ åŸºäºæ··æ·†çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰æŸ¥å‡†ç‡ (Precision) å’ŒæŸ¥å…¨ç‡ (Recall) è¿™ä¸¤ä¸ªè¯„æµ‹æ ‡å‡†ã€‚ æŸ¥å‡†ç‡ï¼Œé¡¾åæ€ä¹‰ï¼Œå¯¹äºæ£€æµ‹å‡ºæ¥çš„æ­£ä¾‹ï¼Œæœ‰å¤šå°‘æ˜¯çœŸæ­£çš„æ­£ä¾‹ï¼Œå³æŸ¥çš„å‡†ä¸å‡†ï¼Œå…¬å¼ä¸ºï¼š \\[ \\text{Precision}=\\frac{TP}{TP+FP} \\] åˆ†æ¯å°±æ˜¯æ¨¡å‹é¢„æµ‹ä¸ºæ­£ä¾‹çš„æ ·æœ¬æ€»æ•°ã€‚ æŸ¥å…¨ç‡ï¼Œå°±å¯¹åº”åˆšæ‰ä¸¾çš„æ–°å† çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ¯”è¾ƒåœ¨ä¹å¯¹äºæ•°æ®é›†ä¸­çš„æ­£ä¾‹ï¼Œæœ‰å¤šå°‘è¢«æŸ¥å‡ºæ¥äº†ï¼Œå…¬å¼ä¸ºï¼š \\[ \\text{Recall} = \\frac{TP}{TP+FN} \\] åˆ†æ¯å°±æ˜¯çœŸå®ç±»åˆ«ä¸ºæ­£ä¾‹çš„æ ·æœ¬æ€»æ•°ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒæŸ¥å‡†ç‡å’ŒæŸ¥å…¨ç‡æ˜¯ç›¸äº’çŸ›ç›¾çš„ï¼Œé™¤éæ˜¯ç‰¹åˆ«ç®€å•çš„ä»»åŠ¡ï¼Œå¾ˆéš¾å…¼é¡¾æŸ¥å‡†ç‡å’ŒæŸ¥å…¨ç‡ã€‚ F1åˆ†æ•° (F1 Score) ç»¼åˆäº†æŸ¥å‡†ç‡å’ŒæŸ¥å…¨ç‡ï¼š \\[ \\text{F}1=\\frac{2\\cdot\\text{Precision}\\cdot\\text{Recall}}{\\text{Precision}+\\text{Recall}} \\] æŸ¥å‡†ç‡å’ŒæŸ¥å…¨ç‡ä¸­ä»»æ„ä¸€é¡¹è¾ƒä½éƒ½ä¼šå¯¼è‡´F1åˆ†æ•°è¾ƒä½ã€‚æœ‰æ—¶å€™æˆ‘ä»¬å¯¹å¾…æŸ¥å‡†ç‡å’ŒæŸ¥å…¨ç‡çš„æƒé‡ä¸åŒï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨F\\(_\\beta\\)åˆ†æ•°ï¼š \\[ \\text{F}_\\beta=\\frac{(1+\\beta^2)\\cdot \\text{Precision}\\cdot\\text{Recall}}{(\\beta^2\\cdot\\text{Precision})+\\text{Recall}} \\] \\(\\beta=1\\)æ—¶ç­‰ä»·äºF1åˆ†æ•°ï¼Œ\\(\\beta&gt;1\\)ä»£è¡¨åé‡æŸ¥å…¨ç‡ï¼Œ\\(\\beta&lt;1\\)ä»£è¡¨åé‡æŸ¥å‡†ç‡ã€‚ Multi-classification å‰é¢çš„è®¨è®ºéƒ½æ˜¯åŸºäºäºŒåˆ†ç±»ä»»åŠ¡ï¼Œå¦‚æœæ˜¯å¤šåˆ†ç±»ä»»åŠ¡çš„è¯ï¼Œ å¯¹äºæ¯ä¸€ç±»ï¼Œæˆ‘ä»¬å°†è¯¥ç±»ä½œä¸ºæ­£ä¾‹ï¼Œå…¶ä»–ç±»åˆ«ä½œä¸ºè´Ÿä¾‹ï¼Œéƒ½èƒ½å¾—åˆ°ä¸€ä¸ªæ··æ·†çŸ©é˜µã€‚å¦‚æœæˆ‘ä»¬åœ¨æ¯ä¸ªæ··æ·†çŸ©é˜µä¸Šè®¡ç®—è¯„æµ‹æŒ‡æ ‡ï¼Œç„¶åè¿›è¡Œå¹³å‡ï¼Œè¿™æ ·å°±å¾—åˆ°å®æŸ¥å‡†ç‡ (macro-Precision)ã€å®æŸ¥å…¨ç‡ (macro-Recall) å’Œå®F1åˆ†æ•° (macro-F1)ã€‚å¦‚æœæˆ‘ä»¬äº‹å…ˆå°†æ··æ·†çŸ©é˜µçš„TPã€FPã€TNã€FNå…ˆè¿›è¡Œå¹³å‡ï¼Œå†è®¡ç®—è¯„æµ‹æŒ‡æ ‡ï¼Œå°±å¾—åˆ°äº†å¾®æŸ¥å‡†ç‡ (micro-Precision)ã€å¾®æŸ¥å…¨ç‡ (micro-Recall) å’Œå¾®F1åˆ†æ•° (micro-F1)ã€‚ PR-Curve å¾ˆå¤šæƒ…å†µä¸‹æ¨¡å‹çš„è¾“å‡ºæ˜¯æ ·æœ¬ä¸ºæ­£ä¾‹çš„â€œæ¦‚ç‡å€¼â€æˆ–è€…æ˜¯åˆ†æ•°ï¼Œåˆ†æ•°è¶Šé«˜çš„æ ·æœ¬ä»£è¡¨è¶Šå¯èƒ½æ˜¯æ­£ä¾‹ã€‚è¿™ç§æ—¶å€™éœ€è¦äººä¸ºåˆ’å®šé˜ˆå€¼ï¼Œè§„å®šé«˜äºé˜ˆå€¼çš„æ ·æœ¬æ˜¯æ­£ä¾‹ã€‚ä¸è¿‡é˜ˆå€¼çš„åˆ’åˆ†ç›¸å½“äºè¶…å‚æ•°çš„é€‰å–ï¼ŒåŒæ—¶æˆ‘ä»¬ä¼šè®¤ä¸ºä¸€ä¸ªé²æ£’çš„æ¨¡å‹çš„æ€§èƒ½åº”è¯¥ä¸å—é˜ˆå€¼é€‰å–çš„å·¦å³ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨PRæ›²çº¿ (Precision-Recall Curve)ï¼Œå³éå†æ‰€æœ‰å¯èƒ½çš„é˜ˆå€¼ï¼Œå¯¹äºæ¯ä¸ªé˜ˆå€¼ï¼Œè®¡ç®—å…¶å¯¹åº”çš„Precisionå’ŒRecallï¼Œç„¶åç”»åœ¨å›¾ä¸Šï¼Œæœ€åä¼šå¾—åˆ°ä¸€ç³»åˆ—ç¦»æ•£çš„ç‚¹ï¼ˆç†è®ºä¸Šåº”è¯¥æ˜¯è¿ç»­æ›²çº¿ï¼Œä¸è¿‡é˜ˆå€¼æ˜¯è¿ç»­å€¼ï¼Œæˆ‘ä»¬åªèƒ½å–ç¦»æ•£å€¼ï¼‰ï¼Œå½¢æˆPR-æ›²çº¿ã€‚ æ¨¡å‹æ€§èƒ½è¶Šå¥½ï¼Œæ›²çº¿å°±ä¼šè¶Šæ¥è¿‘å³ä¸Šè§’çš„ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠPRæ›²çº¿çš„æ›²çº¿ä¸‹é¢ç§¯ (PR-AUC) ä½œä¸ºè¯„æµ‹æ ‡å‡†ã€‚ ROC-Curve ROCå…¨ç§°æ˜¯å—è¯•è€…å·¥ä½œç‰¹å¾ (Receiver Operating Characteristic) æ›²çº¿, å’ŒPRæ›²çº¿ç±»ä¼¼ï¼ŒROCæ›²çº¿ä¹Ÿæ˜¯éå†ä¸åŒçš„é˜ˆå€¼è®¡ç®—ç‚¹ï¼Œä¸è¿‡ROCæ›²çº¿è®¡ç®—çš„æ˜¯çœŸæ­£ä¾‹ç‡ (True Positive Rate, TPR) å’Œå‡æ­£ä¾‹ç‡ (False Positive Rate, FPR)ï¼Œä¸¤è€…å®šä¹‰åˆ†åˆ«æ˜¯ï¼š \\[ \\begin{align} \\text{TPR}=\\frac{TP}{TP+FN}\\\\ \\text{FPR}=\\frac{FP}{TN+FP} \\end{align} \\] å…¶ä¸­TPRå°±æ˜¯æŸ¥å…¨ç‡ï¼Œè€ŒFPRæ˜¯æ‰€æœ‰è´Ÿä¾‹ä¸­æ²¡æœ‰æ£€æµ‹å‡ºæ¥çš„æ¯”ä¾‹ï¼Œè¿™ä¸€é¡¹æ˜¯è¶Šä½è¶Šå¥½ã€‚ æ¨¡å‹æ€§èƒ½è¶Šå¥½ï¼Œæ›²çº¿å°±ä¼šè¶Šæ¥è¿‘å·¦ä¸Šè§’çš„ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠROCæ›²çº¿çš„æ›²çº¿ä¸‹é¢ç§¯ (ROC-AUC) ä½œä¸ºè¯„æµ‹æ ‡å‡†ã€‚ ä¸‹é¢æ¥æ€»ç»“ä¸€ä¸‹PRæ›²çº¿å’ŒROCæ›²çº¿ä¹‹é—´çš„ä¼˜ç¼ºç‚¹ã€‚ çºµè½´ æ¨ªè½´ PR \\(\\text{Precision}=\\frac{TP}{TP+FP}\\) \\(\\text{Recall} = \\frac{TP}{TP+FN}\\) ROC \\(\\text{TPR}=\\frac{TP}{TP+FN}\\) \\(\\text{FPR}=\\frac{FP}{TN+FP}\\) ROCçš„ä¼˜ç‚¹ï¼š ç›¸æ¯”PRä»…å…³æ³¨æ­£ä¾‹ï¼ŒROCåŒæ—¶å…³æ³¨æ­£ä¾‹å’Œè´Ÿä¾‹ ç›¸æ¯”PRä¸æ˜“å—åˆ°æ­£è´Ÿä¾‹ç›¸å¯¹æ•°é‡çš„å½±å“ï¼ŒROCçš„ä¸¤ä¸ªæŒ‡æ ‡çš„è®¡ç®—éƒ½åªæ¶‰åŠåˆ°Pã€Nä¸­çš„ä¸€åˆ—ï¼Œæ­£ä¾‹æˆ–è´Ÿä¾‹å¢åŠ å¯¹æ€»ä½“å½±å“ä¸å¤§ã€‚è€ŒPRæ›²çº¿å°±ä¸ä¸€æ ·ï¼Œä¸¤ä¸ªæŒ‡æ ‡çš„è®¡ç®—éƒ½æ¶‰åŠåˆ°äº†Pã€Nä¸¤åˆ—ï¼Œé‚£ä¹ˆæ­£ä¾‹æˆ–è´Ÿä¾‹æ ·æœ¬æ•°é‡çš„å˜åŒ–ä¼šé€ æˆè¾ƒå¤§å½±å“ã€‚å¦‚è´Ÿä¾‹çªç„¶å¢å¤§ï¼Œé‚£ä¹ˆFPä¹Ÿä¼šå¢å¤§ï¼Œè¿™æ ·Precisionä¼šé™ä½ï¼Œè€ŒRecallå´ä¸å˜ã€‚ ROCçš„ç¼ºç‚¹ï¼š å¯¹äºç±»åˆ«ä¸å¹³è¡¡é—®é¢˜ï¼Œå­˜åœ¨å¤§é‡è´Ÿä¾‹ï¼Œè¿™æ ·ä¼šå¸¦æ¥å¤§é‡çš„FPï¼Œè€ŒROCçš„FPRå´ä¸ä¼šå› ä¸ºFPçš„å¤§å¹…å¢é•¿è€Œå‰§çƒˆæ”¹å˜ï¼Œç»“æœæ˜¯è¿™ä¸€ç±»é”™è¯¯å¾ˆéš¾åœ¨ROCæ›²çº¿ä¸­ä½“ç°å‡ºæ¥ã€‚æ‰€ä»¥ROCä¼šå‘ˆç°å‡ºä¸€ä¸ªè¿‡äºä¹è§‚çš„è¯„ä»·ã€‚ æˆ‘ä»¬æ¥å°è¯•ä¸‹æ˜¯å¦å¦‚æ­¤ï¼Œä¸‹é¢æ˜¯ç”¨éšæœºæ£®æ—åˆ†ç±»å™¨ï¼Œæµ‹è¯•æ ·æœ¬æ­£è´Ÿä¾‹æ•°é‡æ¯”ä¸º1:1çš„æƒ…å†µä¸‹çš„ROCæ›²çº¿å’ŒPRæ›²çº¿ï¼š åœ¨æˆ‘ä»¬å°†æ­£è´Ÿä¾‹æ•°é‡æ¯”è°ƒæ•´ä¸º1:9ä¹‹åï¼ˆæ€»æ•°é‡ç›¸åŒï¼‰ï¼Œå¯ä»¥çœ‹åˆ°ROCæ›²çº¿æ¯”è¾ƒç¨³å®šï¼Œæ²¡å‡ºç°è¾ƒå¤§å˜åŒ–ï¼Œè€ŒPRæ›²çº¿åˆ™å‡ºç°äº†å‰§çƒˆå˜åŒ–ï¼š Bias and Variance åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œåå·®-æ–¹å·®åˆ†è§£æ˜¯è§£é‡Šå­¦ä¹ ç®—æ³•æ³›åŒ–æ€§èƒ½çš„é‡è¦å·¥å…·ã€‚å‡è®¾æˆ‘ä»¬è¦é¢„æµ‹æŸä¸€ä¸ªåœ°åŒºçš„æˆ¿å­çš„æˆ¿ä»·ï¼Œæ¯ä¸€å¥—æˆ¿å­éƒ½æ˜¯ä¸€ä¸ªæ ·æœ¬ï¼Œæˆ‘ä»¬è®¤ä¸ºæ¯ä¸ªæ ·æœ¬éƒ½æ˜¯ä»æ€»ä½“åˆ†å¸ƒ\\(P(X)\\)ç‹¬ç«‹åŒåˆ†å¸ƒé‡‡æ ·å¾—æ¥çš„ã€‚ä¸è¿‡æˆ‘ä»¬ä¸å¯èƒ½å¾—åˆ°æ‰€æœ‰çš„æ ·æœ¬ï¼Œæˆ‘ä»¬é‡‡æ ·å¾—åˆ°çš„è®­ç»ƒé›†åªæ˜¯å…¶ä¸­ä¸€ä¸ªå­é›†ã€‚é‚£ä¹ˆï¼Œå³ä½¿å¯¹äºåŒæ ·çš„æµ‹è¯•æ ·æœ¬ï¼Œä½¿ç”¨ä¸åŒçš„è®­ç»ƒé›†ï¼ˆè®­ç»ƒé›†å¤§å°ç›¸åŒï¼‰è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹å¯¹æµ‹è¯•æ ·æœ¬çš„é¢„æµ‹ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å°†è¿™ä¸€éƒ¨åˆ†æ¨¡å‹è‡ªèº«çš„ä¸ç¨³å®šæ€§ç”¨æ–¹å·® (Variance) æ¥æè¿°ï¼š\\(\\text{Var}(X)=E_D\\left[(\\hat f(X)-E[\\hat f(X)])^2\\right]\\)ï¼Œæ–¹å·®è¶Šå°ä»£è¡¨æ¨¡å‹ç¨³å®šæ€§è¶Šå¼ºã€‚æ¨¡å‹è¾“å‡ºçš„æœŸæœ›ä¸çœŸå®å€¼ä¹‹é—´çš„å·®è·æˆ‘ä»¬ç”¨åå·® (Bias) æ¥æè¿°ï¼š\\(\\text{Bias}(X)=E[\\hat f(X)]-f(X)\\)ã€‚ æ³›åŒ–è¯¯å·®ä¸æ–¹å·®ã€åå·®æœ‰ä¸‹åˆ—å…³ç³»ï¼š \\[ \\begin{align} \\text{Err}(X)&amp;=E\\left[(y-\\hat f(X))^2\\right]\\\\ &amp;=E\\left[(f(X)+\\varepsilon-\\hat f(X))^2\\right]\\\\ &amp;= (E[\\hat f(X)]-f(X))^2 + E\\left[(\\hat f(X)-E[\\hat f(X)])^2\\right]+\\sigma_{\\varepsilon}^2\\\\ &amp;=\\text{Bias}^2 + \\text{Variance} + \\text{Random Error} \\end{align} \\] ä¹Ÿå°±æ˜¯è¯´æ³›åŒ–è¯¯å·®å¯ä»¥åˆ†è§£ä¸ºæ–¹å·®ã€åå·®å’Œéšæœºå™ªå£°ä¹‹å’Œã€‚åå·®åˆ»ç”»äº†æ¨¡å‹çš„æœŸæœ›é¢„æµ‹ä¸çœŸå®å€¼ä¹‹é—´çš„åç¦»ç¨‹åº¦ï¼Œæ–¹å·®åˆ»ç”»äº†ä¸åŒè®­ç»ƒé›†å¯¹æ¨¡å‹æ€§èƒ½çš„å½±å“ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å›¾ä¸­å·¦ä¸Šè§’çš„éƒ¨åˆ†æ˜¯æ¯”è¾ƒç†æƒ³çš„æƒ…å†µï¼Œå³æ–¹å·®å’Œåå·®éƒ½è¾ƒå°ã€‚ä½†å®é™…ä¸Šæ–¹å·®å’Œåå·®å¾€å¾€æ˜¯ç›¸äº’å†²çªçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ¨¡å‹å¤æ‚åº¦ä¸è¶³çš„æ—¶å€™ï¼Œæ¨¡å‹çš„æ‹Ÿåˆèƒ½åŠ›ä¸å¤Ÿå¼ºï¼Œåå·®ä¸»å¯¼äº†æ³›åŒ–è¯¯å·®ï¼Œè€Œéšç€æ¨¡å‹å¤æ‚åº¦çš„æé«˜ï¼Œæ¨¡å‹çš„æ‹Ÿåˆèƒ½åŠ›é€æ¸æé«˜ï¼Œè®­ç»ƒæ•°æ®çš„æ‰°åŠ¨ä¼šé€ æˆæ¨¡å‹å‘ç”Ÿæ˜¾è‘—å˜åŒ–ï¼Œè¿™æ—¶æ–¹å·®é€æ¸ä¸»å¯¼äº†æ³›åŒ–è¯¯å·®ã€‚","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Machine Learning","slug":"Technical-Notes/Machine-Learning","permalink":"http://qfxiao.me/categories/Technical-Notes/Machine-Learning/"}],"tags":[{"name":"Overfitting","slug":"Overfitting","permalink":"http://qfxiao.me/tags/Overfitting/"},{"name":"Bias","slug":"Bias","permalink":"http://qfxiao.me/tags/Bias/"},{"name":"Variance","slug":"Variance","permalink":"http://qfxiao.me/tags/Variance/"}]},{"title":"Decision Tree: Machine Learning Classification Algorithms 3","slug":"Decision-Tree-Machine-Learning-Classification-Algorithms-3","date":"2020-09-02T10:47:55.000Z","updated":"2020-09-10T06:54:21.443Z","comments":true,"path":"2020/09/02/Decision-Tree-Machine-Learning-Classification-Algorithms-3/","link":"","permalink":"http://qfxiao.me/2020/09/02/Decision-Tree-Machine-Learning-Classification-Algorithms-3/","excerpt":"","text":"Introduction ï¼ˆPSï¼šæœ¬æ–‡å†…å®¹æ˜¯å­¦ä¹ é«˜çº§æ ‘æ¨¡å‹ï¼ˆGBDTï¼ŒXGBoostï¼‰çš„åŸºç¡€ï¼Œå¼ºçƒˆå»ºè®®åœ¨çœ‹é‚£äº›å†…å®¹ä¹‹å‰å…ˆäº†è§£æœ¬æ–‡çš„å†…å®¹ï¼ï¼‰ æœ¬æ–‡ä¸»è¦æ˜¯ä»‹ç»å¸¸ç”¨çš„ä¸‰ç§å†³ç­–æ ‘æ¨¡å‹ï¼šID3ã€C4.5å’ŒCARTã€‚å†³ç­–æ ‘ï¼ˆDecision Treeï¼‰æ˜¯ä¸€ç§æœ‰ç›‘ç£åˆ†ç±»æ¨¡å‹ï¼ˆç¨åŠ æ”¹é€ å¯è¿›è¡Œå›å½’ä»»åŠ¡ï¼‰ã€‚ æ¯”å¦‚æˆ‘ä»¬è¦åˆ¤æ–­ä¸€ä¸ªç“œæ˜¯ä¸æ˜¯å¥½ç“œï¼Œå¯¹äºäººæ¥è¯´ï¼Œè¦åˆ¤æ–­ä¸€ä¸ªç“œæ˜¯ä¸æ˜¯å¥½ç“œï¼Œå¯èƒ½ä¼šå…ˆå»çœ‹çœ‹è‰²æ³½ï¼Œç„¶åçœ‹çœ‹æ ¹è’‚ï¼Œç„¶åå†æ•²ä¸€æ•²å¬å¬å£°éŸ³ï¼Œè¿™æ ·ç»è¿‡ä¸€ç³»åˆ—çš„å†³ç­–è¿‡ç¨‹ã€‚ å†³ç­–æ ‘æ­£æ˜¯æ¨¡æ‹Ÿäº†è¿™æ ·çš„è¿‡ç¨‹ã€‚ç»™å®šæ•°æ®é›†ï¼Œå†³ç­–æ ‘ä¼šä¸æ–­åœ°é€‰æ‹©æœ€ä½³çš„ç‰¹å¾å°†æ•°æ®é›†è¿›è¡Œåˆ‡åˆ†ï¼ˆå¦‚é€‰æ‹©è‰²æ³½ï¼Œç„¶åå°†æ•°æ®åˆ†ä¸ºé’ç»¿ã€ä¹Œé»‘ã€æµ…ç™½è¿™å‡ ä¸ªå­é›†ï¼‰ï¼Œç„¶åé€’å½’åœ°è¿›è¡Œä¸‹å»ï¼Œç›´åˆ°è¾¾åˆ°åœæ­¢æ¡ä»¶ï¼š æ¯ä¸ªå¶å­èŠ‚ç‚¹çš„æ ·æœ¬éƒ½å±äºåŒä¸€ä¸ªç±»åˆ« æ²¡æœ‰å¯ä¾›åˆ’åˆ†çš„ç‰¹å¾ï¼Œæˆ–è€…é›†åˆä¸­æ¯ä¸ªæ ·æœ¬æ‰€æœ‰ç‰¹å¾å–å€¼éƒ½ç›¸åŒ å†³ç­–æ ‘è¾¾åˆ°é¢„å…ˆæŒ‡å®šçš„æœ€å¤§æ·±åº¦ æ‰€ä»¥å†³ç­–æ ‘ç®—æ³•è¦è§£å†³çš„å…³é”®é—®é¢˜å°±æ˜¯å¦‚ä½•å»é€‰æ‹©å½“å‰æœ€å¥½çš„åˆ’åˆ†ç‰¹å¾ã€‚ ID3 ID3ç®—æ³•æ ¹æ®ä¿¡æ¯ç†µæ¥è¿›è¡Œç‰¹å¾çš„åˆ’åˆ†ã€‚ä¿¡æ¯ç†µæ˜¯è¡¡é‡ä¸€ä¸ªéšæœºå˜é‡ä¿¡æ¯é‡çš„åº¦é‡ï¼Œå¦‚æœæŠŠæ•°æ®é›†çš„æ ‡ç­¾\\(y\\)çœ‹ä½œæ˜¯éšæœºå˜é‡ï¼Œé‚£ä¹ˆ\\(y\\)çš„ç†µè¶Šå°ä»£è¡¨ä¸ç¡®å®šæ€§è¶Šå°ï¼ˆé›†åˆé‡Œå‡ ä¹éƒ½æ˜¯ä¸€ç§ç±»åˆ«çš„æ ·æœ¬ï¼‰ï¼Œç†µè¶Šå¤§ä»£è¡¨ä¸ç¡®å®šæ€§è¶Šå¤§ï¼ˆé›†åˆåŒ…å«ä¸åŒç±»åˆ«çš„æ ·æœ¬ï¼‰ï¼Œå…¶å…¬å¼ä¸ºï¼š \\[ Ent(D)=-\\sum_{k=1}^{|\\mathcal Y|}p_k\\log p_k \\] \\(Ent(D)\\)ä»£è¡¨é›†åˆ\\(D\\)å¯¹åº”çš„ç†µï¼Œ\\(|\\mathcal Y|\\)æ˜¯ç±»åˆ«æ•°é‡ï¼ŒäºŒåˆ†ç±»å°±æ˜¯\\(|\\mathcal Y|=2\\)ï¼Œ\\(p_k\\)ä¸ºç¬¬\\(k\\)ä¸ªç±»åˆ«å¯¹åº”çš„æ¦‚ç‡ï¼ˆé¢‘ç‡ï¼‰ã€‚å¾ˆè‡ªç„¶çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®åˆ’åˆ†å‰åç†µçš„å˜åŒ–æ¥ç¡®å®šåˆ’åˆ†ç‰¹å¾çš„é€‰æ‹©ï¼Œå¦‚æœåˆ’åˆ†ä¹‹åç†µå‡å°çš„æœ€å¤šï¼Œé‚£ä¹ˆè¿™ä¸ªç‰¹å¾ä¹Ÿæ˜¯æœ€å¥½çš„ã€‚å‡è®¾æˆ‘ä»¬é€‰å®šç‰¹å¾\\(a\\)æ¥å¯¹é›†åˆè¿›è¡Œåˆ’åˆ†ï¼Œç‰¹å¾\\(a\\)å…±æœ‰\\(V\\)ä¸ªç¦»æ•£å–å€¼ï¼Œé‚£ä¹ˆåˆ’åˆ†ä¹‹åå°†ä¼šäº§ç”Ÿ\\(V\\)ä¸ªå­é›†ï¼Œæˆ‘ä»¬è®°æ¯ä¸ªå­é›†ä¸º\\(D^v, v=1,\\cdots, V\\)ã€‚é‚£ä¹ˆï¼Œä¿¡æ¯å¢ç›Šå¯ä»¥å†™ä¸ºï¼š \\[ Gain(D,a)=Ent(D)-\\sum_{v=1}^V \\frac{|D^v|}{|D|}Ent(D^v) \\] ä¸è¿‡ï¼ŒID3å­˜åœ¨ä¸¤ä¸ªè‡´å‘½çš„ç¼ºç‚¹ï¼š æ— æ³•å¯¹è¿ç»­å–å€¼çš„ç‰¹å¾è¿›è¡Œè®¡ç®— å¯¹å–å€¼è¾ƒå¤šçš„ç‰¹å¾å…·æœ‰å¾ˆå¤§çš„åå‘æ€§ï¼ˆæç«¯çš„æƒ…å†µï¼ŒæŠŠæ ·æœ¬ç¼–å·ä½œä¸ºç‰¹å¾ï¼Œç”±äºæ¯ä¸ªæ ·æœ¬çš„ç¼–å·éƒ½ä¸åŒï¼Œåˆ†è£‚ä¹‹åæ¯ä¸ªè‡ªå·±åªæœ‰ä¸€ä¸ªæ ·æœ¬/ç±»åˆ«ï¼Œç†µæ˜¯æœ€å°çš„ï¼‰ C4.5 C4.5ç®—æ³•åœ¨ID3çš„åŸºç¡€ä¸Šåšäº†è¯¸å¤šæ”¹è¿›ã€‚C4.5è§£å†³äº†ID3å¯¹äºå–å€¼æ•°ç›®è¾ƒå¤šçš„ç‰¹å¾çš„åå‘æ€§é—®é¢˜ï¼Œå…¶é‡‡ç”¨çš„æ–¹æ¡ˆå¾ˆç›´è§‚ï¼Œå³å¯¹ä¿¡æ¯å¢ç›Šé™¤ä»¥ä¸€ä¸ªç³»æ•°ï¼Œç‰¹å¾å–å€¼æ•°ç›®è¶Šå¤šçš„ç‰¹å¾ç³»æ•°è¶Šå¤§ï¼Œè¯¥åˆ’åˆ†æ ‡å‡†è¢«ç§°ä½œæ˜¯ä¿¡æ¯å¢ç›Šç‡ï¼š \\[ Gain\\_ratio(D,a)=\\frac{Gain(D,a)}{IV(a)} \\] å…¶ä¸­\\(IV(a)=-\\sum_{v=1}^V\\frac{|D^v|}{|D|}\\log \\frac{|D^v|}{|D|}\\)ã€‚å…¶å®\\(IV(a)\\)å¯ä»¥çœ‹ä½œæ˜¯â€œåˆ’åˆ†ä¹‹åæ¯ä¸ªæ ·æœ¬å±äºé›†åˆ\\(v\\)çš„æ¦‚ç‡â€è¿™ä¸ªéšæœºå˜é‡çš„ç†µï¼Œåˆ’åˆ†çš„å­é›†è¶Šå¤šï¼Œåˆ’åˆ†ä¹‹åå±äºå“ªä¸ªé›†åˆå°±è¶Šä¸ç¡®å®šï¼Œæ‰€ä»¥ç†µå°±è¶Šå¤§ã€‚ ä¸è¿‡ä¿¡æ¯å¢ç›Šç‡åè€Œä¼šå¯¹ç‰¹å¾å–å€¼æ•°ç›®å°‘çš„ç‰¹å¾æœ‰æ‰€åå¥½ï¼Œæ‰€ä»¥C4.5ç®—æ³•æ˜¯å…ˆè®¡ç®—ä¿¡æ¯å¢ç›Šï¼Œç¡®å®šä¿¡æ¯å¢ç›Šé«˜äºå¹³å‡å€¼çš„å€™é€‰é›†ï¼Œå†ä»ä¸­é€‰æ‹©ä¿¡æ¯å¢ç›Šç‡æœ€é«˜çš„ç‰¹å¾ã€‚ é™¤æ­¤ä¹‹å¤–ï¼ŒC4.5è¿˜èƒ½å¤„ç†è¿ç»­å–å€¼çš„ç‰¹å¾ï¼Œå…¶åšæ³•æ˜¯â€œç¦»æ•£åŒ–â€ï¼Œå³å°†è¿ç»­å–å€¼åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªç¦»æ•£çš„åŒºé—´ï¼Œä¸€èˆ¬äºŒåˆ†æ¯”è¾ƒå¸¸ç”¨ã€‚è®¾è¿ç»­ç‰¹å¾\\(a\\)ï¼Œå‡è®¾å…¶å‡ºç°äº†\\(n\\)ä¸ªå–å€¼ï¼Œå°†å…¶æ’åºå¾—åˆ°\\(\\{a^1,a^2,\\cdots,a^n\\}\\)ï¼Œæˆ‘ä»¬è€ƒè™‘æ¯ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹çš„ä¸­ç‚¹é›†åˆ\\(T_a=\\{\\frac{a^i+a^{i+1}}{2}|1\\leq i \\leq n-1\\}\\)ï¼Œä¹‹åæˆ‘ä»¬å°±å¯ä»¥åƒè€ƒå¯Ÿç¦»æ•£å±æ€§å€¼ä¸€æ ·é€‰æ‹©æœ€ä¼˜åˆ’åˆ†ã€‚ ä¸‹å›¾æ˜¯åœ¨breast canceræ•°æ®ä¸Šå†³ç­–æ ‘çš„å¯è§†åŒ–ï¼ˆå›¾ç‰‡å¤ªå¤§äº†ï¼Œå¯ä»¥ç‚¹å¼€æ”¾å¤§ğŸ”çœ‹ï¼‰ï¼š CART CART (Classification and Regression Trees) æ˜¯ä¸€ç§åº”ç”¨å¹¿æ³›çš„å†³ç­–æ ‘æ¨¡å‹ï¼Œæ—¢å¯åº”ç”¨äºåˆ†ç±»ä»»åŠ¡ä¹Ÿå¯åº”ç”¨äºå›å½’ä»»åŠ¡ã€‚ CART Regression æˆ‘ä»¬å…ˆæ¥è¯´è¯´CARTæ€ä¹ˆè¿›è¡Œå›å½’ã€‚åœ¨å›å½’é—®é¢˜ä¸­ï¼ŒCARTä½¿ç”¨äº†MSEä½œä¸ºåˆ’åˆ†å‡†åˆ™ï¼š \\[ \\frac{1}{N}\\sum_{i=1}^N (f(x_i)-y_i)^2 \\] å¦‚æœCARTæœ‰\\(M\\)ç‰‡å¶å­ï¼Œé‚£ä¹ˆç›¸å½“äºCARTå°†è¾“å…¥åˆ’åˆ†æˆäº†\\(M\\)ä¸ªå•å…ƒ\\(R_m, m=1,\\cdots,M\\)ï¼Œä¹Ÿå³æœ‰\\(M\\)ä¸ªè¾“å‡ºï¼Œé‚£ä¹ˆè¯¥CARTåœ¨æ•°æ®é›†ä¸Šçš„MSEä¸ºï¼š \\[ \\frac{1}{N}\\sum_{m=1}^M\\sum_{x_i\\in R_m} (c_m-y_i)^2 \\] è¿™é‡Œ\\(c_j\\)ä¸ºå¶å­èŠ‚ç‚¹\\(j\\)çš„è¾“å‡ºï¼Œä¸€èˆ¬é€‰ä¸ºå¯¹åº”æ ·æœ¬çš„å‡å€¼\\(c_m=\\text{avg}(y_i|x_i\\in R_m)\\)ã€‚è¿™æ ·ï¼Œå‰©ä¸‹çš„é—®é¢˜å°±æ˜¯å¦‚ä½•ç¡®å®šæ¯æ¬¡çš„åˆ‡åˆ†ç‰¹å¾å’Œåˆ‡åˆ†ç‚¹äº†ã€‚å‡è®¾é€‰æ‹©çš„ç‰¹å¾æ˜¯\\(j\\)ï¼Œåˆ‡åˆ†ç‚¹\\(s\\)ï¼Œé‚£ä¹ˆè¯¥åˆ’åˆ†æ–¹æ¡ˆå¯¹åº”çš„æŸå¤±ä¸ºï¼š \\[ \\min_{c_1}\\sum_{x_i\\in R_1\\{j,s\\}}(y_i-c_1)^2+\\min_{c_2}\\sum_{x_i\\in R_2\\{j,s\\}}(y_i-c_2)^2 \\] éå†æ‰€æœ‰çš„\\(j\\)å’Œ\\(s\\)ï¼Œæˆ‘ä»¬å°±èƒ½æ‰¾åˆ°æœ€ä½³çš„ç‰¹å¾å’Œåˆ‡åˆ†ç‚¹ï¼š \\[ \\min_{j,s}\\left[\\min_{c_1}\\sum_{x_i\\in R_1\\{j,s\\}}(y_i-c_1)^2+\\min_{c_2}\\sum_{x_i\\in R_2\\{j,s\\}}(y_i-c_2)^2\\right] \\] ç®—æ³•æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š CART Decision Tree Algorithm INPUT: æ•°æ®é›† \\(D=\\{(x_1,y_1),\\cdots,(x_N,y_N)\\}\\) OUTPUT: é¢„æµ‹å€¼\\(\\{\\hat y_1,\\cdots,\\hat y_N\\}\\) PROCEDURE: 1. é€‰å–å½“å‰æœ€ä¼˜åˆ‡åˆ†ç‰¹å¾å˜é‡\\(j^*\\)ä¸æœ€ä¼˜åˆ‡åˆ†ç‚¹\\(s^*\\) è®¾å½“å‰é€‰æ‹©çš„åˆ‡åˆ†å˜é‡ä¸º\\(j\\)ï¼Œåˆ‡åˆ†ç‚¹ä¸º\\(s\\)é‚£ä¹ˆå¯ä»¥æ ¹æ®åˆ‡åˆ†ç‚¹å°†æ•°æ®é›†åˆ†ä¸ºä¸¤ä¸ªå­é›†ï¼Œä¸€ä¸ªæ˜¯\\(R_1(j,s)=\\left\\{x|x^{(j)}\\leq s\\right\\}\\)ï¼Œå¦ä¸€ä¸ªæ˜¯\\(R_2(j,s)=\\left\\{x|x^{(j)}&gt; s\\right\\}\\)ã€‚ éå†æ‰€æœ‰çš„\\(j\\)ï¼Œæ±‚è§£ \\[ \\min_{j,s}\\left[\\min_{c_1}\\sum\\limits_{x_i\\in R_1(j,s)}(y_i-c_1)^2+\\min\\limits_{c_2}\\sum\\limits_{x_i\\in R_2(j,s)}(y_i-c_2)^2\\right] \\] æ³¨æ„\\(\\hat c_1=\\frac{1}{N_1}\\sum\\limits_{x_i\\in R_1(j,s)}y_i\\) 2. ç”¨é€‰å®šçš„\\((j^*,s^*)\\)æ¥åˆ’åˆ†åŒºåŸŸå¹¶è®¡ç®—è¾“å‡ºå€¼ æ­¤æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¡®å®šè¿™ä¸¤ä¸ªåŒºåŸŸï¼ˆåˆ’åˆ†åˆ°åŒä¸€ä¸ªåŒºåŸŸçš„æ ·æœ¬å¯¹åº”çš„è¾“å‡ºæ˜¯ç›¸åŒçš„ï¼‰çš„è¾“å‡ºå€¼\\(c_1\\)å’Œ\\(c_2\\)ï¼Œå…¶ç¡®å®šæ–¹å¼æ˜¯ä½¿å¾—å¯¹åº”åŒºåŸŸä¸Šçš„å‡æ–¹è¯¯å·®æœ€å°ã€‚è¿™æ ·æˆ‘ä»¬ç›¸å½“äºå¾—åˆ°äº†ç»™å®š\\(j,s\\)ä¸‹çš„æŸå¤±ï¼Œæ‰€ä»¥åªè¦æ‰¾å‡ºä½¿å¾—æŸå¤±æœ€å°çš„\\(j^*,s^*\\)å³å¯ï¼š 3. é€’å½’åœ°å¯¹åˆ’åˆ†å‡ºæ¥çš„ä¸¤ä¸ªåŒºåŸŸé‡å¤æ­¥éª¤1å’Œæ­¥éª¤2ï¼Œç›´åˆ°æ»¡è¶³åœæ­¢æ¡ä»¶ 4. æœ€åå°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸º\\(M\\)ï¼Œè¾“å‡º\\(f(x)=\\sum_{m=1}^M \\hat c_m I(x\\in R_m)\\) ä¸‹å›¾æ˜¯åœ¨æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®ä¸Šå†³ç­–æ ‘çš„å¯è§†åŒ–ï¼ˆå›¾ç‰‡å¤ªå¤§äº†ï¼Œå¯ä»¥ç‚¹å¼€æ”¾å¤§ğŸ”çœ‹ï¼‰ï¼š CART Classification ä»å‰é¢çš„è®¨è®ºå¯ä»¥çœ‹åˆ°ï¼ŒCARTå›å½’æ ‘æ˜¯ä¸€æ£µäºŒå‰æ ‘ï¼Œå¯¹äºåˆ†ç±»ä»»åŠ¡ï¼ŒCARTä¹Ÿæ˜¯ä¸€æ£µäºŒå‰æ ‘ã€‚æˆ‘ä»¬å…ˆæ¥ä»‹ç»CARTçš„åˆ’åˆ†å‡†åˆ™ï¼Œå†æ¥ä»‹ç»å®ƒæ˜¯æ€ä¹ˆè¿›è¡Œåˆ’åˆ†çš„ã€‚ é‡‡ç”¨åŸºå°¼ç³»æ•°ä½œä¸ºå‡†åˆ™ï¼ŒåŸºå°¼ç³»æ•°çš„è®¡ç®—ä¾èµ–äºåŸºå°¼å€¼ï¼š \\[ \\begin{align} Gini(D)&amp;=1-\\sum_{k=1}^{|\\mathcal Y|}p_k^2 \\end{align} \\] ç›´è§‚ä¸Šæ¥è¯´ï¼ŒåŸºå°¼å€¼è¡¨ç¤ºéšæœºæŠ½å–ä¸¤ä¸ªæ ·æœ¬ï¼Œå…¶ç±»åˆ«ä¸ä¸€è‡´çš„æ¦‚ç‡ å¦‚æœè¯´ä¸€ä¸ªç‰¹å¾è¶Šå¥½ï¼Œé‚£ä¹ˆåˆ’åˆ†ä¹‹åå…¶æ¯ä¸ªå­é›†å¯¹åº”çš„åŸºå°¼å€¼åº”è¯¥è¶Šå°è¶Šå¥½ã€‚åŸºå°¼ç³»æ•°çš„å®šä¹‰ä¸ºï¼š \\[ Gini\\_index(D,a)=\\sum_{v=1}^V \\frac{|D^v|}{|D|}Gini(D^v) \\] å¯¹äºç¦»æ•£å–å€¼ç‰¹å¾ï¼ŒCARTä¸ä¼šæ ¹æ®ä¸åŒå–å€¼ä¸ªæ•°è¿›è¡Œåˆ’åˆ†ï¼Œè€Œæ˜¯å’Œè¿ç»­å€¼ç±»ä¼¼ï¼Œä¼šç¡®å®šä¸€ä¸ªâ€œåˆ’åˆ†ç‚¹â€ï¼Œå°†æ ·æœ¬è¿›è¡ŒäºŒåˆ†ã€‚æ¯”å¦‚å¯¹äºç‰¹å¾\\(a\\)ï¼Œå…¶å¯¹åº”å–å€¼ä¸º\\(\\{a^1,a^2,\\cdots,a^n\\}\\)ï¼ŒCARTä¼šè€ƒå¯Ÿæ¯ä¸ªå–å€¼ï¼Œå°†æ ·æœ¬é›†åˆ’åˆ†ä¸ºç‰¹å¾\\(a\\)æ˜¯ä¸æ˜¯ç­‰äº\\(a^i\\)ä¸¤éƒ¨åˆ†ï¼Œç„¶åè®¡ç®—åŸºå°¼ç³»æ•°ï¼Œæœ€ç»ˆä¼šé‡‡ç”¨åŸºå°¼ç³»æ•°æœ€å°çš„å–å€¼ä½œä¸ºåˆ’åˆ†ç‚¹ã€‚ ä¸‹å›¾æ˜¯åœ¨breast canceræ•°æ®ä¸Šå†³ç­–æ ‘çš„å¯è§†åŒ–ï¼ˆå›¾ç‰‡å¤ªå¤§äº†ï¼Œå¯ä»¥ç‚¹å¼€æ”¾å¤§ğŸ”çœ‹ï¼‰ï¼š","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Machine Learning","slug":"Technical-Notes/Machine-Learning","permalink":"http://qfxiao.me/categories/Technical-Notes/Machine-Learning/"}],"tags":[{"name":"ID3","slug":"ID3","permalink":"http://qfxiao.me/tags/ID3/"},{"name":"C4.5","slug":"C4-5","permalink":"http://qfxiao.me/tags/C4-5/"},{"name":"CART","slug":"CART","permalink":"http://qfxiao.me/tags/CART/"}]},{"title":"Support Vector Machine: Machine Learning Classification Algorithms 2","slug":"Support-Vector-Machine-Machine-Learning-Classification-Algorithms-2","date":"2020-08-25T18:09:24.000Z","updated":"2020-09-20T04:30:52.800Z","comments":true,"path":"2020/08/26/Support-Vector-Machine-Machine-Learning-Classification-Algorithms-2/","link":"","permalink":"http://qfxiao.me/2020/08/26/Support-Vector-Machine-Machine-Learning-Classification-Algorithms-2/","excerpt":"","text":"Introduction Still working on itğŸ˜…... blog Hyperplane è¶…å¹³é¢å¯ä»¥ä»ä»£æ•°å’Œå‡ ä½•ä¸¤æ–¹é¢æ¥ç†è§£ã€‚è¶…å¹³é¢çš„ä»£æ•°å®šä¹‰å¯ä»¥çœ‹ä½œæ˜¯æ–¹ç¨‹ï¼š \\[ a_1x_1+\\cdots+a_nx_n=d \\] çš„æ‰€æœ‰è§£å½¢æˆçš„é›†åˆï¼Œå…¶ä¸­\\(a_1,\\cdots,a_n\\)ä¸ºä¸å…¨ä¸º\\(0\\)çš„å®æ•°ï¼Œ\\(d\\)ä¹Ÿæ˜¯å®æ•°ã€‚ ä»å‡ ä½•ä¸Šæ¥è¯´ï¼Œè¶…å¹³é¢å¯ä»¥çœ‹ä½œæ˜¯é™¤ç©ºé—´\\(R^n\\)è‡ªèº«å¤–ç»´åº¦æœ€å¤§çš„ä»¿å°„ç©ºé—´ã€‚ Maximum Margin Classifier è¦è°ˆSVMå°±å¾—å…ˆè°ˆçº¿æ€§åˆ†ç±»å™¨ï¼Œå…¶è®¾ç½®æ˜¯è¿™æ ·çš„ã€‚å¯¹äº\\(D\\)ç»´ç©ºé—´ï¼Œæˆ‘ä»¬æœ‰ä¸€å †æ•°æ®\\(X\\)ï¼Œè¿›è¡ŒäºŒåˆ†ç±»ä»»åŠ¡ï¼Œæ ‡ç­¾è®°ä¸º\\(y\\)ï¼Œå…¶ä¸­\\(y=-1\\)å’Œ\\(y=1\\)åˆ†åˆ«ä»£è¡¨ä¸åŒçš„ç±»åˆ«ã€‚æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªè¶…å¹³é¢ï¼Œå°†æ­£è´Ÿä¾‹åˆ‡åˆ†å¼€æ¥ï¼ˆå…ˆå‡è®¾æ•°æ®æ˜¯çº¿æ€§å¯åˆ†çš„ï¼‰ï¼Œè¿™ä¸ªè¶…å¹³é¢çš„æ–¹ç¨‹å¯ä»¥è¡¨ç¤ºä¸ºï¼š \\[ w^\\top x+b=0 \\] æˆ‘ä»¬ä»¤\\(f(x)=w^\\top x+b\\)ï¼Œå¯¹äº\\(f(x)&lt;0\\)çš„æ ·æœ¬ï¼Œæˆ‘ä»¬èµ‹äºˆå…¶ç±»åˆ«\\(-1\\)ï¼Œå¯¹äº\\(f(x)&gt;0\\)çš„æ ·æœ¬ï¼Œæˆ‘ä»¬å¯ä»¥èµ‹äºˆå…¶ç±»åˆ«\\(1\\)ã€‚å¯¹äºç›¸åŒçš„åˆ†ç±»ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾å‡ºæ— é™ç§è¶…å¹³é¢ã€‚ä¸è¿‡ï¼Œå¯¹äºé‚£äº›æ ·æœ¬ç‰¹åˆ«é è¿‘è¶…å¹³é¢çš„æƒ…å†µï¼Œé²æ£’æ€§å¹¶ä¸å¥½ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºè¿™æ—¶åªè¦è¶…å¹³é¢æœ‰è½»å¾®çš„å˜åŒ–ï¼Œæ ·æœ¬çš„åˆ†ç±»ç»“æœå°±ä¼šå‘ç”Ÿå˜åŒ–ã€‚ç›´è§‚ä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›æ ·æœ¬åˆ°è¶…å¹³é¢çš„è·ç¦»è¶Šå¤§è¶Šå¥½ã€‚ æˆ‘ä»¬å…ˆå®šä¹‰å‡½æ•°é—´éš”çš„æ¦‚å¿µï¼Œå‡½æ•°é—´éš”\\(\\hat \\gamma=y(w^\\top x+b)\\)ï¼Œä¹˜ä»¥\\(y\\)çš„ç›®çš„ä¸»è¦æ˜¯ä¿æŒéè´Ÿæ€§ï¼Œè¡¨ç¤ºèµ·æ¥æ–¹ä¾¿ã€‚å¯è§å‡½æ•°é—´éš”çš„å¤§å°å¹¶ä¸èƒ½è¡¨ç¤ºæ ·æœ¬è·ç¦»ï¼Œå› ä¸ºåŒä¸€ä¸ªè¶…å¹³é¢ï¼Œæ³•å‘é‡\\(w\\)å¯ä»¥ä»»æ„å¢å¤§ï¼Œå‡½æ•°é—´éš”ä¹Ÿä¼šç›¸åº”å¢å¤§ã€‚ ä¸‹é¢æ¥æ¨å¯¼ç‚¹\\(x\\)åˆ°è¶…å¹³é¢çš„è·ç¦»ã€‚è®¾\\(x\\)åœ¨è¶…å¹³é¢ä¸Šçš„æŠ•å½±ä¸º\\(x_0\\)ï¼Œåˆ°è¶…å¹³é¢çš„è·ç¦»ä¸º\\(\\gamma\\)ï¼Œ\\(w\\)ä¸ºæ³•å‘é‡ï¼Œé‚£ä¹ˆæœ‰ï¼š \\[ x=x_0+\\gamma\\frac{w}{\\parallel w\\parallel} \\] å°†ä¸Šå¼å¸¦å…¥åˆ°è¶…å¹³é¢æ–¹ç¨‹å¯ä»¥å¾—åˆ° \\[ \\gamma=\\frac{w^\\top}{\\parallel w\\parallel}x+\\frac{b}{\\parallel w\\parallel} \\] æˆ‘ä»¬ç§°\\(\\gamma\\)ä¸ºå‡ ä½•é—´éš”ã€‚ å¯ä»¥å¾ˆå®¹æ˜“çœ‹å‡ºå‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”çš„å…³ç³»ï¼š \\[ \\gamma = \\frac{\\hat \\gamma}{\\parallel w\\parallel} \\] å‰é¢æåˆ°æˆ‘ä»¬å¸Œæœ›å‡ ä½•é—´éš”è¶Šå¤§è¶Šå¥½ï¼Œäºæ˜¯å¯ä»¥ç›´æ¥æœ€å¤§åŒ–\\(\\gamma\\)ï¼Œå¾—åˆ°ï¼š \\[ \\begin{align} \\max \\space &amp;\\gamma\\\\ s.t. \\space &amp; y_i(w^\\top x_i+b)=\\hat\\gamma_i\\geq\\hat\\gamma, \\space i=1,\\cdots,n \\end{align} \\] è¿™é‡Œ\\(\\hat \\gamma=\\gamma \\parallel w\\parallel\\)ï¼Œæ ¹æ®å‰é¢çš„åˆ†ææˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºåŒä¸€ä¸ªè¶…å¹³é¢ï¼Œå‡½æ•°é—´éš”\\(\\hat\\gamma\\)å¯ä»¥éšç€\\(\\parallel w\\parallel\\)çš„å˜åŒ–è€Œå˜åŒ–ï¼Œæ‰€ä»¥ä¸ºäº†æ‰¾åˆ°æœ€ä¼˜çš„\\(\\gamma\\)ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å›ºå®š\\(\\parallel w\\parallel\\)æˆ–è€…\\(\\hat\\gamma\\)ï¼Œè¿™é‡Œæˆ‘ä»¬å›ºå®š\\(\\hat \\gamma=1\\)ï¼Œæ‰€ä»¥æœ‰ï¼š \\[ \\begin{align} \\max &amp; \\space \\frac{1}{\\parallel w\\parallel},\\\\ s.t. \\space&amp; y_i(w^\\top x_i+b)\\geq 1, \\space i=1,\\cdots,n \\end{align} \\] ä¸‹é¢çš„çº¦æŸæ¡ä»¶ä»£è¡¨å‰ææ˜¯æ‰€æœ‰æ ·æœ¬åˆ†ç±»æ­£ç¡®ï¼Œè€Œ\\(\\max\\frac{1}{\\parallel w\\parallel}\\)ä»£è¡¨æœ€å¤§åŒ–é—´éš”ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å°†å…¶åŒ–ä¸ºç­‰ä»·çš„æœ€å°åŒ–å½¢å¼ï¼š \\[ \\begin{align} \\min &amp; \\space \\frac{1}{2}\\parallel w\\parallel^2,\\\\ s.t. &amp; y_i(w^\\top x_i+b)\\geq 1, \\space i=1,\\cdots,n \\end{align} \\] å…¶ä¸­é‚£äº›\\(y_i(w^\\top x_i+b)=1\\)çš„æ ·æœ¬å°±æ˜¯â€œæ”¯æŒå‘é‡â€ã€‚è¿™ä¸ªä¼˜åŒ–é—®é¢˜æ˜¯å…¸å‹çš„äºŒæ¬¡å‡¸ä¼˜åŒ–é—®é¢˜ï¼Œå¯ä»¥è°ƒç”¨ç°æˆçš„ç®—æ³•å»è§£å†³ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•æ¥æ›´é«˜æ•ˆçš„è§£å†³ã€‚ Dual Problem æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•å¯ä»¥å°†æœ‰\\(d\\)ä¸ªå˜é‡å’Œ\\(k\\)ä¸ªçº¦æŸæ¡ä»¶çš„æœ€ä¼˜åŒ–é—®é¢˜è½¬åŒ–æˆæœ‰\\(d+k\\)ä¸ªå˜é‡çš„æ— çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜æ±‚è§£ã€‚ Lagrange Multiplier å¯¹äºä»¥ä¸‹æœ‰çº¦æŸä¼˜åŒ–é—®é¢˜ï¼š \\[ \\begin{align} \\min_x \\space &amp; f(x)\\\\ \\text{s.t.} \\space &amp; h_i(x)=0 \\space (i=1,\\cdots,m),\\\\ &amp;g_j(x) \\leq 0 \\space (j=1,\\cdots,n) \\end{align} \\] å¼•å…¥æ‹‰æ ¼æœ—æ—¥ä¹˜å­\\(\\boldsymbol\\lambda = (\\lambda_1,\\lambda_2,\\cdots,\\lambda_n)^\\top\\)å’Œ\\(\\boldsymbol\\mu=(\\mu_1,\\mu_2,\\cdots,\\mu_m)^\\top\\)ï¼Œç›¸åº”çš„å¹¿ä¹‰æ‹‰æ ¼æœ—æ—¥å‡½æ•° (generalized Lagrange function) ä¸ºï¼š \\[ L(\\boldsymbol x,\\boldsymbol\\lambda,\\boldsymbol\\mu)=f(\\boldsymbol x)+\\sum_{j=1}^n \\lambda_j g_j(\\boldsymbol x)+\\sum_{i=1}^m \\mu_i h_i(\\boldsymbol x) \\] å…¶ä¸­\\(\\lambda_j\\)ï¼Œ\\(\\mu_i\\)è¢«ç§°ä½œæ˜¯æ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼Œ\\(\\lambda_j \\geq 0\\)ã€‚ Primal Problem ç°åœ¨æˆ‘ä»¬æ¥è®¨è®ºåŸé—®é¢˜çš„ç­‰ä»·æ€§ã€‚å‡è®¾ç»™å®šæŸä¸ª\\(x\\)ï¼Œå¦‚æœ\\(x\\)è¿åçº¦æŸæ¡ä»¶ï¼Œå³å­˜åœ¨æŸä¸ª\\(x\\)ä½¿å¾—\\(h_i(x)\\neq 0\\)æˆ–è€…\\(g_j(x)&gt;0\\)ï¼Œé‚£ä¹ˆå°±æœ‰ï¼š \\[ \\max\\limits_{\\boldsymbol\\lambda,\\boldsymbol\\mu:\\lambda_j\\geq 0} L(\\boldsymbol x,\\boldsymbol\\lambda,\\boldsymbol\\mu)=+\\infty \\] å¦‚æœå­˜åœ¨æŸä¸ª\\(x\\)ä½¿å¾—\\(h_i(x)\\neq 0\\)ï¼Œé‚£ä¹ˆå¯ä»¥ä»¤\\(\\lambda_j \\rightarrow +\\infty\\)ï¼Œå¦‚æœå­˜åœ¨\\(g_j(x)&gt;0\\)ï¼Œé‚£ä¹ˆå¯ä»¤\\(\\mu_ih_i(x)\\rightarrow +\\infty\\)ã€‚ å¦‚æœè€ƒè™‘ä»¥ä¸‹æå°åŒ–é—®é¢˜ï¼š \\[ p^*=\\min_x\\max\\limits_{\\boldsymbol\\lambda,\\boldsymbol\\mu:\\lambda_j\\geq 0} L(\\boldsymbol x,\\boldsymbol\\lambda,\\boldsymbol\\mu) \\] ä»–ä¸åŸå§‹å¸¦çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜æ˜¯ç­‰ä»·çš„ï¼ˆå› ä¸ºä¸ç¬¦åˆçº¦æŸæ—¶ä¼šæœ‰\\(+\\infty\\)ï¼Œè€Œæˆ‘ä»¬è€ƒè™‘çš„æ˜¯æå°åŒ–é—®é¢˜ï¼‰ï¼Œæˆ‘ä»¬å°†å…¶è®°ä¸ºåŸé—®é¢˜ (Primal problem)ã€‚ Dual Problem å¦‚æœå…ˆè€ƒè™‘æœ€å°åŒ–\\(x\\)ï¼Œå†è€ƒè™‘æœ€å¤§åŒ–\\(\\boldsymbol\\lambda\\)å’Œ\\(\\boldsymbol\\mu\\)ï¼Œè¿™æ—¶æœ‰ï¼š \\[ \\max\\limits_{\\boldsymbol\\lambda,\\boldsymbol\\mu:\\lambda_j\\geq 0}\\min_x L(\\boldsymbol x,\\boldsymbol\\lambda,\\boldsymbol\\mu) \\] å¯¹å¶é—®é¢˜ (Dual problem) \\[ d^*=\\max\\limits_{\\boldsymbol\\lambda,\\boldsymbol\\mu:\\lambda_j\\geq 0}\\min_x L(\\boldsymbol x,\\boldsymbol\\lambda,\\boldsymbol\\mu) \\] åŸé—®é¢˜å’Œå¯¹å¶é—®é¢˜çš„å…³ç³» \\[ d^*=\\max\\limits_{\\boldsymbol\\lambda,\\boldsymbol\\mu:\\lambda_j\\geq 0}\\min_x L(\\boldsymbol x,\\boldsymbol\\lambda,\\boldsymbol\\mu) \\leq \\min_x\\max\\limits_{\\boldsymbol\\lambda,\\boldsymbol\\mu:\\lambda_j\\geq 0} L(\\boldsymbol x,\\boldsymbol\\lambda,\\boldsymbol\\mu) = p^* \\] KKT Condition å¯¹äºåŸé—®é¢˜å’Œå¯¹å¶é—®é¢˜ï¼Œè®¾\\(f(x)\\)å’Œ\\(g_i(x)\\)ä¸ºå‡¸å‡½æ•°ï¼Œ\\(h_i(x)\\)ä¸ºä»¿å°„å‡½æ•°ï¼Œå¹¶ä¸”ä¸ç­‰å¼çº¦æŸ\\(c_i(x)\\)æ˜¯ä¸¥æ ¼å¯è¡Œçš„ï¼Œåˆ™\\(x^*\\)ï¼Œ\\(\\lambda^*\\)ï¼Œ\\(\\mu^*\\)åˆ†åˆ«æ˜¯åŸé—®é¢˜å’Œå¯¹å¶é—®é¢˜çš„è§£çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯æ»¡è¶³ä¸‹é¢çš„Karush-Kuhn-Tucker (KKT) æ¡ä»¶ï¼š \\[ \\begin{cases} \\nabla_x L(x^*,\\lambda^*,\\mu^*)=0 &amp;\\\\ \\lambda^*_j g_j(x^*)=0 &amp; j=1,\\cdots n\\\\ g_j(x^*)\\leq 0 &amp; j=1,\\cdots n\\\\ \\lambda_j^*\\geq 0 &amp; j=1,\\cdots n\\\\ h_i(x^*) = 0 &amp; i = 1, \\cdots m \\end{cases} \\] è¿™å‘Šè¯‰æˆ‘ä»¬ Dual Form of SVM Optimization æ”¯æŒå‘é‡æœºä¼˜åŒ–çš„å¯¹å¶é—®é¢˜å¯ä»¥å†™ä¸ºï¼š \\[ L(w,b,\\alpha)=\\frac{1}{2}\\parallel w\\parallel^2-\\sum_{i=1}^n \\alpha_i(y_i(w^\\top x_i+b)-1) \\] æˆ‘ä»¬å…ˆä»¤ï¼š \\[ \\begin{align} \\frac{\\partial L}{\\partial w}=0&amp;\\Rightarrow w=\\sum_{i=1}^n\\alpha_i y_i x_i\\\\ \\frac{\\partial L}{\\partial b}=0&amp;\\Rightarrow \\sum_{i=1}^n\\alpha_i y_i =0 \\end{align} \\] å¸¦å›åˆ°\\(L\\)å¾—åˆ°ï¼š \\[ \\begin{align} L(w,b,\\alpha)&amp;=\\frac{1}{2}\\sum_{i,j=1}^n\\alpha_i\\alpha_j y_i y_j x^\\top_i x_j-\\sum_{i,j=1}^n \\alpha_i\\alpha_jy_iy_jx^\\top_ix_j-b\\sum_{i=1}^n\\alpha_iy_i+\\sum_{i=1}^n\\alpha_i\\\\ &amp;=\\sum_{i=1}^n \\alpha_i - \\frac{1}{2}\\sum_{i,j=1}^n \\alpha_i\\alpha_j y_i y_j x^\\top_i x_j \\end{align} \\] äºæ˜¯å¾—åˆ°å…³äº\\(\\alpha\\)çš„å¯¹å¶ä¼˜åŒ–é—®é¢˜ï¼š \\[ \\begin{align} \\max_\\alpha &amp;\\sum_{i=1}^n \\alpha_i - \\frac{1}{2}\\sum_{i,j=1}^n \\alpha_i\\alpha_j y_i y_j x^\\top_i x_j\\\\ \\text{s.t. }&amp; \\alpha_i\\geq 0, i=1,\\cdots,n\\\\ &amp; \\sum_{i=1}^n \\alpha_i y_i = 0 \\end{align} \\] å‰é¢æœ‰æåˆ°æˆ‘ä»¬æ ¹æ®\\(f(x)=w^\\top x + b\\)çš„è¾“å‡ºæ¥åˆ¤å®šæ ·æœ¬ç±»åˆ«ï¼Œè€Œåˆšæ‰å¾—åˆ°\\(w=\\sum_{i=1}^n\\alpha_i y_i x_i\\)ï¼Œäºæ˜¯ï¼š \\[ \\begin{align} f(x) &amp;= (\\sum_{i=1}^n \\alpha_iy_ix_i)^\\top x+b\\\\ &amp;= \\sum_{i=1}^n \\alpha_i y_i \\langle x_i, x\\rangle + b \\end{align} \\] æœ€åçš„\\(\\sum_{i=1}^n \\alpha_i y_i \\langle x_i, x\\rangle + b\\)å€¼å¾—ç‰¹åˆ«æ³¨æ„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯¹äºæµ‹è¯•æ ·æœ¬\\(x\\)çš„é¢„æµ‹ï¼Œåªéœ€è¦è®¡ç®—å®ƒä¸è®­ç»ƒé›†çš„å†…ç§¯å³å¯ï¼ŒåŒæ—¶ç”±äºæ‰€æœ‰éæ”¯æŒå‘é‡å¯¹åº”çš„\\(\\alpha\\)éƒ½æ˜¯\\(0\\)ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚ä¸€å°éƒ¨åˆ†å†…ç§¯ã€‚åŒæ—¶è¿™ä¸ªå†…ç§¯è®¡ç®—ä¹Ÿæ˜¯åé¢æ ¸æ–¹æ³•åº”ç”¨çš„å‰æã€‚ Kernel åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„è®¨è®ºéƒ½æ˜¯åœ¨æ•°æ®æ˜¯çº¿æ€§å¯åˆ†çš„å‰æä¸‹è¿›è¡Œè®¨è®ºçš„ï¼Œé‚£ä¹ˆå¯¹äºçº¿æ€§ä¸å¯åˆ†çš„æƒ…å†µå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨æ ¸æ–¹æ³•ã€‚ æ ¸æ–¹æ³•çš„æ€æƒ³æ˜¯ï¼Œå¯¹äºåŸå§‹ä¸å¯åˆ†çš„æ•°æ®ï¼Œæˆ‘ä»¬å‡è®¾åŸå§‹æ•°æ®é€šè¿‡ä¸€ä¸ªæ˜ å°„\\(\\phi(\\cdot)\\)å°±å˜å¾—çº¿æ€§å¯åˆ†äº†ã€‚æ ¸æ–¹æ³•ç›¸å½“äºå¯¹æ•°æ®æ‰¾åˆ°äº†ä¸€ç§æ–°çš„è¡¨ç¤ºï¼Œå¦‚ä¸Šå›¾æ²¡æ³•ç”¨ä¸€ä¸ªè¶…å¹³é¢ç›´æ¥åˆ†å‰²ï¼Œä½†é€šè¿‡\\(\\phi(\\cdot)\\)æ˜ å°„ä¹‹åå°±å˜å¾—å¯åˆ†äº†ã€‚åŸå§‹çš„åˆ†ç±»å‡½æ•°ä¸ºï¼š \\[ f(x)= \\sum_{i=1}^n \\alpha_i y_i \\langle x_i, x\\rangle + b \\] åŠ ä¸Šæ˜ å°„ä¹‹åå˜ä¸ºï¼š \\[ f(x)= \\sum_{i=1}^n \\alpha_i y_i \\langle \\phi(x_i), \\phi(x)\\rangle + b \\] ä¼˜åŒ–é—®é¢˜ä¹Ÿå˜ä¸ºï¼š \\[ \\begin{align} \\max_\\alpha &amp;\\sum_{i=1}^n \\alpha_i - \\frac{1}{2}\\sum_{i,j=1}^n \\alpha_i\\alpha_j y_i y_j \\langle\\phi(x_i), \\phi(x_j)\\rangle\\\\ \\text{s.t. }&amp; \\alpha_i\\geq 0, i=1,\\cdots,n\\\\ &amp; \\sum_{i=1}^n \\alpha_i y_i = 0 \\end{align} \\] æˆ‘ä»¬æŠŠè®¡ç®—ä¸¤ä¸ªå‘é‡åœ¨æ˜ å°„åçš„ç©ºé—´ä¸­çš„å†…ç§¯çš„å‡½æ•°å«åšæ ¸å‡½æ•° \\[ f(x)= \\sum_{i=1}^n \\alpha_i y_i k(x_i, x) + b \\] ä¼˜åŒ–é—®é¢˜æ”¹ä¸ºï¼š \\[ \\begin{align} \\max_\\alpha &amp;\\sum_{i=1}^n \\alpha_i - \\frac{1}{2}\\sum_{i,j=1}^n \\alpha_i\\alpha_j y_i y_j k(\\phi(x_i), \\phi(x_j))\\\\ \\text{s.t. }&amp; \\alpha_i\\geq 0, i=1,\\cdots,n\\\\ &amp; \\sum_{i=1}^n \\alpha_i y_i = 0 \\end{align} \\] å®é™…ä¸Šï¼Œé€šè¿‡æ ¸å‡½æ•°ï¼Œæˆ‘ä»¬éšå¼åœ°å®šä¹‰äº†ä¸€ä¸ªæ˜ å°„\\(\\phi(\\cdot)\\) å¸¸ç”¨æ ¸å‡½æ•° åç§° è¡¨è¾¾å¼ å‚æ•° çº¿æ€§æ ¸ å¤šé¡¹å¼æ ¸ RBFæ ¸ æ‹‰æ™®æ‹‰æ–¯æ ¸ Sigmoidæ ¸ Soft Margin æ•°æ®çº¿æ€§ä¸å¯åˆ†çš„æƒ…å†µï¼Œé™¤äº†æ•°æ®æœ¬èº«ç»“æ„éçº¿æ€§çš„åŸå› ä¹‹å¤–ï¼ˆæ ¸æ–¹æ³•ï¼‰ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯å› ä¸ºå™ªå£°æˆ–è€…ç¦»ç¾¤ç‚¹ã€‚ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥å…è®¸ä¸€éƒ¨åˆ†ç‚¹åœ¨ä¸€å®šç¨‹åº¦ä¸Šåç¦»è¶…å¹³é¢ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯åŸæ¥çš„çº¦æŸæ¡ä»¶\\(y_i(w^\\top x_i+b)\\geq 1, \\space i=1,\\cdots,n\\)å˜æˆäº†ï¼š \\[ y_i(w^\\top x_i+b)\\geq 1-\\xi_i, \\space i=1,\\cdots,n \\] å…¶ä¸­\\(\\xi_i\\geq 0\\)ç§°ä½œæ˜¯æ¾å¼›å˜é‡ï¼Œä»£è¡¨æ ·æœ¬\\(i\\)å…è®¸çš„åç¦»ç¨‹åº¦ã€‚å½“ç„¶æ¾å¼›å˜é‡ä¸å¯èƒ½æ— é™å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†\\(\\xi_i\\)åŠ å…¥åˆ°ä¼˜åŒ–ç›®æ ‡å‡½æ•°ä¸­ä½¿å…¶å°½é‡å°ï¼Œäºæ˜¯æœ‰ï¼š \\[ \\begin{align} \\min &amp; \\space \\frac{1}{2}\\parallel w\\parallel^2+C\\sum_{i=1}^n \\xi_i,\\\\ s.t. &amp; y_i(w^\\top x_i+b)\\geq 1-\\xi_i, \\space i=1,\\cdots,n \\end{align} \\] å…¶ä¸­\\(C\\)ä¸ºæ§åˆ¶æœ€ä¼˜åŒ–\\(\\parallel w\\parallel\\)å’Œæ¾å¼›å˜é‡è¿™ä¸¤é¡¹çš„æƒé‡ã€‚è¿™é‡Œçš„ä¼˜åŒ–å‡½æ•°è¿˜æ˜¯å¯¹å¶é—®é¢˜ä¹‹å‰çš„å½¢å¼ï¼Œæˆ‘ä»¬é©¬ä¸Šä¼šè®¨è®ºå¯¹å¶é—®é¢˜ã€‚ Numerical Optimization è¿™é‡Œè®¨è®ºSVMé«˜æ•ˆæ±‚è§£çš„Sequential Minimal Optimization (SMO)ç®—æ³•ã€‚ åæ ‡ä¸‹é™æ³•æ˜¯ä¸€ç§éæ¢¯åº¦ä¼˜åŒ–ç®—æ³•ï¼Œ","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Machine Learning","slug":"Technical-Notes/Machine-Learning","permalink":"http://qfxiao.me/categories/Technical-Notes/Machine-Learning/"}],"tags":[{"name":"SVM","slug":"SVM","permalink":"http://qfxiao.me/tags/SVM/"}]},{"title":"Linear Regression and Logistic Regression - Machine Learning Classification Algorithms 1","slug":"Linear-Regression-and-Logistic-Regression-Machine-Learning-Classification-Algorithms-1","date":"2020-08-25T18:08:49.000Z","updated":"2020-09-19T11:45:47.022Z","comments":true,"path":"2020/08/26/Linear-Regression-and-Logistic-Regression-Machine-Learning-Classification-Algorithms-1/","link":"","permalink":"http://qfxiao.me/2020/08/26/Linear-Regression-and-Logistic-Regression-Machine-Learning-Classification-Algorithms-1/","excerpt":"","text":"Introduction Still working on it... Linear Regression The Model \\[ \\hat y = w^\\top x + b \\] æŸå¤±å‡½æ•°ï¼š \\[ \\mathcal L(w) = \\sum_{i=1}^N \\parallel w^\\top x_i -y_i\\parallel^2 \\] å†™æˆçŸ©é˜µå½¢å¼ \\[ \\mathcal L(w) = \\] è®¾è®­ç»ƒé›†åŒ…å«\\(M\\)ä¸ªæ ·æœ¬ï¼Œ\\(N\\)ä¸ªç‰¹å¾ï¼Œä¸ºäº†æ–¹ä¾¿åç»­æ¨å¯¼ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€åˆ—å…¨æ˜¯\\(1\\)çš„å‘é‡ï¼š \\[ \\mathbf X=\\left( \\begin{matrix} x_{11} &amp; x_{12} &amp; \\cdots &amp; x_{1N} &amp; 1\\\\ x_{21} &amp; x_{22} &amp; \\cdots &amp; x_{2N} &amp; 1\\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots\\\\ x_{M1} &amp; x_{M2} &amp; \\cdots &amp; x_{MN} &amp; 1 \\end{matrix} \\right) \\] æˆ‘ä»¬çš„æ¨¡å‹ \\[ \\boldsymbol{\\hat y} = \\mathbf X \\hat{\\boldsymbol w} \\] æœ€ç»ˆå¾—åˆ° Projection Matrix Probabilistic Interpretation \\[ \\hat{\\boldsymbol w}^* = (\\mathbf X^\\top \\mathbf X)^{-1}\\mathbf X^\\top\\boldsymbol y \\] Regularization å½“ç‰¹å¾æ•°\\(N\\)å¤§äºæ ·æœ¬æ•°é‡\\(M\\)æ—¶ï¼Œå®¹æ˜“å‘ç”Ÿè¿‡æ‹Ÿåˆã€‚ è¿‡æ‹Ÿåˆçš„è§£å†³æ€è·¯ï¼š å¢åŠ æ•°æ®é‡ é™ç»´ï¼Œç‰¹å¾é€‰æ‹©ã€ç‰¹å¾æå– å¢åŠ æ­£åˆ™åŒ– å¸¸è§çš„æ­£åˆ™é¡¹æœ‰\\(\\ell_1\\)æ­£åˆ™å’Œ\\(\\ell_2\\)æ­£åˆ™ã€‚å‡è®¾åŸå§‹ä¼˜åŒ–å‡½æ•°ä¸º \\[ \\mathop{\\arg\\min}\\limits_{\\theta} \\mathcal L(\\theta) \\] åŠ å…¥\\(\\ell_1\\)æ­£åˆ™åŒ–ä¹‹å \\[ \\mathop{\\arg\\min}\\limits_{\\theta} \\mathcal J_1(\\theta)=\\mathcal L(\\theta)+\\color{red}{\\lambda\\parallel \\theta\\parallel_1} \\] åŠ å…¥\\(\\ell_2\\)æ­£åˆ™åŒ–ä¹‹å \\[ \\mathop{\\arg\\min}\\limits_{\\theta} \\mathcal J_2(\\theta)=\\mathcal L(\\theta)+\\color{red}{\\lambda\\parallel \\theta\\parallel_2^2} \\] ä¸Šé¢ä¸¤ä¸ªå…¬å¼æ˜¯å¤§å®¶æœ€å¸¸è§åˆ°çš„å½¢å¼ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå…¬å¼æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿä¸‹é¢å…ˆä»æœ€ä¼˜åŒ–çš„è§’åº¦æ¥æ¨å¯¼ä¸€ä¸‹ã€‚ The Optimization Problem ä¸€èˆ¬æ¥è¯´ï¼Œæ¨¡å‹çš„å‚æ•°é‡ä¸æ¨¡å‹çš„å¤æ‚åº¦æˆæ­£æ¯”ï¼Œæ¨¡å‹å‚æ•°è¶Šå¤šï¼Œè¶Šå®¹æ˜“å‘ç”Ÿè¿‡æ‹Ÿåˆã€‚è¦é™åˆ¶æ¨¡å‹çš„å¤æ‚åº¦ï¼Œæœ€è‡ªç„¶çš„æƒ³æ³•æ˜¯é™åˆ¶å‚æ•°ä¸­éé›¶å…ƒç´ çš„ä¸ªæ•°ï¼ŒåŠ å…¥ä¸€ä¸ªçº¦æŸæ¡ä»¶ï¼š \\[ \\begin{align} \\min_\\theta &amp;\\space\\mathcal L(\\theta)\\\\ \\text{s.t.} &amp;\\parallel \\theta \\parallel_0\\space \\leq\\space C \\end{align} \\] è¿™é‡Œ\\(\\parallel \\theta \\parallel_0\\)ä»£è¡¨å‚æ•°\\(\\theta\\)ä¸­éé›¶å…ƒç´ çš„ä¸ªæ•°ã€‚ä¸è¿‡ç›´æ¥æ±‚è§£è¿™ä¸ªé—®é¢˜å¤æ‚åº¦è¿‡é«˜ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨è¿‘ä¼¼çš„æ–¹å¼ï¼Œä¸è¦æ±‚\\(\\theta\\)ä¸¥æ ¼ç­‰äº\\(0\\)ï¼Œè€Œæ˜¯æ¥è¿‘\\(0\\)å³å¯ï¼Œäºæ˜¯å¯ä»¥ç”¨\\(\\ell_1\\)èŒƒæ•°æˆ–è€…\\(\\ell_2\\)èŒƒæ•°æ¥æ›¿ä»£ï¼š \\[ \\begin{align} \\min_\\theta &amp;\\space\\mathcal L(\\theta)\\\\ \\text{s.t.} &amp;\\parallel \\theta \\parallel_1\\space \\leq\\space C \\end{align} \\] æˆ– \\[ \\begin{align} \\min_\\theta &amp;\\space\\mathcal L(\\theta)\\\\ \\text{s.t.} &amp;\\parallel \\theta \\parallel_2\\space \\leq\\space C \\end{align} \\] å¯¹äºä¸Šè¿°çš„ä¼˜åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•å°†å…¶å˜ä¸ºæ— çº¦æŸä¼˜åŒ–å½¢å¼ï¼Œä»¥\\(\\ell_1\\)èŒƒæ•°ä¸ºä¾‹ï¼Œæœ‰ï¼š \\[ \\begin{align} \\min_\\theta \\max_\\lambda &amp; \\space\\mathcal L(\\theta) + \\lambda (\\parallel \\theta \\parallel_1-C)\\\\ \\text{s.t.} &amp; \\space \\lambda \\geq 0 \\end{align} \\] æˆ‘ä»¬å‡è®¾\\(\\lambda\\)çš„æœ€ä¼˜è§£ä¸º\\(\\lambda^*\\)ï¼Œé‚£ä¹ˆå¸¦å…¥ä¸Šå¼æœ‰ï¼š \\[ \\begin{align} \\min_\\theta &amp;\\space\\mathcal L(\\theta) + \\lambda^* (\\parallel \\theta \\parallel_1-C) \\\\\\Rightarrow&amp; \\space\\mathcal L(\\theta) + \\lambda^*\\parallel\\theta\\parallel_1 \\end{align} \\] è¿™å°±æ˜¯æˆ‘ä»¬å¸¸çœ‹åˆ°çš„æ­£åˆ™åŒ–ä¼˜åŒ–å½¢å¼ã€‚\\(\\ell_2\\)èŒƒæ•°çš„æ¨å¯¼ç±»ä¼¼ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚ Optimization Interpretation ä¸‹é¢æ¥ä»ä¼˜åŒ–çš„è§’åº¦è¿›è¡Œç›´è§‚è§£é‡Šï¼Œå‡è®¾å‚æ•°åªæœ‰ä¸¤ä¸ª\\(w_1\\)å’Œ\\(w_2\\)ã€‚ä¸‹å›¾è“è‰²æ¤­åœ†ä»£è¡¨åŸå§‹æŸå¤±å‡½æ•°\\(\\mathcal L(\\theta)\\)çš„ä¸€æ¡ç­‰é«˜çº¿ï¼Œçº¢è‰²ä¸ºæ­£åˆ™é¡¹çº¦æŸå¯¹åº”çš„å¯è¡ŒåŸŸã€‚åŸå‡½æ•°çš„æœ€ä¼˜è§£ä¸€å®šåœ¨å¯¼æ•°ä¸º\\(0\\)å¤„å–å¾—ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¼æ•°ä¸è“è‰²ç­‰é«˜çº¿ç›¸åˆ‡ï¼Œ Probabilistic Interpretation ä»è´å¶æ–¯çš„è§’åº¦æ¥çœ‹ï¼Œæ— è®ºæ˜¯è¾“å…¥\\(x\\)ï¼Œè¾“å‡º\\(y\\)è¿˜æ˜¯å‚æ•°\\(\\theta\\)ï¼Œéƒ½æ˜¯éšæœºå˜é‡ï¼Œæˆ‘ä»¬å°†å‚æ•°\\(\\theta\\)çš„å…ˆéªŒè®°ä¸º\\(p(\\theta)\\)ï¼Œè€Œ\\(\\theta\\)çš„åéªŒæœ‰ï¼š \\[ \\begin{align} p(\\theta|x,y)&amp;=\\frac{p(x,y|\\theta)\\cdot p(\\theta)}{p(x,y)}\\\\ &amp;=\\frac{p(x|\\theta)\\cdot p(y|x,\\theta)\\cdot p(\\theta)}{p(x,y)}\\\\ &amp;=\\frac{p(x)\\cdot p(y|x,\\theta)\\cdot p(\\theta)}{p(x,y)}\\\\ &amp;\\propto p(y|x,\\theta)\\cdot p(\\theta) \\end{align} \\] å…¶ä¸­\\(x\\)å’Œ\\(\\theta\\)ç›¸äº’ç‹¬ç«‹ï¼Œé‚£ä¹ˆ\\(p(x|\\theta)=p(x)\\)ï¼Œè€Œ LASSO Regression LASSO (Least Absolute Shrinkage and Selection Operator) Ridge Regression \\[ \\sum_{i=1}^N\\parallel \\hat{\\boldsymbol w}^\\top x_i-y_i\\parallel^2+\\lambda \\hat{\\boldsymbol w}^\\top\\hat{\\boldsymbol w} \\] æœ€ä¼˜è§£ \\[ \\hat{\\boldsymbol w}^* = (\\mathbf X^\\top \\mathbf X + \\lambda \\mathbf I)^{-1}\\mathbf X^\\top\\boldsymbol y \\] Logistic Regression å‡è®¾æˆ‘ä»¬çº¿æ€§å›å½’çš„å¯¹è±¡ä¸æ˜¯æ ‡ç­¾ï¼Œè€Œæ˜¯å…³äºæ ‡ç­¾çš„ä¸€ä¸ªå‡½æ•°\\(g(y)\\)ï¼Œ \\[ g(y)=w^\\top x+b \\] å–åå‡½æ•°å¾—åˆ° \\[ y=g^{-1}(w^\\top x+b) \\] æˆ‘ä»¬å°±å¾—åˆ°äº†å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼Œå¯ä»¥å°†çº¿æ€§å›å½’é€‚ç”¨åˆ°æ›´å¹¿çš„æƒ…å½¢ The Model å°†çº¿æ€§å›å½’çš„è¾“å‡ºå€¼ä¸æ ‡ç­¾\\(y\\)è”ç³»èµ·æ¥ï¼Œæœ€ç›´è§‚çš„æƒ³æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªå•ä½é˜¶è·ƒå‡½æ•°ï¼š \\[ y=\\begin{cases}0, &amp;z&lt;0\\\\ 0.5, &amp;z=0\\\\ 1, &amp;z&gt;0\\end{cases} \\] è¿™æ ·ï¼Œå¯¹äºçº¿æ€§å›å½’è¾“å‡ºå¤§äº\\(0\\)çš„è®¤ä¸ºæ˜¯æ­£æ ·æœ¬ï¼Œå°äº\\(0\\)çš„è®¤ä¸ºæ˜¯è´Ÿæ ·æœ¬ã€‚ä¸è¿‡è¿™æ ·çš„å‡½æ•°æ˜¯ä¸å¯å¯¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ›¿ä»£å‡½æ•°ï¼š \\[ \\sigma(z)=\\sigma(w^\\top x+b)=\\frac{1}{1+e^{-(w^\\top x+b)}} \\] å…¶å‡½æ•°å›¾åƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¯¥å‡½æ•°è¢«ç§°ä¸ºæ˜¯Sigmoidå‡½æ•°ï¼Œå…¶å¯¼æ•°å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š \\[ \\sigma^\\prime(x)=\\sigma(x)(1-\\sigma(x)) \\] å…¶è¾“å‡ºåœ¨\\(0-1\\)ä¹‹é—´ï¼Œå¯ä»¥ç”¨ä½œæ¦‚ç‡è§£é‡Šã€‚ è¿™æ ·æˆ‘ä»¬å°±æœ‰ \\[ y=\\frac{1}{1+e^{-(w^\\top x+b)}} \\] æˆ‘ä»¬å¯ä»¥é€šè¿‡å˜æ¢å°†å…¶å†™æˆå¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„å½¢å¼ï¼Œå³ï¼š \\[ \\log \\frac{y}{1-y}=w^\\top x+b \\] ä»è¿™ä¸€å±‚é¢ä¸Šå¯ä»¥è®¤ä¸ºé€»è¾‘å›å½’æ˜¯ä»¥â€œå¯¹æ•°å‡ ç‡â€ä¸ºå¯¹è±¡çš„çº¿æ€§å›å½’ Loss Function å‰é¢æˆ‘ä»¬è¯´è¿‡Sigmoidå‡½æ•°çš„è¾“å‡ºåœ¨\\(0-1\\)ä¹‹é—´ï¼Œå¯ä»¥ä»æ¦‚ç‡åˆ†å¸ƒçš„è§’åº¦æ¥è§£é‡Šã€‚æˆ‘ä»¬è®¾å®šSigmoidä¸º\\(x\\)ä¸ºè´Ÿä¾‹çš„æ¦‚ç‡ï¼š \\[ p_w(y=0|x) = \\frac{1}{1+e^{-(w^\\top x+b)}} \\] é‚£ä¹ˆ \\[ p_w(y=1|x)=\\frac{e^{-(w^\\top x + b)}}{1+e^{-(w^\\top x+b)}} \\] è¿™æ ·æˆ‘ä»¬å®é™…ä¸Šæ˜¯è®¤ä¸º\\(p(y|x)\\)æœä»ä¼¯åŠªåˆ©åˆ†å¸ƒã€‚æˆ‘ä»¬å½“ç„¶æ˜¯å¸Œæœ›å‚æ•°\\(w\\)å¾—åˆ°çš„æ¨¡å‹ä¸çœŸå®æ•°æ®çš„æ‹Ÿåˆç¨‹åº¦è¶Šé«˜è¶Šå¥½ï¼Œå¯ä»¥ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ¥è§£å†³ã€‚ ä¼¼ç„¶ \\[ L(w,b) = \\prod_{i=1}^N (p_w(y=1|x_i))^{y_i} (1-p_w(y=1|x_i))^{1-y_i} \\] å¯¹æ•°ä¼¼ç„¶ä¸º \\[ \\begin{align} \\log L(w,b) &amp;= \\log \\prod_{i=1}^N (p_w(y=1|x_i))^{y_i} (1-p_w(y=1|x_i))^{1-y_i} \\end{align} \\] ä¸ºäº†æ–¹ä¾¿æ¨å¯¼ï¼Œæˆ‘ä»¬å°†åç½®é¡¹\\(b\\)ä¸\\(w\\)åˆå¹¶èµ·æ¥ï¼š \\[ w^\\top x+b\\Rightarrow \\beta x \\] äºæ˜¯ \\[ \\begin{align} \\log L(\\beta) &amp;=\\sum_{i=1}^N y_i\\log p_\\beta(y=1|x_i)+(1-y_i)\\log(1-p_\\beta(y=1|x_i))\\\\ &amp;=\\sum_{i=1}^N y_i \\log \\frac{e^{-\\beta x_i}}{1+e^{-\\beta x_i}} +(1-y_i)\\log \\frac{1}{1+e^{-\\beta x_i}}\\\\ &amp;=\\sum_{i=1}^N y_i\\log (e^{-\\beta x_i} \\cdot \\frac{1}{1+e^{-\\beta x}})+(1-y_i)\\log \\frac{1}{1+e^{-\\beta x}}\\\\ &amp; = \\sum_{i=1}^N -y_i\\beta x_i+y_i \\log \\frac{1}{1+e^{-\\beta x_i}}+\\log \\frac{1}{1+e^{-\\beta x_i}}-y_i \\log \\frac{1}{1+e^{-\\beta x_i}}\\\\ &amp;=\\sum_{i=1}^N -y_i\\beta x_i + \\log \\frac{1}{1+ e^{-\\beta x_i}}\\\\ &amp;=\\sum_{i=1}^N -y_i\\beta x_i - \\log(1+ e^{-\\beta x_i}) \\end{align} \\] æŸå¤±å‡½æ•°ç›¸å½“äºæœ€å°åŒ–\\(\\log L(\\beta)\\)çš„è´Ÿæ•°ï¼š \\[ \\ell (\\beta) = \\sum_{i=1}^N y_i\\beta x_i + \\log(1+ e^{-\\beta x_i}) \\] æŸå¤±å‡½æ•°çš„å¯¼æ•° \\[ \\frac{\\partial \\ell(\\beta)}{\\partial \\beta}=\\sum_{i=1}^N x_i(y_i-p_\\beta(y=1|x_i)) \\] äºŒé˜¶å¯¼æ•°ä¸º \\[ \\frac{\\partial^2\\ell(\\beta)}{\\partial\\beta\\partial\\beta^\\top}=\\sum_{i=1}^N x_ix_i^\\top p_\\beta(y=0|x)p_\\beta(y=1|x) \\] Optimization","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Machine Learning","slug":"Technical-Notes/Machine-Learning","permalink":"http://qfxiao.me/categories/Technical-Notes/Machine-Learning/"}],"tags":[{"name":"Linear Regression","slug":"Linear-Regression","permalink":"http://qfxiao.me/tags/Linear-Regression/"}]},{"title":"Boosting and AdaBoost: Machine Learning Ensemble Algorithms 1","slug":"Boosting-and-AdaBoost-Machine-Learning-Ensemble-Algorithms-1","date":"2020-08-25T16:28:44.000Z","updated":"2020-09-09T03:33:38.696Z","comments":true,"path":"2020/08/26/Boosting-and-AdaBoost-Machine-Learning-Ensemble-Algorithms-1/","link":"","permalink":"http://qfxiao.me/2020/08/26/Boosting-and-AdaBoost-Machine-Learning-Ensemble-Algorithms-1/","excerpt":"","text":"Introduction Boosting AdaBoost Algorithm ç»™å®šæ•°æ®é›†\\(X=\\{(x_1,y_1),\\cdots,(x_N,y_N)\\}\\)ï¼ŒAdaBoostçš„æ€æƒ³æ˜¯é€šè¿‡è®­ç»ƒä¸€ç³»åˆ—å¼±åˆ†ç±»å™¨ï¼Œå¹¶é€šè¿‡çº¿æ€§ç›¸åŠ å°†è¿™äº›å¼±åˆ†ç±»å™¨ç»„åˆæˆå¼ºåˆ†ç±»å™¨ã€‚ åˆå§‹åŒ–æ•°æ®çš„æƒé‡åˆ†å¸ƒ\\(D_1\\) åœ¨è®­ç»ƒæ•°æ®ä¸Šä½¿ç”¨æƒé‡åˆ†å¸ƒ\\(D_m\\)è¿›è¡Œè®­ç»ƒï¼Œå¾—åˆ°åŸºåˆ†ç±»å™¨\\(G_m(x)\\) è®¡ç®—åŸºåˆ†ç±»å™¨\\(G(x)\\)åœ¨è®­ç»ƒæ•°æ®ä¸Šçš„è¯¯å·®\\(e_m\\) è®¡ç®—åŸºåˆ†ç±»å™¨\\(G(x)\\)çš„æƒé‡\\(\\alpha_m\\)ï¼Œå¯ä»¥çœ‹å‡ºè¿™ä¸ªæƒé‡æ˜¯ä¸è¯¯å·®\\(e_m\\)æˆåæ¯”çš„ï¼Œå³è¯¯å·®è¶Šå¤§ï¼Œæƒé‡è¶Šä½ æ›´æ–°è®­ç»ƒæ•°æ®çš„æƒé‡åˆ†å¸ƒ\\(D_{m+1}\\)ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæƒé‡æ˜¯å’Œè¯¯å·®æˆæ­£æ¯”çš„ï¼Œå³è¯¯å·®å¤§çš„æ ·æœ¬ä¼šå—åˆ°æ›´é«˜çš„å…³æ³¨ å›åˆ°æ­¥éª¤2ï¼Œç›´åˆ°å¾—åˆ°\\(M\\)ä¸ªåˆ†ç±»å™¨ å°†åˆ†ç±»å™¨è¿›è¡Œçº¿æ€§ç»„åˆå¾—åˆ°æœ€ç»ˆåˆ†ç±»å™¨","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Machine Learning","slug":"Technical-Notes/Machine-Learning","permalink":"http://qfxiao.me/categories/Technical-Notes/Machine-Learning/"}],"tags":[{"name":"Boosting","slug":"Boosting","permalink":"http://qfxiao.me/tags/Boosting/"},{"name":"Adaboost","slug":"Adaboost","permalink":"http://qfxiao.me/tags/Adaboost/"}]},{"title":"GBDT and XGBoost: Machine Learning Ensemble Algorithms 2","slug":"GBDT-and-XGBoost-Machine-Learning-Ensemble-Algorithms-2","date":"2020-08-25T16:28:26.000Z","updated":"2020-09-17T13:32:26.325Z","comments":true,"path":"2020/08/26/GBDT-and-XGBoost-Machine-Learning-Ensemble-Algorithms-2/","link":"","permalink":"http://qfxiao.me/2020/08/26/GBDT-and-XGBoost-Machine-Learning-Ensemble-Algorithms-2/","excerpt":"","text":"Introduction åœ¨å­¦ä¹ æœ¬æ–‡å†…å®¹ä¹‹å‰å»ºè®®å…ˆå­¦ä¹ å†³ç­–æ ‘ç›¸å…³å†…å®¹ã€‚ Still working on itğŸ˜…... XGBoost Documentation AdaBoost blog GBDT blog slide é™ˆå¤©å¥‡slide blog blog Preliminaries å®é™…ä¸Šï¼ŒGBDTå’Œæ¢¯åº¦ä¸‹é™ã€XGBoostå’Œç‰›é¡¿æ³•ä¹‹é—´æ˜¯å­˜åœ¨å¯†åˆ‡å…³ç³»çš„ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹æ¢¯åº¦ä¸‹é™ç®—æ³•å’Œç‰›é¡¿æ³•çš„åŸºç¡€çŸ¥è¯†ã€‚ Taylor Formulation å‡½æ•°\\(f(x)\\)åœ¨ç‚¹\\(x_0\\)å¤„çš„æ³°å‹’å±•å¼€ä¸ºï¼š \\[ f(x)=\\sum_{n=0}^\\infty\\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n \\] ç‰¹åˆ«çš„ï¼Œä¸€é˜¶å±•å¼€ä¸ºï¼š \\[ f(x)\\approx f(x_0)+f^\\prime(x_0)(x-x_0) \\] äºŒé˜¶å±•å¼€ä¸ºï¼š \\[ f(x)\\approx f(x_0)+f^\\prime(x_0)(x-x_0) + f^{\\prime\\prime}(x_0)\\frac{(x-x_0)^2}{2} \\] è¿­ä»£å½¢å¼ï¼šå‡è®¾\\(x^t=x^{t-1}+\\Delta x\\)ï¼Œå°†\\(f(x)\\)åœ¨\\(x^{t-1}\\)å¤„è¿›è¡Œæ³°å‹’å±•å¼€ \\[ \\begin{align} f(x^t) &amp;= f(x^{t-1}+\\Delta x)\\\\ &amp;\\approx f(x^{t-1})+f^\\prime(x^{t-1})\\Delta x + f^{\\prime\\prime}(x^{t-1})\\frac{\\Delta x^2}{2} \\end{align} \\] Gradient Descend Method è®¾å‚æ•°\\(\\theta\\)ï¼Œé‚£ä¹ˆå‚æ•°å¯¹åº”çš„æŸå¤±å‡½æ•°ä¸º\\(L(\\theta)\\)ï¼Œ è®¾å½“å‰æ­¥æ•°ä¸º\\(t\\)ï¼Œé‚£ä¹ˆ\\(t-1\\)æ­¥æ—¶çš„å‚æ•°ä¸º\\(\\theta^{t-1}\\)ï¼Œå°†\\(L(\\theta^t)\\)åœ¨\\(\\theta^{t-1}\\)å¤„å±•å¼€å¾—åˆ°ï¼š \\[ L(\\theta^t) \\approx L(\\theta^{t-1})+ L^\\prime(\\theta^{t-1})\\Delta\\theta \\] æˆ‘ä»¬æƒ³æ±‚çš„\\(\\theta^t=\\theta^{t-1}+\\Delta \\theta\\) Newton's Method å°†\\(L(\\theta^t)\\)åœ¨\\(\\theta^{t-1}\\)å¤„è¿›è¡ŒäºŒé˜¶æ³°å‹’å±•å¼€ \\[ \\begin{align} L(\\theta^t) &amp;= L(\\theta^{t-1}+\\Delta \\theta)\\\\ &amp;\\approx L(\\theta^{t-1})+L^\\prime(\\theta^{t-1})\\Delta \\theta + L^{\\prime\\prime}(\\theta^{t-1})\\frac{\\Delta \\theta^2}{2} \\end{align} \\] è®°ä¸€é˜¶å¯¼æ•°å’ŒäºŒé˜¶å¯¼æ•°åˆ†åˆ«ä¸º\\(g\\)å’Œ\\(H\\)ï¼Œé‚£ä¹ˆ \\[ L(\\theta^t)=L(\\theta^{t-1})+g\\Delta \\theta + H\\frac{\\Delta \\theta^2}{2} \\] è¦ä½¿å¾—è¿­ä»£åçš„ç»“æœå°½é‡å°ï¼Œå³\\(g\\Delta \\theta + H\\frac{\\Delta \\theta^2}{2}\\)å°½é‡å°ï¼Œé‚£ä¹ˆæœ‰\\(\\frac{\\left(g\\Delta \\theta + H\\frac{\\Delta \\theta^2}{2}\\right)}{\\partial\\Delta\\theta}=0\\) æ±‚å¾—\\(\\Delta \\theta=H^{-1}g\\)ï¼Œæ•…\\(\\theta^{t}=\\theta^{t-1}+\\Delta \\theta=\\theta^{t-1}-\\frac{g}{h}\\)ã€‚å¦‚æœ\\(\\theta\\)æ˜¯ä¸€ä¸ªå‘é‡ï¼Œé‚£ä¹ˆ\\(\\theta^{t}=\\theta^{t-1}-H^{-1}g\\)ï¼Œè¿™é‡Œ\\(H\\)ä¸ºæµ·æ£®çŸ©é˜µã€‚ Gradient Boosting Decision Tree (GBDT) æˆ‘ä»¬é¦–å…ˆæ¥çœ‹åŸºäºæ ‘çš„Boostingæ¨¡å‹ä¸­ï¼Œéå¸¸ç»å…¸çš„æ¢¯åº¦æå‡æ ‘ (Gradient Boosting Decision Tree)ã€‚ The Additive Model é¦–å…ˆGBDTæ˜¯ä¸€ä¸ªåŠ æ³•æ¨¡å‹ï¼Œå³æœ€ç»ˆæ¨¡å‹ç”±ä¸€ç³»åˆ—æ ‘æ¨¡å‹ä¹˜ä»¥å¯¹åº”æƒé‡ç›¸åŠ å¾—æ¥ï¼š \\[ F_T(x;w)=\\sum_{t=0}^T\\alpha_t h_t(x;w_t)=\\sum_{t=0}^T f_t(x;w_t) \\] æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä½¿å¾—\\(F\\)çš„æŸå¤±å‡½æ•°æœ€å°åŒ–ï¼š \\[ F_T^*=\\mathop{\\arg\\min}\\limits_{F}\\sum_{i=1}^N L(y_i, F_T(x_i;w)) \\] ç›´æ¥ä¼˜åŒ–è¿™ä¸ªæŸå¤±å‡½æ•°å¤æ‚åº¦æ˜¯å¾ˆé«˜çš„ï¼ŒGBDTå®é™…ä¸Šè¿ç”¨äº†ä¸€ç§ç±»ä¼¼è´ªå¿ƒçš„ç­–ç•¥æ¥ä¼˜åŒ–è¿™ä¸ªå‡½æ•°ï¼Œå°†ä¼˜åŒ–è¿‡ç¨‹åˆ†è§£æˆäº†è¿­ä»£çš„æ­¥éª¤ã€‚ å›æƒ³æ¢¯åº¦ä¸‹é™ç®—æ³•è¿›è¡Œä¼˜åŒ–çš„æ­¥éª¤ï¼Œæˆ‘ä»¬æœ‰å‚æ•°\\(\\theta\\)ï¼ŒæŸå¤±å‡½æ•°\\(L(\\theta)\\)æ˜¯\\(\\theta\\)çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°æœ€ä¼˜çš„\\(\\theta^*\\)ä½¿å¾—\\(L(\\theta^*)\\)æœ€å°ï¼Œäºæ˜¯æˆ‘ä»¬ä½¿ç”¨äº†è¿­ä»£ä¼˜åŒ–çš„æ­¥éª¤ã€‚å‡è®¾è¿­ä»£æ‰§è¡Œåˆ°ç¬¬\\(t\\)æ­¥ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç°åœ¨çš„å‚æ•°\\(\\theta^{t-1}\\)ä¸ºå‰é¢\\(t-1\\)æ­¥å¢é‡ä¹‹å’Œï¼š\\(\\theta^{t-1}=\\sum_{j=1}^{t-1}\\Delta \\theta_j\\)ï¼Œæ¯ä¸€æ­¥çš„å¢é‡è®°ä¸º\\(\\Delta \\theta_t\\)ã€‚å½“å‰çš„å¢é‡\\(\\Delta \\theta_{t}\\)æ˜¯æ€ä¹ˆè®¡ç®—å¾—åˆ°çš„å‘¢ï¼Ÿå¤§å®¶éƒ½çŸ¥é“æ˜¯é‡‡ç”¨çš„æŸå¤±å‡½æ•°åœ¨\\(\\theta^{t-1}\\)çš„è´Ÿæ¢¯åº¦ä¹˜ä»¥ä¸€ä¸ªæ­¥é•¿ï¼Œå³\\(\\Delta \\theta_t=-\\alpha_t \\frac{\\partial L(\\theta)}{\\partial \\theta^{t-1}}\\)ã€‚ æ¢¯åº¦ä¸‹é™ç›¸å½“äºæ˜¯åœ¨å‚æ•°ç©ºé—´\\(\\theta\\)æ‰¾åˆ°æœ€åˆé€‚çš„å‚æ•°\\(\\theta^*\\)ä½¿å¾—æŸå¤±å‡½æ•°\\(L(\\theta)\\)æœ€å°åŒ–ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæ¨¡å‹\\(F_T\\)çœ‹ä½œæ˜¯å‡½æ•°ç©ºé—´ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯åœ¨å‡½æ•°ç©ºé—´ä¸­æ‰¾åˆ°æœ€ä¼˜çš„\\(F_T^*\\)ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°åŒ–ï¼Œåœ¨è¿™ä¸€ä¸ªè§’åº¦ä¸ŠGBDTå’Œæ¢¯åº¦ä¸‹é™å°±ç»Ÿä¸€èµ·æ¥äº†ã€‚æ¯ä¸€æ­¥çš„åŸºæ¨¡å‹\\(f_t\\)å°±ç›¸å½“äºæ¢¯åº¦ä¸‹é™ä¸­çš„å¢é‡\\(\\Delta \\theta\\)ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¾—åˆ°äº†GBDTæ¯ä¸€çš„ä¼˜åŒ–ç›®æ ‡ï¼Œå³æŸå¤±å‡½æ•°\\(L\\)å¯¹äº\\(F_{t-1}\\)çš„è´Ÿæ¢¯åº¦ã€‚ æ¢¯åº¦ä¸‹é™ GBDT æŸå¤±å‡½æ•° \\(L(\\theta)\\) \\(L(F_t)\\) å‚æ•° \\(\\theta^t\\) \\(F_t\\) å¢é‡ \\(\\Delta \\theta_t=-\\alpha_t g_t\\) \\(f_t=-\\alpha_t g_t\\) æ­¥é•¿ \\(\\alpha_t\\) \\(\\alpha_t\\) åˆå§‹å€¼ \\(\\theta_0\\) \\(f_0\\) Gradient Boosting Tree for Regression æˆ‘ä»¬å…ˆæ¥è®¨è®ºGBDTè§£å†³å›å½’é—®é¢˜çš„ç®—æ³•ã€‚å‰é¢æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡ï¼Œåœ¨æ¯ä¸€æ­¥GBDTçš„ä¼˜åŒ–ç›®æ ‡æ˜¯æŸå¤±å‡½æ•°çš„è´Ÿæ¢¯åº¦ï¼Œé‚£ä¹ˆç°åœ¨çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æ±‚å¾—æ¯ä¸€æ­¥æœ€ä¼˜çš„åŸºæ¨¡å‹ï¼ˆGBDTçš„åŸºæ¨¡å‹é€‰ç”¨çš„æ˜¯CARTï¼‰ã€‚GBDTçš„ç®—æ³•æ­¥éª¤å¦‚ä¸‹ï¼š Gradient Boosting Tree Algorithm INPUT: è®­ç»ƒæ ·æœ¬\\(\\{(x_1,y_1),\\cdots,(x_m,y_m)\\}\\)ï¼Œè¿­ä»£è½®æ•°\\(T\\)ï¼ŒæŸå¤±å‡½æ•°\\(L\\) OUTPUT: å¼ºæ¨¡å‹\\(F_T\\) åˆå§‹åŒ–å¼±å­¦ä¹ å™¨\\(f_0\\)ï¼Œç›´æ¥ä½¿ç”¨ä¸€ä¸ªåŸºæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šè¿›è¡Œè®­ç»ƒ åœ¨æ­¥éª¤\\(t=1...T\\)ï¼Œå¯¹äºæ¯ä¸ªæ ·æœ¬è®¡ç®—è´Ÿæ¢¯åº¦\\(r_{ti}=\\left[\\frac{\\partial L(y_i,F_{t-1}(x_i))}{\\partial F_{t-1}}\\right]\\) åœ¨\\((x_i,r_{ti})\\)ä¸Šè®­ç»ƒå¾—åˆ°ä¸€ä¸ªCARTå›å½’æ ‘ï¼Œç¡®å®šæ ‘çš„ç»“æ„ å‡è®¾ä¸€å…±æœ‰\\(J\\)ä¸ªå¶å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯¹æ¯ä¸ªå¶å­èŠ‚ç‚¹è®¡ç®—æœ€ä½³è¾“å‡ºå€¼\\(c_{tj}=\\mathop{\\arg\\min}\\limits_{c_{tj}}\\sum_{x_i\\in R_{tj}} L(y_i,F_{t-1}(x_i)+c_{tj})\\)ï¼ˆå…¶ä¸­\\(c_{tj}\\)ä»£è¡¨ç¬¬\\(j\\)ä¸ªå¶å­çš„è¾“å‡ºï¼Œ\\(R_{tj}\\)ä»£è¡¨ç¬¬\\(j\\)ä¸ªå¶å­å¯¹åº”çš„æ ·æœ¬é›†åˆï¼‰ï¼Œç¡®å®šæ¯ä¸ªå¶å­èŠ‚ç‚¹çš„è¾“å‡º æ›´æ–°å¼ºå­¦ä¹ å™¨\\(F_t=F_{t-1}+f_t\\)ï¼Œå›åˆ°æ­¥éª¤2ç›´åˆ°è¾¾åˆ°è¿­ä»£è½®æ•° æœ€ç»ˆå¾—åˆ°å¼ºå­¦ä¹ å™¨çš„è¡¨è¾¾å¼ï¼š\\(f(x)=f_0(x)+\\sum\\limits_{t=1}^T\\sum\\limits_{j=1}^J c_{tj}\\mathrm I(x\\in R_{tj})\\) äºæ˜¯æˆ‘ä»¬å°±å¾—åˆ°äº†æœ€ç»ˆæ¨¡å‹\\(F_T\\)ã€‚ Gradient Boosting Tree for Classification åœ¨å¤„ç†åˆ†ç±»ä»»åŠ¡æ—¶ï¼Œç”±äºè¾“å‡ºæ˜¯ç¦»æ•£çš„å€¼ ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æŒ‡æ•°æŸå¤±å‡½æ•°ï¼Œæ­¤æ—¶GBDTé€€åŒ–ä¸ºAdaBoostï¼›å¦ä¸€ç§æ–¹æ³•æ˜¯å€Ÿé‰´é€»è¾‘å›å½’çš„æ–¹æ³•ï¼Œå»å»ºæ¨¡çœŸå®å€¼çš„æ¦‚ç‡ Binary Classification Multi-class Classfication GBDT Sumarry ä¼˜ç‚¹ï¼š å¯ä»¥çµæ´»å¤„ç† ç›¸å¯¹SVMï¼Œè°ƒå‚è¾ƒå°‘ ä½¿ç”¨æŸäº›æŸå¤±å‡½æ•°å¯¹å¼‚å¸¸å€¼çš„é²æ£’æ€§é«˜ ç¼ºç‚¹ï¼š éš¾ä»¥å¹¶è¡Œè®­ç»ƒ XGBoost å‰é¢æˆ‘ä»¬è®²äº†æ¢¯åº¦ä¸‹é™å’Œç‰›é¡¿æ³•ï¼Œåˆšæ‰åˆè®¨è®ºäº†GBDTå’Œæ¢¯åº¦ä¸‹é™çš„å…³ç³»ï¼Œé‚£ä¹ˆXGBoostæ˜¯å¦å’Œç‰›é¡¿æ³•æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚GBDTåˆ©ç”¨äº†æŸå¤±å‡½æ•°åœ¨\\(F_{t-1}\\)çš„ä¸€é˜¶å±•å¼€ï¼ˆå³ä¸€é˜¶å¯¼æ•°ä¿¡æ¯ï¼‰ï¼Œè€ŒXGBooståˆ™åˆ©ç”¨äº†æŸå¤±å‡½æ•°åœ¨\\(F_{t-1}\\)çš„äºŒé˜¶å±•å¼€ï¼Œè¿™ä¹Ÿæ˜¯XGBoostå’ŒGBDTæœ€æ ¹æœ¬çš„åŒºåˆ«ã€‚ä¸‹é¢æˆ‘ä»¬å°†è¯¦ç»†è®²è§£XGBoostç®—æ³•ã€‚ ç‰›é¡¿æ³• XGBoost æŸå¤±å‡½æ•° \\(L(\\theta)\\) \\(L(F_t)\\) å‚æ•° \\(\\theta^t\\) \\(F_t\\) å¢é‡ \\(\\Delta \\theta_t=-\\alpha_t H^{-1}_tg_t\\) \\(f_t=-\\alpha_t H^{-1}_tg_t\\) æ­¥é•¿ \\(\\alpha_t\\) \\(\\alpha_t\\) åˆå§‹å€¼ \\(\\theta_0\\) \\(f_0\\) Regularization XGBoostç›¸æ¯”GBDTçš„å¦ä¸€å¤§æ”¹è¿›æ˜¯åŠ å…¥äº†æ­£åˆ™åŒ–é¡¹ï¼Œå³æ§åˆ¶æ¯ä¸ªæ ‘çš„å¤æ‚åº¦ã€‚è¡¡é‡æ ‘çš„å¤æ‚åº¦çš„åº¦é‡æœ‰å¾ˆå¤šï¼ŒXGBoosté‡‡ç”¨çš„æ˜¯æ¯æ£µæ ‘å¶å­èŠ‚ç‚¹çš„ä¸ªæ•°\\(T\\)å’Œæ¯ä¸ªå¶å­èŠ‚ç‚¹è¾“å‡º\\(w\\)çš„å¹³æ–¹å’Œï¼š \\[ \\Omega(f)=\\gamma T+\\frac{1}{2}\\lambda\\parallel w\\parallel^2 \\] è¿™ä¸€æ­¥ä¸»è¦æ˜¯ä¸ºäº†è¿›ä¸€æ­¥é™ä½æ¯ä¸ªå¼±å­¦ä¹ å™¨çš„æ–¹å·®ã€‚ Objective Function åŠ ä¸Šæ­£åˆ™é¡¹ä¹‹åæ€»çš„æŸå¤±å‡½æ•°å˜ä¸ºï¼š \\[ L=\\sum_{i=1}^N \\ell(y_i, F_T(x_i))+\\Omega(F_T) \\] å’ŒGBDTç±»ä¼¼ï¼Œæˆ‘ä»¬æ¥æ¨å¯¼ç¬¬\\(t\\)æ­¥çš„ä¼˜åŒ–å…¬å¼ï¼Œå¯¹äºç¬¬\\(t\\)æ­¥ï¼Œæˆ‘ä»¬çš„æŸå¤±å‡½æ•°ä¸ºï¼š \\[ \\begin{align} L_t&amp;=\\sum_{i=1}^N \\ell(y_i,F_t(x_i))+\\Omega(F_t)\\\\ &amp;=\\sum_{i=1}^N \\ell(y_i, F_{t-1}(x_i) + f_t(x_i))+\\Omega(F_t) \\end{align} \\] å°†æŸå¤±å‡½æ•°åœ¨\\(F_{t-1}\\)å¤„è¿›è¡ŒäºŒé˜¶æ³°å‹’å±•å¼€ï¼Œå¾—åˆ° \\[ L_t \\approx \\left[\\sum_{i=1}^N \\ell(y_i, F_{t-1}) + g_i f_t(x_i) + \\frac{1}{2}h_i f_t^2(x_i) \\right] + \\Omega(F_t) \\] å…¶ä¸­\\(g_i=\\frac{\\partial \\ell(y_i, F_{t-1})}{\\partial F_{t-1}}\\)ï¼Œ\\(h_i=\\frac{\\partial \\ell(y_i, F_{t-1}) ^2}{\\partial^2 F_{t-1}}\\)ï¼Œåˆ†åˆ«ä»£è¡¨æŸå¤±å‡½æ•°å¯¹\\(F_{t-1}\\)çš„ä¸€é˜¶å¯¼å’ŒäºŒé˜¶å¯¼ã€‚ ç”±äºæˆ‘ä»¬è¦ä¼˜åŒ–çš„æ˜¯æœ¬è½®çš„åŸºæ¨¡å‹\\(f_t\\)ï¼Œ\\(\\ell(y_i, F_{t-1})\\)å·²ç»æ˜¯å›ºå®šçš„äº†ï¼Œç›¸å½“äºå¸¸æ•°ï¼ŒæŠŠå¸¸æ•°é¡¹å»æ‰ï¼Œå¾—åˆ°ï¼š \\[ \\begin{align} \\tilde L_t &amp;= \\left[\\sum_{i=1}^N g_i f_t(x_i) + \\frac{1}{2}h_i f_t^2(x_i) \\right] + \\Omega(f_t)\\\\ &amp;=\\left[\\sum_{i=1}^N g_i f_t(x_i) + \\frac{1}{2}h_i f_t^2(x_i) \\right] + \\gamma T + \\frac{1}{2}\\lambda \\parallel w \\parallel^2 \\end{align} \\] æˆ‘ä»¬éƒ½çŸ¥é“æ ·æœ¬\\(x_i\\)åœ¨æ ‘\\(f_t\\)ä¸Šçš„è¾“å‡ºå–å†³äº\\(x_i\\)åœ¨å“ªä¸ªå¶å­èŠ‚ç‚¹ã€‚å‡è®¾æ ‘\\(f_t\\)ä¸€å…±æœ‰\\(J\\)ä¸ªå¶èŠ‚ç‚¹ï¼Œè®°\\(q(x_i)=j\\)ä»£è¡¨æ ·æœ¬\\(x_i\\)ç»è¿‡å†³ç­–æ ‘å¯¹åº”çš„å¶èŠ‚ç‚¹æ˜¯\\(j\\)ï¼Œ\\(I_j\\)ä»£è¡¨å¶å­èŠ‚ç‚¹\\(j\\)çš„æ‰€æœ‰æ ·æœ¬ä¸‹æ ‡é›†åˆï¼Œ\\(w_j\\)ä»£è¡¨å¶å­èŠ‚ç‚¹\\(j\\)çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥å°†æŸå¤±å‡½æ•°æ”¹å†™ä¸ºï¼š \\[ \\begin{align} \\tilde L_t &amp;= \\sum_{j=1}^J\\left[\\sum_{i\\in I_j}g_i w_j+\\frac{1}{2}(\\sum_{i\\in I_j}h_i +\\lambda)w_j^2\\right]+\\gamma T\\\\ &amp;= \\sum_{j=1}^J\\left[G_j w_j + \\frac{1}{2}(H_j+\\lambda)w_j^2 \\right] + \\gamma T \\end{align} \\] å…¶ä¸­\\(G_j=\\sum_{i\\in I_j}g_i\\)å’Œ\\(H_j=\\sum_{i\\in I_j}h_i\\)ä¸ºç®€è®°ï¼Œåˆ†åˆ«ä»£è¡¨æŸå¤±å‡½æ•°åœ¨å¶å­èŠ‚ç‚¹\\(j\\)å¯¹åº”çš„æ‰€æœ‰æ ·æœ¬ä¸Šçš„ä¸€é˜¶å¯¼ä¹‹å’Œä¸äºŒé˜¶å¯¼ä¹‹å’Œã€‚ åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬è¿˜å‰©ä¸¤ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼Œä¸€ä¸ªæ˜¯ç¡®å®šæ ‘\\(f_t\\)çš„æœ€ä¼˜ç»“æ„ï¼Œä¹Ÿå°±æ˜¯æ€ä¹ˆå»åˆ†è£‚èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªæ˜¯ç¡®å®šæ¯ä¸ªå¶å­èŠ‚ç‚¹çš„æœ€ä¼˜è¾“å‡ºã€‚æˆ‘ä»¬å¯ä»¥å…ˆç¡®å®šä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œæ‰¾åˆ°å¦ä¸€ä¸ªé—®é¢˜çš„æœ€ä¼˜ç­”æ¡ˆï¼Œå†æ¥ç¡®å®šå‰©ä¸‹çš„é—®é¢˜ã€‚ è¿™é‡Œå…ˆå»å¯»æ‰¾æ ‘\\(f_t\\)æ¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹å¯¹åº”çš„æœ€ä¼˜è¾“å‡ºã€‚å’Œç‰›é¡¿æ³•çš„æ¨å¯¼ç±»ä¼¼ï¼Œä¸ºäº†ä½¿æŸå¤±å‡½æ•°ä¸‹é™çš„æœ€å¿«ï¼Œæˆ‘ä»¬ä»¤\\(G_j w_j + \\frac{1}{2}(H_j+\\lambda)w_j^2\\)çš„å¯¼æ•°ä¸º\\(0\\)ï¼Œå¾—åˆ°ï¼š \\[ w_j^*=-\\frac{G_j}{H_j + \\lambda} \\] åŠ ä¸Šæ­£åˆ™é¡¹æœ‰ï¼š \\[ \\tilde L_t^*=-\\frac{1}{2}\\sum_{j=1}^J\\frac{G_j^2}{H_j+\\lambda}+\\gamma T \\] Splitting Strategy ç°åœ¨æ¥ç¡®å®šæ ‘\\(f_t\\)çš„æœ€ä¼˜ç»“æ„ã€‚æœ€ä¼˜ç»“æ„çš„ç¡®å®šå®é™…ä¸Šä½¿ç”¨äº†ä¸€ç§ç±»ä¼¼è´ªå¿ƒçš„ç­–ç•¥ï¼Œå’Œå†³ç­–æ ‘ç±»ä¼¼ï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªåªæœ‰æ ¹èŠ‚ç‚¹çš„æ ‘å‡ºå‘ï¼ˆæ‰€æœ‰æ ·æœ¬éƒ½åœ¨æ ¹èŠ‚ç‚¹è¿™ä¸€å¶å­èŠ‚ç‚¹ä¸Šï¼‰ï¼Œä¸æ–­åˆ†è£‚èŠ‚ç‚¹æ¥é™ä½\\(\\tilde L_t^*\\)ã€‚åœ¨æ¯ä¸€æ­¥çš„åˆ†è£‚ä¸­ï¼Œæˆ‘ä»¬ä¼šå¸Œæœ›\\(\\frac{G_j^2}{H_j+\\lambda}\\)è¶Šå¤§è¶Šå¥½ï¼Œäºæ˜¯ï¼š \\[ Gain = \\frac{G_L^2}{H_L+\\lambda} + \\frac{G_R^2}{H_R+\\lambda} - \\frac{(G_L+G_R)^2}{H_L+H_R+\\lambda} - \\gamma \\] æˆ‘ä»¬å¸Œæœ›æŒ‘é€‰èƒ½ä½¿å¾—\\(Gain\\)æœ€å¤§çš„ç‰¹å¾å’Œç‰¹å¾åˆ†è£‚ç‚¹ï¼Œè€Œé€‰æ‹©çš„ç­–ç•¥åˆæœ‰å¾ˆå¤šç§ï¼Œä¸‹é¢ä»‹ç»ä¸‰ç§ã€‚ Exact Greedy Algorithm for Split Finding æœ€ç®€å•çš„æ–¹æ³•æ˜¯æšä¸¾æ‰€æœ‰ç‰¹å¾ï¼Œç„¶åå¯¹äºè¿™ä¸ªç‰¹å¾ä¸‹çš„æ‰€æœ‰å¯èƒ½å–å€¼è¿›è¡Œæ’åºï¼Œç„¶åéå†åˆ†è£‚ç‚¹ï¼Œæ‰¾åˆ°ä½¿å¾—\\(gain\\)æœ€é«˜çš„é‚£ä¸ªã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯æ‰¾åˆ°çš„åˆ†è£‚ç‚¹ç¡®å®šæ˜¯æœ€å¥½çš„ï¼Œä¸è¿‡åå¤„æ˜¯æ—¶é—´å¤æ‚åº¦è¿‡é«˜ã€‚ Approximate Algorithm for Split Finding ä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„ä¼˜åŒ–æ–¹æ¡ˆæ˜¯ä¸å»éå†æ‰€æœ‰å¯èƒ½çš„åˆ†è£‚ç‚¹ï¼Œè€Œæ˜¯åªè€ƒå¯Ÿå…¶ä¸­çš„åˆ†ä½æ•°ï¼Œå¦‚ä¸‹å›¾å±•ç¤ºäº†ä¸‰åˆ†ä½æ•°æ–¹æ³•ï¼š è¿™æ ·éœ€è¦è€ƒå¯Ÿçš„ç‚¹å°±å¤§å¤§å‡å°‘ã€‚ åŒæ—¶åˆ†ä½æ•°çš„é€‰æ‹©ç”±æœ‰globalå’Œlocalä¹‹åˆ†ï¼Œglobalæ˜¯æŒ‡åœ¨è®­ç»ƒä¹‹å‰æˆ‘ä»¬å°±å¯ä»¥æå‰å¯¹æ¯ä¸ªç‰¹å¾çš„åˆ†ä½æ•°è¿›è¡Œé¢„å¤„ç†ï¼Œlocalæ˜¯æŒ‡æ¯æ¬¡åˆ†è£‚å‰è®¡ç®—åˆ†ä½æ•°ç‚¹ã€‚ç›´è§‚ä¸Šæ¥è¯´globaléœ€è¦æ›´å¤šçš„åˆ†ä½ç‚¹æ•°ï¼Œè€Œlocalåˆ™éœ€è¦æ›´å¤šçš„è®¡ç®—é‡ã€‚ å®é™…ä¸Šï¼ŒXGBoostè¿˜ä¼šä½¿ç”¨äºŒé˜¶å¯¼ä¿¡æ¯\\(h_i\\)å¯¹æ ·æœ¬è¿›è¡Œå¤¹æƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Sparsity-aware Split Finding ç¨€ç–æ„ŸçŸ¥åˆ†è£‚ç®—æ³• (Sparsity-aware Split Finding) Other Features é™¤äº†ä¸Šé¢æåˆ°çš„ä¹‹å¤–ï¼ŒXGBoostè¿˜æœ‰å¾ˆå¤šå·¥ç¨‹ä¼˜åŒ–ã€‚ Block Structure and Parallelism XGBoosté¢„å…ˆå¯¹ç‰¹å¾è¿›è¡Œäº†æ’åºï¼Œ æ¯ä¸ªç‰¹å¾çš„å¢ç›Šçš„è®¡ç®—å¯ä»¥å¹¶è¡Œè¿›è¡Œ Column Sample å€Ÿé‰´éšæœºæ£®æ—ï¼Œå³æ¯æ¬¡åªç”¨ä¸€éƒ¨åˆ†ç‰¹å¾è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Œè¿›ä¸€æ­¥é™ä½è¿‡æ‹Ÿåˆ Shrinkage åœ¨æ¯æ¬¡è¿­ä»£ä¼šå¯¹å¶å­èŠ‚ç‚¹çš„æƒæ€»ä¹˜ä»¥ä¸€ä¸ªç³»æ•°ï¼Œè®©åé¢çš„æ ‘æœ‰æ›´å¤§çš„å­¦ä¹ ç©ºé—´ã€‚ Custom Loss Function Missing Values LightGBM parameter tuning","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Machine Learning","slug":"Technical-Notes/Machine-Learning","permalink":"http://qfxiao.me/categories/Technical-Notes/Machine-Learning/"}],"tags":[{"name":"GBDT","slug":"GBDT","permalink":"http://qfxiao.me/tags/GBDT/"},{"name":"XGBoost","slug":"XGBoost","permalink":"http://qfxiao.me/tags/XGBoost/"}]},{"title":"Unsupervised Representation Learning by Predicting Random Distances","slug":"Unsupervised-Representation-Learning-by-Predicting-Random-Distances","date":"2020-08-24T08:17:36.000Z","updated":"2020-08-24T10:25:42.220Z","comments":true,"path":"2020/08/24/Unsupervised-Representation-Learning-by-Predicting-Random-Distances/","link":"","permalink":"http://qfxiao.me/2020/08/24/Unsupervised-Representation-Learning-by-Predicting-Random-Distances/","excerpt":"","text":"Introduction é’ˆå¯¹é«˜ç»´è¡¨æ ¼æ•°æ®çš„è¡¨ç¤ºå­¦ä¹ ï¼Œä½œè€…æå‡ºäº†åŸºäºé¢„æµ‹é¢„è®¡å˜æ¢åçš„è·ç¦»çš„æ— ç›‘ç£è¡¨ç¤ºå­¦ä¹ æ¡†æ¶RDPï¼Œå¹¶è¿›è¡Œäº†ç†è®ºä¸Šçš„è®¨è®ºã€‚To be finished... è®ºæ–‡åœ°å€ ä»£ç åœ°å€ Proposed Method Random Distance Prediction Model å¯¹äºå¾ˆå¤šä¸‹æ¸¸ä»»åŠ¡æ¥è¯´ï¼Œé«˜ç»´æ•°æ®å¯¹æ¨¡å‹æ•ˆç‡å’Œæ€§èƒ½éƒ½å¾ˆå¤§ï¼Œæ‰€ä»¥å­¦ä¹ ä½ç»´çš„æœ‰æ„ä¹‰ï¼ˆèƒ½å¤Ÿæœ€å¤§é™åº¦ä¿å­˜åŸå§‹ç©ºé—´çš„ä¿¡æ¯ï¼‰çš„è¡¨ç¤ºååˆ†é‡è¦ã€‚æœ¬æ–‡çš„å¤§è‡´æ€æƒ³æ˜¯ç»™å®šä¸€ä¸ªç¡®å®šçš„éšæœºæ˜ å°„å°†æ ·æœ¬æ˜ å°„åˆ°ä¸€ä¸ªæ–°çš„ç©ºé—´ï¼Œç„¶åæ„é€ æ•°æ®é›†ï¼Œè¾“å…¥æ—¶ä»»æ„ä¸€å¯¹æ ·æœ¬ï¼Œæ ‡ç­¾æ˜¯ä¸¤ä¸ªæ ·æœ¬åœ¨æ–°çš„ç©ºé—´çš„è·ç¦»ï¼Œä¹‹åè®­ç»ƒä¸€ä¸ªæ¨¡å‹æ¥å­¦ä¹ è¿™ä¸ªè·ç¦»ã€‚ä½œè€…è®¤ä¸ºé€šè¿‡è¯¥ä»»åŠ¡çš„è®­ç»ƒï¼Œæ¨¡å‹èƒ½å¤Ÿå­¦åˆ°æœ‰æ„ä¹‰çš„ä½ç»´è¡¨ç¤ºã€‚æ¨¡å‹çš„æ¡†æ¶å¦‚ä¸‹å›¾ï¼š å…¶ä¸­\\(\\phi(\\mathbf x;\\Theta):\\mathbb R^D\\mapsto\\mathbb R^M\\)ä¸ºå­ªç”Ÿç¥ç»ç½‘ç»œï¼ˆSiamese Neural Networkï¼‰ï¼Œå°†æ•°æ®æ˜ å°„åˆ°\\(M\\)çš„æ–°ç©ºé—´ã€‚æŸå¤±å‡½æ•°ä¸ºï¼š \\[ \\mathcal L_{rdp}(\\mathbf x_i,\\mathbf x_j)=l(\\langle \\phi(\\mathbf x_i;\\Theta),\\phi(\\mathbf x_j;\\Theta)\\rangle,\\langle\\eta(\\mathbf x_i),\\eta(\\mathbf x_j)\\rangle) \\] å…¶ä¸­\\(\\eta(\\cdot)\\)ä¸ºå·²çŸ¥çš„æ˜ å°„ï¼Œ\\(l(\\cdot)\\)ä¸ºè¡¡é‡ä¸¤ä¸ªè¾“å…¥ç›¸ä¼¼ç¨‹åº¦çš„åº¦é‡ã€‚å…·ä½“çš„æ¥è¯´ï¼Œæ–‡ä¸­é€‰å–äº†ç®€å•çš„å®ç°æ–¹æ¡ˆï¼Œå³é‡‡ç”¨å†…ç§¯ä½œä¸ºæ˜ å°„åçš„æ ·æœ¬çš„è·ç¦»åº¦é‡ï¼š \\[ \\mathcal L_{rdp}(\\mathbf x_i,\\mathbf x_j)=\\left(\\phi(\\mathbf x_i;\\Theta)\\cdot\\phi(\\mathbf x_j;\\Theta)-\\eta(\\mathbf x_i)\\cdot\\eta(\\mathbf x_j)\\right)^2 \\] \\(\\eta(\\cdot)\\)ä¸ºç°æˆçš„æ˜ å°„ã€‚è‡³äºä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Œå¯ä»¥å…ˆæ¥ç€çœ‹ä¸‹é¢åŸæ–‡ç»™å‡ºçš„ç†è®ºåˆ†æï¼Œç„¶åæˆ‘å†è¯´è¯´æˆ‘è‡ªå·±çš„ç†è§£ã€‚ Incorporating Task-Dependent Complementary Auxiliary Loss å¯¹äºç‰¹å®šçš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œä½œè€…æå‡ºå¯ä»¥æ•´åˆé¢å¤–çš„è¯¯å·®å‡½æ•°æ¥æé«˜æ¨¡å‹è¡Œæ€§èƒ½ã€‚æ¯”å¦‚è¯´é’ˆå¯¹èšç±»ä»»åŠ¡å¯ä»¥ä½¿ç”¨é‡æ„è¯¯å·®ï¼š \\[ \\mathcal L_{aux}^{clu}(\\mathbf x)=(\\mathbf x-\\phi^\\prime(\\phi(\\mathbf x;\\Theta); \\Theta^\\prime))^2 \\] å…¶ä¸­\\(\\phi(\\cdot)\\)å’Œ\\(\\phi^\\prime(\\cdot):\\mathbb R^M\\mapsto\\mathbb R^D\\)åˆ†åˆ«ä¸ºç¼–ç å™¨å’Œè§£ç å™¨ã€‚ å¯¹äºå¼‚å¸¸æ£€æµ‹ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹å¼ï¼š \\[ \\mathcal L_{aux}^{ad}(\\mathbf x)=(\\phi(\\mathbf x;\\Theta)-\\eta(\\mathbf x))^2 \\] è¿™ä¸€ä¸ªLossæœ¬æ¥æ˜¯å‡ºç°åœ¨å¼ºåŒ–å­¦ä¹ çš„è®ºæ–‡ä¸­ï¼Œç”¨æ¥æ£€æµ‹ä¸€ä¸ªçŠ¶æ€\\(\\mathbf x\\)å‡ºç°çš„é¢‘ç‡ï¼Œå¦‚æœé¢„æµ‹è¯¯å·®è¾ƒå°ï¼Œè¯´æ˜è¿™ä¸ªæ ·æœ¬ä¹‹å‰è§è¿‡æˆ–è§è¿‡ç±»ä¼¼çš„ï¼Œå¦åˆ™æ²¡æ€ä¹ˆè§è¿‡ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å¼‚å¸¸ã€‚ç”±äºæœ¬æ–‡çš„ç›®çš„ä¸»è¦æ˜¯é™ç»´åŠ ä¿ç•™åŸå§‹ç©ºé—´ä¿¡æ¯ï¼Œå¯ä»¥è®¤ä¸ºä½¿ç”¨çº¿æ€§å˜æ¢çš„è¯æ­¤ç›®çš„å·²ç»è¾¾åˆ°äº†ã€‚ Theoretical Analysis Using Linear Projection è¿™é‡Œè®¨è®ºä½¿ç”¨çº¿æ€§æ˜ å°„çš„æƒ…å†µï¼Œè®¾æ•°æ®é›†\\(\\mathcal X\\subset\\mathbb R^{N\\times D}\\)ï¼Œæ˜ å°„çŸ©é˜µ\\(\\mathbf A\\subset\\mathbb R^{K\\times D}\\)ä¸ºä¸€éšæœºçŸ©é˜µï¼Œæ˜ å°„ä¹‹åçš„æ•°æ®ä¸º\\(\\mathbf A\\mathcal X^\\top\\)ã€‚å¯¹äº\\(\\epsilon\\in(0,\\frac{1}{2})\\)å’Œ\\(K=\\frac{20\\log n}{\\epsilon^2}\\)ï¼Œå­˜åœ¨\\(f:\\mathbb R^D\\mapsto\\mathbb R^K\\)ä½¿å¾—å¯¹äºæ‰€æœ‰çš„\\(\\mathbf x_i,\\mathbf x_j\\in\\mathcal X\\)æœ‰ï¼š \\[ (1-\\epsilon)\\parallel\\mathbf x_i-\\mathbf x_j \\parallel^2\\leq \\parallel f(\\mathbf x_i)-f(\\mathbf x_j)\\parallel^2\\leq (1+\\epsilon)\\parallel\\mathbf x_i-\\mathbf x_j\\parallel^2 \\] å¦‚æœ\\(\\mathbf A\\)çš„æ¯ä¸ªå…ƒç´ ç‹¬ç«‹é‡‡æ ·è‡ªæ ‡å‡†æ­£æ€åˆ†å¸ƒé‚£ä¹ˆæœ‰ï¼š \\[ \\text{Pr}\\left((1-\\epsilon)\\parallel\\mathbf x\\parallel^2\\leq\\parallel\\frac{1}{\\sqrt{K}}\\mathbf A\\mathbf x\\parallel^2\\leq(1+\\epsilon)\\parallel\\mathbf x\\parallel^2\\right)\\geq 1-2e^{\\frac{-(\\epsilon^2-\\epsilon^3)K}{4}} \\] åœ¨è¯¥éšæœºæ˜ å°„ä¸‹æœ‰ï¼š \\[ \\text{Pr}(|\\hat{\\mathbf x}_i\\cdot\\hat{\\mathbf x}_j-f(\\hat{\\mathbf x}_i)\\cdot f(\\hat{\\mathbf x}_j)|\\geq\\epsilon)\\leq 4e^{\\frac{-(\\epsilon^2-\\epsilon^3)\\cdot K}{4}} \\] ç›´è§‚çš„è§£é‡Šå°±æ˜¯è¯´ä½¿ç”¨çº¿æ€§æ˜ å°„çš„æƒ…å†µä¸‹ï¼Œåªè¦ä½¿ç”¨çš„å˜æ¢çŸ©é˜µé‡‡æ ·è‡ªæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œé‚£ä¹ˆå˜æ¢ä¹‹åæ ·æœ¬å¯¹ä¹‹é—´çš„è·ç¦»ä¿¡æ¯èƒ½å¤Ÿä»¥ä¸€å®šçš„æ¦‚ç‡ä¿ç•™ã€‚ Using Non-Linear Projection è¿™é‡Œä½œè€…è¯•å›¾è¯´æ˜ï¼Œåœ¨æŸäº›æ¡ä»¶ä¸‹ï¼Œéçº¿æ€§éšæœºæ˜ å°„çš„ä½œç”¨å’Œæ ¸å‡½æ•°æ¥è¿‘ã€‚å¯¹äºä¸€ä¸ªç¡®å®šçš„éšæœºæ˜ å°„å‡½æ•°\\(g:\\mathbb R^D\\mapsto\\mathbb R^K\\)ï¼Œåœ¨æŸäº›ç‰¹å®šçš„æ¡ä»¶ä¸‹ï¼Œå‡½æ•°\\(g\\)å’Œæ ¸å‡½æ•°å­˜åœ¨ä¸‹åˆ—å…³ç³»ï¼š \\[ k(\\mathbf x_i,\\mathbf x_j)=\\langle\\psi(\\mathbf x_i),\\psi(\\mathbf x_j)\\rangle\\approx g(\\mathbf x_i)\\cdot g(\\mathbf x_j) \\] è¿™ä¸ªæ¡ä»¶æ˜¯å‡½æ•°\\(g\\)ä¸ºä¸€ä¸ªä¹˜ä»¥ä¸€ä¸ªçº¿æ€§çŸ©é˜µ\\(\\mathbf A\\)ç„¶ååœ¨ç»è¿‡ä¸€ä¸ªå…·å¤‡å¹³ç§»ä¸å˜æ€§çš„å‚…é‡Œå¶åŸºå‡½æ•°ï¼ˆå¦‚cosineï¼‰ã€‚ç”±äºæ ¸å‡½æ•°èƒ½å¤Ÿä¿ç•™åŸå§‹ç©ºé—´çš„ä¿¡æ¯ï¼Œæ‰€ä»¥ä½œè€…è®¤ä¸ºä½¿ç”¨éçº¿æ€§å‡½æ•°ä¹Ÿèƒ½ä¿ç•™åŸå§‹ç©ºé—´çš„ä¿¡æ¯ã€‚ PS: æ„Ÿè§‰ä½œè€…åœ¨ç†è®ºéƒ¨åˆ†çš„è®¨è®ºè¿˜æ˜¯æœ‰ç‚¹æ¨¡ç³Šï¼Œå› ä¸ºæŠŠä¸€ä¸ªéšæœºçš„æ˜ å°„ä½œä¸ºï¼ˆä¼ªï¼‰ç›‘ç£ä¿¡æ¯æ¥è¿›è¡Œå­¦ä¹ ï¼Œç¥ç»ç½‘ç»œå­¦åˆ°çš„ä¸ä¹Ÿå°±æ˜¯éšæœºå™ªå£°ä¿¡æ¯å—ï¼Ÿå¯¹äºè¿™ä¸ªæ–¹æ³•workçš„åŸå› ï¼Œæˆ‘åœ¨è¿™é‡Œä¸è´Ÿè´£ä»»çš„åˆ†æä¸€ä¸‹ã€‚ Learning Class Structure by Random Distance Prediction è¿™ä¸€èŠ‚ä¸»è¦è§£é‡Šä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œ\\(\\phi(\\cdot)\\)å­¦åˆ°çš„è¦æ¯”éšæœºæ˜ å°„\\(\\eta(\\cdot)\\)è¦å¥½ã€‚æ¨¡å‹çš„ä¼˜åŒ–ç›®æ ‡å¯ä»¥å†™æˆå¦‚ä¸‹çš„å½¢å¼ï¼š \\[ \\mathop{\\arg\\min}_{\\Theta}\\sum_{\\mathbf x_i,\\mathbf x_j\\in\\mathcal X}(\\phi(\\mathbf x_i;\\Theta)\\cdot\\phi(\\mathbf x_j;\\Theta)-y_{ij})^2 \\] å…¶ä¸­\\(y_{ij}=\\eta(\\mathbf x_i)\\cdot\\eta(\\mathbf x_j)\\)ã€‚è®¾\\(\\mathbf Y_\\eta\\in\\mathbb R^{N\\times N}\\)ä¸ºè·ç¦»çŸ©é˜µã€‚è¿™ä¸ªç›®æ ‡å‡½æ•°æ˜¯åœ¨æœ€å°åŒ–æ¯ä¸€å¯¹æ ·æœ¬åœ¨ç»è¿‡\\(\\phi(\\cdot)\\)å’Œ\\(\\eta(\\cdot)\\)æ˜ å°„åä¹‹é—´çš„è·ç¦»çš„å·®è·ã€‚é€šè¿‡å…¬å¼(7)å’Œå…¬å¼(8)æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨åˆé€‚çš„æ¡ä»¶ä¸‹ï¼Œéšæœºæ˜ å°„\\(\\eta(\\cdot)\\)èƒ½å¤Ÿä¿ç•™åŸå§‹ç©ºé—´çš„è·ç¦»ä¿¡æ¯ï¼ˆå³åŸå§‹ç©ºé—´ç›¸è¿‘çš„æ ·æœ¬åœ¨æ˜ å°„åä¹Ÿç›¸è¿‘ï¼‰ã€‚ä¸è¿‡ï¼Œä¸Šè¿°å…¬å¼çš„æˆç«‹éƒ½ä¾èµ–äºå¯¹æ•°æ®åˆ†å¸ƒçš„ä¸€å®šå‡è®¾ï¼Œå½“çœŸå®çš„æ•°æ®ä¸æ»¡è¶³æ¡ä»¶æ—¶ï¼Œç»“è®ºå°±ä¼šæœ‰æ‰€åå·®ã€‚ Experiments Performance Evaluation in Anomaly Detection Experimental Settings å¼‚å¸¸åˆ†æ•°å®šä¹‰ä¸º\\(\\mathcal S(\\mathbf x)=(\\phi(\\mathbf x;\\Theta)-\\eta(\\mathbf x))^2\\)ã€‚ Comparison to the State-of-the-art Competing Methods Ablation Study Performance Evaluation in Clustering Experimental Settings Comparison to the State-of-the-art Competing Methods image-20200720014002063","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Representation Learning","slug":"Research/Representation-Learning","permalink":"http://qfxiao.me/categories/Research/Representation-Learning/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Representation Learning","slug":"Representation-Learning","permalink":"http://qfxiao.me/tags/Representation-Learning/"}]},{"title":"Effective End-to-end Unsupervised Outlier Detection via Linear Priority of Discriminative Network","slug":"Effective-End-to-end-Unsupervised-Outlier-Detection-via-Linear-Priority-of-Discriminative-Network","date":"2020-07-14T10:46:13.000Z","updated":"2020-07-21T12:35:42.220Z","comments":true,"path":"2020/07/14/Effective-End-to-end-Unsupervised-Outlier-Detection-via-Linear-Priority-of-Discriminative-Network/","link":"","permalink":"http://qfxiao.me/2020/07/14/Effective-End-to-end-Unsupervised-Outlier-Detection-via-Linear-Priority-of-Discriminative-Network/","excerpt":"","text":"Introduction æœ¬æ–‡é’ˆå¯¹æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹æå‡ºäº†\\(E^3\\space{Outlier}\\)ã€‚ä½œè€…ä½¿ç”¨è‡ªç›‘ç£å­¦ä¹ çš„æ–¹æ³•ï¼Œé€šè¿‡æ„å»ºæœ‰ç›‘ç£ä»»åŠ¡åœ¨æ²¡æœ‰æ ‡ç­¾çš„æƒ…å†µä¸‹å­¦ä¹ é«˜å±‚è¯­ä¹‰ç‰¹å¾ã€‚PSï¼šè¿™ç¯‡æ–‡ç« çš„æ–¹æ³•å’ŒNIPS18ä¸Šçš„Deep Anomaly Detection Using Geometric Transformationsï¼ˆåé¢ç®€ç§°GEOMï¼‰é¢‡ä¸ºç›¸ä¼¼ï¼Œä½†æ˜¯ä¸çŸ¥ä¸ºå•¥æ²¡æœ‰åœ¨å®éªŒä¸­è¿›è¡Œæ¯”è¾ƒã€‚åé¢æˆ‘ä¼šåˆ†æä¸€äº›ä¸¤ç¯‡æ–‡ç« æ–¹æ³•ä¸Šçš„å¼‚åŒã€‚ Proposed Method Surrogate Supervision Based Effective Representation Learning for UOD è¿™é‡Œä½œè€…æåˆ°äº†ä½¿ç”¨é‡æ„çš„æ¨¡å‹æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹çš„ä¸è¶³ï¼šé‡æ„æ¨¡å‹é‡‡ç”¨åƒç´ çº§åˆ«çš„æŸå¤±å‡½æ•°ï¼ˆå¦‚mean square errorï¼‰ï¼Œè€Œè¿™å¤ªè¿‡äºä¸¥æ ¼å’Œç»†èŠ‚ï¼Œå¹¶ä¸èƒ½å­¦åˆ°é«˜å±‚è¯­ä¹‰ç‰¹å¾ã€‚ ä¸ºæ­¤ï¼Œä½œè€…æå‡ºäº†surrogate supervision based discriminative network (SSD)ã€‚å…·ä½“æ“ä½œå’ŒGEOMç±»ä¼¼ï¼Œé¦–å…ˆé¢„å®šä¹‰å¤§å°ä¸º\\(K\\)çš„å‡ ä½•å˜æ¢é›†åˆ\\(\\mathcal O=\\{O(\\cdot|y)\\}_{y=1}^K\\)ã€‚å¯¹æ¯ä¸€ä¸ªæ ·æœ¬\\(\\mathbf x\\)ï¼Œåœ¨ç»è¿‡\\(K\\)ä¸ªé›†åˆå˜æ¢ä¹‹åä¼šå¾—åˆ°\\(K\\)ä¸ªå˜æ¢åçš„æ ·æœ¬ï¼ˆç¬¬\\(y\\)ä¸ªå˜æ¢äº§ç”Ÿçš„æ ·æœ¬å³è®°ä¸º\\(\\mathbf x^{(y)}=O(\\mathbf x|y)\\)ï¼‰ï¼Œæ¯ä¸ªæ ·æœ¬å¯¹åº”çš„pseudo labelå³ä¸ºå˜æ¢çš„åºå·æˆ–è€…è¯´ç§ç±»ã€‚ä¹‹ååœ¨æ–°çš„æ•°æ®é›†ä¸Šï¼ˆå¤§å°ä¸ºåŸæ¥çš„\\(K\\)å€ï¼‰è®­ç»ƒ\\(K\\)åˆ†ç±»ç½‘ç»œã€‚ç½‘ç»œçš„è¾“å‡ºä¸º\\(P(\\mathbf x^{(y^\\prime)}|\\boldsymbol\\theta)=[P^{(y)}(\\mathbf x^{(y^\\prime)}|\\boldsymbol\\theta)]_{y=1}^K\\)ï¼Œæ¯ä¸ªç»´åº¦ä»£è¡¨è¾“å…¥æ ·æœ¬å¯¹åº”çš„å˜æ¢çš„æ¦‚ç‡ã€‚æ€»çš„æŸå¤±å‡½æ•°ä¸ºï¼š \\[ \\min_\\theta\\frac{1}{N}\\sum_{i=1}^{N}\\mathcal L_{SS}(\\mathbf x_i|\\theta) \\] å…¶ä¸­\\(\\mathcal L_{SS}(\\mathbf x_i|\\theta)\\)ä»£è¡¨æ¯ä¸ªæ ·æœ¬å¯¹åº”çš„Lossï¼Œè¿™ä¸ªLosså¯ä»¥ç”±åˆ†ç±»å™¨åœ¨\\(K\\)ä¸ªå˜æ¢ä¸Šçš„äº¤å‰ç†µæŸå¤±æ¥ç¡®å®šï¼š \\[ \\mathcal L_{SS}(\\mathbf x_i|\\boldsymbol\\theta)=-\\frac{1}{K}\\sum_{y=1}^K\\log(P^{(y)}(\\mathbf x_i^{(y)}|\\boldsymbol\\theta))=-\\frac{1}{K}\\sum_{y=1}^K\\log(P^{(y)}(O(\\mathbf x_i|y)|\\boldsymbol\\theta)) \\] å˜æ¢é›†åˆ\\(\\mathcal O\\)ç”±ä¸€ç³»åˆ—åŸºæœ¬å˜æ¢çš„ç»„åˆç¡®å®šã€‚ä½œè€…å°†è¿™äº›åŸºæœ¬å˜æ¢åˆ†ä¸ºäº†ï¼š1) æ—‹è½¬ 2) ç¿»è½¬ 3) å¹³ç§»ï¼ŒåŒ…æ‹¬æ¨ªå‘å’Œçºµå‘ 4) Patchç½®æ¢ï¼ˆå‚è€ƒå›¾1(a)ä¸­çš„Patch Re-arrangingï¼‰ã€‚æœ€ç»ˆçš„å˜æ¢é›†åˆ\\(\\mathcal O\\)ç”±ä¸‰ä¸ªå­é›†ç»„æˆï¼Œåˆ†åˆ«æ˜¯\\(\\mathcal O_{RA}\\)ï¼ˆä»£è¡¨Regular Affineï¼Œå…¶ä¸­æ¯ä¸ªå˜æ¢ä¸ºæ—‹è½¬\\(90Â°\\)çš„å€æ•°ã€ç¿»è½¬ã€æ¨ªå‘å¹³ç§»å’Œçºµå‘å¹³ç§»è¿™å››ä¸ªåŸºæœ¬å˜æ¢çš„å åŠ ï¼‰ï¼Œ\\(\\mathcal O_{IA}\\)ï¼ˆä»£è¡¨Irregular Affineï¼Œå…¶ä¸­æ¯ä¸ªå˜æ¢ä¸ºè¿›è¡Œ\\(30Â°\\)çš„å€æ•°ä¸”ä¸ä¸º\\(90Â°\\)çš„å€æ•°è§’åº¦çš„æ—‹è½¬ã€ç¿»è½¬è¿™ä¸¤ä¸ªåŸºæœ¬å˜æ¢çš„å åŠ ï¼‰å’Œ\\(\\mathcal O_{PR}\\)ï¼ˆåªåŒ…å«Patch Re-arrangingï¼‰ã€‚ ä¸ºäº†éªŒè¯SSDå­¦åˆ°çš„ç‰¹å¾çš„æœ‰æ•ˆæ€§ï¼Œä½œè€…å°†CAEæå–çš„ç‰¹å¾å’ŒSSDæå–çš„ç‰¹å¾åˆ†åˆ«ç”¨å­¤ç«‹æ£®æ—è¿›è¡Œå¼‚å¸¸æ£€æµ‹ï¼Œå‘ç°SSDæ•ˆæœæ›´å¥½ï¼ˆè§å›¾1(b)ï¼‰ã€‚ åˆ°è¿™é‡Œä¸ºæ­¢æœ¬æ–‡å’ŒGEOMåŸºæœ¬æ²¡æœ‰å¤§çš„åŒºåˆ«ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯åœ¨æ‰€é‡‡ç”¨çš„å‡ ä½•å˜æ¢ä¸­ï¼Œé‡‡ç”¨äº†éçº¿æ€§å˜æ¢ï¼ˆè¿›è¡Œ\\(30Â°\\)çš„å€æ•°ä¸”ä¸ä¸º\\(90Â°\\)çš„å€æ•°è§’åº¦çš„æ—‹è½¬ï¼‰ã€‚è€Œåœ¨GEOMä¸­ï¼Œæåˆ°è¿‡ä½¿ç”¨éçº¿æ€§å˜æ¢çš„è¯æ•ˆæœä¼šæ¯”è¾ƒå·®ï¼Œè‡³äºå…·ä½“çš„å½±å“å¦‚ä½•ï¼Œå¯èƒ½éœ€è¦å®éªŒæ¥ç¡®å®šã€‚ Inlier Priority: The Foundation of End-to-end UOD åœ¨è¿™é‡Œä½œè€…ä¸»è¦å¯¹åœ¨è®­ç»ƒé›†åŒ…å«å°‘é‡å¼‚å¸¸çš„æƒ…å†µä¸‹åšå‡ºçš„ç†è®ºåˆ†æï¼Œä½œè€…å°†å…¶ç§°ä¸ºInlier Priorityï¼ŒåŸå¥å¦‚ä¸‹ï¼š Inlier Priority: Despite that inliers/outliersare indiscriminately fed into SSD for training, SSD will prioritize the minimization of inliersâ€™ loss. Priority by Gradient Magnitude å¯¹äºç¬¬\\(c\\)ä¸ªç±»æ¥è¯´ï¼Œè®¾softmaxå±‚å’Œå€’æ•°ç¬¬äºŒå±‚ä¹‹é—´çš„æƒé‡çŸ©é˜µä¸º\\(\\mathbf w_c=[w_{s,c}]^{(L+1)}_{s=1}\\)ï¼ŒæŸå¤±å‡½æ•°è®°ä¸º\\(\\mathcal L\\)ï¼Œæ¢¯åº¦è®°ä¸º\\(\\nabla_{\\mathbf w_c}\\mathcal L=[\\nabla_{w_{s,c}}\\mathcal L]^{(L+1)}_{s=1}\\)ã€‚è®¾è®­ç»ƒé›†\\(X^{(c)}\\)åŒ…å«\\(N_{in}\\)ä¸ªæ­£å¸¸æ ·æœ¬ï¼Œ\\(N_{out}\\)ä¸ªå¼‚å¸¸æ ·æœ¬ã€‚è®°æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬å¯¹åº”çš„æ¢¯åº¦åˆ†åˆ«ä¸º\\(\\parallel\\nabla^{(in)}_{\\mathbf w_c}\\mathcal L\\parallel\\)å’Œ\\(\\parallel\\nabla^{(out)}_{\\mathbf w_c}\\mathcal L\\parallel\\)ï¼Œåœ¨ç½‘ç»œåªæœ‰ä¸€ä¸ªéšå±‚ä¸”é‡‡ç”¨Sigmoidä½œä¸ºæ¿€æ´»å‡½æ•°æ—¶ï¼Œä¸¤è€…æ¢¯åº¦çš„æœŸæœ›ä¹‹æ¯”æœ‰å¦‚ä¸‹å…³ç³»ï¼š \\[ \\frac{E(\\parallel\\nabla^{(in)}_{\\mathbf w_c}\\mathcal L\\parallel^2)}{E(\\parallel\\nabla^{(out)}_{\\mathbf w_c}\\mathcal L\\parallel^2)}\\approx\\frac{N^2_{in}}{N^2_{out}} \\] åœ¨è®­ç»ƒé›†ä¸­ï¼Œæ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬çš„æ•°é‡æ˜¯æä¸å‡è¡¡çš„ï¼Œ\\(N_{in}\\gg N_{out}\\)ï¼Œæ‰€ä»¥æœ‰\\(E(\\parallel\\nabla^{(in)}_{\\mathbf w_c}\\mathcal L\\parallel^2)\\gg E(\\parallel\\nabla^{(out)}_{\\mathbf w_c}\\mathcal L\\parallel^2)\\)ã€‚ åœ¨ä½¿ç”¨æ›´å¤æ‚çš„ç½‘ç»œæ—¶ï¼Œä½œè€…é€šè¿‡å®éªŒå±•ç¤ºäº†æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬å¯¹åº”çš„æ¢¯åº¦å¤§å°çš„æ¯”è¾ƒï¼š Priority by Network Updating Direction è¿™é‡Œä½œè€…é€šè¿‡æ¢¯åº¦æ›´æ–°çš„æ–¹å‘æ¥è¿›è¡Œäº†ç†è®ºä¸Šçš„è§£é‡Šã€‚å¯¹äºä¸€ä¸ªBatchçš„æ•°æ®\\(X\\)ï¼Œæ¢¯åº¦ä¸º\\(-\\nabla_\\theta\\mathcal L(X)=-\\frac{1}{N}\\sum_i\\nabla_\\theta\\mathcal L(\\mathbf x_i)\\)ï¼Œå¦‚æœå°†è¯¥æ¢¯åº¦åœ¨Batchä¸­æŸä¸€æ ·æœ¬\\(\\mathbf x_i\\)å¯¹åº”çš„æ¢¯åº¦çš„æ–¹å‘ä¸Šè¿›è¡Œåˆ†è§£\\(-\\nabla_\\theta\\mathcal L(\\mathbf x_i):d_i=-\\nabla_\\theta\\mathcal L(X)\\cdot\\frac{-\\nabla_\\theta\\mathcal L(\\mathbf x_i)}{\\parallel -\\nabla_\\theta\\mathcal L(\\mathbf x_i)\\parallel}\\)ï¼Œè¿™ä»£è¡¨äº†æ€»çš„Lossåœ¨å¤šå¤§ç¨‹åº¦ä¸Šå‡å°æ ·æœ¬\\(\\mathbf x_i\\)å¯¹åº”çš„Lossï¼Œç”±äºä¸€ä¸ªBatchå³åŒ…å«æ­£å¸¸æ ·æœ¬ï¼Œä¹Ÿå¯èƒ½åŒ…å«å¼‚å¸¸æ ·æœ¬ï¼Œæ‰€ä»¥ä½œè€…å°†ä¸¤è€…å¯¹åº”çš„æ¢¯åº¦æ–¹å‘è´¡çŒ®è¿›è¡Œäº†å¯è§†åŒ–ï¼š å¯ä»¥çœ‹åˆ°éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œæ­£å¸¸æ ·æœ¬å¯¹åº”çš„è´¡çŒ®æ›´é«˜ã€‚ PS: æˆ‘ä»¥ä¸ºä½œè€…ä¼šå¯¹åŸºäºå‡ ä½•å˜æ¢çš„å¼‚å¸¸æ£€æµ‹ä¸ºä»€ä¹ˆæœ‰æ•ˆåšä¸€äº›ç†è®ºä¸Šçš„è§£é‡Šï¼Œä¸è¿‡å´æ²¡æœ‰ã€‚è¿™é‡Œåªæ˜¯å¯¹åœ¨è®­ç»ƒé›†åŒ…å«å°‘é‡å¼‚å¸¸çš„æƒ…å†µä¸‹åšå‡ºçš„ç†è®ºåˆ†æï¼Œè€Œè¿™ä¸ªå®é™…ä¸Šç›´è§‰ä¸Šå°±å¾ˆæ˜¾ç„¶äº†ã€‚ Scoring Strategies for UOD ä½œè€…é‡‡ç”¨äº†ä¸‰ç§æ–¹æ³•æ¥è®¡ç®—å¼‚å¸¸åˆ†æ•°ï¼š Pseudo Label based Score (PL) å¯¹äºä¸€ä¸ªæµ‹è¯•æ ·æœ¬\\(\\mathbf x\\)ï¼Œå¯¹å…¶è¿›è¡Œ\\(K\\)ä¸ªå‡ ä½•å˜æ¢ï¼Œé€šè¿‡åˆ†ç±»å™¨ä¼šå¾—åˆ°\\(K\\)ä¸ªè¾“å‡ºï¼Œå¯¹äºç¬¬\\(k\\)ä¸ªè¾“å‡ºï¼Œæˆ‘ä»¬åªå–å…¶ç¬¬\\(k\\)ä¸ªåˆ†é‡ï¼Œæœ€åæŠŠä»–ä»¬åŠ èµ·æ¥é™¤ä»¥\\(K\\)ï¼š \\[ S_{pl}(\\mathbf x)=\\frac{1}{K}\\sum_{y=1}^K P^{(y)}(\\mathbf x^{(y)}|\\boldsymbol\\theta) \\] Maximum Probability based Score (MP) è¿™é‡Œç¨æœ‰ä¸åŒï¼Œå¯¹äºç¬¬\\(k\\)ä¸ªè¾“å‡ºï¼Œæˆ‘ä»¬å–å…¶å€¼æœ€å¤§çš„åˆ†é‡ï¼Œè€Œä¸æ˜¯ç¬¬\\(k\\)ä¸ªåˆ†é‡ï¼š \\[ S_{mp}(\\mathbf x)=\\frac{1}{K}\\sum_{y=1}^K\\max_t P^{(t)}(\\mathbf x^{(y)}|\\boldsymbol\\theta) \\] Negative Entropy based Score (NE) ä½œè€…è®¤ä¸ºï¼Œæ ‡ç­¾ä¸ºOne-Hotå‘é‡ï¼Œåˆ†ç±»å™¨çš„è¾“å‡ºåˆ†å¸ƒè¶Šâ€œå°–å³°â€å°±è¶Šæ¥è¿‘äºæ­£å¸¸æ ·æœ¬ï¼Œè€Œè¶Šâ€œå¹³å‡â€å°±è¶Šæ¥è¿‘äºå¼‚å¸¸æ ·æœ¬ï¼Œæ‰€ä»¥ä½œè€…æå‡ºä½¿ç”¨ç†µæ¥æè¿°åˆ†ç±»å™¨è¾“å‡ºçš„â€œå°–é”åº¦â€ï¼š \\[ S_{ne}(\\mathbf x)=-\\frac{1}{K}\\sum_{y=1}^K H(P(\\mathbf x^{(y)}|\\boldsymbol\\theta))=\\frac{1}{K}\\sum_{y=1}^K\\sum_{t=1}^K P^{(t)}(\\mathbf x^{(y)}|\\boldsymbol\\theta)\\log(P^{(t)}(\\mathbf x^{(y)}|\\boldsymbol\\theta)) \\] è¿™é‡Œä½œè€…å¯¹ç¬¬ä¸€ç§æ–¹æ³•å¾—åˆ°çš„ç»“æœè¿›è¡Œäº†å¯è§†åŒ–ï¼š PSï¼šå¯¹æ¯”NIPS18 çš„Dirichlet Normality Score ä¹Ÿç”¨åˆ°äº†å…¨éƒ¨\\(K\\)ä¸ªç»´åº¦çš„ä¿¡æ¯ ç›¸å½“äºå¯¹åˆ†ç±»å™¨çš„è¾“å‡ºåšäº†è¿ªåˆ©å…‹é›·åˆ†å¸ƒçš„å…ˆéªŒå‡è®¾ï¼Œç„¶åé€šè¿‡è®­ç»ƒé›†çš„è¾“å‡ºä¼°è®¡åˆ†å¸ƒå‚æ•°ã€‚å› ä¸ºç›´è§‰ä¸Šå¯¹äºæ­£å¸¸åˆ†å¸ƒæ¥è¯´ï¼Œåˆ†ç±»å™¨çš„è¾“å‡ºåˆ†å¸ƒå½¢çŠ¶ä¸Šéƒ½ç±»ä¼¼ä¸€ä¸ªå°–å³°ï¼Œä½†å¯¹äºä¸åŒçš„æ•°æ®é›†æ¥è¯´å…·ä½“å½¢çŠ¶è¿˜æ˜¯ä¼šæœ‰æ‰€å·®å¼‚ Experiments Experiment Setup æ•°æ®é›†ç”¨åˆ°äº†MNIST, Fashion-MNIST (F-MNIST) , CIFAR10, SVHNå’ŒCIFAR100ã€‚ä¸ºäº†æ¨¡æ‹Ÿæ— ç›‘ç£å¼‚å¸¸æ£€æµ‹çš„ç¯å¢ƒï¼Œäººä¸ºåœ¨è®­ç»ƒé›†ä¸­åŠ å…¥å¼‚å¸¸æ ·æœ¬ï¼Œå¼‚å¸¸çš„æ¯”ä¾‹\\(\\rho\\)ä»\\(5\\%\\)åˆ°\\(25\\%\\)ä»¥\\(5\\%\\)çš„æ­¥é•¿é€’å¢ã€‚è¯„æµ‹æ ‡å‡†é‡‡ç”¨AUPRå’ŒAUROCã€‚ UOD Performance Comparison and Discussion ä¸‹è¡¨å±•ç¤ºäº†æ¨¡å‹æ€§èƒ½å¯¹æ¯”ç»“æœï¼š ä¸‹å›¾å±•ç¤ºäº†åœ¨ä¸åŒçš„Outlier Ratioä¸‹çš„æ€§èƒ½å¯¹æ¯”ï¼š ä¸‹å›¾å±•ç¤ºäº†åœ¨ä¸åŒçš„å˜æ¢é›†åˆï¼Œç½‘ç»œç»“æ„ï¼Œå¼‚å¸¸åˆ†æ•°çš„æ¡ä»¶ä¸‹çš„æ€§èƒ½ï¼š","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Self-Supervised Learning","slug":"Self-Supervised-Learning","permalink":"http://qfxiao.me/tags/Self-Supervised-Learning/"}]},{"title":"PRML Notes 1.1: Probability Distributions - Binary and Multinomial Variables","slug":"PRML-Notes-1-1-Probability-Distributions-Binary-and-Multinomial-Variables","date":"2020-06-22T05:43:58.000Z","updated":"2020-06-27T10:19:50.637Z","comments":true,"path":"2020/06/22/PRML-Notes-1-1-Probability-Distributions-Binary-and-Multinomial-Variables/","link":"","permalink":"http://qfxiao.me/2020/06/22/PRML-Notes-1-1-Probability-Distributions-Binary-and-Multinomial-Variables/","excerpt":"","text":"Overview è¿™æ˜¯PRML (Pattern Recognition and Machine Learning) ç¬¬äºŒç« Probability Distributionsç¬”è®°çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œä¸»è¦åŒ…æ‹¬2.1. Binary Variableså’Œ2.2. Multinomial Variablesè¿™ä¸¤èŠ‚ã€‚ Probability Distributions for Binary Variables Intro è¿™ä¸€èŠ‚ä¸»è¦é’ˆå¯¹äºŒå€¼éšæœºå˜é‡çš„å»ºæ¨¡ï¼Œå³\\(x\\in\\{0,1\\}\\)ã€‚è¿™é‡Œå¯ä»¥æƒ³è±¡ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªç¡¬å¸ï¼Œ\\(x=1\\)ä»£è¡¨æ­£é¢æœä¸Šï¼Œè€Œ\\(x=0\\)ä»£è¡¨åé¢æœä¸Šï¼Œå¹¶ä¸”æ­£é¢æœä¸Šçš„æ¦‚ç‡ä¸º\\(\\mu\\)ï¼Œå³ï¼š \\[ p(x=1|\\mu)=\\mu \\] å…¶ä¸­\\(0\\leqslant \\mu \\leqslant 1\\)ã€‚\\(x\\)çš„æ¦‚ç‡åˆ†å¸ƒå¯ä»¥å†™ä¸ºï¼š \\[ \\text{Bern}(x|\\mu)=\\mu^x(1-\\mu)^{1-x} \\] ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„ä¼¯åŠªåˆ©åˆ†å¸ƒ (Bernoulli Distribution)ã€‚å…¶å‡å€¼å’Œæ–¹å·®åˆ†åˆ«ä¸ºï¼š \\[ \\begin{align} \\mathbb E[x]&amp;=\\mu\\\\ \\text{var}[x] &amp;= \\mu(1-\\mu) \\end{align} \\] ç°åœ¨æ¥è€ƒè™‘å‚æ•°ä¼°è®¡ä»»åŠ¡ã€‚å‡è®¾æˆ‘ä»¬æ­£åœ¨è¿›è¡Œä¸€ä¸ªæŠ•ç¡¬å¸çš„å®éªŒï¼Œæ¯ä¸€æ¬¡æŠ•å¸éƒ½æœä»ä¼¯åŠªåˆ©åˆ†å¸ƒä¸”ç›¸äº’ç‹¬ç«‹ï¼Œæˆ‘ä»¬å°†æ¯æ¬¡é‡‡é›†åˆ°çš„è§‚æµ‹å€¼ç»„æˆæ•°æ®é›†\\(\\mathcal D=\\{x_1,\\cdots,x_N\\}\\)ï¼Œåˆ™ä¼¼ç„¶å‡½æ•°ä¸ºï¼š \\[ p(\\mathcal D|\\mu)=\\prod_{n=1}^N p(x_n|\\mu)=\\prod_{n=1}^N \\mu^{x_n}(1-\\mu)^{1-x_n} \\] å¦‚æœé‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°ï¼Œè¿™ç­‰ä»·äºæœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶ï¼š \\[ \\ln p(\\mathcal D|\\mu)=\\sum_{n=1}^{N}\\ln p(x_n|\\mu)=\\sum_{n=1}^N\\{x_n\\ln\\mu+(1-x_n)\\ln(1-\\mu)\\} \\] ä»¤å…¶å¯¼æ•°ä¸º0å¾—åˆ°æå€¼ç‚¹ï¼š \\[ \\mu_{ML}=\\frac{1}{N}\\sum_{n=1}^N x_n \\] è¿™ç›¸å½“äºæ ·æœ¬å‡å€¼ï¼Œä¸è¿‡è¿™æ ·åšä¼šæœ‰ä¸¥é‡çš„é—®é¢˜ã€‚å‡è®¾æˆ‘ä»¬çš„æ•°æ®é›†ä¸º\\(\\mathcal D=\\{1,1,1\\}\\)ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªæ”¶é›†åˆ°äº†ä¸‰ä¸ªæ ·æœ¬ï¼Œå¹¶ä¸”éƒ½æ˜¯æ­£ä¾‹ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°\\(\\mu_{ML}=1\\)ï¼Œè€Œè¿™æ˜¾ç„¶æ˜¯ä¸¥é‡è¿‡æ‹Ÿåˆçš„ã€‚ç¨åæˆ‘ä»¬ä¼šè¯´è¯´å¦‚ä½•åº”å¯¹è¿™ç§æƒ…å†µï¼ˆåŠ å…¥å…ˆéªŒï¼‰ã€‚ Binomial Distribution æˆ‘ä»¬åŒæ ·å¯ä»¥å¯¹å¤šæ¬¡ä¼¯åŠªåˆ©å®éªŒè¿›è¡Œæ¦‚ç‡å»ºæ¨¡ã€‚è®°\\(m\\)ä¸ºæˆåŠŸçš„æ¬¡æ•°ï¼Œ\\(N\\)ä¸ºæ•°æ®é›†å¤§å°ï¼Œå¯çŸ¥è¿™ä¸ªæ¦‚ç‡åº”è¯¥ä¸\\(\\mu^m(1-\\mu)^{N-m}\\)æˆæ­£æ¯”ã€‚ä¹˜ä»¥æ ‡å‡†åŒ–ç³»æ•°åå³æˆ‘ä»¬ç†ŸçŸ¥çš„äºŒé¡¹åˆ†å¸ƒ (Binomial Distribution)ï¼š \\[ \\text{Bin}(m|N,\\mu)=\\binom{N}{m}\\mu^m(1-\\mu)^{N-m} \\] å…¶ä¸­ï¼š \\[ \\binom{N}{m}=\\frac{N!}{(N-m)!m!} \\] å…¶å‡å€¼å’Œæ–¹å·®åˆ†åˆ«ä¸ºï¼š \\[ \\begin{align} \\mathbb E[m]&amp;=N\\mu\\\\ \\text{var}[m]&amp;=N\\mu(1-\\mu) \\end{align} \\] Beta Distribution ç°åœ¨æˆ‘ä»¬æ¥è®¨è®ºå¦‚ä½•è§£å†³åˆšæ‰æåˆ°çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡è¿‡æ‹Ÿåˆé—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨è´å¶æ–¯çš„æ€è·¯ï¼Œå¯¹\\(\\mu\\)å¼•å…¥äº†å…ˆéªŒåˆ†å¸ƒ\\(p(\\mu)\\)ã€‚è€Œè¿™ä¸ªåˆ†å¸ƒéœ€è¦å…·æœ‰è‰¯å¥½çš„è§£é‡Šæ€§å’Œæ•°å­¦æ€§è´¨ã€‚ æ ¹æ®è´å¶æ–¯å®šç†ï¼š \\[ p(\\mu|\\mathcal D)=\\frac{p(\\mathcal D|\\mu)p(\\mu)}{p(\\mathcal D)} \\] è€Œ\\(p(\\mathcal D)=\\int_0^1 p(\\mathcal D|\\mu)p(\\mu)\\mathrm d\\mu\\)åªå—æ•°æ®é›†å½±å“ï¼Œè€Œæ•°æ®é›†æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ä¸ºå¸¸æ•°ï¼Œå› æ­¤\\(p(\\mu|\\mathcal D)\\propto p(\\mathcal D|\\mu)p(\\mu)\\)ã€‚è€Œä¼¼ç„¶å‡½æ•°ä¸º\\(\\mu^x(1-\\mu)^{1-x}\\)çš„ä¹˜ç§¯ï¼Œå¦‚æœå…ˆéªŒä¹Ÿé‡‡ç”¨\\(\\mu\\)å’Œ\\(1-\\mu\\)çš„å¹‚çš„ä¹˜ç§¯çš„å½¢å¼ï¼Œé‚£ä¹ˆåéªŒåˆ†å¸ƒä¹Ÿå°†å’Œå…ˆéªŒå½¢å¼ç›¸åŒï¼Œè¿™ç§æ€§è´¨åœ¨ç»Ÿè®¡å­¦ä¸­è¢«ç§°ä¸ºå…ˆéªŒå…±è½­ (conjugacy)ã€‚ è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç»™å‡ºè¿™ä¸ªå…ˆéªŒåˆ†å¸ƒï¼Œå†æ¥åˆ†æå®ƒçš„æ€§è´¨ã€‚è¿™ä¸ªåˆ†å¸ƒå«åšBetaåˆ†å¸ƒ (Beta Distribution)\\(P(\\mu|a,b)\\sim \\text{Beta}(a,b)\\)ï¼š \\[ \\begin{align} \\text{Beta}(\\mu|a,b) &amp;= \\frac{\\Gamma(a+b)}{\\Gamma(a\\Gamma(b)}\\mu^{a-1}(1-\\mu)^{b-1}\\\\ &amp;= \\frac{1}{B(a,b)}\\mu^{a-1}(1-\\mu)^{b-1} \\end{align} \\] \\(B(\\boldsymbol \\alpha,\\beta)\\)ç§°ä¸ºBå‡½æ•°ï¼Œä¸ºä¸€ä¸ªæ ‡å‡†åŒ–å‡½æ•°ï¼š \\[ \\begin{align} B(a,b) = \\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)} \\end{align} \\] å…¶ç›®çš„æ˜¯ä¸ºäº†ä½¿æ•´ä¸ªæ¦‚ç‡åˆ†å¸ƒç§¯åˆ†ç­‰äº1è€Œå­˜åœ¨çš„ã€‚Gammaå‡½æ•°çš„å®šä¹‰ä¸ºï¼š \\[ \\Gamma(x)=\\int_0^{\\infty}s^{x-1}e^{-s}\\mathrm d s \\] Gammaå‡½æ•°æœ‰ä¸€ä¸ªæ€§è´¨ï¼š \\[ \\Gamma(x+1)=x\\Gamma(x) \\] è¯æ˜ä¸ºï¼š \\[ \\begin{align*} \\Gamma(x+1) &amp;= \\int_{0}^{\\infty} {s^{x} e^{-s} ds} \\\\ &amp;= \\big[s^{x} (-e^{-s})\\big] \\big|_{0}^{\\infty} - \\int_{0}^{\\infty} {(x s^{x-1}) (-e^{-s}) ds} \\\\ &amp;= (0 - 0) + x \\int_{0}^{\\infty} {s^{x-1} e^{-s} ds} \\\\ &amp;= x \\Gamma(x) \\end{align*} \\] é™¤æ­¤ä¹‹å¤–ï¼š \\[ \\Gamma(1)=1\\\\ \\Gamma(\\frac{1}{2})=\\sqrt{\\pi} \\] å¯ä»¥éªŒè¯ï¼š \\[ \\int_0^1\\text{Beta}(\\mu|a,b)\\mathrm d\\mu=1 \\] Betaåˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ä¸ºï¼š \\[ \\mathbb E[\\mu]=\\frac{a}{a+b}\\\\ \\text{var}[\\mu]=\\frac{ab}{(a+b)^2(a+b+1)} \\] å› ä¸ºåéªŒåˆ†å¸ƒä¸å…ˆéªŒå’Œä¼¼ç„¶å‡½æ•°çš„ä¹˜ç§¯æˆæ¯”ä¾‹ï¼Œé‚£ä¹ˆï¼š \\[ p(\\mu|m,l,a,b)\\propto\\mu^{m+a-1}(1-\\mu)^{l+b-1} \\] å…¶ä¸­\\(l=N-m\\)ã€‚ä¹˜ä¸Šæ ‡å‡†åŒ–å› å­ï¼Œå°±å¾—åˆ°ï¼š \\[ p(\\mu|m,l,a,b)=\\frac{\\Gamma(m+a+l+b)}{\\Gamma(m+a)\\Gamma(l+b)}\\mu^{m+a-1}(1-\\mu)^{l+b-1} \\] å¾—åˆ°çš„ä»ç„¶æ˜¯Betaåˆ†å¸ƒï¼Œç›¸å½“äºæŠŠ\\(a\\rightarrow{m+a}\\)ï¼Œ\\(b\\rightarrow{l+b}\\)ã€‚åŒæ—¶ä¸éš¾å‘ç°ï¼Œå‚æ•°\\(a\\)å’Œ\\(b\\)éƒ½æœ‰æ¯”è¾ƒç›´è§‚çš„æ„ä¹‰ã€‚\\(a\\)å¯ä»¥çœ‹ä½œæ˜¯å†å²è®°å½•ä¸­ï¼ŒæˆåŠŸçš„æ¬¡æ•°ï¼Œ\\(b\\)å¯ä»¥çœ‹ä½œæ˜¯å†å²è®°å½•ä¸­å¤±è´¥çš„æ¬¡æ•°ï¼Œæ¯”å¦‚\\(a=2\\)ï¼Œ\\(b=3\\)ï¼Œæ ¹æ®ç»éªŒæˆåŠŸçš„æ¦‚ç‡åº”è¯¥åœ¨\\(\\frac{2}{2+3}=0.4\\)å·¦å³ï¼Œå³æˆ‘ä»¬çš„å…ˆéªŒä¸ºæˆåŠŸçš„æ¦‚ç‡ä¸º\\(0.4\\)ï¼ˆè§ä¸‹å›¾å·¦ä¸‹è§’çš„å­å›¾ï¼‰ã€‚å¦‚æœåœ¨å®éªŒä¸­ï¼Œåˆè¿›è¡Œäº†\\(7\\)æ¬¡å®éªŒï¼Œå…¶ä¸­\\(m=6\\)ï¼Œ\\(l=1\\)ï¼Œç”±äºæˆåŠŸçš„æ¬¡æ•°å˜å¤šäº†ï¼Œ\\(a=2+6=8\\)ï¼Œ\\(b=3+1=4\\)ï¼Œç›´è§‰ä¸Šæ¥è¯´æˆ‘ä»¬å¯¹æˆåŠŸæ¦‚ç‡çš„ä¼°è®¡åº”å½“ç›¸åº”æé«˜ï¼Œå¤§æ¦‚ä¸º\\(\\frac{8}{8+4}\\approx 0.67\\)å·¦å³ã€‚è¿™æ—¶çš„Betaåˆ†å¸ƒå¦‚å³ä¸‹è§’çš„å›¾çš„æ ·å­ï¼Œä¹Ÿå°è¯äº†æˆ‘ä»¬çš„ç›´è§‰ã€‚ ä»¥ä¸‹ä¸ºä¸åŒå‚æ•°å¯¹åº”çš„Betaåˆ†å¸ƒçš„äº’åŠ¨æ¼”ç¤ºï¼š æœ€åï¼ŒBetaè¿˜æœ‰ä¸€ä¸ªæœ‰è¶£çš„åº”ç”¨å°±æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸æ–­æ¥æ”¶åˆ°æ–°çš„è§‚æµ‹æ•°æ®ï¼Œé‚£ä¹ˆæ—§çš„åéªŒåˆ†å¸ƒåˆ™å¯ä»¥ä½œä¸ºæ–°çš„å…ˆéªŒåˆ†å¸ƒå°†å‚æ•°æ›´æ–°ä¸‹å» ã€‚è¿™ç›¸å½“äºè¯´ï¼ŒåŸºäºå·²æœ‰çš„è§‚æµ‹æ•°æ®ï¼Œæˆ‘ä»¬æå‡ºä¸€ä¸ªå…ˆéªŒBetaåˆ†å¸ƒï¼Œç„¶åæ ¹æ®æ–°å¾—åˆ°çš„ä¸€æ‰¹è§‚æµ‹æ•°æ®ï¼Œç”¨å…ˆéªŒBetaåˆ†å¸ƒè®¡ç®—ä¸€ä¸ªä¼¼ç„¶å‡½æ•°ï¼Œå°†ä¼¼ç„¶å‡½æ•°å’Œå…ˆéªŒBetaåˆ†å¸ƒä¹˜èµ·æ¥ï¼Œå½’ä¸€åŒ–åå¾—åˆ°äº†æ–°çš„åéªŒåˆ†å¸ƒï¼Œåªè¦ä¸æ–­æœ‰æ–°çš„è§‚æµ‹æ•°æ®æ¥æ”¶åˆ°ï¼Œå°±å¯ä»¥æŠŠåéªŒåˆ†å¸ƒä½œä¸ºæ–°çš„å…ˆéªŒï¼Œä¸æ–­æ›´æ–°ä¸‹å»ã€‚è¿™æ ·åšçš„ä¼˜åŠ¿æ˜¯å¯¹äºå¤§æ•°æ®é›†ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ•´ä¸ªæ•°æ®é›†ï¼Œè€Œæ˜¯åªéœ€è¦ä¸€æ‰¹ä¸€æ‰¹çš„æ›´æ–°å³å¯ã€‚ Probability Distributions for Multinomial Variables Intro å‰é¢æˆ‘ä»¬è®¨è®ºäº†äºŒå€¼éšæœºå˜é‡ï¼Œç°åœ¨æˆ‘ä»¬å°†å…¶æ‰©å±•åˆ°å¤šå€¼å˜é‡ã€‚è®¾ä¸€ä¸ª\\(K\\)ç»´å‘é‡\\(\\mathbf x\\)ï¼Œå½“\\(x_k\\)ä¸º\\(1\\)çš„æ—¶å€™å…¶ä»–å…ƒç´ éƒ½ä¸º\\(0\\)ï¼Œå¦‚\\(K=6,x_3=1\\)æ—¶\\(\\mathbf x\\)è¡¨ç¤ºä¸º\\(\\mathbf x=(0,0,1,0,0,0)^\\top\\)ã€‚å¦‚æœ\\(p(x_k=1)=\\mu_k\\)ï¼Œé‚£ä¹ˆ\\(\\mathbf x\\)çš„æ¦‚ç‡åˆ†å¸ƒä¸ºï¼š \\[ p(\\mathbf x|\\boldsymbol \\mu)=\\prod_{k=1}^{K}\\mu_k^{x_k} \\] \\(\\mu_k\\)æ»¡è¶³\\(\\sum_k \\mu_k=1\\)å’Œ\\(\\mu_k\\geqslant 0\\)ï¼Œè¯¥åˆ†å¸ƒè¢«ç§°ä½œæ˜¯Categorical Distributionã€‚æ˜“çŸ¥å…¶å‡å€¼ä¸ºï¼š \\[ \\begin{align} \\mathbb E[\\mathbf x|\\boldsymbol \\mu]=\\sum_{\\mathbf x}p(\\mathbf x|\\boldsymbol \\mu)\\mathbf x=\\boldsymbol \\mu \\end{align} \\] å‡è®¾æˆ‘ä»¬æœ‰å¤§å°ä¸º\\(N\\)çš„æ•°æ®é›†\\(\\mathcal D\\)ï¼Œæ¯ä¸ªæ ·æœ¬æœä»è¯¥åˆ†å¸ƒä¸”ç›¸äº’ç‹¬ç«‹ï¼Œé‚£ä¹ˆä¼¼ç„¶å‡½æ•°ï¼š \\[ p(\\mathcal D|\\boldsymbol \\mu)=\\prod_{n=1}^N\\prod_{k=1}^K \\mu_k^{x_{nk}}=\\prod_{k=1}^K \\mu_k^{\\sum_n x_{nk}}=\\prod_{k=1}^K\\mu_k^{m_k} \\] å…¶ä¸­\\(m_k=\\sum_n x_{nk}\\)ï¼Œå³\\(x_k=1\\)çš„æ•°é‡ã€‚ä¸ºäº†æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶åŒæ—¶ä¿è¯\\(\\sum_k \\mu_k=1\\)ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼š \\[ \\sum_{k=1}^K m_k\\ln \\mu_k+\\lambda\\left(\\sum_{k=1}^K\\mu_k-1\\right) \\] æˆ‘ä»¬å¾—åˆ°\\(\\mu_k=-m_k/\\lambda\\)ã€‚é€šè¿‡\\(\\sum_k \\mu_k=1\\)å¾—å‡º\\(\\lambda=-N\\)ï¼Œæ•…æœ€åæˆ‘ä»¬æœ‰ï¼š \\[ \\mu_k^{ML}=\\frac{m_k}{N} \\] è¿™ç›¸å½“äºæ˜¯\\(x_k=1\\)çš„æ•°é‡é™¤ä»¥æ€»æ•°ã€‚ Multinomial Distribution ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å¤šæ¬¡å®éªŒè¿›è¡Œå»ºæ¨¡ï¼Œå‡è®¾è¿›è¡Œ\\(N\\)æ¬¡ç‹¬ç«‹å®éªŒï¼Œæ¦‚ç‡åˆ†å¸ƒå¯ä»¥å†™ä¸ºï¼š \\[ \\text{Mult}(m_1,m_2,\\cdots,m_K|\\boldsymbol\\mu,N)=\\binom{N}{m_1m_2\\cdots m_K}\\prod_{k=1}^K\\mu_k^{m_k} \\] è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„å¤šé¡¹åˆ†å¸ƒ (Multinomial Distribution)ï¼Œå…¶ä¸­\\(\\binom{N}{m_1m_2\\cdots m_K}\\)ä¸ºæ­£åˆ™åŒ–å› å­ï¼š \\[ \\binom{N}{m_1m_2\\cdots m_K}=\\frac{N!}{m_1!m_2!\\cdots m_K!} \\] æ³¨æ„\\(\\sum\\limits_{k=1}^K m_k=N\\)ã€‚ Dirichlet Distribution æœ‰äº†å‰é¢Betaçš„å¯å‘ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥å¯¹å¤šé¡¹åˆ†å¸ƒçš„å‚æ•°\\(\\mu_k\\)å»ºç«‹å…±è½­å…ˆéªŒã€‚é¦–å…ˆæ ¹æ®ä¼¼ç„¶å‡½æ•°ï¼Œæˆ‘ä»¬çŸ¥é“å…ˆéªŒåº”å½“ä¸\\(\\mu_k\\)çš„å¹‚çš„ä¹˜ç§¯æˆæ¯”ä¾‹ï¼š \\[ p(\\boldsymbol \\mu|\\boldsymbol \\alpha) \\propto \\prod_{k=1}^{K}\\mu_k^{a_{k-1}} \\] å…¶ä¸­\\(0\\leqslant \\mu_k\\leqslant 1\\)ä¸”\\(\\sum_k\\mu_k=1\\)ã€‚å’ŒBetaåˆ†å¸ƒä¸åŒï¼Œç”±äºè¦æ»¡è¶³\\(\\sum\\mu_k=1\\)ï¼Œæ‰€ä»¥\\(\\{\\mu_k\\}\\)çš„å–å€¼ä¼šä½äº\\(K-1\\)çš„å•çº¯å‹ä¸Šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åŠ ä¸Šæ ‡å‡†åŒ–å› å­ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†æ‰€è°“çš„å…ˆéªŒåˆ†å¸ƒï¼Œç§°ä¹‹ä¸ºè¿ªåˆ©å…‹é›·åˆ†å¸ƒ (Dirichlet Distribution)ï¼š \\[ \\text{Dir}(\\boldsymbol \\mu|\\boldsymbol\\alpha)=\\frac{\\Gamma(\\alpha_0)}{\\Gamma(\\alpha_1)\\cdots\\Gamma(\\alpha_K)}\\prod_{k=1}^K\\mu_k^{a_{k-1}} \\] å…¶ä¸­\\(\\Gamma(\\cdot)\\)ä¸ºGammaå‡½æ•°ï¼Œ\\(\\alpha_0=\\sum\\limits_{k=1}^K\\alpha_k\\)ã€‚ä¸‹å›¾ä¸ºä¸åŒæ¡ä»¶ä¸‹çš„è¿ªåˆ©å…‹é›·åˆ†å¸ƒçš„å¯è§†åŒ–ï¼š \\(\\boldsymbol \\mu\\)çš„åéªŒä¸å…ˆéªŒå’Œä¼¼ç„¶å‡½æ•°çš„ä¹˜ç§¯æˆæ­£æ¯”ï¼š \\[ p(\\boldsymbol\\mu|\\mathcal D,\\boldsymbol\\alpha)\\propto p(\\mathcal D|\\boldsymbol\\mu)p(\\boldsymbol\\mu|\\boldsymbol\\alpha)\\propto\\prod_{k=1}^K \\mu_k^{\\alpha_k+m_k-1} \\] ä¸éš¾éªŒè¯ï¼š \\[ \\begin{align} p(\\boldsymbol\\mu|\\mathcal D,\\boldsymbol\\alpha) &amp;= \\text{Dir}(\\boldsymbol\\mu|\\boldsymbol\\alpha+\\mathbf m)\\\\ &amp;=\\frac{\\Gamma(\\alpha_0+N)}{\\Gamma(\\alpha_1+m_1)\\cdots\\Gamma(\\alpha_K+m_K)}\\prod_{k=1}^K\\mu_k^{\\alpha_k+m_k-1} \\end{align} \\] å³åéªŒåŒæ ·ä¸ºè¿ªåˆ©å…‹é›·åˆ†å¸ƒã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Notes","slug":"Research/Notes","permalink":"http://qfxiao.me/categories/Research/Notes/"}],"tags":[{"name":"Statistics","slug":"Statistics","permalink":"http://qfxiao.me/tags/Statistics/"},{"name":"Probability","slug":"Probability","permalink":"http://qfxiao.me/tags/Probability/"}]},{"title":"Time2Graph: Revisiting Time Series Modeling with Dynamic Shapelets","slug":"Time2Graph-Revisiting-Time-Series-Modeling-with-Dynamic-Shapelets","date":"2020-06-13T08:42:04.000Z","updated":"2020-07-07T03:15:36.315Z","comments":true,"path":"2020/06/13/Time2Graph-Revisiting-Time-Series-Modeling-with-Dynamic-Shapelets/","link":"","permalink":"http://qfxiao.me/2020/06/13/Time2Graph-Revisiting-Time-Series-Modeling-with-Dynamic-Shapelets/","excerpt":"","text":"Introduction æœ¬æ–‡æ—¨åœ¨æä¾›ä¸€ç§å¯è§£é‡Šçš„é«˜æ•ˆçš„æ—¶é—´åºåˆ—å»ºæ¨¡ï¼ˆè¡¨ç¤ºå­¦ä¹ ï¼‰æ–¹æ³•æ¥æ›´å¥½åœ°æœåŠ¡åˆ†ç±»ä»»åŠ¡ã€‚Shapeletåœ¨æ—¶é—´åºåˆ—åˆ†ç±»ä»»åŠ¡ä¸Šä½“ç°äº†è‰¯å¥½çš„å¯è§£é‡Šæ€§ã€‚ä¸è¿‡ä¼ ç»Ÿçš„åŸºäºShapeletçš„æ–¹æ³•å¿½ç•¥äº†Shapeletåœ¨ä¸åŒæ—¶é—´ç‰‡æ®µä¸Šçš„åŠ¨æ€æ€§ï¼Œå³æ•´ä¸ªæ—¶é—´ç»´åº¦ä¸Šä¸åŒçš„æ—¶é—´ç‰‡æ®µå¯èƒ½é€‚åˆç”¨ä¸åŒçš„Shapeletã€‚ä½œè€…åŸºäºæ­¤è®¾è®¡äº†åŠ¨æ€çš„time-aware shapeletï¼Œå¹¶ä¸”å®šä¹‰äº†shapelet evolution graphæ¥æ•è·Shapeletåœ¨æ—¶é—´ç»´åº¦ä¸Šçš„åŠ¨æ€å˜åŒ–ã€‚ ğŸ“°Get Paper Preliminaries æ—¶é—´åºåˆ—é›†åˆ\\(T=\\{t_1,\\cdots,t_{|T|}\\}\\)åŒ…å«è‹¥å¹²æ¡æ—¶åºæ•°æ®\\(t=\\{x_1,\\cdots,x_n\\}\\)ã€‚ä¸€ä¸ª\\(t\\)çš„ç‰‡æ®µ\\(s\\)æ˜¯\\(t\\)çš„ä¸€ä¸ªè¿ç»­å­åºåˆ—ã€‚å¦‚æœ\\(t\\)èƒ½è¢«åˆ‡åˆ†æˆ\\(m\\)ä¸ªé•¿åº¦éƒ½ä¸º\\(l\\)çš„ç‰‡æ®µï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰\\(t=\\{\\{x_{l*k+1},\\cdots,x_{l*k+l}\\},0\\leq k\\leq m-1\\}\\)ã€‚ä¸¤ä¸ªé•¿åº¦ç›¸ç­‰çš„ç‰‡æ®µä¹‹é—´è·ç¦»å¾ˆå¥½åº¦é‡ï¼Œç›´æ¥è®¡ç®—æ¬§å¼è·ç¦»å³å¯ï¼Œé‚£ä¹ˆä¸¤ä¸ªç‰‡æ®µé•¿åº¦ä¸ç›¸ç­‰çš„æƒ…å†µå‘¢ï¼Ÿè¿™å°±éœ€è¦å¯¹å…¶ï¼ˆAlignmentï¼‰çš„æ¦‚å¿µã€‚ Definition 1 Alignment. ç»™å®šä¸¤ä¸ªé•¿åº¦åˆ†åˆ«ä¸º\\(l_i\\)å’Œ\\(l_j\\)çš„åºåˆ—\\(s_i\\)å’Œ\\(s_j\\)ï¼Œä¸€ä¸ªalignment \\(a=(a_1,a_2)\\)æ˜¯ä¸€ä¸ªæ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„é•¿åº¦ä¸º\\(p\\)çš„ä¸‹æ ‡åºåˆ—ï¼š \\[ 1\\leq a_k(1)\\leq\\cdots\\leq a_k(p)=l_k,\\\\ a_k(n+1)-a_k(n)\\leq 1,\\\\ \\text{for }k=i,j,\\text{ and }1\\leq n\\leq p-1 \\] ä¸Šè¿°å…¬å¼å¯èƒ½æ¯”è¾ƒæŠ½è±¡ï¼Œå…¶å®çœ‹äº†ä¸‹å›¾å°±ä¸éš¾ç†è§£ï¼š ç‰‡æ®µ\\(s_i\\)ä¸­çš„æŸä¸ªç‚¹\\(a\\)ï¼Œä¸ç‰‡æ®µ\\(s_j\\)ä¸­çš„æŸä¸ªç‚¹\\(b\\)å½¢æˆå¯¹åº”ï¼Œç„¶ååœ¨\\(a\\)å’Œ\\(b\\)ä¹‹é—´è¿ä¸€æ¡è™šæ‹Ÿçš„çº¿ï¼ˆä¸èƒ½ä¸å·²æœ‰çš„çº¿äº¤å‰ï¼‰ï¼Œä¸€ç›´è¿™ä¹ˆåšç›´åˆ°çŸ­çš„é‚£ä¸ªç‰‡æ®µä¸­çš„æ¯ä¸ªç‚¹éƒ½æ‰¾åˆ°å¯¹åº”ï¼Œå°±æ˜¯ä¸€ä¸ªåˆç†çš„alignmentã€‚å¯¹äºä¸¤ä¸ªé•¿åº¦ä¸ä¸€æ ·çš„ç‰‡æ®µ\\(s_i\\)å’Œ\\(s_j\\)ï¼Œä¼šæœ‰å¾ˆå¤šç§alignmentã€‚æˆ‘ä»¬æŠŠ\\(s_i\\)å’Œ\\(s_j\\)æ‰€æœ‰å¯èƒ½çš„alignmentè®°ä¸º\\(\\mathcal{A}(s_i,s_j)\\)ã€‚åœ¨å®šä¹‰äº†alignmentä¹‹åå°±å¯ä»¥å®šä¹‰DTWäº†ã€‚DTW (Dynamic Time Warping) å®šä¹‰ä¸ºåœ¨ç»™å®šä¸€ä¸ªé¢„å®šä¹‰çš„è·ç¦»åº¦é‡\\(\\tau\\)å’Œæ‰€æœ‰å¯èƒ½çš„alignment \\(\\mathcal{A}(s_i,s_j)\\)çš„æƒ…å†µä¸‹ï¼Œæœ€å°çš„è·ç¦»\\(\\tau\\)ï¼š \\[ d_\\text{DTW}(s_i,s_j)=\\min_{a\\in\\mathcal{A}(s_i,s_j)}\\tau(s_i,s_j|a) \\] è¿›ä¸€æ­¥çš„ï¼Œå› ä¸ºæ—¶é—´åºåˆ—\\(t\\)ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªç‰‡æ®µï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå­åºåˆ—\\(s\\)å’Œæ—¶é—´åºåˆ—\\(t\\)ä¹‹é—´çš„è·ç¦»åº¦é‡ï¼š \\[ D(s,t)=\\min_{1\\leq k\\leq m} d(s,s_k) \\] è¿™é‡Œ\\(\\boldsymbol s_k\\)ä¸ºæ—¶åº\\(\\boldsymbol t\\)åˆ†è§£æˆçš„ç‰‡æ®µã€‚ä¹‹åShapeletå¯ä»¥é€šè¿‡ç‰‡æ®µä¸æ—¶åºçš„è·ç¦»å®šä¹‰ä¸ºæœ€å…·æœ‰è¾¨è¯†åº¦çš„æœ‰ä»£è¡¨æ€§çš„ç‰‡æ®µï¼š Definition 2 Shapelet. ä¸€ä¸ªShapelet \\(\\boldsymbol v\\)æ˜¯å¯¹äºç‰¹å®šç±»åˆ«æ—¶åºçš„æœ€å…·æœ‰ä»£è¡¨æ€§çš„ç‰‡æ®µã€‚è€ƒè™‘æ—¶åºåˆ†ç±»ä»»åŠ¡ï¼Œç»™å®šæ—¶åºé›†åˆ\\(T\\)ï¼Œå¯ä»¥é€šè¿‡ä¸\\(\\boldsymbol v\\)ç›¸ä¼¼æˆ–ä¸ç›¸ä¼¼è€Œåˆ†æˆä¸¤ä¸ªå­é›†åˆï¼Œä¸\\(\\boldsymbol v\\)ç›¸ä¼¼çš„é›†åˆä¸\\(\\boldsymbol v\\)çš„è·ç¦»åº”å½“å°½é‡å°ï¼Œä¸\\(\\boldsymbol v\\)ä¸ç›¸ä¼¼çš„é›†åˆä¸\\(\\boldsymbol v\\)çš„è·ç¦»åº”å½“å°½é‡å¤§ï¼Œæ­¤æ—¶æŸå¤±å‡½æ•°å¯ä»¥å½¢å¼åŒ–ä¸ºï¼š \\[ \\mathcal L=-g(S_{pos}(\\boldsymbol v,T),S_{neg}(\\boldsymbol v,T)) \\] \\(\\mathcal L\\)æè¿°äº†åœ¨shapelet \\(\\boldsymbol v\\)ä¸‹æ­£è´Ÿæ ·æœ¬é›†çš„ç›¸å¼‚æ€§ã€‚\\(S_{*}(\\boldsymbol v,T)\\)è¡¨ç¤ºç‰¹å®šæ—¶åºé›†åˆä¸\\(\\boldsymbol v\\)çš„è·ç¦»é›†åˆï¼Œ\\(g(\\cdot,\\cdot)\\)ä¸ºæ¥å—ä¸¤ä¸ªæœ‰é™é›†åˆä¸ºè¾“å…¥çš„å¯å¾®å‡½æ•°ï¼Œå¹¶ä¸”èƒ½å¤Ÿåº¦é‡ä¸¤ä¸ªé›†åˆçš„è·ç¦»ã€‚ Framework æœ¬æ–‡ä¸»è¦æ˜¯æå‡ºäº†ä¸€ç§æ—¶é—´åºåˆ—è¡¨ç¤ºå­¦ä¹ æ–¹æ³•ã€‚åŸºäºShapeletåœ¨ä¸åŒçš„æ—¶é—´ç‰‡æ®µä¸Šçš„ä½œç”¨æ˜¯ä¸åŒçš„è§‚å¯Ÿï¼Œä½œè€…ä¸ºä¸åŒçš„æ—¶é—´ç‰‡æ®µèµ‹äºˆäº†ä¸åŒçš„Shapeletï¼Œè€Œä¸æ˜¯åƒä¼ ç»Ÿæ–¹æ³•ä¸€æ ·æ•´ä¸ªæ—¶åºå¯¹åº”ä¸€ä¸ªShapeletã€‚æ¥ç€åŸºäºè¿™äº›Shapeletä½œè€…æ„é€ äº†å›¾ï¼Œå¹¶é€šè¿‡å›¾åµŒå…¥å¾—åˆ°äº†åµŒå…¥å‘é‡ï¼Œä½œä¸ºæ—¶åºçš„è¡¨ç¤ºã€‚ Time-Aware Shapelet Extraction ç¬¬ä¸€æ­¥æ˜¯æ•è·Shapeletåœ¨æ—¶é—´ç»´åº¦ä¸Šçš„åŠ¨æ€å½±å“ã€‚æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå‚æ•°æ¥å®šé‡çš„æµ‹é‡shapeletåœ¨ä¸åŒæ—¶é—´ä¸Šçš„åŠ¨æ€æ€§ã€‚ç¬¬ä¸€ä¸ªæ˜¯å±€éƒ¨å› å­\\(\\boldsymbol w_n\\)ï¼Œç”¨æ¥æ§åˆ¶shapeletå†…éƒ¨\\(n\\)ä¸ªå…ƒç´ çš„æƒé‡ï¼Œé‚£ä¹ˆshapelet \\(\\boldsymbol v\\)å’Œç‰‡æ®µ\\(\\boldsymbol s\\)çš„è·ç¦»ä¸ºï¼š \\[ \\begin{align} \\hat{d}(\\boldsymbol v,\\boldsymbol s|\\boldsymbol w) &amp;= \\tau(\\boldsymbol v,\\boldsymbol s|\\boldsymbol a^*,\\boldsymbol w)\\\\ &amp; = \\left(\\sum_{k=1}^{p}\\boldsymbol w_{\\boldsymbol a^*_1(k)}\\cdot(\\boldsymbol v_{\\boldsymbol a^*_1(k)}-\\boldsymbol s_{\\boldsymbol a^*_2(k)})^2\\right)^{\\frac{1}{2}} \\end{align} \\] å…¶ä¸­\\(\\boldsymbol a^*\\)ä¸ºDTWè·ç¦»ä¸‹çš„æœ€ä½³å¯¹é½ã€‚ ç¬¬äºŒä¸ªæ˜¯å…¨å±€å› ç´ \\(\\boldsymbol u_m\\)ï¼Œè¿™ä¸»è¦æ˜¯é€šè¿‡å¯¹ä¸åŒç‰‡æ®µ\\(\\boldsymbol s\\)æ–½åŠ ä¸åŒçš„æƒé‡å®ç°çš„ï¼Œäºæ˜¯shapelet \\(\\boldsymbol v\\)å’Œæ—¶é—´åºåˆ—\\(\\boldsymbol t\\)çš„è·ç¦»å¯ä»¥é‡å†™ä¸ºï¼š \\[ \\hat{D}(\\boldsymbol v,\\boldsymbol t|\\boldsymbol w,\\boldsymbol u)=\\min_{1\\leq k\\leq m}\\boldsymbol u_k\\cdot\\hat{d}(\\boldsymbol v,\\boldsymbol s_k|\\boldsymbol w) \\] å…¶ä¸­\\(\\boldsymbol t\\)è¢«åˆ†å‰²ä¸º\\(m\\)ä¸ªç‰‡æ®µï¼š\\(\\boldsymbol t=\\{\\boldsymbol s_1,\\cdots,\\boldsymbol s_m\\}\\)ã€‚å¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œå…·ä½“çš„æ¥è¯´ï¼Œæˆ‘ä»¬å…ˆç”Ÿæˆä¸€å †Shapeletå€™é€‰é›†ï¼Œç„¶åé€šè¿‡æœ‰ç›‘ç£çš„æ–¹æ³•æ¥æŒ‘é€‰æœ€ä½³çš„Shapeletå’Œå¯¹åº”çš„å‚æ•°\\(\\boldsymbol w\\)å’Œ\\(\\boldsymbol u\\)ã€‚ è®¡ç®—shapeletå€™é€‰é›†çš„ç®—æ³•å¦‚ä¸‹ï¼š åœ¨è·å–äº†Shapeletå€™é€‰é›†åˆä¹‹åï¼Œæˆ‘ä»¬æœ‰å¸¦æœ‰æ ‡ç­¾çš„æ—¶åºé›†åˆ\\(T\\)ï¼Œå¯¹äºæ¯ä¸€ä¸ªShapeletæˆ‘ä»¬å¯ä»¥ä¼˜åŒ–ï¼š \\[ \\hat{\\mathcal L}=-g(S_{pos}(\\boldsymbol v,T),S_{neg}(\\boldsymbol v,T))+\\lambda\\parallel \\boldsymbol w\\parallel+\\epsilon\\parallel \\boldsymbol u\\parallel \\] æ¥è·å–æœ€ä¼˜çš„\\(\\hat{\\boldsymbol w}\\)å’Œ\\(\\hat{\\boldsymbol u}\\)ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æŒ‘é€‰å‡ºä½¿å¾—\\(\\hat{\\mathcal L}\\)æœ€å°çš„å‰\\(K\\)ä¸ªShapeletã€‚æ•´ä¸ªè¿‡ç¨‹çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š Shapelet Evolution Graph åœ¨è·å–äº†Shapeletä¹‹åï¼Œä¸ºäº†æ•è·Shapeletä¹‹é—´çš„ç›¸å…³æ€§ï¼Œæˆ‘ä»¬å®šä¹‰äº†Shapelet Evolution Graphã€‚ Definition 3 Shapelet Evolution Graph. Shapelet Evolution Graphä¸ºä¸€ä¸ªæœ‰å‘å¸¦æƒå›¾\\(G=(V,E)\\)ï¼Œ\\(V\\)ä¸º\\(K\\)ä¸ªShapeletï¼Œæ¯æ¡å¸¦æœ‰æƒé‡\\(w_{ij}\\)çš„è¾¹\\(e_{ij}\\in E\\)ä»£è¡¨ä¸¤ä¸ªShapelet \\(\\boldsymbol v_i \\in V\\)å’Œ\\(\\boldsymbol v_j \\in V\\)è¢«åˆ†é…ç»™ç›¸é‚»ç‰‡æ®µçš„æ¦‚ç‡ã€‚ Graph Construction è¿™é‡Œæ¥è¯´ä¸€ä¸‹ï¼Œå»ºå›¾çš„å…·ä½“è¿‡ç¨‹ã€‚é¦–å…ˆé¡¶ç‚¹ä¸ºShapeletï¼Œä¹‹åæ¥è¿›è¡Œè¾¹çš„æ„é€ ã€‚å¯¹äºæ¯ä¸€ä¸ªç‰‡æ®µ\\(\\boldsymbol s_i\\)ï¼Œæˆ‘ä»¬ä¼šè®¡ç®—Shapeletåˆ°è¯¥ç‰‡æ®µçš„è·ç¦»ï¼Œè·ç¦»è¶Šè¿‘ä»£è¡¨è¿™ä¸ªShapeletä¸ç‰‡æ®µè¶ŠåŒ¹é…ã€‚ä¹‹åä¼šè®¾å®šä¸€ä¸ªé˜ˆå€¼\\(\\delta\\)ï¼Œç„¶åå°†ä¸ç‰‡æ®µçš„è·ç¦»ä½äºè¿™ä¸ªé˜ˆå€¼çš„Shapeletåˆ†é…ç»™è¿™ä¸ªç‰‡æ®µï¼ˆä¸€ä¸ªShapeletå¯èƒ½ä¼šåˆ†é…ç»™å¤šä¸ªä¸åŒç‰‡æ®µï¼‰ã€‚å¯¹äº\\(\\boldsymbol s_i\\)çš„æ‰€æœ‰shapetletæˆ‘ä»¬è®°ä¸º\\(\\boldsymbol v_{i,*}\\)ï¼Œæˆ‘ä»¬ä¼šæŒ‰ç…§Shapeåˆ°ç‰‡æ®µçš„è·ç¦»è¿›è¡Œå½’ä¸€åŒ–ï¼š \\[ \\boldsymbol p_{i,j}=\\frac{\\max(\\hat{d}_{i,*}(\\boldsymbol v_{i,*},\\boldsymbol s_i))-\\hat{d}_{i,j}(\\boldsymbol v_{i,j},\\boldsymbol s_i)}{\\max(\\hat{d}_{i,*}(\\boldsymbol v_{i,*},\\boldsymbol s_i))-\\min(\\hat{d}_{i,*}(\\boldsymbol v_{i,*},\\boldsymbol s_i))} \\] å…¶ä¸­\\(\\hat{d}_{i,*}(\\boldsymbol v_{i,*},\\boldsymbol s_i)=\\boldsymbol u_*[i]*\\hat{d}(\\boldsymbol v_{i,*},\\boldsymbol s_i|\\boldsymbol w_*)&lt;\\delta\\)ã€‚è¿™æ ·å¯¹äºæ¯ä¸ªç‰‡æ®µ\\(\\boldsymbol s_i\\)æ‰€åˆ†é…çš„Shapeletå¯¹åº”çš„\\(\\boldsymbol p\\)ä¹‹å’Œä¼šç­‰äº\\(1\\)ã€‚å¯¹æ¯ä¸€å¯¹ç›¸é‚»çš„ç‰‡æ®µ\\((\\boldsymbol s_i,\\boldsymbol s_{i+1})\\)çš„Shapelet \\(\\boldsymbol v_{i,j}\\)å’Œ\\(\\boldsymbol v_{i+1,k}\\)ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€æ¡è¿æ¥\\(\\boldsymbol v_{*,j}\\)å’Œ\\(\\boldsymbol v_{*,k}\\)çš„è¾¹\\(e_{j,k}\\)ï¼Œæƒé‡ä¸º\\(\\boldsymbol p_{i,j}\\cdot\\boldsymbol p_{i+1,k}\\)ã€‚æœ€åï¼Œæ‰€æœ‰é‡å¤çš„è¾¹ä¼šè¢«åˆå¹¶ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå‡è®¾æœ‰ä¸¤ä¸ªç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µåˆ†é…äº†\\(3\\)ä¸ªShapeletï¼ŒShapelet \\(B\\)åœ¨ç‰‡æ®µ\\(1\\)å¯¹åº”çš„æ¦‚ç‡æ˜¯\\(p_{12}\\)ï¼ŒShapelet \\(C\\)åœ¨ç‰‡æ®µ\\(2\\)å¯¹åº”çš„æ¦‚ç‡æ˜¯\\(p_{23}\\)ï¼Œé‚£ä¹ˆç”±äºç‰‡æ®µ\\(1\\)å’Œ\\(2\\)æ˜¯ç›¸é‚»ç‰‡æ®µï¼Œä¼šåœ¨\\(B\\)å’Œ\\(C\\)ä¹‹é—´è¿ä¸€æ¡è¾¹ï¼Œè¾¹çš„æƒé‡ä¸º\\(p_{12}*p_{23}\\)ã€‚ å»ºå›¾çš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š Representation Learning ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨DeepWalkç®—æ³•æ¥è·å–è·å–æ¯ä¸ªç»“ç‚¹ï¼ˆShapeletï¼‰çš„åµŒå…¥è¡¨ç¤ºã€‚å¯¹äºæ—¶åº\\(\\boldsymbol t=\\{\\boldsymbol s_1,\\cdots,\\boldsymbol s_m\\}\\)å³å¯¹åº”çš„Shapelet \\(\\{\\boldsymbol v_{1,*},\\cdots, v_{m,*}\\}\\)å’Œå¯¹åº”çš„æ¦‚ç‡\\(\\{\\boldsymbol p_{1,*},\\cdots,\\boldsymbol p_{m,*}\\}\\)ï¼Œæ¯ä¸ªShaplet \\(\\boldsymbol v_{i,j}\\)çš„è¡¨ç¤ºè®°ä¸º\\(\\boldsymbol \\mu(\\boldsymbol v_{i,j})\\)ã€‚ç‰‡æ®µ\\(\\boldsymbol s_i\\)å¯¹åº”çš„åµŒå…¥å‘é‡ä¸ºå¯¹åº”çš„ShapeletåµŒå…¥å‘é‡ä¸å¯¹åº”çš„æ¦‚ç‡å€¼åŠ æƒæ±‚å’Œï¼š \\[ \\boldsymbol\\Phi_i=\\left(\\sum_j p_{i,j}\\cdot\\boldsymbol \\mu(\\boldsymbol v_{i,j})\\right),\\space 1\\leq i \\leq m \\] ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š Experiments Experimental Setup æ–‡ä¸­ç”¨äº†Earthquakes (EQS)ã€WormsTwoClass (WTC)ã€Strawberry (STB)ã€Electricity Consumption Records (ECR)å’ŒNetwork Traffic Flow (NTF) è¿™äº”ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­åä¸¤ä¸ªä¸ºä½œè€…è‡ªå·±æ”¶é›†çš„æ•°æ®é›†ã€‚äº”ä¸ªæ•°æ®é›†å¯¹åº”çš„ç»Ÿè®¡ä¿¡æ¯å¦‚ä¸‹ï¼š æ–‡ä¸­ä¸å¤šä¸ªBaselineè¿›è¡Œäº†æ¯”è¾ƒï¼ŒåŒ…æ‹¬: Distance-based Models: æ–‡ä¸­ä½¿ç”¨äº†ä¸åŒçš„è·ç¦»åº¦é‡ä¸åŸºäº1-NNçš„æ¨¡å‹è¿›è¡Œç»„åˆï¼ŒåŒ…æ‹¬Euclidean Distance (ED)ã€Dynamic Time Warping (DTW)ã€Weighted DTW (WDTW)ã€Complexity-Invariant Distance (CID) å’Œ Derivative DTW (DDTW)ï¼› Feature-based Models: æ–‡ä¸­åˆ†åˆ«ä½¿ç”¨äº†æå–ç‰¹å¾ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ç­‰ï¼‰å’ŒåŸå§‹åºåˆ—æ¥è®­ç»ƒXGBoostã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜ä½¿ç”¨äº† Bag-of-Patterns (BoP)ã€Time Series Forest (TSF)ã€Elastic Ensembles (EE) å’Œ åŸºäºSAXçš„ Vector Space Model (SAXVSM)ï¼› Shapelet-based Models: è¿™éƒ¨åˆ†æ¨¡å‹åŒ…æ‹¬ Learn Time Series Shapelets (LS)ã€Fast Shapelets (FS)ã€å’Œ Learned Pattern Similarity (LPS)ï¼› Deep Learning Models: è¿™éƒ¨åˆ†æ¨¡å‹åŒ…æ‹¬MLPã€LSTMå’ŒVAEã€‚ Comparison Results å¯¹äºå‰ä¸‰ä¸ªå…¬å…±æ•°æ®é›†è¯„æµ‹æ ‡å‡†é‡‡ç”¨Accuracyï¼Œåä¸¤ä¸ªæ•°æ®é›†å› ä¸ºæ ·æœ¬ç±»æ¯”ä¸å‡è¡¡ï¼Œæ‰€ä»¥é‡‡ç”¨äº†Precisionã€Recallå’ŒF1ä½œä¸ºè¯„æµ‹æ ‡å‡†ã€‚ç»“æœå¦‚ä¸‹ï¼š åœ¨EQSæ•°æ®é›†ä¸Šï¼ŒTime2Graphæ‰“è´¥äº†æ‰€æœ‰Baselineï¼Œè€Œåœ¨WTCå’ŒSTBè¿™ä¸¤ä¸ªæ•°æ®é›†ä¸Šä¹Ÿè¾¾åˆ°äº†è¾ƒå¥½çš„æ•ˆæœã€‚åœ¨ECRå’ŒNTFè¿™ä¸¤ä¸ªçœŸå®æ•°æ®é›†ä¸Šï¼ŒTime2Graphåœ¨F1ä¸Šæ‰“è´¥äº†æ‰€æœ‰Baselineã€‚ Parameter Analysis æœ¬èŠ‚å¯¹Shapeletçš„æ•°é‡\\(K\\)ã€åµŒå…¥ç»´åº¦\\(B\\)å’Œç‰‡æ®µé•¿åº¦\\(l\\)è¿›è¡Œäº†å‚æ•°åˆ†æã€‚ç»“æœå¦‚ä¸‹ï¼š Case Study of Time-Aware Shapelets æœ¬èŠ‚ä½œè€…å¯¹æå‡ºçš„Time-Aware Shapetletè¿›è¡Œäº†ç»†è‡´çš„æ¢ç©¶ã€‚ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ä¸åŒShapeletçš„åŒºåˆ†èƒ½åŠ›æ˜¯å¦ä¸åŒï¼Ÿä¸‹å›¾(a)é‡Œï¼Œä½œè€…åœ¨ä½¿ç”¨Shapeletè¿›è¡ŒäºŒåˆ†ç±»çš„ä»»åŠ¡ä¸­ï¼Œå°†ShapeletæŒ‰Lossï¼ˆå›¾ä¸­ç°è‰²çš„çº¿ï¼‰è¿›è¡Œæ’åºï¼Œå¹¶ä¸”ç»˜åˆ¶äº†å¯¹åº”çš„æ­£è´Ÿæ ·æœ¬è·ç¦»çš„KLæ•£åº¦ï¼ˆæ©˜çº¢è‰²çš„ç‚¹ï¼‰ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨Lossæ›²çº¿å’ŒKLæ•£åº¦å‘ˆåæ¯”å…³ç³»ã€‚KLæ•£åº¦è¶Šé«˜ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¯¥Shapeletçš„åŒºåˆ†åº¦è¶Šé«˜ï¼Œè¿™è¯´æ˜ä¸åŒShapeletçš„åŒºåˆ†åº¦çš„ç¡®ä¸åŒï¼Œå¹¶ä¸”è¿™ä¼šä¸æœ€ç»ˆæ•ˆæœç›´æ¥æŒ‚é’©ã€‚å›¾(b)å±•ç¤ºäº†ä¸åŒShapeletçš„å‡å€¼å’Œæ–¹å·®ï¼ˆåŸæ–‡æ²¡æœ‰è¯´æ¸…æ¥šæ˜¯ä»€ä¹ˆçš„å‡å€¼å’Œæ–¹å·®ï¼‰ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…å’Œæµè¡Œçš„Shapeletæå–ç®—æ³•LSè¿›è¡Œäº†æ¯”è¾ƒï¼Œå¦‚å›¾(c)å’Œå›¾(d)ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°å¯¹äºä¸åŒæ—¶é—´ï¼Œæœ¬æ–‡çš„ç®—æ³•æå–çš„Shapeletçš„ç¡®æ˜¯å…·æœ‰æ—¶é—´åŠ¨æ€æ€§çš„ã€‚ Case Study of the Shapelet Evolution Graph æœ¬èŠ‚ä½œè€…å¯¹Shapelet Evolution Graphè¿›è¡Œäº†ç»†è‡´çš„æ¢ç©¶ã€‚ä¸‹å›¾åˆ†åˆ«ä¸ºä¸€æœˆä»½å’Œä¸ƒæœˆä»½çš„Shapelet Evolution Graphã€‚åœ¨ä¸€æœˆï¼Œ45å·Shapeletçš„åº¦è¾ƒå¤§ï¼Œè€Œä¸”å¯¹åº”çš„æ—¶é—´å› ç´ åœ¨ä¸€æœˆå’ŒäºŒæœˆä¹Ÿè¾ƒå¤§ï¼ˆå›¾ä¸­æ·±è‰²éƒ¨åˆ†ï¼‰ã€‚è¯´æ˜45å·Shapeletåœ¨ä¸€æœˆä»½å…·æœ‰ä»£è¡¨æ€§ã€‚è€Œåœ¨ä¸ƒæœˆï¼Œ45å·Shapeletçš„é‡è¦æ€§é™ä½ï¼Œè€Œ42å·Shapeletåœ¨ä¸ƒæœˆçš„é‡è¦æ€§å¾ˆé«˜ã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Time Series Modeling","slug":"Research/Time-Series-Modeling","permalink":"http://qfxiao.me/categories/Research/Time-Series-Modeling/"}],"tags":[{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Shapelet","slug":"Shapelet","permalink":"http://qfxiao.me/tags/Shapelet/"}]},{"title":"Generative Probabilistic Novelty Detection with Adversarial Autoencoders","slug":"Generative-Probabilistic-Novelty-Detection-with-Adversarial-Autoencoders","date":"2020-06-06T04:03:27.000Z","updated":"2020-06-25T08:14:29.250Z","comments":true,"path":"2020/06/06/Generative-Probabilistic-Novelty-Detection-with-Adversarial-Autoencoders/","link":"","permalink":"http://qfxiao.me/2020/06/06/Generative-Probabilistic-Novelty-Detection-with-Adversarial-Autoencoders/","excerpt":"","text":"Introduction è¿™ç¯‡æ–‡ç« ä»‹ç»äº†ä¸€ç§åŸºäºæ¦‚ç‡åˆ†å¸ƒçš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯å‡è®¾æ­£å¸¸æ ·æœ¬æœä»å®šä¹‰åœ¨æµå½¢\\(M\\)ä¸Šçš„åˆ†å¸ƒï¼Œè€Œå¯¹äºä»»æ„ä¸€ç‚¹\\(\\bar x\\)ï¼Œé€šè¿‡æŠ•å½±åˆ°æµå½¢\\(M\\)ä¸Š\\(x^\\parallel\\)ï¼Œå¯ä»¥åˆ†è§£ä¸ºå¹³è¡Œäºåˆ‡ç©ºé—´çš„éƒ¨åˆ†\\(x^\\parallel\\)å’Œæ­£äº¤ä¸åˆ‡ç©ºé—´çš„éƒ¨åˆ†\\(x^\\bot\\)ã€‚åŸå§‹çš„åæ ‡\\(\\bar x\\)è¢«è½¬æ¢åˆ°\\(x^\\parallel\\)å±€éƒ¨åæ ‡ç³»ä¸­ï¼Œç„¶åä¼¼ç„¶é€šè¿‡è½¬æ¢åçš„åæ ‡ç³»è¿›è¡Œè®¡ç®—ã€‚ Methodology Generative Probabilistic Novelty Detection æˆ‘ä»¬å‡è®¾è®­ç»ƒæ•°æ®\\(x_1,\\cdots,x_N\\)ï¼Œå…¶ä¸­\\(x_i\\in\\mathbb{R}^m\\)ï¼Œä»ä¸€ä¸ªåˆ†å¸ƒé‡‡æ ·çš„æ¥ï¼Œå¹¶å¸¦æœ‰éšæœºå™ªå£°\\(\\xi\\)ï¼š \\[ x_i=f(z_i)+\\xi_i, \\space\\space\\space i=1,\\cdots,N \\] å…¶ä¸­\\(z_i\\in\\mathbb{R}^n\\)ï¼Œ\\(f:\\Omega\\mapsto\\mathbb{R}^m\\)å®šä¹‰äº†ä¸€ä¸ª\\(n\\)ç»´å¸¦å‚æµå½¢\\(\\mathcal{M}\\equiv f(\\Omega)\\)ã€‚æ³¨æ„è¿™é‡Œå™ªå£°çš„åŠ å…¥ä½¿å¾—æ ·æœ¬çš„å€¼åŸŸæ‰©å±•åˆ°äº†æ•´ä¸ªå®æ•°ç©ºé—´ã€‚åŒæ—¶å‡è®¾å­˜åœ¨\\(g:\\mathbb{R}^m\\mapsto\\mathbb{R}^n\\)ï¼Œå¯¹ä»»æ„\\(x\\in\\mathcal{M}\\)éƒ½æœ‰\\(f(g(x))=x\\)ã€‚\\(f\\)å’Œ\\(g\\)åé¢ä¼šé€šè¿‡ç¥ç»ç½‘ç»œå®ç°ã€‚ å¯¹äºä¸€ä¸ªæµ‹è¯•æ ·æœ¬\\(\\bar{x}\\in\\mathbb{R}^m\\)ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å…¶åœ¨\\(M\\)ä¸Šçš„æŠ•å½±ï¼Œè¿™æ˜¯é€šè¿‡é€†å˜æ¢\\(\\bar z = g(\\bar x)\\)å¾—åˆ°å¯¹åº”\\(z\\)çš„ç„¶åå†é€šè¿‡\\(\\bar x^{\\parallel}=f(\\bar z)\\)å¾—åˆ°ã€‚\\(f\\)åœ¨\\(\\bar z\\)çš„ä¸€é˜¶æ³°å‹’å±•å¼€ä¸ºï¼š \\[ f(z)=f(\\bar z)+J_f(\\bar z)(z-\\bar z)+O(\\parallel z-\\bar z\\parallel ^2) \\] å…¶ä¸­\\(J_f(\\bar z)\\)ä¸º\\(f\\)åœ¨ç‚¹\\(\\bar z\\)çš„é›…å„æ¯”çŸ©é˜µã€‚\\(\\mathcal T=\\text{span}(J_f(\\bar z))\\)ä»£è¡¨ç‚¹\\(\\bar z\\)å¤„ç”±\\(J_f(\\bar z)\\)çš„\\(n\\)ä¸ªç‹¬ç«‹å‘é‡ç»„æˆçš„åˆ‡ç©ºé—´ã€‚é€šè¿‡å¯¹\\(J_f(\\bar z)\\)è¿›è¡Œå¥‡å¼‚å€¼åˆ†è§£\\(J_f(\\bar z)=U^\\parallel SV^\\top\\)ã€‚ \\[ \\bar w=U^\\top\\bar x=\\left[\\begin{matrix}U^{\\parallel^\\top}\\bar x\\\\ U^{\\bot^\\top}\\bar x\\end{matrix}\\right]=\\left[\\begin{matrix}\\bar w^\\parallel\\\\ \\bar w^\\bot\\end{matrix}\\right] \\] åæ ‡\\(\\bar w\\)å¯ä»¥åˆ†è§£ä¸ºå¹³è¡Œäº\\(\\mathcal T\\)å’Œæ­£äº¤äº\\(\\mathcal T\\)ä¸¤éƒ¨åˆ†ã€‚ å®šä¹‰åœ¨æ–½åŠ å˜æ¢å‰åçš„åæ ‡ç³»ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒ\\(p_X(x)\\)å’Œ\\(p_W(w)\\)æ˜¯ç­‰ä»·çš„ï¼Œä¸è¿‡å¯¹äº\\(p_W(w)\\)ï¼Œæˆ‘ä»¬å‡è®¾å¹³è¡Œéƒ¨åˆ†å’Œæ­£äº¤éƒ¨åˆ†æ˜¯ç‹¬ç«‹çš„ï¼Œå³ï¼š \\[ p_X(x)=p_W(w)=p_W(w^\\parallel,w^\\bot)=p_{W^\\parallel}(w^\\parallel)p_{W^\\bot}(w^\\bot) \\] è¿™ä¸€å‡è®¾çš„ä¾æ®æ˜¯éšæœºå™ªå£°éƒ¨åˆ†å‡è®¾ä¸»è¦æ˜¯å¾€æµå½¢ä¹‹å¤–åç¦»çš„ï¼Œå³ä¸\\(\\mathcal T\\)æ­£äº¤ï¼Œæ‰€ä»¥\\(W^\\bot\\)ä¸»è¦æ˜¯åæ˜ å™ªå£°çš„éƒ¨åˆ†ã€‚è€Œå™ªå£°ä¸æ ·æœ¬åˆ†å¸ƒç›¸ç‹¬ç«‹çš„å‡è®¾æ˜¯åˆç†çš„ã€‚äºæ˜¯ï¼Œå¼‚å¸¸åˆ†æ•°å¯ä»¥å®šä¹‰ä¸ºï¼š \\[ p_X(\\bar x)=p_{W^\\parallel}(\\bar w^\\parallel)p_{W^\\bot}(\\bar w^\\bot)=\\begin{cases}\\geq \\gamma \\Rightarrow \\text{Inlier}\\\\&lt;\\gamma\\Rightarrow\\text{Outlier}\\end{cases} \\] Computing the Distribution of Data Samples ä¸Šé¢çš„å¼‚å¸¸åˆ†æ•°éœ€è¦è®¡ç®—\\(p_{W^\\parallel}(\\bar w^\\parallel)\\)å’Œ\\(p_{W^\\bot}(\\bar w^\\bot)\\)ã€‚ç»™å®šæµ‹è¯•æ ·æœ¬\\(\\bar x\\)ï¼ŒæŠ•å½±åˆ°æµå½¢\\(\\bar x^\\parallel=f(g(\\bar x))\\)ã€‚\\(\\bar w^\\parallel\\)å¯ä»¥é‡å†™ä¸º\\(\\bar w^\\parallel=U^{\\parallel^\\top}\\bar x=U^{\\parallel^\\top}(\\bar x-\\bar x^{\\parallel})+U^{\\parallel^\\top}\\bar x^\\parallel=U^{\\parallel^\\top}\\bar x^\\parallel\\)ï¼Œå³æˆ‘ä»¬å‡è®¾\\(U^{\\parallel^\\top}(\\bar x-\\bar x^\\parallel)\\approx 0\\)ã€‚äºæ˜¯æœ‰\\(w^\\parallel(z)=U^{\\parallel^\\top}f(\\bar z)+SV^\\top(z-\\bar z)+O(\\parallel z-\\bar z\\parallel^2)\\)ã€‚ å¦‚æœ\\(Z\\)ä¸ºå®šä¹‰åœ¨æµå½¢ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒï¼Œé‚£ä¹ˆï¼š \\[ p_{W^\\parallel}(w^\\parallel)=|\\text{det}S^{-1}|p_Z(z) \\] \\(p_{W^\\bot}(w^\\bot)\\)ç”±åŠå¾„ä¸º\\(\\parallel w^\\bot\\parallel\\)çš„è¶…çƒä½“\\(\\mathcal S^{m-n-1}\\)æ¥è¿›è¡Œä¼°è®¡ï¼š \\[ p_{W^\\bot}(w^\\bot)\\approx\\frac{\\Gamma(\\frac{m-n}{2})}{2\\pi^{\\frac{m-n}{2}}\\parallel w^\\bot\\parallel^{m-n}}p_{\\parallel W^\\bot\\parallel}(\\parallel w^\\bot\\parallel) \\] å…¶ä¸­\\(\\Gamma(\\cdot)\\)ä»£è¡¨Gammaå‡½æ•°ã€‚ Manifold Learning with Adversarial Autoencoders ä¸ºäº†å­¦ä¹ æ˜ å°„\\(f\\)å’Œ\\(g\\)ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†AAEæ¡†æ¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é™¤äº†å¸¸è§„çš„AAEå¤–ï¼Œæˆ‘ä»¬è¿˜ä¸º\\(x\\)æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„åˆ¤åˆ«å™¨ã€‚ Adversarial Losses å¯¹äºéšå˜é‡\\(z\\)ï¼Œå¯¹æŠ—æŸå¤±å‡½æ•°ä¸ºï¼š \\[ \\mathcal L_{adv-d_z}(x,g,D_z)=E[\\log(D_z(\\mathcal N(0,1)))]+E[\\log(1-D_z(g(x)))] \\] å¯¹äºæ ·æœ¬\\(x\\)ï¼Œå¯¹æŠ—æŸå¤±å‡½æ•°ä¸ºï¼š \\[ \\mathcal L_{adv-d_x}(x,D_x,f)=E[\\log(D_x(x))]+E[\\log(1-D_x(f(\\mathcal N(0,1))))] \\] Autoencoder Loss \\[ \\mathcal L_\\text{error}(x,g,f)=-E_z[\\log(p(f(g(x))|x))] \\] Full Objective \\[ \\mathcal L(x,g,D_z,D_x,f)=\\mathcal L_{adv-d_z}+\\mathcal L_{adv-d_x}+\\lambda \\mathcal L_\\text{error} \\] ä¸‹å›¾ä¸ºæ¨¡å‹é‡æ„çš„ä¾‹å­ï¼š Experiments Datasets MNIST. æ‰‹å†Œæ•°å­—è¯†åˆ«æ•°æ®é›†ã€‚ The Coil-100. åŒ…å«7200å¼ 100ä¸ªä¸åŒç‰©ä½“çš„ä¸åŒè§’åº¦çš„å›¾ç‰‡ã€‚ Fashion-MNIST. æ‰‹å†Œæ•°å­—è¯†åˆ«æ•°æ®é›†å½©è‰²ç‰ˆã€‚ Others. å‰ä¸‰ä¸ªæ•°æ®é›†éƒ½æ˜¯é‡‡ç”¨ä¸€ä¸ªç±»ä½œä¸ºinlierï¼Œè€Œå…¶ä»–ç±»ä½œä¸ºoutlierã€‚åœ¨è¿™ä¸€è®¾ç½®ä¸­inlieré‡‡æ ·è‡ªæ•°æ®é›†CIFAR-10(CIFAR-100)ï¼Œè€Œoutlieré‡‡æ ·è‡ªTinyImageNetã€LSUNå’ŒiSUNã€‚ Results MNIST Dataset Coil-100 Dataset Fashion-MNIST CIFAR-10 (CIFAR-100) Ablation","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"GAN","slug":"GAN","permalink":"http://qfxiao.me/tags/GAN/"},{"name":"Novelty Detection","slug":"Novelty-Detection","permalink":"http://qfxiao.me/tags/Novelty-Detection/"}]},{"title":"Estimate the Implicit Likelihoods of GANs with Application to Anomaly Detection","slug":"Estimate-the-Implicit-Likelihoods-of-GANs-with-Application-to-Anomaly-Detection","date":"2020-06-06T02:57:38.000Z","updated":"2020-06-25T10:59:03.358Z","comments":true,"path":"2020/06/06/Estimate-the-Implicit-Likelihoods-of-GANs-with-Application-to-Anomaly-Detection/","link":"","permalink":"http://qfxiao.me/2020/06/06/Estimate-the-Implicit-Likelihoods-of-GANs-with-Application-to-Anomaly-Detection/","excerpt":"","text":"Introduction Preliminaries Flow-based Models Recap Jacobian Matrix and Determinant è®¾å‡½æ•°\\(f:\\mathbb{R}^n\\mapsto\\mathbb{R}^m\\)ï¼Œç”±\\(f\\)çš„ä¸€é˜¶åå¯¼æ•°ç»„æˆçš„çŸ©é˜µå«åšJacobiançŸ©é˜µï¼š \\[ \\mathbf J=\\left[ \\begin{matrix} \\frac{\\partial f_1}{\\partial x_1} &amp;\\cdots &amp;\\frac{\\partial f_1}{\\partial x_n}\\\\ \\vdots &amp;\\ddots &amp;\\vdots\\\\ \\frac{\\partial f_m}{\\partial x_1}&amp; \\dots&amp; \\frac{\\partial f_m}{\\partial x_n} \\end{matrix} \\right] \\] Change of Variable Theorem ç»™å®šå·²çŸ¥æ¦‚ç‡åˆ†å¸ƒçš„éšæœºå˜é‡\\(z\\sim\\pi(z)\\)ï¼Œæ–°éšæœºå˜é‡ç”±å¯é€†æ˜ å°„\\(f\\)ç»™å‡º\\(x=f(z)\\)ï¼Œ\\(z=f^{-1}(x)\\)ã€‚ç”±äºï¼š \\[ \\int p(x)\\mathrm{d}x=\\int \\pi(z)\\mathrm d z=1 \\] æ‰€ä»¥\\(p(x)\\)å¯ä»¥ç”±ä¸‹å¼å¾—åˆ°ï¼š \\[ p(x)=\\pi(z)\\left|\\frac{\\mathrm d z}{\\mathrm d x}\\right|=\\pi(f^{-1}(x))\\left|\\frac{\\mathrm d f^{-1}}{\\mathrm d x}\\right|=\\pi(f^{-1}(x))|(f^{-1})^\\prime(x)| \\] \\(\\frac{\\mathrm d f^{-1}}{\\mathrm d x}\\)ç›¸å½“äºå¯¹é€†å‡½æ•°\\(f^{-1}\\)æ±‚å¯¼ï¼Œè€Œ\\(z=f^{-1}(x)\\)ã€‚ å¯¹äºå¤šå˜é‡çš„æƒ…å†µï¼š \\[ \\mathbf z\\sim \\pi(\\mathbf z), \\mathbf x=f(\\mathbf z),\\mathbf z = f^{-1}(\\mathbf x)\\\\ p(\\mathbf x) = \\pi(\\mathbf z)\\left|\\text{det}\\frac{\\mathrm d \\mathbf z}{\\mathrm d \\mathbf x}\\right|= \\pi(f^{-1}(\\mathbf x))\\left|\\text{det}\\frac{\\mathrm d f^{-1}}{\\mathrm d \\mathbf x}\\right| \\] \\(\\left|\\text{det}\\frac{\\mathrm d f^{-1}}{\\mathrm d \\mathbf x}\\right|\\)ä¸ºé€†å‡½æ•°JacobiançŸ©é˜µè¡Œåˆ—å¼çš„ç»å¯¹å€¼ã€‚ Deep Generative Models as Manifolds ä¸€ä¸ªæ·±åº¦ç”Ÿæˆæ¨¡å‹å¯ä»¥è¡¨ç¤ºä¸ºä»ä½ç»´éšç©ºé—´\\(\\mathcal Z \\subseteq R^d\\)æ˜ å°„åˆ°æµå½¢\\(\\mathcal M\\subseteq R^D\\)çš„åµŒå…¥å‡½æ•°\\(g:\\mathcal Z\\rightarrow \\mathcal X\\)ï¼Œ\\(D \\ll d\\)ã€‚é€šå¸¸å‡è®¾\\(g\\)ä¸ºå…‰æ»‘æ˜ å°„ï¼Œé‚£ä¹ˆ\\(\\mathcal M\\)ä¸ºä¸€ä¸ªåµŒå…¥æµå½¢ã€‚\\(g\\)åœ¨\\(z\\in\\mathcal Z\\)çš„é›…å„æ¯”çŸ©é˜µ\\(\\mathbf J_g(z)\\)æä¾›äº†åœ¨\\(x=g(z)\\in\\mathcal X\\)å¤„çš„åˆ‡ç©ºé—´ï¼Œå³\\(\\mathbf J_g:T_z\\mathcal Z\\rightarrow T_x\\mathcal X\\)ã€‚è¿™ä¸ªæ˜ å°„ä¸æ˜¯æ»¡å°„ï¼Œå¹¶ä¸”å€¼åŸŸé™åˆ¶åœ¨æµå½¢\\(\\mathcal M\\)åœ¨\\(x=g(z)\\)çš„åˆ‡ç©ºé—´ï¼Œè®°ä¸º\\(T_x\\mathcal M\\)ã€‚\\(\\mathcal M\\)ä¸çœŸå®æ•°æ®æµå½¢æ¥è¿‘ï¼Œå³\\(\\mathcal M_{data}\\)ã€‚ è€ƒè™‘ä¸€ä¸ªå®šä¹‰åœ¨éšç©ºé—´\\(\\mathcal Z\\)æ¯ä¸€ç‚¹\\(z\\)ä¸Šçš„Riemannian metricï¼š \\[ \\mathbf M(z)=\\mathbf J_g(z)^\\top\\mathbf J_g(z) \\] ç»™å®šä¸¤ä¸ªåˆ‡ç©ºé—´å‘é‡\\(u,v\\in T_z\\in\\mathcal Z\\)ï¼Œä»–ä»¬çš„å†…ç§¯å®šä¹‰ä¸º\\(&lt;u,v&gt;=u^\\top \\mathbf M(z)v\\)ã€‚ è€ƒè™‘ä¸€ä¸ªå…‰æ»‘æ›²çº¿\\(\\gamma:t\\in[a,b]\\rightarrow\\mathcal Z\\)ï¼Œ \\[ L(\\gamma)=\\int^b_a\\sqrt{\\hat{\\gamma}(t)^\\top M_{\\gamma(t)}\\hat{\\gamma}(t)}\\mathrm d t \\] Change of Variable on Manifolds åœ¨æµå½¢ä¸Šçš„Change of Variable Theoremæ˜¯ç±»ä¼¼çš„ï¼š \\[ p_\\mathcal{X}(x)=p_\\mathcal{Z}(g^{-1}(x))\\text{det}(\\mathbf J_g(g^{-1}(x))^\\top\\mathbf J_g(g^{-1}(x)))^{-\\frac{1}{2}} \\] æˆ‘ä»¬å‡è®¾éšç©ºé—´åˆ†å¸ƒ\\(p_\\mathcal{Z}\\)æœä»æ ‡å‡†æ­£æ€å…ˆéªŒåˆ†å¸ƒ\\(N(0,\\mathbf I_d)\\)ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡º\\(x\\)çš„ä¼¼ç„¶ï¼š \\[ \\log(p_\\mathcal{X}(g(z)))=\\log(p_\\mathcal{Z}(z))-\\frac{1}{2}\\log(\\text{det}(\\mathbf J_g(z)^\\top\\mathbf J_g(z))) \\] é€šå¸¸æˆ‘ä»¬æ²¡æ³•çŸ¥é“çœŸå®ä¸–ç•Œä¸­\\(\\mathcal M_{data}\\)çš„åˆ‡ç©ºé—´ç»´åº¦æ˜¯å¤šå°‘ï¼Œè®¾å®š\\(d=\\text{dim}\\mathcal Z&gt;T_x\\mathcal M_{data}\\)ä¼šå¯¼è‡´\\(\\mathbf J_g\\)ä¸æ˜¯æ»¡ç§©çŸ©é˜µï¼Œè¿™æ—¶\\(\\text{det}(\\mathbf J_g(z)^\\top\\mathbf J_g(z))=0\\)ï¼Œå³æ— æ³•åº”ç”¨ä¸Šå¼è®¡ç®—ä¼¼ç„¶ã€‚ Density Estimation with Neural Networks Anomaly Detection with Generative Models Proposed Method å¯¹äºGANæ¨¡å‹ï¼Œç»™å®šéšå˜é‡\\(z\\)å’Œç”Ÿæˆå™¨\\(g\\)ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¬å¼(8)è®¡ç®—ç”Ÿæˆæ ·æœ¬\\(g(z)\\)çš„å¯¹æ•°ä¼¼ç„¶ï¼Œä¸ºäº†ä¿è¯JacobiançŸ©é˜µä¸ºæ»¡ç§©ï¼Œæˆ‘ä»¬å¯ä»¥é€‰å®šè¾ƒä½çš„éšå˜é‡ç»´åº¦\\(d\\)ï¼Œä¸è¿‡è¿™æ ·ä¼šä¼¤å®³GANæ¨¡å‹çš„æ€§èƒ½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªinference networkæ¥å°†\\(x\\)æ˜ å°„å›\\(z\\)ï¼Œ The Variance Network of the Generator æ–‡ä¸­å¯¹ç”Ÿæˆå™¨\\(g\\)è¿›è¡Œäº†æ‰©å±•ï¼š \\[ f(z) = g(z) + \\sigma(z)\\odot\\epsilon,\\\\ g:\\mathcal Z\\rightarrow\\mathcal X, \\sigma:\\mathcal Z\\rightarrow\\mathbb{R},\\epsilon\\sim N(0,\\mathbf I_D) \\] \\(g\\)ä»£è¡¨å‡å€¼ï¼Œ\\(\\sigma\\)ä»£è¡¨æ–¹å·®ï¼Œå®é™…ä¸Š\\(\\mathbb E_{\\epsilon\\sim N(0,\\mathbf I_D)}f(z)=g(z)\\)ã€‚ä¸ºäº†ä¿è¯æ–¹å·®åœ¨å°‘æ ·æœ¬æˆ–æ— æ ·æœ¬çš„åŒºåŸŸæ›´å¤§ï¼Œæ–¹å·®ç½‘ç»œé‡‡ç”¨RBFç½‘ç»œå®ç°ã€‚ RBFç½‘ç»œï¼š \\[ h(x)=\\exp\\left(-\\frac{(x-c)^2}{r^2}\\right) \\] é¦–å…ˆï¼Œä»éšç©ºé—´é‡‡æ ·å¤§é‡çš„æ ·æœ¬ï¼Œä¹‹åä½¿ç”¨K-meansç®—æ³•å°†å…¶åˆ†ä¸º\\(K\\)ä¸ªèšç°‡ï¼Œ\\(c_k\\)ä¸ºç¬¬\\(k\\)ä¸ªç°‡çš„ä¸­å¿ƒï¼Œ\\(C_k\\)ä¸ºç¬¬\\(k\\)ä¸ªç°‡çš„æ ·æœ¬æ•°é‡ã€‚å¯¹äºä»»ä½•æ ·æœ¬\\(x\\)ï¼Œä¸ºäº†è®¡ç®—å…¶å¯¹åº”çš„æ–¹å·®ï¼Œéœ€è¦ç”¨ä¸€ä¸ªinference network \\(h\\)æ¥å°†å…¶æ˜ å°„åˆ°éšç©ºé—´ï¼Œå³\\(z=h(x)\\)ã€‚RBFç½‘ç»œé€šè¿‡è¾“å…¥\\(z\\)åˆ°æ¯ä¸ªç°‡ä¸­å¿ƒçš„è·ç¦»æ¥è¿”å›\\(x\\)å¯¹åº”çš„æ–¹å·®ï¼ŒRBFå‡½æ•°ç”±ä¸‹å¼ç»™å‡ºï¼š \\[ \\sigma(z)=(\\mathbf W^2\\mathbf v(z))^{-\\frac{1}{2}},\\\\ v_k(z) = \\exp(-\\lambda_k\\parallel z-c_k\\parallel^2_2), \\space k=1,\\cdots,K\\\\ \\lambda_k=\\frac{1}{2}\\left(\\frac{a}{|C_k|}\\sum_{z_j\\in C_k}\\parallel z_j-c_k\\parallel_2\\right)^{-2} \\] å…¶ä¸­\\(\\alpha\\)ä¸ºæ ¸çš„è¶…å‚æ•°ï¼Œ\\(\\mathbf W\\)ä¸ºæ¨¡å‹å‚æ•°ã€‚ç»™å®šç”Ÿæˆå™¨\\(g\\)ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æœ€å°åŒ–\\(f(z)\\)å’Œ\\(x\\)ä¹‹é—´çš„è·ç¦»æ¥ä¼˜åŒ–å‚æ•°\\(\\mathbf W\\)ã€‚ \\[ \\begin{align} \\bar{\\mathbf M}^z_f&amp;=\\mathbb E_{\\epsilon\\sim N(0,\\mathbf I_D)}\\mathbf J_f^\\top(z)\\mathbf J_f(z)\\\\ &amp;=\\mathbf J_g^\\top(z)\\mathbf J_g(z)+\\mathbf J_\\sigma^\\top(z)\\mathbf J_\\sigma(z) \\end{align} \\] LEMMA 1. å¯¹äº\\(K\\geq \\text{dim}(\\mathcal Z)+1\\)å’Œæ»¡ç§©çŸ©é˜µ\\(\\mathbf W^2\\)ï¼Œ\\(\\bar{\\mathbf M}_f^z\\)ä¸ºä¸€ä¸ªæ»¡ç§©çŸ©é˜µã€‚ç”Ÿæˆæ ·æœ¬çš„å¯¹æ•°ä¼¼ç„¶ç”±ä¸‹å¼ç»™å‡ºï¼š \\[ \\mathbb E_{\\epsilon\\sim N(0,\\mathbf I_D)}\\log(p_\\mathcal{X}(f(z)))=\\log(p_\\mathcal{Z}(z))-\\frac{1}{2}\\log(\\text{det}(\\bar{\\mathbf M}_f^z)) \\] The Inference Network Learning \\[ \\max_{h,\\sigma}\\mathbb E_{x\\sim p_{data}(x)}\\left[\\log(p(x|z))|_{z=h(x)}\\right] \\] \\(p(x|z)\\) \\[ \\max_{h,\\sigma}\\mathbb E_{x\\sim p_{data}(x), z=h(x)}\\left[\\log(p(x|z))-\\text{KL}\\right] \\] LEMMA 2. \\[ f(z)\\sim GP(g(z), \\Lambda_\\sigma) \\] \\[ L_{h,\\sigma}=\\mathbb E_{x\\sim p_{data}}\\left[\\sum_{i=1}^D[-\\frac{1}{2}(g_i(h(x))-x_i)^2/\\sigma_i^2(h(x))-\\log\\sigma_i(h(x))]-\\text{KL}(q(z|x)\\parallel p(z))\\right] \\] Stabilize Training \\[ \\min_{g,h}\\mathbb E_{z\\sim p(z)}[\\parallel z-h(g(z))\\parallel^2] \\] Algorithm LEMMA 3. Experiments","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"GAN","slug":"GAN","permalink":"http://qfxiao.me/tags/GAN/"}]},{"title":"Classification-based Anomaly Detection for General Data","slug":"Classification-based-Anomaly-Detection-for-General-Data","date":"2020-06-02T15:01:34.000Z","updated":"2020-06-26T12:55:43.589Z","comments":true,"path":"2020/06/02/Classification-based-Anomaly-Detection-for-General-Data/","link":"","permalink":"http://qfxiao.me/2020/06/02/Classification-based-Anomaly-Detection-for-General-Data/","excerpt":"","text":"Introduction æœ¬æ–‡ä¸»è¦æ˜¯å¯¹NIPS18è¿™ç¯‡å¼‚å¸¸æ£€æµ‹æ–‡ç« çš„æ”¹è¿›ï¼Œé¦–å…ˆæ˜¯åˆ©ç”¨äº†æ ‡ç­¾ä¿¡æ¯æ¥æå‡ç®—æ³•çš„è¡¨ç°ï¼Œå…¶æ¬¡æ˜¯å°†ç®—æ³•æ‰©å±•åˆ°äº†éå›¾åƒæ•°æ®ã€‚ä½œè€…å¯¹ç°æœ‰çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•è¿›è¡Œäº†å›é¡¾ï¼š Reconstruction Methodsï¼š è¿™ä¸€éƒ¨åˆ†æ–¹æ³•å‡è®¾å¼‚å¸¸æ ·æœ¬å’Œæ­£å¸¸æ ·æœ¬èƒ½å¤Ÿé€šè¿‡é‡æ„ä»»åŠ¡æ¥è¿›è¡ŒåŒºåˆ†ã€‚é€šè¿‡åœ¨æ­£å¸¸æ ·æœ¬ä¸Šå­¦ä¹ é‡æ„ä»»åŠ¡ï¼Œä¹‹åå¯¹äºæ­£å¸¸æ ·æœ¬ï¼Œæ¨¡å‹èƒ½å¤Ÿå¾ˆå¥½åœ°è¿›è¡Œé‡æ„ï¼Œè€Œå¼‚å¸¸æ ·æœ¬åˆ™ä¼šæœ‰è¾ƒé«˜çš„é‡æ„è¯¯å·®ã€‚ Distributional Methodsï¼š è¿™ä¸€éƒ¨åˆ†æ–¹æ³•å°†å¼‚å¸¸æ£€æµ‹çœ‹ä½œæ˜¯å¯†åº¦ä¼°è®¡é—®é¢˜ã€‚é€šè¿‡å¯¹æ­£å¸¸æ ·æœ¬çš„åˆ†å¸ƒè¿›è¡Œä¼°è®¡ï¼Œå¼‚å¸¸æ ·æœ¬åœ¨è¯¥æ­£å¸¸åˆ†å¸ƒä¸‹çš„ä¼¼ç„¶å°†ä¼šå¾ˆä½ã€‚ Classification-based Methodsï¼š è¿™ä¸€éƒ¨åˆ†æ–¹æ³•ä¸»è¦æ˜¯æŒ‡çš„å•åˆ†ç±»æ–¹æ³•å’Œé€šè¿‡å‡ ä½•å˜æ¢æ„é€ åˆ†ç±»ä»»åŠ¡çš„æ–¹æ³•ã€‚æœ¬æ–‡ä½¿ç”¨çš„å°±æ˜¯è¿™ç±»æ–¹æ³•ã€‚ Proposed Method Classification-based Anomaly Detection å‡è®¾æ‰€æœ‰æ•°æ®ä½äºç©ºé—´\\(R^L\\)å†…ï¼Œè€Œæ­£å¸¸æ•°æ®ä½äºå­ç©ºé—´\\(X\\subset R^L\\)å†…ã€‚æˆ‘ä»¬å‡è®¾æ‰€æœ‰çš„å¼‚å¸¸æ ·æœ¬ä½äº\\(X\\)ä¹‹å¤–ã€‚ä¸ºäº†æ£€æµ‹å¼‚å¸¸ï¼Œæˆ‘ä»¬å¸Œæœ›å­¦ä¹ ä¸€ä¸ªåˆ†ç±»å™¨\\(C\\)ä½¿å¾—å¯¹äºæ‰€æœ‰çš„\\(x\\in X\\)æœ‰\\(C(x)=1\\)ï¼Œè€Œå¯¹æ‰€æœ‰çš„\\(x\\in R^L\\backslash X\\)æœ‰\\(C(x)=0\\)ã€‚ å•åˆ†ç±»æ–¹æ³•çš„æ€æƒ³æ˜¯ç›´æ¥å­¦ä¹ \\(P(x\\in X)\\)ï¼Œä»£è¡¨çš„æ–¹æ³•æœ‰One-Class SVMï¼ŒDSVDDç­‰ã€‚ä¼ ç»Ÿçš„OC-SVMç›´æ¥åœ¨åŸå§‹ç©ºé—´æˆ–è€…æ ¸ç©ºé—´å­¦ä¹ åˆ†ç±»å™¨ã€‚æ¯”è¾ƒæ–°çš„æ–¹æ³•ï¼Œå¦‚Deep-SVDDåˆ™æ˜¯å…ˆå°†æ ·æœ¬è½¬æ¢åˆ°ä¸€ä¸ªç‰¹å¾ç©ºé—´ï¼Œç„¶ååœ¨è¿™ä¸ªç‰¹å¾ç©ºé—´ä¸Šå­¦ä¹ ä½¿å¾—åŠå¾„\\(R\\)æœ€å°çš„è¶…çƒä½“ï¼ˆçƒå¿ƒ\\(c_0\\)ï¼‰ï¼Œæ¥è¦†ç›–ä½æ‰€æœ‰æ­£å¸¸æ ·æœ¬ã€‚å¼‚å¸¸çš„åˆ¤å®šåˆ™é€šè¿‡è®¡ç®—\\(\\parallel f(x)-c_0\\parallel^2-R^2\\)æ¥å®ç°ã€‚ä¸è¿‡å­¦ä¹ ä¸€ä¸ªå¥½çš„æ ·æœ¬åˆ°ç‰¹å¾ç©ºé—´çš„å˜æ¢å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¯´\\(f(x)=0, \\forall x \\in X\\)å°±æ˜¯ä¸€ä¸ªä½¿å¾—è¶…çƒä½“æœ€å°çš„è§£ã€‚æ‰€ä»¥éœ€è¦å¾ˆå¤štrickæ¥é¿å…è¯¸å¦‚æ­¤ç±»çš„æƒ…å†µã€‚ Geometric-transformation classification (GEOM) åˆ™å°†æ•°æ®ç©ºé—´\\(X\\)é€šè¿‡\\(M\\)ä¸ªå‡ ä½•å˜æ¢è½¬æ¢åˆ°ä¸€ç³»åˆ—å­ç©ºé—´\\(X_1,\\cdots,X_M\\)ã€‚ä¹‹åè®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨æ¥é¢„æµ‹æ ·æœ¬\\(T(x,m)\\)å¯¹åº”çš„å‡ ä½•å˜æ¢çš„ç§ç±»\\(m\\)ã€‚è½¬æ¢åçš„æ­£å¸¸å›¾ç‰‡ç©ºé—´è®°ä¸º\\(\\cup_m X_m\\)ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•å°è¯•ä¼°è®¡ä»¥ä¸‹æ¡ä»¶æ¦‚ç‡ï¼š \\[ P(m^\\prime|T(x,m))=\\frac{P(T(x,m)\\in X_{m^\\prime})P(m^\\prime)}{\\sum_{\\bar{m}}P(T(x,m)\\in X_{\\bar{m}})P(\\tilde{m})}-\\frac{P(T(x,m)\\in X_{m^\\prime})}{\\sum_{\\bar{m}}P(T(x,m)\\in X_{\\bar{m}})} \\] å¯¹äºå¼‚å¸¸çš„æ ·æœ¬\\(x\\in R^L\\backslash X\\)ï¼Œåœ¨ç»è¿‡å‡ ä½•å˜æ¢ä¹‹åï¼Œéƒ½ä¸ä¼šä½äºæ­£ç¡®çš„å­ç©ºé—´ä¸­ï¼Œå³\\(T(x,m)\\in R^L\\backslash X_m\\)ã€‚ä¹‹åï¼Œä½¿ç”¨\\(P(m|T(x,m))\\)æ¥åˆ¤å®šå¼‚å¸¸ã€‚ ä½œè€…è®¤ä¸ºï¼Œè¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯åˆ†ç±»å™¨\\(P(m^\\prime|T(x,m))\\)åªåœ¨æ­£å¸¸æ•°æ®ä¸Šè®­ç»ƒï¼Œè€Œå¯¹äºå¼‚å¸¸æ ·æœ¬çš„å¼‚å¸¸åˆ†æ•°ä¼šå‡ºç°æ–¹å·®å¾ˆå¤§çš„é—®é¢˜ã€‚ ä¸€ç§è§£å†³æ–¹å¼æ˜¯åŠ å…¥å¼‚å¸¸æ ·æœ¬è¿›è¡Œè®­ç»ƒï¼Œä½†æ˜¯ä½œè€…è®¤ä¸ºåœ¨æœ‰çš„ä»»åŠ¡ä¸­æ ‡ç­¾å¾ˆéš¾è·å–ï¼Œäºæ˜¯ä½œè€…ä½¿ç”¨äº†å¦å¤–ä¸€ç§æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ Distance-based Multiple Transformation Classification å’ŒGEOMä¸€æ ·ï¼Œå…ˆå¯¹æ¯ä¸ªæ ·æœ¬è¿›è¡Œ\\(M\\)ä¸ªå‡ ä½•å˜æ¢ï¼Œç„¶åå­¦ä¹ ä¸€ä¸ªç‰¹å¾æå–å™¨\\(f(x)\\)ï¼Œå°†\\(X_m\\)æ˜ å°„åˆ°ç‰¹å¾ç©ºé—´ã€‚ä¹‹åå’ŒOC-SVMç±»ä¼¼ï¼Œå‡è®¾ç‰¹å¾\\(\\{f(x)|x\\in X_m\\}\\)ä¸ºçƒå¿ƒä¸º\\(c_m=\\frac{1}{N}\\sum_{x\\in X} f(T(x,m))\\)çš„è¶…çƒä½“ã€‚æ ·æœ¬å±äºæŸä¸€ç±»\\(m^\\prime\\)çš„æ¦‚ç‡ç”±ä¸‹å¼ç»™å‡ºï¼š \\[ P(m^\\prime|T(x,m))=\\frac{e^{-\\parallel f(T(x,m))-c_{m^\\prime}\\parallel^2}}{\\sum_{\\bar m}e^{-\\parallel f(T(x,m))-c_{\\bar m}\\parallel^2}} \\] ç›®æ ‡å‡½æ•°é‡‡ç”¨çš„æ˜¯Triplet Lossï¼š \\[ L=\\sum_i\\max(\\parallel f(T(x_i,m))-c_m\\parallel^2+s-\\min_{m^\\prime\\neq m}\\parallel f(T(x_i,m))-c_{m^\\prime}\\parallel^2,0) \\] \\(\\parallel f(T(x_i,m))-c_m\\parallel^2\\)ç›¸å½“äºæœ€å°åŒ–äº†ç±»å†…è·ç¦»ï¼Œ\\(\\min_{m^\\prime\\neq m}\\parallel f(T(x_i,m))-c_{m^\\prime}\\parallel^2\\)æœ€å¤§åŒ–äº†æ¯ä¸ªç±»å¯¹åº”çš„é›†ç°‡é—´è·ç¦»ã€‚åœ¨æ£€æµ‹é˜¶æ®µï¼Œä¸ºäº†é¿å…ä¸€äº›æ•°å€¼é—®é¢˜ï¼Œä½œè€…åšäº†ä¸€äº›å¹³æ»‘æ“ä½œï¼š \\[ \\tilde P(m^\\prime|T(x,m))=\\frac{e^{-\\parallel f(T(x,m))-c_{m^\\prime}\\parallel^2+\\epsilon}}{\\sum_{\\tilde m}e^{-\\parallel f(T(x,m))-c_{\\tilde m}\\parallel^2+M\\cdot\\epsilon}} \\] æœ€åçš„è¯„åˆ¤åˆ†æ•°ç”±ä¸‹å¼ç»™å‡ºï¼š \\[ Score(x)=-\\log P(x\\in X)=-\\sum_m\\log \\tilde{P}(T(x,m)\\in X_m)=-\\sum_m\\log\\tilde{P}(m|T(x,m)) \\] ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š Parameterizing the Set of Transformations åœ¨GEOMä¸­ï¼Œç”±äºä½¿ç”¨çš„å‡ ä½•å˜æ¢éƒ½æ˜¯é’ˆå¯¹å›¾åƒçš„ï¼Œæ‰€ä»¥å¯¹äºå…¶ä»–ç±»å‹çš„æ•°æ®å¹¶ä¸é€‚ç”¨ã€‚æœ¬æ–‡ä¸­ä½œè€…å¯¹éå›¾åƒæ•°æ®è®¾è®¡äº†ä»¥ä¸‹å˜æ¢ï¼š \\[ T(x,m)=W_mx+b_m \\] ä¸åŒçš„å‚æ•°\\(W_m\\)å’Œ\\(b_m\\)å³ä¸ºä¸åŒçš„å‡ ä½•å˜æ¢ï¼Œå¯ä»¥è€ƒè™‘é‡‡ç”¨éšæœºé‡‡æ ·çš„æ–¹å¼ã€‚ Experiments Image Experiments å¯¹äºå›¾åƒæ•°æ®çš„å¼‚å¸¸æ£€æµ‹å®éªŒï¼Œä½œè€…é‡‡ç”¨äº†CIFAR10ã€FasionMNISTè¿™ä¸¤ä¸ªæ•°æ®é›†ï¼Œå®éªŒç»“æœå¦‚ä¸‹ï¼š Tabular Data Experiments å¯¹äºéå›¾åƒæ•°æ®ï¼Œä½œè€…é‡‡ç”¨äº†å‡ ä¸ªå°çš„æ•°æ®é›†ï¼šArrhythmiaã€Thyroidã€KDDå’ŒKDDRevã€‚é‡‡ç”¨çš„BaselineåŒ…æ‹¬OC-SVMã€E2E-AEã€LOFã€DAGMMå’ŒFB-AE (Feature Bagging Autoencoder)ã€‚å¯¹äºå‡ ä½•å˜æ¢çš„å‚æ•°ï¼Œé‡‡æ ·è‡ªæ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚ç»“æœå¦‚ä¸‹ï¼š Remark ç»“åˆOpenReviewä¸Šçš„ä¸€äº›è®¨è®ºï¼Œè¿™é‡Œæå‡ºä¸€äº›é—®é¢˜å’Œæ€»ç»“ï¼š KDDæ•°æ®é›†å¤ªç®€å•äº†ï¼Œæ­£å¸¸ã€å¼‚å¸¸æ ·æœ¬èƒ½å¤Ÿå¾ˆå®¹æ˜“è¢«åˆ†å¼€ï¼› å¯¹äºå›¾åƒæ•°æ®ä½œè€…åªä½¿ç”¨äº†CIFAR10å’ŒFashionMNISTè¿™ä¸¤ä¸ªæ¯”è¾ƒå°çš„æ•°æ®é›†ï¼Œè€Œåœ¨GEOMä¸­è¿˜ä½¿ç”¨äº†CIFAR100å’ŒCatsVsDogsã€‚å¹¶ä¸”GEOMåŸæ–‡ä¸­æåˆ°æ•°æ®é›†ï¼ˆæŒ‡å›¾åƒå¤§å°ï¼‰è¶Šå¤§ï¼ŒGEOMçš„ä¼˜åŠ¿å°±è¶Šæ˜æ˜¾ï¼Œæ‰€ä»¥åœ¨æœ¬æ–‡çš„å®éªŒä¸­åªä½¿ç”¨è¿™ä¸¤ä¸ªæ•°æ®é›†è¯´æœåŠ›ç•¥æ˜¾ä¸å¤Ÿï¼› å…³äºè¯„æµ‹æ ‡å‡†çš„é—®é¢˜ï¼Œä½œè€…åœ¨å›¾åƒæ•°æ®ä¸­ç”¨çš„æ˜¯AUROCï¼Œè€Œéå›¾åƒæ•°æ®ç”¨çš„æ˜¯F1 scoreã€‚åƒAUPRã€AUROCè¿™ç§è¯„æµ‹æ ‡å‡†å¾€å¾€æ›´åŠ å…¨é¢ï¼Œè€ŒF1 scoreä¾èµ–äºé˜ˆå€¼çš„é€‰å–ã€‚å¦‚æœæ˜¯éå†é˜ˆå€¼æ‰¾åˆ°æœ€å¥½çš„é‚£ä¸ªF1 scoreï¼Œåˆ™æ— æ³•å…¨é¢è€ƒå¯Ÿæ¨¡å‹çš„é²æ£’æ€§ï¼Œæ¨¡å‹æœ‰å¯èƒ½åªæ˜¯åœ¨ç‰¹å®šçš„é˜ˆå€¼ä¸‹è¡¨ç°å¾ˆå¥½ï¼Œè€Œé˜ˆå€¼ç¨å¾®åå·®ä¸€ä¸‹æ€§èƒ½å¯èƒ½å°±ä¼šå¤§å¹…ä¸‹é™ã€‚æˆ‘çœ‹åˆ°çš„å¤§å¤šæ•°å¼‚å¸¸æ£€æµ‹æ–‡ç« éƒ½æ˜¯ä½¿ç”¨AUROCæˆ–è€…F1åŠ ä¸ŠAUROCä½œä¸ºè¯„æµ‹æŒ‡æ ‡ï¼› æ–‡ä¸­åœ¨ç¬¬äºŒèŠ‚â€œCLASSIFICATION-BASED ANOMALY DETECTIONâ€çš„æœ«å°¾ä¸¤æ®µå…³äºGEOMæ–¹æ³•çš„ç¼ºç‚¹è¯´çš„å¾ˆæ¨¡ç³Šã€‚å¼‚å¸¸åˆ†æ•°çš„æ–¹å·®å¤§åˆ°åº•æŒ‡çš„æ˜¯ä»€ä¹ˆï¼› å…³äºä½œè€…æå‡ºçš„å˜æ¢\\(T(x,m)=W_mx+b_m\\)å¹¶æ²¡æœ‰ç”¨åˆ°å›¾åƒæ•°æ®çš„å®éªŒä¸Šï¼Œè€Œä¸”åœ¨å®éªŒä¸­\\(b_m\\)è¿™ä¸ªå‚æ•°å®é™…ä¸Šæ˜¯è¢«å¿½ç•¥æ‰äº†çš„ï¼Œ\\(b_m\\)çš„ä½œç”¨ç©¶ç«Ÿå¦‚ä½•ä¸å¾—è€ŒçŸ¥ã€‚è€Œä¸”GEOMä¸­çš„å‡ ä½•å˜æ¢çš„Motivationåœ¨åŸæ–‡ä¸­æ˜¯åšäº†å®éªŒå……åˆ†è®¨è®ºäº†çš„ï¼ŒGEOMçš„ä½œè€…è®¤ä¸ºè¿™äº›å‡ ä½•å˜æ¢ä¿ç•™äº†å›¾åƒçš„é«˜é˜¶è¯­ä¹‰ä¿¡æ¯ã€‚è€Œæœ¬æ–‡ä¸­çš„å˜æ¢ä¸­çš„å‚æ•°åªæ˜¯éšæœºé‡‡æ ·è€Œæ¥ï¼Œå¹¶ä¸å­˜åœ¨è¯´ä¿ç•™åŸå§‹æ•°æ®ä¸­çš„ç»“æ„ä¿¡æ¯ã€‚å¦‚æœå¿½ç•¥æ‰è¿™ä¸€å±‚å˜æ¢ï¼Œé‚£å°±ç±»ä¼¼äºåŠ äº†ç¥ç»ç½‘ç»œæå–ç‰¹å¾çš„OC-SVMã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"}]},{"title":"é¢å‘OpenPAIçš„Dockeré•œåƒé…ç½®åŠOpenPAIåŸºæœ¬ä½¿ç”¨æ–¹æ³•","slug":"é¢å‘OpenPAIçš„Dockeré•œåƒé…ç½®åŠOpenPAIåŸºæœ¬ä½¿ç”¨æ–¹æ³•","date":"2020-06-02T04:26:13.000Z","updated":"2020-08-01T04:00:16.325Z","comments":true,"path":"2020/06/02/é¢å‘OpenPAIçš„Dockeré•œåƒé…ç½®åŠOpenPAIåŸºæœ¬ä½¿ç”¨æ–¹æ³•/","link":"","permalink":"http://qfxiao.me/2020/06/02/%E9%9D%A2%E5%90%91OpenPAI%E7%9A%84Docker%E9%95%9C%E5%83%8F%E9%85%8D%E7%BD%AE%E5%8F%8AOpenPAI%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/","excerpt":"","text":"Introduction å®éªŒå®¤æœåŠ¡å™¨é›†ç¾¤é‡‡ç”¨OpenPAIæ¥è¿›è¡ŒGPUèµ„æºçš„ç®¡ç†ï¼Œè€ŒOpenPAIé‡‡ç”¨äº†Dockerä½œä¸ºåŸºç¡€ï¼Œå³ä»£ç éƒ½æ”¾åœ¨Dockerå®¹å™¨ä¸­è¿è¡Œã€‚ç”±äºDockerçš„ä½¿ç”¨ã€Dockeré•œåƒçš„é…ç½®éƒ½æœ‰ä¸€å®šçš„é—¨æ§›ï¼Œæ‰€ä»¥è¿™é‡Œå†™ä¸€ç¯‡Tutorialæ¥è¿›è¡Œä»‹ç»ã€‚æœ¬æ–‡ä¸æ˜¯ç½‘ä¸Šèµ„æ–™çš„æ‹¼å‡‘ï¼Œè€Œæ˜¯ç»è¿‡æœ¬äººèµ°å¼¯è·¯è¸©å‘å½¢æˆçš„\"Best practice\"ã€‚ä¸»è¦å†…å®¹åŒ…æ‹¬Dockerçš„ä»‹ç»ã€Dockerçš„åŸºæœ¬ä½¿ç”¨ã€å¦‚ä½•é…ç½®è‡ªå·±çš„Dockeré•œåƒä»¥åŠOpenPAIå¹³å°çš„åŸºæœ¬ä½¿ç”¨ï¼Œä½†ä¸åŒ…æ‹¬Dockerå’ŒOpenPAIçš„å®‰è£…ã€‚ 2020.8.1 Update: åŠ å…¥é€šè¿‡HDFSè¯»å–å®¹å™¨ä¿å­˜çš„æ–‡ä»¶çš„æ–¹æ³• Docker from Scratch è¦ç†è§£Dockeræ˜¯ä»€ä¹ˆï¼Œä»è™šæ‹Ÿæœºå¼€å§‹è®²å¯èƒ½ä¼šæ¯”è¾ƒå¥½ç†è§£ã€‚è™šæ‹Ÿæœºå¤§å®¶å¯èƒ½éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œæ¯”å¦‚è¯´æˆ‘ç”¨çš„ç³»ç»Ÿæ˜¯Windowsï¼Œä½†æˆ‘éœ€è¦Linuxç³»ç»Ÿæ¥ä½œä¸ºä¸€ä¸ªFlaskç¼–å†™çš„ç½‘ç«™çš„æœåŠ¡å™¨ï¼Œä½†æ˜¯åˆä¸æƒ³å•ç‹¬å®‰è£…Linuxç³»ç»Ÿï¼Œäºæ˜¯å¯ä»¥ä½¿ç”¨è™šæ‹Ÿæœºæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®‰è£…VMWare Workstationï¼Œå»å®˜ç½‘ä¸‹è½½Ubuntuç³»ç»Ÿé•œåƒï¼Œç„¶ååœ¨VMWareä¸­å®‰è£…å¥½ç³»ç»Ÿï¼Œç„¶åä»å¤´é…ç½®Flaskç›¸å…³ç¯å¢ƒã€‚å®é™…ä¸Šæˆ‘éœ€è¦çš„ä»…ä»…æ˜¯ä¸€ä¸ªFlaskè¿è¡Œç¯å¢ƒè€Œå·²ï¼Œè€Œä½¿ç”¨è™šæ‹Ÿæœºå´éœ€è¦å¦‚æ­¤â€œå¤§è´¹å‘¨ç« â€ï¼Œè¿™æ—¶Dockerå‡ºç°äº†ï¼Œç½‘ä¸Šæœ‰å¤§é‡ç°æˆçš„Flask Dockeré•œåƒï¼Œé…ç½®å¥½äº†ä½ æ‰€éœ€çš„Flaskç¯å¢ƒï¼Œä½ åªéœ€è¦ä¸‹è½½è¿™äº›é•œåƒï¼Œç„¶åè¿è¡Œå®ƒï¼Œä½ å°±å¾—åˆ°äº†ä¸€ä¸ªFlaskè¿è¡Œç¯å¢ƒï¼Œè€Œä¸ä½ å½“å‰ä½¿ç”¨çš„ç³»ç»Ÿæ— å…³ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªTomcatçš„è¿è¡Œç¯å¢ƒï¼Œé‚£ä¹ˆå»æ‰¾ä¸€ä¸ªTomcatçš„Dockeré•œåƒå°±è¡Œã€‚Dockerå°†éœ€æ±‚æˆ–è€…è¯´æœåŠ¡ç»‘å®šåœ¨äº†Dockeré•œåƒä¸­ï¼ˆè½»é‡åŒ–ï¼Œä¸€ä¸ªéœ€æ±‚å¯¹åº”ä¸€ä¸ªDockeré•œåƒï¼Œæ¯ä¸ªé•œåƒéƒ½å¾ˆå°ï¼‰ï¼Œä½ æœ‰ä»€ä¹ˆéœ€æ±‚ï¼Œå»æ‰¾ç›¸åº”çš„é•œåƒå³å¯ï¼ˆæˆ–è€…è‡ªå·±å†™ä¸€ä¸ªï¼‰ï¼Œé•œåƒçš„è¿è¡Œæ˜¯ä»¥è™šæ‹Ÿæœºçš„å½¢å¼å­˜åœ¨ï¼Œæ‰€ä»¥ä»–ä»¬ä¹‹é—´ä¹Ÿæ˜¯äº’ä¸å¹²æ‰°çš„ã€‚åŒæ—¶ï¼Œä½ åœ¨å†™å¥½ä¸€ä¸ªDockeré•œåƒä¹‹åï¼Œä½ è¿˜å¯ä»¥åˆ†äº«ç»™åˆ«äººï¼Œè¿™æ ·å…¶ä»–äººå°±ä¸ç”¨é‡æ–°é…ç½®ï¼Œç›´æ¥è¿è¡Œä½ ç»™ä»–çš„é•œåƒå³å¯ã€‚Dockeræœ‰ä¸¤ä¸ªæ¯”è¾ƒå…³é”®çš„æ¦‚å¿µï¼š é•œåƒ Imagesï¼š è¿™é‡Œçš„é•œåƒä¸æ˜¯æŒ‡æˆ‘ä»¬å®‰è£…ç³»ç»Ÿæ—¶ä¸‹è½½çš„ISOé•œåƒï¼ŒDockeré•œåƒå°±æ˜¯æŠŠä½ éœ€è¦çš„ä¸œè¥¿ï¼ˆä¸€ä¸ªç³»ç»Ÿ+éœ€è¦çš„æœåŠ¡ï¼‰é›†ä¸­åˆ°ä¸€èµ·ï¼Œç›¸å½“äºåšèœçš„èœè°±ï¼› å®¹å™¨ Containersï¼š å¦‚æœä¸€ä¸ªDockeré•œåƒå¯åŠ¨äº†ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ä¸€ä¸ªDockerå®¹å™¨äº§ç”Ÿï¼Œç›¸å½“äºæŒ‰ç…§èœè°±åšå‡ºæ¥çš„èœã€‚ è¿™ä¸€èŠ‚æˆ‘ä»¬å…ˆä¸è®¨è®ºå¦‚ä½•è‡ªå·±å†™Dockeré•œåƒï¼Œåªæ˜¯å…ˆè®¨è®ºDockerçš„åŸºæœ¬æ“ä½œã€‚ Basic Operations Dockeræ–°å®‰è£…å¥½å½“ç„¶æ˜¯æ²¡æœ‰ä»€ä¹ˆé•œåƒçš„ï¼Œé¦–å…ˆæˆ‘ä»¬ä½¿ç”¨docker pull hello-worldæ¥ä¸‹è½½ä¸€ä¸ªæµ‹è¯•é•œåƒã€‚ æ‹‰å–é•œåƒ docker pull &lt;image_name&gt; åœ¨è¾“å…¥ä¹‹åï¼ŒDockerä¼šè‡ªåŠ¨åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸ŠæŸ¥æ‰¾å¯¹åº”çš„é•œåƒè¿›è¡Œä¸‹è½½ã€‚ç”±äºæˆ‘çš„ç”µè„‘ä¸Šå·²ç»æœ‰è¿™ä¸ªé•œåƒäº†ï¼Œæ‰€ä»¥æ˜¾ç¤ºæ˜¯ä¸‹é¢çš„æ ·å­ï¼š æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¾“å…¥docker run hello-worldè¿è¡Œè¿™ä¸ªé•œåƒã€‚ è¿è¡Œé•œåƒdocker run &lt;image_name&gt; å¯ä»¥çœ‹åˆ°ï¼ŒDockerè¾“å‡ºäº†ä¸€äº›ä¿¡æ¯å°±è‡ªå·±é€€å‡ºäº†ï¼Œè¿™å’Œæˆ‘ä»¬ç†è§£çš„è™šæ‹Ÿæœºä¸å¤ªä¸€æ ·ã€‚åœ¨Dockeré‡Œé¢ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿï¼Œç”¨æˆ·åœ¨è¿è¡Œä¹‹åå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨è¿™ä¸ªæ“ä½œç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„æœåŠ¡ï¼Œé»˜è®¤è¿è¡Œå®Œä¸€äº›æŒ‡ä»¤å°±é€€å‡ºäº†ã€‚è¿™é‡Œçš„hello-worldé•œåƒè¿™æ˜¯è¾“å‡ºäº†ä¸€äº›ä¿¡æ¯åå°±è‡ªåŠ¨é€€å‡ºäº†ï¼Œå› ä¸ºè¿™å°±æ˜¯è¿™ä¸ªé•œåƒçš„å…¨éƒ¨å†…å®¹ã€‚ æˆ‘ä»¬å°è¯•æ¥è¿è¡Œä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿï¼Œå…ˆç”¨docker pull ubuntuæ‹‰å–Ubuntu Dockeré•œåƒï¼š æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ï¼š -itçš„æ„æ€æ˜¯ä»€ä¹ˆï¼Ÿæ ¹æ®docker run --helpï¼š -i, --interactive Keep STDIN open even if not attached --ip string IPv4 address (e.g., 172.30.100.104) --ip6 string IPv6 address (e.g., 2001:db8::33) --ipc string IPC mode to use --isolation string Container isolation technology --kernel-memory bytes Kernel memory limit -t, --tty Allocate a pseudo-TTY --ulimit ulimit Ulimit options (default []) Copy å…¶å®-itæ˜¯-iå’Œ-tçš„åˆå¹¶å†™æ³•ï¼Œæ„æ€æ˜¯è¿è¡Œåè¿›å…¥è¿™ä¸ªå®¹å™¨å¹¶ä¸”å¯ç”¨shellï¼Œä¸ç„¶è¿è¡Œä¹‹åå°±ä¼šæ”¾åˆ°åå°è€Œä¸ä¼šè¿›å…¥å®¹å™¨ä¸­ã€‚è€Œ--rmåˆ™ä»£è¡¨å®¹å™¨é€€å‡ºä¹‹åä¼šè¢«åˆ é™¤ï¼ˆé•œåƒä¸ä¼šè¢«åˆ é™¤ï¼‰ï¼Œæ¯æ¬¡è¿è¡Œå®é™…ä¸Šä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œå¦‚æœä¸åŠ --rmæˆ–é€€å‡ºä¹‹åä¸æ‰‹åŠ¨åˆ é™¤çš„è¯ä¼šçœ‹åˆ°ä¸€å †åœæ­¢è¿è¡Œçš„å®¹å™¨ã€‚ è¾“å…¥cat /etc/issueå¯ä»¥çœ‹åˆ°é»˜è®¤æ‹‰å–çš„æ˜¯æœ€æ–°çš„Ubuntu 20.04 LTSï¼š Build Customized Docker Images å¦‚æœæ²¡æœ‰ç°æˆçš„Dockeré•œåƒèƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘è‡ªå·±å†™ä¸€ä¸ªã€‚è¦è‡ªå®šä¹‰ä¸€ä¸ªDockeré•œåƒéœ€è¦ä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯ç¼–å†™Dockerfileï¼Œç¬¬äºŒæ­¥æ˜¯ä½¿ç”¨docker buildå‘½ä»¤æ„å»ºé•œåƒã€‚Dockerfileå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œæè¿°äº†æˆ‘ä»¬æ„å»ºé•œåƒæ‰€éœ€è¦çš„å…¨éƒ¨å‘½ä»¤ï¼Œæ¯”å¦‚è¦æ„å»ºä¸€ä¸ªç”¨äºPythonç§‘å­¦è®¡ç®—çš„Dockeré•œåƒï¼Œæˆ‘ä»¬éœ€è¦åœ¨Dockerfileä¸­ç¼–å†™å®‰è£…Pythonçš„å‘½ä»¤ï¼Œå®‰è£…Numpyã€Scipyç­‰å¸¸ç”¨åŒ…çš„å‘½ä»¤ç­‰ç­‰ã€‚æˆ‘ä»¬å…ˆæ¥ä¸Šæ‰‹ç¼–å†™Dockerfileï¼Œè¿™é‡Œæˆ‘å‡†å¤‡å†™ä¸€ä¸ªåŒ…å«hexoåšå®¢æ¡†æ¶çš„é•œåƒï¼Œè¿™ä¸ªæ¡†æ¶éœ€è¦nodeä½œä¸ºåŸºç¡€ç¯å¢ƒï¼Œä¸è¿‡æˆ‘ä»¬ä¸éœ€è¦åœ¨Dockerfileé‡Œå†™å®‰è£…nodeçš„å‘½ä»¤ã€‚å› ä¸ºç±»ä¼¼äºC++æˆ–Pythonä¸­çš„å¯¹è±¡çš„ç»§æ‰¿ï¼ŒDockerfileä¹Ÿå¯ä»¥â€œç»§æ‰¿â€ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸å¿…ä»å¤´å†™èµ·ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å®Œæ•´çš„Dockfileå’Œæ•ˆæœï¼Œå†æ¥ä¸€ä¸€è§£é‡Šã€‚ FROM node -------------------------------------------------------------- RUN npm install -g hexo-cli EXPOSE 4000 CMD hexo init blog &amp;&amp; cd blog &amp;&amp; hexo generate &amp;&amp; hexo serverCopy è¿è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°DockeræŒ‰ç…§æˆ‘ä»¬å†™çš„Dockerfileä¸€è¡Œä¸€è¡Œçš„è¿›è¡Œé•œåƒçš„æ„å»ºï¼š ç°åœ¨æ¥è§£é‡ŠDocerfileé‡Œçš„å†…å®¹ã€‚FROM &lt;docker image&gt;è¡¨ç¤ºç»§æ‰¿å…¶ä»–çš„é•œåƒï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨nodeå®˜æ–¹çš„é•œåƒã€‚æ¥ä¸‹æ¥æ˜¯å®‰è£…hexoï¼ŒRUN &lt;command&gt;è¡¨ç¤ºæ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨npm install -g hexo-cliè¿›è¡Œå®‰è£…ã€‚ç”±äºè¦æµè§ˆåšå®¢ç½‘é¡µéœ€è¦å¼€æ”¾ç«¯å£ï¼Œè€ŒDockerå®¹å™¨è¿è¡Œçš„æ—¶å€™å’Œå¤–éƒ¨ä¸»æœºæ˜¯å®Œå…¨éš”æ–­çš„ï¼Œè¦ä½¿å¤–éƒ¨ä¸»æœºè®¿é—®Dockerå®¹å™¨ç«¯å£ï¼Œéœ€è¦æš´éœ²ç«¯å£ã€‚EXPOSE &lt;port&gt;ä»£è¡¨æš´éœ²ç«¯å£ï¼Œè¿™é‡Œç”¨çš„æ˜¯4000ç«¯å£ã€‚ä¹‹åæ˜¯åˆ›å»ºåšå®¢å’Œå¯åŠ¨æœ¬åœ°æœåŠ¡ï¼ŒCMD &lt;command&gt;å’ŒRUN &lt;command&gt;çš„åŒºåˆ«æ˜¯RUNä¼šåœ¨æ„å»ºçš„æ—¶å€™æ‰§è¡Œï¼Œè€ŒCMDæ˜¯åœ¨å®¹å™¨å¯åŠ¨ä¹‹åæ‰ä¼šæ‰§è¡Œã€‚hexo init blog &amp;&amp; cd blog &amp;&amp; hexo generate &amp;&amp; hexo serveråˆ†åˆ«ä»£è¡¨åˆå§‹åŒ–åšå®¢ã€è¿›å…¥åšå®¢æ‰€åœ¨æ–‡ä»¶å¤¹ã€ç”Ÿæˆåšå®¢ç½‘ç«™ã€å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ã€‚æ›´å¤šæŒ‡ä»¤å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚ ç„¶åæˆ‘ä»¬ä½¿ç”¨docker build -t test_hexo .å‘½ä»¤æ„å»ºé•œåƒã€‚ æ„å»ºé•œåƒ docker build -t &lt;image_name&gt; &lt;direcotry&gt; è¿è¡Œé•œåƒï¼š å¯ä»¥çœ‹åˆ°å®¹å™¨å¯åŠ¨åå¼€å§‹æ‰§è¡Œåšå®¢åˆå§‹åŒ–ã€‚ æœ€ååœ¨locahost:4000ä¸Šå¯åŠ¨äº†ä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥è¿™ä¸ªåœ°å€ï¼Œå¯ä»¥çœ‹åˆ°åˆšåˆšæ„å»ºå¥½çš„åšå®¢ï¼š å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨Dockerfileä¸­æˆ‘ä»¬æš´éœ²äº†4000ç«¯å£ï¼Œä½¿ç”¨-pæ ‡ç­¾å¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼šdocker run -p &lt;docker_port&gt;:&lt;local_port&gt; &lt;image_name&gt;ã€‚æ¯”å¦‚docker run -p 9999:8888 xxxxä»£è¡¨å°†Dockerå®¹å™¨ä¸­çš„9999ç«¯å£è½¬å‘åˆ°å¤–éƒ¨ä¸»æœºçš„8888ç«¯å£ã€‚å¦‚æœä½ æ˜¯åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šä½¿ç”¨çš„Dockerï¼Œé‚£ä¹ˆç«¯å£åªæ˜¯è¢«è½¬å‘åˆ°äº†è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œè¿˜å¾—æ‰‹åŠ¨å°†è¿œç¨‹æœåŠ¡å™¨å†è½¬å‘åˆ°ä½ æœ¬æœºä¸Šæ‰èƒ½ç›´æ¥åœ¨æœ¬æœºæµè§ˆå™¨ä¸Šçœ‹åˆ°é¡µé¢ã€‚ Build Docker Images with Aliyun Container Registry å› ä¸ºæŸäº›åŸå› ï¼Œå¦‚æœåœ¨æ„å»ºé•œåƒçš„æ—¶å€™éœ€è¦é€šè¿‡apt-get updateæ›´æ–°æºï¼Œä¼šå‘ç°æ— è®ºå¦‚ä½•éƒ½ä¼šå¡ä½ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ï¼Œåœ¨é˜¿é‡Œçš„æœåŠ¡å™¨ä¸Šæ„å»ºå¥½é•œåƒï¼Œå†æ‹‰å–åˆ°è‡ªå·±çš„æœºå™¨ä¸Šã€‚æ³¨å†Œå¥½å¸å·ä¹‹åï¼Œç‚¹å‡»åˆ›å»ºé•œåƒä»“åº“ï¼š è¿™é‡Œä»“åº“ç±»å‹å¦‚æœæ²¡æœ‰ç‰¹æ®Šéœ€æ±‚å»ºè®®ä½¿ç”¨å…¬å¼€ï¼Œç„¶åå¡«å†™ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼š ä¹‹åè®¾ç½®ä»£ç æºï¼Œå…¶å®å°±æ˜¯å‘Šè¯‰é˜¿é‡Œäº‘ä»å“ªå„¿è·å–Dockerfileï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯Githubï¼Œæ‰€ä»¥éœ€è¦å…ˆåœ¨é˜¿é‡Œäº‘ä¸­å…³è”Githubè´¦å·ï¼Œç„¶ååœ¨Githubä¸­åˆ›å»ºä¸€ä¸ªç”¨æ¥æ”¾Dockerfileçš„ä»“åº“ã€‚æ„å»ºè®¾ç½®é‡Œæœ‰ä¸€ä¸ªâ€œæµ·å¤–æœºå™¨æ„å»ºâ€ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬ä½¿ç”¨é˜¿é‡Œäº‘å®¹å™¨æœåŠ¡çš„ä¸»è¦ç›®çš„ï¼Œå‹¾é€‰ã€‚ é•œåƒä»“åº“åˆ›å»ºå¥½ä¹‹åï¼Œç‚¹è¿›å»ï¼Œåœ¨æ„å»ºé¡µé¢ç‚¹å‡»æ·»åŠ è§„åˆ™ï¼š æŒ‰ä¸‹å›¾è¿›è¡Œè®¾ç½®å³å¯ï¼Œé•œåƒç‰ˆæœ¬å°±æ˜¯ä½ æƒ³è¦çš„é•œåƒåå­—ï¼š ç‚¹å‡»â€œç«‹å³æ„å»ºâ€ï¼š ç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œå¦‚æœæ„å»ºæˆåŠŸï¼Œä¾¿å¯ä»¥è¿›è¡Œæ‹‰å–äº†ï¼Œåœ¨é•œåƒä»“åº“çš„åŸºæœ¬ä¿¡æ¯é¡µé¢å¯ä»¥çœ‹åˆ°åœ°å€ï¼š å°†é˜¿é‡Œäº‘ä¸Šçš„é•œåƒæ‹‰å–åˆ°æœ¬æœºä¹‹åä¸€èˆ¬ä¼šæƒ³è¦å¯¹é•œåƒæ”¹åï¼Œå¯ä»¥ä½¿ç”¨docker tag &lt;old_name&gt; &lt;new_name&gt;ã€‚ Build Docker Images for Deep Learning Startup åœ¨Dockerä¸­é…ç½®é€‚ç”¨äºOpenPAIçš„æ·±åº¦å­¦ä¹ é•œåƒä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ï¼Œä¼šæœ‰å¾ˆå¤šçš„å‘ï¼Œè¿™é‡Œä¸“é—¨è¯´ä¸€ä¸‹å¦‚ä½•é…ç½®ã€‚æ¨èåœ¨é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ä¸­è¿›è¡Œæ„å»ºï¼Œä¼šå°‘å¾ˆå¤šéº»çƒ¦ã€‚ ç¬¬ä¸€æ­¥æ˜¯åˆå§‹é•œåƒï¼Œç”±äºéœ€è¦ç”¨åˆ°CUDAï¼Œè¿™é‡Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼ˆæ¯”å¦‚ä¸åŒCUDAç‰ˆæœ¬æ”¯æŒçš„GPUé©±åŠ¨ç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œè¿˜æœ‰Tensorflowä¸åŒç‰ˆæœ¬å¯¹CUDAå’ŒcuDNNè¦æ±‚ä¹Ÿä¸ä¸€æ ·ï¼‰ä»Nvidiaçš„Dockerhubå®˜æ–¹é¡µé¢é€‰æ‹©åˆé€‚çš„CUDAå’ŒcuDNNç‰ˆæœ¬ï¼š è¿™é‡Œæˆ‘ä»¬é€‰æ‹©CUDA10.1 + cuDNN7ï¼š FROM nvidia/cuda:10.1-cudnn7-devel-ubuntu18.04Copy è¿™ä¸€æ¡ä¸»è¦æ˜¯è§£å†³ä¹±ç é—®é¢˜ä»¥åŠå®šä¹‰ç”¨åˆ°çš„è½¯ä»¶åŒ…çš„ç‰ˆæœ¬ï¼Œè¿™é‡ŒMinicondaç‰ˆæœ¬è®¾ç½®ä¸º4.5.4çš„åŸå› æ˜¯è¿™æ˜¯æœ€åä¸€ä¸ªè‡ªå¸¦Python3.6çš„ç‰ˆæœ¬ï¼Œæˆ‘åœ¨è¿™å„¿ä¸ºäº†ç¨³å®šæ‰€ä»¥ç”¨äº†Python3.6ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å®‰è£…æœ€æ–°ç‰ˆçš„Minicondaï¼š ENV LANG=C.UTF-8 LC_ALL=C.UTF-8 ENV HADOOP_VERSION=2.7.2 LABEL HADOOP_VERSION=2.7.2 ENV MINICONDA_VERSION=4.5.4Copy æ¥ä¸‹æ¥å®‰è£…å¿…é¡»çš„åŒ…ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®éœ€æ±‚è‡ªè¡Œè°ƒæ•´ï¼Œ-yæ ‡ç­¾ä»£è¡¨Yesï¼Œå³è‡ªåŠ¨åŒæ„å®‰è£…ï¼š RUN DEBIAN_FRONTEND=noninteractive &amp;&amp; \\ apt-get -y update &amp;&amp; \\ apt-get -y install build-essential \\ wget \\ git \\ curl \\ unzip \\ automake \\ openjdk-8-jdk \\ openssh-server \\ openssh-client \\ lsof \\ libcupti-dev &amp;&amp; \\ apt-get clean &amp;&amp; \\ rm -rf /var/lib/apt/lists/*Copy å®‰è£…Minicondaå¹¶è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œ-bæ ‡ç­¾å¯ä»¥è®©Minicondaæ— äº¤äº’è‡ªåŠ¨å®‰è£…ï¼š RUN wget --quiet https://repo.anaconda.com/miniconda/Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh &amp;&amp; /bin/bash Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh -b -p /opt/miniconda \\ &amp;&amp; rm Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh ENV PATH /opt/miniconda/bin:$PATHCopy å®‰è£…Hadoopï¼ŒOpenPAIå¹³å°ä¼šç”¨åˆ°ï¼š RUN wget -qO- http://archive.apache.org/dist/hadoop/common/hadoop-$&#123;HADOOP_VERSION&#125;/hadoop-$&#123;HADOOP_VERSION&#125;.tar.gz | \\ tar xz -C /usr/local &amp;&amp; \\ mv /usr/local/hadoop-$&#123;HADOOP_VERSION&#125; /usr/local/hadoopCopy ENVçš„ä½œç”¨æ˜¯é…ç½®ç¯å¢ƒå˜é‡ã€‚é…ç½®JAVAå’ŒHadoopç¯å¢ƒå˜é‡ï¼š ENV JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64 \\ HADOOP_INSTALL=/usr/local/hadoop \\ NVIDIA_VISIBLE_DEVICES=all ENV HADOOP_PREFIX=$&#123;HADOOP_INSTALL&#125; \\ HADOOP_BIN_DIR=$&#123;HADOOP_INSTALL&#125;/bin \\ HADOOP_SBIN_DIR=$&#123;HADOOP_INSTALL&#125;/sbin \\ HADOOP_HDFS_HOME=$&#123;HADOOP_INSTALL&#125; \\ HADOOP_COMMON_LIB_NATIVE_DIR=$&#123;HADOOP_INSTALL&#125;/lib/native \\ HADOOP_OPTS=&quot;-Djava.library.path=$&#123;HADOOP_INSTALL&#125;/lib/native&quot;Copy è®¾ç½®PATHç¯å¢ƒå˜é‡ï¼š ENV PATH=/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:$&#123;HADOOP_BIN_DIR&#125;:$&#123;HADOOP_SBIN_DIR&#125; \\ LD_LIBRARY_PATH=/usr/local/cuda/extras/CUPTI/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/cuda/lib64:/usr/local/cuda/targets/x86_64-linux/lib/stubs:$&#123;JAVA_HOME&#125;/jre/lib/amd64/serverCopy å®Œæ•´çš„Dockerfileå¦‚ä¸‹ï¼š FROM nvidia/cuda:10.1-cudnn7-devel-ubuntu18.04 ENV LANG=C.UTF-8 LC_ALL=C.UTF-8 ENV HADOOP_VERSION=2.7.2 LABEL HADOOP_VERSION=2.7.2 ENV MINICONDA_VERSION=4.5.4 RUN DEBIAN_FRONTEND=noninteractive &amp;&amp; \\ apt-get -y update &amp;&amp; \\ apt-get -y install build-essential \\ wget \\ git \\ curl \\ unzip \\ automake \\ openjdk-8-jdk \\ openssh-server \\ openssh-client \\ lsof \\ libcupti-dev &amp;&amp; \\ apt-get clean &amp;&amp; \\ rm -rf /var/lib/apt/lists/* RUN wget --quiet https://repo.anaconda.com/miniconda/Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh &amp;&amp; /bin/bash Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh -b -p /opt/miniconda \\ &amp;&amp; rm Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh ENV PATH /opt/miniconda/bin:$PATH RUN wget -qO- http://archive.apache.org/dist/hadoop/common/hadoop-$&#123;HADOOP_VERSION&#125;/hadoop-$&#123;HADOOP_VERSION&#125;.tar.gz | \\ tar xz -C /usr/local &amp;&amp; \\ mv /usr/local/hadoop-$&#123;HADOOP_VERSION&#125; /usr/local/hadoop ENV JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64 \\ HADOOP_INSTALL=/usr/local/hadoop \\ NVIDIA_VISIBLE_DEVICES=all ENV HADOOP_PREFIX=$&#123;HADOOP_INSTALL&#125; \\ HADOOP_BIN_DIR=$&#123;HADOOP_INSTALL&#125;/bin \\ HADOOP_SBIN_DIR=$&#123;HADOOP_INSTALL&#125;/sbin \\ HADOOP_HDFS_HOME=$&#123;HADOOP_INSTALL&#125; \\ HADOOP_COMMON_LIB_NATIVE_DIR=$&#123;HADOOP_INSTALL&#125;/lib/native \\ HADOOP_OPTS=&quot;-Djava.library.path=$&#123;HADOOP_INSTALL&#125;/lib/native&quot; ENV PATH=/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:$&#123;HADOOP_BIN_DIR&#125;:$&#123;HADOOP_SBIN_DIR&#125;:$PATH \\ LD_LIBRARY_PATH=/usr/local/cuda/extras/CUPTI/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/cuda/lib64:/usr/local/cuda/targets/x86_64-linux/lib/stubs:$&#123;JAVA_HOME&#125;/jre/lib/amd64/serverCopy å»ºè®®å…ˆæŠŠè¿™ä¸€éƒ¨åˆ†è¿›è¡Œæ„å»ºï¼Œä½œä¸ºåŸºç¡€é•œåƒï¼Œåé¢è¦é…ç½®å…¶ä»–ç¯å¢ƒï¼ˆå¦‚å®‰è£…Pytorchæ¡†æ¶ç™»ï¼‰ï¼Œå°±ä¸ç”¨é‡å¤æ„å»ºè¿™éƒ¨åˆ†ï¼Œè¿˜å‡å°‘äº†å‡ºé”™çš„å¯èƒ½æ€§ã€‚è¿™é‡Œè¯´ä¸€ä¸‹ï¼Œå¯åŠ¨å¸¦CUDAçš„Dockeré•œåƒéœ€è¦åœ¨docker runåŠ ä¸Šé¢å¤–çš„å‚æ•°--runtime nvidiaã€‚ æ¥ä¸‹æ¥å®‰è£…æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚ Configure PyTorch å‡è®¾ä¸Šé¢çš„é•œåƒæˆ‘ä»¬å‘½åä¸ºxiaoqinfeng/baseï¼Œé‚£ä¹ˆæ„å»ºPyTorchçš„Dockerfileå¯ä»¥åƒä¸‹é¢è¿™ä¹ˆå†™ï¼š FROM xiaoqinfeng/base RUN pip install -U pip RUN pip install numpy scipy pandas matplotlib tqdm RUN pip install torch==1.5.0+cu101 torchvision==0.6.0+cu101 -f https://download.pytorch.org/whl/torch_stable.htmlCopy å› ä¸ºè¿™é‡Œæˆ‘ç”¨çš„CUDA10.1ï¼Œå…¶ä»–ç‰ˆæœ¬çš„CUDAå®‰è£…æŒ‡ä»¤å¯èƒ½ä¸å¤ªä¸€æ ·ï¼Œå…·ä½“å¯ä»¥å‚è€ƒå®˜ç½‘ã€‚ Configure Tensorflow å¦‚æœæ˜¯å®‰è£…Tensorflowï¼Œé‚£ä¹ˆæ„å»ºTensorflowçš„Dockerfileå¯ä»¥åƒä¸‹é¢è¿™ä¹ˆå†™ï¼š FROM xiaoqinfeng/base RUN pip install -U pip RUN pip install numpy scipy pandas matplotlib tqdm tensorflow-gpuCopy è¿™é‡Œä¼šè‡ªåŠ¨å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Tensorflow2ã€‚Tensorflowä¸åŒç‰ˆæœ¬å¯¹CUDAå’ŒcuDNNç‰ˆæœ¬ç”šè‡³Pythonç‰ˆæœ¬çš„æ”¯æŒéƒ½ä¸å¤ªä¸€æ ·ï¼Œå¯ä»¥å‚è€ƒå®˜ç½‘çš„è¯´æ˜ã€‚ Deep Learning with OpenPAI What is OpenPAI OpenPAIæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ·±åº¦å­¦ä¹ è®¡ç®—èµ„æºç®¡ç†å¹³å°ï¼Œå¯¹äºæˆ‘ä»¬ç”¨æˆ·æ¥è¯´ï¼Œåªéœ€è¦å®šä¹‰å¥½Dockeré•œåƒï¼Œç„¶åç¼–å†™å¥½ä»»åŠ¡è®¾ç½®ï¼Œæäº¤åˆ°å¹³å°ä¹‹åï¼Œå¹³å°ä¾¿ä¼šè‡ªåŠ¨åˆ†é…è®¡ç®—èµ„æºæ¥è¿è¡Œä»»åŠ¡ã€‚ OpenPAIç•Œé¢ï¼š ä¸‹é¢æˆ‘ä»¬æ¥è®²è®²æ€ä¹ˆå‘OpenPAIå¹³å°æäº¤ä»»åŠ¡ã€‚ Submit Jobs to OpenPAI Pack Code &amp; Data Files å‡è®¾ä½ å·²ç»å®Œæˆäº†ä»£ç çš„ç¼–å†™å’Œæµ‹è¯•ï¼Œä½ çš„ç›®å½•ç»“æ„å¯èƒ½çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼š . â”œâ”€â”€ README.md â”œâ”€â”€ data â”‚ â””â”€â”€ dataset.csv â”œâ”€â”€ main.py â””â”€â”€ src â”œâ”€â”€ data.py â””â”€â”€ net.pyCopy å› ä¸ºOpenPAIä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿå®¹å™¨æ¥è¿è¡Œä½ çš„ä»£ç ï¼Œæ‰€ä»¥ä½ çš„æ•°æ®å’Œä»£ç å¿…é¡»è¦ä»¥æŸç§æ–¹å¼ä¼ é€åˆ°OpenPAIä¸Šçš„è™šæ‹Ÿå®¹å™¨ä¸­ã€‚æˆ‘ä»¬å…ˆæ¥æ‰“åŒ…ï¼Œåœ¨ä»£ç ç›®å½•ä¸‹æ‰§è¡Œtar -cvf files.tar ./ã€‚ä¹‹åï¼Œè¿è¡Œpython -m http.server &lt;port&gt;ã€‚æ‰“å¼€æµè§ˆå™¨è¾“å…¥&lt;server_ip&gt;:&lt;port&gt;åº”è¯¥å°±èƒ½çœ‹åˆ°ä½ çš„æ–‡ä»¶äº†ï¼š ç”±äºè¿™ä¸ªhttpè¿›ç¨‹éœ€è¦ä¸€ç›´è¿è¡Œï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨screenæ”¾åˆ°åå°æ‰§è¡Œã€‚ Configure Tasks åƒOpenPAIæäº¤ä»»åŠ¡å¯ä»¥é‡‡ç”¨ç½‘é¡µæäº¤ä¹Ÿå¯ä»¥ä½¿ç”¨VSCodeæ’ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç½‘é¡µæäº¤ã€‚ç™»å…¥OpenPAIç•Œé¢ï¼Œç‚¹å‡»Submit Jobï¼š å¯ä»¥çœ‹åˆ°æäº¤ä»»åŠ¡çš„ç•Œé¢ï¼š Job nameå¤§å®¶å¯ä»¥è‡ªå·±è®¾ç½®ã€‚åœ¨Commandä¸€æ ï¼Œæ˜¯æ‰§è¡Œä»»åŠ¡æ‰€éœ€çš„å…¨éƒ¨å‘½ä»¤ï¼Œé¦–å…ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯å°†ä»£ç æ•°æ®å‹ç¼©åŒ…ä¸‹è½½åˆ°å®¹å™¨ä¸­å¹¶è§£å‹ï¼š wget &lt;server_ip&gt;:&lt;port&gt;/files.tar tar -xvf files.tarCopy ç„¶åæ˜¯è¿è¡Œä»£ç ï¼Œå‡è®¾æˆ‘è¿™é‡Œçš„ä»»åŠ¡æ¯”è¾ƒç®€å•ï¼Œåªæœ‰ä¸€è¡Œmain.pyçš„è°ƒç”¨ï¼š python main.pyCopy å¦‚æœä»»åŠ¡çš„æ‰§è¡Œæ¯”è¾ƒå¤æ‚ï¼Œä¹Ÿåªéœ€æŠŠå‘½ä»¤å¡«åˆ°Commandé‡Œå³å¯ï¼ŒOpenPAIä¼šè‡ªåŠ¨æ‰§è¡Œã€‚æ¥ä¸‹æ¥æ˜¯è®¾ç½®é…ç½®ï¼Œå¯ä»¥é€‰GPUçš„æ•°é‡ï¼Œå†…å­˜å¤§å°ç­‰ç­‰ï¼š ç„¶åæ˜¯é•œåƒçš„é€‰æ‹©ï¼š è¦æ³¨æ„åœ¨æœ¬æœºä¸Šæ„å»ºå¥½é•œåƒä¹‹åï¼Œéœ€è¦æŠŠé•œåƒé‡å‘½åä¸º&lt;repository_address&gt;/&lt;image_name&gt;çš„æ ¼å¼ï¼ˆæˆ‘ä»¬çš„&lt;repository&gt;æ˜¯lin-ai-27:5000ï¼Œå‡è®¾æˆ‘çš„é•œåƒåæ˜¯xiaoqinfeng/pytorchï¼Œé‚£å°±æ˜¯æ”¹æˆlin-ai-27:5000/xiaoqinfeng/pytorchï¼‰ï¼Œç„¶åæ‰§è¡Œdocker pushæ¨é€åˆ°Dockeré•œåƒæœåŠ¡å™¨ä¸Šæ‰èƒ½åœ¨OpenPAIä¸Šä½¿ç”¨ã€‚ æäº¤ä¹‹åï¼Œå¯ä»¥åœ¨Jobsç•Œé¢çœ‹åˆ°ä»»åŠ¡çš„è¿è¡Œæƒ…å†µï¼š Misc Store Files in Containers æˆ‘ä»¬å¾€å¾€éœ€è¦åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ä¿å­˜æ–‡ä»¶ï¼Œå¦‚checkpointsç­‰ã€‚åœ¨OpenPAIä¸Šæ‰§è¡Œç¨‹åºçš„è¯æ–‡ä»¶æ˜¯ä¿å­˜åœ¨ç¨‹åºä¸­çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨è¿è¡Œå®Œä¹‹åæŠŠæ–‡ä»¶å¤åˆ¶åˆ°æœ¬åœ°ç”µè„‘ä¸Šå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±éœ€è¦åœ¨ä»»åŠ¡çš„é…ç½®æ–‡ä»¶é‡ŒåŠ ä¸Šå¤åˆ¶æ–‡ä»¶åˆ°HDFSçš„è¯­å¥ã€‚é¦–å…ˆç¡®è®¤ä½ çš„HDFSçš„URLï¼šå¦‚hdfs://172.31.246.52:9000/ä½ çš„OpenPAIç”¨æˆ·å/ã€‚ å¦‚æœè¦åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨hdfs dfs -mkdir -p &lt;HDFS URL&gt;+&lt;New Folder&gt;ã€‚è¿™é‡Œ&lt;New Folder&gt;æ˜¯ä½ è¦åˆ›å»ºçš„çš„æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œç”¨èµ·æ¥å’ŒLinuxçš„mkdirå‘½ä»¤å…¶å®æ˜¯å·®ä¸å¤šçš„ã€‚ è¦å¤åˆ¶æ–‡ä»¶ï¼ˆå¤¹ï¼‰åˆ™ä½¿ç”¨hdfs dfs -cp &lt;Source Dir&gt; &lt;Dest Dir&gt;ã€‚","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Misc","slug":"Technical-Notes/Misc","permalink":"http://qfxiao.me/categories/Technical-Notes/Misc/"}],"tags":[{"name":"Pytorch","slug":"Pytorch","permalink":"http://qfxiao.me/tags/Pytorch/"},{"name":"Tensorflow","slug":"Tensorflow","permalink":"http://qfxiao.me/tags/Tensorflow/"},{"name":"Docker","slug":"Docker","permalink":"http://qfxiao.me/tags/Docker/"}]},{"title":"Ubuntu20.04LTS æ·±åº¦å­¦ä¹ ç¯å¢ƒé…ç½® CUDA11 + cuDNN8 + Tensorflow + Pytorch","slug":"Ubuntu20-4LTS-æ·±åº¦å­¦ä¹ ç¯å¢ƒé…ç½®-CUDA11-cuDNN8-Tensorflow-Pytorch","date":"2020-06-02T02:26:13.000Z","updated":"2020-12-21T14:05:52.434Z","comments":true,"path":"2020/06/02/Ubuntu20-4LTS-æ·±åº¦å­¦ä¹ ç¯å¢ƒé…ç½®-CUDA11-cuDNN8-Tensorflow-Pytorch/","link":"","permalink":"http://qfxiao.me/2020/06/02/Ubuntu20-4LTS-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-CUDA11-cuDNN8-Tensorflow-Pytorch/","excerpt":"","text":"Introduction Ubuntuçš„æœ€æ–°LTSç‰ˆæœ¬ä¹Ÿæ›´æ–°åˆ°äº†20.04ï¼Œåœ¨ç»™æ–°æœºå™¨é…ç½®æ·±åº¦å­¦ä¹ ç¯å¢ƒçš„æ—¶å€™å‘ç°æ¯”ä»¥å‰å®¹æ˜“äº†è®¸å¤šï¼Œç‰¹æ­¤å†™ä¸€ç¯‡Tutorialã€‚è¿™é‡Œçš„å®‰è£…æ–¹æ³•åªé’ˆå¯¹Ubuntu20.04LTSï¼Œå¯¹äºå…¶ä»–ç‰ˆæœ¬çš„ç³»ç»Ÿå¯èƒ½ä¸å¤ªé€‚ç”¨ã€‚ Install GPU Drivers è¿™é‡Œå‡è®¾å®‰è£…ç³»ç»Ÿä¹‹åå·²ç»åšå¥½äº†å¿…è¦çš„é…ç½®ï¼ˆå®‰è£…å¸¸ç”¨è½¯ä»¶ä¾èµ–ã€ä¿®æ”¹å›½å†…æºç­‰ï¼‰ã€‚Ubuntu20.04ä¸­GPUé©±åŠ¨å¯ä»¥ç›´æ¥é€šè¿‡GUIç•Œé¢å®‰è£…ï¼Œååˆ†æ–¹ä¾¿ï¼Œæ–¹æ³•æ˜¯æ‰¾åˆ°è½¯ä»¶ä¸æ›´æ–° (Software &amp; Updates)ï¼Œåœ¨é™„åŠ é©±åŠ¨ (additional drivers) é€‰é¡¹å¡ä¸­é€‰æ‹©é©±åŠ¨ç‰ˆæœ¬ï¼Œä¸€èˆ¬æ˜¯é€‰æ‹©â€œä¸“æœ‰ï¼Œtestedâ€ (proprietary, tested) é‚£ä¸ªï¼Œä¹‹åç‚¹Apply Changesï¼Œé‡å¯ã€‚ å¦‚æœæ˜¯æœåŠ¡å™¨çš„è¯ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨å‘½ä»¤è¡Œçš„å®‰è£…æ–¹æ³•ã€‚åœ¨å‘½ä»¤è¡Œè¾“å…¥ï¼š ubuntu-drivers devices ä¼šåˆ—å‡ºé©±åŠ¨ä¿¡æ¯ï¼š image-20201219103330645 å¯ä»¥çœ‹åˆ°æ¨èé©±åŠ¨ç‰ˆæœ¬æ˜¯455ï¼Œç›´æ¥ä½¿ç”¨å‘½ä»¤ubuntu-drivers autoinstallå°±å¯ä»¥è‡ªåŠ¨å®‰è£…æ¨èç‰ˆæœ¬çš„é©±åŠ¨äº†ã€‚ Install CUDA &amp; cuDNN æœ€å¸¸ç”¨çš„æ–¹å¼æ˜¯æŒ‰ç…§å®˜ç½‘çš„æŒ‡å¯¼æ¥å®‰è£…CUDAï¼Œä¹‹åéœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œåœ¨~/.bashrcä¸­æ·»åŠ ä¸‹åˆ—æŒ‡ä»¤ï¼š export PATH=/usr/local/cuda-11.0/bin$&#123;PATH:+:$&#123;PATH&#125;&#125; export LD_LIBRARY_PATH=/usr/local/cuda-11.0/lib64\\ $&#123;LD_LIBRARY_PATH:+:$&#123;LD_LIBRARY_PATH&#125;&#125; è¿˜å¯ä»¥é€‰æ‹©ç®€å•çš„æ–¹å¼ï¼Œç›´æ¥ä½¿ç”¨apt-getæ¥å®‰è£…CUDAï¼š sudo apt-get install nvidia-cuda-toolkit ä¸è¿‡è¿™æ ·ä¼šç›´æ¥å®‰è£…æœ€æ–°çš„CUDAç‰ˆæœ¬ï¼Œè€ŒPyTorchç­‰æ·±åº¦å­¦ä¹ æ¡†æ¶ä¸ä¸€å®šå¯¹æœ€æ–°çš„CUDAç‰ˆæœ¬éƒ½æœ‰å¾ˆå¥½çš„æ”¯æŒï¼Œæ‰€ä»¥ä¸æ¨èè¿™ç§æ–¹å¼ã€‚ å®‰è£…å®ŒCUDAä¹‹åè¾“å…¥nvcc --versionå¯ä»¥æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸï¼Œè¾“å…¥nvidia-smiå¯ä»¥çœ‹åˆ°GPUä¿¡æ¯å’ŒCUDAç‰ˆæœ¬ã€‚ ä¹‹åå®‰è£…cuDNNï¼Œè¿›å…¥å®˜ç½‘ï¼Œé€‰æ‹©Download cuDNNï¼š ä¼šè¦æ±‚ç™»å½•ï¼Œå¦‚æœæ²¡æœ‰è´¦å·çš„æ³¨å†Œä¸€ä¸ªå³å¯ã€‚åœ¨è¿™é‡Œæ ¹æ®CUDAç‰ˆæœ¬é€‰æ‹©é€‚åˆçš„cuDNNï¼Œæˆ‘è¿™é‡Œæ˜¯CUDA10.2ã€‚æˆ‘ä»¬é€‰æ‹©debåŒ…çš„æ–¹å¼å®‰è£…ï¼Œä¸‹è½½ä¸‹å›¾ä¸­åœˆå‡ºæ¥çš„ä¸‰ä¸ªdebåŒ…ï¼Œä¾æ¬¡ç”¨sudo dpkg -i xxx.debå‘½ä»¤å®‰è£…ã€‚ Configure Python ä¸ºäº†æ›´å¥½åœ°ç®¡ç†PythonåŒ…å’Œè™šæ‹Ÿç¯å¢ƒï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…Anacondaã€‚ä½¿ç”¨Anacondaä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œè™šæ‹Ÿç¯å¢ƒä¹‹é—´äº’ä¸å¹²æ‰°ã€‚åšç§‘å­¦å®éªŒæˆ‘ä»¬ä¸€èˆ¬éœ€è¦å®‰è£…å¤§é‡çš„PythonåŒ…ï¼Œæœ‰çš„åŒ…ä¹‹é—´ç”šè‡³è¿˜æœ‰å†²çªï¼Œå¦‚æœæˆ‘ä»¬æŠŠä»–ä»¬éƒ½å®‰è£…åœ¨åŒä¸€ä¸ªç¯å¢ƒä¸‹å°±ä¼šéš¾ä»¥ç®¡ç†ï¼Œç”šè‡³å‡ºå†²çªã€‚è€Œæœ‰äº†è™šæ‹Ÿç¯å¢ƒä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸åŒéœ€æ±‚æ”¾åœ¨ä¸åŒè™šæ‹Ÿç¯å¢ƒä¸­ï¼Œæ¯”å¦‚æ·±åº¦å­¦ä¹ å¼€å‘æ”¾åœ¨ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒä¸­ï¼ˆå®‰è£…Tensorflowç­‰ï¼‰ï¼Œç½‘ç«™å¼€å‘æ”¾åœ¨ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒä¸­ï¼ˆå®‰è£…Flaskç­‰ï¼‰ã€‚Anacondaé»˜è®¤è‡ªå¸¦å¤§é‡çš„åŒ…ï¼Œä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬ä¼šåˆ›å»ºæ–°çš„è™šæ‹Ÿç¯å¢ƒå»å®‰è£…æ–°çš„åŒ…ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬é€‰ç”¨Minicondaã€‚Minicondaå’ŒAnacondaå”¯ä¸€çš„åŒºåˆ«æ˜¯ä¸ä¼šè‡ªå¸¦å¤§é‡PythonåŒ…ï¼Œè¿™é‡Œå¤§å®¶è‡ªè¡Œé€‰æ‹©ã€‚Anacondaå›½å†…é•œåƒä¸‹è½½åœ°å€ä¸ºï¼šhttps://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/ï¼ŒMinicondaå›½å†…é•œåƒä¸‹è½½åœ°å€ä¸ºï¼šhttps://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/ã€‚ æ¯”å¦‚è¯´æˆ‘ä»¬ä¸‹è½½çš„æ˜¯Miniconda3-py38_4.8.2-Linux-x86_64.shï¼Œæ‰§è¡Œbash Miniconda3-py38_4.8.2-Linux-x86_64.shå³å¯å®‰è£…ã€‚æ˜¾ç¤ºä¸€å¤§å±ç”¨æˆ·åè®®å“ªå„¿æŒ‰qå¯ä»¥ç›´æ¥è·³è¿‡ï¼Œå…¶ä»–é€‰é¡¹çš„é»˜è®¤çš„è¾“å…¥yeså³å¯ã€‚åœ¨æç¤ºæ˜¯å¦éœ€è¦conda initçš„æ—¶å€™è®°å¾—è¾“å…¥yesã€‚ å®‰è£…æˆåŠŸä¹‹åï¼Œé‡å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œå¯ä»¥çœ‹åˆ°ç°åœ¨å¤„äºbaseç¯å¢ƒä¸­ï¼š æˆ‘ä»¬å…ˆé…ç½®ä¸€ä¸‹å›½å†…é•œåƒï¼Œæ‰§è¡Œ vim ~/.condarc ç„¶åç²˜è´´ä¸‹åˆ—æ–‡æœ¬ä½¿ç”¨æ¸…åæºï¼š channels: - defaults show_channel_urls: true channel_alias: https://mirrors.tuna.tsinghua.edu.cn/anaconda default_channels: - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/pro - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2 custom_channels: conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud ä¹‹åæˆ‘ä»¬è¾“å…¥conda create -n &lt;your_name&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒï¼Œå¦‚æœéœ€è¦æŒ‡å®šPythonç‰ˆæœ¬ï¼Œåˆ™conda create --n &lt;your_name&gt; python=&lt;python_version&gt;ã€‚ä¹‹åè¾“å…¥conda activate &lt;your_name&gt;è¿›å…¥è™šæ‹Ÿç¯å¢ƒï¼Œå¦‚æœéœ€è¦é€€å‡ºï¼Œåˆ™ä½¿ç”¨conda deactivateã€‚ å®‰è£…å¸¸ç”¨åŒ…ï¼š conda install --yes numpy scipy pandas matplotlib tqdm pip jupyter --yesçš„ä½œç”¨æ˜¯æ‰‹åŠ¨è¾“å…¥yæ¥ç¡®è®¤æ˜¯å¦å®‰è£…ï¼Œè¿™é‡Œåˆ—å‡ºçš„æ˜¯ä¸€äº›æœ€å¸¸ç”¨çš„PythonåŒ…ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è‡ªè¡Œè°ƒæ•´ã€‚conda installä¸ºAnacondaä¸­å®‰è£…PythonåŒ…çš„æ–¹å¼ã€‚ Install PyTorch è¿™é‡Œæ¥å®‰è£…PyTorchç¯å¢ƒï¼Œæ¨èä½¿ç”¨conda create -n pytorchåˆ›å»ºä¸€ä¸ªä¸“æœ‰è™šæ‹Ÿç¯å¢ƒï¼Œç„¶åä½¿ç”¨conda installå®‰è£…å¸¸ç”¨åŒ…ã€‚å¯¹äºå®‰è£…PyTorchï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨condaä¹Ÿå¯ä»¥ä½¿ç”¨pipå®‰è£…ã€‚pipæ˜¯å¦å¤–ä¸€ä¸ªå®‰è£…PythonåŒ…çš„å·¥å…·ï¼Œç”±äºä¸æ£€æŸ¥ä¾èµ–æ‰€ä»¥æ¯”condaå®‰è£…é€Ÿåº¦å¿«ï¼Œè€Œä¸”åŒ…çš„æ•°é‡æ¯”condaå¤šï¼Œä½¿ç”¨ä¹Ÿæ›´å¹¿æ³›ã€‚åŒæ ·pipä¹Ÿå¯ä»¥ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿä¸‹è½½ï¼Œè¯¦è§https://mirrors.tuna.tsinghua.edu.cn/help/pypi/ã€‚ å¯¹äºCUDA11.0ï¼Œå®˜æ–¹ç»™å‡ºçš„ç”¨condaå®‰è£…PyTorchçš„å‘½ä»¤ï¼ˆCUDA11.1ä¹Ÿæ˜¯è¿™ä¸ªï¼‰æ˜¯ï¼š conda install pytorch torchvision torchaudio cudatoolkit=11.0 -c pytorch ç”¨pipå®‰è£…PyTorchçš„å‘½ä»¤æ˜¯ï¼š pip install torch==1.7.1+cu110 torchvision==0.8.2+cu110 torchaudio===0.7.2 -f https://download.pytorch.org/whl/torch_stable.html å¯¹äºå…¶ä»–ç‰ˆæœ¬çš„CUDAå®‰è£…å‘½ä»¤å¯èƒ½ä¸ä¸€æ ·ï¼Œå¯ä»¥å»å®˜ç½‘æŸ¥çœ‹ã€‚ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•GPUç‰ˆæœ¬çš„PyTorchæ˜¯å¦æ­£å¸¸å·¥ä½œï¼š python -c &quot;import torch; print(torch.cuda.is_available())&quot; Install Tensorflow å®‰è£…Tensorflowç¯å¢ƒåŒæ ·æ¨èåˆ›å»ºä¸€ä¸ªä¸“æœ‰è™šæ‹Ÿç¯å¢ƒã€‚å¯¹äºTensorflow2çš„å®‰è£…ï¼Œä½¿ç”¨pipååˆ†æ–¹ä¾¿ï¼Œä½¿ç”¨ pip install tensorflow tensorflow-gpu å³å¯ã€‚è¦å®‰è£…å…¶ä»–ç‰ˆæœ¬çš„Tensorflowå¯ä»¥ä½¿ç”¨pip install tensorflow==&lt;tf_version&gt; tensorflow-gpu==&lt;tf_version&gt;æ¥æŒ‡å®šç‰ˆæœ¬ã€‚ä¸è¿‡ä¸åŒç‰ˆæœ¬çš„Tensorflowè¦æ±‚çš„CUDAç‰ˆæœ¬éƒ½æœ‰æ‰€ä¸åŒï¼Œå¯ä»¥å‚è€ƒå®˜ç½‘çš„è¯´æ˜ã€‚ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•GPUç‰ˆæœ¬çš„Tensorflowæ˜¯å¦æ­£å¸¸å·¥ä½œï¼š python -c &quot;import tensorflow as tf; tf.config.list_physical_devices(&#x27;GPU&#x27;)&quot;","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Misc","slug":"Technical-Notes/Misc","permalink":"http://qfxiao.me/categories/Technical-Notes/Misc/"}],"tags":[{"name":"Pytorch","slug":"Pytorch","permalink":"http://qfxiao.me/tags/Pytorch/"},{"name":"Tensorflow","slug":"Tensorflow","permalink":"http://qfxiao.me/tags/Tensorflow/"}]},{"title":"Deep Anomaly Detection Using Geometric Transformations","slug":"Deep-Anomaly-Detection-Using-Geometric-Transformations","date":"2020-06-01T15:17:03.000Z","updated":"2020-06-26T16:25:25.079Z","comments":true,"path":"2020/06/01/Deep-Anomaly-Detection-Using-Geometric-Transformations/","link":"","permalink":"http://qfxiao.me/2020/06/01/Deep-Anomaly-Detection-Using-Geometric-Transformations/","excerpt":"","text":"Introduction æœ¬æ–‡è€ƒè™‘å›¾åƒæ•°æ®çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜ã€‚ä¸åŸºäºé‡æ„çš„æ–¹æ³•ä¸åŒï¼Œæœ¬æ–‡æå‡ºçš„æ–¹æ³•é€šè¿‡å¯¹æ­£å¸¸å›¾ç‰‡æ–½åŠ ä¸åŒçš„å‡ ä½•å˜æ¢ä¹‹åï¼Œè®­ç»ƒä¸€ä¸ªå¤šåˆ†ç±»å™¨å°†æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹é—®é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªæœ‰ç›‘ç£é—®é¢˜ã€‚æœ¬æ–¹æ³•èƒŒåçš„ç›´è§‰æ˜¯åœ¨è®­ç»ƒèƒ½å¤Ÿåˆ†è¾¨ä¸åŒå˜æ¢åçš„å›¾ç‰‡ä¹‹åï¼Œåˆ†ç±»å™¨ä¸€å®šå­¦å¾—äº†ä¸€äº›æ˜¾è‘—çš„å‡ ä½•ç‰¹å¾ï¼Œè¿™äº›å‡ ä½•ç‰¹å¾æ˜¯æ­£å¸¸ç±»åˆ«ç‹¬æœ‰çš„ã€‚ Proposed Method Problem Statement æœ¬æ–‡è€ƒè™‘é’ˆå¯¹å›¾åƒçš„å¼‚å¸¸æ£€æµ‹ã€‚è®°\\(\\mathcal X\\)ä¸ºæ‰€æœ‰è‡ªç„¶å›¾åƒçš„ç©ºé—´ï¼Œ\\(X\\subseteq\\mathcal X\\)ä¸ºæ­£å¸¸å›¾åƒé›†åˆã€‚ç»™å®šæ•°æ®é›†\\(S\\subseteq X\\)ï¼Œå¼‚å¸¸æ£€æµ‹çš„ç›®çš„æ˜¯å­¦ä¹ ä¸€ä¸ªåˆ†ç±»å™¨\\(h_S(x):\\mathcal X\\rightarrow\\{0,1\\}\\)ï¼Œå…¶ä¸­\\(h_S(x)=1\\Leftrightarrow x\\in X\\)ã€‚ ä¸ºäº†å…¼é¡¾æŸ¥å‡†ç‡å’ŒæŸ¥å…¨ç‡ï¼Œå¸¸ç”¨çš„è®¾ç½®æ˜¯å­¦ä¹ ä¸€ä¸ªæ‰“åˆ†å‡½æ•°\\(n_S(x):\\mathcal X\\rightarrow\\mathbb R\\)ï¼Œåˆ†æ•°è¶Šé«˜ä»£è¡¨æ ·æœ¬å±äº\\(X\\)çš„æ¦‚ç‡è¶Šå¤§ã€‚ä¹‹åï¼Œé€šè¿‡è®¾å®šé˜ˆå€¼ï¼Œä¾¿å¯ä»¥æ„å»ºå¼‚å¸¸åˆ†ç±»å™¨ï¼š \\[ \\begin{align} h_S^\\lambda(x)= \\begin{cases} 1 &amp; n_S(x)\\leq\\lambda\\\\ 0 &amp; n_S(x)&lt;\\lambda \\end{cases} \\end{align} \\] Discriminative Learning of an Anomaly Scoring Function Using Geometric Transformations æœ‰åˆå§‹æ•°æ®é›†\\(S\\)ï¼Œå‡ ä½•å˜æ¢é›†åˆ\\(\\mathcal T\\)ï¼Œé€šè¿‡å¯¹\\(S\\)ä¸­æ¯ä¸ªæ ·æœ¬æ–½åŠ è¿™\\(|\\mathcal T|\\)ä¸ªå‡ ä½•å˜æ¢å¾—åˆ°æ–°æ•°æ®é›†è®°ä¸º\\(S_\\mathcal{T}\\)ï¼Œä¸”\\(S_\\mathcal{T}\\)ä¸­æ¯ä¸ªæ ·æœ¬çš„æ ‡ç­¾ä¸ºå˜æ¢çš„åºå·ã€‚ä¹‹åï¼Œåœ¨\\(S_\\mathcal{T}\\)ä¸Šè®­ç»ƒä¸€ä¸ª\\(|\\mathcal T|\\)åˆ†ç±»å™¨ã€‚åœ¨æµ‹è¯•é˜¶æ®µï¼Œå¯¹æµ‹è¯•æ ·æœ¬åŒæ ·æ–½åŠ \\(|\\mathcal T|\\)ä¸ªå‡ ä½•å˜æ¢ï¼Œåˆ†ç±»å™¨ä¼šç»™å‡ºç»è¿‡\\(\\mathrm{softmax}\\)çš„è¾“å‡ºå‘é‡ï¼Œæœ€ç»ˆçš„å¼‚å¸¸åˆ†æ•°ç”±ç»è¿‡è¾“å‡ºçš„å‘é‡æ„é€ çš„åˆ†å¸ƒå¯¹æ•°ä¼¼ç„¶å¾—æ¥ã€‚ Creating and Learning the Self-Labeled Dataset è®¾\\(\\mathcal T=\\{T_0,T_1,\\cdots,T_{k-1}\\}\\)ä¸ºå‡ ä½•å˜æ¢é›†åˆï¼Œ\\(1\\leq i\\leq k-1,\\space T_i:\\mathcal X\\rightarrow \\mathcal X\\)ï¼Œä¸”\\(T_0(x)=x\\)ã€‚\\(S_\\mathcal{T}\\)å®šä¹‰ä¸ºï¼š \\[ S_\\mathcal T=\\{(T_j(x),j):x\\in S,T_j\\in\\mathcal T\\} \\] å¯¹äºæ¯ä¸ª\\(x\\in S\\)ï¼Œ\\(j\\)ä¸º\\(T_j(x)\\)çš„æ ‡ç­¾ã€‚æˆ‘ä»¬ç›´æ¥å­¦ä¹ ä¸€ä¸ª\\(K\\)ç±»åˆ†ç±»å™¨\\(f_\\theta\\)ï¼Œæ¥é¢„æµ‹è¾“å…¥æ ·æœ¬å¯¹åº”çš„å‡ ä½•å˜æ¢ç§ç±»ï¼Œè¿™ç›¸å½“äºæ˜¯ä¸€ä¸ªå›¾åƒåˆ†ç±»é—®é¢˜ã€‚ Dirichlet Normality Score æ¥ä¸‹æ¥è¦åšçš„æ˜¯å¦‚ä½•å®šä¹‰å¼‚å¸¸åˆ†æ•°ï¼Œè®°ä¸º\\(n_S(x)\\)ï¼Œè¿™æ˜¯æ–‡ä¸­çš„ä¸€ä¸ªé‡è¦çš„éƒ¨åˆ†ã€‚è®¾å‡ ä½•å˜æ¢é›†åˆ\\(\\mathcal T=\\{T_0,T_1,\\cdots,T_{k-1}\\}\\)ï¼Œä¸”\\(k\\)åˆ†ç±»å™¨\\(f_\\theta\\)åœ¨\\(S_\\mathcal{T}\\)ä¸Šå®Œæˆè®­ç»ƒã€‚å¯¹äºä»»æ„ä¸€ä¸ªæ ·æœ¬\\(x\\)ï¼Œä»¤\\(\\mathbf y(x)=\\text{softmax}(f_{\\theta}(x))\\)ï¼Œå³åˆ†ç±»å™¨\\(f_\\theta\\)è¾“å‡ºçš„\\(\\text{softmax}\\)ä¹‹åçš„å‘é‡ã€‚å¼‚å¸¸åˆ†æ•°\\(n_S(x)\\)å®šä¹‰ä¸ºï¼š \\[ n_S(x)=\\sum\\limits_{i=0}^{k-1}\\log p(\\mathbf y(T_i(x))|T_i) \\] è¯¥å¼‚å¸¸åˆ†æ•°å®šä¹‰ä¸ºæ¯ä¸ªç±»åˆ«ä¸Šï¼Œåœ¨å‡ ä½•å˜æ¢\\(T_i\\)çš„æ¡ä»¶ä¸‹ï¼Œè¾“å‡ºçš„\\(\\mathbf y\\)çš„å¯¹æ•°ä¼¼ç„¶ä¹‹å’Œã€‚åœ¨æ–‡ä¸­ï¼Œä½œè€…å‡è®¾\\(\\mathbf y(T_i(x)|T_i\\)æœä»è¿ªåˆ©å…‹é›·åˆ†å¸ƒï¼š\\(\\mathbf y(T_i(x))|T_i\\sim\\text{Dir}(\\boldsymbol \\alpha_i)\\)ï¼Œå…¶ä¸­\\(\\boldsymbol \\alpha_i\\in\\mathbb R^k_+\\)ï¼Œ\\(x\\sim p_X(x)\\)ï¼Œ\\(i\\sim\\text{Uni}(0,k-1)\\)ï¼Œè€Œ\\(p_X(x)\\)ä»£è¡¨æ­£å¸¸æ ·æœ¬çš„çœŸå®æ•°æ®åˆ†å¸ƒã€‚äºæ˜¯ï¼š \\[ n_S(x)=\\sum_{i=0}^{k-1}\\left[\\log\\Gamma(\\sum_{j=0}^{k-1}[\\tilde{\\boldsymbol\\alpha}_i]_j)-\\sum_{j=0}^{k-1}\\log\\Gamma([\\tilde{\\boldsymbol\\alpha}_i]_j)+\\sum_{j=0}^{k-1}([\\tilde{\\boldsymbol\\alpha}_i]_j-1)\\log\\mathbf y(T_i(x))_j\\right] \\] å› ä¸º\\(\\tilde{\\alpha}_i\\)ç›¸å¯¹äº\\(x\\)æ¥è¯´æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¿½ç•¥ï¼Œäºæ˜¯å¼å­ç®€åŒ–ä¸ºï¼š \\[ n_S(x)=\\sum_{i=0}^{k-1}\\sum_{j=0}^{k-1}([\\tilde{\\boldsymbol\\alpha}_i]_j-1)\\log\\mathbf y(T_i(x))_j=\\sum_{i=0}^{k-1}(\\tilde{\\boldsymbol \\alpha}_i-1)\\cdot\\log\\mathbf y(T_i(x)) \\] æ³¨æ„è¿™é‡Œçš„æ¯ä¸ª\\(\\boldsymbol \\alpha_i\\)éƒ½æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå³å¯¹äºæ¯ä¸ªå˜æ¢\\(i\\)ï¼Œéƒ½å¯¹åº”ä¸€ä¸ªè¿ªåˆ©å…‹é›·åˆ†å¸ƒï¼Œå…¶å‚æ•°ä¸º\\(\\boldsymbol\\alpha_i\\)ï¼›åœ¨å¯¹è®­ç»ƒé›†è¿›è¡Œç¬¬\\(i\\)ä¸ªå‡ ä½•å˜æ¢ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°äº†\\(\\{T_i(x)\\}\\)ï¼Œç„¶ååˆ†ç±»å™¨\\(f_\\theta(\\cdot)\\)çš„è¾“å‡º\\(\\mathbf y(T_i(x))\\)ç›¸å½“äºè¿ªåˆ©å…‹é›·åˆ†å¸ƒçš„è§‚æµ‹å€¼ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è§‚æµ‹å€¼æ¥ä¼°è®¡å‚æ•°\\(\\boldsymbol \\alpha_i\\)ï¼Œç„¶åæ ¹æ®è¿™ä¸ªå‚æ•°æ¥è®¡ç®—\\(n_S(x)\\)ã€‚å¯¹äº\\(\\boldsymbol\\alpha_i\\)ï¼Œå¯ä»¥çŸ¥é“å…¶ç¬¬\\(i\\)ä¸ªåˆ†é‡åº”è¯¥æ˜¯ç›¸å¯¹æ¯”è¾ƒå¤§çš„ï¼Œä¸‹é¢æ˜¯è¿è¡Œå®˜æ–¹ä»£ç å¾—åˆ°çš„\\(\\boldsymbol\\alpha_i\\)çš„ç»“æœï¼ˆ\\(i=69\\)ï¼Œ\\(i\\)ä»\\(0\\)å¼€å§‹ï¼Œæ€»å…±ä¸º\\(72\\)ç»´ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°ç¬¬\\(69\\)ä¸ªåˆ†é‡æ˜¯æœ€å¤§çš„ã€‚ [INFO] value of mle_alpha_t: [ 0.10228925 0.08997199 0.13083569 0.10862965 0.09811163 0.08527119 0.17637901 0.27628416 0.12873376 0.19197053 0.11587154 0.09873095 0.12700618 0.07688542 0.10488203 0.12499191 0.11637607 0.07739511 0.13049147 0.51031647 0.20546597 0.15558449 0.09288609 0.12134945 0.09324992 0.14650162 0.16281216 0.11827823 0.08214853 0.15618336 0.28129761 0.45293697 0.11485838 1.78598954 0.16556983 0.1141158 0.10909459 0.13916602 0.11563799 0.07309986 0.11049714 0.12974086 0.15930642 0.13714361 0.13938356 0.70619553 0.11174039 0.07201538 0.16626109 0.12153727 0.09548811 0.07940956 0.15832209 0.11035474 0.12487912 0.16937875 0.23212662 0.37041831 0.08557451 0.0839439 0.09924258 0.39766872 0.14917286 0.08704662 0.09554555 0.31047109 0.24504759 0.16812463 0.11508187 63.98878807 0.12971073 0.07972932] ä¸‹å›¾ä¹Ÿå±•ç¤ºäº†å¯¹äºæ¯ä¸ªå˜æ¢\\(i\\)ï¼Œ\\(\\mathbf y(T_i(x)|T_i\\)åˆ†å¸ƒçš„æƒ…å†µï¼š ä½œè€…è¿˜ç»™å‡ºäº†ä¸€ç§ç®€åŒ–çš„å½¢å¼ï¼Œ\\(\\hat{n}_S(x)=\\frac{1}{k}\\sum^{k-1}_{j=0}[\\mathbf y(T_j(x))]_j\\)ã€‚ç›¸å½“äºè¯´ï¼Œå¯¹äºæ¯ä¸ªå˜æ¢\\(T_i\\)åˆ†ç±»å™¨éƒ½ä¼šç»™å‡ºä¸€ä¸ª\\(\\text{softmax}\\)å‘é‡ï¼Œå–å…¶ç¬¬\\(i\\)ä¸ªåˆ†é‡\\([\\mathbf y(T_j(x))]_j\\)ï¼Œç„¶åæŠŠæ¯ä¸ªå˜æ¢å¯¹åº”çš„\\([\\mathbf y(T_j(x))]_j\\)åŠ èµ·æ¥ã€‚ æ•´ä¸ªç®—æ³•çš„æµç¨‹å¦‚ä¸‹ï¼š è¿™é‡Œç»“åˆä½œè€…çš„æºä»£ç ç®€å•è¯´ä¸€ä¸‹æ£€æµ‹é˜¶æ®µçš„æµç¨‹ã€‚ for t_ind in range(transformer.n_transforms): observed_dirichlet = mdl.predict(transformer.transform_batch(observed_data, [t_ind] * len(observed_data)), batch_size=1024) åœ¨è®­ç»ƒå¥½æ¨¡å‹ä¹‹åï¼Œå¯¹äºè®­ç»ƒé›†çš„æ‰€æœ‰æ ·æœ¬ï¼Œå¯¹å…¶è¿›è¡Œ\\(K\\)ä¸ªå‡ ä½•å˜æ¢ä¹‹åï¼Œå¾—åˆ°\\(K\\)ä¸ªæ ·æœ¬\\(\\{T_i(x)\\}\\)ï¼Œå¯¹äºæ‰€æœ‰ç¬¬\\(i\\)ä¸ªå‡ ä½•å˜æ¢å¯¹åº”çš„æ ·æœ¬\\(\\{T_i(x)\\}\\)ï¼Œé€šè¿‡åˆ†ç±»å™¨\\(f_\\theta\\)ä¼šç»™å‡ºè¾“å‡º\\(\\mathbf y(T_i(x))\\)ã€‚è¿™é‡Œå¯¹åº”ç®—æ³•ä¸­çš„ç¬¬\\(7-8\\)è¡Œï¼Œè¿™ä¸ªobserved_dirichletå°±æ˜¯\\(S_i\\)ã€‚ log_p_hat_train = np.log(observed_dirichlet).mean(axis=0) alpha_sum_approx = calc_approx_alpha_sum(observed_dirichlet) alpha_0 = observed_dirichlet.mean(axis=0) * alpha_sum_approx ä¹‹åè¿™éƒ¨åˆ†ä¸»è¦å¯¹åº”ç®—æ³•ä¸­çš„\\(9-11\\)è¡Œã€‚ä½œè€…æŠŠæ‰€æœ‰çš„ç¬¬\\(i\\)ä¸ªå˜æ¢ï¼Œåˆ†ç±»å™¨çš„è¾“å‡ºçš„é›†åˆï¼ˆä¹Ÿå°±æ˜¯å˜é‡observed_dirichletï¼‰è®°ä¸º\\(S_i\\)ï¼Œ\\(\\bar s\\)ä¸º\\(S_i\\)çš„å¹³å‡ï¼Œ\\(\\bar l\\)ä¸º\\(S_i\\)å¯¹æ•°çš„å¹³å‡ï¼ˆå˜é‡log_p_hat_trainï¼‰ï¼Œåˆå§‹å€¼\\(\\tilde{\\alpha}_i\\)ç”±\\(\\bar s\\frac{(k-1)(-\\Psi(1))}{\\bar s\\cdot\\log\\bar s-\\bar s\\cdot\\bar l}\\)ç»™å‡ºï¼ˆå˜é‡alpha_0ï¼‰ã€‚å‡½æ•°calc_approx_alpha_sumå®ç°çš„æ˜¯ç®—æ³•ä¸­ç¬¬\\(11\\)è¡Œçš„\\(\\frac{(k-1)(-\\Psi(1))}{\\bar s\\cdot\\log\\bar s-\\bar s\\cdot\\bar l}\\)ï¼Œä»£ç å¦‚ä¸‹ï¼š def calc_approx_alpha_sum(observations): N = len(observations) f = np.mean(observations, axis=0) return (N * (len(f) - 1) * (-psi(1))) / ( N * np.sum(f * np.log(f)) - np.sum(f * np.sum(np.log(observations), axis=0))) mle_alpha_t = fixed_point_dirichlet_mle(alpha_0, log_p_hat_train) è¿™é‡Œå¯¹åº”ç®—æ³•ä¸­çš„\\(12-14\\)è¡Œï¼Œå³é‡å¤\\(\\tilde\\alpha_i\\leftarrow\\Psi^{-1}\\left(\\Psi(\\sum_j[\\alpha_i]_j)+\\bar l\\right)\\)æ¥ä¼°è®¡\\(\\alpha\\)ï¼Œå‡½æ•°fixed_point_dirichlet_mleä»£ç å¦‚ä¸‹ï¼š def fixed_point_dirichlet_mle(alpha_init, log_p_hat, max_iter=1000): alpha_new = alpha_old = alpha_init for _ in range(max_iter): alpha_new = inv_psi(psi(np.sum(alpha_old)) + log_p_hat) if np.sqrt(np.sum((alpha_old - alpha_new) ** 2)) &lt; 1e-9: break alpha_old = alpha_new return alpha_new \\(\\Psi^{-1}(\\cdot)\\)æ˜¯é€šè¿‡æ•°å€¼æ–¹æ³•æ¥ä¼°è®¡çš„ï¼š def inv_psi(y, iters=5): # initial estimate cond = y &gt;= -2.22 x = cond * (np.exp(y) + 0.5) + (1 - cond) * -1 / (y - psi(1)) for _ in range(iters): x = x - (psi(x) - y) / polygamma(1, x) return x æœ€åï¼Œåœ¨å¾—åˆ°å¯¹\\(\\alpha\\)çš„ä¼°è®¡ä¹‹åï¼Œå¯ä»¥æ¥è®¡ç®—æµ‹è¯•æ ·æœ¬çš„åˆ†æ•°äº†ã€‚è¿™é‡Œå¯¹åº”çš„æ˜¯ç®—æ³•ä¸­çš„ç¬¬\\(16\\)è¡Œã€‚ x_test_p = mdl.predict(transformer.transform_batch(x_test, [t_ind] * len(x_test)), batch_size=1024) scores += dirichlet_normality_score(mle_alpha_t, x_test_p) å‡½æ•°dirichlet_normality_scoreä»£ç å¦‚ä¸‹ï¼š def dirichlet_normality_score(alpha, p): return np.sum((alpha - 1) * np.log(p), axis=-1) Experiments Baselines æ–‡ä¸­ç”¨åˆ°äº†å¦‚ä¸‹çš„Baselineï¼š One-class SVM. å•ç±»æ”¯æŒå‘é‡æœºï¼Œä½œè€…ä½¿ç”¨äº†ä¸‰ä¸ªå˜ä½“ï¼Œåˆ†åˆ«ä¸ºRAW-OC-SVMâ€”â€”ä½¿ç”¨åŸå§‹æ•°æ®ä½œä¸ºè¾“å…¥ï¼ŒCAE-OC-SVMâ€”â€”ä½¿ç”¨ä¸€ä¸ªå·ç§¯è‡ªç¼–ç å™¨æ¥è·å¾—ä½ç»´è¡¨ç¤ºä½œä¸ºè¾“å…¥å’ŒE2E-OC-SVMâ€”â€”å…¨åä¸ºOne-Class Deep Support Vector Data Descriptionï¼› Deep structured energy-based models. Deep Autoencoding Gaussian Mixture Model. Generative Adversarial Networks. Datasets æ–‡ä¸­ç”¨åˆ°äº†ä¸€ä¸‹å‡ ä¸ªæ•°æ®é›†ï¼š CIFAR-10 CIFAR-100 Fashion-MNIST CatsVsDogs åœ¨å®éªŒä¸­æ‰€æœ‰å›¾ç‰‡éƒ½è¢«å½’ä¸€åŒ–åˆ°\\([-1,1]\\)çš„èŒƒå›´ã€‚ Experimental Protocol è®¾æ•°æ®é›†æœ‰\\(C\\)ä¸ªç±»ï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œ\\(C\\)æ¬¡å®éªŒï¼Œåœ¨ç¬¬\\(c\\)æ¬¡å®éªŒ (\\(1\\leq c \\leq C\\))ä¸­æˆ‘ä»¬ä¼šå°†ç¬¬\\(c\\)ä¸ªç±»ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œè€Œå…¶ä»–ç±»ä½œä¸ºå¼‚å¸¸æ ·æœ¬ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œè®­ç»ƒé›†åªåŒ…å«æ­£å¸¸æ ·æœ¬ï¼Œè€Œåœ¨æµ‹è¯•é˜¶æ®µåˆ™ä¼šæœ‰æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬ã€‚åœ¨è·å¾—å¼‚å¸¸åˆ†æ•°ä¹‹åï¼Œé˜ˆå€¼\\(\\lambda\\)åˆ™æ ¹æ®ROCæ›²çº¿ä¸‹é¢ç§¯é€‰æ‹©ã€‚ å®éªŒä¸­ä½¿ç”¨çš„å‡ ä½•å˜æ¢åŸºäºä»¥ä¸‹ä¸‰ç§åŸºå˜æ¢ï¼š Horizontal flip: è®°ä¸º\\(T_b^{flip}(x)\\)ï¼Œ\\(b\\in\\{T,F\\}\\)ä»£è¡¨æ˜¯å¦ç¿»è½¬ï¼› Translation: è®°ä¸º\\(T_{s_h,s_w}^{trans}(x)\\)ï¼Œå…¶ä¸­\\(s_h,s_w\\in\\{-1,0,1\\}\\)ã€‚åœ¨é•¿å®½ä¸¤ä¸ªç»´åº¦ä¸Šä½ç§»åˆ†åˆ«ä¸º\\(0.25\\)é«˜åº¦å’Œ\\(0.25\\)å®½åº¦ï¼Œè¿™ä¸¤ä¸ªç»´åº¦å‘ç”Ÿä½ç§»çš„æ–¹å‘ç”±\\(s_h\\)å’Œ\\(s_w\\)å†³å®šï¼Œå½“\\(s_h=s_w=0\\)æ—¶ä»£è¡¨ä¸ç§»åŠ¨ï¼› Rotation by multiples 90 degrees: è®°ä¸º\\(T_k^{rot}(x)\\)ï¼Œ\\(k\\in\\{0,1,2,3\\}\\)ã€‚æ—‹è½¬\\(k\\times90\\)åº¦ã€‚ å°†ä¸‰ç§åŸºå˜æ¢å åŠ æœ‰ï¼š \\[ \\mathcal T=\\left\\{ T_k^{rot}\\circ T_{s_h,s_w}^{trans}\\circ T_b^{flip} : \\begin{matrix} b &amp;\\in \\{T,F\\}\\\\ s_h,s_w&amp;\\in\\{-1,0,1\\}\\\\ k&amp;\\in\\{0,1,2,3\\} \\end{matrix} \\right\\} \\] æœ€ç»ˆå‡ ä½•å˜æ¢ç§æ•°ä¸º\\(2\\times3\\times3\\times4=72\\)ç§ã€‚ åˆ†ç±»å™¨æ¨¡å‹ä½¿ç”¨çš„æ˜¯Wide Residual Networkï¼Œä¼˜åŒ–å™¨ä¸ºAdamï¼ŒBatch sizeä¸º128ï¼Œè®­ç»ƒè½®æ•°ä¸º200ã€‚ Results ä¸‹é¢æ˜¯ä¸åŒæ–¹æ³•åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„å®éªŒç»“æœï¼š è¯„æµ‹æ ‡å‡†ä½¿ç”¨çš„æ˜¯AUROCã€‚ä½œè€…å…³äºç»“æœçš„åˆ†æä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ç®—æ³•éƒ½æ¯”Baselineè¦å¥½ï¼Œè€Œä¸”æ˜¯è¶Šå¤§çš„æ•°æ®é›†æ•ˆæœè¶Šå¥½ã€‚CatsVsDogsæ•°æ®é›†æ¯å¼ å›¾ç‰‡çš„å¤§å°æ¯”å…¶ä»–å‡ ä¸ªæ•°æ®é›†éƒ½è¦å¤§ï¼Œè€ŒBaselineåœ¨è¿™ä¸ªæ•°æ®é›†ä¸Šçš„ç»“æœéƒ½åœ¨\\(50\\%\\)æˆ–ä¸åˆ°\\(50\\%\\)ï¼Œè¿™åŸºæœ¬ç­‰åŒäºççŒœï¼› åœ¨CIFAR-100æ•°æ®é›†é‡Œï¼Œç”±äºå°†è¿™100ç±»èšåˆä¸ºäº†20ç±»ï¼Œæ‰€ä»¥å­˜åœ¨ç±»å†…æ ·æœ¬å·®å¼‚å¤§çš„é—®é¢˜ã€‚æ¯”å¦‚åœ¨ç±»\\(5\\)ã€ç±»\\(7\\)å’Œç±»\\(13\\)ä¸Šï¼Œæ¨¡å‹è¡¨ç°å°±ä¸å¤Ÿå¥½ï¼› åœ¨Fashion-MNISTæ•°æ®é›†ä¸Šå‡ ä¹æ‰€æœ‰æ–¹æ³•ï¼ˆé™¤äº†DAGMMï¼‰éƒ½è¡¨ç°å¾ˆå¥½ã€‚ On the Intuition for Using Geometric Transformations è¿™é‡Œä½œè€…å¯¹æ‰€é€‰ç”¨çš„å‡ ä½•å˜æ¢åšäº†ä¸€äº›è§£é‡Šã€‚å®éªŒä¸­é€‰ç”¨çš„ä¸‰ç§åŸºæœ¬å‡ ä½•å˜æ¢éƒ½æ˜¯å¯é€†çš„çº¿æ€§å‡ ä½•å˜æ¢ï¼ˆä¸”ä¸ºåŒå°„ï¼‰ï¼Œä½œè€…ä¹Ÿè¯•è¿‡ä¸€äº›å¤æ‚çš„éçº¿æ€§å˜æ¢ï¼Œå¦‚é«˜æ–¯æ¨¡ç³Šã€é”åŒ–ã€ä¼½é©¬æ ¡æ­£ç­‰ç­‰ï¼Œä½†æ˜¯æ•ˆæœå¹¶ä¸å¥½ã€‚ ä½œè€…è®¤ä¸ºåˆ†ç±»å™¨èƒ½å¤Ÿåˆ†è¾¨ä¸åŒå˜æ¢çš„èƒ½åŠ›ä¸æœ€ç»ˆæ€§èƒ½æˆæ­£æ¯”ï¼Œä¸ºäº†éªŒè¯è¿™ä¸€ç‚¹ï¼Œè¿›è¡Œäº†\\(3\\)ä¸ªå®éªŒã€‚ä»MNISTæ•°æ®é›†é€‰æ‹©ä¸€ä¸ªæ•°å­—ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œå‡ ä½•å˜æ¢åªé‡‡ç”¨ä¸¤ä¸ªï¼Œç„¶åé€‰æ‹©å¦ä¸€ä¸ªæ•°å­—ä½œä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œç»“æœå¦‚ä¸‹ï¼š Normal digit: 8ï¼ŒAnomaly: 3ï¼ŒTransformations: Identity and horizontal flip. ç”±äºæ•°å­—\\(8\\)æ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥è¦è®©åˆ†ç±»å™¨åˆ†è¾¨åŸå§‹çš„\\(8\\)å’Œç¿»è½¬ä¹‹åçš„\\(8\\)æ˜¯å¾ˆéš¾çš„ï¼ŒAUROCåªæœ‰\\(0.646\\)ï¼› Normal digit: 3ï¼ŒAnomaly: 8ï¼ŒTransformations: Identity and horizontal flip. è¿™é‡ŒæŠŠ\\(3\\)ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œç”±äº\\(3\\)ä¸æ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥ä¸¤ç§å˜æ¢æ˜¯å¯ä»¥åˆ†è¾¨çš„ï¼ŒAUROCè¾¾åˆ°äº†\\(0.957\\)ï¼› Normal digit: 8ï¼ŒAnomaly: 3ï¼ŒTransformations: Identity and translation by 7 pixels. åŒæ ·æ˜¯æŠŠ\\(8\\)ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œä½†å˜æ¢ç”¨çš„æ˜¯å¹³ç§»ï¼ŒAUROCè¾¾åˆ°äº†\\(0.919\\)ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜è®¾è®¡äº†ä¸€ä¸ªå®éªŒï¼Œç›®çš„æ˜¯æµ‹è¯•ä»€ä¹ˆæ ·çš„å›¾åƒä¼šè·å¾—è¾ƒé«˜çš„åˆ†æ•°\\(n_S(x)\\)ã€‚åœ¨ç»™å®šè®­ç»ƒå¥½çš„åˆ†ç±»å™¨çš„æƒ…å†µä¸‹ï¼Œä¼˜åŒ–è¾“å…¥çš„å›¾åƒï¼Œç›®æ ‡å‡½æ•°æ˜¯æœ€å¤§åŒ–åˆ†æ•°\\(n_S(x)\\)ã€‚ä¸‹å›¾ä¸ºå®éªŒç»“æœï¼š åœ¨å·¦å›¾ä¸­ï¼Œå°†æ•°å­—\\(3\\)ä½œä¸ºæ­£å¸¸æ ·æœ¬è®­ç»ƒçš„åˆ†ç±»å™¨ã€åŸå§‹è¾“å…¥ä¸ºæ•°å­—\\(0\\)çš„å›¾ç‰‡æ—¶ï¼Œéšç€ä¼˜åŒ–çš„è¿›è¡Œï¼Œå›¾ç‰‡æ…¢æ…¢åœ°å˜å¾—åƒæ•°å­—\\(3\\)ã€‚åœ¨å³å›¾ä¸­ï¼ŒåŒæ ·æ˜¯å°†æ•°å­—\\(3\\)ä½œä¸ºæ­£å¸¸æ ·æœ¬è®­ç»ƒçš„åˆ†ç±»å™¨ï¼Œä¸è¿‡åŸå§‹è¾“å…¥ä¹Ÿæ˜¯æ•°å­—\\(3\\)ï¼Œè¿™æ—¶å›¾åƒå´æ²¡æœ‰æ€ä¹ˆå˜åŒ–ã€‚ Remark æ–‡ä¸­æåˆ°çš„åœ¨CIFAR100æ•°æ®çš„å®éªŒä¸Šï¼Œç”±äºç±»é—´å·®å¼‚æ¯”è¾ƒå¤§å¯¼è‡´æ•ˆæœè¾ƒå·®ï¼Œé‚£ä¹ˆå¾ˆè‡ªç„¶åœ°ï¼Œä¸åŒçš„å˜æ¢æ ·æœ¬å¯¹åº”çš„é›†ç°‡å®é™…ä¸Šåº”å½“è¶³å¤Ÿåˆ†å¼€ï¼Œé›†ç°‡å†…çš„æ ·æœ¬è¦è¶³å¤Ÿè¿›ï¼Œè¿™æ ·å¯¹äºåˆ†ç±»å™¨æ¥è¯´æ‰èƒ½æ¯”è¾ƒå¥½çš„åˆ†ç±»ã€‚ä¸è¿‡é‡‡ç”¨çš„å‡ ä½•å˜æ¢å¹¶æ²¡æœ‰é’ˆå¯¹è¿™ä¸€ç‚¹è¿›è¡Œç‰¹åˆ«è®¾è®¡ï¼› æ–‡ä¸­å¼ºè°ƒäº†æ‰€ä½¿ç”¨çš„å˜æ¢ä¸ºå‡ ä½•å˜æ¢ï¼Œå…¶å®é™¤æ­¤ä¹‹å¤–ï¼Œæ‰€ä½¿ç”¨çš„å˜æ¢è¿˜éƒ½æ˜¯å¯ä»¥ç”¨çŸ©é˜µè¡¨ç¤ºçš„å¯é€†çš„å˜æ¢ã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"}]},{"title":"Cross-dataset Time Series Anomaly Detection for Cloud Systems","slug":"Cross-dataset-Time-Series-Anomaly-Detection-for-Cloud-Systems","date":"2020-06-01T08:14:08.000Z","updated":"2020-06-25T05:28:22.135Z","comments":true,"path":"2020/06/01/Cross-dataset-Time-Series-Anomaly-Detection-for-Cloud-Systems/","link":"","permalink":"http://qfxiao.me/2020/06/01/Cross-dataset-Time-Series-Anomaly-Detection-for-Cloud-Systems/","excerpt":"","text":"Introduction æœ¬æ–‡ä»‹ç»äº†ä¸€ç§ç”¨äºäº‘è®¡ç®—å¹³å°çš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¡†æ¶ã€‚ä¸ºäº†è§£å†³æ ‡ç­¾ä¸è¶³çš„é—®é¢˜ï¼Œæ–‡ä¸­ä½¿ç”¨äº†è¿ç§»å­¦ä¹ çš„æ–¹æ³•ï¼Œå³åœ¨æœ‰æ ‡ç­¾çš„source domainä¸Šè®­ç»ƒæ¨¡å‹ï¼Œåœ¨æ²¡æœ‰æ ‡ç­¾çš„target domainä¸Šæ£€æµ‹ã€‚åŒæ—¶ï¼Œæ–‡ä¸­è¿˜ä½¿ç”¨äº†ä¸»åŠ¨å­¦ä¹ çš„æ–¹æ³•æ¥æŒ‘é€‰æœ€æœ‰ä»·å€¼çš„æ— æ ‡ç­¾æ ·æœ¬è¿›è¡Œæ ‡è®°ã€‚ ğŸ“°Get Paper Background é’ˆå¯¹äº‘è®¡ç®—å¹³å°æ•°æ®çš„å¼‚å¸¸æ£€æµ‹é€šå¸¸æ˜¯åº”ç”¨åœ¨äº‘ç›‘æ§æ•°æ®ï¼Œå¦‚KPIã€CPUä½¿ç”¨ç‡ã€ç³»ç»Ÿè´Ÿè½½ç­‰æ—¶åºæ•°æ®ä¸Šã€‚å’Œä¼ ç»Ÿçš„å¼‚å¸¸æ£€æµ‹ä¸ä¸€æ ·çš„æ˜¯ï¼Œæ—¶åºå¼‚å¸¸æ£€æµ‹å¾€å¾€æ›´éš¾ï¼Œæ–‡ä¸­æ€»ç»“äº†ä»¥ä¸‹å‡ ä¸ªæŒ‘æˆ˜ï¼š å¼‚å¸¸ç‰¹å¾çš„å·®å¼‚æ€§ã€‚åœ¨ä¸åŒçš„äº‘æœåŠ¡ç³»ç»Ÿä¸­ï¼Œå¯¹å¼‚å¸¸çš„å®¹å¿åº¦æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥å¯¹æ¯ä¸ªåœºæ™¯æˆ–ç³»ç»Ÿç»„ä»¶è®¾ç½®å‡†ç¡®çš„é˜ˆå€¼æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹æ˜¯ååˆ†å›°éš¾çš„ï¼› æ—¶é—´ä¾èµ–æ€§ã€‚è¯¥å¼‚å¸¸æ£€æµ‹é—®é¢˜å¤„ç†çš„æ˜¯æ—¶é—´åºåˆ—æ•°æ®ï¼Œè€Œä¼ ç»Ÿçš„å¼‚å¸¸æ£€æµ‹å¹¶ä¸ä¼šè€ƒè™‘æ—¶é—´ä¾èµ–æ€§ï¼› æ— ç›‘ç£å­¦ä¹ çš„æ€§èƒ½é—®é¢˜ã€‚æ— ç›‘ç£çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„æ€§èƒ½æœ‰é™ï¼Œä¼šå¸¦æ¥å¤§é‡çš„è¯¯æŠ¥ï¼› æœ‰ç›‘ç£å­¦ä¹ éœ€è¦å¤§é‡æ ‡ç­¾ã€‚ Proposed Approach ä¸ºäº†è§£å†³ä¸Šè¿°æŒ‘æˆ˜ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ä¸ªæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¡†æ¶ATAD (Active Transfer Anomaly Detection)ã€‚è¯¥æ¡†æ¶ç»“åˆäº†è¿ç§»å­¦ä¹ æŠ€æœ¯å’Œä¸»åŠ¨å­¦ä¹ æŠ€æœ¯ï¼Œç¤ºæ„å›¾å¦‚ä¸‹ï¼š æœªæ ‡è®°æ•°æ®\\(T_u\\)æ˜¯æˆ‘ä»¬è¦æ£€æµ‹çš„ç›®æ ‡æ•°æ® (target domain)ï¼Œæ ‡è®°æ•°æ®\\(T_l\\)æ˜¯æˆ‘ä»¬çš„æºæ•°æ® (source domain)ï¼Œå¯ä»¥æ˜¯å¼€æºæ•°æ®æˆ–è€…æ˜¯å…¶ä»–ç³»ç»Ÿçš„ç›‘æ§æ•°æ®ã€‚ Transfer Learning Component åœ¨åº”ç”¨è¿ç§»å­¦ä¹ æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªå› ç´ ï¼š æˆ‘ä»¬å¤„ç†çš„æ˜¯æ—¶é—´åºåˆ—æ•°æ®ï¼Œå³åœ¨ä¸åŒçš„æ—¶é—´ç‚¹ä¸Šæ ·æœ¬ä¹‹é—´ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå–äº†ä¸åŒçš„ç‰¹å¾ï¼Œæ¯ä¸€ä¸ªæ—¶é—´ç‚¹è¢«è½¬æ¢ä¸ºäº†é«˜ç»´çš„ç‰¹å¾å‘é‡ï¼Œä¸”æ¯ä¸ªæ—¶é—´ç‚¹é™„è¿‘çš„èƒŒæ™¯ä¿¡æ¯è¢«ä¿å­˜åœ¨äº†ç‰¹å¾å‘é‡ä¹‹ä¸­ï¼› æ—¶é—´åºåˆ—çš„ç²’åº¦ã€‚ç²—ç²’åº¦çš„è¿ç§»å­¦ä¹ ä¸åˆ©äºå‘ç°å¼‚å¸¸ï¼Œæœ¬æ–‡é‡‡ç”¨ç»†ç²’åº¦ï¼Œå³æ•°æ®ç‚¹çº§åˆ«çš„è¿ç§»å­¦ä¹ ï¼› è¿ç§»å­¦ä¹ éœ€è¦source domainå’Œtarget domainå…·æœ‰æ½œåœ¨çš„ç›¸ä¼¼æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹source domainä¸­çš„æ ·æœ¬è¿›è¡Œè¿‡æ»¤ã€‚ Feature Identification è¿™ä¸€èŠ‚æè¿°ç‰¹å¾å·¥ç¨‹ä¸­ç”¨åˆ°çš„ç‰¹å¾ã€‚åœ¨æå–ç‰¹å¾ä¹‹å‰ï¼Œæ–‡ä¸­ä½¿ç”¨äº†ç¦»æ•£å‚…é‡Œå¶å˜æ¢æ¥è¯†åˆ«æ—¶é—´åºåˆ—çš„å‘¨æœŸ\\(p\\)ï¼Œå¹¶ä¸ºåé¢æ»‘åŠ¨çª—å£çš„å¤§å°åŸåˆ™ä½œå‚è€ƒã€‚ Statistical Features ç»Ÿè®¡ç‰¹å¾åŒ…å«äº†ä¸€äº›åŸºæœ¬çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¦‚å‡å€¼ã€æ–¹å·®ç­‰ï¼Œç”¨åˆ°çš„ç‰¹å¾å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š è¡¨ä¸­çš„ç»Ÿè®¡ç‰¹å¾éƒ½æ˜¯åŸºäºå¤§å°ç­‰äºå‘¨æœŸ\\(p\\)çš„æ»‘åŠ¨çª—å£çš„ã€‚ Forecasting Error Features ä½¿ç”¨é¢„æµ‹ç‰¹å¾çš„ç†ç”±æ˜¯å¦‚æœä¸€ä¸ªæ•°æ®ç‚¹åç¦»é¢„æµ‹å€¼å¾ˆè¿œï¼Œé‚£ä¹ˆå®ƒå¾ˆæœ‰å¯èƒ½æ˜¯å¼‚å¸¸ã€‚æ–‡ä¸­ä½¿ç”¨äº†å¤šç§æ—¶é—´åºåˆ—é¢„æµ‹æ¨¡å‹ï¼Œå¦‚SARIMAã€Holtã€Holt-Wintersã€STLç­‰ã€‚æœ€ç»ˆçš„é¢„æµ‹ç»“æœä½¿ç”¨ä¸‹å¼æ¥åŠ æƒé›†æˆï¼š \\[ \\hat{Y}_t=\\sum\\limits_{m=1}^{M}\\frac{\\hat{Y}_{m,t}}{M-1}\\left(1-\\frac{RMSE_{m,t}}{\\sum\\limits_{n=1}^M RMSE_{n,t}}\\right) \\] \\(M\\)ä»£è¡¨\\(M\\)ä¸ªä¸åŒæ¨¡å‹ï¼Œ\\(RMSE_{m,t}\\)ä»£è¡¨æ¨¡å‹\\(m\\)åœ¨æ—¶é—´\\(t\\)çš„\\(RMSE\\)ï¼Œ\\(\\hat{Y}_t\\)æ˜¯åœ¨æ—¶é—´\\(t\\)çš„æœ€ç»ˆé¢„æµ‹ç»“æœã€‚ä¹‹åï¼Œä½¿ç”¨ä¸‹è¡¨ä¸­çš„Metricsæ¥è®¡ç®—ä¸åŒé¢„æµ‹ç‰¹å¾ï¼š åŒæ ·çš„ï¼Œä¸Šè¿°ç‰¹å¾éƒ½æ˜¯åŸºäºçª—å£çš„ã€‚ Temporal Features è¿™ä¸€éƒ¨åˆ†æ˜¯ä¸€äº›æ—¶é—´åºåˆ—ç›¸å…³ç‰¹å¾ï¼š æœ€åï¼Œæ€»å…±æå–äº†37ä¸ªç‰¹å¾ï¼Œå¹¶ä¸”æ¯ä¸ªç‰¹å¾éƒ½è¿›è¡Œäº†æ­£åˆ™åŒ–ã€‚ The Transfer between Source Domain and Target Domain æœ¬æ–‡ç»“åˆäº†åŸºäºå®ä¾‹çš„è¿ç§»å­¦ä¹ (Instance-based Transfer Learning)å’ŒåŸºäºç‰¹å¾çš„è¿ç§»å­¦ä¹ (Feature-based Transfer Learning)ã€‚ é¦–å…ˆï¼Œsource domainä¸­çš„æ•°æ®å·®å¼‚æ€§æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸target domainç›¸ä¼¼çš„æ ·æœ¬ã€‚ åŸºäºå®ä¾‹çš„è¿ç§»å­¦ä¹ (Instance-based Transfer Learning)çš„æ€æƒ³æ˜¯é€‰æ‹©source domainä¸­ä¸target domainç›¸ä¼¼çš„æ ·æœ¬ã€‚å¯¹äºsource domainï¼Œåœ¨å°†æ—¶é—´åºåˆ—\\(T_l\\)è½¬æ¢ä¸ºç‰¹å¾\\(F_l\\)ä¹‹åï¼Œæœ¬æ–‡ä½¿ç”¨\\(K-means\\)ç®—æ³•å°†\\(F_l\\)åˆ†æˆè‹¥å¹²ä¸ªç°‡ã€‚æ¯ä¸ªç°‡\\(F_l^i, i\\in[1,K]\\)æ˜¯\\(F_l\\)çš„ä¸é‡å å­é›†ã€‚ä¸ºäº†é€‰æ‹©åˆé€‚çš„æ ·æœ¬ï¼Œæˆ‘ä»¬è®¡ç®—äº†target domainä¸­çš„æ ·æœ¬å’Œæ¯ä¸ªç°‡ä¸­å¿ƒç‚¹çš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œç„¶åæ ·æœ¬ä¼šå’Œè·ç¦»æœ€è¿‘çš„ç°‡\\(F_l^i\\)è”ç³»èµ·æ¥ã€‚ ä¹‹åï¼Œä¸ºäº†ä½¿source domainå’Œtarget domainåœ¨ç‰¹å¾ç©ºé—´çš„å·®åˆ«æ›´å°ï¼Œä½œè€…åœ¨æ¯ä¸ªç°‡ä¸Šä½¿ç”¨äº†CORrelation ALignment (CORAL) ç®—æ³•ã€‚CORALæ˜¯ä¸€ç§é¢†åŸŸé€‚åº”ç®—æ³• (Domain Adaption)ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯å¯¹source domainå’Œtarget domainè¿›è¡Œçº¿æ€§å˜æ¢ä½¿å…¶äºŒé˜¶ç»Ÿè®¡ä¿¡æ¯ï¼ˆå³åæ–¹å·®çŸ©é˜µï¼‰çš„å·®åˆ«æœ€å°åŒ–ï¼š \\[ \\min_A\\parallel A^\\top C^i_lA-C^i_u\\parallel_F^2 \\] åœ¨æœ€åä¸€æ­¥ï¼Œä½œè€…åœ¨æ¯ä¸€ä¸ªsub source domain \\(\\hat{F}_l^i\\)è®­ç»ƒäº†æœ‰ç›‘ç£æ¨¡å‹ï¼ˆéšæœºæ£®æ—æˆ–SVMï¼‰ï¼Œæ‰€ä»¥æœ€åæˆ‘ä»¬å¾—åˆ°äº†\\(K\\)ä¸ªåŸºæ¨¡å‹ã€‚ Active Learning Component ç”±äºæ•°æ®çš„å·®å¼‚æ€§å’Œå¤æ‚æ€§å¤ªå¤§ï¼Œä»…ä»…ä½¿ç”¨è¿ç§»å­¦ä¹ çš„æŠ€æœ¯ä¸è¶³ä»¥è¾¾åˆ°å¾ˆå¥½çš„æ•ˆæœã€‚åœ¨ATADä¸­ï¼Œä½œè€…ä½¿ç”¨äº†ä¸»åŠ¨å­¦ä¹ æŠ€æœ¯æ¥ç”¨è¾ƒå°‘çš„æˆæœ¬æ ‡æ³¨æœ€æœ‰ä»·å€¼çš„æ ·æœ¬æ¥æå‡æ€§èƒ½ã€‚æœ¬æ–‡ä¸­ä½¿ç”¨åŸºäºUncertaintyå’ŒContext Diversityçš„ä¸»åŠ¨å­¦ä¹ ã€‚ Uncertainty å¤§å¤šæ•°ä¸»åŠ¨å­¦ä¹ ç®—æ³•ä½¿ç”¨ä¸ç¡®å®šæ€§ (Uncertainty) æ¥ä½œä¸ºé€‰æ‹©è¦æ ‡è®°çš„æ ·æœ¬çš„å‡†åˆ™ã€‚ \\[ Uncertainty=-|Prob(Normal)-Prob(Anomaly)| \\] å…¶ä¸­çš„\\(Prob\\)ç”±åŸºæ¨¡å‹ç»™å‡ºã€‚ Context Diversity å¤šæ ·æ€§ (Diversity) ä¹Ÿæ˜¯ä¸€ä¸ªé€‰æ‹©è¦æ ‡è®°æ ·æœ¬çš„é‡è¦å‚è€ƒã€‚å¦‚æœæœ‰ä¸¤ä¸ªç›¸ä¼¼çš„æ ·æœ¬ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦å°†ä»–ä»¬éƒ½æ ‡è®°ã€‚ æ—¶é—´ä¸Šç›¸é‚»çš„æ ·æœ¬å¾€å¾€ä¹Ÿæ˜¯ç›¸ä¼¼çš„ã€‚ å…·ä½“çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¯¹æ‰€æœ‰æ ·æœ¬æŒ‰ç…§Uncertaintyæ’åºï¼Œç„¶åè¿›è¡Œä¸€æ¬¡æ‰«æï¼Œå¦‚æœå½“å‰æ ·æœ¬åœ¨å€™é€‰é›†ä¸­æŸä¸ªæ ·æœ¬çš„Contextä¹‹ä¸­ï¼Œæˆ‘ä»¬åˆ™å¿½ç•¥å½“å‰æ ·æœ¬ï¼Œå› ä¸ºè¿™ä»£è¡¨å½“å‰æ ·æœ¬å’Œå€™é€‰é›†ä¸­çš„é‚£ä¸ªæ ·æœ¬æ˜¯ç›¸ä¼¼çš„ã€‚å¦‚æœä¸åœ¨Contextä¹‹ä¸­ï¼Œæˆ‘ä»¬åˆ™å°†è¯¥æ ·æœ¬åŠ å…¥å€™é€‰é›†ä¸­ã€‚ åˆ¤æ–­æ˜¯å¦åœ¨æŸä¸ªæ ·æœ¬çš„Contextä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç›´æ¥åˆ¤æ–­æ˜¯å¦è½åœ¨åŒºé—´\\([t-\\alpha,t+\\alpha]\\)ä¸­å°±æ˜¯äº†ã€‚ ä¸»åŠ¨å­¦ä¹ æ¨¡å—çš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Experiments åœ¨å®éªŒéƒ¨åˆ†ï¼Œä½œè€…è¯•å›¾å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š ATADçš„æ•ˆæœå¦‚ä½•ï¼Ÿ è¿ç§»å­¦ä¹ æ¨¡å—çš„æœ‰æ•ˆæ€§å¦‚ä½•ï¼Ÿ ä¸»åŠ¨å­¦ä¹ æ¨¡å—çš„æœ‰æ•ˆæ€§å¦‚ä½•ï¼Ÿ ATADåœ¨åŸºäºå…¬å¼€æ•°æ®æ—¶å¯¹å…¬å¸å†…éƒ¨æ•°æ®æ£€æµ‹æ•ˆæœå¦‚ä½•ï¼Ÿ Dataset and Setup ä¸‹è¡¨æ˜¯ç”¨åˆ°çš„æ•°æ®é›†çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼š Evaluation Metric è¯„æµ‹æ ‡å‡†ä½¿ç”¨çš„æ˜¯F1-scoreï¼š \\[ F1=\\frac{2\\cdot P\\cdot R}{P+R}, \\space P=\\frac{TP}{TP+FP}, \\space R=\\frac{TP}{TP+FN} \\] Results RQ1: How effective is ATAD? BaselineåŒ…æ‹¬å­¤ç«‹æ£®æ—ã€K-Sigmaã€S-H-ESDå’Œéšæœºæ£®æ—ã€‚ æœ€ç»ˆç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š ä¸ºäº†è¯„æµ‹ATADåˆ©ç”¨æ ‡ç­¾çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†RFåœ¨è¾¾åˆ°å’ŒATADç›¸ä¼¼F1 scoreæƒ…å†µä¸‹æ‰€éœ€æ ‡ç­¾çš„æ•°é‡ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š RQ2: How effective is the Transfer Learning Component? æˆ‘ä»¬ä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢æ¥æ¢ç©¶æ¨¡å‹è¿ç§»çŸ¥è¯†çš„èƒ½åŠ›ï¼š ä½¿ç”¨æ–‡ä¸­æ‰€ç”¨åˆ°çš„ç‰¹å¾çš„é‡è¦æ€§ æœ¬æ¨¡å‹è¿ç§»çŸ¥è¯†çš„èƒ½åŠ› å¯¹äºç¬¬ä¸€ç‚¹ï¼Œä½œè€…æå‡ºä¼ ç»Ÿçš„æ–¹æ³•ä¸€èˆ¬åªæå–äº†ç»Ÿè®¡ç‰¹å¾ï¼Œè€Œæœ¬æ–‡è¿˜æå–äº†å¤šç§å…¶ä»–ç‰¹å¾ã€‚ä½œè€…å¯¹æå–ä¸åŒç‰¹å¾è¿›è¡Œäº†æ¯”è¾ƒè¯•éªŒï¼Œç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜å±•ç¤ºäº†ä¸åŒæ•°æ®é›†ä¸‹å‰10æœ‰æ•ˆçš„ç‰¹å¾ï¼š å¯¹äºç¬¬äºŒç‚¹ï¼Œä½œè€…æ¯”è¾ƒäº†æ˜¯å¦ä½¿ç”¨æ–‡ä¸­çš„é¢†åŸŸé€‚åº”ç®—æ³•CORALï¼Œåœ¨è¾¾åˆ°ç›¸ä¼¼F1 scoreä¸‹æ‰€éœ€çš„æ ‡ç­¾æ•°ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š RQ3: How effective is the Active Learning component? ä¸ºäº†éªŒè¯æœ¬æ–‡æ‰€ç”¨çš„ä¸»åŠ¨å­¦ä¹ çš„æœ‰æ•ˆæ€§ï¼Œä½œè€…è¿›è¡Œäº†å¯¹æ¯”è¯•éªŒã€‚ç¬¬ä¸€ä¸ªæ¨¡å‹ (Supervised model) ä½¿ç”¨å…¨éƒ¨æ ‡ç­¾ä½†ä¸ä½¿ç”¨è¿ç§»å­¦ä¹ è®­ç»ƒï¼Œç¬¬äºŒä¸ª (NaÃ¯ve) ä¸ºåªä½¿ç”¨ä¸»åŠ¨å­¦ä¹ è€Œä¸ä½¿ç”¨è¿ç§»å­¦ä¹ ï¼Œç¬¬ä¸‰ä¸ªä¸ºæœ¬æ–‡æå‡ºçš„æ¨¡å‹ã€‚ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸ºäº†è¾¾åˆ°ç›¸ä¼¼çš„æ€§èƒ½ï¼Œä¸åŒæ¨¡å‹éœ€è¦çš„æ ‡ç­¾æ•°ã€‚ ä¸‹è¡¨å±•ç¤ºäº†ä½¿ç”¨ä¸åŒä¸»åŠ¨å­¦ä¹ ç­–ç•¥ (U - conventional uncertainty method, UCD - æœ¬æ–‡ä½¿ç”¨çš„æ–¹æ³•, random - éšæœºé€‰æ‹©) è¿›è¡Œæ ‡è®°å¾—åˆ°çš„ç»“æœï¼š åŒæ—¶ä½œè€…è¿˜å¯¹ä¸åŒ\\(\\alpha\\)çš„é€‰æ‹©è¿›è¡Œäº†å®éªŒï¼š RQ4: How effective is ATAD in detecting anomalies in a companyâ€™s local dataset based on public datasets? è¿™é‡Œä½œè€…å¯¹æ¯”äº†ä¸åŒæ–¹æ³•åœ¨å¾®è½¯å†…éƒ¨æ•°æ®é›†ä¸Šçš„ç»“æœï¼š","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Transfer Learning","slug":"Transfer-Learning","permalink":"http://qfxiao.me/tags/Transfer-Learning/"}]},{"title":"Learning Representations of Ultrahigh-dimensional Data for Random Distance-based Outlier Detection","slug":"Learning-Representations-of-Ultrahigh-dimensional-Data-for-Random-Distance-based-Outlier-Detection","date":"2020-05-06T03:05:37.000Z","updated":"2020-06-25T08:15:23.573Z","comments":true,"path":"2020/05/06/Learning-Representations-of-Ultrahigh-dimensional-Data-for-Random-Distance-based-Outlier-Detection/","link":"","permalink":"http://qfxiao.me/2020/05/06/Learning-Representations-of-Ultrahigh-dimensional-Data-for-Random-Distance-based-Outlier-Detection/","excerpt":"","text":"Introduction æœ¬æ–‡æå‡ºäº†ä¸€ç§é’ˆå¯¹é«˜ç»´æ•°æ®å¼‚å¸¸æ£€æµ‹çš„è¡¨ç¤ºå­¦ä¹ æ–¹æ³•ã€‚æ–‡ä¸­æå‡ºäº†RAMODOæ¡†æ¶ï¼Œä¸€ç§åŸºäºæ’åºçš„ç»“åˆè¡¨ç¤ºå­¦ä¹ å’Œå¼‚å¸¸æ£€æµ‹çš„æ— ç›‘ç£æ¡†æ¶ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒåŸºäºRAMODOï¼Œæ–‡ä¸­è¿˜æå‡ºäº†åŸºäºæ­¤æ¡†æ¶çš„æ¨¡å‹REPENã€‚ PaperğŸ“° Proposed Method The Proposed Framework: RAMODO Problem Statement æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºé«˜ç»´æ•°æ®å­¦ä¹ ä½ç»´è¡¨ç¤ºï¼ŒåŒæ—¶åœ¨å­¦åˆ°çš„ä½ç»´è¡¨ç¤ºä¸­èƒ½å¤Ÿæ›´å¥½åœ°è¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€‚è®¾æœ‰æ•°æ®é›†\\(\\mathcal{X}=\\{\\mathbf x_1,\\mathbf x_2,\\cdots, \\mathbf x_N\\}\\) (\\(\\mathbf x_i\\in \\mathbb{R}^D\\)) å’Œä¸€ä¸ªåŸºäºéšæœºè·ç¦»çš„å¼‚å¸¸æ£€æµ‹å™¨\\(\\phi:\\mathcal{X}\\mapsto \\mathbb{R}\\)ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªè¡¨ç¤ºå‡½æ•°\\(f:\\mathcal{X}\\mapsto\\mathbb{R}^M (M\\ll D)\\)ä½¿å¾—å¯¹äºæ‰€æœ‰å¼‚å¸¸æ ·æœ¬\\(\\mathbf x_i\\)å’Œæ­£å¸¸æ ·æœ¬\\(\\mathbf x_j\\)éƒ½æœ‰\\(\\phi(f(\\mathbf x_i))&gt;\\phi(f(\\mathbf x_j))\\)ã€‚ Ranking Model-based Representation Learning Framework RAMODOåŸºäºpairwise ranking modelã€‚ç¬¬ä¸€æ­¥æ˜¯é€šè¿‡ä¸€å®šçš„é¢„å¤„ç†ç®—æ³•ï¼ˆåŸæ–‡ä¸­ç§°ä¸ºoutlier thresholdingï¼‰å°†æ•°æ®åˆ’åˆ†ä¸ºinlierå€™é€‰é›†å’Œoutlierå€™é€‰é›†ï¼›ç¬¬äºŒæ­¥é€šè¿‡éšæœºä»inlierå€™é€‰é›†é‡‡æ ·\\(n\\)ä¸ªæ ·æœ¬ç”Ÿæˆquery set \\((\\mathbf x_i,\\cdots,\\mathbf x_{i+n-1})\\)ï¼Œä»inlierå€™é€‰é›†é‡‡æ ·ä¸€ä¸ªæ ·æœ¬ç”Ÿæˆpositive example \\((\\mathbf x^+)\\)ï¼Œä»outlierå€™é€‰é›†é‡‡æ ·ä¸€ä¸ªæ ·æœ¬ç”Ÿæˆnegative example \\((\\mathbf x^-)\\)ï¼Œå°†ä¸‰è€…ç»„åˆç”Ÿæˆ metatriplet \\(T=(&lt;\\mathbf x_i,\\cdots,\\mathbf x_{i+n-1}&gt;,\\mathbf x^+,\\mathbf x^-)\\)ï¼›ç¬¬ä¸‰æ­¥é€šè¿‡ç¥ç»ç½‘ç»œ\\(f\\)å­¦ä¹ è¡¨ç¤ºï¼›ç¬¬å››æ­¥é€šè¿‡outlier score-based ranking loss \\(L(\\phi(f(\\mathbf x^+)|&lt;f(\\mathbf x_i),\\cdots,f(\\mathbf x_{i+n-1})&gt;),\\phi(f(\\mathbf x^-)|&lt;f(\\mathbf x_i),\\cdots,f(\\mathbf x_{i+n-1})&gt;))\\)æ¥è¿›è¡Œä¼˜åŒ–ï¼Œå…¶ä¸­\\(\\phi(\\cdot|\\cdot)\\)ä¸ºåŸºäºè·ç¦»çš„å¼‚å¸¸æ£€æµ‹å™¨ã€‚ A RAMODO Instance: REPEN REPENä¸ºRAMODOçš„å®ä¾‹æ¨¡å‹ï¼Œä½¿ç”¨Spä½œä¸ºå¼‚å¸¸æ£€æµ‹å™¨ã€‚ Outlier Thresholding Using State-of-the-art Detectors and Cantelli's Inequality ç¬¬ä¸€æ­¥ä½¿ç”¨Spä½œä¸ºåŸºç¡€è·å¾—åˆå§‹anomaly scoreï¼š Definition 1 (Sp-based Outlier Scoring). ç»™å®šæ ·æœ¬\\(x_i\\)ï¼ŒSp ä»¥ä»¥ä¸‹æ–¹å¼å®šä¹‰è¯¥æ ·æœ¬çš„å¼‚å¸¸ç¨‹åº¦ï¼š \\[ r_i=\\frac{1}{m}\\sum\\limits_{j=1}^m nn\\_dist(\\mathbf x_i|\\mathcal{S}_j) \\] å…¶ä¸­\\(\\mathcal S_j\\subset \\mathcal X\\)ä¸ºæ•°æ®é›†éšæœºé‡‡æ ·çš„å­é›†ï¼Œ\\(m\\)ä¸ºé›†æˆå¤§å°ï¼Œ\\(nn_dist(\\cdot|\\cdot)\\)ä¸º\\(\\mathcal S_j\\)ä¸­æœ€è¿‘é‚»å±…çš„è·ç¦»ã€‚ æ¥ç€é€šè¿‡Cantelli's Inequalityæ¥å®šä¹‰Pseudo Outlierï¼š Definition 2 (Cantelli's Inequality-based Outlier Thresholding). ç»™å®šå¼‚å¸¸åˆ†æ•°å‘é‡\\(\\mathbf r\\in\\mathbb R^N\\)ï¼Œæ›´é«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ›´é«˜çš„å¯èƒ½æ€§ä¸ºå¼‚å¸¸ï¼Œè®¾\\(\\mu\\)å’Œ\\(\\delta^2\\)åˆ†åˆ«ä¸ºå‡å€¼å’Œæ–¹å·®ï¼ŒOutlierå€™é€‰é›†ç”±ä»¥ä¸‹æ–¹å¼ç¡®å®šï¼š \\[ \\mathcal{O}=\\{\\mathbf x_i|r_i \\geq \\mu + \\alpha\\delta\\}, \\space\\forall \\mathbf x_i\\in\\mathcal X, \\space r_i\\in\\mathbf r \\] å…¶ä¸­\\(\\alpha\\geq 0\\)ä¸ºè‡ªå®šä¹‰çš„é˜ˆå€¼ã€‚ Inlierå€™é€‰é›†\\(\\mathcal I=\\mathcal X\\backslash \\mathcal O\\)ã€‚ Triplet Sampling Based on Outlier Scores é¦–å…ˆï¼Œä»\\(\\mathcal I\\)é‡‡æ ·ä¸€å®šæ•°é‡çš„æ ·æœ¬ç»„æˆquery setï¼Œæ¯ä¸ªæ ·æœ¬è¢«é‡‡æ ·çš„æ¦‚ç‡ä¸å…¶å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°æœ‰å…³ï¼š \\[ p(\\mathbf x_i)=\\frac{\\mathbb Z-r_i}{\\sum_{t=1}^{|\\mathcal I|}[\\mathbb Z-r_t]} \\] å…¶ä¸­\\(\\mathbb Z=\\sum_{t=1}^{|\\mathcal I|}r_t\\)ã€‚ ä¹‹åä»inlier setä¸­å‡åŒ€éšæœºé‡‡æ ·ä¸€ä¸ªpositive sample \\(\\mathbf x^+\\)ã€‚æœ€åä»outlier setä¸­æ ¹æ®ä»¥ä¸‹æ¦‚ç‡é‡‡æ ·ä¸€ä¸ªnegative sample \\(\\mathbf x^-\\)ï¼š \\[ p(\\mathbf x_j)=\\frac{r_j}{\\sum_{t=1}^{|\\mathcal O|}r_t} \\] A Shallow Data Representation å•å±‚ç¥ç»ç½‘ç»œç”¨æ¥è·å¾—æµ…å±‚çš„è¡¨ç¤ºï¼š Definition 3 (Single-layer Fully-connected Representations) ç»™å®šè¾“å…¥\\(x\\)ï¼Œ \\[ f_\\Theta(\\mathbf x)=\\{\\psi(\\mathbf w_1^\\top\\mathbf x),\\psi(\\mathbf w_2^\\top\\mathbf x),\\cdots,\\psi(\\mathbf w_M^\\top\\mathbf x)\\} \\] å…¶ä¸­\\(\\psi(\\cdot)\\)ä¸ºæ¿€æ´»å‡½æ•°ï¼Œ\\(\\mathbf w\\)ä¸ºæƒé‡çŸ©é˜µã€‚ Ranking Loss Using Random Nearest Neighbor Distance-based Outlier Scores è®¾\\(\\mathcal{Q}=&lt;f_\\Theta(\\mathbf x_i),\\cdots,f_\\Theta(\\mathbf x_{i+n-1})&gt;\\)ä¸ºquery setï¼Œç»™å®šæ ·æœ¬\\(\\mathbf x\\)ï¼ŒREPENæ ¹æ®æœ€è¿‘é‚»è·ç¦»å®šä¹‰äº†\\(f_\\Theta(\\mathbf x)\\)çš„å¼‚å¸¸ç¨‹åº¦ï¼š \\[ \\phi(f_\\Theta(\\mathbf x)|\\mathcal{Q})=nn\\_dist(f_\\Theta(\\mathbf x)|\\mathcal Q) \\] å› æ­¤ï¼Œç»™å®šä¸‰å…ƒç»„\\(T=(\\mathcal Q,f_\\Theta(\\mathbf x^+),f_\\Theta(\\mathbf x^-))\\)ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦å¾—è¡¨ç¤º\\(f(\\cdot)\\)ä½¿å¾—ï¼š \\[ nn\\_dist(f_\\Theta(\\mathbf x^+)|\\mathcal Q)&lt;nn\\_dist(f_\\Theta(\\mathbf x^-)|\\mathcal Q) \\] æŸå¤±å‡½æ•°ï¼š \\[ J(\\Theta;T)=L(\\phi(f_\\Theta(\\mathbf x^+)|\\mathcal Q),\\phi(f_\\Theta(\\mathbf x^-)|\\mathcal Q))=\\\\\\max\\{0, c+nn\\_dist(f_\\Theta(\\mathbf x^+)|\\mathcal Q)-nn\\_dist(f_\\Theta(\\mathbf x^-)|\\mathcal Q)\\} \\] å…¶ä¸­\\(c\\)ä¸ºè¾¹ç•Œå‚æ•°ã€‚ç»™å®šä¸€ç³»åˆ—ä¸‰å…ƒç»„ï¼Œæœ€ç»ˆä¼˜åŒ–ç›®æ ‡å¦‚ä¸‹ï¼š \\[ \\mathop{\\text{arg min}}\\limits_{\\Theta}\\frac{1}{|\\mathcal{T}|}\\sum\\limits_{i=1}^{|\\mathcal T|}J(\\Theta;T_i) \\] The Algorithm and Its Time Complexity Leveraging A Few Labeled Outliers to Improve Triplet Sampling Experiments Datasets ADï¼šç½‘ç»œå¹¿å‘Šæ£€æµ‹ LCï¼šè‚ºç™Œç–¾ç—…ç›‘æµ‹ p53ï¼šå¼‚å¸¸è›‹ç™½è´¨æ´»åŠ¨æ£€æµ‹ R8ï¼šæ–‡æœ¬åˆ†ç±» News20ï¼šæ–‡æœ¬åˆ†ç±» URLï¼šå¼‚å¸¸ç½‘å€æ£€æµ‹ Webspamï¼šPascal Large Scale LearningChallenge Effectiveness in Real-world Data with Thousands to Millions of Features ä½œè€…åˆ†åˆ«ä½¿ç”¨åŸå§‹ç‰¹å¾å’ŒREPENå­¦åˆ°çš„ç‰¹å¾è¿›è¡Œå¼‚å¸¸æ£€æµ‹ï¼ŒIMPä»£è¡¨æ€§èƒ½æå‡æ¯”ä¾‹ï¼ŒSUä»£è¡¨åŠ é€Ÿæ¯”ä¾‹ã€‚ Comparing to State-of-the-art Representation Learning Competitors AE: è‡ªç¼–ç å™¨ HLLE: Hessian Locally Linear Embedding SRP: Sparse Random Projection CoP: Coherent Pursuit The Capability of Leveraging Labeled Outliers as Prior Knowledge Sensitivity Test w.r.t. the Representation Dimension æ–‡ä¸­æåˆ°äº†å¯¹äºR8ã€URLã€News20è¿™ä¸‰ä¸ªæ•°æ®é›†åœ¨ç»´åº¦\\(M=1\\)çš„æ—¶å€™è¡¨ç°å’Œå…¶ä»–ç»´åº¦ä¸€æ ·å¥½ï¼Œä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯åœ¨è¿™å‡ ä¸ªæ•°æ®é›†ä¸­å¼‚å¸¸éƒ¨åˆ†æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œæ‰€ä»¥1ç»´å°±è¶³å¤Ÿäº†ï¼Œå¦ä¸€ä¸ªè§£é‡Šæ˜¯ä¼˜åŒ–é—®é¢˜ã€‚ Scalability Test","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Representation Learning","slug":"Representation-Learning","permalink":"http://qfxiao.me/tags/Representation-Learning/"}]},{"title":"Deep Weakly-supervised Anomaly Detection","slug":"Deep-Weakly-supervised-Anomaly-Detection","date":"2020-03-29T16:17:24.000Z","updated":"2020-06-25T05:33:35.419Z","comments":true,"path":"2020/03/30/Deep-Weakly-supervised-Anomaly-Detection/","link":"","permalink":"http://qfxiao.me/2020/03/30/Deep-Weakly-supervised-Anomaly-Detection/","excerpt":"","text":"Introduction åœ¨æ–‡çŒ®ä¸­ï¼Œå› ä¸ºæ ‡æ³¨æˆæœ¬çš„æ˜‚è´µï¼Œæ— ç›‘ç£æ–¹æ³•å æ®äº†å¼‚å¸¸æ£€æµ‹çš„ä¸»è¦ä½ç½®ã€‚ç„¶è€Œï¼Œåœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰å°‘é‡æ ‡ç­¾ï¼Œå¦‚ä½•åˆ©ç”¨è¿™éƒ¨åˆ†æ ‡ç­¾ä¿¡æ¯å°±æˆä¸ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œä½œè€…å°†å…¶ç§°ä¹‹ä¸ºanomaly-informed modelingã€‚ä½œè€…æå‡ºäº†ä¸¤ç‚¹æŒ‘æˆ˜ï¼š å°‘é‡æ ‡ç­¾å¯èƒ½æ— æ³•æä¾›æ‰€æœ‰ç±»å‹å¼‚å¸¸çš„ä¿¡æ¯ï¼› å¤§éƒ¨åˆ†æ— æ ‡ç­¾æ•°æ®ä¸ºæ­£å¸¸æ ·æœ¬ï¼Œä½†å…¶ä¸­åŒ…å«å°‘éƒ¨åˆ†å¼‚å¸¸ï¼ˆæ±¡æŸ“ï¼‰ã€‚ ä½œè€…æå‡ºäº†åŸºäºpairwise relation learningçš„æ–¹æ³•æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚æ–‡ç« çš„ä¸»è¦è´¡çŒ®å¦‚ä¸‹ï¼š æå‡ºäº†ä¸€ç§åŸºäºpairing-based data augmentationå’Œordinal regressionæ¥è¿›è¡Œå¼±ç›‘ç£å¼‚å¸¸æ£€æµ‹çš„æ¡†æ¶ åŸºäºè¯¥æ¡†æ¶æå‡ºäº†PReNetï¼Œä¸€ç§åŸºäºåŒæµordinal regressionçš„ç½‘ç»œ ä»ç†è®ºå’Œå®è·µè§’åº¦åˆ†æäº†æ–¹æ³•çš„æœ‰æ•ˆæ€§ åœ¨40ä¸ªçœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®Œå–„çš„å®éªŒ Proposed Method Learning Anomaly Scores by Predicting Pairwise Relation Problem Formulation ç»™å®šæ•°æ®é›†\\(\\mathcal{X}=\\{\\mathbf{x}_1,\\mathbf {x}_2,\\cdots,\\mathbf{x}_N,\\mathbf{x}_{N+1},\\cdots,\\mathbf{x}_{N+K}\\}\\)ï¼ŒåŒ…å«ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯äº”æ ‡ç­¾æ•°æ®\\(\\mathcal{U}=\\{\\mathbf{x}_1,\\mathbf {x}_2,\\cdots,\\mathbf{x}_N\\}\\)ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æœ‰æ ‡ç­¾å¼‚å¸¸æ•°æ®\\(\\mathcal{A}=\\{\\mathbf{x}_{N+1},\\cdots,\\mathbf{x}_{N+K}\\}\\)ï¼Œå…¶ä¸­\\(K\\ll N\\)ã€‚æˆ‘ä»¬çš„ä»»åŠ¡ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªæ‰“åˆ†å‡½æ•°\\(\\phi:\\mathcal{X}\\mapsto \\mathbb{R}\\)ï¼Œä½¿å¾—å¯¹ä»»ä»»æ„å¼‚å¸¸æ ·æœ¬çš„æ‰“åˆ†é«˜äºä»»æ„æ­£å¸¸æ ·æœ¬ã€‚ åœ¨è¿™ä¸ªFormulationé‡Œï¼Œä½œè€…å°†å…³ç³»å­¦ä¹ å’Œå¼‚å¸¸æ‰“åˆ†ç»Ÿä¸€äº†èµ·æ¥ã€‚é¦–å…ˆï¼Œè¾“å…¥çš„æ•°æ®é›†ä¸å†æ˜¯åŸå§‹æ ·æœ¬ï¼Œè€Œæ˜¯æ ·æœ¬å¯¹ã€‚æ ·æœ¬å¯¹åŒ…å«ä¸‰ç§ï¼šanomaly-anomalyï¼Œanomaly-unlabeledï¼Œunlabeled-unlabeledï¼Œè®°ä¸º\\(C_{\\{\\mathbf{a},\\mathbf{a}\\}}\\)ï¼Œ\\(C_{\\{\\mathbf{a},\\mathbf{u}\\}}\\)ï¼Œ\\(C_{\\{\\mathbf{u},\\mathbf{u}\\}}\\)ã€‚æ¯ä¸€ä¸ªæ ·æœ¬å¯¹åŒ…å«ä¸€ä¸ªæ ‡ç­¾\\(y\\)ï¼Œè¡¨ç¤ºè¯¥pairå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°ï¼Œæ•´ä¸ªè¾“å…¥æ•°æ®é›†\\(\\mathcal{P}=\\{\\{\\mathbf{x}_i,\\mathbf{x}_j,y_{ij}\\}|\\mathbf{x}_i,\\mathbf{x}_j\\in\\mathcal{X} \\space\\text{and}\\space y_{ij}\\in\\mathbb{N}\\}\\)ã€‚å› ä¸ºæœ‰\\(y_{\\{\\mathbf a,\\mathbf a\\}}&gt;y_{\\{\\mathbf a,\\mathbf u\\}}&gt;y_{\\{\\mathbf u,\\mathbf u\\}}\\)ï¼Œæ‰€ä»¥å¯¹å…³ç³»çš„å­¦ä¹ ä¹Ÿæ˜¯å¯¹å¼‚å¸¸æ‰“åˆ†çš„å­¦ä¹ ã€‚ The Instantiated Model: PReNET ä¸‹å›¾ä¸ºæ¨¡å‹ç¤ºæ„å›¾ï¼ŒData Augmentationæ¨¡å—è´Ÿè´£äº§ç”Ÿpairæ•°æ®ï¼ŒEnd-to-End Anomaly Score Learner \\(\\phi\\) æ¨¡å—è´Ÿè´£å…³ç³»å­¦ä¹ ï¼ˆå¼‚å¸¸æ‰“åˆ†ï¼‰ã€‚ Data Argumentation by Pairing æ•°æ®çš„äº§ç”Ÿåˆ†ä¸ºä¸¤æ­¥ï¼š ä»\\(\\mathcal{A}\\)å’Œ\\(\\mathcal{U}\\)ä¸Šéšæœºé‡‡æ ·ï¼Œç»„æˆpairï¼› å¯¹æ¯ä¸ªpairæ‰“ä¸Šæ¬¡åº(ordinal class feature) æ ‡ç­¾\\(\\mathbf{y}\\)ã€‚ éƒ¨åˆ†\\(C_{\\{\\mathbf{a},\\mathbf{u}\\}}\\)å’Œ\\(C_{\\{\\mathbf{u},\\mathbf{u}\\}}\\)å¯èƒ½åŒ…å«å¼‚å¸¸æ±¡æŸ“ï¼Œå› ä¸ºåœ¨\\(\\mathcal{U}\\)ä¸­å¯èƒ½ä¼šæœ‰æœªæ ‡è®°çš„å¼‚å¸¸æ ·æœ¬ã€‚ End-to-End Anomaly Score Learner ä»¤\\(\\mathcal{Z}\\in\\mathbb{R}^M\\)ä¸ºä¸­é—´è¡¨ç¤ºç©ºé—´ï¼Œé‚£ä¹ˆScore Learnerå¯ä»¥æ‹†è§£ä¸ºç‰¹å¾å­¦ä¹ \\(\\psi(\\cdot;\\Theta_r):\\mathcal{X}\\mapsto \\mathcal{Z}\\)å’Œæ‰“åˆ†å‡½æ•°\\(\\eta((\\cdot,\\cdot);\\Theta_s):(\\mathcal{Z},\\mathcal{Z})\\mapsto\\mathbb{R}\\)ä¸¤éƒ¨åˆ†ï¼Œä¸¤éƒ¨åˆ†éƒ½ç”±ç¥ç»ç½‘ç»œç»„æˆã€‚ Ordinal Regression æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š \\[ L\\left(\\phi((\\mathbf x_i,\\mathbf x_j);\\Theta),y_{ij}\\right)=|y_{ij}-\\phi((\\mathbf x_i,\\mathbf x_j);\\Theta)| \\] é‡‡ç”¨ç»å¯¹å€¼è€Œä¸æ˜¯å‡æ–¹è¯¯å·®çš„åŸå› æ˜¯ä¸ºäº†å‡å°‘å¼‚å¸¸æ±¡æŸ“çš„å½±å“ã€‚é»˜è®¤\\(y_{\\{\\mathbf a,\\mathbf a\\}}=8\\)ï¼Œ\\(y_{\\{\\mathbf a,\\mathbf u\\}}=4\\)ï¼Œ\\(y_{\\{\\mathbf u,\\mathbf u\\}}=0\\)ã€‚æœ€åçš„ä¼˜åŒ–å‡½æ•°å¯ä»¥å†™ä¸ºï¼š \\[ \\mathop{\\text{argmin}}\\limits_{\\Theta}\\frac{1}{|\\mathcal{B}|}\\sum\\limits_{\\{\\mathbf x_i,\\mathbf x_j, y_{ij}\\}\\in\\mathcal{B}}|y_{ij}-\\phi((\\mathbf x_i,\\mathbf x_j);\\Theta)|+\\lambda R(\\Theta) \\] \\(\\mathcal{B}\\)ä¸ºä¸€ä¸ªbatchï¼Œ\\(R(\\Theta)\\)ä¸ºæ­£åˆ™é¡¹ã€‚ Anomaly Detection Using PReNet Training Stage è®­ç»ƒæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸ºäº†ä¿è¯è®­ç»ƒæ ·æœ¬ç±»åˆ«çš„å¹³è¡¡ï¼Œ\\(\\frac{|\\mathcal{B}|}{2}\\)çš„æ ·æœ¬é‡‡æ ·è‡ª\\(C_{\\{\\mathbf u,\\mathbf u\\}}\\)ï¼Œé‡‡æ ·è‡ª\\(C_{\\{\\mathbf a,\\mathbf u\\}}\\)å’Œ\\[C_{\\{\\mathbf a,\\mathbf a\\}}\\]çš„æ ·æœ¬éƒ½å \\(\\frac{|\\mathcal{B}|}{4}\\)ã€‚ Anomaly Scoring Stage åœ¨æµ‹è¯•é˜¶æ®µï¼Œç»™å®šæµ‹è¯•æ ·æœ¬\\(\\mathbf{x}_k\\)ï¼Œå…ˆåˆ†åˆ«ä»\\(\\mathcal{A}\\)å’Œ\\(\\mathcal{U}\\)é‡‡æ ·ï¼Œç„¶åå®šä¹‰ä»¥ä¸‹anomaly scoreï¼š \\[ s_{\\mathbf{x}_k}=\\frac{1}{2E}\\left[\\sum\\limits_{i=1}^E\\phi((\\mathbf a_i,\\mathbf x_k);\\Theta^*)+\\sum\\limits_{j=1}^E\\phi((\\mathbf x_k,\\mathbf u_j);\\Theta^*)\\right] \\] \\(\\mathbf a_i\\)å’Œ\\(\\mathbf u_j\\)ä¸ºéšæœºé‡‡æ ·å¾—åˆ°çš„å¼‚å¸¸æ ·æœ¬å’Œæ­£å¸¸æ ·æœ¬ï¼Œé‡‡æ ·å¤§å°\\(E\\)é»˜è®¤ä¸º30ã€‚ Experiments å®éªŒéƒ¨åˆ†ä¸»è¦æ˜¯å›ç­”ä»¥ä¸‹å››ä¸ªé—®é¢˜ï¼š åœ¨æœ‰é™çš„æ ‡ç­¾å¼‚å¸¸æƒ…å†µä¸‹ï¼ŒPReNetèƒ½å¦æœ‰æ•ˆåœ°æ£€æµ‹å·²çŸ¥å’ŒæœªçŸ¥çš„å¼‚å¸¸ï¼› åœ¨ä¸åŒæ•°é‡æ ‡ç­¾å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼ŒPReNetçš„è¡¨ç°å¦‚ä½•ï¼› PReNetå¯¹å¼‚å¸¸æ±¡æŸ“çš„é²æ£’æ€§å¦‚ä½•ï¼› PReNetä¸åŒç»„ä»¶çš„é‡è¦æ€§å¦‚ä½•ã€‚ Datasets å®éªŒä¸€å…±ç”¨åˆ°äº†40ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­12ä¸ªç”¨æ¥è¯„æµ‹ç®—æ³•æ£€æµ‹å·²çŸ¥çš„å¼‚å¸¸çš„èƒ½åŠ›ï¼ˆå¦‚Table 2æ‰€ç¤ºï¼‰ï¼Œ28ä¸ªç”¨æ¥è¯„æµ‹ç®—æ³•æ£€æµ‹æœªçŸ¥çš„å¼‚å¸¸çš„èƒ½åŠ›ï¼ˆå¦‚Table 3æ‰€ç¤ºï¼‰ã€‚ Competing Methods and Parameter Settings ç”¨åˆ°çš„baselineæœ‰ä»¥ä¸‹å‡ ä¸ªï¼š DevNetï¼šåŒä¸€ä½œè€…åœ¨KDD2019æå‡ºçš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ Deep support vector data description (DSVDD)ï¼šæ·±åº¦æ”¯æŒå‘é‡æ•°æ®æè¿° Prototypical networkï¼š few-shot classificationä¸­çš„ä¸€ç§æ¨¡å‹ iForestï¼šå­¤ç«‹æ£®æ— Performance Evaluation Metrics ç”¨åˆ°çš„Metricsä¸ºAUC-ROCå’ŒAUC-PRã€‚ Detection of Known Anomalies åœ¨æœ¬å®éªŒä¸­ï¼Œå¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹ï¼ˆ2%ï¼‰å’Œæœ‰æ ‡è®°å¼‚å¸¸æ ·æœ¬çš„æ•°é‡ï¼ˆ60ï¼‰æ˜¯å›ºå®šçš„ï¼Œä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š Detection of Unknown Anomalies åœ¨æœ¬å®éªŒä¸­ï¼Œå¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹ï¼ˆ2%ï¼‰å’Œæœ‰æ ‡è®°å¼‚å¸¸æ ·æœ¬çš„æ•°é‡ï¼ˆ60ï¼‰åŒæ ·æ˜¯å›ºå®šçš„ï¼Œä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š Availability of Known Anomalies æœ¬å®éªŒä¸»è¦æ˜¯ç ”ç©¶ä¸åŒæ•°é‡æ ‡æ³¨å¼‚å¸¸æ ·æœ¬çš„æ¡ä»¶ä¸‹ï¼Œç®—æ³•çš„æ€§èƒ½å¦‚ä½•ã€‚å¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹å›ºå®šï¼ˆ2%ï¼‰ï¼Œæ ‡æ³¨å¼‚å¸¸çš„æ•°é‡ä»15åˆ°120å˜åŒ–ã€‚å®éªŒç»“æœå¦‚ä¸‹ï¼š Further Analysis of PReNet Tolerance to Anomaly Contamination in Unlabeled Data æœ¬å®éªŒä¸»è¦ç ”ç©¶ä¸åŒå¼‚å¸¸æ±¡æŸ“æ¯”ä¾‹ä¸‹ï¼Œç®—æ³•çš„æ€§èƒ½ï¼Œå³æ¢ç©¶ç®—æ³•å¯¹å¼‚å¸¸æ±¡æŸ“çš„é²æ£’æ€§ã€‚æ ‡æ³¨å¼‚å¸¸æ ·æœ¬çš„æ•°é‡æ’å®šï¼ˆ60ï¼‰ï¼Œå¼‚å¸¸æ±¡æŸ“æ¯”ä¾‹åœ¨\\(\\{0\\%,2\\%,5\\%,10\\%\\}\\)ä¸­å˜åŒ–ã€‚å®éªŒç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š Ablation Study è¿™ä¸€èŠ‚æ˜¯æ¶ˆèå®éªŒï¼Œåˆ†åˆ«è®¾ç½®äº†å››ä¸ªå˜ä½“ï¼š BOR: æŸå¤±å‡½æ•°æ›¿æ¢æˆäº†äºŒå€¼å›å½’Binary Ordinal Regressionï¼› OSNet: å°†åŒæµç»“æ„ç®€åŒ–ä¸ºå•æµï¼› LDM: å°†ç½‘ç»œä¸­çš„éšè—å±‚å»é™¤ï¼› A2H: åŠ å…¥äº†é¢å¤–çš„éšè—å±‚ï¼Œå¹¶ä¸”åŠ å…¥äº†\\(\\ell_2\\)-normé˜²æ­¢è¿‡æ‹Ÿåˆã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"}]},{"title":"Discovering Physical Concepts with Neural Networks","slug":"Discovering-Physical-Concepts-with-Neural-Networks","date":"2020-03-01T14:55:02.000Z","updated":"2020-06-25T05:35:20.215Z","comments":true,"path":"2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/","link":"","permalink":"http://qfxiao.me/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/","excerpt":"","text":"Introduction å¦‚é¢˜ç›®æ‰€ç¤ºï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥å‘æ˜ç‰©ç†æ¦‚å¿µã€‚å…¶æ€è·¯æ˜¯ä»å®éªŒæ•°æ®å­¦åˆ°è¡¨ç¤ºï¼Œç„¶åç”¨å­¦åˆ°çš„è¡¨ç¤ºæ¥å›ç­”ç‰©ç†é—®é¢˜ï¼Œç”±æ­¤ç‰©ç†æ¦‚å¿µå¯ä»¥ä»å­¦åˆ°çš„è¡¨ç¤ºæ¥æå–å‡ºã€‚ä½œè€…è¿›è¡Œäº†4ä¸ªå®éªŒï¼š åœ¨é˜»å°¼æŒ¯åŠ¨å®éªŒä¸­ï¼Œæ¨¡å‹å­¦åˆ°äº†ç›¸å…³çš„ç‰©ç†å‚æ•°ï¼› åœ¨è§’åŠ¨é‡å®ˆæ’å®éªŒä¸­ï¼Œæ¨¡å‹é¢„æµ‹äº†è´¨ç‚¹çš„è¿åŠ¨ï¼› ç»™å®šé‡å­ç³»ç»Ÿçš„è§‚æµ‹æ•°æ®ï¼Œæ¨¡å‹æ­£ç¡®çš„è¯†åˆ«å‡ºäº†é‡å­çŠ¶æ€çš„è‡ªç”±åº¦ï¼› ç»™å®šä»åœ°çƒè§‚æµ‹çš„å¤ªé˜³å’Œç«æ˜Ÿçš„ä½ç½®æ—¶é—´åºåˆ—æ•°æ®ï¼Œæ¨¡å‹å‘ç°äº†æ—¥å¿ƒè¯´æ¨¡å‹ã€‚ Preliminaries ä½œè€…åœ¨é™„å½•ä¸­å¯¹ç¥ç»ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†è¿›è¡Œäº†ä»‹ç»ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œåªæˆªå–äº†ä¸€äº›ç›¸å¯¹å‰æ²¿çš„å†…å®¹ã€‚ Variational Autoencoders æœ¬æ–‡ç”¨åˆ°çš„æ¨¡å‹åŸºç¡€æ˜¯VAEï¼š Representation Learning Representation learningçš„ä¸»è¦ç›®æ ‡æ˜¯å°†æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªéšå‘é‡ (encoder)ï¼Œä¸ºäº†ä¿è¯éšå‘é‡åŒ…å«äº†æ‰€æœ‰ç›¸å…³ä¿¡æ¯ï¼Œ é‚£ä¹ˆåº”è¯¥èƒ½å¤Ÿä»éšå‘é‡è¿˜åŸåŸæ•°æ® (decoder)ã€‚ä¼ ç»Ÿçš„Autoencoderæ˜¯è¿™ä¸ªæ€æƒ³çš„æœ€ç®€å•å®ç°ï¼Œè€ŒVAEåˆ™å°†AEå’ŒVariational Inferenceç»“åˆäº†èµ·æ¥ï¼Œæ˜¯ä¸€ç§ç»å…¸çš„ç”Ÿæˆå¼æ¨¡å‹ã€‚ç°åœ¨å¾ˆå¤šç ”ç©¶å…³æ³¨Disentangled Representation Learningï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿæ— ç›‘ç£åœ°å­¦ä¹ æ•°æ®ï¼Œä»ä¸­å­¦åˆ°æœ‰æ„ä¹‰çš„è¡¨ç¤ºã€‚ \\(\\boldsymbol \\beta\\)-VAE \\(\\beta\\)-VAEæ˜¯ä¸€ç§ç‰¹æ®Šçš„VAEï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç»å…¸çš„Disentangled Representation Learningæ¨¡å‹ï¼Œå®ƒå’ŒVAEä¸»è¦çš„åŒºåˆ«æ˜¯å¯¹KLæ•£åº¦ä¸€é¡¹åŠ ä¸Šäº†æƒé‡\\(\\beta\\)è¿›è¡Œè°ƒèŠ‚ï¼š \\[ C_\\beta(x)=-\\left[\\mathbb{E}_{z\\sim p_\\phi(z|x)}\\log p_\\theta(x|z)\\right] + \\beta D_\\text{KL}\\left[p_\\phi(z|x)\\parallel h(z)\\right] \\] å¦‚æœå‡è®¾\\(p_\\phi(z|x)=\\mathcal{N}(\\mu,\\sigma)\\)ï¼Œé‚£ä¹ˆæŸå¤±å‡½æ•°å¯ä»¥è¿›è¡Œç®€åŒ–ï¼š \\[ C_\\beta(x)=\\parallel \\hat{x} - x \\parallel^2_2-\\frac{\\beta}{2}\\left(\\sum\\limits_i\\log(\\sigma_i^2)-\\mu_i^2-\\sigma_i^2\\right)+C \\] Network Structure Network Structure: SciNet æ¨¡ä»¿ç‰©ç†å­¦å®¶å»ºæ¨¡ç‰©ç†é—®é¢˜çš„è¿‡ç¨‹ï¼Œä½œè€…æå‡ºäº†SciNetï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç‰©ç†å­¦å®¶åœ¨å»ºæ¨¡ç‰©ç†é—®é¢˜çš„æ—¶å€™ï¼Œå¾€å¾€æ˜¯ä»ä¸€äº›å®éªŒæ•°æ®å‡ºå‘ï¼Œæ ¹æ®ç‰©ç†å¸¸è¯†æå–æ›´åŠ ç²¾ç»ƒçš„è¡¨ç¤ºï¼Œç„¶åç”¨å­¦åˆ°çš„è¡¨ç¤ºæ¥å›ç­”ç‰©ç†é—®é¢˜ã€‚ å¯¹äºå•çº¯çš„è¾“å…¥è¾“å‡ºé—®é¢˜ï¼ŒSciNetå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ˜ å°„ï¼Œ\\(F:\\mathcal{O}\\times\\mathcal{Q}\\rightarrow\\mathcal{A}\\)ã€‚\\(\\mathcal{O}\\)æ˜¯å¯èƒ½çš„å®éªŒæ•°æ®é›†åˆï¼Œ\\(\\mathcal{Q}\\)æ˜¯å¯èƒ½çš„é—®é¢˜é›†åˆï¼Œ\\(\\mathcal{A}\\)æ˜¯å¯èƒ½çš„ç­”æ¡ˆé›†åˆã€‚å¯ä»¥å°†å…¶åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼šç¼–ç è¿‡ç¨‹\\(E:\\mathcal{O}\\rightarrow\\mathcal{R}\\)ä»å®éªŒæ•°æ®å­¦åˆ°è¡¨ç¤ºï¼Œè§£ç è¿‡ç¨‹\\(D:\\mathcal{R}\\times \\mathcal{Q}\\rightarrow \\mathcal{A}\\)æ ¹æ®ç»™å®šçš„é—®é¢˜ä»è¡¨ç¤ºæ¥å›ç­”é—®é¢˜ã€‚ç”±æ­¤ï¼Œ\\(F(o,q)=D(E(o),q)\\)ã€‚åœ¨å®ç°æ–¹é¢ï¼ŒSciNeté‡‡ç”¨çš„æ˜¯å…¨è¿æ¥ç½‘ç»œã€‚ Training and Testing SciNet ç”¨æ¥è®­ç»ƒçš„æ•°æ®å½¢å¼ä¸º\\((o,q,a_{cor}(o,q))\\)ï¼Œè§‚æµ‹\\(o\\)å’Œé—®é¢˜\\(q\\)åˆ†åˆ«ä»è§‚æµ‹é›†\\(\\mathcal{O}\\)å’Œé—®é¢˜é›†\\(\\mathcal{Q}\\)é€‰å‡ºï¼Œ\\(a_{cor}(o,q)\\)ä¸ºå¯¹åº”çš„æ­£ç¡®ç­”æ¡ˆã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å‡†ç¡®åº¦å°½é‡é«˜ï¼Œå¹¶ä¸”å­¦åˆ°minimal uncorrelated representationsã€‚ä¸ºæ­¤ï¼Œä½œè€…é‡‡ç”¨disentangling variational autoencoderä½œä¸ºæ¨¡å‹ã€‚ Results åœ¨æ–‡ä¸­ï¼Œä½œè€…è¿›è¡Œäº†4ä¸ªå®éªŒæ¥éªŒè¯æ¨¡å‹çš„æœ‰æ•ˆæ€§ã€‚ Damped Pendulum é˜»å°¼æŒ¯åŠ¨å®éªŒï¼š ä»»åŠ¡ï¼šé¢„æµ‹ä¸€ç»´é˜»å°¼æŒ¯åŠ¨åœ¨ä¸åŒæ—¶é—´çš„ä½ç½®ã€‚ ç‰©ç†æ¨¡å‹ï¼š\\(-kx-b\\dot{x}=m\\ddot{x}\\)ï¼Œ\\(k\\)ä¸ºå¼¹æ€§æ¨¡é‡ï¼Œ\\(b\\)ä¸ºé˜»å°¼ç³»æ•°ï¼Œé€šè§£ä¸º\\(x(t)=A_0e^{-\\frac{b}{2m}t}\\cos(\\omega t+\\delta_0), \\space \\omega=\\sqrt{\\frac{k}{m}}\\sqrt{1-\\frac{b^2}{4mk}}\\) è§‚æµ‹æ•°æ®ï¼šä½ç½®æ—¶é—´åºåˆ—æ•°æ®\\(o=[x(t_i)]_{i\\in\\{1,\\cdots,50\\}}\\in\\mathbb{R}^{50}\\)ï¼Œæ—¶é—´é—´éš”ç›¸ç­‰ï¼Œè´¨é‡\\(m=1\\text{kg}\\)ï¼ŒæŒ¯å¹…\\(A_0=1\\text{m}\\)ï¼Œç›¸ä½\\(\\delta_0=0\\)ï¼Œå¼¹æ€§æ¨¡é‡\\(k\\in[5,10]\\text{kg}/\\text{s}^2\\)ï¼Œé˜»å°¼ç³»æ•°\\(b\\in[0.5,1]\\text{kg}/\\text{s}\\)ã€‚ é—®é¢˜ï¼šé¢„æµ‹\\(q=t_\\text{pred}\\in\\mathbb{R}\\) éšå˜é‡å¤§å°è®¾ç½®ä¸º3ï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š (b)ä¸­çš„ä¸‰å¹…å›¾åˆ†åˆ«æ˜¯å­¦åˆ°çš„ä¸‰ä¸ªéšå˜é‡å’Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„å‚æ•°\\(k\\)å’Œ\\(b\\)çš„å…³ç³»å›¾ã€‚ç¬¬ä¸€å¹…å›¾ä¸­å˜é‡\\(1\\)ä¸\\(b\\)å‡ ä¹å®Œå…¨çº¿æ€§ç›¸å…³ï¼Œä¸\\(k\\)åŸºäºçº¿æ€§æ— å…³ï¼Œå˜é‡\\(2\\)åªå’Œ\\(k\\)ç›¸å…³ã€‚å˜é‡\\(3\\)å‡ ä¹ä¸ºä¸€ä¸ªå¸¸æ•°ï¼Œæ•…ä¸æä¾›é¢å¤–çš„ä¿¡æ¯ã€‚ç”±æ­¤ä½œè€…è®¤ä¸ºSciNetå­¦åˆ°äº†æˆ‘ä»¬å…³å¿ƒçš„ä¸¤ä¸ªå‚æ•°çš„çŸ¥è¯†ã€‚ Conservation of Angular Momentum è§’åŠ¨é‡å®ˆæ’å®éªŒï¼š ä»»åŠ¡ï¼šé¢„æµ‹ä¸€ä¸ªç”±é•¿åº¦ä¸º\\(r\\)çš„ç»³å­æ†ç»‘ç€çš„æ—‹è½¬è´¨ç‚¹åœ¨ä½ç½®\\((0,r)\\)ç»ä¸€ä¸ªè‡ªç”±è´¨ç‚¹æ’å‡»åçš„ä½ç½® ç‰©ç†æ¨¡å‹ï¼šç»™å®šæ’å‡»ä¹‹å‰çš„è§’åŠ¨é‡ï¼Œè‡ªç”±è´¨ç‚¹æ’å‡»ä¹‹åçš„é€Ÿåº¦ï¼Œæ—‹è½¬è´¨ç‚¹åœ¨æ’å‡»ä¹‹ååœ¨æ—¶é—´\\(t_\\text{pred}^\\prime\\)çš„ä½ç½®å¯ä»¥ç”±è§’åŠ¨é‡å®ˆæ’å®šå¾‹ç»™å‡ºï¼š \\[ J=m_\\text{rot}r^2\\omega-rm_\\text{free}(\\mathbf{v}_\\text{free})_x=m_\\text{rot}r^2\\omega^\\prime-rm_\\text{free}(\\mathbf{v}^\\prime_\\text{free})_x=J^\\prime \\] è§‚æµ‹æ•°æ®ï¼šåœ¨æ’å‡»ä¹‹å‰ä¸¤ä¸ªè´¨ç‚¹çš„ä½ç½®æ•°æ®\\(o=[(t_i^\\text{rot},q_\\text{rot}(t_i^\\text{rot})),(t_i^\\text{free},q_\\text{free}(t_i^\\text{free}))]_{i\\in\\{1,\\cdots,5\\}}\\)ï¼Œè´¨é‡ä¸ºå›ºå®šå€¼ï¼ŒåŠå¾„\\(r\\)ä¹Ÿä¸ºå›ºå®šå€¼ã€‚æ•°æ®æ·»åŠ é«˜æ–¯å™ªå£°ã€‚ é—®é¢˜ï¼šé¢„æµ‹æ’å‡»ä¹‹åè‡ªç”±è´¨ç‚¹åœ¨æ—¶é—´\\(t_\\text{pred}^\\prime\\)çš„ä½ç½® å®éªŒå®¤æ„å›¾å¦‚ä¸‹ï¼š å®éªŒç»“æœè¡¨æ˜SciNetèƒ½å¤Ÿæ­£ç¡®é¢„æµ‹è´¨ç‚¹æ’å‡»ä¹‹åçš„ä½ç½®ï¼ŒåŒæ—¶å¯¹å™ªéŸ³é²æ£’ã€‚æ ¹æ®(b)ï¼Œéšå˜é‡å’Œè§’åŠ¨é‡å­˜åœ¨çº¿æ€§ç›¸å…³å…³ç³»ï¼Œä½œè€…è®¤ä¸ºSciNetå­¦åˆ°äº†å®ˆæ’çš„åŠ¨é‡è¿™ä¸€æ¦‚å¿µã€‚ Representation of Qubits é‡å­æ¯”ç‰¹å®éªŒï¼š ä»»åŠ¡ï¼šé¢„æµ‹åœ¨\\(n=1,2\\)çš„çº¯\\(n\\)é‡å­ä½çŠ¶æ€\\(\\psi\\in\\mathbb{C}^{2^n}\\)ä¸‹ä»»ä½•äºŒè¿›åˆ¶æŠ•å½±æµ‹é‡\\(\\omega\\in\\mathbb{C}^{2^n}\\)çš„æµ‹é‡æ¦‚ç‡ã€‚ ç‰©ç†æ¨¡å‹ï¼šåœ¨æ‰§è¡Œæµ‹é‡\\(\\omega\\in\\mathbb{C}^{2^n}\\)çš„çŠ¶æ€\\(\\psi\\in\\mathbb{C}^{2^n}\\)ä¸‹æµ‹é‡0çš„æ¦‚ç‡\\(p(\\omega,\\psi)\\)ç”±\\(p(\\omega,\\psi)=|\\left&lt;\\omega,\\psi\\right&gt;|^2\\)ç»™å®š è§‚æµ‹æ•°æ®ï¼šçŠ¶æ€\\(\\psi: o=[p(\\alpha_i,\\psi)]_{i\\in\\{i,\\cdots,n_1\\}}\\)çš„æ“ä½œå‚æ•°åŒ–ï¼šè¡¨ç¤ºä¸€ç»„å›ºå®šçš„éšæœºäºŒå…ƒå°„å½±æµ‹é‡å€¼\\(\\mathcal{M}_1=\\{\\alpha_1,\\cdots,\\alpha_{n_1}\\}\\)ï¼ˆä¸€ä¸ªé‡å­ä½\\(n_1 = 10\\)ï¼Œä¸¤ä¸ªé‡å­ä½\\(n_1 = 30\\)ï¼‰ é—®é¢˜ï¼šå¯¹äºå›ºå®šçš„ä¸€ç»„éšæœºäºŒå…ƒå°„å½±æµ‹é‡\\(\\mathcal{M}_2=\\{\\beta_1,\\cdots,\\beta_{n_2}\\}\\)ï¼Œæµ‹é‡\\(\\omega:q=[p(\\beta_i,\\omega)]_{i\\in\\{1,\\cdots,n_2\\}}\\)çš„Operationalå‚æ•°åŒ–ï¼ˆä¸€ä¸ªé‡å­ä½\\(n_2 = 10\\)ï¼Œä¸¤ä¸ªé‡å­ä½\\(n_2 = 30\\)ï¼‰ å®éªŒç»“æœå¦‚ä¸‹ï¼š é€šè¿‡å®éªŒå‘ç°ï¼ŒSciNetå¯ä»¥åœ¨ä¸æä¾›å…ˆéªŒç‰©ç†çŸ¥è¯†çš„æ¡ä»¶ä¸‹ç¡®å®šè¡¨è¿°çŠ¶æ€\\(\\psi\\)æœ€å°çš„å‚æ•°æ•°é‡ã€‚åŒæ—¶ï¼ŒSciNetè¿˜èƒ½åˆ†è¾¨tomographically completeå’Œtomographically incompleteã€‚ Heliocentric Model of the Solar System æ—¥å¿ƒè¯´æ¨¡å‹ï¼š é—®é¢˜ï¼šåœ¨ç»™å®šåˆå§‹æ¡ä»¶ä¸‹é¢„æµ‹ç›¸å¯¹ä¸åœ°çƒçš„å¤ªé˜³å’Œç«æ˜Ÿçš„è§’åº¦\\(\\theta_M(t)\\)å’Œ\\(\\theta_S(t)\\) ç‰©ç†æ¨¡å‹ï¼šåœ°çƒå’Œç«æ˜Ÿå›´ç»•å¤ªé˜³ä»¥ä¸€å®šè§’é€Ÿåº¦åšè¿‘ä¼¼åœ†å‘¨è¿åŠ¨ è§‚æµ‹æ•°æ®ï¼šç»™å®šåˆå§‹è§’åº¦ï¼Œéšæœºé€‰æ‹©å‘¨å‘¨æœŸçš„å“¥ç™½å°¼çš„è§‚æµ‹æ•°æ® æ¨¡å‹çš„å®ç°ç¨æœ‰å˜åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™æ ·ï¼Œå¯¹äºä¸åŒæ—¶é—´éƒ½å¯¹åº”ä¸€ä¸ªéšå˜é‡\\(r(t_i)\\)ï¼Œè€Œä¸”éšå˜é‡æ˜¯æ—¶é—´ä¾èµ–çš„ï¼Œå¯¹äºä¸€ä¸ªéšå˜é‡\\(r(t_i)\\)æœ‰ä¸€ä¸ªè§£ç å™¨æ¥è¾“å‡ºç­”æ¡ˆã€‚ å®éªŒç»“æœè¡¨ç¤ºï¼ŒSciNetä¸ä»…æ­£ç¡®é¢„æµ‹äº†å¤ªé˜³å’Œç«æ˜Ÿç›¸å¯¹åœ°çƒçš„è§’åº¦ï¼ŒåŒæ—¶éšå˜é‡æ­ç¤ºäº†ç«æ˜Ÿå’Œåœ°çƒç›¸å¯¹å¤ªé˜³çš„è§’åº¦ã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Misc","slug":"Research/Misc","permalink":"http://qfxiao.me/categories/Research/Misc/"}],"tags":[{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"}]},{"title":"Transfer Anomaly Detection by Inferring Latent Domain Representations","slug":"Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations","date":"2020-02-27T12:02:18.000Z","updated":"2020-06-25T09:01:35.786Z","comments":true,"path":"2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/","link":"","permalink":"http://qfxiao.me/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/","excerpt":"","text":"Introduction ä½œè€…æå‡ºäº†ä¸€ç§åˆ©ç”¨è¿ç§»å­¦ä¹ æå‡target domainå¼‚å¸¸æ£€æµ‹æ€§èƒ½çš„ç®—æ³•ã€‚æ–‡ä¸­æŒ‡å‡ºç°æœ‰çš„åŸºäºè¿ç§»å­¦ä¹ çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•éœ€è¦å¯¹æ¯ä¸ª target domain è¿›è¡Œå•ç‹¬è®­ç»ƒï¼Œè¿™æ ·åšä¼šå¸¦æ¥å¾ˆå¤§çš„è®¡ç®—å¼€é”€ã€‚æœ¬æ–‡é€šè¿‡latent domain vectorsæ¥å®ç°æ— éœ€é‡æ–°è®­ç»ƒçš„å¼‚å¸¸æ£€æµ‹ã€‚latent domain vectorsæ˜¯domainçš„ä¸€ç§éšå«è¡¨ç¤ºï¼Œé€šè¿‡è¯¥domainä¸­çš„æ­£å¸¸æ ·æœ¬å¾—åˆ°ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œanomaly score functioné€šè¿‡Auto-encoderå¾—åˆ°ã€‚ Proposed Method Task ä»¤\\(\\mathbf{X}_d^+:=\\{\\mathbf{x}^+_{dn}\\}^{N^+_d}_{n=1}\\)ä¸ºç¬¬\\(d\\)ä¸ªdomainçš„å¼‚å¸¸æ ·æœ¬é›†ï¼Œ\\(\\mathbf{x}_{dn}^+\\in\\mathbb{R}^M\\)ä¸ºå…¶ä¸­ç¬¬\\(n\\)ä¸ªæ ·æœ¬çš„\\(M\\)ç»´ç‰¹å¾å‘é‡ï¼Œ\\(N^+_d\\)ä¸ºç¬¬\\(d\\)ä¸ªdomainå¼‚å¸¸æ ·æœ¬çš„æ•°é‡ã€‚ ç±»ä¼¼çš„ï¼Œä»¤\\(\\mathbf{X}_d^-:=\\{\\mathbf{x}^-_{dn}\\}^{N^-_d}_{n=1}\\)ä¸ºç¬¬\\(d\\)ä¸ªdomainçš„æ­£å¸¸æ ·æœ¬é›†ã€‚æˆ‘ä»¬å‡è®¾å¯¹äºæ¯ä¸ªdomainéƒ½æœ‰\\(N^+_d\\ll N^-_d\\)ï¼Œä¸”ç‰¹å¾å‘é‡ç»´åº¦éƒ½ä¸º\\(M\\)ã€‚ å‡è®¾åœ¨ source domain \\(D_S\\)éƒ½æœ‰æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬ï¼Œè®°ä¸º\\(\\{\\mathbf{X}^+_d\\cup\\mathbf{X}_d^-\\}^{D_S}_{d=1}\\)ï¼Œåœ¨ target domain \\(D_T\\)åªæœ‰æ­£å¸¸æ ·æœ¬\\(\\{\\mathbf{X}_d^-\\}^{D_S+D_T}_{d=D_S+1}\\)ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¾—åˆ°ä¸€ä¸ªå¯¹äº target domain åˆé€‚çš„ domain-specific çš„å¼‚å¸¸æ‰“åˆ†å‡½æ•°ã€‚ Domain-specific Anomaly Score Function æˆ‘ä»¬åŸºäºAuto-encoderå®šä¹‰å¼‚å¸¸æ‰“åˆ†å‡½æ•°ã€‚å¯¹äºæ¯ä¸ªdomainï¼Œæˆ‘ä»¬å‡è®¾å­˜åœ¨ä¸€ä¸ª\\(K\\)ç»´çš„éšå˜é‡\\(\\mathbf{z}_d\\in\\mathbb{R}^K\\)ã€‚å¯¹äºç¬¬\\(d\\)ä¸ª domainï¼Œå¼‚å¸¸æ‰“åˆ†å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š \\[ s_\\theta(\\mathbf{x}_{dn}|\\mathbf{z}_d):=\\parallel\\mathbf{x}_{dn}-G_{\\theta_G}(F_{\\theta_F}(\\mathbf{x}_{dn},\\mathbf{z}_d))\\parallel^2 \\] å…¶ä¸­å‚æ•°\\(\\theta:=(\\theta_G,\\theta_F)\\)åœ¨æ‰€æœ‰ domain ä¹‹é—´å…±äº«ã€‚ Models for Latent Domain Vectors éšå˜é‡\\(\\mathbf{z}_d\\)æ˜¯æ— æ³•è§‚æµ‹åˆ°çš„ï¼Œåªèƒ½é€šè¿‡æ•°æ®æ¥ä¼°è®¡ã€‚é¦–å…ˆ\\(\\mathbf{z}_d\\)åœ¨\\(\\mathbf{X}_d^-\\)æ¡ä»¶ä¸‹çš„æ¡ä»¶åˆ†å¸ƒå‡è®¾ä¸ºé«˜æ–¯åˆ†å¸ƒï¼š \\[ q_\\theta(\\mathbf{z}_d|\\mathbf{X}_d^-):=\\mathcal{N}(\\mathbf{z}_d|\\mu_\\phi(\\mathbf{X}_d^-),\\text{diag}(\\sigma_\\phi^2(\\mathbf{X}_d^-))) \\] å…¶ä¸­å‡å€¼\\(\\mu_\\phi(\\mathbf{X}_d^-)\\in\\mathbb{R}^K\\)å’Œæ–¹å·®\\(\\sigma^2_\\phi(\\mathbf{X}_d^-)\\in\\mathbb{R}^K_+\\)ç”±ç¥ç»ç½‘ç»œå»ºæ¨¡ï¼Œä¸”åœ¨æ‰€æœ‰ domain ä¹‹é—´å…±äº«ã€‚åœ¨\\(\\mathbf{X}_d^-\\)ç»™å®šçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¾¿èƒ½å¤Ÿæ¨æ–­å‡ºè¯¥ domain å¯¹åº”çš„éšå˜é‡ï¼Œ \\(q_\\phi\\)çš„è¾“å…¥ä¸ºæ­£å¸¸æ ·æœ¬çš„é›†åˆï¼Œæ•…ç¥ç»ç½‘ç»œéœ€è¦æ»¡è¶³permutation invariantã€‚\\(\\tau(\\mathbf{X}_d^-)=\\rho(\\sum_{n=1}^{N_d^-}\\eta(\\mathbf{x}_{dn}^-))\\)ï¼Œå…¶ä¸­\\(\\tau(\\mathbf{X}_d^-)\\)è¡¨ç¤º\\(\\mu_\\phi(\\mathbf{X_d^-})\\)æˆ–\\(\\ln\\sigma_\\phi^2(\\mathbf{X}_d^-)\\)ï¼Œ\\(\\rho\\)å’Œ\\(\\eta\\)ä¸ºç¥ç»ç½‘ç»œï¼Œ Objective Function ç›®æ ‡å‡½æ•°ç”±anomaly scoreå‡½æ•°å’Œéšå˜é‡ç»„æˆã€‚ç¬¬\\(d\\)ä¸ªdomainåœ¨å¯¹åº”çš„éšå˜é‡\\(\\mathbf{z}_d\\)æ¡ä»¶ä¸‹çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š \\[ L_d(\\theta|\\mathbf{z}_d):=\\frac{1}{N_d^-}\\sum\\limits_{n=1}^{N_d^-}s_\\theta(\\mathbf{x}_{dn}^-|\\mathbf{z}_d)-\\frac{\\lambda}{N_d^-N_d^+}\\sum\\limits_{n,m=1}^{N_d^-,N_d^+}f(s_\\theta(\\mathbf{x}_{dm}^+|\\mathbf{z}_d)-s_\\theta(\\mathbf{x}_{dn}^-|\\mathbf{z}_d)) \\] å…¶ä¸­\\(\\lambda\\geq 0\\)ä¸ºè¶…å‚æ•°ï¼Œ\\(f\\)ä¸ºsigmoidå‡½æ•°ã€‚å…¬å¼çš„ç¬¬ä¸€é¡¹è¡¨ç¤ºç¬¬\\(d\\)ä¸ªdomainæ­£å¸¸æ ·æœ¬å¯¹åº”çš„anomaly scoreã€‚ç¬¬äºŒé¡¹ä¸ºå¯å¾®åˆ†çš„AUCã€‚å¼‚å¸¸æ ·æœ¬çš„anomaly scoreåº”å½“å¤§äºæ­£å¸¸æ ·æœ¬ï¼Œæ‰€ä»¥å¯¹ä»»ä½•\\(\\mathbf x_{dm}^+\\in\\mathbf X_d^+, \\mathbf x_{dn}^-\\in\\mathbf X_d^-\\)æœ‰\\(s_\\theta(\\mathbf x_{dm}^+|\\mathbf z_d)&gt;s_\\theta(\\mathbf x_{dn}^-|\\mathbf z_d)\\)ã€‚ç¬¬äºŒé¡¹\\(\\frac{\\lambda}{N_d^-N_d^+}\\sum\\limits_{n,m=1}^{N_d^-,N_d^+}f(s_\\theta(\\mathbf{x}_{dm}^+|\\mathbf{z}_d)-s_\\theta(\\mathbf{x}_{dn}^-|\\mathbf{z}_d))\\)çš„å–å€¼èŒƒå›´æ˜¯\\([0,1]\\)ï¼Œå½“æ‰€æœ‰çš„\\(s_\\theta(\\mathbf{x}_{dm}^+|\\mathbf{z}_d)\\gg s_\\theta(\\mathbf{x}_{dm}^-|\\mathbf{z}_d)\\)æ—¶è¯¥é¡¹ä¸º1ï¼Œå½“æ‰€æœ‰çš„\\(s_\\theta(\\mathbf{x}_{dm}^+|\\mathbf{z}_d)\\ll s_\\theta(\\mathbf{x}_{dm}^-|\\mathbf{z}_d)\\)æ—¶è¯¥é¡¹ä¸º0ï¼Œæ‰€ä»¥æœ€å°åŒ–è¯¥é¡¹çš„ç›¸åæ•°ç›¸å½“äºé¼“åŠ±\\(s_\\theta(\\mathbf{x}_{dm}^+|\\mathbf{z}_d)\\gg s_\\theta(\\mathbf{x}_{dm}^-|\\mathbf{z}_d)\\)ã€‚ å› ä¸ºéšå˜é‡\\(\\mathbf z_d\\)åŒ…å«ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ç›®æ ‡å‡½æ•°é‡Œè€ƒè™‘è¿™ä¸€ç‚¹ï¼š \\[ \\mathcal{L}_d(\\theta,\\phi):=\\mathbb{E}_{q_\\phi(\\mathbf{z}_d|\\mathbf{X}_d^-)}\\left[L_d(\\theta|\\mathbf{z}_d)\\right]+\\beta D_\\text{KL}(q_\\phi(\\mathbf{z}_d|\\mathbf{X}_d^-)\\parallel p(\\mathbf{z_d})) \\] ç¬¬ä¸€é¡¹æ˜¯\\(L_d(\\theta|\\mathbf z_d)\\)å…³äº\\(q_\\phi(\\mathbf z_d|\\mathbf X_d^-)\\)çš„æœŸæœ›ï¼Œç¬¬äºŒé¡¹æ˜¯\\(q_\\phi(\\mathbf z_d|\\mathbf X_d^-)\\)å’Œ\\(p(\\mathbf z_d):=\\mathcal{N}(\\boldsymbol 0,\\boldsymbol I)\\)çš„KLæ•£åº¦ã€‚ç¬¬ä¸€é¡¹å¯ä»¥ç”¨monte carloä¼°è®¡\\(\\mathbb{E}_{q_\\phi(\\mathbf{z}_d|\\mathbf{X}_d^-)}\\left[L_d(\\theta|\\mathbf{z}_d)\\right]\\approx\\frac{1}{L}\\sum_{\\ell=1}^L L_d(\\theta|\\mathbf z_d^{(\\ell)})\\)ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜éœ€è¦ç”¨åˆ°reparametrization trickã€‚ å¯¹äºç¬¬\\(d\\)ä¸ªtarget domainï¼Œå› ä¸ºæ²¡æœ‰å¼‚å¸¸æ ·æœ¬ï¼ˆå‡è®¾ï¼‰ï¼Œæ‰€ä»¥\\(L_d(\\theta|\\mathbf{z}_d):=\\frac{1}{N_d^-}\\sum\\limits_{n=1}^{N_d^-}s_\\theta(\\mathbf{x}_{dn}^-|\\mathbf{z}_d)\\)ï¼Œæœ‰ï¼š \\[ \\mathcal{L}_d(\\theta,\\phi):=\\mathbb{E}_{q_\\phi(\\mathbf{z}_d|\\mathbf{X}_d^-)}\\left[\\frac{1}{N_d^-}\\sum\\limits_{n=1}^{N_d^-}s_\\theta(\\mathbf{x}_{dn}^-|\\mathbf{z}_d)\\right]+\\beta D_\\text{KL}(q_\\phi(\\mathbf{z}_d|\\mathbf{X}_d^-)\\parallel p(\\mathbf{z}_d)) \\] æ‰€ä»¥æ€»çš„æŸå¤±å‡½æ•°ä¸ºå„domainå¯¹åº”çš„æŸå¤±å‡½æ•°ä¹‹å’Œ\\(\\mathcal{L}(\\theta,\\phi):=\\sum_{d=1}^{D_S+D_T}\\alpha_d\\mathcal{L}_d(\\theta,\\phi)\\)ã€‚ Inference è®­ç»ƒå¥½ä¹‹åï¼Œdomain-specificçš„anomaly scoreå¯ä»¥ç”±ä¸‹å¼è®¡ç®—å‡ºï¼š \\[ s(\\mathbf{x}_{d^\\prime}):=\\int s_{\\theta_*}(\\mathbf{x_{d^\\prime}}|\\mathbf{z}_{d^\\prime})q_{\\phi_*}(\\mathbf{z}_{d^\\prime}|\\mathbf{X}_{d^\\prime}^-)\\mathrm{d}\\mathbf{z}_{d^\\prime}\\approx\\frac{1}{L}\\sum\\limits_{\\ell=1}^L s_{\\theta_*}(\\mathbf{x}_{d^\\prime}|\\mathbf{z}_{d^\\prime}^{(\\ell)}) \\] Experiments Data å®éªŒåŒ…å«äº”ä¸ªæ•°æ®é›†ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆæˆæ•°æ®é›†ã€‚å¦‚ä¸‹å›¾(a)æ‰€ç¤ºï¼Œå›´ç»•\\((0,0)\\)æœ‰\\(8\\)ä¸ªåœˆï¼Œæ¯ä¸ªåœˆåŒ…å«äº†ä¸€ä¸ªå†…åœˆä½œä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œç¬¬\\(7\\)ä¸ªåœˆè¢«é€‰ä¸ºtarget domainï¼Œå…¶ä½™çš„ä¸ºsource domainã€‚ç¬¬äºŒä¸ªæ˜¯MNIST-rï¼Œæ˜¯åŠ å…¥æ—‹è½¬çš„MNISTï¼ŒåŒ…å«6ä¸ªdomainï¼Œå…¶ä¸­æ•°å­—â€œ4â€è¢«é€‰ä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œå…¶ä½™ä¸ºæ­£å¸¸ã€‚ç¬¬ä¸‰ä¸ªä¸ºAnuran Callsï¼ŒåŒ…å«5ä¸ªdomainã€‚ç¬¬å››ä¸ªæ˜¯Landmineï¼Œä¸»è¦ç”¨åœ¨å¤šä»»åŠ¡å­¦ä¹ ä¸­ã€‚ç¬¬äº”ä¸ªæ˜¯IoTï¼Œç½‘ç»œæµé‡æ•°æ®ï¼ŒåŒ…å«8ä¸ªdomainã€‚ Comparison Methods å¯¹æ¯”çš„baselineåŒ…æ‹¬NNï¼ˆæ™®é€šå¤šå±‚ç¥ç»ç½‘ç»œï¼‰ï¼ŒNNAUCï¼ˆåŠ å…¥å¯å¾®åˆ†AUCä½œä¸ºæŸå¤±å‡½æ•°ï¼‰ï¼ŒAEï¼ˆæ™®é€šAutoencoerï¼‰ï¼ŒAEAUCï¼ˆåŠ å…¥å¯å¾®åˆ†AUCçš„AEï¼‰ï¼ŒOSVMï¼ˆå•ç±»æ”¯æŒå‘é‡æœºï¼‰ï¼ŒCCSAï¼ŒTOSVMå’ŒOTLã€‚ Results 4ä¸ªçœŸå®æ•°æ®é›†çš„ç»“æœå¦‚ä¸‹ï¼š è¡¨5ä¸ºè€ƒè™‘éšå˜é‡ä¸ç¡®å®šæ€§çš„ablation studyã€‚å°†åŸæ¥çš„å…¬å¼\\(\\mathcal{L}_d(\\theta,\\phi):=\\mathbb{E}_{q_\\phi(\\mathbf{z}_d|\\mathbf{X}_d^-)}\\left[L_d(\\theta|\\mathbf{z}_d)\\right]+\\beta D_\\text{KL}(q_\\phi(\\mathbf{z}_d|\\mathbf{X}_d^-)\\parallel p(\\mathbf{z_d}))\\)ä¸­\\(q_\\phi(\\mathbf z_d|\\mathbf X_d^-)\\)ç”¨è¿ªåˆ©å…‹é›·åˆ†å¸ƒ\\(q_\\phi(\\mathbf z_d|\\mathbf X_d^-)=\\delta(\\mathbf z_d-\\mu_\\phi(\\mathbf X_d^-))\\)ä»£æ›¿å¹¶ä¸”å»æ‰KLæ•£åº¦ã€‚ è¡¨6å±•ç¤ºäº†ä¸åŒå¼‚å¸¸æ¯”ä¾‹å¯¹æ•ˆæœçš„å½±å“ã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Transfer Learning","slug":"Transfer-Learning","permalink":"http://qfxiao.me/tags/Transfer-Learning/"}]},{"title":"Deep Anomaly Detection with Deviation Networks","slug":"Deep-Anomaly-Detection-with-Deviation-Networks","date":"2020-02-24T02:45:08.000Z","updated":"2020-06-25T05:30:55.514Z","comments":true,"path":"2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/","link":"","permalink":"http://qfxiao.me/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/","excerpt":"","text":"Introduction æœ¬æ–‡å…³æ³¨Deep Anomaly Detectionï¼Œä¹Ÿå°±æ˜¯ç”¨æ·±åº¦å­¦ä¹ çš„æ–¹æ³•æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€‚æ–‡ä¸­æåˆ°ç°æœ‰çš„Deep Anomaly Detectionå­˜åœ¨ä¸¤ä¸ªå¼Šç«¯ï¼šä¸€ä¸ªæ˜¯é‡‡ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•æ¥è¿›è¡Œç‰¹å¾å­¦ä¹ ï¼Œç„¶åé€šè¿‡ä¸‹æ¸¸ä»»åŠ¡å¾—åˆ°Anomaly Scoreï¼Œç›¸æ¯”æ–‡ä¸­End-to-Endçš„Anomaly Scoreå­¦ä¹ ï¼Œå­˜åœ¨ä¼˜åŒ–ä¸å……åˆ†çš„é£é™©ï¼›å¦ä¸€ä¸ªæ˜¯ç°æœ‰çš„æ–¹æ³•ä¸»è¦æ˜¯æ— ç›‘ç£å­¦ä¹ ï¼Œæ— æ³•åˆ©ç”¨å·²çŸ¥çš„ä¿¡æ¯ï¼ˆå¦‚å°‘é‡æ ‡ç­¾ï¼‰ã€‚ä¸ºæ­¤ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œæ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚ æœ¬æ–‡çš„ä¸»è¦è´¡çŒ®å¦‚ä¸‹ï¼š æå‡ºäº†ä¸€ç§ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œç›´æ¥å­¦ä¹ Anomaly Scoreå¹¶ä¸”å¯ä»¥åˆ©ç”¨å·²çŸ¥ä¿¡æ¯ï¼› åŸºäºæå‡ºçš„æ¡†æ¶ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ç§å®ä¾‹æ–¹æ³• (DevNet)ã€‚ Proposed Model End-To-End Anomaly Score Learning Problem Statement ä¸ºäº†åŒºåˆ«äºä¼ ç»Ÿçš„ä¸¤é˜¶æ®µå¼‚å¸¸æ£€æµ‹ï¼ˆå…ˆå­¦ä¹ ç‰¹å¾è¡¨ç¤ºï¼Œç„¶ååœ¨å­¦åˆ°çš„ç‰¹å¾ä¸Šå®šä¹‰ä¸€ä¸ªanomaly measureæ¥å¾—åˆ°anomaly scoreï¼‰ï¼Œä½œè€…å¯¹ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜é‡æ–°è¿›è¡Œå½¢å¼åŒ–ã€‚ ç»™å®š\\(N+K\\)ä¸ªæ ·æœ¬\\(\\mathcal{X}=\\{\\boldsymbol x_1,\\boldsymbol x_2,\\cdots,\\boldsymbol x_N,\\boldsymbol x_{N+1},\\cdots,\\boldsymbol x_{N+K}\\}\\)ï¼Œå…¶ä¸­\\(\\boldsymbol x_i\\in\\mathbb{R}^D\\)ï¼Œæ— æ ‡ç­¾æ ·æœ¬é›†\\(\\mathcal{U}=\\{\\boldsymbol x_1,\\boldsymbol x_2,\\cdots,\\boldsymbol x_N\\}\\)ï¼Œæœ‰æ ‡ç­¾æ ·æœ¬é›†\\(\\mathcal{K}=\\{\\boldsymbol x_{N+1},\\cdots,\\boldsymbol x_{N+K}\\}\\)ï¼Œä¸”\\(K\\ll N\\)ã€‚å¼‚å¸¸æ£€æµ‹çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªanomaly scoring function\\(\\phi:\\mathcal{X}\\mapsto\\mathbb{R}\\)ä½¿å¾—\\(\\phi(\\boldsymbol x_i)&gt;\\phi(\\boldsymbol x_j)\\)ï¼Œå…¶ä¸­\\(\\boldsymbol x_i\\)ä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œ\\(\\boldsymbol x_j\\)ä¸ºæ­£å¸¸æ ·æœ¬ã€‚ The Proposed Framework ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ç§é€šç”¨å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œæ¨¡å‹æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ¨¡å‹æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸»è¦åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š anomaly scoring network. å›¾ä¸­å·¦è¾¹çš„éƒ¨åˆ†ï¼Œä¸€ä¸ªå‡½æ•°\\(\\phi\\)ï¼Œè¾“å…¥æ ·æœ¬\\(\\mathbf{x}\\)ï¼Œè¾“å‡ºanomaly score reference score generator. å›¾ä¸­å³è¾¹çš„éƒ¨åˆ†ã€‚åªæœ‰ä¸€ä¸ªanomaly scoring networkå¹¶ä¸èƒ½è¿›è¡Œè®­ç»ƒï¼Œéœ€è¦è®­ç»ƒçš„ç›®æ ‡ã€‚ä¸ºæ­¤åŠ å…¥reference score generatorï¼Œè¾“å…¥ä¸ºéšæœºé€‰æ‹©çš„\\(l\\)ä¸ªæ­£å¸¸æ ·æœ¬ï¼Œè¾“å‡ºreference scoreï¼ˆè¿™\\(l\\)ä¸ªæ­£å¸¸æ ·æœ¬anomaly scoreçš„å‡å€¼ï¼Œè®°ä¸º\\(\\mu_\\mathcal{R}\\)ï¼‰ deviation loss. \\(\\phi(\\mathbf{x})\\)ï¼Œ\\(\\mu_\\mathcal{R}\\)åŠå¯¹åº”çš„æ ‡å‡†å·®\\(\\sigma_\\mathcal{R}\\)ä½œä¸ºdeviation losså‡½æ•°çš„è¾“å…¥ã€‚å› ä¸º\\(\\mu_\\mathcal{R}\\)å’Œ\\(\\sigma_\\mathcal{R}\\)å¯¹åº”æ­£å¸¸æ ·æœ¬é›†çš„å‡å€¼å’Œæ–¹å·®ï¼Œé‚£ä¹ˆå¼‚å¸¸æ ·æœ¬çš„anomaly scoreåº”è¯¥å’Œ\\(\\mu_\\mathcal{R}\\)å·®åˆ«æ¯”è¾ƒå¤§ï¼Œè€Œæ­£å¸¸æ ·æœ¬åˆ™åº”è¯¥æ¥è¿‘\\(\\mu_\\mathcal{R}\\)ã€‚ Deviation Networks ä¸‹é¢æ˜¯ä¸Šè¿°ä¸‰ä¸ªéƒ¨ä»¶çš„å…·ä½“å®ç°ã€‚ End-To-End Anomaly Scoring Network è®°\\(\\mathcal{Q}\\in\\mathbb{R}^M\\)ä¸ºä¸­é—´è¡¨ç¤ºç©ºé—´ï¼Œanomaly scoring network\\(\\phi(\\cdot;\\Theta):\\mathcal{X}\\mapsto\\mathbb{R}\\)å¯ä»¥å®šä¹‰ä¸ºæ•°æ®è¡¨ç¤ºå­¦ä¹ \\(\\psi(\\cdot;\\Theta_t):\\mathcal{X}\\mapsto\\mathcal{Q}\\)å’Œå¼‚å¸¸åˆ†æ•°å­¦ä¹ \\(\\eta(\\cdot;\\Theta_s):\\mathcal{Q}\\mapsto\\mathbb{R}\\)ä¸¤é˜¶æ®µçš„ç»„åˆï¼Œå…¶ä¸­\\(\\Theta=\\{\\Theta_t,\\Theta_s\\}\\)ã€‚ \\(\\psi(\\cdot;\\Theta_t)\\)å¯ä»¥ç”¨ä¸€ä¸ª\\(H\\)å±‚ç¥ç»ç½‘ç»œæ¥å®ç°ï¼š \\[ \\mathrm{q}=\\psi(\\mathbf{x};\\Theta_t) \\] å…¶ä¸­\\(\\mathbf{x}\\in\\mathcal{X}\\)ï¼Œ\\(\\mathrm{q}\\in\\mathcal{Q}\\)ã€‚ \\(\\eta(\\cdot;\\Theta_s)\\)å¯ä»¥ç”¨ä¸€ä¸ªå•å±‚çš„ç¥ç»ç½‘ç»œæ¥å®ç°ï¼š \\[ \\eta(\\mathrm q;\\Theta_s)=\\sum\\limits_{i=1}^M w_i^oq_i+w_{M+1}^o \\] å…¶ä¸­\\(\\mathrm q\\in\\mathcal Q\\)ï¼Œ\\(\\Theta_s=\\{\\mathbf{w}^o\\}\\)ã€‚ æ‰€ä»¥æœ‰ï¼š \\[ \\phi(\\mathbf{x};\\Theta)=\\eta(\\psi(\\mathbf{x};\\Theta_t);\\Theta_s) \\] Gaussian Prior-based Reference Scores æœ‰ä¸¤ç§æ–¹æ³•æ¥è·å¾—\\(\\mu_\\mathcal{R}\\)ï¼Œä¸€ç§æ˜¯data-drivenï¼Œä¸€ç§æ˜¯prior-drivenã€‚å¦‚æœæ˜¯data-drivençš„è¯åˆ™é‡‡ç”¨å¦ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œæ–‡ä¸­è¡¨ç¤ºä¸ºäº†æ›´å¥½çš„è§£é‡Šæ€§å’Œè®¡ç®—æ•ˆç‡ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ˜¯prior-drivenã€‚ \\[ \\begin{align} r_1,r_2,\\cdots,r_l\\sim \\mathcal{N}(\\mu,\\sigma^2),\\\\ \\mu_\\mathcal{R}=\\frac{1}{l}\\sum\\limits_{i=1}^l r_i \\end{align} \\] åœ¨æ–‡ä¸­ï¼Œé‡‡ç”¨çš„prioræ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒã€‚ Z-Score Based Deviation Loss anomaly scoring networkçš„ä¼˜åŒ–ç›®æ ‡å¯ä»¥å®šä¹‰ä¸ºZ-Scoreçš„æ–¹å¼ï¼š \\[ dev(\\boldsymbol x)=\\frac{\\phi(\\boldsymbol x;\\Theta)-\\mu_{\\mathcal{R}}}{\\sigma_{\\mathcal{R}}} \\] \\(dev(\\boldsymbol x)\\)å¯ä»¥çœ‹ä½œæ˜¯æ ·æœ¬åç¦»æ ‡å‡†çš„ç¨‹åº¦ï¼Œè€Œæˆ‘ä»¬è‚¯å®šå¸Œæœ›å¼‚å¸¸æ ·æœ¬åç¦»æ ‡å‡†è¶Šå¤§ï¼Œæ­£å¸¸æ ·æœ¬è¶Šæ¥è¿‘æ ‡å‡†ã€‚æ–‡ä¸­é‡‡ç”¨çš„æŸå¤±å‡½æ•°æ˜¯Contrastive Lossï¼š \\[ L(\\phi(\\boldsymbol x;\\Theta),\\mu_\\mathcal{R},\\sigma_\\mathcal{R})=(1-y)|dev(\\boldsymbol x)| + y \\max(0, a - dev(\\boldsymbol x)) \\] Contrastive Lossçš„ç›´è§‚è§£é‡Šå¯ä»¥çœ‹ä¸‹å›¾ï¼š å¯¹äºè´Ÿä¾‹ï¼ˆæ­£å¸¸ï¼‰ï¼Œä¼˜åŒ–è¿‡ç¨‹å°†ä»–ä»¬å°½é‡å‘åŸç‚¹é è¿‘ï¼Œå¯¹äºæ­£ä¾‹ï¼ˆå¼‚å¸¸ï¼‰ï¼Œä¼˜åŒ–è¿‡ç¨‹å°†ä»–ä»¬æ‹‰å‘è¾¹ç•Œã€‚ The DevNet Algorithm DevNetçš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š Interpretability of Anomaly Scores å› ä¸ºreference score generatoré€‰æ‹©çš„æ˜¯ç¡®å®šçš„é«˜æ–¯åˆ†å¸ƒï¼Œäºæ˜¯å¯ä»¥ç”¨æ¦‚ç‡è®ºç»™å‡ºä¸€äº›è§£é‡Šæ€§ã€‚ä½œè€…ç»™å‡ºäº†ä¸€ä¸ªç»“è®ºï¼Œ PROPOSITIONï¼š è®¾\\(\\boldsymbol x\\in\\mathcal{X}\\)ï¼Œ\\(z_p\\)ä¸º\\(\\mathcal{N}(\\mu,\\sigma^2)\\)çš„åˆ†ä½æ•°ï¼Œé‚£ä¹ˆ\\(\\phi(\\boldsymbol x)\\)åœ¨åŒºé—´\\(\\mu\\pm z_p\\sigma\\)çš„æ¦‚ç‡ä¸º\\(2(1-p)\\)ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾\\(p=0.95\\)ï¼Œé‚£ä¹ˆ\\(z_{0.95}=1.96\\)ï¼Œè¡¨ç¤ºå¼‚å¸¸åˆ†æ•°é«˜äº1.96çš„æ ·æœ¬å°†ä»¥0.95çš„ç½®ä¿¡åº¦ä¸ºå¼‚å¸¸ã€‚ Experiment å®éªŒç”¨åˆ°äº†9ä¸ªæ•°æ®é›†ï¼Œ4ä¸ªBaseline (REPENï¼ŒDSVDDï¼ŒFSNETï¼ŒiForest)ï¼Œä»¥åŠROCå’ŒPRæ›²çº¿ä¸¤ç§è¯„æµ‹æ ‡å‡†ã€‚ Effectiveness in Real-world Data Sets Experiment Settings è¿™ä¸€ä¸ªå®éªŒä¸»è¦æ˜¯ä¸ºäº†éªŒè¯ç®—æ³•åœ¨çœŸå®åœºæ™¯ä¸‹çš„æ•ˆæœï¼Œå³å¤§é‡æ— æ ‡ç­¾æ•°æ®å’Œæå°‘é‡æ ‡ç­¾æ•°æ®ã€‚è®­ç»ƒé›†åŒ…å«ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯æ— æ ‡ç­¾æ•°æ®\\(\\mathcal{U}\\),åŒ…å«\\(2\\%\\)çš„å¼‚å¸¸æ ·æœ¬ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æœ‰æ ‡ç­¾æ•°æ®\\(\\mathcal{K}\\)ï¼Œç”±éšæœºé‡‡æ ·\\(0.005\\%-1\\%\\)çš„è®­ç»ƒæ•°æ®å’Œ\\(0.08\\%-6\\%\\)çš„å¼‚å¸¸æ ·æœ¬ç»„æˆã€‚ Findings å®éªŒç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š ä»ç»“æœä¸Šçœ‹æ¥ï¼Œæœ¬æ–‡æå‡ºçš„æ–¹æ³•åœ¨æ‰€æœ‰æ•°æ®é›†ä¸Šéƒ½æ¯”Baselineå¥½ï¼Œè¯´æ˜DevNetç«¯åˆ°ç«¯ç›´æ¥ä¼˜åŒ–Anomaly Scoreçš„æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚ Data Efficiency Experiment Settings è¿™ä¸€ä¸ªå®éªŒä¸»è¦æ˜¯ä¸ºäº†æ¢ç©¶åŸºäºæ·±åº¦çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„data efficiencyã€‚å’Œä¸Šä¸€ä¸ªå®éªŒä¸€æ ·ï¼Œæ— æ ‡ç­¾æ•°æ®é›†åŒ…å«\\(2\\%\\)çš„å¼‚å¸¸ï¼Œè€Œæœ‰æ ‡ç­¾çš„å¼‚å¸¸æ•°é‡ä»\\(5\\)åˆ°\\(120\\)ä¸ç­‰ã€‚æœ¬å®éªŒè¯•å›¾å›ç­”ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š DevNetçš„data efficiencyå¦‚ä½•ï¼Ÿ åŸºäºæ·±åº¦çš„æ–¹æ³•åœ¨å¤šå¤§ç¨‹åº¦ä¸Šèƒ½å¤Ÿåˆ©ç”¨æ ‡ç­¾ä¿¡æ¯ï¼Ÿ Findings åœ¨å‡ ä¸ªåŸºäºæ·±åº¦çš„Baselineä¸­ï¼ŒDevNetçš„æ•ˆæœæ˜¯æœ€å¥½çš„ï¼ŒåŒæ—¶åœ¨æœ‰æ ‡ç­¾å¼‚å¸¸éå¸¸æœ‰é™çš„æƒ…å†µä¸‹ï¼ŒDevNetä¹Ÿèƒ½å¾ˆå¥½çš„åˆ©ç”¨æ ‡ç­¾ä¿¡æ¯ï¼Œè¾¾åˆ°æ›´å¥½çš„æ•ˆæœã€‚ Robustness w.r.t. Anomaly Contamination Experiment Settings åœ¨ç¬¬ä¸€ä¸ªå®éªŒä¸­ï¼Œæ— æ ‡ç­¾æ•°æ®é›†\\(\\mathcal{U}\\)åŒ…å«çš„æ˜¯å›ºå®šçš„å¼‚å¸¸æ¯”ä¾‹\\(2\\%\\)ï¼Œè€Œåœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½œè€…æµ‹è¯•äº†ä»\\(0\\%\\)åˆ°\\(20\\%\\)ä¹‹é—´ä¸åŒå¼‚å¸¸æ¯”ä¾‹æ¥æµ‹è¯•ç®—æ³•çš„é²æ£’æ€§ï¼ˆå³ä½¿\\(\\mathcal{U}\\)ä¸­åŒ…å«å¼‚å¸¸ï¼Œç”±äºæ²¡æœ‰æ ‡ç­¾ï¼Œåœ¨è®­ç»ƒçš„æ—¶å€™ä»ç„¶å‡è®¾éƒ½ä¸ºæ­£å¸¸æ¥è¿›è¡Œè®­ç»ƒï¼‰ã€‚æœ¬å®éªŒè¯•å›¾å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š åŸºäºæ·±åº¦çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„é²æ£’æ€§å¦‚ä½•ï¼Ÿ å½“è®­ç»ƒé›†ä¸­å¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹è¾ƒé«˜çš„æ—¶å€™åŸºäºæ·±åº¦çš„æ–¹æ³•èƒ½å¦æ‰“è´¥æ— ç›‘ç£çš„æ–¹æ³•ï¼Ÿ Findings ä¸‹å›¾ä¸ºå®éªŒç»“æœï¼š ä»ç»“æœä¸Šæ¥çœ‹ï¼ŒDevNetæ¯”å…¶ä»–åŸºäºæ·±åº¦çš„æ–¹æ³•é²æ£’æ€§æ›´å¥½ï¼ŒåŒæ—¶åœ¨é«˜å¼‚å¸¸æ±¡æŸ“çš„æƒ…å†µä¸‹ä»ç„¶æ¯”çº¯æ— ç›‘ç£æ–¹æ³•æ•ˆæœè¦å¥½ã€‚ Ablation Study æœ¬å®éªŒè®¾ç½®äº†DevNetçš„ä¸‰ä¸ªå˜ä½“ï¼ˆé»˜è®¤çš„DevNet-Defä¸ºå•å±‚éšå±‚åŠ ä¸Šä¸€ä¸ªè¾“å‡ºå±‚ï¼‰æ¥è¿›è¡Œæ¶ˆèå®éªŒï¼Œåˆ†åˆ«æ˜¯ï¼š DevNet-Repï¼Œå»æ‰äº†anomaly scoring networkç½‘ç»œçš„è¾“å‡ºå±‚ï¼Œå¯¹åº”end-to-end learning of anomaly scoreså’Œdeviation lossï¼› DevNet-Linearï¼Œå»æ‰äº†ç½‘ç»œä¸­çš„éçº¿æ€§å±‚ï¼Œå¯¹åº”learning of non-linear featuresï¼› DevNet-3HLï¼Œéšå±‚æ•°é‡ä¸º3å±‚ã€‚ å¯¹æ¯”ç»“æœå¦‚ä¸‹ï¼š é€šè¿‡å®éªŒå¯ä»¥å‘ç°ï¼ŒDevNet-Repè¯´æ˜äº†end-to-end learning of anomaly scoreså’Œdeviation lossçš„æœ‰æ•ˆæ€§ï¼Œè€ŒDevNet-Linearè¯´æ˜äº†learning of non-linear featuresçš„é‡è¦æ€§ã€‚DevNet-3HLè¯´æ˜äº†åŠ æ·±ç½‘ç»œå¹¶ä¸æ€»èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ã€‚ Scalability Test è¿™ä¸€ä¸ªå®éªŒä½¿ç”¨åˆæˆçš„æ•°æ®æ¥æµ‹è¯•ç®—æ³•å¯¹å¤§è§„æ¨¡æ•°æ®çš„å¤„ç†èƒ½åŠ›ï¼Œåˆ†åˆ«ä»Data Sizeå’ŒData Dimensionalityä¸¤æ–¹é¢æ¥æµ‹è¯•ã€‚ç»“æœå¦‚ä¸‹ï¼š å¯ä»¥çœ‹å‡ºï¼ŒDevNetå¯¹Data Sizeå¹¶ä¸æ•æ„Ÿï¼ŒåŒæ—¶ï¼Œé¢å¯¹é«˜ç»´æ•°æ®ï¼ŒDevNetä¹Ÿæ²¡æœ‰è¡¨ç°å‡ºåŠ£åŠ¿ã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"}]},{"title":"Geant4 å®‰è£…æ•™ç¨‹ä¸è°ƒè¯•ç¯å¢ƒé…ç½®","slug":"Geant4-å®‰è£…æ•™ç¨‹","date":"2020-01-31T03:25:59.000Z","updated":"2020-06-25T05:39:27.592Z","comments":true,"path":"2020/01/31/Geant4-å®‰è£…æ•™ç¨‹/","link":"","permalink":"http://qfxiao.me/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/","excerpt":"","text":"Introduction Geant4å®‰è£…çš„æ•™ç¨‹å¾ˆå¤šï¼Œç‰ˆæœ¬éƒ½å¾ˆæ—§äº†ï¼Œè¿™é‡Œå†™ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼ˆ10.6ï¼‰åŸºäºUbuntuçš„å®‰è£…æ•™ç¨‹ï¼Œå¹¶ä¸”å¼€å¯CLion IDEè°ƒè¯•ã€‚ Step 1: Download Packages é¦–å…ˆè¿›å…¥å®˜ç½‘(http://geant4.web.cern.ch/support/download)ä¸‹è½½æºä»£ç ï¼ˆæ¨ètar.gzæ ¼å¼ï¼‰åŠæ•°æ®æ–‡ä»¶ï¼Œè§£å‹ã€‚æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸“é—¨ç”¨æ¥æ”¾Geant4ç›¸å…³æ–‡ä»¶ï¼Œæ–°å»ºdataï¼Œsourceï¼Œbuildæ–‡ä»¶å¤¹ï¼Œå°†Geant4çš„æ–‡ä»¶å¤åˆ¶è¿›æ¥å¹¶æŒ‰å¦‚ä¸‹ç»“æ„ç»„ç»‡ï¼š . â”œâ”€â”€ build â”œâ”€â”€ data â”‚ â”œâ”€â”€ G4ABLA3.1 â”‚ â”œâ”€â”€ G4EMLOW7.9 â”‚ â”œâ”€â”€ G4ENSDFSTATE2.2 â”‚ â”œâ”€â”€ G4INCL1.0 â”‚ â”œâ”€â”€ G4NDL4.6 â”‚ â”œâ”€â”€ G4PARTICLEXS2.1 â”‚ â”œâ”€â”€ G4PII1.3 â”‚ â”œâ”€â”€ G4SAIDDATA2.0 â”‚ â”œâ”€â”€ G4TENDL1.3.2 â”‚ â”œâ”€â”€ PhotonEvaporation5.5 â”‚ â”œâ”€â”€ RadioactiveDecay5.4 â”‚ â””â”€â”€ RealSurface2.1.1 â””â”€â”€ source â””â”€â”€ geant4.10.06 Step 2: Install Dependencies å®‰è£…ç¼–è¯‘æ‰€éœ€ç¯å¢ƒï¼š sudo apt-get install build-essential cmake å®‰è£…ç›¸å…³ä¾èµ–ï¼š sudo apt-get install libgl1-mesa-dev libglu1-mesa-dev libxt-dev libxmu-dev libxi-dev zlib1g-dev libgl2ps-dev libexpat1-dev libxerces-c-dev å¦‚æœè¦ç”¨åˆ°QTéœ€è¦å•ç‹¬å®‰è£…QTã€‚ Step 3: Compile è¿›å…¥buildæ–‡ä»¶å¤¹ï¼Œç”¨cmakeå‘½ä»¤ï¼š cmake ../source/geant4.10.06/ -DCMAKE_BUILD_TYPE=DEBUG -DGEANT4_USE_GDML=ON -DGEANT4_USE_OPENGL_X11=ON -DGEANT4_USE_RAYTRACER_X11=ON -DGEANT4_BUILD_MULTITHREADED=ON å…¶ä¸­../source/geant4.10.06/æ›¿æ¢æˆæ¢æˆï¼ˆå¦‚æœç‰ˆæœ¬ä¸ä¸€æ ·ï¼‰ä½ è‡ªå·±çš„Geant4æºä»£ç æ‰€åœ¨ç›®å½•ï¼Œéœ€è¦QTåˆ™åŠ ä¸Š-DGEANT4_USE_QT=ONã€‚å¦‚æœä¸éœ€è¦è°ƒè¯•åˆ™æŠŠ-DCMAKE_BUILD_TYPE=DEBUGæ”¹æˆ-DCMAKE_BUILD_TYPE=RELEASEã€‚-DGEANT4_BUILD_MULTITHREADED=ONæ˜¯å¤šçº¿ç¨‹ï¼Œè§†æƒ…å†µå¼€å¯ã€‚ å®Œæˆä¹‹åå¼€å§‹ç¼–è¯‘ï¼š make -jX -jXä¸ºå¤šçº¿ç¨‹ç¼–è¯‘ï¼Œå¦‚-j8ã€‚ ç¼–è¯‘å®Œæˆä¹‹åè¿›è¡Œå®‰è£…ï¼š sudo make install Step 4: Configure å®‰è£…çš„é»˜è®¤è·¯å¾„åœ¨/usr/local/share/Geant4-10.6.0ï¼Œå°†ä¸‹è½½çš„æ•°æ®æ–‡ä»¶å¤åˆ¶åˆ°è¯¥æ–‡ä»¶å¤¹ï¼š sudo cp -r ./data/ /usr/local/share/Geant4-10.6.0/ ä¹‹åï¼Œåœ¨~/.bashrcé‡Œæ·»åŠ /usr/local/share/Geant4-10.6.0/geant4make/geant4make.shï¼Œå¦‚æœä½ çš„ç‰ˆæœ¬å’Œæˆ‘çš„ä¸ä¸€æ ·ï¼Œç›¸åº”ä¿®æ”¹å³å¯ã€‚ Step 5: CLion Configuration æœ€åæˆ‘ä»¬æ¥é…ç½®CLionç¯å¢ƒï¼Œé…å¥½ä¹‹åå¯ä»¥åœ¨IDEä¸­ç¼–å†™Geant4ä»£ç ï¼Œè¿˜å¯ä»¥æ–­ç‚¹è°ƒè¯•ï¼Œéå¸¸æ–¹ä¾¿ã€‚å®‰è£…CLionçš„è¿‡ç¨‹è¿™é‡Œçœç•¥ï¼Œæ‰“å¼€ä¸€ä¸ªGeant4è‡ªå¸¦çš„ä¾‹å­æˆ–è€…è‡ªå·±æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæ‰“å¼€Edit Configurationsã€‚ éšä¾¿æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¾“å…¥ä¸€ä¸‹å‘½ä»¤è·å–ç¯å¢ƒå˜é‡ï¼š env | grep G4 åœ¨Environment variableså¡«å…¥åˆšæ‰è·å–çš„ç¯å¢ƒå˜é‡ï¼ˆå¤åˆ¶ä¹‹åæŒ‰ä¸€ä¸‹ç²˜è´´å°±å¯ä»¥äº†ï¼‰ï¼Œç„¶åæŠŠWorking directoryè®¾ç½®æˆå½“å‰æ–‡ä»¶å¤¹ã€‚ ç°åœ¨å°±å¤§åŠŸå‘Šæˆäº†ï¼","categories":[{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Misc","slug":"Technical-Notes/Misc","permalink":"http://qfxiao.me/categories/Technical-Notes/Misc/"}],"tags":[{"name":"Geant4","slug":"Geant4","permalink":"http://qfxiao.me/tags/Geant4/"}]},{"title":"Complementary Set Variational Autoencoder for Supervised Anomaly Detection","slug":"Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection","date":"2020-01-09T02:15:03.000Z","updated":"2020-06-25T05:25:53.385Z","comments":true,"path":"2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/","link":"","permalink":"http://qfxiao.me/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/","excerpt":"","text":"Introduction å¯¹äºå¼‚å¸¸æ£€æµ‹é—®é¢˜ï¼Œå¼‚å¸¸çš„æ¨¡å¼æ˜¯å¤šç§å¤šæ ·çš„ã€‚æœ‰ç›‘ç£æ¨¡å‹èƒ½å¤Ÿè¾ƒå¥½åœ°å¤„ç†è®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„æ¨¡å¼ï¼Œæ— ç›‘ç£æ¨¡å‹èƒ½å¤Ÿå¤„ç†è®­ç»ƒé›†ä¸­æœªå‡ºç°è¿‡çš„æ¨¡å¼ï¼Œä½†å¯¹äºè®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å‹å¹¶æ²¡æœ‰å­¦ä¹ ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§æ—¢èƒ½å­¦ä¹ è®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å¼ï¼ŒåŒæ—¶èƒ½å¤„ç†æœªå‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å¼çš„æ–¹æ³•ã€‚ Proposed Model Conventional VAE é¦–å…ˆå›é¡¾ä¸€ä¸‹åŸå§‹çš„VAEã€‚ åŸå§‹VAEä¸­çš„æŸå¤±å‡½æ•°ä¸ºï¼š \\[ \\mathcal{L}(\\boldsymbol{\\theta},\\boldsymbol{\\phi};\\boldsymbol{x})=\\mathbb{E}_{q(\\boldsymbol{z}|\\boldsymbol{x};\\boldsymbol{\\phi})}[\\log p(\\boldsymbol{x}|\\boldsymbol{z};\\boldsymbol{\\theta})]-\\text{KL}[q(\\boldsymbol{z}|\\boldsymbol{x};\\boldsymbol{\\phi}\\parallel p(\\boldsymbol{z}))] \\] åŸæ–‡ä¸­ä½œè€…è¯æ˜äº†\\(\\mathcal{L}(\\boldsymbol{\\theta},\\boldsymbol{\\phi};\\boldsymbol{x})\\leq\\log p(\\boldsymbol{x};\\boldsymbol{\\theta})\\)ï¼Œæ‰€ä»¥\\(\\mathcal{L}(\\boldsymbol{\\theta},\\boldsymbol{\\phi};\\boldsymbol{x})\\)å¯ä»¥çœ‹ä½œæ˜¯æ•°æ®åˆ†å¸ƒ\\(p(\\boldsymbol{x})\\)å¯¹æ•°ä¼¼ç„¶çš„ä¸€ä¸ªä¸‹ç•Œã€‚\\(\\mathcal{L}(\\boldsymbol{\\theta},\\boldsymbol{\\phi};\\boldsymbol{x})\\)åˆè¢«ç§°ä¸ºè¯æ®ä¸‹ç•Œ (ELBO)ã€‚\\(\\mathbb{E}_{q(\\boldsymbol{z}|\\boldsymbol{x};\\boldsymbol{\\phi})}[\\log p(\\boldsymbol{x}|\\boldsymbol{z};\\boldsymbol{\\theta})]\\)ä¸­çš„æœŸæœ›ä¸€èˆ¬ç”¨è’™ç‰¹å¡æ´›æ¥è¿›è¡Œä¼°è®¡ï¼š \\[ \\begin{align} \\mathcal{L}(\\boldsymbol{\\theta},\\boldsymbol{\\phi};\\boldsymbol{x})\\simeq&amp; \\frac{1}{L}\\sum\\limits_l\\log p(\\boldsymbol{x}|\\boldsymbol{z}^{(l)};\\boldsymbol{\\theta})-\\text{KL}[q(\\boldsymbol{z}|\\boldsymbol{x};\\boldsymbol{\\phi})\\parallel p(\\boldsymbol{z})],\\\\ \\boldsymbol{z}^{(l)}&amp;\\sim q(\\boldsymbol{z}|\\boldsymbol{x};\\boldsymbol{\\phi}), \\space l\\in\\{1,2,\\cdots,L\\} \\end{align} \\] å¯¹äºéšå˜é‡\\(\\boldsymbol{z}\\)ï¼Œä¸€èˆ¬å‡è®¾å…ˆéªŒæœä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼ŒåéªŒæœä»å‡å€¼ä¸º\\(\\mu\\)ï¼Œæ–¹å·®ä¸º\\(\\sigma^2\\)çš„é«˜æ–¯åˆ†å¸ƒï¼Œæ•…KLæ•£åº¦èƒ½ç›´æ¥å†™å‡ºè§£æå¼ï¼š \\[ \\mathcal{L}(\\boldsymbol{\\theta},\\boldsymbol{\\phi};\\boldsymbol{x})\\simeq \\frac{1}{L}\\sum\\limits_l\\log p(\\boldsymbol{x}|\\boldsymbol{z}^{(l)};\\boldsymbol{\\theta})-C(-\\frac{1}{2}-\\log\\sigma+\\frac{1}{2}\\sigma^2+\\frac{1}{2}\\mu^2) \\] ä½¿ç”¨VAEæ¥åšå¼‚å¸¸æ£€æµ‹é€šå¸¸æ˜¯åœ¨æ­£å¸¸æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼Œåœ¨æ£€æµ‹é˜¶æ®µï¼Œå¦‚æœæ˜¯å¼‚å¸¸æ ·æœ¬ï¼Œé‚£ä¹ˆVAEä¸èƒ½å¾ˆå¥½åœ°é‡æ„å®ƒï¼Œè¿™æ ·ä¼šå¯¼è‡´è¾ƒå¤§çš„é‡æ„è¯¯å·®ã€‚ Prior Distribution for Anomalies åœ¨åŸå§‹VAEå¼‚å¸¸æ£€æµ‹ä¸­ï¼Œæ— è®ºè¾“å…¥æ ·æœ¬\\(\\boldsymbol{x}\\)æ˜¯å¦å¼‚å¸¸ï¼ŒVAEéƒ½ä¼šä½¿å¯¹åº”ç¼–ç çš„åéªŒ\\(p(\\boldsymbol{z}|\\boldsymbol{x})\\)æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸”æ–½åŠ æ ‡å‡†é«˜æ–¯åˆ†å¸ƒçš„çº¦æŸã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œä½œè€…å¯¹å¼‚å¸¸å’Œæ­£å¸¸æ ·æœ¬å¯¹åº”çš„éšå˜é‡çš„å…ˆéªŒåˆ†å¸ƒåšäº†ä¸åŒå‡è®¾ã€‚é¦–å…ˆï¼Œæ­£å¸¸å…ˆéªŒä¾ç„¶æ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼Œè®°ä¸º\\(p_n(\\boldsymbol{z})\\)ã€‚è€Œå¯¹äºå¼‚å¸¸å…ˆéªŒï¼Œä½œè€…è®¤ä¸ºå¼‚å¸¸å³ä¸ºâ€œä¸æ­£å¸¸â€ï¼Œå’Œæ­£å¸¸æ˜¯è¡¥é›†çš„å…³ç³»ã€‚ä½œè€…åœ¨æ–‡ä¸­å®šä¹‰å¼‚å¸¸å…ˆéªŒåˆ†å¸ƒ\\(p_a(\\boldsymbol{z})\\)ä¸ºï¼š \\[ p_a(\\boldsymbol{z})=\\frac{1}{Y^\\prime}(\\max\\limits_{\\boldsymbol{z}^\\prime}p_n(\\boldsymbol{z}^\\prime)-p_n(\\boldsymbol{z})) \\] å…¶ä¸­\\(Y^\\prime\\)ä¸ºä½¿\\(p_a(\\boldsymbol{z})\\)æˆä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„è°ƒèŠ‚å› å­ã€‚å®é™…ä¸Šï¼Œ\\(Y^\\prime\\)å¾€å¾€ä¼šæˆä¸ºæ— é™å¤§ï¼Œå› ä¸º\\(p(\\boldsymbol z)\\)åœ¨æ•´ä¸ªå®šä¹‰åŸŸä¸Šéƒ½æœ‰å®šä¹‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…åŠ å…¥äº†\\(p_w(\\boldsymbol z)\\)ï¼Œä¸€ä¸ªåœ¨æ¯ä¸ªç»´åº¦éƒ½è¶³å¤Ÿå®½çš„è¾…åŠ©åˆ†å¸ƒï¼š \\[ p_a(\\boldsymbol z)=\\frac{1}{Y}p_w(\\boldsymbol z)\\left(\\max\\limits_{\\boldsymbol z^\\prime}p_n(\\boldsymbol z^\\prime)-p_n(\\boldsymbol z)\\right) \\] å…¶ä¸­\\(Y\\)ä¸ºæœ‰é™çš„å¸¸æ•°ã€‚åœ¨æ–‡ä¸­\\(p_n(\\boldsymbol z)\\)å’Œ\\(p_w(\\boldsymbol z)\\)éƒ½ä¸ºé«˜æ–¯åˆ†å¸ƒï¼Œé‚£ä¹ˆ\\(p_a(\\boldsymbol z)\\)çš„å…·ä½“å½¢å¼ä¸ºï¼š \\[ p_a(\\boldsymbol z)=\\frac{1}{Y}\\mathcal{N}(\\boldsymbol z;\\boldsymbol 0,\\boldsymbol s^2)\\{\\max\\limits_{\\boldsymbol z^\\prime}\\mathcal N(\\boldsymbol z^\\prime;\\boldsymbol 0,\\boldsymbol 1)-\\mathcal N(\\boldsymbol z;\\boldsymbol 0,\\boldsymbol 1)\\} \\] å…¶ä¸­ï¼š \\[ \\max\\limits_{\\boldsymbol z^\\prime}\\mathcal N(\\boldsymbol z^\\prime;\\boldsymbol 0,\\boldsymbol 1)=\\frac{1}{\\sqrt{2\\pi}} \\] \\[ Y=\\int_{-\\infty}^{\\infty}p_a(\\boldsymbol z)\\mathrm{d}\\boldsymbol z=\\frac{1}{\\sqrt{2\\pi}}\\left\\{1-\\frac{1}{\\boldsymbol s^2+1}\\right\\} \\] \\(\\boldsymbol s^2\\)ä¸ºè¶…å‚æ•°ï¼Œæ§åˆ¶åˆ†å¸ƒçš„å®½åº¦ã€‚ç”¨æ–‡ä¸­çš„å…ˆéªŒæ›¿æ¢VAEåŸå§‹çš„KLæ•£åº¦ï¼Œå¯å†™ä¸ºï¼š \\[ \\text{KL}\\left[q(\\boldsymbol z|\\boldsymbol x;\\phi)\\parallel p_a(\\boldsymbol z)\\right]=\\int_{-\\infty}^\\infty\\mathcal{N}(\\boldsymbol z;\\boldsymbol \\mu,\\boldsymbol \\sigma^2)\\log\\frac{\\mathcal N(\\boldsymbol z;\\boldsymbol\\mu,\\boldsymbol\\sigma^2)}{\\frac{1}{Y}\\mathcal N(\\boldsymbol z;\\boldsymbol 0,\\boldsymbol s^2)\\left\\{\\frac{1}{2\\pi}-\\mathcal N(\\boldsymbol z;\\boldsymbol0,\\boldsymbol 1)\\right\\}}\\mathrm{d}\\boldsymbol z \\] å±•å¼€åï¼š \\[ \\begin{align} \\text{KL}\\left[q(\\boldsymbol z|\\boldsymbol x;\\phi)\\parallel p_a(\\boldsymbol z)\\right]&amp;= \\int_{-\\infty}^\\infty\\mathcal{N}(\\boldsymbol z;\\boldsymbol \\mu,\\boldsymbol \\sigma^2)\\log\\mathcal{N}(\\boldsymbol z;\\boldsymbol\\mu,\\boldsymbol\\sigma^2)\\mathrm{d}\\boldsymbol z\\\\ &amp;+\\log Y\\\\ &amp;-\\int_{-\\infty}^\\infty\\mathcal{N}(\\boldsymbol z;\\boldsymbol \\mu,\\boldsymbol \\sigma^2)\\log\\mathcal{N}(\\boldsymbol z;\\boldsymbol 0,\\boldsymbol s^2)\\mathrm{d}\\boldsymbol z\\\\ &amp;-\\int_{-\\infty}^\\infty\\mathcal{N}(\\boldsymbol z;\\boldsymbol \\mu,\\boldsymbol \\sigma^2)\\log\\left\\{\\frac{1}{\\sqrt{2\\pi}}-\\mathcal{N}(\\boldsymbol z;\\boldsymbol 0, \\boldsymbol 1)\\right\\}\\mathrm{d}\\boldsymbol z \\end{align} \\] ä½¿ç”¨æ³°å‹’å±•å¼€ï¼Œ\\(\\log (x+\\frac{1}{2\\pi})\\simeq-\\log 2\\pi+2\\pi x\\)ï¼ŒKLæ•£åº¦å¯ä»¥ç”¨ä¸‹å¼ä¼°è®¡ï¼š \\[ \\begin{align} \\text{KL}\\left[q(\\boldsymbol z|\\boldsymbol x;\\phi)\\parallel p_a(\\boldsymbol z)\\right]&amp;\\simeq\\sqrt{\\frac{2\\pi}{\\boldsymbol\\sigma^2+1}}\\exp\\left(\\frac{-\\boldsymbol\\mu^2}{2(\\boldsymbol\\sigma^2+1)}\\right)\\\\ &amp;+\\frac{\\boldsymbol\\mu^2+\\boldsymbol\\sigma^2}{2\\boldsymbol s^2}-\\log\\boldsymbol\\sigma+\\log\\boldsymbol s+\\log\\left(\\sqrt{\\boldsymbol s^2+1}-1\\right)\\\\ &amp;-\\frac{\\log(\\boldsymbol s^2+1)}{2}+\\frac{\\log(2\\pi)-1}{2} \\end{align} \\] ä¸‹å›¾ä¸ºä¸€ç»´æ—¶\\(p_n(\\boldsymbol z)\\)å’Œ\\(p_a(\\boldsymbol z)\\)çš„ç¤ºä¾‹ï¼š Implementation of proposed method æ–‡ä¸­ä½¿ç”¨ç¼–ç å™¨è¾“å‡ºçš„åˆ†å¸ƒ\\(\\mathcal{N}(\\boldsymbol z;\\boldsymbol \\mu, \\boldsymbol \\sigma^2)\\)ä¸æ ‡å‡†æ­£æ€åˆ†å¸ƒä¹‹é—´çš„KLæ•£åº¦æ¥ä½œä¸ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨æ¯ä¸€è½®çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒåŠ å…¥ä¸€è½®ä½¿ç”¨Anomaly Priorçš„è®­ç»ƒã€‚ Experiments MNIST ä½œè€…è®¾è®¡äº†ä¸¤ä¸ªTaskï¼š Task 1. \\(N\\) vs. \\(\\bar{N}\\). å°†æ‰‹å†™æ•°å­—ä¸­çš„ä¸€ä¸ªä½œä¸ºå·²çŸ¥å¼‚å¸¸ï¼Œå…¶ä»–ä½œä¸ºæ­£å¸¸ï¼Œå¹¶åŠ å…¥å‡åŒ€åˆ†å¸ƒä½œä¸ºæœªçŸ¥çš„å¼‚å¸¸ã€‚ Task 2. æ‰‹å†™æ•°å­—è¢«åˆ†ä¸º3ç»„ï¼šå·²çŸ¥å¼‚å¸¸ï¼Œæ­£å¸¸ï¼ŒæœªçŸ¥å¼‚å¸¸ã€‚ ç»†èŠ‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š åœ¨å®ç°ä¸Šï¼Œä½¿ç”¨Adamä¼˜åŒ–å™¨ï¼Œbatch_sizeä¸º100ï¼Œepochsä¸º200ã€‚Encoderå’ŒDecoderéƒ½ç”±ä¸‰å±‚æ„ŸçŸ¥æœºç»„æˆï¼Œè¶…å‚æ•°\\(s^2\\)è®¾ç½®ä¸º400ã€‚è¯„æµ‹æ ‡å‡†ä½¿ç”¨AUC (area under the receiver characteristic curve)ã€‚ ä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"VAE","slug":"VAE","permalink":"http://qfxiao.me/tags/VAE/"}]},{"title":"Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE","slug":"Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE","date":"2020-01-06T05:09:32.000Z","updated":"2020-06-25T10:18:35.575Z","comments":true,"path":"2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/","link":"","permalink":"http://qfxiao.me/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/","excerpt":"","text":"Introduction è®ºæ–‡ğŸ“ƒ ä»£ç ğŸ“¥ æœ¬æ–‡ä»‹ç»äº†ä¸€ç§åˆ©ç”¨å¯¹æŠ—è®­ç»ƒæ¥è¿›è¡Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„æ–¹æ³•Buzzã€‚ä½œè€…è®¤ä¸ºåœ¨ç°å®ä¸­å¤æ‚çš„KPIæ•°æ®å¤§é‡å­˜åœ¨ï¼Œè¿™ç§æ•°æ®é€šå¸¸å¸¦æœ‰éé«˜æ–¯åˆ†å¸ƒçš„å™ªå£°ï¼ŒåŒæ—¶æ•°æ®åˆ†å¸ƒå¤æ‚ï¼Œå¯¼è‡´ä¸€èˆ¬çš„ç”Ÿæˆå¼æ¨¡å‹æ— æ³•å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„å»ºæ¨¡ï¼Œæ‰€ä»¥ä½œè€…æå‡ºäº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„æ¨¡å‹ã€‚åœ¨æ–‡ä¸­ï¼Œä½œè€…çš„åˆ›æ–°ç‚¹ä¸»è¦æœ‰ä¸‰ä¸ªï¼š ä¸ºäº†å¤„ç†å¤æ‚æ•°æ®ï¼Œå°†æ•°æ®ç©ºé—´åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼Œåœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šè¿›è¡Œè·ç¦»çš„åº¦é‡ï¼› é‡‡ç”¨Wassersteinè·ç¦»åº¦é‡æ¨¡å‹å»ºæ¨¡çš„åˆ†å¸ƒå’ŒçœŸå®åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼› å»ºç«‹äº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„Buzzçš„æŸå¤±å‡½æ•°å’ŒVAEä¹‹é—´çš„å…³ç³»ã€‚ Background Anomaly Detection å¯¹äºä»»æ„æ—¶é—´\\(t\\)ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼\\(x_{t-T+1},\\cdots,x_t\\)ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º\\(y_t=1\\))ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚\\(p(y_t=1|x_{t-T+1},\\cdots,x_t)\\)ã€‚ VAE Model Latent Data Auto-encoder (AE) None L1Loss Variational Auto-encoder (VAE) KL Divergence Log Likelihood Adversarial Auto-encoder (AAE) Discriminator L1Loss Wasserstein Auto-encoder (WAE) MaxMeanDiscrepancy or Discriminator L1Loss AlphaGAN Discriminator Discriminator+L1Loss GAN and WGAN-GP åŸå§‹GANç­‰ä»·äºä¼˜åŒ–ï¼š \\[ \\mathbb{E}_{x\\sim P_r}\\log{\\frac{P_r(x)}{\\frac{1}{2}\\left[P_r(x)+P_g(x)\\right]}}+\\mathbb{E}_{x\\sim P_g}\\log{\\frac{P_g(x)}{\\frac{1}{2}\\left[P_r(x)+P_g(x)\\right]}} \\] æ ¹æ®KLæ•£åº¦å’ŒJSæ•£åº¦çš„å®šä¹‰ï¼š \\[ \\text{KL}(P_1\\parallel P_2)=\\mathbb{E}_{x\\sim P_1}\\log{\\frac{P_1}{P_2}} \\] \\[ \\text{JS}(P_1\\parallel P_2)=\\frac{1}{2}\\text{KL}(P_1\\parallel \\frac{P_1+P_2}{2})+\\frac{1}{2}\\text{KL}(P_2\\parallel \\frac{P_1+P_2}{2}) \\] å¯é‡å†™ä¸ºï¼š \\[ 2\\text{JS}(P_r\\parallel P_g)-2\\log 2 \\] å½“\\(P_r\\)ä¸\\(P_g\\)çš„æ”¯æ’‘é›†ï¼ˆsupportï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­çš„ä½ç»´æµå½¢ï¼ˆmanifoldï¼‰æ—¶ï¼Œ\\(P_r\\)ä¸\\(P_g\\)é‡å éƒ¨åˆ†æµ‹åº¦ï¼ˆmeasureï¼‰ä¸º0çš„æ¦‚ç‡ä¸º1ã€‚ æ”¯æ’‘é›†ï¼ˆsupportï¼‰å…¶å®å°±æ˜¯å‡½æ•°çš„éé›¶éƒ¨åˆ†å­é›†ï¼Œæ¯”å¦‚ReLUå‡½æ•°çš„æ”¯æ’‘é›†å°±æ˜¯[å…¬å¼]ï¼Œä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„æ”¯æ’‘é›†å°±æ˜¯æ‰€æœ‰æ¦‚ç‡å¯†åº¦éé›¶éƒ¨åˆ†çš„é›†åˆã€‚ æµå½¢ï¼ˆmanifoldï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­æ›²çº¿ã€æ›²é¢æ¦‚å¿µçš„æ‹“å¹¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä½ç»´ä¸Šç›´è§‚ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œæ¯”å¦‚æˆ‘ä»¬è¯´ä¸‰ç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªæ›²é¢æ˜¯ä¸€ä¸ªäºŒç»´æµå½¢ï¼Œå› ä¸ºå®ƒçš„æœ¬è´¨ç»´åº¦ï¼ˆintrinsic dimensionï¼‰åªæœ‰2ï¼Œä¸€ä¸ªç‚¹åœ¨è¿™ä¸ªäºŒç»´æµå½¢ä¸Šç§»åŠ¨åªæœ‰ä¸¤ä¸ªæ–¹å‘çš„è‡ªç”±åº¦ã€‚åŒç†ï¼Œä¸‰ç»´ç©ºé—´æˆ–è€…äºŒç»´ç©ºé—´ä¸­çš„ä¸€æ¡æ›²çº¿éƒ½æ˜¯ä¸€ä¸ªä¸€ç»´æµå½¢ã€‚ æµ‹åº¦ï¼ˆmeasureï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­é•¿åº¦ã€é¢ç§¯ã€ä½“ç§¯æ¦‚å¿µçš„æ‹“å¹¿ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œè¶…ä½“ç§¯â€ã€‚ Wassersteinè·ç¦»å®šä¹‰å¦‚ä¸‹ï¼š \\[ W(P_r,P_g)=\\inf\\limits_{\\gamma\\sim\\prod(P_r,P_g)}\\mathbb{E}_{(x,y)\\sim \\gamma}\\left[\\parallel x-y\\parallel\\right] \\] ä¸‹ç¡®ç•Œ\\(\\inf\\)æ²¡æ³•ç›´æ¥æ±‚è§£ï¼Œä¸è¿‡æ ¹æ®ç›¸å…³å®šç†å…¶ç­‰ä»·äºï¼š \\[ W(P_r,P_g)=\\frac{1}{K}\\sup\\limits_{\\parallel f\\parallel_L\\leq K}\\mathbb{E}_{x\\sim P_r}[f(x)]-\\mathbb{E}_{x\\sim P_g}[f(x)] \\] Lipschitzè¿ç»­æ˜¯æŒ‡å­˜åœ¨ä¸€ä¸ªå¸¸æ•°\\(K\\geq 0\\)ä½¿å¾—å®šä¹‰åŸŸå†…ä»»æ„ä¸¤ä¸ªå…ƒç´ \\(x_1\\)å’Œ\\(x_2\\)éƒ½æ»¡è¶³ï¼š \\[ |f(x_1)-f(x_2)|\\leq K|x_1-x_2| \\] WANçš„æŸå¤±å‡½æ•°ï¼š \\[ \\mathcal{L}=\\mathop{\\mathbb{E}}\\limits_{\\mathbf{x}\\sim\\mathbb{P}_g}\\left[D({\\mathbf{x}})\\right]-\\mathop{\\mathbb{E}}\\limits_{\\mathbf{x}\\sim\\mathbb{P}_r}\\left[D(\\mathbf{x})\\right] \\] WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š \\[ \\mathcal{L}=\\mathop{\\mathbb{E}}\\limits_{\\tilde{\\mathbf{x}}\\sim\\mathbb{P}_g}\\left[D(\\tilde{\\mathbf{x}})\\right]-\\mathop{\\mathbb{E}}\\limits_{\\mathbf{x}\\sim\\mathbb{P}_r}\\left[D(\\mathbf{x})\\right] + \\lambda\\mathop{\\mathbb{E}}\\limits_{\\hat{\\mathbf{x}}\\sim\\mathbb{P}_{\\hat{\\mathbf{x}}}}\\left[(\\parallel\\nabla_{\\hat{\\mathbf{x}}}D(\\hat{\\mathbf{x}})\\parallel_2-1)^2\\right] \\] Proposed Method ä¸‹å›¾ä¸ºBuzzçš„æ€»ä½“æµç¨‹ï¼š æ•°æ®ä¼šé¦–å…ˆè¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼Œä¹‹åè¿›è¡Œè®­ç»ƒã€‚åœ¨æ£€æµ‹é˜¶æ®µä¼šæ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥åˆ¤å®šå¼‚å¸¸ã€‚ Motivation åœ¨æ–‡ä¸­ï¼Œæœ€å…³é”®çš„ä¸¤ä¸ªåˆ›æ–°ç‚¹åˆ†åˆ«æ˜¯Wassersteinè·ç¦»å’Œå¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œåˆ†åŒºçš„æ–¹æ³•ã€‚ åœ¨ä½¿ç”¨è·ç¦»åº¦é‡æ–¹é¢ï¼Œ å› ä¸ºWassersteinåœ¨WGANä¸­å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœï¼Œæ˜¯ä¸€ç§é²æ£’çš„è·ç¦»åº¦é‡ï¼Œæ‰€ä»¥ä½œè€…åœ¨æ–‡ä¸­é‡‡ç”¨äº†Wassersteinè·ç¦»æ¥è¡¡é‡ç”Ÿæˆçš„åˆ†å¸ƒå’ŒçœŸå®çš„åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå¹¶ç”±æ­¤å¼•å…¥äº†å¯¹æŠ—è®­ç»ƒï¼› åœ¨åˆ†åŒºæ–¹æ³•æ–¹é¢ï¼Œä½œè€…è®¤ä¸ºåŸå§‹æ•°æ®è¿‡äºå¤æ‚ï¼Œæ‰€ä»¥å°†æ•°æ®ç©ºé—´\\(\\mathcal{X}\\)è¿›è¡Œåˆ’åˆ†ï¼Œç„¶ååœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šä½¿ç”¨Wassersteinåº¦é‡è·ç¦»ï¼Œè€Œæ€»ä½“çš„è·ç¦»ç”±æ¯ä¸ªåˆ†åŒºçš„è·ç¦»çš„æœŸæœ›æ±‚å¾—ã€‚ ä½œè€…è¿˜å‘ç°ï¼Œå½“åˆ’åˆ†åœ°è¶Šæ¥è¶Šç»†æ—¶ï¼Œæ€»ä½“è·ç¦»æ¥è¿‘äºç‰¹å®šå½¢å¼çš„VAEçš„é‡æ„è¯¯å·®é¡¹ã€‚ Network Structure ä¸‹å›¾ä¸ºæ¨¡å‹çš„ç½‘ç»œç»“æ„ï¼š Training Objective Function å…ˆå®šä¹‰ä¸€äº›ç¬¦å·ï¼š \\(b\\)å’Œ\\(s\\)åˆ†åˆ«ä¸ºBatchçš„å¤§å°å’Œé‚»å±…çš„å¤§å°ï¼Œæ•°æ®é›†æŒ‰\\(s\\)è¿›è¡Œåˆ‡åˆ†ï¼Œç„¶åéšæœºæ‰“ä¹±ï¼Œæ¯ä¸ªBatchåŒ…å«\\(b\\)ä¸ª\\(s\\)ï¼Œä¹‹å\\(s/=2,b*=2\\)ï¼› \\(\\mathcal{W}=\\{w_1,w_2,\\cdots,w_b\\}\\)ä¸ºä¸€ä¸ªBatchï¼Œä¸”æ»¡è¶³æ¯ä¸ª\\(w_i\\)æ˜¯\\(s\\)çš„å€æ•°ï¼› \\(w\\in\\mathcal{W}\\)çš„é‚»åŸŸé›†(neighborhood set)ä¸ºä¸€ä¸ªæ—¶é—´ä¸Šçš„partitionï¼Œè®°ä¸º\\(\\{w,w+1,\\cdots,w+s-1\\}\\) \\(\\mathbf{x}^{(w)},\\mathbf{x}^{(w+1)},\\cdots,\\mathbf{x}^{(w+s-1)}\\)ä¸ºåœ¨ç©ºé—´\\(\\mathcal{X}\\)ä¸Šçš„ä¸€ä¸ªpartitionï¼Œè®°ä¸º\\(S_w\\)ï¼Œå…¶ä¸­\\(\\mathbf{x}^{(w)}\\)è¡¨ç¤ºä»¥\\(w\\)ä¸ºç»“å°¾çš„æ—¶é—´çª—å£ã€‚ Buzzçš„æŸå¤±å‡½æ•°å’ŒWGAN-GPç±»ä¼¼ï¼Œä½†åšäº†ä¸€äº›æ”¹è¿›ï¼Œç”±ä¸‹é¢å››éƒ¨åˆ†ç»„æˆï¼Œä¸‹é¢åˆ†åˆ«è§£é‡Šã€‚ ç¬¬ä¸€ä¸ªæ˜¯æ¯ä¸€ä¸ªpartitionçš„\\(\\mathbf{z}\\)åéªŒçš„KLæ•£åº¦ï¼š \\[ \\mathcal{K} = \\frac{1}{bs}\\sum\\limits_{w\\in\\mathcal{W}}\\sum\\limits_{i=1}^{s-1}\\text{KL}\\left[q_\\phi(\\mathbf{z}|\\mathbf{x})\\parallel\\mathcal{N}(\\mathbf{0},\\mathbf{1})\\right] \\] ç¬¬äºŒä¸ªåœ¨è®­ç»ƒæ—¶æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼š \\[ Z(\\lambda) = \\frac{\\Gamma(W)}{\\Gamma(\\frac{W}{2})}2\\pi^{\\frac{W}{2}}\\lambda^{-W} \\] å…¶ä¸­\\(\\Gamma\\)æ˜¯Gammaå‡½æ•°ã€‚ ç¬¬ä¸‰ä¸ªæ˜¯Wassersteinè·ç¦»ï¼š \\[ \\mathcal{T}(F,w)=\\frac{1}{bs}\\sum\\limits_{i=1}^{s-1}\\mathbb{E}_{q_\\phi(\\mathbf{z}|\\mathbf{x}^{w+i})}\\left[F(\\mathbf{x}^{(w+i)})-F(G(\\mathbf{z}))\\right] \\] ç¬¬å››ä¸ªæ˜¯Gradient Penaltyï¼š \\[ \\mathcal{R}(F,w)=\\frac{1}{bs}\\sum\\limits_{i=1}^{s-1}\\mathbb{E}_{q_\\phi(\\mathbf{z}|\\mathbf{x}^{(w+i)})}\\left[\\mathbb{E}_{\\varepsilon\\sim[0,1]}(\\parallel\\nabla_{\\hat{\\mathbf{x}}}(\\hat{\\mathbf{x}})\\parallel-\\mathbf{1})^2\\right] \\] å…¶ä¸­\\(\\hat{\\mathbf{x}}=\\varepsilon \\mathbf{x}^{w+i}+(1-\\varepsilon)G(\\mathbf{z})\\)ä¸ºç”Ÿæˆæ•°æ®ä¸çœŸå®æ•°æ®çš„æ’å€¼ã€‚ åŸå§‹çš„WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š \\[ L=\\mathop{\\mathbb{E}}\\limits_{\\tilde{\\mathbf{x}}\\sim\\mathbb{P}_g}\\left[D(\\tilde{\\mathbf{x}})\\right]-\\mathop{\\mathbb{E}}\\limits_{\\mathbf{x}\\sim\\mathbb{P}_r}\\left[D(\\mathbf{x})\\right] + \\lambda\\mathop{\\mathbb{E}}\\limits_{\\hat{\\mathbf{x}}\\sim\\mathbb{P}_{\\hat{\\mathbf{x}}}}\\left[(\\parallel\\nabla_{\\hat{\\mathbf{x}}}D(\\hat{\\mathbf{x}})\\parallel_2-1)^2\\right] \\] å…¶ä¸­\\(\\mathbb{P}_g\\)ä¸ºç”Ÿæˆå™¨çš„åˆ†å¸ƒï¼Œ\\(\\mathbb{P}_r\\)ä¸ºçœŸå®åˆ†å¸ƒï¼Œ\\(\\mathbb{P}_{\\hat{\\mathbf{x}}}\\)ä¸ºçœŸå®æ•°æ®å’Œç”Ÿæˆæ•°æ®æ’å€¼å¾—åˆ°çš„åˆ†å¸ƒã€‚ \\[ \\hat{\\mathcal{L}}_{Buzz}=-\\lambda\\sup\\limits_F\\left[\\sum\\limits_{w\\in\\mathcal{W}}(\\left|\\mathcal{T}(F,w)\\right|-\\eta\\mathcal{R}(F,w))\\right]-\\mathcal{K}-\\log Z(\\lambda) \\] Training Procedure Buzzçš„è®­ç»ƒè¿‡ç¨‹ä¸WGAN-GPç±»ä¼¼ï¼Œ Detection æ–‡ä¸­å‡è®¾è§£ç å™¨çš„è¾“å‡ºæœä»å¦‚ä¸‹åˆ†å¸ƒï¼š \\[ p_\\theta(\\mathbf{x}|\\mathbf{z})=\\frac{1}{Z(\\lambda)}\\exp\\{-\\lambda\\parallel\\mathbf{x}-G(\\mathbf{z})\\parallel\\} \\] ä½œè€…å®šä¹‰å¼‚å¸¸åˆ†æ•°ä¸ºï¼š \\[ \\mathcal{S}=\\log p_\\theta(\\mathbf{x})-\\log p_\\theta(\\bar{\\mathbf{x}}) \\] å…¶ä¸­\\(\\bar{\\mathbf{x}}\\)ä¸ºç»è¿‡MCMCå¡«å……åçš„æ ·æœ¬ã€‚ å¼‚å¸¸åˆ†æ•°ä¹Ÿå¯ä»¥å±•å¼€ä¸ºï¼š \\[ \\log\\frac{1}{L}\\sum\\limits_{l=1}^L\\left[\\frac{p_\\theta(\\mathbf{x}|\\mathbf{z^{(l)}})p_\\theta(\\mathbf{z}^{(l)})}{q_\\phi(\\mathbf{z}^{(l)}|\\bar{\\mathbf{x}})}\\right]-\\log\\frac{1}{L}\\sum\\limits_{l=1}^L\\left[\\frac{p_\\theta(\\bar{\\mathbf{x}}|\\mathbf{z}^{(l)})p_\\theta(\\mathbf{z}^{(l)})}{q_\\phi(\\mathbf{z}^{(l)}|\\bar{\\mathbf{x}})}\\right] \\] æœ€ç»ˆç®—æ³•æµç¨‹å›¾ä¸ºï¼š Theoretical Analysis åœ¨ç†è®ºåˆ†æä¸­ï¼Œä½œè€…ä¸»è¦æ˜¯æƒ³å»ºç«‹\\(\\mathcal{L}_{Buzz}\\)å’ŒVAEçš„æŸå¤±å‡½æ•°\\(\\mathcal{L}_{vae}\\)ä¹‹é—´çš„è”ç³»ï¼ŒæŸå¤±å‡½æ•°\\(\\mathcal{\\hat{L}}_{Buzz}\\)ä¸ºï¼š \\[ \\hat{\\mathcal{L}}_{Buzz}=-\\lambda\\sup\\limits_F\\left[\\sum\\limits_{w\\in\\mathcal{W}}(\\left|\\mathcal{T}(F,w)\\right|-\\eta\\mathcal{R}(F,w))\\right]-\\mathcal{K}-\\log Z(\\lambda) \\] ä¸ºäº†ä¾¿äºåˆ†æï¼Œå»æ‰Gradient Penaltyçš„éƒ¨åˆ†ï¼Œå…¬å¼å¯ç®€åŒ–ä¸ºï¼š \\[ \\mathcal{L}_{Buzz}=-\\lambda\\mathbb{E}_{p(w)}W^1\\left[P(\\mathbf{x}|w)\\parallel P(\\mathbf{y}|w)\\right]-\\mathcal{K}-\\log Z(\\lambda) \\] å®é™…ä¸Š\\(Z(\\lambda)=\\mathfrak{S}_W\\Gamma(W)\\lambda^{-W}\\)ï¼Œå…¶ä¸­\\(\\mathfrak{S}_W\\)ä¸º\\(W\\)ç»´å•ä½çƒçš„è¡¨é¢ç§¯ã€‚ \\(n\\)ç»´ç©ºé—´å•ä½çƒè¡¨é¢ç§¯å…¬å¼ï¼š \\[ \\omega_n=\\frac{2\\pi^{\\frac{n}{2}}}{\\Gamma(\\frac{n}{2})} \\] è€Œ\\(W^1\\left[P(\\mathbf{x}|w)\\parallel P(\\mathbf{y}|w)\\right]\\)ä¸ºWassersteinè·ç¦»ï¼š \\[ W^1\\left[P(\\mathbf{x}|w)\\parallel P(\\mathbf{y}|w)\\right]=\\sup\\limits_{Lip(f)\\leq 1}\\left\\{\\int_\\mathcal{X}f(\\mathbf{x})p(\\mathbf{x}|w)\\mathrm{d}\\mathbf{x}-\\int_\\mathcal{X}f(\\mathbf{y})p(\\mathbf{y}|w)\\mathrm{d}\\mathbf{y}\\right\\} \\] Lemma 1 é€šè¿‡è®¾å®šå…·ä½“å½¢å¼çš„åéªŒåˆ†å¸ƒï¼ŒVAEçš„æŸå¤±å‡½æ•°å¯ä»¥å†™ä¸ºï¼š è®¾\\(\\mathbf{x}\\)çš„åéªŒåˆ†å¸ƒ\\(p(\\mathbf{x}|\\mathbf{z})=\\frac{1}{Z(\\lambda)}\\exp\\{-\\lambda\\parallel\\mathbf{x}-G(\\mathbf{z})\\parallel\\}\\)ï¼Œé‚£ä¹ˆVAEçš„æŸå¤±å‡½æ•°ä¸ºï¼š \\[ \\mathcal{L}_{vae}=\\lambda\\mathbb{E}_{p(w)}\\left[\\mathbb{E}_{p(\\mathbf{x}|w)}\\mathbb{E}_{p_G(\\mathbf{y}|\\mathbf{x})}-\\parallel\\mathbf{x}-\\mathbf{y}\\parallel\\right]-\\mathcal{K}-\\log{Z(\\lambda)} \\] åéªŒåˆ†å¸ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªLaplaceåˆ†å¸ƒï¼š Laplace Distribution: \\[ f(x|\\theta,\\lambda)=\\frac{1}{2\\lambda}\\exp{\\left(-\\frac{|x-\\theta|}{\\lambda}\\right)} \\] å¯ä»¥ç›´æ¥æŠŠåéªŒåˆ†å¸ƒå¸¦å…¥VAEçš„æŸå¤±å‡½æ•°å°±å¾—åˆ°äº†ã€‚ Lemma 2 \\(S_w\\)å®šä¹‰ä¸ºæ•°æ®ç©ºé—´\\(\\mathcal{X}\\)çš„ä¸€ä¸ªpartitionï¼Œè€Œ\\(S=\\{(\\mathbf{x}_1,\\mathbf{x}_2)| \\exists w, \\mathbf{x}_1\\in S_w,\\mathbf{x}_2\\in S_w\\}\\)ã€‚ å½“\\(G,\\phi,\\lambda\\)å›ºå®šæ—¶ï¼Œ\\(S\\downarrow\\)æœ‰\\(\\mathcal{L}_{Buzz}\\downarrow\\) Lemma 3 \\(\\max\\mathcal{L}_{Buzz}\\geq\\max{\\mathcal{L}_{vae}}\\)ï¼ŒåŒæ—¶ï¼Œå½“\\(S\\downarrow\\text{diag}{\\mathcal{X}}\\)æ—¶\\(\\max\\mathcal{L}_{Buzz}\\downarrow\\max\\mathcal{L}_{vae}\\) Lemma 4 ä»¤\\(p^\\prime_G(\\mathbf{y}|\\mathbf{x})\\)è¡¨ç¤º\\(\\mathbb{E}_{q_{\\phi^\\prime}}\\left[p_G(\\mathbf{y}|\\mathbf{z})\\right]\\)ã€‚å¦‚æœ\\((G,\\phi,\\lambda)\\)æ˜¯ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆå­˜åœ¨\\((G,\\phi^\\prime,\\lambda)\\)ä½¿å¾—ï¼š \\[ \\mathbb{E}_{p(\\mathbf{x}|w)}\\mathbb{E}_{p_G^\\prime(\\mathbf{y}|\\mathbf{x})}\\parallel\\mathbf{x}-\\mathbf{y}\\parallel=W^1\\left[P(\\mathbf{x}|w)\\parallel P_G(\\mathbf{y}|w)\\right] \\] æ­¤æ—¶\\(\\mathcal{L}_{Buzz}-\\mathcal{L}_{vae}^\\prime=\\mathcal{K}^\\prime-\\mathcal{K}\\)ï¼Œå…¶ä¸­\\(\\mathcal{L}^\\prime,\\mathcal{K}^\\prime\\)åˆ†åˆ«ä¸º\\((G,\\phi^\\prime,\\lambda)\\)æ—¶çš„\\(\\mathcal{L}\\)å’Œ\\(\\mathcal{K}\\)ã€‚ \\[ \\mathcal{L}^\\dagger_{Buzz}=\\mathbb{E}_{p(\\mathbf{x})}\\left[\\mathbb{E}_{q_{\\phi^\\prime}(\\mathbf{z}|\\mathbf{x})}\\log_{p_\\theta}(\\mathbf{x}|\\mathbf{z})\\right]-\\min\\limits_{\\bar{\\phi}\\sim\\phi^\\prime}\\bar{\\mathcal{K}} \\] Lemma 5 è¿™é‡Œä¸»è¦æ˜¯æƒ³è¯æ˜ å¯¹äºå›ºå®šçš„\\(w\\)ï¼Œä»¤ï¼š \\[ \\mathcal{F}=\\{f|Lip(f)\\leq 1\\}, \\space \\mathcal{F}^*=\\left\\{f|_{S_w}\\bigg|Lip(f|_{S_w})\\leq 1\\right\\} \\] æœ‰\\(\\sup_{f\\in\\mathcal{F}}\\mathcal{T}(f)=\\sup_{f|_{S_w}\\in\\mathcal{F}^*}\\mathcal{T}^*\\left(f|_{S_w}\\right)\\)ã€‚ Theorem 6 \\(\\mathcal{L}_{Buzz}\\)çš„å¯¹å¶å½¢å¼ä¸ºï¼š \\[ \\mathcal{L}_{Buzz}=-\\lambda\\sup\\limits_{Lip(F;S)\\leq 1}\\mathbb{E}_{p(w)}\\mathcal{T}^*(F)-\\mathcal{K}-\\log Z(\\lambda) \\] è¿‘ä¼¼çš„\\(\\mathcal{L}_{Buzz}\\)çš„å¯¹å¶å½¢å¼ä¸ºï¼š \\[ \\bar{\\mathcal{L}}_{Buzz}=-\\lambda\\sup\\limits_{Lip(F;S)\\leq 1}\\mathbb{E}_{p(w)}\\mathcal{T}(F)-\\mathcal{K}-\\log Z(\\lambda) \\] Experiment","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://qfxiao.me/tags/Machine-Learning/"},{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"},{"name":"VAE","slug":"VAE","permalink":"http://qfxiao.me/tags/VAE/"}]},{"title":"Variational Approaches for Auto-Encoding Generative Adversarial Networks","slug":"Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks","date":"2019-11-02T15:28:53.000Z","updated":"2020-06-25T09:14:15.351Z","comments":true,"path":"2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/","link":"","permalink":"http://qfxiao.me/2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/","excerpt":"","text":"Abstract æœ¬æ–‡æ­ç¤ºäº†å¯¹æŠ—ç”Ÿæˆç½‘ç»œï¼ˆGenerative Adversarial Networks, GANï¼‰å’Œå˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational Auto-encoders, VAEï¼‰ä¹‹é—´çš„è”ç³»ï¼Œå¹¶æ®æ­¤æå‡ºäº†ä¸€ç§å°†ä¸¤è€…ç»“åˆçš„æ–°æ¨¡å‹ã€‚æ–‡ä¸­ä¸»è¦æ˜¯å°†ä¸å¯è§£çš„ä¼¼ç„¶å‡½æ•°å’ŒæœªçŸ¥çš„åéªŒåˆ†å¸ƒç”¨ä¸€ä¸ªéç¡®å®šçš„åˆ†å¸ƒï¼ˆImmplicit Distributionï¼‰æ›¿ä»£ï¼Œå¹¶åŠ å…¥åˆ¤åˆ«å™¨æ¥ä½¿å¾—è¯¥åˆ†å¸ƒé€¼è¿‘çœŸå®çš„åˆ†å¸ƒã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œä½œè€…å°†VAEä¸­çš„æŸå¤±å‡½æ•°è¿›è¡Œäº†æ›¿æ¢ï¼Œå˜æˆäº†GANä¸­çš„â€œç”Ÿæˆ-åˆ¤åˆ«â€æ¨¡å¼ã€‚ åŸæ–‡ Contribution æœ¬æ–‡æœ‰å¦‚ä¸‹è´¡çŒ®ï¼š æœ¬æ–‡æå‡ºå˜åˆ†æ¨æ–­ï¼ˆVariational Inferenceï¼‰ä¹Ÿèƒ½é€šè¿‡å¯¹éç¡®å®šåˆ†å¸ƒçš„ä¼°è®¡åº”ç”¨åœ¨GANä¸­ï¼› åŸºäºä¼¼ç„¶çš„æ¨¡å‹ï¼ˆLikelihood-based Modelsï¼‰å’Œéä¼¼ç„¶æ¨¡å‹ï¼ˆLikelihood-free Modelsï¼‰èƒ½å¤Ÿé€šè¿‡å¯¹æŠ—å­¦ä¹ ç»“åˆèµ·æ¥ï¼› ä½œè€…æ ¹æ®æ–‡ä¸­æå‡ºçš„æ–°è§‚ç‚¹ä¿®æ”¹äº†VAEçš„æŸå¤±å‡½æ•°ï¼Œå°†å…¶ç§°ä¹‹ä¸ºAuto-encoding GAN (\\(\\alpha\\)-GAN)ï¼Œå¹¶æå‡ºäº†å¯¹åº”çš„å®ç”¨çš„æ”¹è¿›ï¼› æœ¬æ–‡ä¸ä¼—å¤šState-of-Artæ¨¡å‹è¿›è¡Œäº†å¯¹æ¯” Methodology Overcoming Intractability in Generative Models Latent Variable Models éšå˜é‡æ¨¡å‹é€šè¿‡éšå˜é‡çš„å½¢å¼æè¿°äº†æ•°æ®çš„äº§ç”Ÿè¿‡ç¨‹ã€‚æœ€ç®€å•çš„å½¢å¼æ˜¯å‡è®¾éšå˜é‡\\(\\mathbf{z}\\)æœä»ä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒ\\(\\mathbf{z}\\sim p(\\mathbf{z})\\)ï¼Œè€Œæ•°æ®\\(\\mathbf{x}\\)ä»æ¡ä»¶åˆ†å¸ƒ\\(p(\\mathbf{x}|\\mathbf{z})\\)æŠ½æ ·äº§ç”Ÿã€‚é€šå¸¸æ¥è¯´æè¿°\\(p(\\mathbf{x}|\\mathbf{z})\\)çš„æ¨¡å‹ç§°ä¸ºç”Ÿæˆå™¨\\(\\mathcal{G}_\\theta(\\mathbf{z})\\)ï¼Œå¸¦æœ‰å¯ä¼˜åŒ–çš„å‚æ•°\\(\\theta\\)ï¼Œè€Œ\\(\\mathbf{z}\\)é€šå¸¸å‡è®¾ä¸ºæ­£æ€åˆ†å¸ƒ\\(\\mathbf{z}\\sim\\mathcal{N}(\\mathbf{0},\\mathbf{I})\\)ã€‚ æ–‡ä¸­åŒºåˆ†äº†ä¸¤ç§éšå˜é‡æ¨¡å‹ï¼Œä¸€ç§æ˜¯Implicit Latent Variable Modelsï¼Œä¸€ç§æ˜¯Prescribed Latent Variable Modelsã€‚æ–‡ä¸­çš„æè¿°ä¸å¤ªæ¸…æ¥šï¼Œä¸ªäººè®¤ä¸ºä¸¤è€…çš„åŒºåˆ«æ˜¯å‰è€…å›¾æ¨¡å‹ä¸­çš„\\(\\mathbf{x}\\)ä¸æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œåœ¨ä¼˜åŒ–çš„æ—¶å€™éœ€è¦ç”¨ä¸€ä¸ªåˆ»ç”»ç”Ÿæˆçš„\\(\\mathbf{x}\\)å’ŒçœŸå®çš„\\(\\mathbf{x}\\)çš„å·®åˆ«çš„å‡½æ•°\\(\\delta(\\mathbf{x}-\\mathcal{G}_\\theta(\\mathbf{z}))\\)ï¼Œè€Œåè€…å›¾æ¨¡å‹ä¸­\\(\\mathbf{x}\\)æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œè¿™æ ·å¯ä»¥å†™å‡ºä¼¼ç„¶å‡½æ•°ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚ æ— è®ºæ˜¯GANè¿˜æ˜¯VAEéƒ½éœ€è¦é€šè¿‡è¾¹ç¼˜åˆ†å¸ƒ\\(p_\\theta(\\mathbf{x})\\)æ¥åˆ»ç”»å»ºæ¨¡çš„å¥½åï¼Œæ¯”å¦‚è¯´æ ¹æ®\\(p_\\theta(\\mathbf{x})\\)ä¸çœŸå®åˆ†å¸ƒ\\(p^*_\\theta(\\mathbf{x})\\)ä¹‹é—´çš„KLæ•£åº¦\\(\\text{KL}\\left[p_\\theta(\\mathbf{x})\\parallel p_\\theta^*(\\mathbf{x})\\right]\\)ã€‚ä½†é€šå¸¸æƒ…å†µä¸‹\\(p_\\theta(\\mathbf{x})\\)éƒ½æ˜¯ä¸å¯è§£çš„ï¼Œè€ŒGANå’ŒVAEé€šè¿‡ä¸åŒçš„é€”å¾„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ Generative Adversarial Networks GANæ²¡æœ‰ç›´æ¥è®¡ç®—\\(p_\\theta(\\mathbf{x})\\)ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªåˆ¤åˆ«å™¨æ¥åˆ¤åˆ«æ ·æœ¬æ˜¯ä»\\(p_\\theta(\\mathbf{x})\\)è¿˜æ˜¯\\(p_\\theta^*(\\mathbf{x})\\)é‡‡æ ·å¾—åˆ°çš„ï¼Œå¦‚æœåˆ¤åˆ«å™¨æ— æ³•è¿›è¡ŒåŒºåˆ†ï¼Œé‚£æˆ‘ä»¬è®¤ä¸ºæ­¤æ—¶\\(p_\\theta(\\mathbf{x})\\approx p_\\theta^*(\\mathbf{x})\\)ã€‚ ä»¤éšæœºå˜é‡\\(y\\in\\{0,1\\}\\)ï¼Œ\\(y=1\\)è¡¨ç¤ºæ ·æœ¬\\(\\mathbf{x}\\)æ¥è‡ªçœŸå®åˆ†å¸ƒï¼Œ\\(y=0\\)è¡¨ç¤ºæ ·æœ¬\\(\\mathbf{x}\\)æ¥è‡ªç”Ÿæˆåˆ†å¸ƒï¼Œè€Œåˆ¤åˆ«å™¨çš„è¾“å‡ºä¸º\\(\\mathbf{x}\\)æ¥è‡ªçœŸå®åˆ†å¸ƒçš„æ¦‚ç‡\\(\\mathcal{D}_\\phi(\\mathbf{x})=p(y=1|\\mathbf{x})\\)ã€‚GANé€šè¿‡å¯¹æ¥è‡ªçœŸå®åˆ†å¸ƒå’Œç”Ÿæˆåˆ†å¸ƒçš„æ ·æœ¬æ±‚äºŒå…ƒäº¤å‰ç†µæ¥ä½œä¸ºåˆ¤åˆ«å™¨æŸå¤±å‡½æ•°ï¼š \\[ \\textbf{Discriminator Loss: }\\mathbb{E}_{p^*(\\mathbf{x})}[-\\log\\mathcal{D}_\\phi(\\mathbf{x})]+\\mathbb{E}_{p_\\theta(\\mathbf{x})}[-\\log(1-\\mathcal{D}_\\phi(\\mathbf{x}))] \\] ç”Ÿæˆå™¨å°†æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬åˆ¤å®šä¸ºçœŸçš„æ¦‚ç‡ä½œä¸ºæŸå¤±å‡½æ•°ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªç­‰ä»·çš„ä½†åœ¨å®è·µä¸­è¡¨ç°æ›´å¥½çš„æ›¿ä»£ç‰ˆæœ¬ï¼š \\[ \\textbf{Generator Loss: }\\mathbb{E}_{p_\\theta(\\mathbf{x})}[\\log(1-\\mathcal{D}_\\phi(\\mathbf{x}))];\\textbf{ Alternative Loss: }\\mathbf{E}_{p_\\theta(\\mathbf{x})}[-\\log\\mathcal{D}_\\phi(\\mathbf{x})] \\] The Density Ratio Trick ä»¤\\(p^*(\\mathbf{x})=p(\\mathbf{x}|y=1)\\)ï¼Œ\\(p_\\theta(\\mathbf{x})=p(\\mathbf{x}|y=0)\\)ã€‚å®šä¹‰Density Ratio \\(r_\\phi(\\mathbf{x})\\)ä¸ºçœŸå®åˆ†å¸ƒå’Œç”Ÿæˆåˆ†å¸ƒä¹‹é—´çš„æ¯”ä¾‹ï¼š \\[ r_\\phi(\\mathbf{x})=\\frac{p^*(\\mathbf{x})}{p_\\theta(\\mathbf{x})}=\\frac{p(\\mathbf{x}|y=1)}{p(\\mathbf{x}|y=0)}=\\frac{p(y=1|\\mathbf{x})}{p(y=0|\\mathbf{x})}=\\frac{\\mathcal{D}_\\phi(\\mathbf{x})}{1-\\mathcal{D}_\\phi(\\mathbf{x})} \\] ä¸Šå¼è¡¨æ˜äº†Density Ratioçš„è®¡ç®—å¯ä»¥ä»…é€šè¿‡ä»ä¸¤ä¸ªåˆ†å¸ƒä¸Šé‡‡æ ·å¾—åˆ°çš„æ ·æœ¬åŠ ä¸Šä¸€ä¸ªäºŒåˆ†ç±»å™¨\\(\\mathcal{D}_\\phi(\\mathbf{x})\\)å®ç°ï¼ˆå‡è®¾\\(p(y=0)=p(y=1)\\)ï¼‰ã€‚æ›´æ·±å…¥çš„è¯´ï¼Œå¯¹äºä¸å¯è§£çš„åˆ†å¸ƒ\\(p_\\theta^*(\\mathbf{x})\\)ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—Density Ratioæ¥äº†è§£æˆ‘ä»¬è¿‘ä¼¼çš„åˆ†å¸ƒ\\(p_\\theta(\\mathbf{x})\\)å’ŒçœŸå®çš„\\(p_\\theta^*(\\mathbf{x})\\)ä¹‹é—´çš„ç›¸å¯¹æ€§ã€‚è€Œä¸”æˆ‘ä»¬åªéœ€è¦èƒ½å¤Ÿåœ¨ä¸¤ä¸ªåˆ†å¸ƒä¸Šè¿›è¡Œé‡‡æ ·ï¼Œå¹¶ä¸”è®­ç»ƒä¸€ä¸ªåˆ¤åˆ«å™¨å³å¯ã€‚å› ä¸ºåˆ¤åˆ«å™¨æ˜¯ä¸€ä¸ªæ™®é€šçš„åˆ†ç±»å™¨ï¼Œæ‰€ä»¥å¤§é‡çš„ä¸»æµåˆ†ç±»å™¨éƒ½å¯ä»¥ä½¿ç”¨ã€‚ Variational Inference ç°åœ¨æ¥çœ‹VAEï¼Œå¦ä¸€ç§è§£å†³ä¸å¯è§£åˆ†å¸ƒçš„æ–¹æ³•æ˜¯è¿‘ä¼¼ã€‚Variational Inferenceé€šè¿‡å¼•å…¥ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ\\(q_\\eta(\\mathbf{z}|\\mathbf{x})\\)æ¨å‡ºäº†ä¸å¯è§£çš„\\(\\mathbf{x}\\)çš„å¯¹æ•°ä¼¼ç„¶çš„ä¸‹ç•Œï¼ˆå¸¸è¢«ç§°ä¸ºè¯æ®ä¸‹ç•ŒELBOï¼‰ï¼š \\[ \\log p_\\theta(\\mathbf{x})=\\log\\int p_\\theta(\\mathbb{x}|\\mathbb{z})p(\\mathbf{z})\\text{d}\\mathbf{z}\\geq \\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}\\left[\\log p_\\theta(\\mathbf{x}|\\mathbf{z})\\right]-\\text{KL}\\left[q_\\eta(\\mathbf{z}|\\mathbf{x})\\parallel p(\\mathbf{z})\\right]=\\mathcal{F}(\\boldsymbol{\\theta}, \\boldsymbol{\\eta}) \\] VAEæ˜¯Variational Inferenceçš„ä¸€ç§å®ç°ï¼Œå˜åˆ†åˆ†å¸ƒé€šè¿‡ä¸€ä¸ªç¥ç»ç½‘ç»œè¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ä¸”å»ºç«‹èµ·äº†å®Œæ•´çš„å¯ä¼˜åŒ–çš„æ¨¡å‹ã€‚ Synthetic Likelihood å½“ä¼¼ç„¶å‡½æ•°æœªçŸ¥ï¼ˆGANä¸­æ²¡æœ‰æ˜¾å¼çš„ä¼¼ç„¶å‡½æ•°ï¼Œè€ŒVAEä¸­æœ‰ï¼‰çš„æ—¶å€™ï¼ŒVariational Inferenceä¾¿æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚å¯¹äºæ²¡æœ‰æ˜¾å¼çš„ä¼¼ç„¶å‡½æ•°çš„æƒ…å†µï¼Œä»¥VAEçš„ELBOçš„ç¬¬ä¸€é¡¹ä¸ºä¾‹ï¼Œå‡è®¾\\(p_\\theta(\\mathbf{x}|\\mathbf{z})\\)åˆ†å¸ƒçš„å…·ä½“å½¢å¼æœªçŸ¥ï¼Œæˆ‘ä»¬åªæœ‰ä»\\(p_\\theta(\\mathbf{x}|\\mathbf{z})\\)é‡‡æ ·å¾—åˆ°çš„æ ·æœ¬ï¼Œå¦‚ä½•è®¡ç®—\\(\\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}[\\log p_\\theta(\\mathbf{x}|\\mathbf{z})]\\)å‘¢ï¼Ÿä¸€ä¸ªæ–¹æ³•æ˜¯ä¹˜ä»¥\\(p_\\theta^*(\\mathbf{x})\\)å†é™¤ä»¥\\(p_\\theta^*(\\mathbf{x})\\)ï¼š \\[ \\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}[\\log p_\\theta(\\mathbf{x}|\\mathbf{z})]=\\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}\\left[\\log\\frac{p_\\theta(\\mathbf{x}|\\mathbf{z})}{p^*(\\mathbf{x})}\\right]+\\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}[\\log p^*(\\mathbf{x})] \\] å…¬å¼(5)ä¸­çš„ç¬¬ä¸€é¡¹åŒ…æ‹¬äº†åˆæˆä¼¼ç„¶\\(R(\\theta)=\\frac{p_\\theta(\\mathbf{x}|\\mathbf{z})}{p^*(\\mathbf{x})}\\)ï¼Œä¼˜åŒ–\\(R(\\theta)\\)ç›¸å½“äºä¼˜åŒ–\\(\\log p_\\theta(\\mathbf{x}|\\mathbf{z})\\)ã€‚ç¬¬äºŒé¡¹ä¸ç”Ÿæˆç½‘ç»œçš„å‚æ•°\\(\\theta\\)æ— å…³ï¼Œæ‰€ä»¥åœ¨ä¼˜åŒ–çš„æ—¶å€™å¯ä»¥å¿½ç•¥ã€‚ A Fusion of Variational and Adversarial Learning GANå’ŒVAEåˆ†åˆ«ä»ä¸åŒçš„è§’åº¦è§£å†³äº†ç”Ÿæˆæ¨¡å‹çš„æ¨æ–­é—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹é¢ä»VAEå‡ºå‘ï¼Œè€ƒè™‘å°†ä¸¤è€…ç»“åˆèµ·æ¥ã€‚ Implicit Variational Distributions å˜åˆ†æ¨æ–­Variational Inferenceçš„ä¸»è¦ä»»åŠ¡å°±æ˜¯ç¡®å®š\\(q_\\eta(\\mathbf{z}|\\mathbf{x})\\)ï¼Œé€šå¸¸çš„åšæ³•å¦‚Mean-field Variational Inferenceä¼šå‡è®¾ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚åœ¨æœ¬æ–‡ä¸­ä¸å¯¹\\(q_\\eta(\\mathbf{z}|\\mathbf{x})\\)çš„å½¢å¼ä½œå‡è®¾ï¼Œä»…å‡è®¾å…¶ä¸ºä¸€ä¸ªéšå«çš„åˆ†å¸ƒã€‚è¿ç”¨ä¸Šæ–‡æåˆ°çš„Density Ratio Trickï¼Œæˆ‘ä»¬å¯ä»¥å°†VAEæŸå¤±å‡½æ•°ä¸­çš„ç¬¬äºŒé¡¹æ”¹å†™ä¸ºï¼š \\[ -\\text{KL}[q_\\eta(\\mathbf{z}|\\mathbf{x})\\parallel p(\\mathbf{z})]=\\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}\\left[\\log\\frac{p(\\mathbf{z})}{q_\\eta(\\mathbf{z}|\\mathbf{x})}\\right]\\approx\\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}\\left[\\log\\frac{\\mathcal{C}_\\boldsymbol{\\omega}(\\mathbf{z})}{1-\\mathcal{C}_\\boldsymbol{\\omega}(\\mathbf{z})}\\right] \\] æ–‡ä¸­å¼•å…¥äº†ä¸€ä¸ªéšå˜é‡åˆ†ç±»å™¨ï¼ˆLatent Classifierï¼‰\\(\\mathcal{C}_{\\boldsymbol{\\omega}}(\\mathbf{z})\\)ï¼Œç”¨æ¥åˆ¤åˆ«\\(\\mathbf{z}\\)æ˜¯ä»ç¼–ç ç½‘ç»œè¿˜æ˜¯ä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ï¼ˆçŒœæµ‹è¿™æ ·åšçš„å¥½å¤„æ˜¯ä¸ç”¨å†å¯¹\\(\\mathbf{z}\\)çš„åéªŒåšé«˜æ–¯åˆ†å¸ƒçš„å‡è®¾äº†ï¼Œä¹Ÿä¸éœ€è¦åœ¨å˜åˆ†ç½‘ç»œè¾“å‡ºå½¢æˆçš„é«˜æ–¯åˆ†å¸ƒä¸Šé‡‡æ ·å¾—åˆ°\\(\\mathbf{z}\\)äº†ï¼Œè¿™æ ·é‡å‚æ•°æŠ€å·§ä¹Ÿçœäº†ï¼‰ã€‚å…·ä½“å®ç°ä¸Šï¼ŒæœŸæœ›å¯ä»¥ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•ï¼ˆé‡‡æ ·å¤šæ¬¡å–å‡å€¼ï¼‰è¿›è¡Œè®¡ç®—ã€‚ Likelihood Choice å¯¹äºVAEæŸå¤±å‡½æ•°ç¬¬ä¸€é¡¹ï¼Œå¯¹åº”ç”Ÿæˆç½‘ç»œï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¯¹\\(p(\\mathbf{x}|\\mathbf{z})\\)åˆ†å¸ƒçš„å…·ä½“å½¢å¼åšå‡è®¾ï¼Œ è¿™æ ·å¯¹åº”Likelihood-basedçš„æƒ…å†µã€‚æ–‡ä¸­é€‰æ‹©çš„æ˜¯Zero-mean Laplace Distribution \\(p_\\theta(\\mathbf{x}|\\mathbf{z})\\propto\\exp(-\\lambda\\parallel\\mathbf{x}-\\mathcal{G}_\\theta(\\mathbf{z})\\parallel_1)\\)ï¼ˆä¸å°±æ˜¯\\(L_1\\) Losså—ï¼Ÿï¼Ÿï¼Ÿï¼‰ã€‚ å¯¹äºLikelihood-freeçš„æƒ…å†µï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ä¸Šé¢æåˆ°çš„Density Ratio Trickï¼Œè¿™æ—¶éœ€è¦åŠ ä¸€ä¸ªä¸€ä¸ªåˆ¤åˆ«å™¨ã€‚ \\[ \\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}\\left[-\\lambda\\parallel\\mathbf{x}-\\mathcal{G}_\\theta(\\mathbf{z})\\parallel_1\\right]\\space\\space\\text{ or }\\space\\space\\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}\\left[\\log\\frac{\\mathcal{D}_\\phi(\\mathcal{G}_\\theta(\\mathbf{z}))}{1-\\mathcal{D}_\\phi(\\mathcal{G}_\\theta(\\mathbf{z}))}\\right] \\] å¯¹äºä¸¤ç§é€‰æ‹©ï¼Œå‰è€…å¯¹åº”VAEï¼Œå¥½å¤„æ˜¯ä¸ä¼šå‡ºç°æ¨¡å¼å´©æºƒçš„æƒ…å†µï¼Œåè€…å¯¹åº”GANï¼Œå®¹æ˜“å‡ºç°æ¨¡å¼å´©æºƒçš„æƒ…å†µï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å¯¹æŠ—å­¦ä¹ çš„æ–¹å¼ï¼ˆè¿™æ˜¯ä¼˜ç‚¹ï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œæœ¬æ–‡é€‰æ‹©ä¸¤ç§éƒ½ç”¨ï¼ˆæˆ‘å…¨éƒ½è¦.jpgï¼‰ã€‚ Hybrid Loss Functions å°†å‰é¢çš„è®¨è®ºç»“åˆèµ·æ¥ï¼Œæœ€åçš„æŸå¤±å‡½æ•°å°±æ˜¯ï¼š \\[ \\mathcal{L}(\\boldsymbol{\\theta},\\boldsymbol{\\eta})=\\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}\\left[-\\lambda\\parallel\\mathbf{x}-\\mathcal{G}_\\theta(\\mathbf{z})\\parallel_1+\\log\\frac{\\mathcal{D}_\\phi(\\mathcal{G}_\\theta(\\mathbf{z}))}{1-\\mathcal{D}_\\phi(\\mathcal{G}_\\theta(\\mathbf{z}))}+\\log\\frac{\\mathcal{C}_\\boldsymbol{\\omega}(\\mathbf{z})}{1-\\mathcal{C}_\\boldsymbol{\\omega}(\\mathbf{z})}\\right] \\] æœ€åæ¨¡å‹åŒ…å«å››ä¸ªç½‘ç»œï¼šç”Ÿæˆç½‘ç»œ\\(p_\\theta(\\mathbf{x}|\\mathbf{z})\\)ã€æ¨æ–­ç½‘ç»œ\\(q_\\eta(\\mathbf{z}|\\mathbf{x})\\)ä»¥åŠä¸¤ä¸ªåˆ¤åˆ«å™¨\\(\\mathcal{C}_{\\boldsymbol{\\omega}}\\)å’Œ\\(\\mathcal{D}_\\phi\\)ï¼Œä½œè€…å°†å…¶å‘½åä¸º\\(\\alpha\\)-GANã€‚ ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š Improved Techniques ä½œè€…ä¸ºäº†æ”¹è¿›æ¨¡å‹çš„ç¨³å®šæ€§å’Œæ•ˆç‡ï¼Œå°†ç”Ÿæˆå™¨çš„Lossä¸­çš„\\(-\\log(1-\\mathcal{D}_\\phi)\\)ä¿®æ”¹ä¸ºäº†\\(\\log\\mathcal{D}_\\phi-\\log(1-\\mathcal{D}_\\phi)\\)ï¼Œå¹¶å£°ç§°è¿™æ ·èƒ½æä¾›éé¥±å’Œï¼ˆNon-saturatingï¼‰çš„æ¢¯åº¦ï¼š \\[ \\textbf{Generator Loss: } \\mathbb{E}_{q_\\eta(\\mathbf{z}|\\mathbf{x})}\\left[\\lambda\\parallel\\mathbf{x}-\\mathcal{G}_\\theta(\\mathbf{z})\\parallel_1-\\log\\mathcal{D}_\\phi(\\mathcal{G}_\\theta(\\mathbf{z}))+\\log(1-\\mathcal{D}_\\phi(\\mathcal{G}_\\theta(\\mathbf{z})))\\right] \\] ä½œè€…è®¤ä¸ºåœ¨ç”Ÿæˆå™¨æŸå¤±å‡½æ•°ä¸­åŠ å…¥\\(\\lambda\\parallel\\mathbf{x}-\\mathcal{G}_\\theta(\\mathbf{z})\\parallel_1\\)èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦é˜²æ­¢æ¨¡å¼å´©æºƒã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…å‘ç°å°†çœŸå®æ ·æœ¬ï¼ˆåŸæ–‡æ˜¯The Samplesï¼‰ä½œä¸ºç”Ÿæˆçš„æ ·æœ¬è¾“å…¥åˆ°åˆ¤åˆ«å™¨ä¸­èƒ½å¤Ÿæå‡æ€§èƒ½ã€‚ä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯æ ¹æ®Jensenä¸ç­‰å¼ï¼š\\(\\log p_\\theta(\\mathbf{x})=\\log\\int p_\\theta(\\mathbf{x}|\\mathbf{z})p(\\mathbf{z})\\text{d}\\mathbf{z}\\geq \\mathbb{E}_{p(\\mathbf{z})}[\\log p_\\theta(\\mathbf{x}|\\mathbf{z})]\\)ï¼Œ [TODO] Related Work [TODO] Experiments [TODO] Metrics æœ¬æ–‡ä½¿ç”¨äº†å‡ ç§ä¸åŒçš„è¯„æµ‹ç”Ÿæˆæ¨¡å‹çš„æ–¹æ³•ï¼š Inception Score: Multi-scale Structural Similarity (MS-SSIM): Independent Wasserstein Critic: Results on ColorMNIST Results on CelebA Results on CIFAR-10","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"GAN","slug":"Research/GAN","permalink":"http://qfxiao.me/categories/Research/GAN/"}],"tags":[{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"},{"name":"Variational Inference","slug":"Variational-Inference","permalink":"http://qfxiao.me/tags/Variational-Inference/"},{"name":"VAE","slug":"VAE","permalink":"http://qfxiao.me/tags/VAE/"},{"name":"GAN","slug":"GAN","permalink":"http://qfxiao.me/tags/GAN/"}]},{"title":"Anomaly Detection in Streams with Extreme Value Theory","slug":"Anomaly-Detection-in-Streams-with-Extreme-Value-Theory","date":"2019-10-29T03:36:22.000Z","updated":"2020-06-25T05:20:44.374Z","comments":true,"path":"2019/10/29/Anomaly-Detection-in-Streams-with-Extreme-Value-Theory/","link":"","permalink":"http://qfxiao.me/2019/10/29/Anomaly-Detection-in-Streams-with-Extreme-Value-Theory/","excerpt":"","text":"Introduction æœ¬æ–‡åŸºäºExtreme Value Theoryæå‡ºäº†ä¸€ç§ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®é˜ˆå€¼ä¹Ÿä¸éœ€è¦å¯¹æ•°æ®åˆ†å¸ƒä½œä»»ä½•å‡è®¾çš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæœ¬æ–¹æ³•å¯ä»¥ç”¨åœ¨é€šç”¨çš„è‡ªåŠ¨é˜ˆå€¼é€‰æ‹©çš„åœºåˆä¸­ã€‚ åŸæ–‡ Background åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚é˜ˆå€¼çš„é€‰æ‹©å¯ä»¥é€šè¿‡å®éªŒçš„æ–¹æ³•æˆ–è€…å¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œå‡è®¾çš„æ–¹æ³•æ¥å¾—åˆ°ï¼Œä¸è¿‡è¿™æ ·åšé€šå¸¸ä¸å‡†ç¡®ã€‚å€ŸåŠ©Extreme Value Theoryæˆ‘ä»¬å¯ä»¥åœ¨ä¸éœ€è¦å¯¹åŸå§‹æ•°æ®çš„åˆ†å¸ƒä½œå¾ˆå¼ºçš„å‡è®¾çš„æƒ…å†µä¸‹ï¼Œæ¨æ–­æˆ‘ä»¬æƒ³è¦çš„æç«¯äº‹ä»¶çš„åˆ†å¸ƒï¼ˆåœ¨å¼‚å¸¸æ£€æµ‹ä¸­å°±æ˜¯å¼‚å¸¸å€¼ï¼‰ã€‚ ä¸‹é¢ç»™å‡ºä¸€äº›æ•°å­¦ç¬¦å·ï¼Œ\\(X\\)ä¸ºéšæœºå˜é‡ï¼Œ\\(F\\)ä¸ºç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œå³\\(F(x)=\\mathbb{P}(X\\leq x)\\)ã€‚è®°\\(F\\)çš„â€œæœ«å°¾â€åˆ†å¸ƒ\\(\\bar{F}(x)=1-F(x)=\\mathbb{P}(X&gt;x)\\)ã€‚å¯¹äºä¸€ä¸ªéšæœºå˜é‡\\(X\\)å’Œç»™å®šçš„æ¦‚ç‡\\(q\\)ï¼Œè®°\\(z_q\\)ä¸ºåœ¨\\(1-q\\)æ°´å¹³çš„åˆ†ä½æ•°ï¼Œå³\\(z_q\\)ä¸ºæ»¡è¶³\\(\\mathbb{P}(X\\leq z_q)\\geq 1-q\\)æœ€å°çš„å€¼ã€‚ Extreme Value Distributions Extreme Value Theoryä¸»è¦æ˜¯ä¸ºäº†æ‰¾å‡ºæç«¯äº‹ä»¶å‘ç”Ÿçš„è§„å¾‹ï¼Œæœ‰å­¦è€…è¯æ˜ï¼Œåœ¨å¾ˆå¼±çš„æ¡ä»¶ä¸‹ï¼Œæ‰€æœ‰æç«¯äº‹ä»¶éƒ½æœä»ä¸€ä¸ªç‰¹å®šçš„åˆ†å¸ƒï¼Œè€Œä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ã€‚å…·ä½“å½¢å¼å¦‚ä¸‹ï¼š \\[ G_\\gamma:x\\mapsto \\exp(-(1+\\gamma x)^{-\\frac{1}{\\gamma}}), \\space\\space\\space\\space\\space\\gamma\\in\\mathbb{R}, \\space\\space\\space\\space\\space 1+\\gamma x&gt;0 \\] å…¶ä¸­\\(\\gamma\\)ç§°ä¸ºExtreme Value Indexï¼Œç”±åŸå§‹åˆ†å¸ƒå†³å®šã€‚ æ›´ä¸¥è°¨çš„è¯´æ³•æ˜¯Fisher-Tippett-Gnedenkoå®šç†ï¼ˆæå€¼ç†è®ºç¬¬ä¸€å®šç†ï¼‰ï¼š THEOREM: (Fisher-Tippett-Gnedenko). ä»¤\\(X_1,X_2,\\cdots,X_n,\\cdots\\)ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡åºåˆ—ï¼Œ\\(M_n=\\max \\{X_1,\\cdots,X_n\\}\\)ã€‚å¦‚æœå®æ•°å¯¹åºåˆ—\\((a_n,b_n)\\)å­˜åœ¨ä¸”æ»¡è¶³\\(a_n&gt;0\\)å’Œ\\(\\lim\\limits_{n\\rightarrow \\infty}P\\left(\\frac{M_n-b_n}{a_n}\\leq x\\right)=F(x)\\)ï¼Œå…¶ä¸­\\(F\\)ä¸ºéé€€åŒ–åˆ†å¸ƒå‡½æ•°ï¼Œé‚£ä¹ˆ\\(F\\)å±äºGumbelã€FrÃ©chetæˆ–Weibullåˆ†å¸ƒæ—ï¼ˆæˆ–æ€»ç§°Generalized Extreme Value Distributionï¼‰ä¸­çš„ä¸€ç§ã€‚ è¿™æ˜¯ä¸€ä¸ªåç›´è§‰çš„ç»“è®ºï¼Œä½†æ˜¯æƒ³åˆ°å½“äº‹ä»¶å‘ç”Ÿå˜å¾—æç«¯æ—¶ï¼Œå³\\(\\mathbb{P}(X&gt;x)\\rightarrow 0\\)ï¼Œ\\(\\bar{F}(x)=\\mathbb{P}(X&gt;x)\\)åˆ†å¸ƒçš„å½¢çŠ¶å…¶å®å¹¶æ²¡æœ‰å¾ˆå¤šç§é€‰æ‹©ã€‚Table 1å±•ç¤ºäº†å‡ ç§ä¸åŒåˆ†å¸ƒå¯¹åº”çš„\\(\\gamma\\)ï¼š Figure 1å±•ç¤ºäº†å‡ ç§ä¸åŒ\\(\\gamma\\)æƒ…å†µä¸‹çš„â€œæœ«å°¾â€åˆ†å¸ƒï¼š Power of EVT æ ¹æ®Extreme Value Theoryï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸå§‹åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹è®¡ç®—æç«¯äº‹ä»¶çš„æ¦‚ç‡ã€‚ä½†æ˜¯\\(\\bar{G}_\\gamma\\)åˆ†å¸ƒä¸­å‚æ•°\\(\\gamma\\)æ˜¯æœªçŸ¥çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§é«˜æ•ˆçš„æ–¹æ³•æ¥è¿›è¡Œä¼°è®¡ã€‚The Peaks-Over-Threshold (POT) æ–¹æ³•æ˜¯æœ¬æ–‡ä»‹ç»çš„ä¸€ç§æ–¹æ³•ã€‚ Peaks-Over-Threshold Approach POTæ–¹æ³•ä¾èµ–äºPickands-Balkema-De Haanå®šç†ï¼ˆæå€¼ç†è®ºç¬¬äºŒå®šç†ï¼‰ï¼Œç»´åŸºç™¾ç§‘ç‰ˆï¼š è€ƒè™‘ä¸€ä¸ªæœªçŸ¥åˆ†å¸ƒ\\(F\\)å’Œéšæœºå˜é‡\\(X\\)ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡\\(X\\)åœ¨è¶…è¿‡ç¡®å®šé˜ˆå€¼\\(u\\)ä¸‹çš„æ¡ä»¶åˆ†å¸ƒ\\(F_u\\)ï¼Œå®šä¹‰ä¸ºï¼š \\[ F_u(y)=P(X-u\\leq y|X&gt;u)=\\frac{F(u+y)-F(u)}{1-F(u)} \\] å…¶ä¸­\\(0\\leq y\\leq x_F-u\\)ï¼Œ\\(x_F\\)ä¸º\\(F\\)çš„å³ç«¯ç‚¹ã€‚\\(F_u\\)æè¿°äº†è¶…è¿‡ç‰¹å¾é˜ˆå€¼\\(u\\)çš„åˆ†å¸ƒï¼Œç§°ä¸ºConditional Excess Distribution Functionã€‚ STATEMENT: (Pickands-Balkema-De Haan). è®¾\\((X_1,X_2,\\cdots)\\)ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒéšæœºå˜é‡åºåˆ—ï¼Œ\\(F_u\\)ä¸ºç›¸åº”çš„Conditional Excess Distribution Functionã€‚å¯¹äºä¸€å¤§ç±»çš„\\(F\\)å’Œå¾ˆå¤§çš„\\(u\\)ï¼Œ\\(F_u\\)èƒ½å¤Ÿå¾ˆå¥½çš„è¢«Generalized Pareto Distributionæ‰€æ‹Ÿåˆï¼š \\[ F_u(y)\\rightarrow G_{k,\\sigma}(y),\\space\\space \\text{as } u\\rightarrow \\infty \\] å…¶ä¸­ï¼š \\[ G_{k,\\sigma}(y)= \\begin{cases} 1-(1+ky/\\sigma)^{-1/k}, &amp;\\text{if }k\\neq 0\\\\ 1-e^{-y/\\sigma}, &amp;\\text{if }k=0 \\end{cases} \\] å½“\\(k\\geq 0\\)æ—¶\\(\\sigma&gt;0, y\\geq 0\\)ï¼Œ\\(k&lt;0\\)æ—¶\\(0\\leq y\\leq -\\sigma/k\\)ã€‚ è®ºæ–‡ä¸­ç»™å‡ºçš„å®šç†å¦‚ä¸‹ï¼š THEOREM: (Pickands-Balkema-De Haan). ç´¯ç§¯æ¦‚ç‡å¯†åº¦å‡½æ•°\\(F\\in\\mathcal{D}_\\gamma\\)å½“ä¸”ä»…å½“å‡½æ•°\\(\\sigma\\)å­˜åœ¨æ—¶ï¼Œå¯¹æ‰€æœ‰\\(x\\in\\mathbb{R}\\)åœ¨\\(1+\\gamma x&gt;0\\)çš„æ¡ä»¶ä¸‹æœ‰ï¼š \\[ \\frac{\\bar{F}(t+\\sigma(t)x)}{\\bar{F}(t)}\\mathop{\\rightarrow}\\limits_{t\\rightarrow\\tau}(1+\\gamma x)^{-\\frac{1}{\\gamma}} \\] ä¸Šå¼å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š \\[ \\bar{F}_t(x)=\\mathbb{P}(X-t&gt;x|X&gt;t)\\mathop{\\sim}\\limits_{t\\rightarrow\\tau}\\left(1+\\frac{\\gamma x}{\\sigma(t)}\\right)^{-\\frac{1}{\\gamma}} \\] è¯¥å¼è¡¨æ˜\\(X\\)è¶…è¿‡é˜ˆå€¼\\(t\\)çš„æ¦‚ç‡ï¼ˆå†™ä¸º\\(X-t\\)ï¼‰æœä»Generalized Pareto Distribution (GPD)ï¼Œå‚æ•°ä¸º\\(\\gamma\\)å’Œ\\(\\sigma\\)ã€‚POTä¸»è¦æ˜¯æ‹ŸåˆGPDè€Œä¸æ˜¯EVTåˆ†å¸ƒã€‚ å¦‚æœæˆ‘ä»¬è¦ä¼°è®¡å‚æ•°\\(\\hat{\\gamma}\\)å’Œ\\(\\hat{\\sigma}\\)ï¼Œåˆ†ä½æ•°å¯ä»¥é€šè¿‡ä¸‹å¼è®¡ç®—å¾—åˆ°ï¼š \\[ z_q\\simeq t+\\frac{\\hat{\\sigma}}{\\hat{\\gamma}}\\left(\\left(\\frac{qn}{N_t}\\right)^{-\\hat{\\gamma}}-1\\right) \\] å…¶ä¸­\\(t\\)æ˜¯ä¸€ä¸ªâ€œå¾ˆé«˜â€çš„é˜ˆå€¼ï¼Œ\\(q\\)æ˜¯ç»™å®šçš„æ¦‚ç‡å€¼ï¼Œ\\(n\\)æ˜¯æ‰€æœ‰è§‚æµ‹æ ·æœ¬çš„æ•°é‡ï¼Œ\\(N_t\\)æ˜¯peaksçš„æ•°é‡ï¼Œå³\\(X_i&gt;t\\)çš„æ•°é‡ã€‚ä¸ºäº†è¿›è¡Œé«˜æ•ˆçš„å‚æ•°ä¼°è®¡ï¼Œæ–‡ä¸­ä½¿ç”¨äº†æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚ Maximum Likelihood Estimation è®¾\\(X_1,\\cdots,X_n\\)ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°è®°ä¸º\\(f_\\theta\\)ï¼Œ\\(\\theta\\)ä¸ºåˆ†å¸ƒä¸­çš„å‚æ•°ï¼Œé‚£ä¹ˆä¼¼ç„¶å‡½æ•°å¯ä»¥å†™ä¸ºï¼š \\[ \\mathcal{L}(X_1,\\cdots,X_n;\\theta)=\\prod\\limits_{i=1}^n f_\\theta(X_i) \\] åœ¨æå¤§ä¼¼ç„¶ä¼°è®¡ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°åˆé€‚çš„å‚æ•°ä½¿å¾—ä¼¼ç„¶å‡½æ•°æœ€å¤§åŒ–ã€‚åœ¨æˆ‘ä»¬çš„é—®é¢˜ä¸­ï¼Œä¼¼ç„¶å‡½æ•°å¦‚ä¸‹ï¼š \\[ \\log\\mathcal{L}(\\gamma,\\sigma)=-N_t\\log\\sigma-\\left(1+\\frac{1}{\\gamma}\\right)\\sum\\limits_{i=1}^{N_t}\\log\\left(1+\\frac{\\gamma}{\\sigma}Y_i\\right) \\] å…¶ä¸­\\(Y_i&gt;0\\)è¡¨ç¤º\\(X_i\\)è¶…è¿‡é˜ˆå€¼\\(t\\)çš„éƒ¨åˆ†ã€‚ æ–‡ä¸­ä½¿ç”¨äº†Grimshaw's Trickæ¥å°†å«ä¸¤ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜è½¬æ¢ä¸ºåªå«ä¸€ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜ã€‚è®°\\(\\ell(\\gamma,\\sigma)=\\log\\mathcal{L}(\\gamma,\\sigma)\\)ï¼Œå¯¹äºæ‰€æœ‰æå€¼æ¥è¯´æœ‰\\(\\nabla \\ell(\\gamma, \\sigma)=0\\)ã€‚Grimshaw's Trickè¡¨æ˜å¯¹äºæ»¡è¶³\\(\\nabla \\ell(\\gamma, \\sigma)=0\\)çš„ä¸€å¯¹\\((\\gamma^*,\\sigma^*)\\)ï¼Œ\\(x^*=\\frac{\\gamma^*}{\\sigma^*}\\)ä¸ºç­‰å¼\\(u(X)v(X)=1\\)çš„è§£ï¼Œå…¶ä¸­ï¼š \\[ \\begin{align} u(x)&amp;=\\frac{1}{N_t}\\sum\\limits_{i=1}^{N_t}\\frac{1}{1+xY_i}\\\\ v(x)&amp;=1+\\frac{1}{N_t}\\sum\\limits_{i=1}^{N_t}\\log(1+xY_i) \\end{align} \\] åœ¨æ‰¾åˆ°æ»¡è¶³è¯¥ç­‰å¼çš„è§£\\(x^*\\)åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°\\(\\gamma^*=v(x^*)-1\\)å’Œ\\(\\sigma^*=\\gamma^*/x^*\\)ï¼Œäºæ˜¯é—®é¢˜å°±å˜æˆäº†å¦‚ä½•å¯»æ‰¾æ–¹ç¨‹çš„æ‰€æœ‰æ ¹ã€‚ å› ä¸º\\(\\log\\)çš„å­˜åœ¨ï¼Œæ‰€ä»¥æœ‰\\(1+xY_i&gt;0\\)ã€‚è€Œ\\(Y_i\\)æ˜¯æ­£æ•°ï¼Œæ‰€ä»¥\\(x^*\\)çš„èŒƒå›´ä¸€å®šåœ¨\\(\\left(-\\frac{1}{Y^M},+\\infty\\right)\\)ï¼Œå…¶ä¸­\\(Y^M=\\max Y_i\\)ã€‚ Grimshawï¼ˆä½œè€…å‚è€ƒçš„ä¸€ç¯‡è®ºæ–‡ï¼‰è¿˜ç»™å‡ºäº†ä¸€ä¸ªä¸Šç•Œï¼š \\[ x^*_{\\text{max}}=2\\frac{\\bar{Y}-Y^m}{(Y^m)^2} \\] å…¶ä¸­\\(Y^m=\\min Y_i\\)ï¼Œ\\(\\bar{Y}\\)ä¸º\\(Y_i\\)çš„å‡å€¼ã€‚è¯¦ç»†çš„ä¼˜åŒ–æ–¹æ³•ä¼šåœ¨ä¸‹æ–‡è®¨è®ºã€‚ èƒŒæ™¯éƒ¨åˆ†åˆ°æ­¤ç»“æŸï¼Œæ¥ä¸‹æ¥çš„éƒ¨åˆ†å°±æ˜¯ä½œè€…æå‡ºçš„æ–°æ–¹æ³•ã€‚ Methodology Extreme Value Theoryç»™å‡ºäº†åœ¨å¯¹åŸå§‹åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡ä½¿å¾—\\(\\mathbb{P}(X&gt;z_q)&lt;q\\)çš„\\(z_q\\)çš„æ–¹æ³•ã€‚ æœ¬æ–‡æ®æ­¤æå‡ºäº†æ—¶é—´åºåˆ—æµçš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚é¦–å…ˆæ ¹æ®å·²çŸ¥çš„è§‚æµ‹å€¼\\(X_1,\\cdots,X_n\\)å¾—åˆ°é˜ˆå€¼\\(z_q\\)ï¼Œç„¶åæ ¹æ®æ•°æ®çš„ç‰¹æ€§è¿ç”¨ä¸¤ç§ä¸åŒæ–¹æ³•æ¥æ›´æ–°\\(z_q\\)ã€‚å¯¹äºå¹³ç¨³æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨SPOTï¼›å¯¹äºéå¹³ç¨³æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨DSPOTã€‚ Initialization Step åœ¨è¿›è¡Œå¼‚å¸¸æ£€æµ‹ä¹‹å‰ï¼Œéœ€è¦æ ¹æ®å·²æœ‰çš„è§‚æµ‹æ•°æ®è¿›è¡Œ\\(z_q\\)çš„ä¼°è®¡ã€‚ç»™å®š\\(n\\)ä¸ªè§‚æµ‹å€¼\\(X_1,\\cdots,X_n\\)å’Œä¸€ä¸ªå›ºå®šçš„æ¦‚ç‡å€¼\\(q\\)ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡é˜ˆå€¼\\(z_q\\)ä½¿å¾—\\(\\mathbb{P}(X&gt;z_q)&lt;q\\)ã€‚å…¶ä¸»è¦æµç¨‹æ˜¯é¦–å…ˆè®¾å®šä¸€ä¸ªè¾ƒå¤§çš„é˜ˆå€¼\\(t\\)ï¼Œç„¶åé€šè¿‡æ‹ŸåˆGPDåˆ†å¸ƒæ¥è®¡ç®—\\(z_q\\)ã€‚è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š \\(Y_t\\)ä»£è¡¨å¤§äº\\(t\\)çš„è§‚æµ‹å€¼çš„é›†åˆï¼ŒGPDåˆ†å¸ƒçš„æ‹Ÿåˆä½¿ç”¨äº†å‰æ–‡æåˆ°çš„Grimshaw's Trickã€‚ Finding Anomalies in a Stream é€šè¿‡Initialization Stepä½¿ç”¨POTç®—æ³•å¾—åˆ°çš„\\(z_q\\)ï¼Œæˆ‘ä»¬å®šä¹‰å…¶ä¸º\"Normality Bound\"ï¼Œç”¨äºåé¢çš„æ£€æµ‹ã€‚åœ¨åé¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®æ–°å¾—åˆ°çš„è§‚æµ‹å€¼æ¥æ›´æ–°\\(z_q\\)ã€‚ Stationary Case æˆ‘ä»¬é¦–å…ˆæ¥è®¨è®ºæ—¶é—´åºåˆ—æ²¡æœ‰æ—¶é—´ä¾èµ–æ€§çš„æƒ…å†µï¼ˆ\\(X_1,\\cdots,X_n\\)ä¹‹é—´ç‹¬ç«‹åŒåˆ†å¸ƒï¼‰ã€‚é€šè¿‡POTç®—æ³•å¯¹æ‰€æœ‰è§‚æµ‹å€¼å¾—åˆ°\\(z_q\\)ä¹‹åï¼ŒStreaming POT (SPOT) ç®—æ³•ä¼šæ£€æŸ¥\\(X_n\\)ä¹‹åçš„å€¼ï¼ˆæ•°æ®æµåœºæ™¯ï¼Œ\\(X_1,\\cdots,X_n\\)æ˜¯å†å²æ•°æ®ï¼Œè¿˜ä¼šæœ‰æ–°çš„æ•°æ®è¿›æ¥ï¼‰ï¼Œå¦‚æœå¤§äº\\(z_q\\)ï¼Œåˆ™å°†\\(X_i\\)åŠ å…¥å¼‚å¸¸ç‚¹é›†åˆä¸­ï¼›å¦‚æœå¤§äº\\(t\\)ä½†å°äº\\(z_q\\)ï¼Œåˆ™å°†\\(X_i\\)åŠ å…¥è§‚æµ‹å€¼é›†åˆä¸­ï¼Œæ›´æ–°\\(z_q\\)ï¼›å…¶ä»–æƒ…å†µæˆ‘ä»¬\\(X_i\\)æ˜¯æ­£å¸¸æƒ…å†µã€‚ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š Drifting Case SPOTç®—æ³•åªé€‚ç”¨äºå¹³ç¨³åˆ†å¸ƒçš„æƒ…å†µï¼Œä½†åœ¨ç°å®ç”Ÿæ´»ä¸­è¿™æ ·çš„å‡è®¾è¿‡å¼ºäº†ã€‚äºæ˜¯ä½œè€…æå‡ºäº†èƒ½å¤„ç†æ—¶é—´ä¾èµ–æ€§çš„Streaming POT with Drift (DSPOT) ç®—æ³•ã€‚ åœ¨DSPOTä¸­ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨\\(X_i\\)çš„ç»å¯¹å€¼ï¼Œè€Œæ˜¯ç”¨ç›¸å¯¹å€¼\\(X^\\prime_i=X_i-M_i\\)ï¼Œå…¶ä¸­\\(M_i\\)æ˜¯\\(i\\)æ—¶åˆ»çš„å±€éƒ¨ç‰¹å¾ï¼Œå¦‚Figure 4æ‰€ç¤ºã€‚æœ€ç®€å•çš„å®ç°æ˜¯ä½¿ç”¨å±€éƒ¨å‡å€¼ï¼Œå³\\(M_i=(1/d)\\cdot\\sum\\limits_{k=1}^d X_{i-k}^*\\)ï¼Œ\\(X_{i-1}^*,\\cdots,X_{i-d}^*\\)æ˜¯é•¿åº¦ä¸º\\(d\\)çš„çª—å£ã€‚æˆ‘ä»¬å‡è®¾\\(X^\\prime_i\\)æœä»å¹³ç¨³åˆ†å¸ƒçš„å‡è®¾ã€‚ ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š Numerical Optimization ç°åœ¨å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯ä¼˜åŒ–äº†ï¼Œå‰æ–‡å·²ç»æåˆ°å¯¹GPDçš„æ‹Ÿåˆå·²ç»è¢«ä¼˜åŒ–æˆä¸€ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜ï¼Œä¸‹é¢å°†ä¼šè¯¦ç»†è®¨è®ºä¼˜åŒ–ç®—æ³•ã€‚ Reduction of the Optimal Parameters Search å‰æ–‡å·²ç»å¾—åˆ°äº†ä¸€ä¸ªåˆæ­¥çš„\\(x^*\\)çš„Boundï¼Œå³\\(x^*&gt;-\\frac{1}{Y^M}\\)å’Œ\\(x^*\\leq 2\\frac{\\bar{Y}-Y^m}{(Y^m)^2}\\)ï¼Œä¸‹é¢å°†ç»™å‡ºä¸€ä¸ªæ›´ä¸¥æ ¼çš„Boundã€‚ PROPOSITION: å¦‚æœ\\(x^*\\)æ˜¯\\(u(x)v(x)=1\\)çš„è§£ï¼Œé‚£ä¹ˆï¼š \\[ x^*\\leq 0 \\text{ or } x^*\\geq 2\\frac{\\bar{Y}-Y^m}{\\bar{Y}Y^m} \\] è¯æ˜è§è®ºæ–‡åŸæ–‡ã€‚ è¿™æ ·\\(x^*\\)çš„èŒƒå›´å°±è¿›ä¸€æ­¥ç¼©å°äº†ï¼Œäºæ˜¯æœ‰\\(u(x)v(X)=1\\)çš„è§£\\(x^*\\)åœ¨ä»¥ä¸‹èŒƒå›´ä¹‹å†…ï¼š \\[ \\left(-\\frac{1}{Y^M},0\\right]\\text{ and }\\left[2\\frac{\\bar{Y}-Y^m}{\\bar{Y}Y^m},2\\frac{\\bar{Y}-Y^m}{(Y^m)^2}\\right] \\] How Can We Maximize the Likelihood Function? æ¥ä¸‹æ¥æ˜¯ä¼˜åŒ–çš„å…·ä½“å®ç°é—®é¢˜ã€‚æ–‡ä¸­é¦–å…ˆè®¾å®šäº†ä¸€ä¸ªå¾ˆå°çš„å€¼\\(\\epsilon&gt;0\\space(\\sim 10^{-8})\\)ï¼Œç„¶ååœ¨ä¸‹é¢çš„èŒƒå›´å†…å¯»æ‰¾å‡½æ•°\\(w:x\\mapsto u(x)v(x)-1\\)çš„æ ¹ï¼š \\[ \\left[-\\frac{1}{Y^M}+\\epsilon,-\\epsilon\\right]\\text{ and }\\left[2\\frac{\\bar{Y}-Y^m}{\\bar{Y}Y^m},2\\frac{\\bar{Y}-Y^m}{(Y^m)^2}\\right] \\] ä½œè€…æ²¡æœ‰ä½¿ç”¨ç°æœ‰çš„å¯»æ‰¾å‡½æ•°æ ¹çš„ç®—æ³•ï¼Œè€Œæ˜¯è½¬æ¢ä¸ºå¦‚ä¸‹ä¼˜åŒ–é—®é¢˜ï¼š \\[ \\min\\limits_{x_1,\\cdots,x_k\\in I}\\sum\\limits_{i=1}^k w(x_k)^2 \\] å…¶ä¸­\\(I\\)å°±æ˜¯\\(x^*\\)çš„Boundã€‚è¯¥é—®é¢˜æ˜¯ä¸€ä¸ªå¾ˆå…¸å‹çš„ä¼˜åŒ–é—®é¢˜ï¼Œå¯ä»¥è¢«å¾ˆå¤šæˆç†Ÿçš„ç®—æ³•æ‰€è§£å†³ã€‚ Initial Threshold åœ¨ç®—æ³•çš„Initialization Stepï¼Œéœ€è¦äº‹å…ˆè®¾å®šä¸€ä¸ªé˜ˆå€¼\\(t\\)ï¼Œå¦‚æœè®¾å®šçš„å¤ªå¤§ï¼Œé‚£ä¹ˆ\\(Y_t\\)çš„æ•°é‡å°±ä¼šå¾ˆå°‘ã€‚ä½œè€…ç»™å‡ºçš„å»ºè®®æ˜¯ä¿è¯\\(t&lt;z_q\\)ï¼Œå³\\(t\\)å¯¹åº”çš„æ¦‚ç‡å€¼åº”è¯¥å°äº\\(1-q\\)ã€‚ Experiments åœ¨å®éªŒéƒ¨åˆ†ï¼Œä½œè€…åœ¨åˆæˆæ•°æ®å’ŒçœŸå®æ•°æ®ä¸Šè¯•éªŒäº†SPOTç®—æ³•å’ŒDSPOTç®—æ³•çš„æœ‰æ•ˆæ€§ã€‚ (D)SPOT Reliability ä½œè€…é¦–å…ˆåœ¨åˆæˆæ•°æ®ä¸ŠéªŒè¯SPOTçš„æœ‰æ•ˆæ€§ã€‚å…·ä½“åšæ³•æ˜¯ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒç”Ÿæˆæ•°æ®ï¼ˆé«˜æ–¯åˆ†å¸ƒçš„åˆ†ä½æ•°èƒ½å¤Ÿç›´æ¥è®¡ç®—ï¼‰ï¼Œç„¶åå°†SPOTå¾—å‡ºçš„\\(z_q\\)å’Œç†è®ºå€¼è¿›è¡Œå¯¹æ¯”ã€‚è¯¯å·®å®šä¹‰å¦‚ä¸‹ï¼š \\[ \\text{error rate}=\\left|\\frac{z^{\\text{SPOT}}-z^{\\text{th}}}{z^{\\text{th}}}\\right| \\] ä¸‹å›¾æ˜¯é‡‡ç”¨ä¸åŒæ•°é‡è§‚æµ‹å€¼çš„ç»“æœï¼š Finding Anomalies with SPOT åœ¨è¿™ä¸€èŠ‚ä½œè€…åœ¨çœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒä»¥éªŒè¯SPOTç®—æ³•çš„æœ‰æ•ˆæ€§ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š åœ¨æ–‡ä¸­ä½œè€…è¯´ç®—æ³•çš„True Positiveè¾¾åˆ°äº†\\(86\\%\\)ï¼ŒFalse Positiveå°äº\\(4\\%\\)ã€‚ Finding Anomalies with DSPOT åœ¨è¿™ä¸€èŠ‚ä½œè€…ä½¿ç”¨DSPOTåœ¨çœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒã€‚çª—å£å¤§å°\\(d=450\\)ï¼Œé¢„è®¾çš„é£é™©æ¦‚ç‡å€¼\\(q=10^{-3}\\)ã€‚ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åœ¨å›¾ä¸­å¯ä»¥çœ‹å‡ºåœ¨\\(8000\\) Minutesä¹‹åä¸Šç•Œæ˜¾è‘—æé«˜ï¼Œä½œè€…åˆ†æäº†åŸå› ï¼Œè®¤ä¸ºæ˜¯å› ä¸ºè¶…è¿‡é˜ˆå€¼\\(t\\)çš„ç‚¹\\(Y_t\\)çš„å­˜å‚¨æ˜¯å…¨å±€çš„ï¼Œåœ¨å‰\\(8000\\) Minutesç®—æ³•å­˜å‚¨äº†å¾ˆå¤šè¾ƒé«˜çš„\\(Y_t\\)å€¼ï¼Œè€Œåœ¨\\(8000\\) Minutesä¹‹åï¼ŒçœŸå®æ•°æ®çš„è¶‹åŠ¿å¼€å§‹ä¸‹é™ï¼Œä½†ç®—æ³•ä»æ˜¯æ ¹æ®å…¨å±€çš„\\(Y_t\\)æ¥è¿›è¡Œ\\(z_q\\)çš„è®¡ç®—ï¼ˆè¿™ä¸€æ®µæ²¡æœ‰ç‰¹åˆ«æ˜ç™½ï¼‰ã€‚ä½œè€…ç»™å‡ºçš„ä¿®æ­£æ–¹æ³•æ˜¯åªä¿å­˜å›ºå®šæ•°é‡çš„Peaksã€‚ ä¸‹å›¾æ˜¯ä½œè€…åœ¨è‚¡ç¥¨æ•°æ®ä¸Šå¾—åˆ°çš„å®éªŒç»“æœï¼š Performances ä½œè€…è¿˜éªŒè¯äº†ç®—æ³•çš„æ—¶é—´æ•ˆç‡ã€‚ è¡¨ä¸­Tä»£è¡¨çš„æ˜¯æ¯ä¸ªIterationçš„æ—¶é—´ï¼ŒMä»£è¡¨çš„æ˜¯Peaksçš„æ¯”ä¾‹ï¼Œ\"bi-\"å‰ç¼€ä»£è¡¨çš„æ˜¯åŒæ—¶è®¡ç®—ä¸Šç•Œå’Œä¸‹ç•Œã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://qfxiao.me/tags/Machine-Learning/"},{"name":"Statistics","slug":"Statistics","permalink":"http://qfxiao.me/tags/Statistics/"}]},{"title":"An Introduction to Variational Autoencoders","slug":"An-Introduction-to-Variational-Autoencoders","date":"2019-10-22T07:14:26.000Z","updated":"2020-06-24T08:16:51.584Z","comments":true,"path":"2019/10/22/An-Introduction-to-Variational-Autoencoders/","link":"","permalink":"http://qfxiao.me/2019/10/22/An-Introduction-to-Variational-Autoencoders/","excerpt":"","text":"Deep Generative Models ç”Ÿæˆæ¨¡å‹æ˜¯æŒ‡ä¸€ç³»åˆ—ç”¨äºéšæœºç”Ÿæˆå¯è§‚æµ‹æ•°æ®çš„æ¨¡å‹ã€‚å‡è®¾åœ¨ä¸€ä¸ªé«˜ç»´ç©ºé—´\\(\\mathcal{X}\\)ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªéšæœºå‘é‡\\(\\mathbf{X}\\)æœä»ä¸€ä¸ªæœªçŸ¥çš„åˆ†å¸ƒ\\(p_r(x),x\\in \\mathcal{X}\\)ã€‚ç”Ÿæˆæ¨¡å‹å°±æ˜¯æ ¹æ®ä¸€äº›å¯è§‚æµ‹çš„æ ·æœ¬\\(x^{(1)},x^{(2)},\\cdots,x^{(N)}\\)æ¥å­¦ä¹ ä¸€ä¸ªå‚æ•°åŒ–çš„æ¨¡å‹\\(p_\\theta(x)\\)æ¥è¿‘ä¼¼æœªçŸ¥åˆ†å¸ƒ\\(p_r(x)\\)ã€‚ ç”Ÿæˆæ¨¡å‹ä¸»è¦ç”¨äºå¯†åº¦ä¼°è®¡å’Œæ ·æœ¬ç”Ÿæˆã€‚ å¯†åº¦ä¼°è®¡å³ç»™å®šä¸€ç»„æ•°æ®\\(\\mathcal{D}=\\{x^{(i)}\\},1\\leq i\\leq N\\)ï¼Œå‡è®¾ä»–ä»¬éƒ½æ˜¯ä»ç›¸åŒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°\\(p_r(x)\\)ç‹¬ç«‹äº§ç”Ÿçš„ã€‚å¯†åº¦ä¼°è®¡å°±æ˜¯æ ¹æ®æ•°æ®é›†\\(\\mathcal{D}\\)æ¥ä¼°è®¡å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°\\(p_r(x)\\)ã€‚ å¦‚æœå°†ç”Ÿæˆæ¨¡å‹ç”¨äºç›‘ç£å­¦ä¹ ï¼Œé‚£ä¹ˆå°±æ˜¯è¾“å‡ºæ ‡ç­¾çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ\\(p(y|x)\\)ï¼Œæ ¹æ®è´å¶æ–¯å…¬å¼ï¼š \\[p(y|x)=\\frac{p(x,y)}{\\sum_y p(x,y)}\\] é—®é¢˜å°±å˜ä¸ºäº†è”åˆæ¦‚ç‡\\(p(x,y)\\)çš„å¯†åº¦ä¼°è®¡é—®é¢˜ã€‚ æ ·æœ¬ç”Ÿæˆå³æ ¹æ®ç»™å®šçš„æ¦‚ç‡åˆ†å¸ƒ\\(p_\\theta(x)\\)ç”Ÿæˆä¸€äº›æœä»è¿™ä¸ªåˆ†å¸ƒçš„æ ·æœ¬ï¼Œå³é‡‡æ ·ã€‚åœ¨å«éšå˜é‡çš„ç”Ÿæˆæ¨¡å‹ä¸­ï¼Œç”Ÿæˆ\\(x\\)çš„è¿‡ç¨‹ä¸€èˆ¬åŒ…å«ä¸¤æ­¥ï¼š æ ¹æ®éšå˜é‡çš„åˆ†å¸ƒ\\(p_\\theta(z)\\)é‡‡æ ·å¾—åˆ°\\(z\\)ï¼› æ ¹æ®æ¡ä»¶åˆ†å¸ƒ\\(p_\\theta(x|z;\\theta)\\)è¿›è¡Œé‡‡æ ·å¾—åˆ°\\(x\\)ã€‚ æ‰€ä»¥åœ¨ç”Ÿæˆæ¨¡å‹ä¸­çš„é‡ç‚¹æ˜¯ä¼°è®¡æ¡ä»¶åˆ†å¸ƒ\\(p(x|z;\\theta)\\)ã€‚ Parameter Estimation for Hidden Variable with EM Algorithm å¦‚æœå›¾æ¨¡å‹ä¸­å­˜åœ¨éšå˜é‡ï¼Œå°±éœ€è¦ä½¿ç”¨EMç®—æ³•è¿›è¡Œå‚æ•°ä¼°è®¡ã€‚ åœ¨ä¸€ä¸ªåŒ…å«éšå˜é‡çš„å›¾æ¨¡å‹ä¸­ï¼Œä»¤\\(\\mathbf{X}\\)ä¸ºå¯è§‚æµ‹å˜é‡é›†åˆï¼Œ\\(\\mathbf{Z}\\)ä¸ºéšå˜é‡é›†åˆï¼Œåˆ™ä¸€ä¸ªæ ·æœ¬\\(x\\)çš„è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š \\[p(x;\\theta)=\\sum_z p(x,z;\\theta)\\] ç»™å®šåŒ…å«\\(N\\)ä¸ªè®­ç»ƒæ ·æœ¬çš„è®­ç»ƒé›†\\(\\mathcal{D}=\\{x^{(n)}\\},1\\leq i\\leq N\\)ï¼Œåˆ™è®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¸ºï¼š \\[\\begin{align}\\mathcal{L}(\\mathcal{D};\\theta)&amp;=\\frac{1}{N}\\sum_{n=1}^N \\log p(x^{(n)};\\theta)\\\\&amp;=\\frac{1}{N}\\sum_{n=1}^N \\log \\sum_z p(x^{(n)},z;\\theta)\\end{align}\\] è¿™æ—¶ï¼Œåªè¦æœ€å¤§åŒ–æ•´ä¸ªè®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶\\(\\mathcal{L}(\\mathcal{D};\\theta)\\)ï¼Œå³å¯ä¼°è®¡å‡ºæœ€ä¼˜çš„å‚æ•°\\(\\theta^*\\)ã€‚ä¸è¿‡åœ¨è®¡ç®—æ¢¯åº¦çš„æ—¶å€™ï¼Œéœ€è¦åœ¨å¯¹æ•°å‡½æ•°å†…éƒ¨è¿›è¡Œæ±‚å’Œæˆ–ç§¯åˆ†è®¡ç®—ã€‚ä¸ºäº†æ›´å¥½çš„è®¡ç®—\\(\\log p(x;\\theta)\\)ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªé¢å¤–çš„å˜åˆ†å‡½æ•°\\(q(z)\\)ï¼Œ\\(q(z)\\)ä¸ºå®šä¹‰åœ¨éšå˜é‡\\(z\\)ä¸Šçš„åˆ†å¸ƒã€‚æ ·æœ¬\\(x\\)çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š \\[\\begin{align}\\log p(x;\\theta)&amp;=\\log \\sum_z q(z)\\frac{p(x,z;\\theta)}{q(z)}\\\\&amp;\\geq\\sum_z q(z)\\log \\frac{p(x,z;\\theta)}{q(z)}\\\\&amp;\\triangleq ELBO(q,x;\\theta)\\end{align}\\] å…¶ä¸­\\(ELBO(q,x;\\theta)\\)ä¸ºå¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°\\(\\log p(x;\\theta)\\)çš„ä¸‹ç•Œï¼Œç§°ä¸ºè¯æ®ä¸‹ç•Œã€‚å…¬å¼ä¸­ä½¿ç”¨äº†Jensenä¸ç­‰å¼(å³å¯¹äºå‡¹å‡½æ•°\\(g\\)ï¼Œæœ‰\\(g(\\mathbb{E}[x])\\geq\\mathbb{E}[g(X)]\\))ã€‚åœ¨è¿™é‡Œï¼Œ\\(\\frac{p(x,z;\\theta)}{q(z)}\\)å¯è§†ä¸º\\(q(z)\\)çš„å‡½æ•°ï¼Œè®°ä¸º\\(f(q(z))\\)ï¼Œé‚£ä¹ˆ\\(f(q(z))\\)çš„æœŸæœ›å³\\(\\mathbb{E}[f(q(z))]=\\sum_z q(z)f(q(z))=\\sum_z q(z)\\frac{p(x,z;\\theta)}{q(z)}\\)ã€‚è€Œæ ¹æ®Jensenä¸ç­‰å¼ï¼Œæœ‰\\(g(\\mathbb{E}[f(q(z))])\\geq\\mathbb{E}[g(f(q(z)))]\\Leftrightarrow g(\\sum_z q(z)\\frac{p(x,z;\\theta)}{q(z)})\\geq \\sum_z q(z)g(\\frac{p(x,z;\\theta)}{q(z)})\\)ï¼Œåœ¨è¿™é‡Œ\\(g\\)å°±æ˜¯å¯¹æ•°å‡½æ•°ã€‚ æ ¹æ®Jensenä¸ç­‰å¼å–ç­‰çš„æ¡ä»¶ï¼š\\(\\frac{p(x,z;\\theta)}{q(z)}=c\\)ï¼Œ\\(c\\)ä¸ºå¸¸æ•°ï¼Œæœ‰ï¼š \\[\\begin{align}\\sum_z p(x,z;\\theta)&amp;=c\\sum_z q(z)\\\\\\Leftrightarrow\\sum_z p(x,z;\\theta)&amp;=c\\cdot1\\end{align}\\] å› æ­¤ï¼š \\[\\begin{align}q(z)&amp;=\\frac{p(x,z;\\theta)}{\\sum_z p(x,z;\\theta)}\\\\&amp;=\\frac{p(x,z;\\theta)}{p(x;\\theta)}\\\\&amp;=p(z|x;\\theta)\\end{align}\\] æ‰€ä»¥ï¼Œå½“ä¸”ä»…å½“\\(q(z)=p(z|x;\\theta)\\)æ—¶ï¼Œ\\(\\log p(x;\\theta)=ELBO(q,x;\\theta)\\)ã€‚ äºæ˜¯æœ€å¤§åŒ–å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°\\(\\log p(x;\\theta)\\)çš„è¿‡ç¨‹å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š å…ˆæ‰¾åˆ°è¿‘ä¼¼åˆ†å¸ƒ\\(q(z)\\)ä½¿å¾—\\(\\log p(x;\\theta)=ELBO(q,x;\\theta)\\)ï¼› å†å¯»æ‰¾å‚æ•°\\(\\theta\\)æœ€å¤§åŒ–\\(ELBO(q,x;\\theta)\\)ã€‚ è¿™å°±æ˜¯æœŸæœ›æœ€å¤§åŒ–(Expectation-Maximum,EM)ç®—æ³•ã€‚ EMç®—æ³•é€šè¿‡è¿­ä»£çš„æ–¹æ³•ï¼Œä¸æ–­é‡å¤ç›´åˆ°æ”¶æ•›åˆ°æŸä¸ªå±€éƒ¨æœ€ä¼˜è§£ã€‚åœ¨ç¬¬\\(t\\)æ­¥æ›´æ–°æ—¶ï¼ŒEæ­¥å’ŒMæ­¥åˆ†åˆ«ä¸ºï¼š Eæ­¥ï¼šå›ºå®šå‚æ•°\\(\\theta_t\\)ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆ†å¸ƒä½¿\\(ELBO(q,x;\\theta_t)\\)æœ€å¤§ï¼Œå³ç­‰äº\\(\\log p(x;\\theta_t)\\)ï¼š\\(q_{t+1}(z)=\\text{arg}_q \\max ELBO(q,x;\\theta_t)\\)ï¼› Mæ­¥ï¼šå›ºå®š\\(q_{t+1}(z)\\)ï¼Œæ‰¾åˆ°ä¸€ç»„å‚æ•°ä½¿å¾—è¯æ®ä¸‹ç•Œæœ€å¤§ï¼Œå³ï¼š\\(\\theta_{t+1}=\\text{arg}_\\theta\\max ELBO(q_{t+1},x;\\theta)\\)ã€‚ å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ä¿¡æ¯è®ºçš„è§†è§’æ¥è¿›è¡Œåˆ†è§£ï¼š \\[\\begin{align}\\log p(x;\\theta)&amp;=\\sum_z q(z)\\log p(x;\\theta)\\\\&amp;=\\sum_z q(z)(\\log p(x,z;\\theta)-\\log p(z|x;\\theta))\\\\&amp;=\\sum_z q(z)\\log\\frac{p(x,z;\\theta)}{q(z)}-\\sum_z q(z)\\log\\frac{p(z|x;\\theta)}{q(z)}\\\\&amp;=ELBO(q,x;\\theta)+D_{KL}(q(z)\\parallel p(z|x;\\theta))\\end{align}\\] å…¶ä¸­\\(D_{KL}(q(z)\\parallel p(z|x;\\theta))\\) Generative Model with Hidden Variable å‡è®¾ä¸€ä¸ªç”Ÿæˆæ¨¡å‹åŒ…å«ä¸å¯è§‚æµ‹çš„éšå˜é‡ï¼Œå…¶ä¸­å¯è§‚æµ‹å˜é‡\\(x\\)ä¸ºä¸€ä¸ªé«˜ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ï¼Œè€Œä¸å¯è§‚æµ‹çš„éšå˜é‡\\(z\\)ä¸ºä¸€ä¸ªç›¸å¯¹ä½ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ã€‚ è¿™ä¸ªç”Ÿæˆæ¨¡å‹çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å¯ä»¥è¡¨è¾¾ä¸ºï¼š \\[p(x,z;\\theta)=p(x|z;\\theta)p(z;\\theta)\\] å…¶ä¸­\\(p(z;\\theta)\\)ä¸ºéšå˜é‡\\(z\\)çš„å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒï¼›\\(p(x|z;\\theta)\\)ä¸ºå·²çŸ¥\\(z\\)æ¡ä»¶ä¸‹\\(x\\)çš„æ¦‚ç‡åˆ†å¸ƒã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾\\(p(z;\\theta)\\)å’Œ\\(p(x|z;\\theta)\\)æœä»æŸç§å¸¦å‚çš„åˆ†å¸ƒæ—ï¼Œå…¶å½¢å¼å·²çŸ¥ï¼Œè€Œå‚æ•°å¯ä»¥é€šè¿‡æœ€å¤§ä¼¼ç„¶æ¥è¿›è¡Œä¼°è®¡ã€‚ ç»™å®šä¸€ä¸ªæ ·æœ¬\\(x\\)ï¼Œå…¶å¯¹æ•°è¾¹é™…ä¼¼ç„¶\\(\\log p(x;\\theta)\\)å¯ä»¥åˆ†è§£ä¸ºï¼š \\[\\log p(x;\\theta)=ELBO(q,x;\\theta,\\phi)+D_{KL}(q(z;\\phi)\\parallel p(z|x;\\theta))\\] å…¶ä¸­\\(q(z;\\phi)\\)ä¸ºé¢å¤–å¼•å…¥çš„å˜åˆ†å¯†åº¦å‡½æ•°ï¼Œ\\(ELBO(q,x;\\theta,\\phi)\\)ä¸ºè¯æ®ä¸‹ç•Œï¼š \\[ELBO(q,x;\\theta,\\phi)=\\mathbb{E}_{z\\sim q(z;\\phi)}[\\log{\\frac{p(x,z;\\theta)}{q(z;\\phi)}}]\\] æœ€å¤§åŒ–\\(\\log p(x;\\theta)\\)å¯ä»¥ç”¨EMç®—æ³•æ¥æ±‚è§£ï¼š E-step: å¯»æ‰¾ä¸€ä¸ªå¯†åº¦å‡½æ•°\\(q(z;\\phi)\\)ä½¿å…¶ç­‰äºæˆ–æ¥è¿‘äºåéªŒå¯†åº¦å‡½æ•°\\(p(z|x;\\theta)\\); M-step: ä¿æŒ\\(q(z;\\phi)\\)å›ºå®šï¼Œå¯»æ‰¾\\(\\theta\\)æ¥æœ€å¤§åŒ–\\(ELBO(q,x;\\theta,\\phi)\\)ã€‚ åœ¨EMç®—æ³•çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œç†è®ºä¸Šæœ€ä¼˜çš„\\(q(z;\\phi)\\)ä¸ºéšå˜é‡çš„åéªŒæ¦‚ç‡å¯†åº¦å‡½æ•°\\(p(z|x;\\theta)\\)ï¼š \\[p(z|x;\\theta)=\\frac{p(x|z;\\theta)p(z;\\theta)}{\\int_z p(x|z;\\theta)p(z;\\theta)\\text{d}z}\\] åéªŒå¯†åº¦å‡½æ•°\\(p(z|x;\\theta)\\)çš„è®¡ç®—æ˜¯ä¸€ä¸ªç»Ÿè®¡æ¨æ–­çš„é—®é¢˜ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹\\(p(x|z;\\theta)\\)ä¹Ÿæ¯”è¾ƒéš¾ä»¥è®¡ç®—ã€‚ Variational Autoencoder å˜åˆ†è‡ªç¼–ç å™¨(Variational Autoencoder, VAE)çš„ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥åˆ†åˆ«å»ºæ¨¡ä¸¤ä¸ªå¤æ‚çš„æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿå˜åˆ†åˆ†å¸ƒ\\(q(z;\\phi)\\)ï¼Œç§°ä¸ºæ¨æ–­ç½‘ç»œã€‚æ¨æ–­ç½‘ç»œçš„è¾“å…¥ä¸º\\(x\\)ï¼Œè¾“å‡ºä¸ºå˜åˆ†åˆ†å¸ƒ\\(q(z|x;\\phi)\\)ï¼› ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿæ¦‚ç‡åˆ†å¸ƒ\\(p(x|z;\\theta)\\)ï¼Œç§°ä¸ºç”Ÿæˆç½‘ç»œã€‚ç”Ÿæˆç½‘ç»œçš„è¾“å…¥ä¸º\\(z\\)ï¼Œè¾“å‡ºä¸ºæ¦‚ç‡åˆ†å¸ƒ\\(p(x|z;\\theta)\\)ã€‚ VAEçš„å›¾æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Variational Network å‡è®¾\\(q(z|x;\\phi)\\)æ˜¯æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼š \\[q(z|x;\\phi)=\\mathcal{N}(z;\\mu_I,\\sigma^2_I I)\\] å…¶ä¸­\\(\\mu_I\\)å’Œ\\(\\sigma_I^2\\)æ˜¯é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ï¼Œå¯ä»¥é€šè¿‡æ¨æ–­ç½‘ç»œ\\(f_I(x;\\phi)\\)æ¥é¢„æµ‹ï¼š \\[ \\left[\\begin{matrix}\\mu_I\\\\\\sigma_I\\end{matrix}\\right]=f_I(x;\\phi) \\] æ¨æ–­ç½‘ç»œ\\(f_I(x;\\phi)\\)å¯ä»¥æ˜¯ä¸€èˆ¬çš„å…¨è¿æ¥ç½‘ç»œæˆ–å·ç§¯ç½‘ç»œï¼Œæ¯”å¦‚ä¸€ä¸ªä¸¤å±‚çš„ç¥ç»ç½‘ç»œï¼š \\[\\begin{align}h&amp;=\\sigma(W^{(1)}x+b^{(1)})\\\\\\mu_I&amp;=W^{(2)}h+b^{(2)}\\\\\\sigma_I&amp;=\\text{softplus}(W^{(3)}h+b^{(3)})\\end{align}\\] å…¶ä¸­æ‰€æœ‰ç½‘ç»œå‚æ•°\\(\\{W^{(1)},W^{(2)},W^{(3)},b^{(1)},b^{(2)},b^{(3)}\\}\\)å³å¯¹åº”äº†å˜åˆ†å‚æ•°\\(\\phi\\)ã€‚ æ¨æ–­ç½‘ç»œçš„ç›®æ ‡æ˜¯ä½¿å¾—\\(q(z|x;\\phi)\\)æ¥å°½å¯èƒ½æ¥è¿‘çœŸå®çš„åéªŒ\\(p(z|x;\\theta)\\)ï¼Œéœ€è¦æ‰¾åˆ°å˜åˆ†å‚æ•°\\(\\phi^*\\)æ¥æœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„KLæ•£åº¦ï¼š \\[\\phi^*=\\text{arg}_\\phi\\min{D_{KL}(q(z|x;\\phi)\\parallel p(z|x;\\theta))}\\] ç”±äº\\(p(z|x;\\theta)\\)æœªçŸ¥ï¼Œæ•…KLæ•£åº¦æ— æ³•ç›´æ¥è®¡ç®—ï¼Œä¸è¿‡ç”±äº\\(D_{KL}(q(z|x;\\phi)\\parallel p(z|x;\\theta))=\\log p(x;\\theta)-ELBO(q,x;\\theta,\\phi)\\)ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œï¼Œæœ‰ï¼š \\[\\phi^*=\\text{arg}_\\phi\\max{ELBO(q,x;\\theta,\\phi)}\\] Generative Network ç”Ÿæˆæ¨¡å‹çš„è”åˆåˆ†å¸ƒå¯ä»¥åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†ï¼šéšå˜é‡\\(z\\)çš„å…ˆéªŒåˆ†å¸ƒ\\(p(z;\\theta)\\)å’Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ\\(p(x|z;\\theta)\\)ã€‚ä¸ºç®€å•èµ·è§ï¼Œä¸€èˆ¬å‡è®¾éšå˜é‡\\(z\\)çš„å…ˆéªŒåˆ†å¸ƒä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ\\(\\mathcal{N}(z|0,I)\\)ï¼Œéšå˜é‡æ¯ä¸€ç»´ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ\\(p(x|z;\\theta)\\)å¯ä»¥é€šè¿‡ç”Ÿæˆç½‘ç»œæ¥å»ºæ¨¡ï¼Œæˆ‘ä»¬åŒæ ·ç”¨å‚æ•°åŒ–çš„åˆ†å¸ƒæ—æ¥è¡¨ç¤ºæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ\\(p(x|z;\\theta)\\)ï¼Œè¿™äº›åˆ†å¸ƒæ—çš„å‡½æ•°å¯ä»¥ç”¨ç”Ÿæˆç½‘ç»œè®¡ç®—å¾—åˆ°ã€‚æ ¹æ®å˜é‡\\(x\\)çš„ç±»å‹ä¸åŒï¼Œå¯ä»¥å‡è®¾\\(p(x|z;\\theta)\\)æœä»ä¸åŒçš„åˆ†å¸ƒæ—ã€‚å¦‚æœ\\(x\\in\\{0,1\\}^d\\)æ˜¯\\(d\\)ç»´çš„äºŒå€¼å‘é‡ï¼Œå¯ä»¥å‡è®¾\\(\\log p(x|z;\\theta)\\)æœä»å¤šå˜é‡çš„ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œå³ï¼š \\[\\begin{align}p(x|z;\\theta)&amp;=\\prod\\limits_{i=1}^d p(x_i|z;\\theta)\\\\&amp;=\\prod\\limits_{i=1}^d \\gamma_i^{x_i}(1-\\gamma_i)^{(1-x_i)}\\end{align}\\] å¦‚æœ\\(x\\in\\mathbb{R}^d\\)æ˜¯\\(d\\)ç»´çš„è¿ç»­å‘é‡ï¼Œå¯ä»¥å‡è®¾\\(p(x|z;\\theta)\\)æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼Œå³ï¼š \\[p(x|z;\\theta)=\\mathcal{N}(x;\\mu_G,\\sigma_G^2 I)\\] ç”Ÿæˆç½‘ç»œçš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ç»„\\(\\theta^*\\)æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œ\\(ELBO(q,x;\\theta,\\phi)\\)ï¼š \\[\\theta^*=\\text{arg}_\\theta\\max ELBO(q,x;\\theta,\\phi)\\] Model Combination æ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œçš„ç›®æ ‡éƒ½æ˜¯æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œå› æ­¤æ€»çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š \\[\\begin{align}\\max_{\\theta,\\phi}ELBO(q,x;\\theta,\\phi)&amp;=\\max_{\\theta,\\phi}\\mathbb{E}_{z\\sim q(z;\\phi)}[\\log\\frac{p(x|z;\\theta)p(z;\\theta)}{q(z;\\theta)}]\\\\&amp;=\\max_{\\theta,\\phi}\\mathbb{E}_{z\\sim q(z|x;\\phi)}[\\log p(x|z;\\theta)]-D_{KL}(q(z|x;\\phi)\\parallel p(z;\\theta))\\end{align}\\] å…¶ä¸­å…ˆéªŒåˆ†å¸ƒ\\(p(z;\\theta)=\\mathcal{N}(z|0,I)\\)ã€‚ å…¬å¼ä¸­\\(\\mathbb{E}_{z\\sim q(z|x;\\phi)}[\\log p(x|z;\\theta)]\\)ä¸€èˆ¬é€šè¿‡é‡‡æ ·çš„æ–¹å¼è¿›è¡Œè®¡ç®—ï¼Œæœ€åå–å¹³å‡å€¼ã€‚ Model Training ç»™å®šæ•°æ®é›†\\(\\mathcal{D}\\)ï¼ŒåŒ…å«\\(N\\)ä¸ªä»æœªçŸ¥æ•°æ®åˆ†å¸ƒä¸­æŠ½å–çš„ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬\\(x^{(1)},x^{(2)},\\cdots,x^{(N)}\\)ã€‚å˜åˆ†è‡ªç¼–ç å™¨çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š \\[\\mathcal{J}(\\phi,\\theta|\\mathcal{D})=\\sum\\limits_{n=1}^N(\\frac{1}{M}\\sum\\limits_{m=1}^M\\log p(x^{(n)}|z^{(n,m)};\\theta)-D_{KL}(q(z|x^{(n)};\\phi)\\parallel\\mathcal{N}(z;0,I)))\\] å¦‚æœé‡‡ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œæ¯æ¬¡ä»æ•°æ®é›†ä¸­é‡‡ä¸€ä¸ªæ ·æœ¬\\(x\\)ï¼Œç„¶åæ ¹æ®\\(q(z|x;\\phi)\\)é‡‡ä¸€ä¸ªéšå˜é‡\\(z\\)ï¼Œåˆ™ç›®æ ‡å‡½æ•°å˜ä¸ºï¼š \\[\\mathcal{J}(\\phi,\\theta|x)=\\log p(x|z;\\theta)-D_{KL}(q(z|x;\\phi)\\parallel\\mathcal{N}(z;0,I))\\] å‡è®¾\\(q(z|x;\\phi)\\)æ˜¯æ­£æ€åˆ†å¸ƒï¼ŒKLæ•£åº¦å¯ç›´æ¥ç®—å‡ºï¼š \\[D_{KL}(\\mathcal{N}(\\mu_1,\\Sigma_1)\\parallel\\mathcal(\\mu_2,\\Sigma_2))\\\\=\\frac{1}{2}(\\text{tr}(\\sigma_I^2 I)+\\mu_I^T\\mu_I-d-\\log(|\\sigma_I^2 I|))\\] å†å‚æ•°åŒ–æ˜¯å°†ä¸€ä¸ªå‚æ•°ä¸º\\(u\\)çš„å‡½æ•°\\(f(u)\\)ï¼Œé€šè¿‡ä¸€ä¸ªå‡½æ•°\\(u=g(v)\\)ï¼Œè½¬æ¢ä¸ºå‚æ•°ä¸º\\(v\\)çš„å‡½æ•°\\(\\hat{f}(v)=f(g(v))\\)ã€‚åœ¨å˜åˆ†è‡ªç¼–ç å™¨ä¸­ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ±‚éšæœºå˜é‡\\(z\\)å…³äº\\(\\phi\\)çš„å¯¼æ•°ã€‚ä½†ç”±äºæ˜¯é‡‡æ ·çš„æ–¹å¼ï¼Œæ— æ³•ç›´æ¥åˆ»ç”»\\(z\\)å’Œ\\(\\phi\\)ä¹‹é—´çš„å‡½æ•°å…³ç³»ï¼Œå› æ­¤ä¹Ÿæ— æ³•è®¡ç®—å¯¼æ•°ã€‚ å¦‚æœ\\(z\\sim q(z|x;\\phi)\\)çš„éšæœºæ€§ç‹¬ç«‹äºå‚æ•°\\(\\phi\\)ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å†å‚æ•°åŒ–çš„æ–¹æ³•æ¥è®¡ç®—å¯¼æ•°ã€‚å‡è®¾\\(q(z|x;\\phi)\\)ä¸ºæ­£æ€åˆ†å¸ƒ\\(\\mathcal{N}(\\mu_I,\\sigma^2_I I)\\)ï¼Œå…¶ä¸­\\(\\mu_I\\)å’Œ\\(\\sigma_I\\)æ˜¯æ¨æ–­ç½‘ç»œ\\(f_I(x;\\phi)\\)çš„è¾“å‡ºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼é‡‡æ ·\\(z\\)ï¼š \\[z=\\mu_I+\\sigma_I\\odot \\varepsilon\\] å…¶ä¸­\\(\\varepsilon\\sim\\mathcal{N}(0,I)\\)ã€‚è¿™æ ·\\(z\\)å’Œ\\(\\mu_I,\\sigma_I\\)çš„å…³ç³»ä»é‡‡æ ·å…³ç³»å˜ä¸ºå‡½æ•°å…³ç³»ã€‚ å¦‚æœè¿›ä¸€æ­¥å‡è®¾\\(p(x|z;\\theta)\\)æœä»é«˜æ–¯åˆ†å¸ƒ\\(\\mathcal{N}(x|\\mu_G,I)\\)ï¼Œå…¶ä¸­\\(\\mu_G=f_G(z;\\theta)\\)æ˜¯ç”Ÿæˆç½‘ç»œçš„è¾“å‡ºï¼Œåˆ™ç›®æ ‡å‡½æ•°å¯ä»¥ç®€åŒ–ä¸ºï¼š \\[\\mathcal{J}(\\phi,\\theta|x)=-\\parallel x-\\mu_G\\parallel^2+D_{KL}(\\mathcal{N}(\\mu_I,\\sigma_I)\\parallel\\mathcal{N}(0,I))\\] å…¶ä¸­ç¬¬ä¸€é¡¹å¯ä»¥è¿‘ä¼¼çœ‹ä½œæ˜¯è¾“å…¥\\(x\\)çš„é‡æ„æ­£ç¡®æ€§ï¼Œç¬¬äºŒé¡¹å¯ä»¥çœ‹ä½œæ˜¯æ­£åˆ™åŒ–é¡¹ã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Tutorial","slug":"Research/Tutorial","permalink":"http://qfxiao.me/categories/Research/Tutorial/"}],"tags":[{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"},{"name":"Variational Inference","slug":"Variational-Inference","permalink":"http://qfxiao.me/tags/Variational-Inference/"},{"name":"VAE","slug":"VAE","permalink":"http://qfxiao.me/tags/VAE/"}]},{"title":"Recurrent Neural Networks for Multivariate Time Series with Missing Values","slug":"Recurrent-Neural-Networks-for-Multivariate-Time-Series-with-Missing-Values","date":"2019-10-18T15:17:07.000Z","updated":"2020-06-25T08:25:06.176Z","comments":true,"path":"2019/10/18/Recurrent-Neural-Networks-for-Multivariate-Time-Series-with-Missing-Values/","link":"","permalink":"http://qfxiao.me/2019/10/18/Recurrent-Neural-Networks-for-Multivariate-Time-Series-with-Missing-Values/","excerpt":"","text":"Abstract æ–‡ä¸­æå‡ºäº†ä¸€ç§å¯ä»¥å¤„ç†å¸¦ç¼ºå¤±å€¼å¤šä¸ºæ—¶é—´åºåˆ—çš„GRUæ¨¡å‹ï¼šGRU-Dã€‚æœ¬æ¨¡å‹ä¸ä»…å¯ä»¥æ•æ‰æ—¶é—´åºåˆ—ä¸­çš„é•¿æœŸä¾èµ–æ¨¡å¼ï¼Œå¹¶ä¸”è¿˜èƒ½åˆ©ç”¨æ—¶é—´åºåˆ—ä¸­çš„ç¼ºå¤±æ¨¡å¼æ¥è¾¾åˆ°æ›´å¥½çš„æ—¶é—´åºåˆ—é¢„æµ‹æ•ˆæœã€‚ åŸæ–‡ Methodology Notations è®°åŒ…å«\\(D\\)ä¸ªå˜é‡çš„å¤šå˜é‡æ—¶é—´åºåˆ—ä¸º\\(X=(x_1,x_2,\\cdots,x_T)^T\\in\\mathbb{R}^{T\\times D}\\)ï¼Œå…¶ä¸­å¯¹äºæ¯ä¸ª\\(t\\in\\{1,2,\\cdots,T\\},x_t\\in\\mathbb{R}^D\\)è¡¨ç¤ºæ—¶é—´åºåˆ—åœ¨æ—¶é—´\\(t\\)çš„è§‚æµ‹å€¼ï¼Œ\\(x_t^d\\)è¡¨ç¤º\\(x_t\\)çš„ç¬¬\\(d\\)ä¸ªæˆåˆ†ã€‚è®°\\(s_t\\in\\mathbb{R}\\)ä¸º\\(t\\)æ—¶åˆ»çš„æ—¶é—´æˆ³ï¼Œå¹¶å‡è®¾ç¬¬ä¸€ä¸ªè§‚æµ‹å€¼çš„æ—¶é—´æˆ³ä¸º\\(0\\)ã€‚å¯¹äºåŒ…å«ç¼ºå¤±å€¼çš„æ—¶é—´åºåˆ—ï¼Œæˆ‘ä»¬ç”¨Masking Vector \\(m_t\\in\\{0,1\\}\\)è¿›è¡Œæ ‡è®°ï¼ŒåŒæ—¶å¯¹æ¯ä¸ª\\(x_t^d\\)ç»´æŠ¤è·ç¦»ä¸Šä¸€ä¸ªè§‚æµ‹å€¼çš„Time Interval \\(\\delta_t^d\\in\\mathbb{R}\\)ï¼Œå…¬å¼å¦‚ä¸‹ï¼š \\[ m_t^d=\\begin{cases}1, &amp;\\text{if }x_t^d\\text{ is observed}\\\\0, &amp;\\text{otherwise}\\end{cases} \\] \\[ \\delta_t^d=\\begin{cases}s_t-s_{t-1}+\\delta_{t-1}^d, &amp;t&gt;1,m_{t-1}^d=0\\\\s_t-s_{t-1}, &amp;t&gt;1, m_{t-1}^d=1\\\\0, &amp;t=1\\end{cases} \\] ä¸‹å›¾æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨æ—¶é—´åºåˆ—çš„åˆ†ç±»é—®é¢˜ï¼Œå³ç»™å®šæ•°æ®é›†\\(\\mathcal{D}=\\{(X_n,s_n,M_n)\\}_{n=1}^N\\)ï¼Œæˆ‘ä»¬è¦å¯¹æ¯ä¸ªæ ·æœ¬çš„ç±»åˆ«è¿›è¡Œé¢„æµ‹\\(l_n\\in\\{1,\\cdots,L\\}\\)ã€‚ GRU-RNN for Time Series Classification GRUæ˜¯ä¸€ç§æ”¹è¿›ç‰ˆæœ¬çš„RNNï¼Œå…¶æœ€å¤§ä¸åŒæ˜¯åŠ å…¥äº†é—¨æ§æœºåˆ¶ã€‚GRUå•å…ƒçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š GRUåŒ…å«äº†é‡ç½®é—¨å’Œæ›´æ–°é—¨ï¼Œå…¶ä¸­é‡ç½®é—¨\\(R_t\\)è´Ÿè´£æ§åˆ¶ä¸Šä¸€æ—¶é—´çš„éšçŠ¶æ€\\(h_{t-1}\\)æœ‰å¤šå°‘éƒ¨åˆ†éœ€è¦ä¿ç•™ï¼Œè€Œæ›´æ–°é—¨åˆ™å†³å®šç”±\\(R_t\\)è®¡ç®—å‡ºæ¥çš„å€™é€‰éšçŠ¶æ€\\(\\tilde{h}_t\\)æœ‰å¤šå°‘éƒ¨åˆ†éœ€è¦ä¿ç•™ã€‚æœ€åå½“å‰æ—¶é—´çš„éšçŠ¶æ€ç”±\\(h_{t-1}\\)å’Œ\\(\\tilde{h}_t\\)å…±åŒç®—å‡ºã€‚GRUçš„çŠ¶æ€æ›´æ–°å…¬å¼å¦‚ä¸‹ï¼š \\[ \\begin{align} R_t&amp;=\\sigma(W_rx_t+U_rh_{t-1}+b_r)\\\\ Z_t&amp;=\\sigma(W_zx_t+U_zh_{t-1}+b_z)\\\\ \\tilde{h}_t&amp;=\\text{tanh}(Wx_t+U(R_t\\odot h_{t-1})+b)\\\\ h_t&amp;=(1-Z_t)\\odot h_{t-1}+Z_t\\odot \\tilde{h}_t \\end{align} \\] æ–‡ä¸­æå‡ºäº†ä¸€äº›å¤„ç†ç¼ºå¤±å€¼çš„ç®€å•æ–¹æ³•ï¼š ç›´æ¥ç”¨å‡å€¼æ›¿ä»£ï¼š\\(x_t^d\\leftarrow m_t^dx_t^d+(1-m_t^d)\\tilde{x}^d\\)ï¼Œå…¶ä¸­\\(\\tilde{x}^d=\\frac{\\sum_{n=1}^N\\sum_{t=1}^{T_n}m_{t,n}^d x_{t,n}^d}{\\sum_{n=1}^N\\sum_{t=1}^{T_n}m_{t,n}^d\\tilde{x}^d}\\)ã€‚è¿™ç§æ–¹æ³•ç§°ä¸ºGRU-Meanï¼› ç”¨ä¸Šä¸€ä¸ªè§‚æµ‹å€¼æ›¿ä»£ï¼š\\(x_t^d\\leftarrow m_t^d x_t^d+(1-m_t^d)x_{t^\\prime}^d\\)ã€‚è¿™ç§æ–¹æ³•ç§°ä¸ºGRU-Forwardï¼› ä¸å¡«å……ï¼Œå°†æ˜¯å¦ç¼ºå¤±ï¼Œè·ç¦»ä¸Šä¸€ä¸ªè§‚æµ‹å€¼çš„æ—¶é—´ä½œä¸ºé¢å¤–ä¿¡æ¯è¾“å…¥ï¼š\\(x_t^{(n)}\\leftarrow[x_t^{(n)};m_t^{(n)};\\delta_t^{(n)}]\\)ã€‚è¿™ç§æ–¹æ³•ç§°ä¸ºGRU-Simpleã€‚ GRU-D: Model with Trainable Decays æ–‡ä¸­æå‡ºäº†æ—¶é—´åºåˆ—ç¼ºå¤±å€¼çš„ä¸¤ä¸ªæ€§è´¨ï¼šä¸€ä¸ªæ˜¯åœ¨ä¸Šä¸€ä¸ªè§‚æµ‹å€¼è·ç¦»å¾ˆè¿œçš„æƒ…å†µä¸‹ç¼ºå¤±å€¼å€¾å‘äºæ¥è¿‘ä¸€ä¸ªé»˜è®¤çš„å€¼ï¼Œç¬¬äºŒä¸ªæ˜¯ç¼ºå¤±å€¼çš„å½±å“ä¼šéšç€æ—¶é—´å‡å¼±ã€‚ä¸ºäº†ä½“ç°ä¸Šè¿°ä¸¤ç‚¹ï¼Œæ–‡ä¸­æå‡ºäº†GPU-Dæ¨¡å‹ï¼Œæ¨¡å‹æ¡†æ¶å¦‚ä¸‹ï¼š åœ¨æ¨¡å‹ä¸­ï¼ŒDecay Ratesè¢«è®¾å®šä¸ºä¸€ä¸ªå¸¦å‚æ•°çš„å‡½æ•°å’ŒGRUä¸€èµ·è®­ç»ƒï¼š \\[ \\gamma_t=\\exp\\{-\\max(0,W_\\gamma\\delta_t+b_\\gamma)\\} \\] \\[ \\hat{x}_t^d=m_t^dx_t^d+(1-m_t^d)(\\gamma_{x_t}^dx_{t^\\prime}^d+(1-\\gamma_{x_t}^d)\\tilde{x}^d) \\] å…¶ä¸­\\(x_{t^\\prime}^d\\)æ˜¯ç¬¬\\(d\\)ä¸ªå˜é‡çš„ä¸Šä¸€ä¸ªè§‚æµ‹å€¼ï¼Œ\\(\\tilde{x}^d\\)æ˜¯ç¬¬\\(d\\)ä¸ªå˜é‡çš„ç»éªŒå‡å€¼ã€‚è¿™æ ·\\(\\hat{x}_t^d\\)å°±ä»£è¡¨ç»è¿‡Input Decayçš„è¾“å…¥ã€‚ æ–‡ä¸­æåˆ°åªç”¨Input Decayæ˜¯ä¸å¤Ÿçš„ï¼Œé™¤æ­¤ä¹‹å¤–ä½œè€…è¿˜ä½¿ç”¨äº†Hidden State Decayï¼Œå³å¯¹\\(h_{t-1}\\)è¿›è¡ŒDecayï¼Œå…¬å¼å¦‚ä¸‹ï¼š \\[ \\hat{h}_{t-1}=\\gamma_{h_t}\\odot h_{t-1} \\] ç”¨Decayä¹‹åçš„\\(\\hat{x}_t\\)å’Œ\\(\\hat{h}_{t-1}\\)æ›¿æ¢åŸå§‹çš„GRUå…¬å¼å°±å¾—åˆ°äº†GRU-Dæ¨¡å‹ï¼š \\[ \\begin{align} R_t&amp;=\\sigma(W_r\\hat{x}_t-U_r\\hat{h}_{t-1}+V_rm_t+b_r)\\\\ Z_t&amp;=\\sigma(W_z\\hat{x}_t+U_z\\hat{h}_{t-1}+V_zm_t+b_z)\\\\ \\tilde{h}_t&amp;=\\text{tanh}(W\\hat{x}_t+U(R_t\\odot \\hat{h}_{t-1})+Vm_t+b)\\\\ h_t&amp;=(1-z_t)\\odot \\hat{h}_{t-1}+z_t\\odot\\tilde{h}_t \\end{align} \\] Experiments Baseline Imputation Methods ä¸‹å›¾ä¸ºæ–‡ä¸­æ¯”è¾ƒä¸­ç”¨åˆ°çš„Baselineï¼š Baseline Prediction Methods ä¸‹å›¾ä¸ºæ–‡ä¸­ç”¨åˆ°çš„ç”¨æ¥é¢„æµ‹çš„Baselineï¼š Results æ–‡ä¸­ç”¨åˆ°çš„æ•°æ®é›†å¦‚ä¸‹ï¼š Gesture phase segmentation dataset (Gesture). PhysioNet Challenge 2012 dataset (PhysioNet). MIMIC-â…¢ dataset (MIMIC-â…¢). ä¸‹å›¾å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨äººå·¥åˆæˆæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ¨¡å‹åœ¨é¢„æµ‹ä»»åŠ¡è¡¨ç°çš„å¯¹æ¯”ï¼š ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨MIMIC-â…¢å’ŒPhysioNetæ•°æ®é›†ä¸Šçš„å¤šä»»åŠ¡è¡¨ç°ï¼š ä¸‹å›¾åˆ†åˆ«å±•ç¤ºäº†æ¨¡å‹å­¦åˆ°çš„Input Decayå’ŒHidden State Decayï¼š","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"RNN","slug":"Research/RNN","permalink":"http://qfxiao.me/categories/Research/RNN/"}],"tags":[{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"},{"name":"RNN","slug":"RNN","permalink":"http://qfxiao.me/tags/RNN/"}]},{"title":"Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network","slug":"Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network","date":"2019-10-18T15:00:57.000Z","updated":"2020-09-12T02:54:14.061Z","comments":true,"path":"2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/","link":"","permalink":"http://qfxiao.me/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/","excerpt":"","text":"Abstract æœ¬æ–‡æå‡ºäº†OmniAnomalyï¼šä¸€ç§é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—çš„éšæœºå¾ªç¯ç¥ç»ç½‘ç»œå¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚è¯¥æ¨¡å‹è¿ç”¨äº†ä¸€ç³»åˆ—æŠ€æœ¯æ¥æ•æ‰å¤šå˜é‡æ—¶é—´åºåˆ—çš„æ­£å¸¸æ¨¡å¼ï¼Œå¹¶åœ¨æ£€æµ‹é˜¶æ®µåŸºäºé‡æ„è¯¯å·®æ¥æ£€æµ‹å¼‚å¸¸ï¼ŒåŒæ—¶æœ¬æ–‡è¿˜æä¾›äº†ä¸€å®šçš„ç†è®ºè§£é‡Šã€‚ åŸæ–‡ Contribution æå‡ºäº†OmniAnomalyï¼Œä¸€ç§åŸºäºéšæœºå¾ªç¯ç¥ç»ç½‘ç»œçš„å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼› æå‡ºäº†é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„è§£é‡Šæ–¹æ³•ï¼› é€šè¿‡å®éªŒè¯æ˜äº†OmniAnomalyä¸­æ‰€ç”¨çš„å…³é”®æŠ€æœ¯çš„æœ‰æ•ˆæ€§ï¼ŒåŒ…æ‹¬GRUï¼Œplanar NF, stochastic variable connectionå’Œadjusted Peaks-Over-Threshold methodï¼› é€šè¿‡å¤§é‡çš„å®éªŒæˆ‘ä»¬è¯æ˜äº†OmniAnomalyçš„æœ‰æ•ˆæ€§ï¼› å‘å¸ƒäº†ä»£ç å’Œæ•°æ®é›†ã€‚ Background Linear Gaussian State Space Model çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆState Space Model, SSMï¼‰çš„æ¦‚å¿µæ¥è‡ªäºæ§åˆ¶ç†è®ºï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®¨è®ºå…¶åœ¨æ—¶é—´åºåˆ—ä¸­çš„åº”ç”¨ã€‚å…¶å¤§æ¦‚æ€æƒ³æ˜¯æˆ‘ä»¬è®¤ä¸ºæ—¶é—´åºåˆ—åœ¨æ—¶åˆ»\\(t\\)çš„è§‚æµ‹å€¼\\(z_t\\)æ˜¯ä¸€ä¸ªéšå«çŠ¶æ€\\(\\boldsymbol{l}_t\\)çš„æ¡ä»¶åˆ†å¸ƒ\\(p(z_t|\\boldsymbol{l}_t)\\)ï¼Œè€Œè¿™ä¸ªéšå«çŠ¶æ€\\(\\boldsymbol{l}_t\\)åˆ»ç”»äº†æ—¶é—´åºåˆ—çš„å†…åœ¨è§„å¾‹ï¼ŒåŒæ—¶éšå«çŠ¶æ€ä¼šéšç€æ—¶é—´æ›´æ–°ï¼Œå³æœä»æ¡ä»¶åˆ†å¸ƒ\\(p(\\boldsymbol{l}_t|\\boldsymbol{l}_{t-1})\\)ã€‚ åœ¨çº¿æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆLinear State Space Modelï¼‰ä¸­æˆ‘ä»¬ä»¥å¦‚ä¸‹çš„æ–¹å¼åˆ»ç”»éšå«çŠ¶æ€çš„æ›´æ–°ï¼š \\[ \\boldsymbol{l}_t=\\boldsymbol{F}_t\\boldsymbol{l}_{t-1}+\\boldsymbol{g}_t\\varepsilon_t, \\space\\space\\space\\varepsilon_t\\sim\\mathcal{N}(0,1) \\] \\(\\boldsymbol{F}_t\\)ä¸ºç¡®å®šçš„çŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œè€Œ\\(\\boldsymbol{g}_t\\varepsilon_t\\)åˆ™è¡¨ç¤ºäº†çŠ¶æ€è½¬ç§»çš„éšæœºæ€§ã€‚ è§‚æµ‹å€¼\\(z_t\\)ä»éšå«çŠ¶æ€\\(\\boldsymbol{l}_t\\)è®¡ç®—è€Œæ¥ï¼š \\[ \\begin{align} z_t&amp;=y_t+\\sigma_t\\epsilon_t,\\\\ y_t&amp;=\\boldsymbol{a}_t^\\top\\boldsymbol{l}_{t-1}+b_t,\\\\ \\epsilon_t&amp;\\sim\\mathcal{N}(0,1) \\end{align} \\] å…¶ä¸­\\(\\boldsymbol{a}_t\\in\\mathbb{R}^L,\\sigma_t\\in \\mathbb{R},b_t\\in\\mathbb{R}\\)éƒ½æ˜¯é¢å¤–çš„å‚æ•°ã€‚åˆå§‹çŠ¶æ€\\(\\boldsymbol{l}_0\\)åˆ™ä»ä¸€ä¸ªç‹¬ç«‹çš„é«˜æ–¯åˆ†å¸ƒå¾—æ¥ï¼Œå³\\(\\boldsymbol{l}_0\\sim N(\\boldsymbol\\mu_0,\\text{diag}(\\boldsymbol{\\sigma}_0^2))\\)ã€‚ ä»¤å‚æ•°é›†åˆ\\(\\Theta_t=(\\boldsymbol{\\mu}_0,\\boldsymbol{\\Sigma}_0,\\boldsymbol{F}_t,\\boldsymbol{g}_t,\\boldsymbol{a}_t,b_t,\\sigma_t),\\forall t&gt;0\\)ï¼Œä¸€èˆ¬æ¥è¯´å‚æ•°é›†åˆä¸ä¼šéšç€æ—¶é—´å˜åŒ–ï¼Œå³æ¯ä¸ªæ—¶åˆ»\\(t\\)å…±äº«åŒæ ·çš„å‚æ•°\\(\\Theta_t=\\Theta,\\forall t&gt;0\\)ã€‚å¯¹å‚æ•°çš„ä¼°è®¡å¯ä»¥é‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ï¼š \\[ \\begin{align} \\Theta^*_{1:T}&amp;=\\arg\\max_{\\Theta_{1:T}}p(z_{1:T}|\\Theta_{1:T}),\\\\ \\end{align} \\] å…¶ä¸­ï¼š \\[ \\begin{align} p(z_{1:T}|\\Theta_{1:T})&amp;=p(z_1|\\Theta_1)\\prod\\limits_{t=2}^T p(z_t|z_{1:t-1},\\Theta_{1:t})\\\\ &amp;=\\int p(\\boldsymbol{l}_0)\\left[\\prod\\limits_{t=1}^T p(z_t|\\boldsymbol{l}_t)p(\\boldsymbol{l}_t|\\boldsymbol{l}_{t-1})\\right]\\mathrm{d}\\boldsymbol{l}_{0:T} \\end{align} \\] Planar Normalizing Flow Normalizing Flows VAEé‡‡ç”¨ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ\\(q_\\phi(z|x)\\)æ¥è¿‘ä¼¼çœŸå®çš„åéªŒåˆ†å¸ƒ\\(p(z|x)\\)ï¼Œå¹¶æ¨å¯¼å‡º\\(\\log p_\\theta(x)\\)çš„ä¸‹ç•Œï¼ˆç§°ä¸ºELBOï¼‰æ¥ä½œä¸ºä¼˜åŒ–ç›®æ ‡å‡½æ•°ï¼š \\[ \\begin{align} \\log p_\\theta(x)&amp;=\\log \\int p_\\theta(x|z)p(z)\\mathrm{d}z\\\\ &amp;=\\log\\int\\frac{q_\\phi(z|x)}{q_\\phi(z|x)}p_\\theta(x|z)p(z)\\mathrm{d}z\\\\ &amp;\\geq-D_{KL}[q_\\phi(z|x)\\parallel p(z)]+\\mathbb{E}_q[\\log p_\\theta(x|z)] \\end{align} \\] \\(\\log p_\\theta(x)\\)ä¸ELBOå–ç­‰çš„æ¡ä»¶æ˜¯\\(D_{KL}[q_\\phi(z|x)\\parallel p(z)]\\)ï¼Œè¡¨æ˜å˜åˆ†åˆ†å¸ƒå®Œå…¨åŒ¹é…äº†çœŸå®çš„åéªŒåˆ†å¸ƒã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒçœŸå®çš„åéªŒåˆ†å¸ƒå¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œè€Œæˆ‘ä»¬çš„å˜åˆ†åˆ†å¸ƒé€šå¸¸æ˜¯ä¸€ä¸ªç¡®å®šçš„è¾ƒä¸ºç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚è¿™æ ·å˜åˆ†åˆ†å¸ƒå¯èƒ½å¾ˆéš¾å¯¹çœŸå®åéªŒåˆ†å¸ƒå¾—åˆ°ä¸€ä¸ªå¾ˆå¥½çš„æ‹Ÿåˆã€‚ ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ ‡å‡†åŒ–æµï¼ˆNormalizing Flowsï¼‰ã€‚æ ‡å‡†åŒ–æµæ˜¯ä»ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒå‡ºå‘ï¼Œæ‰§è¡Œä¸€ç³»åˆ—å¯é€†çš„æ˜ å°„ï¼Œå°†åŸå§‹ç®€å•çš„åˆ†å¸ƒè½¬åŒ–ä¸ºä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒã€‚ é¦–å…ˆè€ƒè™‘ä¸€ä¸ªå…‰æ»‘çš„ã€å¯é€†çš„æ˜ å°„\\(f:\\mathbb{R}^d\\mapsto \\mathbb{R}^d\\)ï¼Œè®°\\(g=f^{-1}\\)ï¼Œé‚£ä¹ˆ\\(g\\circ f(\\mathbf{z})=\\mathbf{z}\\)ã€‚ä»¤\\(\\mathbf{z}^\\prime=f(\\mathbf{z})\\)ï¼Œé‚£ä¹ˆ\\(\\mathbf{z}^\\prime\\)çš„åˆ†å¸ƒä¸ºï¼š \\[ q(\\mathbf{z}^\\prime)=q(\\mathbf{z})\\left|\\text{det}\\frac{\\partial f^{-1}}{\\partial \\mathbf{z}^\\prime}\\right|=q(z)\\left|\\text{det}\\frac{\\partial f}{\\partial \\mathbf{z}}\\right|^{-1} \\] å¼ä¸­\\(q(\\mathbf{z}^\\prime)=q(z)\\left|\\text{det}\\frac{\\partial f}{\\partial \\mathbf{z}}\\right|^{-1}\\)è¯´æ˜äº†\\(\\mathbf{z}^\\prime\\)çš„åˆ†å¸ƒç­‰äº\\(\\mathbf{z}\\)çš„åˆ†å¸ƒä¹˜ä¸Š\\(f\\)çš„JacobiançŸ©é˜µçš„è¡Œåˆ—å¼çš„å€’æ•°ã€‚é‚£ä¹ˆå¯¹äºæ˜ å°„å¤šæ¬¡çš„æƒ…å†µï¼š \\[ \\mathbf{z}_K=f_K\\circ\\cdots\\circ f_2\\circ f_1(\\mathbf{z}_0) \\] \\(\\mathbf{z}_K\\)çš„åˆ†å¸ƒå¯ä»¥é€šè¿‡é“¾å¼è®¡ç®—å¾—åˆ°ï¼š \\[ \\ln q_K(\\mathbf{z}_K)=\\ln q_0(\\mathbf{z}_0)-\\sum\\limits_{k=1}^K\\ln\\left|\\text{det}\\frac{\\partial f_k}{\\partial \\mathbf{z}_{k-1}}\\right| \\] Planar Flows è€ƒè™‘ä¸€ä¸ªå˜æ¢æ—ï¼š \\[ f(\\mathbf{z})=\\mathbf{z}+\\mathbf{u}h(\\mathbf{w}^\\top\\mathbf{z}+b) \\] å…¶ä¸­\\(\\lambda=\\{\\mathbf{w}\\in \\mathbb{R}^d,\\mathbf{u}\\in\\mathbb{R}^d,b\\in\\mathbb{R}\\}\\)ä¸ºå‚æ•°é›†åˆï¼Œ\\(h(\\cdot)\\)ä¸ºå…ƒç´ çº§çš„éçº¿æ€§å‡½æ•°ï¼ˆå¦‚å„ç§æ¿€æ´»å‡½æ•°ï¼‰ã€‚ä»¤\\(\\psi(\\mathbf{z})=h^\\prime(\\mathbf{w}^\\top\\mathbf{z}+b)\\mathbf{w}\\)ï¼Œåˆ™\\(f\\)çš„JacobiançŸ©é˜µè¡Œåˆ—å¼ç»å¯¹å€¼ç­‰äºï¼š \\[ \\left|\\text{det}\\frac{\\partial f}{\\partial \\mathbf{z}}\\right|=\\left|\\text{det}(\\mathbf{I}+\\mathbf{u}\\psi(\\mathbf{z})^\\top)\\right|=\\left|1+\\mathbf{u}^\\top\\psi(\\mathbf{z})\\right| \\] ä½†æ˜¯\\(f\\)å¹¶ä¸ä¿è¯æ€»æ˜¯å¯é€†çš„ï¼Œå¦‚\\(h(x)=\\tanh(x)\\)æ—¶ï¼Œ\\(f\\)å¯é€†çš„æ¡ä»¶æ˜¯\\(\\mathbf{w}^\\top \\mathbf{u}\\geq-1\\)ã€‚ ä¸‹é¢è®¨è®ºå¦‚ä½•ä¿è¯å¯é€†çš„æ¡ä»¶ã€‚è€ƒè™‘å°†\\(\\mathbf{z}\\)åˆ†è§£ä¸º\\(\\mathbf{z}=\\mathbf{z}_\\bot+\\mathbf{z}_\\parallel\\)ï¼Œå…¶ä¸­\\(\\mathbf{z}_\\bot\\)ä¸\\(\\mathbf{w}\\)æ­£äº¤ï¼Œ\\(\\mathbf{z}_\\parallel\\)ä¸\\(\\mathbf{w}\\)å¹³è¡Œï¼Œé‚£ä¹ˆï¼š \\[ f(z)=\\mathbf{z}_\\bot+\\mathbf{z}_\\parallel+\\mathbf{u}h(\\mathbf{w}^\\top \\mathbf{z}_\\parallel +b) \\] å®é™…ä¸Šå¾—åˆ°\\(\\mathbf{z}_\\parallel\\)ä¹‹åå¯ä»¥å¾ˆå®¹æ˜“çš„å¾—åˆ°\\(\\mathbf{z}_\\bot\\)ï¼Œä»¤\\(\\mathbf{y}=f(\\mathbf{z})\\)ï¼Œæœ‰ï¼š \\[ \\mathbf{z}_\\bot=\\mathbf{y}-\\mathbf{z}_\\parallel-\\mathbf{u}h(\\mathbf{w}^\\top\\mathbf{z}_\\parallel+b) \\] è€Œ\\(\\mathbf{z}_\\parallel\\)ä¸\\(\\mathbf{w}\\)å¹³è¡Œï¼Œæ˜“çŸ¥\\(\\mathbf{z}_\\parallel=\\alpha\\frac{\\mathbf{w}}{\\parallel\\mathbf{w}\\parallel^2}\\)ï¼Œå…¶ä¸­\\(\\alpha\\in\\mathbb{R}\\)ã€‚ å¯¹å¼(16)ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥\\(\\mathbf{w}^\\top\\)å¯å¾—ï¼š \\[ \\mathbf{w}^\\top f(\\mathbf{z})=\\alpha+\\mathbf{w}^\\top\\mathbf{u} h(\\alpha+b) \\] å½“\\(\\alpha+\\mathbf{w}^\\top\\mathbf{u} h(\\alpha+b)\\)å¯¹äº\\(\\alpha\\)æ˜¯éé€’å‡å‡½æ•°çš„æ—¶å€™ï¼Œ\\(f\\)æ˜¯å¯é€†çš„ã€‚å› ä¸º\\(\\alpha+\\mathbf{w}^\\top\\mathbf{u} h(\\alpha+b)\\)æ˜¯éé€’å‡å‡½æ•°æ—¶æœ‰\\(1+\\mathbf{w}^\\top\\mathbf{u}h^\\prime(\\alpha+b)\\geq 0\\equiv \\mathbf{w}^\\top \\mathbf{u}\\geq -\\frac{1}{h^\\prime(\\alpha + b)}\\)ï¼Œè€Œ\\(0\\leq h^\\prime(\\alpha + b) \\leq 1\\)ï¼ˆ\\(\\tanh\\)å‡½æ•°çš„æ€§è´¨ï¼‰ï¼Œæ‰€ä»¥æ€»æ˜¯æœ‰\\(\\mathbf{w}^\\top \\mathbf{u}\\geq-1\\)ã€‚ å¯¹äºä»»æ„ä¸€ä¸ª\\(\\mathbf{u}\\)ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ–¹å¼æ„é€ ä¸€ä¸ª\\(\\hat{\\mathbf{u}}\\)ä½¿å¾—\\(\\mathbf{w}^\\top\\hat{\\mathbf{u}}&gt;-1\\)ï¼Œå³ä»¤\\(\\hat{\\mathbf{u}}(\\mathbf{w},\\mathbf{u})=\\mathbf{u}+[m(\\mathbf{w}^\\top\\mathbf{u})-(\\mathbf{w}^\\top\\mathbf{u})]\\frac{\\mathbf{w}}{\\parallel\\mathbf{w}\\parallel^2}\\)ï¼Œå…¶ä¸­\\(m(x)=-1+\\log(1+e^x)\\)ã€‚ Methodology Problem Statement æœ¬æ–‡é’ˆå¯¹çš„æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—\\(x=\\{x_1,x_2,\\cdots,x_N\\}\\in R^{M\\times N}\\)ï¼Œ\\(N\\)ä¸ºæ—¶é—´é•¿åº¦ï¼Œå…¶ä¸­æŸä¸€æ—¶åˆ»çš„è§‚æµ‹å€¼\\(x_t\\in R^M\\)ä¸ºä¸€ä¸ª\\(M\\)ç»´çš„å‘é‡ã€‚ä½œè€…ä½¿ç”¨\\(x_{t-T:t}\\in R^{M\\times(T+1)}\\)æ¥è¡¨ç¤º\\(t-T\\)åˆ°\\(t\\)ä¹‹é—´çš„æ—¶é—´åºåˆ—ã€‚ Overall Structure ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é¢„å¤„ç†æ¨¡å—ä¸»è¦æ˜¯å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ä»¥åŠçª—å£åˆ‡åˆ†ã€‚è®­ç»ƒæ¨¡å—åˆ™æ ¹æ®è¾“å…¥çš„æ•°æ®å¯¹æ­£å¸¸æ¨¡å¼è¿›è¡Œæ•æ‰ï¼Œè¾“å‡ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨çº¿æ£€æµ‹æ¨¡å—åˆ™ä¼šå®šæœŸæ‰§è¡Œã€‚ Network Architecture æ¨¡å‹çš„æ€»ä½“ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åœ¨qnetä¸­ï¼Œé¦–å…ˆGRUè¢«ç”¨æ¥å»ºæ¨¡æ ·æœ¬çš„æ—¶é—´ä¾èµ–å…³ç³»ï¼Œä¹‹åVAEå°†æ ·æœ¬\\(\\mathbf{x}\\)æ˜ å°„åˆ°éšç©ºé—´\\(\\mathbf{z}\\)ã€‚æ–‡ä¸­ä½¿ç”¨äº†Linear Gaussian State Space Modelæ¥å»ºæ¨¡éšå˜é‡ä¹‹é—´çš„æ—¶é—´ä¾èµ–å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜ä½¿ç”¨äº†Planar Normalizing Flowæ¥å°†éšå˜é‡æ˜ å°„åˆ°å¤æ‚çš„éé«˜æ–¯åˆ†å¸ƒã€‚åœ¨pnetä¸­ï¼Œéšå˜é‡\\(\\mathbf{z}_{t-T:t}\\)è¢«ç”¨æ¥é‡å»º\\(\\mathbf{x}_{t-T:t}\\)ï¼Œç›´è§‚ä¸Šæ¥è¯´ï¼Œå¯¹æ ·æœ¬çš„å¥½çš„éšå˜é‡è¡¨ç¤ºå¯ä»¥å¸¦æ¥æ›´å¥½çš„é‡æ„æ•ˆæœã€‚ ä»ç»†èŠ‚ä¸Šæ¥è¯´ï¼Œåœ¨æ—¶é—´\\(t\\)ï¼Œqnetçš„è¾“å…¥ä¸º\\(\\mathbf{x}_t\\)å’Œ\\(\\mathbf{e}_{t-1}\\)ï¼Œä¸¤è€…ç»è¿‡GRU Cellä¹‹åä¼šäº§ç”Ÿ\\(t\\)æ—¶é—´çš„\\(\\mathbf{e_t}\\)ã€‚\\(\\mathbf{e}_t\\)æ˜¯GRUæ•æ‰æ—¶é—´ä¾èµ–æ€§çš„å…³é”®ï¼Œå¯ä»¥è®¤ä¸ºå®ƒåŒ…å«äº†\\(\\mathbf{x}_{1:t}\\)çš„ä¿¡æ¯ã€‚ä¹‹å\\(\\mathbf{e}_t\\)ä¼šå’Œ\\(\\mathbf{z}_{t-1}\\)è¿›è¡Œæ‹¼æ¥ï¼Œè¿›å…¥æ ‡å‡†çš„VAEå˜åˆ†ç½‘ç»œç»“æ„ï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„å‚æ•°\\(\\mu_{z_t},\\sigma_{z_t}\\)é‡‡æ ·å¾—åˆ°éšå˜é‡\\(\\mathbf{z}_t^0\\)ï¼Œæ­¤æ—¶éšå˜é‡å¯ä»¥è¯´æ•æ‰äº†æ—¶é—´ä¾èµ–æ€§ã€‚ ç½‘ç»œä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š \\[ \\begin{align} e_t&amp;=(1-c_t^e)\\circ\\text{tanh}(w^ex_t+u^e(r_t^e\\circ e_{t-1})+b^e)+c_t^e\\circ e_{t-1}\\\\ \\mu_{z_t}&amp;=w^{\\mu_z}h^\\phi([z_{t-1},e_t])+b^{\\mu_z}\\\\ \\sigma_{z_t}&amp;=\\text{softplus}(w^{\\sigma_z}h^\\phi([z_{t-1},e_t])+b^{\\sigma_z})+\\epsilon^{\\sigma_z} \\end{align} \\] å…¶ä¸­\\(r_t^e=\\text{sigmoid}(\\mathbf{w}^{r^e}\\mathbf{x}_t+\\mathbf{u}^{r^e}\\mathbf{e}_{t-1}+b^{r^e})\\)æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ\\(c_t^e=\\text{sigmoid}(\\mathbf{w}^{c^e}\\mathbf{x}_t+\\mathbf{u}^{c^e}\\mathbf{e}_{t-1}+b^{c^e})\\)æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚ æ­¤æ—¶\\(\\mathbf{z}_t^0\\)æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸ºäº†æ‹Ÿåˆå¤æ‚çš„åéªŒåˆ†å¸ƒï¼Œæˆ‘ä»¬ä½¿ç”¨Planar Normalizing Flowæ¥å¯¹\\(\\mathbf{z}_t^0\\)è¿›è¡Œå˜æ¢ï¼Œæœ€åå¾—åˆ°ç»\\(K\\)æ¬¡å˜æ¢åçš„éšæœºå˜é‡\\(\\mathbf{z}_t^K\\)ã€‚ åœ¨æ—¶é—´\\(t\\)ï¼Œpnetè¯•å›¾é€šè¿‡\\(\\mathbf{z}_t^K\\)æ¥é‡æ„\\(\\mathbf{x}_t\\)ã€‚é¦–å…ˆ\\(\\mathbf{z}\\)ç©ºé—´ä¸­çš„å˜é‡ä¼šæ ¹æ®Linear Gaussian State Space Modelæ¥è¿›è¡Œâ€œè¿æ¥â€œï¼Œå…¬å¼ä¸º\\(\\mathbf{z}_t=\\mathbf{O}_\\theta(\\mathbf{T}_\\theta\\mathbf{z}_{t-1}+\\mathbf{v}_t)+\\boldsymbol{\\epsilon}_t\\)ï¼Œå…¶ä¸­\\(\\mathbf{O}_\\theta\\)å’Œ\\(\\mathbf{T}_\\theta\\)ä¸ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œ\\(\\mathbf{v}_t\\)å’Œ\\(\\boldsymbol{\\epsilon}_t\\)ä¸ºéšæœºå™ªå£°ã€‚ä¹‹å\\(\\mathbf{z}_t\\)å’Œ\\(\\mathbf{d}_{t-1}\\)ä¼šä½œä¸ºGRUçš„è¾“å…¥ï¼Œäº§ç”Ÿ\\(\\mathbf{d}_t\\)ã€‚ä¹‹å\\(\\mathbf{d}_t\\)ä¼šç»è¿‡æ ‡å‡†VAEä¸­çš„ç”Ÿæˆç½‘ç»œï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„é«˜æ–¯åˆ†å¸ƒå‚æ•°\\(\\mu_{x_t},\\sigma_{x_t}\\)é‡‡æ ·å¾—åˆ°é‡æ„åçš„æ ·æœ¬\\(\\mathbf{x}^\\prime_t\\)ã€‚pnetä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š \\[ \\begin{align} d_t&amp;=(1-c_t^d)\\circ\\text{tanh}(w^dz_t+u^d(r_t^d\\circ d_{t-1})+b^d)+c_t^d\\circ d_{t-1}\\\\ \\mu_{x_t}&amp;=w^{\\mu_x}h^\\theta(d_t)+b^{\\mu_x}\\\\ \\sigma_{x_t}&amp;=\\text{softplus}(w^{\\sigma_x}h^\\theta(d_t)+b^{\\sigma_x})+\\epsilon^{\\sigma_x} \\end{align} \\] å…¶ä¸­\\(r_t^d=\\text{sigmoid}(\\mathbf{w}^{r^d}\\mathbf{x}_t+\\mathbf{u}^{r^d}\\mathbf{d}_{t-1}+b^{r^d})\\)æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ\\(c_t^d=\\text{sigmoid}(\\mathbf{w}^{c^d}\\mathbf{x}_t+\\mathbf{u}^{c^d}\\mathbf{d}_{t-1}+b^{c^d})\\)æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚ Offline Model Training å’Œä¼ ç»ŸVAEç±»ä¼¼ï¼Œæ¨¡å‹çš„è®­ç»ƒå¯ä»¥é€šè¿‡ä¼˜åŒ–ELBOæ¥å®Œæˆã€‚è®°é•¿åº¦ä¸º\\(T+1\\)çš„è¾“å…¥åºåˆ—ä¸º\\(\\mathbf{x}_{t-T:t}\\)ï¼Œéšç©ºé—´å˜é‡é‡‡æ ·æ¬¡æ•°ä¸º\\(L\\)ï¼Œç¬¬\\(l\\)ä¸ªéšç©ºé—´å˜é‡ä¸º\\(\\mathbf{l}^{(l)}_{t-T:t}\\)ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š \\[ \\tilde{\\mathcal{L}}(\\mathbf{x}_{t-T:t})\\approx\\frac{1}{L}\\sum_{t=1}^L[\\log(p_\\theta(\\mathbf{x}_{t-T:t}|\\mathbf{z}_{t-T:t}^{(l)}))+\\log(p_\\theta(\\mathbf{z}_{t-T:t}^{(l)}))-\\log(q_\\phi(\\mathbf{z}_{t-T:t}^{(l)}|\\mathbf{x}_{t-T:t}))] \\] ç¬¬ä¸€é¡¹\\(\\log(p_\\theta(\\mathbf{x}_{t-T:t}|\\mathbf{z}_{t-T:t}^{(l)}))\\)å¯ä»¥çœ‹ä½œæ˜¯é‡æ„è¯¯å·®ï¼›ç¬¬äºŒé¡¹\\(\\log(p_\\theta(\\mathbf{z}_{t-T:t}))=\\sum_{i=t-T}^t \\log(p_\\theta(\\mathbf{z}_i|\\mathbf{z}_{i-1}))\\)é€šè¿‡Linear Gaussian State Space Modelè®¡ç®—ï¼›ç¬¬ä¸‰é¡¹\\(-\\log(q_\\phi(\\mathbf{z}_{t-T:t}|\\mathbf{x}_{t-T:t}))=-\\sum_{i=t-T}^t\\log(q_\\phi(\\mathbf{z}_i|\\mathbf{z}_{i-1},\\mathbf{x}_{t-T:i}))\\)ä¸ºéšå˜é‡\\(\\mathbf{z}\\)åéªŒåˆ†å¸ƒçš„ä¼°è®¡ï¼ŒåŒæ—¶\\(\\mathbf{z}_i\\)æ˜¯ç»Planar Normalizing Flowè½¬æ¢è¿‡çš„ã€‚ Online Detection åœ¨è®­ç»ƒå¥½æ¨¡å‹ä¹‹åï¼Œå°±å¯ä»¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹äº†ã€‚åœ¨æ—¶é—´\\(t\\)ï¼Œæˆ‘ä»¬é€šè¿‡æ ¹æ®é•¿åº¦ä¸º\\(T+1\\)çš„åºåˆ—\\(\\mathbf{x}_{t-T:t}\\)æ¥é‡æ„\\(\\mathbf{x}_t\\)ï¼Œå¹¶æ ¹æ®é‡æ„æ¦‚ç‡\\(\\log(p_\\theta(\\mathbf{x}_t|\\mathbf{z}_{t-T:t}))\\)æ¥åˆ¤å®šå¼‚å¸¸ã€‚å®šä¹‰\\(\\mathbf{x}_t\\)å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°\\(S_t=\\log(p_\\theta(\\mathbf{x}_t|\\mathbf{z}_{t-T:t}))\\)ï¼Œé«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ ·æœ¬\\(\\mathbf{x}_t\\)èƒ½å¤Ÿä»¥å¤§æ¦‚ç‡é‡æ„ï¼ˆå› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è®­ç»ƒï¼Œå¯ä»¥è®¤ä¸ºæ¨¡å‹å»ºæ¨¡çš„æ˜¯æ­£å¸¸æ ·æœ¬çš„åˆ†å¸ƒï¼Œé‡æ„æ¦‚ç‡é«˜å°±ä»£è¡¨ç¬¦åˆæ­£å¸¸åˆ†å¸ƒï¼‰ã€‚ç»™å®šé˜ˆå€¼ä¹‹åä¾¿å¯æ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤å®šã€‚ Automatic Threshold Selection åœ¨å¼‚å¸¸æ£€æµ‹é˜¶æ®µï¼Œéœ€è¦æ ¹æ®è®¾å®šçš„é˜ˆå€¼å’Œæ¯ä¸ªæ ·æœ¬çš„å¼‚å¸¸åˆ†æ•°æ¥åˆ¤æ–­è¯¥æ ·æœ¬æ˜¯å¦ä¸ºå¼‚å¸¸ï¼Œæ‰€ä»¥é˜ˆå€¼çš„é€‰æ‹©ååˆ†é‡è¦ã€‚æ–‡ä¸­ç”¨åˆ°äº†ä¸€ç§æ ¹æ®Extreme Value Theoryè‡ªåŠ¨é€‰æ‹©é˜ˆå€¼çš„ç®—æ³•ã€‚å¯¹äºä¸€ä¸ªåˆ†å¸ƒï¼Œå…¶ä¸­çš„æç«¯äº‹ä»¶å¾€å¾€ä½äºåˆ†å¸ƒçš„æœ«å°¾ï¼Œè€ŒExtreme Value Theoryç¬¬ä¸€å®šç†ç»™å‡ºä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ï¼Œè¿™äº›æç«¯äº‹ä»¶çš„åˆ†å¸ƒæœä»ä¸€ä¸ªå¸¦å‚çš„åˆ†å¸ƒæ—ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨å¯¹æ•°æ®åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡æç«¯äº‹ä»¶çš„åˆ†å¸ƒã€‚ é™¤äº†Extreme Value Theoryç¬¬ä¸€å®šç†ä¹‹å¤–ï¼ŒExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼\\(t\\)çš„åˆ†å¸ƒå¯ä»¥ç”¨Generalized Pareto Distributionæ¥æè¿°ã€‚ä½œè€…ä½¿ç”¨äº†åŸºäºExtreme Value Theoryç¬¬äºŒå®šç†çš„Peaks-Over-Thresholdç®—æ³•æ¥è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚å› ä¸ºExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼\\(t\\)çš„åˆ†å¸ƒï¼Œè€Œåœ¨æœ¬æ–‡çš„åœºæ™¯ä¸­æˆ‘ä»¬éœ€è¦åˆ»ç”»çš„å¼‚å¸¸ç‚¹çš„åˆ†å¸ƒåº”è¯¥æ˜¯å°äºä¸€ä¸ªç»™å®šé˜ˆå€¼çš„åˆ†å¸ƒï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹å…¬å¼ã€‚ å¯¹äºç»™å®šçš„æ•°æ®ï¼Œæ¨¡å‹ä¼šç»™å‡ºå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°åºåˆ—\\(\\{S_1,S_2,\\cdots,S_{N^\\prime}\\}\\)ï¼Œç»™å®šé¢„å…ˆè®¾å®šçš„é˜ˆå€¼\\(th\\)ï¼Œ\\(S_i\\)æç«¯éƒ¨åˆ†ï¼ˆå³å°äº\\(th\\)çš„éƒ¨åˆ†ï¼‰çš„åˆ†å¸ƒç¬¦åˆGeneralized Pareto Distributionï¼Œå…¬å¼å¦‚ä¸‹ï¼š \\[ \\bar{F}(s)=P(th-S&gt;s|S&lt;th)\\sim(1+\\frac{\\gamma s}{\\beta})^{-\\frac{1}{\\gamma}} \\] å…¶ä¸­\\(\\gamma\\)å’Œ\\(\\beta\\)ä¸ºåˆ†å¸ƒçš„å½¢çŠ¶å‚æ•°ï¼Œæœ¬æ–‡ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ¥å¯¹å‚æ•°è¿›è¡Œä¼°è®¡ã€‚è®¾å‚æ•°çš„ä¼°è®¡å€¼åˆ†åˆ«ä¸º\\(\\hat{\\gamma}\\)å’Œ\\(\\hat{\\beta}\\)ï¼Œæœ€ç»ˆçš„é˜ˆå€¼\\(th_F\\)ç”±æ‹Ÿåˆå¾—åˆ°çš„åˆ†å¸ƒçš„åˆ†ä½æ•°ç¡®å®šï¼š \\[ th_F\\simeq th-\\frac{\\hat{\\beta}}{\\hat{\\gamma}}((\\frac{qN^\\prime}{N^\\prime_{th}})^{-\\hat{\\gamma}}-1) \\] å…¶ä¸­\\(q\\)ä¸ºæœŸæœ›\\(S&lt;th\\)çš„æ¦‚ç‡ï¼Œ\\(N^\\prime\\)ä¸ºè§‚æµ‹å€¼çš„æ•°é‡ï¼Œ\\(N^\\prime_{th}\\)ä¸º\\(S_i&lt;th\\)çš„ä¸ªæ•°ã€‚ Anomaly Interpretation \\[ \\log(p_\\theta(\\mathbf{x}_t|\\mathbf{z}_{t-T:t}))=\\sum_{i=1}^M\\log(p_\\theta(x_t^i|\\mathbf{z}_{t-T:t})) \\] Experiments Datasets and Metrics Overall Performance Effects of Major Techniques Visualization on Z-Space Representations","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://qfxiao.me/tags/Machine-Learning/"},{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"},{"name":"VAE","slug":"VAE","permalink":"http://qfxiao.me/tags/VAE/"},{"name":"RNN","slug":"RNN","permalink":"http://qfxiao.me/tags/RNN/"},{"name":"Flow-based Model","slug":"Flow-based-Model","permalink":"http://qfxiao.me/tags/Flow-based-Model/"}]},{"title":"GAIN: Missing Data Imputation using Generative Adversarial Nets","slug":"GAIN-Missing-Data-Imputation-using-Generative-Adversarial-Nets","date":"2019-10-16T12:19:10.000Z","updated":"2020-06-25T05:38:07.244Z","comments":true,"path":"2019/10/16/GAIN-Missing-Data-Imputation-using-Generative-Adversarial-Nets/","link":"","permalink":"http://qfxiao.me/2019/10/16/GAIN-Missing-Data-Imputation-using-Generative-Adversarial-Nets/","excerpt":"","text":"Abstract æœ¬æ–‡åŸºäºGANæå‡ºäº†ä¸€ç§æ—¶é—´åºåˆ—ç¼ºå¤±å€¼å¡«å……ï¼ˆTime Series Imputationï¼‰çš„æ–¹æ³•ã€‚å…¶ä¸»è¦çš„æ€è·¯ä¸ºç”Ÿæˆå™¨\\(G\\)ä»éšç©ºé—´\\(Z\\)ç”Ÿæˆå®Œæ•´çš„æ ·æœ¬ï¼Œè€Œåˆ¤åˆ«å™¨\\(D\\)åˆ™è¾“å‡ºæ ·æœ¬ä¸­ä¸åŒéƒ¨åˆ†ä¸ºçœŸå®çš„æ¦‚ç‡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…æå‡ºäº†ä½¿ç”¨Hint Vectoræ¥æ­ç¤ºåŸå§‹æ•°æ®ä¸­ç¼ºå¤±éƒ¨åˆ†çš„ä¿¡æ¯ï¼Œæ¥ä¼˜åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚ åŸæ–‡ Methodology Problem Formulation è€ƒè™‘ä¸€ä¸ª\\(d\\)ç»´çš„ç©ºé—´\\(\\mathcal{X}=\\mathcal{X}_1\\times \\cdots\\times \\mathcal{X}_d\\)ï¼Œè®¾\\(\\mathbf{X}=(X_1,\\cdots,X_d)\\)ç»´ç©ºé—´\\(\\mathcal{X}\\)ä¸Šçš„éšæœºå‘é‡ï¼ˆå³ç†æƒ³çš„å®Œæ•´çš„æ—¶é—´åºåˆ—ï¼‰ï¼Œè®°å…¶åˆ†å¸ƒä¸º\\(P(\\mathbf{X})\\)ã€‚è®¾\\(\\mathbf{M}=(M_1,\\cdots,M_d)\\)ä¸ºMaskå‘é‡è¡¨ç¤º\\(\\mathbf{X}\\)ä¸­è¢«è§‚å¯Ÿåˆ°çš„éƒ¨åˆ†ã€‚ï¼ˆå³æ ‡è¯†æ—¶é—´åºåˆ—å“ªäº›éƒ¨åˆ†æœ‰ç¼ºå¤±ï¼‰ï¼Œå–å€¼ä¸º\\(\\{0,1\\}^d\\)ã€‚ å¯¹äºæ¯ä¸€ä¸ª\\(i\\in\\{1,\\cdots,d\\}\\)ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°ç©ºé—´\\(\\tilde{\\mathcal{X}}=\\mathcal{X}\\cup\\{*\\}\\)ï¼Œå…¶ä¸­\\(*\\)è¡¨ç¤ºä¸å±äºä»»æ„\\(\\mathcal{X}_i\\)çš„ä¸€ä¸ªç‚¹ã€‚ä»¤\\(\\tilde{\\mathcal{X}}=\\tilde{\\mathcal{X}_1}\\times\\cdots\\times\\tilde{\\mathcal{X}_d}\\)ï¼ŒåŒæ—¶å®šä¹‰ä¸€ä¸ªæ–°çš„éšæœºå˜é‡ï¼ˆå³æˆ‘ä»¬è§‚æµ‹åˆ°çš„å«æœ‰ç¼ºå¤±å€¼çš„æ—¶é—´åºåˆ—ï¼‰\\(\\tilde{\\mathbf{X}}=(\\tilde{X}_1,\\cdots,\\tilde{X}_d)\\in \\tilde{\\mathcal{X}}\\)ï¼š \\[ \\tilde{X}_i=\\begin{cases}X_i,&amp;\\text{if } M_i=1\\\\*,&amp;\\text{otherwise}\\end{cases} \\] å‡è®¾æ•°æ®é›†çš„å½¢å¼ä¸º\\(\\mathcal{D}=\\{(\\tilde{x}^i,m^i)\\}^n_{i=1}\\)ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ä»\\(P(\\mathbf{X}|\\tilde{\\mathbf{X}}=\\tilde{x}^i)\\)ä¸Šé‡‡æ ·æ¥å¯¹ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ã€‚ Model Architecture æ¨¡å‹çš„æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Generator ç”Ÿæˆå™¨çš„è¾“å…¥æœ‰ä¸‰é¡¹ï¼š\\(\\tilde{\\mathbf{X}}\\)ï¼Œ\\(\\mathbf{M}\\)å’Œéšæœºå™ªå£°\\(\\mathbf{Z}\\)ï¼Œè¾“å‡ºè®¾ä¸º\\(\\bar{\\mathbf{X}}\\)ã€‚è®¾ç”Ÿæˆå™¨ä¸ºæ˜ å°„\\(G: \\tilde{\\mathcal{X}}\\times\\{0,1\\}^d\\times[0,1]^d\\rightarrow \\mathcal{X}\\)ï¼Œè€Œ\\(\\mathbf{Z}\\)ä¸º\\(d\\)ç»´çš„é«˜æ–¯å™ªå£°ã€‚ç”Ÿæˆå™¨çš„è¾“å‡ºå’Œå¡«å……åçš„æ—¶é—´åºåˆ—å®šä¹‰ä¸ºï¼š \\[ \\begin{align} \\bar{\\mathbf{X}}&amp;=G(\\tilde{\\mathbf{X}},\\mathbf{M},(1-\\mathbf{M})\\odot\\mathbf{Z})\\\\ \\hat{\\mathbf{X}}&amp;=\\mathbf{M}\\odot\\tilde{\\mathbf{X}}+(1-\\mathbf{M})\\odot\\bar{\\mathbf{X}} \\end{align} \\] \\(\\bar{\\mathbf{X}}\\)å³ä¸ºç”Ÿæˆå™¨çš„ç›´æ¥è¾“å‡ºï¼Œå› ä¸ºå…¶å®æœ‰äº›éƒ¨åˆ†æ²¡æœ‰ç¼ºå¤±ï¼Œç”Ÿæˆå™¨è¿˜æ˜¯ä¼šä¸ºæ¯ä¸ªéƒ¨åˆ†è¾“å‡ºå€¼ã€‚ \\(\\hat{\\mathbf{X}}\\)ä¸ºå¡«å……åçš„æ—¶é—´åºåˆ—ï¼Œå¯¹äºç¼ºå¤±çš„éƒ¨åˆ†é‡‡ç”¨ç”Ÿæˆå™¨çš„è¾“å‡ºè¿›è¡Œå¡«å……ã€‚ Discriminator å’ŒåŸå§‹çš„GANä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ¤æ–­æ•´ä¸ªæ ·æœ¬æ˜¯çœŸå®çš„æˆ–è€…æ˜¯ç”Ÿæˆçš„ï¼Œè€Œæ˜¯éœ€è¦åˆ¤æ–­æ ·æœ¬çš„é‚£äº›éƒ¨åˆ†æ˜¯çœŸå®çš„æˆ–è€…æ˜¯ç”Ÿæˆçš„ï¼Œæ‰€ä»¥åˆ¤åˆ«å™¨ä¸ºæ˜ å°„\\(D: \\mathcal{X}\\rightarrow[0,1]^d\\)ã€‚åˆ¤åˆ«å™¨çš„å…·ä½“ç›®æ ‡å‡½æ•°å°†åœ¨åé¢è®¨è®ºã€‚ Hint Hintæ˜¯ä¸€ç§æç¤ºæœºå€¼ï¼Œæ˜¯ä¸€ä¸ªå’Œ\\(\\mathbf{X}\\)ç›¸åŒç»´åº¦çš„éšæœºå˜é‡\\(\\mathbf{H}\\)ï¼Œå…¶åˆ†å¸ƒä¾èµ–äº\\(\\mathbf{M}\\)ã€‚\\(\\mathbf{H}\\)æ˜¯ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰çš„ï¼Œç›¸å½“äºä¸€ç§ä¸å®Œæ•´çš„\\(\\mathbf{M}\\)ï¼Œç”¨æ¥ä½œä¸ºåˆ¤åˆ«å™¨çš„é¢å¤–è¾“å…¥ã€‚ Objective æˆ‘ä»¬è®­ç»ƒåˆ¤åˆ«å™¨æœ€å¤§åŒ–æ­£ç¡®é¢„æµ‹\\(\\mathbf{M}\\)çš„æ¦‚ç‡ï¼Œè€Œç”Ÿæˆå™¨æœ€å°åŒ–åˆ¤åˆ«å™¨æ­£ç¡®é¢„æµ‹\\(\\mathbf{M}\\)çš„æ¦‚ç‡ï¼Œç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š \\[ \\begin{align} V(D,G)=&amp;\\mathbb{E}_{\\hat{X},M,H}[\\mathbf{M}^T\\log D(\\hat{\\mathbf{X}},\\mathbf{H})\\\\&amp;+(1-\\mathbf{M})^T\\log(1-D(\\hat{\\mathbf{X}},\\mathbf{H}))] \\end{align} \\] æŒ‰ç…§æ ‡å‡†çš„GANå¯ä»¥å°†ä¼˜åŒ–å‡½æ•°å†™æˆä»¥ä¸‹çš„å½¢å¼ï¼š \\[ \\min_G\\max_D V(D,G) \\] åœ¨è¿™é‡Œåˆ¤åˆ«å™¨çš„ä»»åŠ¡å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªäºŒåˆ†ç±»ï¼Œè€Œç›®æ ‡å‡½æ•°å°±æ˜¯äºŒå€¼äº¤å‰ç†µçš„å®šä¹‰ï¼Œå› æ­¤å¯ä»¥å†™ä¸ºï¼š \\[ \\mathcal{L}(a,b)=\\sum\\limits_{i=1}^d[a_i\\log(b_i)+(1-a_i)\\log(1-b_i)] \\] \\(\\mathbf{M}\\)å¯ä»¥çœ‹ä½œGround Truthï¼Œè®°\\(\\hat{\\mathbf{M}}=D(\\hat{\\mathbf{X},\\mathbf{H}})\\)ï¼Œå³åˆ¤åˆ«å™¨è¾“å‡ºçš„é¢„æµ‹ï¼Œå› æ­¤ä¼˜åŒ–å‡½æ•°å¯ä»¥ç®€è®°ä¸ºï¼š \\[ \\min_G\\max_D\\mathbb{E}[\\mathcal{L}(\\mathbf{M},\\hat{\\mathbf{M}})] \\] GAIN Algorithm ä¸‹é¢è®¨è®ºGAINç®—æ³•çš„è®­ç»ƒæµç¨‹ã€‚ æœ¬æ–‡é€šè¿‡ç†è®ºè®¨è®ºï¼Œç»™å‡ºäº†ç”ŸæˆHint Vectorçš„ä¸€ä¸ªæ–¹æ³•ï¼Œé¦–å…ˆå®šä¹‰éšæœºå˜é‡\\(\\mathbf{B}=(B_1,\\cdots,B_d)\\in\\{0,1\\}^d\\)ï¼Œ\\(\\mathbf{B}\\)é€šè¿‡ä»\\(\\{1,\\cdots,d\\}\\)éšæœºå‡åŒ€é‡‡æ ·ä¸€ä¸ª\\(k\\)ï¼Œç„¶åç”±ä¸‹åˆ—å…¬å¼å¾—åˆ°ï¼š \\[ B_j=\\begin{cases}1, &amp;\\text{if }j\\neq k\\\\0, &amp;\\text{if }j=k\\end{cases} \\] å®šä¹‰ç©ºé—´\\(\\mathcal{H}=\\{0,0.5,1\\}^d\\)ï¼ŒHint Vectorä¸º\\(\\mathbf{H}=\\mathbf{B}\\odot\\mathbf{M}+0.5(1-\\mathbf{B})\\in\\mathcal{H}\\)ã€‚ åˆ¤åˆ«å™¨çš„è®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼šå›ºå®šç”Ÿæˆå™¨\\(G\\)ï¼Œå¯¹ä¸€ä¸ªå¤§å°ä¸º\\(k_D\\)çš„mini-batchï¼Œç‹¬ç«‹åŒåˆ†å¸ƒé‡‡æ ·\\(k_D\\)ä¸ª\\(z\\)å’Œ\\(b\\)ï¼Œç”¨æ¥è®¡ç®—\\(\\mathbf{Z}\\)å’Œ\\(\\mathbf{B}\\)ã€‚åˆ¤åˆ«å™¨çš„æŸå¤±å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š \\[ \\mathcal{L}_D(m,\\hat{m},b)=\\sum\\limits_{i:b_i=0}[m_i\\log(\\hat{m}_i)+(1-m_i)\\log(1-\\hat{m}_i)] \\] åˆ¤åˆ«å™¨çš„ä¼˜åŒ–å‡½æ•°ä¸ºï¼š \\[ \\min_D-\\sum\\limits_{j=1}^{k_D}\\mathcal{L}_D(m(j),\\hat{m}(j),b(j)) \\] å…¶ä¸­\\(\\hat{m}(j)=D(\\hat{x}(j),m(j))\\)ã€‚ åœ¨ä¼˜åŒ–äº†åˆ¤åˆ«å™¨ä¹‹åï¼Œéœ€è¦ä¼˜åŒ–ç”Ÿæˆå™¨ï¼Œå¯¹ä¸€ä¸ªå¤§å°ä¸º\\(k_G\\)çš„mini-batchï¼Œç”Ÿæˆå™¨çš„æŸå¤±å‡½æ•°åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯åœ¨ç¼ºå¤±éƒ¨åˆ†çš„æŸå¤±ï¼š \\[ \\mathcal{L}_G(m,\\hat{m},b)=-\\sum\\limits_{i:b_i=0}(1-m_i)\\log(\\hat{m}_i) \\] ä¸€ä¸ªæ˜¯æœªç¼ºå¤±éƒ¨åˆ†çš„æŸå¤±ï¼š \\[ \\mathcal{L}_M(x,x^\\prime)=\\sum\\limits_{i=1}^d m_iL_M(x_i,x_i^\\prime) \\] å…¶ä¸­ï¼š \\[ L_M(x_i,x_i^\\prime)=\\begin{cases}(x_i^\\prime-x_i)^2, &amp;\\text{if }x_i\\text{ is continuours},\\\\-x_i\\log(x_i^\\prime), &amp;\\text{if }x_i\\text{ is binary}.\\end{cases} \\] æœ€ç»ˆçš„ä¼˜åŒ–å‡½æ•°ä¸ºï¼š \\[ \\min_G\\sum\\limits_{j=1}^{k_G}\\mathcal{L}_G(m(j),\\hat{m}(j),b(j))+\\alpha\\mathcal{L}_M(\\tilde{x}(j),\\hat{x}(j)) \\] ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š Experiments ä¸‹è¡¨ä¸ºåœ¨5ä¸ªä¸åŒæ•°æ®é›†ä¸Šå®éªŒï¼Œä¸å…¶ä»–5ç§æ–¹æ³•å¯¹æ¯”çš„ç»“æœï¼š ä¸Šå›¾ä¸ºGAINã€MissForestå’ŒAutoencoderä¸‰ç§æ¨¡å‹åœ¨ä¸åŒç¼ºå¤±æ¯”ä¾‹ã€æ ·æœ¬æ•°é‡ã€ç‰¹å¾ç»´åº¦ä¸‹çš„å¯¹æ¯”æ›²çº¿å›¾ã€‚ ä¸‹è¡¨ä¸ºä½¿ç”¨ä¸åŒæ¨¡å‹å¯¹æ—¶é—´åºåˆ—è¿›è¡Œå¡«å……ä¹‹åï¼Œä½¿ç”¨é€»è¾‘å›å½’è¿›è¡Œå›å½’ä»»åŠ¡çš„æ€§èƒ½ï¼š ä¸‹å›¾ä¸ºGAINã€MissForestå’ŒAutoencoderä¸‰ç§æ¨¡å‹åœ¨ä¸åŒç¼ºå¤±æ¯”ä¾‹ä¸‹çš„AUROCæ›²çº¿å›¾ï¼š ä¸‹è¡¨å±•ç¤ºçš„æ˜¯ä½œè€…å¯¹æ—¶é—´åºåˆ—å¡«å……ç®—æ³•ä¿æŒç‰¹å¾-æ ‡ç­¾å…³ç³»çš„èƒ½åŠ›ã€‚ä½œè€…åˆ†åˆ«ç”¨å®Œæ•´çš„æ•°æ®å’Œå¡«å……åçš„æ•°æ®ç”¨é€»è¾‘å›å½’æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œå°†ä¸¤è€…çš„æƒé‡æ±‚ç»å¯¹å€¼å’Œå‡æ–¹æ ¹çš„ç»“æœã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Time Series Imputation","slug":"Research/Time-Series-Imputation","permalink":"http://qfxiao.me/categories/Research/Time-Series-Imputation/"}],"tags":[{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"},{"name":"GAN","slug":"GAN","permalink":"http://qfxiao.me/tags/GAN/"}]},{"title":"Anomaly Detection with Generative Adversarial Networks for Multivariate Time Series","slug":"Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series","date":"2019-09-22T14:32:18.000Z","updated":"2020-06-25T05:24:46.844Z","comments":true,"path":"2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/","link":"","permalink":"http://qfxiao.me/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/","excerpt":"","text":"Introduction è¿™ç¯‡æ–‡ç« æå‡ºäº†ä¸€ä¸ªåŸºäºGANçš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¨¡å‹ã€‚ åŸæ–‡ Contribution æå‡ºäº†åŸºäºGANçš„æ—¶é—´åºåˆ—æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹æ¨¡å‹ æˆ‘ä»¬ä½¿ç”¨åŸºäºLSTMçš„GANæ¥å¯¹å¤šå˜é‡æ—¶é—´åºåˆ—è¿›è¡Œå»ºæ¨¡ ç»“åˆä½¿ç”¨äº†Residual Losså’ŒDiscrimination Lossæ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­ Background Generative Adversarial Networks GANs In a Nutshell, an extremely simple explanation æˆ‘ä»¬æƒ³è¦ä»ä¸€ä¸ªå¤æ‚çš„ã€é«˜ç»´çš„æ•°æ®åˆ†å¸ƒ\\(p_r(x)\\)ä¸Šé‡‡æ ·å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ç‚¹ï¼Œç„¶è€Œ\\(p_r(x)\\)æ— æ³•ç›´æ¥æ±‚å¾— ä»£æ›¿æ–¹æ³•ï¼šä»ä¸€ä¸ªç®€å•çš„ã€å·²çŸ¥çš„åˆ†å¸ƒ\\(p_z(z)\\)ä¸Šé‡‡æ ·ï¼Œç„¶åå­¦ä¹ ä¸€ä¸ªTransformation \\(G(z): z\\rightarrow x\\)æ¥å°†\\(z\\)æ˜ å°„åˆ°\\(x\\) Training: Two-player Game Generator Network: ä»éšæœºåˆ†å¸ƒ\\(p_z(z)\\)é‡‡æ ·\\(z\\)ï¼Œé€šè¿‡æ˜ å°„ç”Ÿæˆæ ·æœ¬\\(x\\)ï¼Œè¿™ä¸ªç”Ÿæˆçš„æ ·æœ¬è¦å°½é‡â€œçœŸå®â€ã€‚æ€ä¹ˆâ€œçœŸå®â€ï¼Ÿä¼˜åŒ–ç”Ÿæˆå™¨å‚æ•°\\(\\theta_G\\)æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†å³å¯ Discriminator Network: æ¥å—ä¸€ä¸ªæ ·æœ¬\\(x\\)ï¼Œåˆ¤æ–­å…¶æ˜¯ç”Ÿæˆçš„æ ·æœ¬è¿˜æ˜¯çœŸå®çš„æ ·æœ¬ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œæˆ‘ä»¬æ˜¯çŸ¥é“ä¸€ä¸ªæ ·æœ¬\\(x\\)åˆ°åº•æ˜¯ç”Ÿæˆçš„è¿˜æ˜¯çœŸå®çš„ï¼Œæ‰€ä»¥ä¼˜åŒ–åˆ¤åˆ«å™¨å‚æ•°\\(\\theta_D\\)æœ€å°åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†ï¼Œæœ€å¤§åŒ–å¯¹çœŸå®æ ·æœ¬çš„è¯„åˆ†ï¼ˆå³æœ€å¤§åŒ–åˆ†è¾¨çœŸå®æ ·æœ¬çš„èƒ½åŠ›ï¼‰ å½¢å¼åŒ–çš„æ¥è®²ï¼Œä¼˜åŒ–å‡½æ•°å¦‚ä¸‹ï¼š \\[\\min\\limits_{\\theta_G}\\max\\limits_{\\theta_D}V(G,D)=\\mathbb{E}_{x\\sim p_{data}(x)\\log(\\underbrace{D_{\\theta{D}}(x)}_{åˆ¤åˆ«å™¨å¯¹çœŸå®æ ·æœ¬çš„è¯„åˆ†})}+\\mathbb{E}_{z\\sim p_z(z)}\\log(1-\\underbrace{D_{\\theta_d}(G_{\\theta_G}(z))}_{åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†})\\] è®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š Long Short Time Memory Networks Vanilla Recurrent Neural Networks æ™®é€šçš„ç¥ç»ç½‘ç»œï¼š æ¦‚æ‹¬çš„æ¥è®²ï¼Œå¯ä»¥æ¶µç›–ä¸ºä¸€ä¸ªå…¬å¼\\(\\hat{\\mathbf{y}}=f(\\mathbf{x})\\)ã€‚å¯¹äºä¸€ä¸ªæ ·æœ¬\\(\\mathbf{x}\\)ï¼Œé€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œæ˜ å°„ï¼Œè¾“å‡º\\(\\mathbf{y}\\)ã€‚ å¯¹äºRNNï¼Œæˆ‘ä»¬å¤„ç†çš„æ˜¯åºåˆ—æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰æ ·æœ¬ä¹‹é—´å¹¶ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚å¯¹äºä¸€ä¸ªåºåˆ—ä¸­çš„ä¸€ä¸ªæ ·æœ¬\\(x_t\\in\\{x_1,x_2,\\cdots,x_n\\}\\)ï¼Œå°†å…¶è¾“å…¥åˆ°ç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œä¸ºäº†å»ºæ¨¡\\(x_t\\)ä¹‹å‰çš„å­åºåˆ—å¯¹\\(x_t\\)çš„å½±å“å…³ç³»ï¼Œéœ€è¦å°†è¿™ä¸ªå­åºåˆ—çš„ä¿¡æ¯ä¹Ÿè¾“å…¥åˆ°ç¥ç»ç½‘ç»œä¸­ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿä¸ºæ¯ä¸€ä¸ªæ ·æœ¬ç‚¹ä¿å­˜ä¸€ä¸ªStateã€‚å³å®šä¹‰\\(h_t=g(\\hat{y_t})=g(f(x_t))\\)ï¼Œå¯¹äºå½“å‰æ ·æœ¬ç‚¹ï¼Œ\\(\\hat{y_t}=f(x_t,h_{t-1})\\)ã€‚ä¹Ÿå°±æ˜¯è¯´ç¥ç»ç½‘ç»œçš„è¾“å…¥ä¸ä»…åŒ…å«äº†å½“å‰æ ·æœ¬ç‚¹çš„ç‰¹å¾ï¼Œä¹ŸåŒ…å«äº†ä¸Šä¸€ä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€(ä¸Šä¸€ä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€åˆéšå«äº†ä¸Šä¸Šä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€...)ï¼Œå°±åƒæ˜¯ä¸ºç½‘ç»œåŠ ä¸Šäº†çŸ­æœŸè®°å¿†ã€‚ Gradient Flow of Vanilla RNN ä¸‹é¢æ¥è¿›è¡Œä¸€äº›å½¢å¼åŒ–çš„å®šä¹‰ï¼Œå‡è®¾åœ¨æ—¶åˆ»\\(t\\)ç½‘ç»œè¾“å…¥ç‰¹å¾ä¸º\\(x_t\\)ï¼Œè¾“å‡ºéšå«çŠ¶æ€ä¸º\\(h_{t}\\)ï¼Œå…¶ä¸ä»…å’Œå½“å‰è¾“å…¥\\(x_t\\)æœ‰å…³ï¼Œè¿˜å’Œä¸Šä¸€ä¸ªéšå«çŠ¶æ€\\(h_{t-1}\\)æœ‰å…³ï¼š å½“å‰æ—¶åˆ»æ€»çš„å‡€è¾“å…¥\\(z_t=Uh_{t-1}+Wx_t+b\\) å½“å‰æ—¶åˆ»è¾“å‡ºéšå«çŠ¶æ€\\(h_t=f(z_t)\\) å½“å‰æ—¶åˆ»è¾“å‡º\\(\\hat{y}_t=Vh_t\\) RNNçš„æ¢¯åº¦æ›´æ–°å…¬å¼(æ¨å¯¼è¿‡ç¨‹æ¯”è¾ƒå¤æ‚)ï¼š \\[\\frac{\\partial{\\mathcal{L}}}{\\partial U}=\\sum\\limits_{t=1}^T\\sum\\limits_{k=1}^t \\delta_{t,k}\\mathbf{h}_{k-1}^T\\] \\[\\frac{\\partial{\\mathcal{L}}}{\\partial{W}}=\\sum\\limits_{t=1}^T\\sum\\limits_{k=1}^t \\delta_{t,k}x_k^T\\] \\[\\frac{\\partial\\mathcal{L}}{\\partial{b}}=\\sum\\limits_{t=1}^T\\sum\\limits_{k=1}^t\\delta_{t,k}\\] å…¶ä¸­\\(\\delta_{t,k}=\\frac{\\partial{\\mathcal{L}}}{\\partial{z_k}}=\\text{diag}(f^\\prime(z_k))U^T\\delta_{t,k+1}\\)å®šä¹‰ä¸ºç¬¬\\(t\\)æ—¶åˆ»çš„æŸå¤±å¯¹ç¬¬\\(k\\)æ—¶åˆ»éšè—ç¥ç»å±‚çš„å‡€è¾“å…¥\\(z_k\\)çš„å¯¼æ•°ï¼Œä¸”\\(z_k=Uh_{k-1}+Wx_k+b,1\\leq k&lt;t\\)ã€‚ RNNçš„æ¢¯åº¦æµå‘å¦‚ä¸‹å›¾çº¢ç®­å¤´æ‰€ç¤ºï¼š RNNä¼šé‡åˆ°æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚æ ¹æ®å‰é¢çš„å…¬å¼ï¼Œ\\(\\delta_{t,k}\\)å®é™…ä¸Šæ˜¯é€’å½’å®šä¹‰çš„ï¼Œå±•å¼€å¾—åˆ°ï¼š \\[\\delta_{t,k}=\\prod\\limits_{\\tau=k}^{t-1}(\\text{diag}(f^\\prime(z_\\tau))U^T)\\delta_{t,t}\\] å¦‚æœå®šä¹‰\\(\\gamma\\cong\\parallel\\text{diag}(f^\\prime(z_\\tau))U^T\\parallel\\)ï¼Œé‚£ä¹ˆ\\(\\delta_{t,k}\\cong\\gamma^{t-k}\\delta_{t,t}\\)ã€‚åœ¨\\(t-k\\)å¾ˆå¤§æ—¶ï¼Œ\\(\\gamma&lt;1\\)ä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼Œ\\(\\gamma&gt;1\\)æ—¶ä¼šå¯¼è‡´æ¢¯åº¦çˆ†ç‚¸ã€‚ Long Short Time Memory LSTMæ˜¯ä¸€ç§è§£å†³RNNæ¢¯åº¦æ¶ˆå¤±é—®é¢˜çš„æ”¹è¿›ç‰ˆæœ¬ï¼š åœ¨LSTMä¸­ï¼Œç»´æŠ¤äº†ä¸¤ä¸ªStateï¼Œ\\(c_t\\)å’Œ\\(h_t\\)ã€‚å…¶ä¸­\\(c_t\\)ç”±é—å¿˜é—¨\\(f\\)ä¸ä¸Šä¸€ä¸ª\\(c_{t-1}\\)ç›¸ä¹˜(ä»£è¡¨ç»§æ‰¿ä¸Šä¸€ä¸ªCellçš„ä¿¡æ¯å¹¶åŠ ä»¥ä¸€å®šç¨‹åº¦çš„é—å¿˜)ï¼ŒåŠ ä¸Šè¾“å‡ºé—¨\\(i\\)ä¸Gate Gate \\(g\\)ç›¸ä¹˜(Gate Gateä»£è¡¨å½“å‰çš„å€™é€‰çŠ¶æ€ï¼Œè¾“å‡ºé—¨\\(i\\)æ§åˆ¶å½“å‰å€™é€‰çŠ¶æ€æœ‰å¤šå°‘ä¿¡æ¯éœ€è¦ä¿å­˜)ã€‚æœ€åï¼Œè¾“å‡ºé—¨\\(o\\)æ§åˆ¶å½“å‰æ—¶åˆ»çš„Cell State \\(c_t\\)æœ‰å¤šå°‘ä¿¡æ¯éœ€è¦è¾“å‡ºç»™å¤–éƒ¨çŠ¶æ€\\(h_t\\)ã€‚ ä¸‰ä¸ªé—¨çš„è®¡ç®—æ–¹å¼ä¸ºï¼š \\[i_t=\\sigma(W_ix_t+U_ih_{t-1}+b_i)\\] \\[f_t=\\sigma(W_fx_t+U_fh_{t-1}+b_f)\\] \\[o_t=\\sigma(W_ox_t+U_oh_{t-1}+b_o)\\] Methodology æ€»ä½“æ¡†æ¶å›¾å¦‚Fig 1æ‰€ç¤ºï¼š GAN with LSTM-RNN ç½‘ç»œç»“æ„ä¸Šç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨éƒ½æ˜¯LSTMï¼Œä¼˜åŒ–å‡½æ•°å’Œæ™®é€šGANä¸€æ ·ï¼š \\[\\min\\limits_G\\max\\limits_D V(D,G)=\\mathbb{E}_{x\\sim p_{data}(x)}[\\log D(x)]+\\mathbb{E}_{z\\sim p_z(z)}[\\log (1-D(G(z)))]\\] GAN-based Anomaly Score åœ¨æµ‹è¯•é˜¶æ®µï¼Œéœ€è¦ä½¿ç”¨æ¢¯åº¦ä¼˜åŒ–å¯»æ‰¾ä¸€ä¸ªä½¿å¾—\\(G_{rnn}(z)\\)æœ€æ¥è¿‘\\(X^{test}\\)çš„\\(z^k\\)ï¼š \\[\\min\\limits_{Z^k}Error(X^{test},G_{rnn}(Z^k))=1-Similarity(X^{test},G_{rnn}(Z^k))\\] æœ¬æ–‡å®šä¹‰äº†ä¸¤ç§Anomaly Scoreï¼Œä¸€ç§æ˜¯Residual Lossï¼š \\[Res(X^{test}_t)=\\sum\\limits_{i=1}^n|x^{test,i}_t-G_{rnn}(Z^{k,i}_t)|\\] ä¸€ç§æ˜¯Discrimination Lossï¼Œå³åˆ¤åˆ«å™¨çš„è¾“å‡º\\(D_{rnn}(x_t^{test})\\)ã€‚ æ€»çš„Anomaly Scoreï¼š \\[S^{test}_t=\\lambda Res(X^{test}_t)+(1-\\lambda)D_{rnn}(x^{test}_t)\\] Anomaly Detection Framework æ¨¡å‹çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š ç”±äºæœ¬æ–‡æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—é¢„æµ‹ï¼Œè€Œä¸”æ—¶é—´åºåˆ—çš„é•¿åº¦æœ‰å¯èƒ½æ¯”è¾ƒé•¿ï¼Œä½œè€…ä½¿ç”¨äº†æ»‘åŠ¨çª—å£å’ŒPCAæ¥è¿›è¡Œé¢„å¤„ç†ã€‚ Experiments","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://qfxiao.me/tags/Machine-Learning/"},{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"}]},{"title":"ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection","slug":"ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection","date":"2019-09-22T14:29:18.000Z","updated":"2020-06-24T07:48:38.792Z","comments":true,"path":"2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/","link":"","permalink":"http://qfxiao.me/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/","excerpt":"","text":"Introduction æœ¬æ–‡é’ˆå¯¹é¢å‘åŒºé—´çš„KPIå¼‚å¸¸æ£€æµ‹æå‡ºäº†Label Screeningæ–¹æ³•å’ŒRelearning Algorithm. åŸæ–‡ Contribution æå‡ºäº†ä¸€ç§Label Screeningæ–¹æ³•æ¥å¯¹åŒºé—´å†…ä¸åŒé‡è¦æ€§è¿›è¡Œè¿‡æ»¤ æå‡ºäº†ä¸€ç§Relearning Algorithmæ¥å¯¹FPå’ŒTPè¿›è¡ŒRelearningï¼Œåœ¨ä¸å‡å°‘Recallçš„æ¡ä»¶ä¸‹å¢å¤§Precision Methodology Overall Structure ç®—æ³•çš„æ•´ä½“æ¡†æ¶å¦‚ä¸‹ï¼š Label Screening Model é¢„è®­ç»ƒçš„ç»“æœè¢«åˆ†ä¸º\\(TP_{po},FP_{po},TN_{po},FN_{po}\\)å››ç±»ï¼Œ\\(TP_{po}\\)å’Œ\\(FN_{po}\\)å¯ä»¥è¢«ç»†åˆ†å¦‚ä¸‹ï¼š \\[ \\begin{align}TP_{po}&amp;=TP_{po,withinT}+TP_{po,afterT}\\\\&amp;=TP_{po,withinT}+TP_{po,afterT,tpl}+TP_{po,after,fnl}\\end{align} \\] \\[ \\begin{align}FN_{po}&amp;=FN_{po,withinT}+FN_{po,afterT}\\\\&amp;=FN_{po,withinT,tpl}+FN_{po,,withinT,fnl}+FN_{po,afterT,tpl}+FN_{po,afterT,fnl}\\end{align} \\] å…¶ä¸­ä¸‹æ ‡\\({}_{withinT}\\)ä»£è¡¨åœ¨å¼‚å¸¸ç‰‡æ®µç¬¬ä¸€ä¸ªç‚¹\\(T\\)è·ç¦»å†…çš„æ‰€æœ‰ç‚¹ï¼Œä¸‹æ ‡\\({}_{afterT}\\)ä»£è¡¨\\(T\\)è·ç¦»ä¹‹åã€‚ä¸‹æ ‡\\({}_{tpl}\\)å’Œ\\({}_{fnl}\\)åˆ†åˆ«ä»£è¡¨åœ¨å¼‚å¸¸ç‰‡æ®µä¸­ï¼ŒåŒ…å«å’Œä¸åŒ…å«\\(TP_{po,withinT}\\)çš„ç‚¹ã€‚ ä»¥TPä¸ºä¾‹ï¼ŒPoint-basedçš„TPåŒ…å«äº†åœ¨TèŒƒå›´ä¹‹å†…çš„ï¼ˆå³åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯TPçš„ç‚¹ï¼‰å’ŒTèŒƒå›´ä¹‹å¤–çš„ç‚¹ï¼ˆå³åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¸è®¤ä¸ºæ˜¯TPçš„ç‚¹ï¼‰ã€‚è€Œåœ¨TèŒƒå›´ä¹‹å¤–çš„ç‚¹åˆå¯ä»¥ç»†åˆ†ä¸ºè¯¥å¼‚å¸¸ç‰‡æ®µæ˜¯å¦åŒ…å«\\(TP_{po,withinT}\\)çš„ç‚¹ï¼ˆå³è¯¥ç‚¹åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¸ä¼šè¢«åˆ¤å®šä¸ºTPï¼Œä½†è¯¥å¼‚å¸¸ç‰‡æ®µæœ‰å…¶ç‚¹ä¼šè¢«åˆ¤å®šä¸ºTPï¼‰ã€‚ ç±»ä¼¼çš„ï¼Œ\\(TP_{io}\\)å’Œ\\(FN_{io}\\)å¯ä»¥è¢«åˆ†è§£ä¸ºï¼š \\[ \\begin{align}TP_{io}&amp;=TP_{po,withinT}+TP_{po,afterT,tpl}+FN_{po,withinT,tpl}+FN_{po,afterT,tpl}\\\\&amp;=TP_{po}+FN_{po,withinT,tpl}+FN_{po,afterT,tpl}-TP_{po,afterT,fnl}\\end{align} \\] \\[ \\begin{align}FN_{io}&amp;=FN_{po,withinT,fnl}+FN_{po,afterT,fnl}+TP_{po,afterT,fnl}\\\\&amp;=FN_{po}+TP_{po,afterT,fnl}-FN_{po,withinT,tpl}-FN_{po,afterT,tpl}\\end{align} \\] æ–‡ä¸­å¯¹è¯¥éƒ¨åˆ†çš„åˆ†æå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š åœ¨Interval-orientedçš„æ ‡å‡†ä¸­ï¼Œ\\(FN_{po,tpl}\\)çš„ç‚¹ä»ä¼šè¢«è®¤ä¸ºæ˜¯\\(TP_{io}\\)ï¼Œè€Œ\\(TP_{po,afterT}\\)ï¼ˆä¸å¸¦\\({}_{tpl}\\)ï¼‰ä¸ä¼šè¢«è®¤ä¸ºæ˜¯\\(TP_{io}\\)ï¼Œæ‰€ä»¥æœ€ç»ˆ\\(TP_{io}\\)ç”±æ‰€æœ‰\\(TP_{po}\\)åŠ ä¸Šé‚£äº›ä¼šè¢«è®¤ä¸ºæ˜¯\\(TP_{io}\\)çš„\\(FN_{po,tpl}\\)å†å»æ‰ä¸å¸¦\\({}_{tpl}\\)çš„\\(TP_{po,afterT}\\)ç»„æˆï¼Œå³å…¬å¼(6) åŒæ—¶ï¼Œæ ¹æ®å…¬å¼(6)ï¼Œå¦‚æœ\\(TP_{po}\\)å˜ä¸º\\(FN_{po,tpl}\\)ï¼Œä¹Ÿä¸ä¼šå¯¹æœ€ç»ˆç»“æœé€ æˆå½±å“ã€‚ä½†æ˜¯æ ¹æ®å…¬å¼(5)å’Œå…¬å¼(7)ï¼Œ\\(TP_{po,withinT}\\)å˜æˆ\\(FN_{po,withinT,fnl}\\)ä¼šå‡å°\\(TP_{io}\\)åŒæ—¶å¢å¤§\\(FN_{io}\\) æ–‡ç« æŒ‡å‡ºï¼Œè™½ç„¶\\(FN_{po,withinT,tpl}\\)å’Œ\\(FN_{po,afterT,tpl}\\)æœ€åéƒ½ä¼šè¢«è®¤ä¸ºæ˜¯\\(TP_{io}\\)ï¼Œä½†ä½œè€…å‡è®¾\\(FN_{po,withinT,tpl}\\)æ›´éš¾æ£€æµ‹ï¼Œæ‰€ä»¥åº”è¯¥ä¿ç•™ï¼Œè€Œ\\(FN_{po,afterT,tpl}\\)åº”è¯¥å‰Šå‡ Label Screeningæ–¹æ³•å»é™¤äº†\\(FN_{po,afterT}\\)çš„ç‚¹ Screenedä¹‹åçš„è®­ç»ƒé›†è¢«ç”¨æ¥è®­ç»ƒDNNä¸»æ¨¡å‹ï¼Œä½†Label Screeningçš„é¢„æµ‹ç»“æœä¹Ÿä¼šè¢«ä¿ç•™ï¼Œå’ŒDNNä¸»æ¨¡å‹çš„ç»“æœè¿›è¡Œç»„åˆ ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š Relearning Algorithm Relearning Modelçš„è¾“å…¥æ˜¯DNNä¸»æ¨¡å‹é¢„æµ‹å‡ºæ¥çš„å¼‚å¸¸ï¼Œå…¶ä¸­åŒ…æ‹¬TPå’ŒFPã€‚Relearning Modelé‡‡ç”¨çš„æ˜¯éšæœºæ£®æ—ï¼Œå…¶è¾“å…¥çš„æ ·æœ¬é€šè¿‡é‡‡æ ·å¾—åˆ°ï¼š \\[ \\begin{align} \\text{relearning}\\space&amp;\\text{training set}=\\\\&amp; shuffle\\{4C\\ast\\text{randomof}(TP_{po})\\\\&amp;+C\\cdot\\text{randomof}(FP_{po})+C\\cdot\\text{randomof}(TN_{po})\\} \\end{align} \\] å…¶ä¸­\\(C\\)ä¸ºå¸¸æ•°ã€‚TNå’ŒFPéƒ½çœ‹ä½œæ˜¯è´Ÿä¾‹(æ­£å¸¸æ ·æœ¬)ï¼ŒTPçœ‹ä½œæ˜¯æ­£ä¾‹ã€‚ Detection å¯¹äºä¸€ä¸ªæ»‘åŠ¨çª—å£\\(x_t=\\{x_{t-w+1},\\cdots,x_t\\}\\)ï¼Œå¼‚å¸¸æ£€æµ‹ç®—æ³•çš„ç›®æ ‡æ˜¯è¾“å‡ºæ£€æµ‹ç»“æœ\\(y_t\\in\\{0,1\\}\\)æ¥è¡¨ç¤ºæ—¶é—´\\(t\\)æ˜¯å¦å‘ç”Ÿå¼‚å¸¸ã€‚å®é™…ä¸Šç®—æ³•è¾“å‡ºçš„æ˜¯\\(p_{y_t}\\in[0,1]\\)æ¦‚ç‡å€¼æ¥è¡¨ç¤ºåœ¨æ—¶é—´\\(t\\)å‘ç”Ÿå¼‚å¸¸çš„æ¦‚ç‡ã€‚æ–‡ä¸­ä¸‰ä¸ªæ¨¡å‹ä¼šå¾—åˆ°ä¸‰ä¸ªè¾“å‡ºï¼š\\(y_{t,ls},y_{t,main},y_{t,re}\\)ã€‚æœ€ç»ˆç»“æœä¸ºï¼š \\[ y_t=y_{t,ls}\\space\\&amp;\\space y_{t,main}\\space\\&amp; \\space y_{t,re} \\] åœ¨ç»˜åˆ¶PRæ›²çº¿æ—¶ï¼Œé‡‡ç”¨çš„å…¬å¼ä¸ºï¼š \\[ \\begin{align} p_{y_t}(th)=&amp;(1-sig(p_{y_t,ls},th))\\cdot(p_{y_t,ls})\\\\ &amp;+sig(p_{y_t,ls},th)\\cdot(1-sig(p_{y_t,main},th))\\cdot p_{y_t,main}\\\\ &amp;+sig(p_{y_t,ls},th)\\cdot sig(p_{y_t,main},th)\\cdot p_{y_t,re}\\\\ \\end{align} \\] \\[ y_t(th)=sig(p_{y_t}(th),th) \\] ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š Experiments Datasets æ¸…åAIOpsæ•°æ®é›†ï¼Œé€‰å–äº†25æ¡KPIã€‚ Preprocessing Missing Data. å»é™¤ã€‚ Standardization. Minmax Standardizationï¼ŒFeature Extractionä½¿ç”¨çš„æ˜¯Standardizationåçš„æ•°æ®ã€‚ Feature Extraction. ä½¿ç”¨äº†12ç§ç‰¹å¾ã€‚ Group Feature Name Values The original values standardized Statistical Features Mean, Standard Deviation, Range, Difference... Fitting Features EWMA, AR Wavelet Features Db2 wavelet decomposition Results AUCPR F1 Remark è¿™ç¯‡æ–‡ç« çš„Label Screeningæ–¹æ³•å®é™…ä¸Šæ˜¯åœ¨å¤„ç†æ ·æœ¬åˆ†ç±»éš¾æ˜“åº¦çš„é—®é¢˜ï¼Œå°†å¼‚å¸¸åŒºé—´å†…å®¹æ˜“çš„æ ·æœ¬å»é™¤äº† å¯¹äºæ—¶é—´åºåˆ—çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¸€èˆ¬æ˜¯Point-basedçš„å¼‚å¸¸æ ‡ç­¾ï¼Œä¸€ä¸ªæ—¶é—´ç‚¹çš„ç‰¹å¾æ˜¯æœ‰é™çš„ã€‚å¦‚æœç”¨çª—å£çš„æ–¹å¼ï¼Œä»¥\\(\\{x_{t-w+1},\\cdots,x_t\\}\\)ä½œä¸ºæ—¶é—´\\(t\\)çš„è¾“å…¥ï¼ˆå½“ç„¶æ¯ä¸ª\\(x_t\\)å¯ä»¥æœ‰å¤šä¸ªChannelï¼‰ï¼Œç„¶åæŠŠé¢„æµ‹ç»“æœä½œä¸ºæ—¶é—´\\(t\\)çš„è¾“å‡º","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://qfxiao.me/tags/Machine-Learning/"},{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"}]},{"title":"Unsupervised Anomaly Detection via Variational Auto-Encoder for Seasonal KPIs in Web Applications","slug":"Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications","date":"2019-09-22T12:35:18.000Z","updated":"2020-06-25T09:11:13.347Z","comments":true,"path":"2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/","link":"","permalink":"http://qfxiao.me/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/","excerpt":"","text":"Abstract æœ¬æ–‡æå‡ºäº†Donutï¼Œä¸€ä¸ªåŸºäºVAEçš„æ— ç›‘ç£æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿã€‚ åŸæ–‡ Contribution Donutä¸­ä½¿ç”¨åˆ°äº†ä¸‰ä¸ªæŠ€å·§ï¼ŒåŒ…æ‹¬æ”¹è¿›åçš„ELBOã€ç¼ºå¤±æ•°æ®æ³¨å…¥å’ŒMCMCæ’å€¼ï¼› æå‡ºåŸºäºVAEçš„å¼‚å¸¸æ£€æµ‹è®­ç»ƒæ—¢éœ€è¦æ­£å¸¸æ ·æœ¬ä¹Ÿéœ€è¦å¼‚å¸¸æ ·æœ¬ï¼› å¯¹Donutæå‡ºäº†åœ¨z-ç©ºé—´ä¸­åŸºäºKDEçš„ç†è®ºè§£é‡Šã€‚ Background Anomaly Detection å¯¹äºä»»æ„æ—¶é—´\\(t\\)ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼\\(x_{t-T+1},\\cdots,x_t\\)ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º\\(y_t=1\\))ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚\\(p(y_t=1|x_{t-T+1},\\cdots,x_t)\\)ã€‚ Methodology Problem Statement æœ¬æ–‡çš„ç›®çš„æ˜¯åŸºäºæ·±åº¦ç”Ÿæˆç½‘ç»œå¼€å‘å…·æœ‰ç†è®ºè§£é‡Šæ€§çš„æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œå¹¶ä¸”åœ¨æœ‰æ ‡ç­¾çš„æƒ…å†µä¸‹èƒ½åˆ©ç”¨æ ‡ç­¾ä¿¡æ¯æå‡æ€§èƒ½ã€‚æœ¬æ–‡åŸºäºVAEæ¥æ„å»ºæ¨¡å‹ã€‚ Network Structure ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸€å…±åŒ…å«äº†é¢„å¤„ç†ã€è®­ç»ƒå’Œæ£€æµ‹ä¸‰ä¸ªéƒ¨åˆ†ã€‚ ä¸‹å›¾ä¸ºæ¨¡å‹çš„æ¦‚ç‡å›¾æ¨¡å‹ï¼š å›¾ä¸­åŒå®çº¿çš„æ¡†ä¸ºæœ¬æ–‡æ¨¡å‹æœ‰åˆ«äºä¼ ç»ŸVAEçš„åœ°æ–¹ï¼Œå…¶ä½™åœ°æ–¹å’ŒVAEä¸€æ ·ã€‚å…ˆéªŒæ¦‚ç‡\\(p_\\theta(z)\\)é€‰ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ\\(\\mathcal{N}(0,I)\\)ï¼ŒåéªŒæ¦‚ç‡\\(x\\)å’Œ\\(z\\)éƒ½æ˜¯å¯¹è§’åŒ–é«˜æ–¯åˆ†å¸ƒï¼Œå³\\(p_\\theta(x|z)=\\mathcal{N}(\\mu_x,\\sigma_x^2 I),q_\\phi(z|x)=\\mathcal{N}(\\mu_z,\\sigma_z^2 I)\\)ã€‚å¦‚Figure 4æ‰€ç¤ºï¼Œæ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œä¸­åˆ†åˆ«éƒ½æœ‰éšå«å±‚\\(f_\\phi(x)\\)å’Œ\\(f_\\theta(z)\\)å¯¹ç½‘ç»œçš„è¾“å…¥è¿›è¡Œç‰¹å¾æŠ½å–ã€‚é«˜æ–¯åˆ†å¸ƒçš„å‚æ•°å³ä»è¿™äº›æŠ½å–å‡ºæ¥çš„ç‰¹å¾ä¸Šå¾—åˆ°ã€‚å‡å€¼é€šè¿‡çº¿æ€§å±‚å¾—åˆ°ï¼š\\(\\mu_x=W^T_{\\mu_x}f_\\theta(z)+b_{\\mu_x}, \\mu_z=W^T_{\\mu_z}f_\\theta(x)+b_{\\mu_z}\\)ã€‚æ ‡å‡†å·®é€šè¿‡Soft Pluså±‚åŠ ä¸€ä¸ªé«˜æ–¯å™ªå£°å¾—åˆ°ï¼š\\(\\sigma_x=\\text{SoftPlus}[W^T_{\\sigma_x}f_\\theta(z)+b_{\\sigma_x}]+\\varepsilonï¼Œ\\sigma_x=\\text{SoftPlus}[W^T_{\\sigma_z}f_\\theta(x)+b_{\\sigma_z}]+\\varepsilon\\)ã€‚ æ–‡ä¸­æåˆ°å› ä¸ºKPIçš„å±€éƒ¨æ–¹å·®éå¸¸å°ï¼Œæ‰€ä»¥é‡‡ç”¨ç›´æ¥å»ºæ¨¡\\(\\sigma_x,\\sigma_z\\)çš„æ–¹å¼è€Œä¸æ˜¯é‡‡ç”¨å¯¹æ•°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸ºäº†ç†è®ºä¸Šçš„è§£é‡Šæ€§ï¼Œæ–‡ä¸­çš„ç¥ç»ç½‘ç»œåªä½¿ç”¨äº†å…¨è¿æ¥å±‚ã€‚ Training è®­ç»ƒå¯ä»¥ç›´æ¥é‡‡ç”¨ç»å…¸çš„SGVBæ¥ä¼˜åŒ–ELBOï¼š \\[ \\begin{align} \\log p_\\theta(x)&amp;\\geq\\log p_\\theta(x)-\\text{KL}[q_\\phi(z|x)\\parallel p_\\theta(z|x)]\\\\ &amp;=\\mathcal{L}\\\\ &amp;=\\mathbb{E}_{q_\\phi(z|x)}[\\log p_\\theta(x)+\\log p_\\theta(z|x)-\\log q_\\phi(z|x)]\\\\ &amp;=\\mathbb{E}_{q_\\phi(z|x)}[\\log p_\\theta(x,z)-\\log q_\\phi(z|x)]\\\\ &amp;=\\mathbb{E}_{q_\\phi(z|x)}[\\log p_\\theta(x|z)+\\log p_\\theta(z)-\\log q_\\phi(z|x)] \\end{align} \\] ä½†æ˜¯åœ¨å®é™…çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè®­ç»ƒæ•°æ®éœ€è¦ä¿è¯éƒ½æ˜¯æ­£å¸¸æ ·æœ¬ï¼Œä½†å®é™…ä¸Šè®­ç»ƒæ ·æœ¬æœ‰å¯èƒ½ä¼šåŒ…å«å¼‚å¸¸æˆ–è€…æ˜¯ç¼ºå¤±å€¼ã€‚ä¸€ç§åšæ³•æ˜¯ç”¨ç¼ºå¤±å€¼å¡«å……çš„ç®—æ³•æ¥å¡«å……è¿™äº›å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼ï¼Œä½†ä½œè€…è®¤ä¸ºä½¿ç”¨ç¼ºå¤±å€¼å¡«å……ç®—æ³•å¹¶ä¸èƒ½å¾ˆå¥½çš„è¿˜åŸæ•°æ®çš„æ­£å¸¸æ¨¡å¼ï¼Œä»è€Œä¿è¯ç®—æ³•çš„æœ‰æ•ˆæ€§ã€‚åœ¨æ–‡ä¸­ä½œè€…é‡‡ç”¨äº†ä¿®æ”¹ELBOçš„æ–¹æ³•ï¼Œå¹¶å°†å…¶ç§°ä¹‹ä¸ºModified ELBO (M-ELBO)ï¼Œå…¬å¼å¦‚ä¸‹ï¼š \\[ \\tilde{\\mathcal{L}}=\\mathbb{E}_{q_\\phi(z|x)}[\\sum\\limits_{w=1}^W{\\alpha_w\\log p_\\theta(x_w|z)+\\beta\\log p_\\theta(z)-\\log q_\\phi(z|x)}] \\] å…¶ä¸­\\(\\alpha_w\\)ä¸ºæŒ‡ç¤ºæ ‡è®°ï¼Œ\\(\\alpha_w=1\\)ä»£è¡¨ä¸æ˜¯å¼‚å¸¸ä¹Ÿä¸æ˜¯ç¼ºå¤±ã€‚\\(\\beta\\)å®šä¹‰ä¸º\\(\\beta=\\frac{\\sum_{w=1}^W\\alpha_w}{W}\\)ã€‚ åœ¨M-ELBOä¸­ï¼Œå¼‚å¸¸æˆ–ç¼ºå¤±å€¼å¯¹åº”çš„\\(\\log p_\\theta(x_w|z)\\)çš„è´¡çŒ®ä¼šè¢«æ’é™¤ï¼ŒåŒæ—¶\\(\\log p_\\theta(z)\\)åœ¨ä¹˜ä»¥\\(\\beta\\)åä¼šç›¸åº”ç¼©å°ã€‚ä½œè€…æ²¡æœ‰ä¿®æ”¹\\(\\log q_\\phi(z|x)\\)è¿™ä¸€é¡¹çš„åŸå› æœ‰äºŒï¼šä¸€æ˜¯\\(q_\\phi(z|x)\\)ä»…ä»…æ˜¯ä»\\(x\\)åˆ°\\(z\\)çš„æ˜ å°„ï¼Œå¹¶ä¸éœ€è¦è€ƒè™‘â€œæ­£å¸¸æ¨¡å¼â€ï¼›äºŒæ˜¯\\(\\mathbb{E}_{q_\\phi(z|x)}[-\\log q_\\phi(z|x)]\\)å°±æ˜¯\\(q_\\phi(z|x)\\)çš„ç†µï¼Œè€Œè¿™ä¸ªåœ¨åé¢çš„ç†è®ºåˆ†æä¸­æœ‰ç‰¹åˆ«çš„å«ä¹‰ã€‚ é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ç§è§£å†³æ–¹æ³•å°±æ˜¯æŠŠæ‰€æœ‰åŒ…å«å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼çš„çª—å£å»é™¤ï¼Œè¿™ç§æ–¹æ³•çš„æ€§èƒ½åœ¨å®éªŒä¸­ä¼šè¿›è¡Œè®¨è®ºã€‚ åœ¨æ–‡ä¸­ä½œè€…è¿˜ä½¿ç”¨äº†ä¸€ç§Missing Data InjectionæŠ€æœ¯ï¼Œå³åœ¨æ¯ä¸ªEpochéšæœºçš„æŒ‰ç…§ä¸€ä¸ªé¢„è®¾æ¯”ä¾‹\\(\\lambda\\)å°†æ­£å¸¸çš„æ•°æ®è®¾ä¸ºç¼ºå¤±ã€‚ä½œè€…è®¤ä¸ºè¿™æ ·æœ‰åŠ©äºæ€§èƒ½çš„æå‡ã€‚ Detection åœ¨æ£€æµ‹é˜¶æ®µï¼Œå¯¹äºä¸€ä¸ªè¾“å…¥æ ·æœ¬ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡å‹è¾“å‡ºå…¶å¼‚å¸¸çš„æ¦‚ç‡ã€‚å› ä¸ºæˆ‘ä»¬å»ºæ¨¡äº†\\(p_\\theta(x|z)\\)ï¼Œä¸€ç§æ–¹æ³•æ˜¯é‡‡æ ·è®¡ç®—\\(p_\\theta(x)=\\mathbb{E}_{p_\\theta(z)}[p_\\theta(x|z)]\\)ï¼Œä½†è¿™ç§æ–¹æ³•è®¡ç®—ä»£ä»·ååˆ†æ˜‚è´µã€‚å…¶ä»–çš„ä¸€äº›æ–¹æ¡ˆæœ‰è®¡ç®—\\(\\mathbb{E}_{q_\\phi(z|x)}[p_\\theta(x|z)]\\)æˆ–\\(\\mathbb{E}_{q_\\phi(z|x)}[\\log p_\\theta(x|z)]\\)ï¼Œå…¶ä¸­åè€…è¢«ç§°ä¸º\"Reconstruction Probability\"ï¼Œä½œè€…ä¾¿é‡‡ç”¨äº†è¿™ç§æ–¹æ¡ˆã€‚ åŒæ—¶ï¼Œä½œè€…è®¤ä¸ºè¾“å…¥çš„æ£€æµ‹æ ·æœ¬çš„ç¼ºå¤±å€¼ä¼šå¯¹ç»“æœé€ æˆè¾ƒå¤§åå·®ï¼Œäºæ˜¯ä½¿ç”¨äº†ä¸€ç§MCMC-based Missing Data Imputationçš„æ–¹æ³•æ¥å¯¹æ£€æµ‹æ ·æœ¬çš„ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ã€‚å…·ä½“åšæ³•æ˜¯å°†æµ‹è¯•æ ·æœ¬åˆ†ä¸ºå·²è§‚æµ‹å’Œç¼ºå¤±ä¸¤éƒ¨åˆ†\\(x=(x_o,x_m)\\)ï¼Œç„¶åä½¿ç”¨è®­ç»ƒå¥½çš„VAEè¿›è¡Œé‡æ„å¾—åˆ°\\((x^\\prime_o,x^\\prime_m)\\)ï¼Œç„¶åç”¨\\(x^\\prime_m\\)æ›¿æ¢\\(x_m\\)ï¼Œè¿™æ ·ä¸æ–­å¾ªç¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä½œè€…ä½¿ç”¨äº†\\(L\\)ä¸ªæ ·æœ¬æ¥è®¡ç®—Reconstruction Probabilityï¼Œè™½ç„¶å¾—åˆ°çš„è¾“å‡ºæ˜¯é’ˆå¯¹æ•´ä¸ªçª—å£æ¯ä¸ªç‚¹çš„ï¼Œä½†ä½œè€…åªä½¿ç”¨æœ€åä¸€ä¸ªç‚¹ã€‚ Experiments Datasets ä½œè€…é€‰æ‹©äº†ä¸‰æ¡KPIä½œä¸ºæµ‹è¯•æ•°æ®ï¼Œåˆ†åˆ«è®°ä¸º\\(\\mathcal{A}\\)ï¼Œ\\(\\mathcal{B}\\)ï¼Œ\\(\\mathcal{C}\\)ï¼Œå…¶åŸºæœ¬æ•°æ®å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š Metrics å› ä¸ºå¼‚å¸¸æ£€æµ‹ç±»åˆ«çš„æä¸å‡è¡¡æ€§ï¼Œä¼ ç»Ÿçš„æ€§èƒ½æŒ‡æ ‡å¹¶ä¸å¤ªåˆé€‚ï¼ˆå¼‚å¸¸æ ·æœ¬æå°‘ï¼Œä¸”å¼‚å¸¸ä¸€èˆ¬å‘ˆè¿ç»­çš„ç‰‡æ®µï¼‰ã€‚ä½œè€…è®¤ä¸ºåœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­è¿ç»´äººå‘˜éœ€è¦å°½é‡æ—©çš„è·çŸ¥å¼‚å¸¸çš„å‘ç”Ÿï¼Œäºæ˜¯æå‡ºäº†æ–°çš„è¯„æµ‹æœºåˆ¶ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¬¬ä¸€è¡Œä¸ºçœŸå®çš„æ ‡ç­¾ï¼Œç¬¬äºŒè¡Œä¸ºé¢„æµ‹çš„å¼‚å¸¸æ¦‚ç‡ï¼Œç¬¬ä¸‰è¡Œä¸ºé¢„æµ‹çš„æ ‡ç­¾ã€‚ç¬¬ä¸€è¡Œä¸­å¼‚å¸¸ç‰‡æ®µè¢«åŠ ç²—è¡¨ç¤ºï¼Œå¯¹äºæ¯ä¸€ä¸ªå¼‚å¸¸ç‰‡æ®µçš„ç¬¬ä¸€ä¸ªä½ç½®\\({y}_{t^\\prime}\\)ï¼Œå¦‚æœé¢„æµ‹çš„æ ‡ç­¾ä¸­å­˜åœ¨\\(\\hat{y}_{t}\\)æ»¡è¶³\\(t^\\prime&lt;t\\)ä¸”\\(|t-t^\\prime|\\)å°äºç­‰äºé¢„è®¾çš„é˜ˆå€¼\\(T\\)ï¼Œé‚£ä¹ˆ\\(y_{t^\\prime}\\)å¯¹åº”çš„æ•´æ®µå¼‚å¸¸éƒ½è¢«è®¤ä¸ºæ­£ç¡®æ£€æµ‹ï¼Œå¦åˆ™æ•´æ®µå¼‚å¸¸éƒ½è®¤ä¸ºæ²¡æœ‰è¢«æ­£ç¡®æ£€æµ‹ã€‚ç„¶ååœ¨æ­¤åŸºç¡€ä¸Šè®¡ç®—F1-scoreï¼ŒAUCç­‰æŒ‡æ ‡ä½œä¸ºè¯„æµ‹æ‰‹æ®µã€‚ Results Overall Performance ä¸‹å›¾å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š Effects of Donut Techniques ä¸ºäº†æ¢ç©¶Donutä¸­æ‰€åšçš„å„ç§æ”¹è¿›çš„å®é™…ä½œç”¨ï¼Œä½œè€…åšäº†å¤§é‡å¯¹æ¯”å®éªŒï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š M-ELBO ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºM-ELBOå¯¹æ€§èƒ½æå‡æœ€å¤§ã€‚ä½œè€…åœ¨æ–‡ä¸­æåˆ°ä¸€å¼€å§‹å¹¶æ²¡æœŸæœ›M-ELBOèƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ï¼Œåªæ˜¯å¸Œæœ›å®ƒèƒ½å¤ŸWorkã€‚è¿™è¡¨æ˜åœ¨VAEçš„è®­ç»ƒä¸­ï¼Œåªä½¿ç”¨æ­£å¸¸æ ·æœ¬æ˜¯ä¸å¤Ÿçš„ï¼Œä¹Ÿéœ€è¦åŠ å…¥éæ­£å¸¸çš„ä¿¡æ¯ï¼› Missing Data Injection è¯¥æŠ€å·§çš„ä¸»è¦ä½œç”¨æ˜¯å¢å¼ºM-ELBOçš„æ•ˆæœã€‚ä»ç»“æœä¸Šæ¥çœ‹ä½œç”¨å¹¶ä¸æ˜¯ååˆ†çš„æ˜¾è‘—ï¼Œåªæ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹è·å¾—äº†å°‘é‡çš„æå‡ï¼› MCMC Imputation ä½œè€…è®¤ä¸ºè™½ç„¶è¯¥æŠ€å·§åªåœ¨ä¸€éƒ¨åˆ†æƒ…å†µä¸‹æ˜¾è‘—æå‡äº†æ€§èƒ½ï¼Œä½†æ€»ä½“æ¥è¯´å€¼å¾—ä½¿ç”¨ã€‚ Impact of K è¯¥éƒ¨åˆ†ä½œè€…æ¢ç©¶äº†éšå˜é‡\\(z\\)çš„ç»´åº¦\\(K\\)å¯¹æ€§èƒ½çš„å½±å“ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š ä»å›¾ä¸Šæ¥çœ‹ï¼Œå¯¹æ•°æ®é›†\\(\\mathcal{A}\\)ï¼Œ\\(\\mathcal{B}\\)ï¼Œ\\(\\mathcal{C}\\)æœ€ä½³çš„\\(K\\)åˆ†åˆ«æ˜¯\\(5\\)ï¼Œ\\(4\\)å’Œ\\(3\\)ï¼Œä½†æ˜¯è®¾å®šè¾ƒå¤§çš„\\(K\\)å¹¶ä¸ä¼šå¯¹æ€§èƒ½æœ‰ä¸¥é‡çš„æŸå®³ã€‚ä½œè€…è¿˜å‘ç°å¯¹äºè¾ƒä¸ºå¹³æ»‘çš„KPIéœ€è¦è¾ƒå¤§çš„\\(K\\)ã€‚ Analysis KDE Interpretation åœ¨è¿™ä¸€èŠ‚ä½œè€…å¯¹Reconstruction Probabilityçš„æ„ä¹‰è¿›è¡Œäº†æ·±å…¥çš„æ¢è®¨ã€‚é¦–å…ˆä½œè€…å¯¹\\(q_\\phi(z|x)\\)è¿›è¡Œäº†å¯è§†åŒ–ï¼Œåœ¨å›¾ä¸­ä½œè€…å°†æ—¶é—´ç»´åº¦ç”¨é¢œè‰²æ¥è¡¨ç¤ºã€‚å¦‚Figure 11(a) æ‰€ç¤ºï¼Œ\\(z\\)å‡ ä¹æ˜¯æŒ‰ç…§\\(x\\)å¯¹åº”çš„æ—¶é—´å‘ˆä¸€ä¸ªè¿ç»­çš„æµå½¢åˆ†å¸ƒï¼Œä½œè€…å°†è¿™ç§ç°è±¡ç§°ä¸ºTime Gradientã€‚å³ä½¿Donutæ²¡æœ‰æ˜¾å¼çš„ç”¨åˆ°æ—¶é—´ä¿¡æ¯ï¼Œä¸è¿‡å› ä¸ºå®éªŒç”¨åˆ°çš„æ•°æ®åŸºæœ¬æ˜¯å¹³æ»‘çš„ï¼Œæ‰€ä»¥è¯´ç›¸é‚»çš„\\(x\\)ä¼šæ¯”è¾ƒç›¸ä¼¼ï¼Œå› æ­¤ç»è¿‡æ˜ å°„åçš„\\(z\\)ä¹Ÿä¼šæ¯”è¾ƒç›¸ä¼¼ã€‚ä½œè€…æ®æ­¤æå‡ºDonutçš„ä¸€ä¸ªä¼˜åŠ¿ä¾¿æ˜¯å¯¹äºæ²¡æœ‰è§è¿‡çš„åéªŒåˆ†å¸ƒ\\(q_\\phi(z|x)\\)ï¼Œåªè¦å…¶ä½äºè®­ç»ƒè¿‡çš„ä¸¤ä¸ªåéªŒä¹‹é—´ï¼Œä¹Ÿä¼šäº§ç”Ÿåˆç†çš„åˆ†å¸ƒã€‚ å¯¹äºå¼‚å¸¸çš„æ ·æœ¬\\(x\\)ï¼Œå‡è®¾å…¶å¯¹åº”çš„æ­£å¸¸æ¨¡å¼ä¸º\\(\\tilde{x}\\)ï¼Œä½œè€…è®¤ä¸º\\(q_\\phi(z|x)\\)ä¼šåœ¨æŸç§ç¨‹åº¦ä¸Šå¯¹æ­£å¸¸çš„\\(q_\\phi(z|\\tilde{x})\\)è¿›è¡Œè¿‘ä¼¼ã€‚å› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è¿›è¡Œè®­ç»ƒçš„ï¼Œéšå˜é‡\\(z\\)çš„ç»´åº¦é€šå¸¸æ¥è¯´å°äºæ ·æœ¬\\(x\\)ï¼Œè¿™å°±å¯¼è‡´\\(z\\)åªä¼šä¿ç•™ä¸€éƒ¨åˆ†ä¸»è¦çš„ä¿¡æ¯ã€‚å¯¹äºå¼‚å¸¸æ ·æœ¬ï¼Œå…¶å¼‚å¸¸æ¨¡å¼åœ¨ç¼–ç æ—¶å°±è¢«ä¸¢æ‰äº†ã€‚ä½œè€…è¿˜æŒ‡å‡ºå¦‚æœ\\(x\\)åŒ…å«çš„å¼‚å¸¸å¤ªå¤šï¼Œé‚£ä¹ˆæ¨¡å‹å°†éš¾ä»¥å¯¹\\(x\\)è¿›è¡Œè¿˜åŸã€‚ åŸºäºä¸Šè¿°è®¨è®ºï¼Œä½œè€…å¯¹ä½¿ç”¨\\(\\mathbb{E}_{q_\\phi(z|x)}[\\log p_\\theta(x|z)]\\)ä½œä¸ºReconstruction Probabilityçš„æ„ä¹‰è¿›è¡Œäº†é˜é‡Šã€‚è®¾è¾“å…¥æ ·æœ¬ä¸º\\(x\\)ï¼Œå¦‚æœå…¶åŒ…å«å¼‚å¸¸ï¼Œå‡è®¾å…¶å¯¹åº”çš„æ­£å¸¸æ ·æœ¬ä¸º\\(\\tilde{x}\\)ï¼Œé‚£ä¹ˆ\\(q_\\phi(z|x)\\)éƒ¨åˆ†åœ°å’Œ\\(q_\\phi(z|\\tilde{x})\\)ç›¸ä¼¼ã€‚å¦‚æœ\\(x\\)å’Œ\\(\\tilde{x}\\)ç›¸ä¼¼ç¨‹åº¦é«˜ï¼Œé‚£ä¹ˆ\\(\\log p_\\theta(x|z)\\)å°±ä¼šå¾ˆå¤§ï¼ˆå…¶ä¸­\\(z\\sim q_\\phi(z|\\tilde{x})\\)ï¼‰ã€‚\\(\\log p_\\theta(x|z)\\)ç±»ä¼¼äºä¸€ä¸ªå¯†åº¦ä¼°è®¡å™¨ï¼Œä»£è¡¨\\(x\\)åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸\\(\\tilde{x}\\)æ¥è¿‘ï¼Œ\\(\\mathbb{E}_{q_\\phi(z|x)}[\\log p_\\theta(x|z)]\\)ç›¸å½“äºå¯¹æ¯ä¸€ä¸ª\\(z\\)å¯¹åº”çš„\\(\\log p_\\theta(x|z)\\)ä¹˜ä»¥ä¸€ä¸ªæƒé‡\\(q_\\phi(z|x)\\)ç„¶åç›¸åŠ ã€‚äºæ˜¯ä½œè€…æå‡ºäº†Reconstruction Probabilityçš„KDE Interpretation:åœ¨Donutæ¨¡å‹ä¸­ï¼ŒReconstruction Probability \\(\\mathbb{E}_{q_\\phi(z|x)}[\\log p_\\theta(x|z)]\\)å¯ä»¥çœ‹ä½œæ˜¯ä»¥\\(q_\\phi(z|x)\\)ä¸ºæƒé‡ï¼Œ\\(\\log p_\\theta(x|z)\\)ä¸ºæ ¸çš„æ ¸å¯†åº¦ä¼°è®¡ (Kernel Density Estimation)ã€‚ ä¸‰ç»´å¯è§†åŒ–å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä½œè€…è¿˜å¯¹ç›´æ¥è®¡ç®—\\(p_\\theta(x)=\\mathbb{E}_{p_\\theta(z)}[p_\\theta(x|z)]\\)è¿›è¡Œäº†è´¨ç–‘ï¼Œå› ä¸ºè¿™ç§æ–¹æ³•ç›´æ¥æ±‚\\(x\\)çš„å…ˆéªŒï¼Œä»…ä»…è€ƒè™‘äº†\\(x\\)çš„æ€»ä½“æ¨¡å¼ï¼Œè€Œå¿½ç•¥äº†\\(x\\)çš„ä¸ªä½“æ¨¡å¼ã€‚ Find Good Posteriors for Abnormal \\(x\\) é€šè¿‡ä¸Šé¢çš„è®¨è®ºæˆ‘ä»¬çŸ¥é“äº†Donuté€šè¿‡æ‰¾åˆ°\\(x\\)çš„æ­£å¸¸åéªŒæ¥ä¼°è®¡\\(x\\)åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸\\(\\tilde{x}\\)ç›¸ä¼¼ï¼Œåœ¨è¿™ä¸€èŠ‚ä½œè€…è®¨è®ºäº†æ–‡ä¸­ä½¿ç”¨çš„ä¸åŒæŠ€å·§å¯¹æ‰¾åˆ°\\(x\\)çš„åéªŒçš„ä½œç”¨ã€‚å¯¹äºMissing Data Injectionä½œè€…è®¤ä¸ºè¯¥æŠ€å·§å¢å¼ºäº†M-ELBOçš„æ•ˆæœã€‚å¯¹äºMCMC Imputationï¼Œä½œè€…è®¤ä¸ºè¯¥æŠ€å·§ä¸»è¦æ˜¯åœ¨æ£€æµ‹é˜¶æ®µé€šè¿‡ä¸æ–­è¿­ä»£æä¾›äº†æ›´å¥½çš„åéªŒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä½œè€…è®¤ä¸ºï¼Œè™½ç„¶å¯¹äºåŒ…å«å¤§é‡å¼‚å¸¸çš„æ ·æœ¬ï¼ŒDonutä¸èƒ½å¾ˆå¥½çš„è¿˜åŸï¼Œä½†åœ¨è¿ç»´åœºæ™¯ä¸­ï¼Œåªè¦å¯¹å¤§æ®µå¼‚å¸¸çš„å¼€å§‹é˜¶æ®µè¿›è¡Œå‡†ç¡®é¢„æµ‹å³å¯ã€‚ Causes of Time Gradient åœ¨è¿™ä¸€èŠ‚ä½œè€…è®¨è®ºäº†Time Gradientå‡ºç°çš„åŸå› ã€‚é¦–å…ˆå‡è®¾\\(x\\)éƒ½æ˜¯æ­£å¸¸ç‚¹ï¼Œè¿™æ—¶\\(x\\)çš„ELBOä¸ºï¼š \\[ \\begin{align} \\mathcal{L}(x)&amp;=\\mathbb{E}_{q_\\phi(z|x)}[\\log p_\\theta(x|z)+\\log p_\\theta(z)-\\log q_\\phi(z|x)]\\\\ &amp;=\\mathbb{E}[\\log p_\\theta(x|z)]+\\mathbb{E}[\\log p_\\theta(z)]+\\text{H}[z|x] \\end{align} \\] ç¬¬ä¸€é¡¹è¡¨æ˜åœ¨\\(z\\sim q_\\phi(z|x)\\)ä¸‹å°½å¯èƒ½é‡æ„\\(x\\)ã€‚ç¬¬äºŒé¡¹è¡¨æ˜\\(q_\\phi(z|x)\\)å°½é‡ä¸\\(z\\)çš„å…ˆéªŒ\\(\\mathcal{N}(0,I)\\)æ¥è¿‘ã€‚ç¬¬ä¸‰é¡¹ä¸º\\(q_\\phi(z|x)\\)çš„ç†µï¼Œè¡¨æ˜\\(q_\\phi(z|x)\\)åº”å°½é‡åˆ†æ•£ã€‚ç„¶è€Œç¬¬äºŒé¡¹åˆé™åˆ¶äº†è¿™ç§åˆ†æ•£çš„åŒºåŸŸï¼Œå¦‚ Figure 11(c) æ‰€ç¤ºã€‚åŒæ—¶è€ƒè™‘è¿™ä¸‰é¡¹çš„è¯ï¼Œç¬¬ä¸€é¡¹ä½¿å¾—\\(z\\)ä¸èƒ½è‡ªç”±åœ°åˆ†æ•£ï¼Œå¯¹äºä¸ç›¸ä¼¼çš„\\(x\\)å…¶å¯¹åº”çš„\\(z\\)ä¹Ÿæ˜¯ä¸ç›¸ä¼¼çš„ï¼Œå› ä¸ºè¦æœ€å¤§åŒ–\\(x\\)çš„é‡æ„æ¦‚ç‡ã€‚ç„¶è€Œå¯¹äºç›¸ä¼¼çš„\\(x\\)æ¥è¯´ï¼Œå…¶å¯¹åº”çš„\\(q_\\phi(z|x)\\)ä¼šå‡ºç°å¾ˆå¤šé‡å¤çš„éƒ¨åˆ†ã€‚å½“è¾¾åˆ°å¹³è¡¡æ—¶ï¼ŒTime Gradientå°±å‡ºç°äº†ã€‚ åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå½“\\(x\\)è¶Šä¸ç›¸ä¼¼ï¼Œ\\(q_\\phi(z|x)\\)å°±ä¼šç›¸è·è¶Šè¿œï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ç„¶è€Œåœ¨ä¸€å¼€å§‹ï¼Œå‚æ•°ç»è¿‡éšæœºåˆå§‹åŒ–ï¼Œ\\(q_\\phi(z|x)\\)éƒ½æ˜¯éšæœºæ•£ä¹±çš„ï¼Œå¦‚ Figure 11(b) æ‰€ç¤ºã€‚éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œ\\(q_\\phi(z|x)\\)å°†ä¼šä¸æ–­ä¼˜åŒ–ã€‚ç”±äºKPIæ•°æ®å¾€å¾€æ˜¯å…‰æ»‘çš„ï¼Œé‚£ä¹ˆåœ¨æ—¶é—´ä¸Šç›¸è·è¶Šè¿œçš„æ ·æœ¬å°±ä¼šè¶Šä¸ç›¸ä¼¼ï¼Œå¯¹åº”çš„\\(q_\\phi(z|x)\\)ä¹Ÿä¼šç›¸è·æ›´è¿œã€‚è¿™ä¹Ÿè¯´æ˜äº†ï¼Œè®­ç»ƒç»“æŸåï¼Œæ—¶é—´ä¸Šç›¸è·è¶Šè¿œçš„ï¼Œ\\(q_\\phi(z|x)\\)ä¹Ÿä¼šç›¸è·è¶Šè¿œï¼Œåä¹‹äº¦ç„¶ã€‚åŒæ—¶è¿™ä¹Ÿè¡¨æ˜å­¦ä¹ ç‡çš„è®¾ç½®å¯¹æœ¬æ¨¡å‹çš„ç¨³å®šæ€§æœ‰è‡³å…³é‡è¦çš„ä½œç”¨ã€‚ Sub-Optimal Equilibrium ä¸Šé¢æˆ‘ä»¬è®¨è®ºäº†éšç€è®­ç»ƒè¿›è¡Œ\\(q_\\phi(z|x)\\)çš„æ¼”å˜ï¼Œä½œè€…æå‡ºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°æ¨¡å‹æ”¶æ•›åˆ°æ¬¡ä¼˜çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç¬¬ä¸€è¡Œå±•ç¤ºçš„æ˜¯æ”¶æ•›åˆ°æœ€ä¼˜çš„æƒ…å†µï¼Œç¬¬äºŒè¡Œå±•ç¤ºçš„æ˜¯æ”¶æ•›åˆ°æ¬¡ä¼˜çš„æƒ…å†µã€‚ä»ç¬¬äºŒè¡Œçš„ç¬¬ä¸€ä¸ªå›¾ï¼ˆStep 100ï¼‰æ¥çœ‹ï¼Œç´«è‰²çš„ç‚¹å¼€å§‹ç©¿è¿‡ç»¿è‰²çš„ç‚¹ï¼Œéšç€è®­ç»ƒçš„è¿›è¡Œï¼Œç´«è‰²çš„ç‚¹å¼€å§‹å°†ç»¿è‰²çš„ç‚¹æ¨å¼€ã€‚åˆ°Step 5000çš„æ—¶å€™ï¼Œç»¿è‰²çš„ç‚¹å·²ç»è¢«åˆ†æˆäº†ä¸¤åŠã€‚ä¸‹å›¾å±•ç¤ºäº†å¯¹åº”çš„è®­ç»ƒè¯¯å·®å’ŒéªŒè¯è¯¯å·®ï¼š è¿™æ ·çš„ç°è±¡ä¼šå¯¼è‡´åœ¨ä¸¤åŠç»¿è‰²åŒºåŸŸä¹‹é—´çš„æµ‹è¯•æ ·æœ¬ä¼šè¢«è¯†åˆ«ä¸ºç´«è‰²ï¼Œä»è€Œé™ä½æ€§èƒ½ã€‚ä½œè€…æå‡ºåœ¨\\(K\\)è¾ƒå¤§çš„æ—¶å€™è¿™ç§ç°è±¡ä¸å®¹æ˜“å‘ç”Ÿï¼Œä½†è¿™æ—¶è®­ç»ƒçš„æ”¶æ•›åˆä¼šæˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://qfxiao.me/tags/Machine-Learning/"},{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"},{"name":"VAE","slug":"VAE","permalink":"http://qfxiao.me/tags/VAE/"}]},{"title":"Time-Series Anomaly Detection Service at Microsoft","slug":"Time-Series-Anomaly-Detection-Service-at-Microsoft","date":"2019-09-22T12:33:18.000Z","updated":"2020-06-25T08:59:23.758Z","comments":true,"path":"2019/09/22/Time-Series-Anomaly-Detection-Service-at-Microsoft/","link":"","permalink":"http://qfxiao.me/2019/09/22/Time-Series-Anomaly-Detection-Service-at-Microsoft/","excerpt":"","text":"Abstract æœ¬æ–‡å€Ÿé‰´è®¡ç®—æœºè§†è§‰ä¸­çš„æ˜¾è‘—æ€§æ£€æµ‹ï¼Œæå‡ºäº†ä¸€ç§åŸºäºSpectral Residualçš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚ åŸæ–‡ è¿™ç¯‡æ–‡ç« è¿˜æå‡ºäº†å‡ ä¸ªæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹è½åœ°çš„éš¾ç‚¹ï¼š Lack of Labels. åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¼šäº§ç”Ÿå¤§é‡çš„KPIï¼Œè€Œå¾ˆéš¾å¯¹æ¯ä¸ªKPIè¿›è¡Œäººå·¥æ ‡æ³¨ã€‚ Generalization. ä¸åŒKPIæ‰€è¡¨ç°å‡ºæ¥çš„æ¨¡å¼ä¹Ÿä¸å°½ç›¸åŒï¼Œå¦‚Figure 1æ‰€ç¤ºã€‚ç°æœ‰æ–¹æ³•å¾ˆéš¾åœ¨æ‰€æœ‰æ¨¡å¼çš„KPIä¸Šéƒ½è¡¨ç°è‰¯å¥½ã€‚ Efficiency. åœ¨å®é™…åœºæ™¯ä¸­ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„æ—¶é—´åºåˆ—æ•°æ®ï¼ŒåŒæ—¶å¯¹å¼‚å¸¸æ£€æµ‹ç®—æ³•çš„æ—¶é—´æ•ˆç‡æœ‰è¦æ±‚ã€‚ Contribution å°†Visual Saliency Detectionçš„æ–¹æ³•å¼•å…¥äº†æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ã€‚ ç»“åˆSpectral Residualå’ŒCNNæé«˜äº†å¼‚å¸¸æ£€æµ‹çš„æ•ˆæœã€‚ ç®—æ³•å…·æœ‰è‰¯å¥½çš„æ—¶é—´æ•ˆç‡å’Œé€šç”¨æ€§ã€‚ Background Spectral Residual SR(Spectral Residual)ç®—æ³•ä¸»è¦åŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼š é€šè¿‡å‚…é‡Œå¶å˜æ¢å¾—åˆ°log amplitude spectrumï¼› è®¡ç®—spectral residualï¼› é€šè¿‡å‚…é‡Œå¶é€†å˜æ¢å›åˆ°æ—¶é—´åŸŸã€‚ æ›´å½¢å¼åŒ–çš„è¡¨è¿°ä¸ºå¦‚ä¸‹ï¼š ç»™å®šä¸€ä¸ªåºåˆ—\\(\\mathbb{x}\\)ï¼Œåˆ™æœ‰ï¼š \\[A(f)=Amplitude(\\mathscr{F}(\\mathbb{x}))\\] \\[P(f)=Phrase(\\mathscr{F}(\\mathbb{x}))\\] \\[L(f)=\\log(A(f))\\] \\[AL(F)=h_1(f)\\cdot L(f)\\] \\[R(f)=L(f)-AL(f)\\] \\[S(\\mathbb{x})=\\parallel\\mathscr{F}^{-1}(\\exp(R(f)+iP(f)))\\parallel\\] å…¶ä¸­\\(\\mathscr{F}\\)å’Œ\\(\\mathscr{F}^{-1}\\)åˆ†åˆ«è¡¨ç¤ºå‚…é‡Œå¶å˜æ¢å’Œå‚…é‡Œå¶é€†å˜æ¢ï¼›\\(\\mathbb{x}\\in \\mathbb{R}^{n\\times 1}\\)è¡¨ç¤ºè¾“å…¥åºåˆ—ï¼›\\(A(f)\\)ä¸ºå¹…åº¦è°±ï¼Œ\\(P(f)\\)ä¸ºç›¸ä½è°±ï¼Œ\\(L(f)\\)ä¸ºå¯¹æ•°å¹…åº¦è°±ï¼Œ\\(AL(F)\\)ä¸ºå‡å€¼æ»¤æ³¢åçš„å¯¹æ•°å¹…åº¦è°±ï¼›\\(R(f)\\)ä¸ºspectral residualï¼›\\(S(\\mathbb{x})\\)ç§°ä¸ºsaliency mapã€‚Figure 4ä¸ºæ–‡ä¸­ç»™å‡ºçš„Saliency Mapç¤ºæ„å›¾ã€‚ Methodology Problem Definition ç»™å®šä¸€ç³»åˆ—å®æ•°å€¼\\(\\mathbb{x}=x_1,x_2,\\cdots,x_n\\)ï¼Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„ä»»åŠ¡æ˜¯äº§ç”Ÿä¸€ä¸ªè¾“å‡ºåºåˆ—\\(\\mathbb{y}=y_1,y_2,\\cdots,y_n\\)å…¶ä¸­\\(y_i\\in\\{0,1\\}\\)è¡¨ç¤º\\(x_i\\)æ˜¯å¦ä¸ºå¼‚å¸¸ç‚¹ã€‚ SR å¯¹äºç»™å®šåºåˆ—\\(\\mathbb{x}\\)ï¼Œè®¡ç®—Saliency Map \\(S(\\mathbb{x})\\)ï¼Œè¾“å‡ºåºåˆ—\\(O(\\mathbb{x})\\)å®šä¹‰ä¸ºï¼š \\[O(x_i)=\\begin{cases}1,\\quad \\text{if}\\frac{S(x_i)-\\overline{S(x_i)}}{\\overline{S(x_i)}}&gt;\\tau\\\\\\\\0,\\quad \\text{otherwise}\\end{cases}\\] å…¶ä¸­\\(S(x_i)\\)ä¸º\\(x_i\\)å¯¹åº”çš„Saliency Mapçš„å€¼ï¼Œ\\(\\overline{S(x_i)}\\)ä¸º\\(x_i\\)é™„è¿‘Saliency Mapå±€éƒ¨å‡å€¼ã€‚ åœ¨å®é™…æ“ä½œä¸­ï¼ŒFFTæ˜¯åœ¨ä¸€ä¸ªæ»‘åŠ¨çª—å£ä¸­è¿›è¡Œçš„ï¼Œæ–‡ä¸­æåˆ°SRæ–¹æ³•åœ¨ç‚¹ä½äºçª—å£ä¸­å¤®æ—¶æ•ˆæœæ›´å¥½ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œæµ‹è¯•çš„æ—¶å€™ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ–¹æ³•å¯¹å½“å‰ç‚¹\\(x_n\\)(ä¹Ÿå°±æ˜¯å½“å‰åºåˆ—æœ€åä¸€ä¸ªç‚¹)ä¹‹åçš„ç‚¹è¿›è¡Œé¢„æµ‹ï¼š \\[\\overline{g}=\\frac{1}{m}\\sum_{i=1}^m g(x_n,x_{n-i})\\] \\[x_{n+1}=x_{n-m+1}+\\overline{g}\\cdot m\\] å…¶ä¸­\\(g(x_i,x_j)\\)ä»£è¡¨\\(x_i\\)å’Œ\\(x_j\\)ä¸¤ç‚¹æ„æˆçš„ç›´çº¿çš„æ¢¯åº¦ï¼›\\(\\overline{g}\\)ä»£è¡¨æ‰€å¤„ç†çš„ç‚¹çš„å¹³å‡æ¢¯åº¦ï¼›\\(m\\)ä¸ºæ‰€å¤„ç†çš„ç‚¹çš„æ•°é‡ã€‚åœ¨æœ¬æ–‡ä¸­è®¾ç½®\\(m=5\\)ã€‚æ–‡ä¸­å‘ç°ç¬¬ä¸€ä¸ªé¢„æµ‹çš„å€¼å¾ˆé‡è¦ï¼Œæ‰€ä»¥ç›´æ¥æŠŠ\\(x_{n+1}\\)èµ‹å€¼\\(k\\)æ¬¡æ·»åŠ åˆ°åºåˆ—çš„æœ«å°¾ã€‚ SR-CNN æœ¬æ–‡æåˆ°ï¼Œä»…ä»…ä½¿ç”¨ä¸€ä¸ªé˜ˆå€¼æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­å¤ªè¿‡ç®€å•ï¼Œäºæ˜¯æå‡ºä½¿ç”¨ä¸€ä¸ªåˆ¤åˆ«æ¨¡å‹æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­ã€‚ç”±äºè®­ç»ƒæ•°æ®æ²¡æœ‰æ ‡ç­¾ï¼Œæ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å…¬å¼äººå·¥åŠ å…¥å¼‚å¸¸ï¼š \\[x=(\\overline{x}+mean)(1+var)\\cdot r+x\\] å…¶ä¸­\\(\\overline{x}\\)æ‰€å¤„ç†çš„ç‚¹çš„å±€éƒ¨å‡å€¼ï¼›\\(mean\\)å’Œ\\(var\\)ä¸ºå½“å‰æ»‘åŠ¨çª—å£ç‚¹çš„å‡å€¼å’Œæ–¹å·®ï¼›\\(r\\sim \\mathcal{N}(0,1)\\)ä¸ºæœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å™ªå£°ã€‚ å¯¹äºåˆ¤åˆ«æ¨¡å‹ä½¿ç”¨çš„æ˜¯CNNï¼Œä¸»è¦åŒ…å«ä¸¤ä¸ª1ç»´å·ç§¯å±‚(kernel sizeç­‰äºçª—å£å¤§å°\\(w\\))å’Œä¸¤ä¸ªå…¨è¿æ¥å±‚ã€‚ä¸¤ä¸ªå·ç§¯å±‚çš„channel sizeåˆ†åˆ«ä¸º\\(w\\)å’Œ\\(2w\\)ã€‚ Experiments Datasets æ‰€ç”¨æ•°æ®é›†åŒ…å«æ¸…åAIOpsç«èµ›æ•°æ®ã€Yahooå’ŒMicrosoftçš„KPIæ•°æ®ã€‚ Evaluation Metrics ç®—æ³•å‡†ç¡®ç‡æ–¹é¢ç”¨äº†precisionï¼Œrecallå’Œ\\(F_1\\)-scoreã€‚ ç”±äºåœ¨å®é™…åœºæ™¯ä¸­KPIçš„å¼‚å¸¸å¾€å¾€æ˜¯ä»¥ä¸€æ®µä¸€æ®µçš„å½¢å¼å‡ºç°ï¼Œä¸”å¹¶ä¸è¦æ±‚æŸä¸€ä¸ªæ—¶é—´ç‚¹å‡ºç°å¼‚å¸¸ç®—æ³•å°±é©¬ä¸Šæ£€æµ‹å‡ºæ¥ï¼Œåªè¦æ£€æµ‹å‡ºæ¥çš„æ—¶é—´åœ¨ä¸€å®šçš„å®¹å¿èŒƒå›´å†…å³å¯ã€‚æœ¬æ–‡ä½¿ç”¨äº†ä¸€äº›è°ƒæ•´çš„æ‰‹æ®µï¼Œå¦‚Figure 6ã€‚å¯¹äºæŸä¸€æ®µå¼‚å¸¸ï¼Œè®¾æ®µé¦–çš„å¼‚å¸¸ä½äºæ—¶é—´ç‚¹\\(t_{truth}\\)ï¼Œé¢„æµ‹ä¸ºå¼‚å¸¸çš„ç»“æœä¸­æ—¶é—´åœ¨\\(t_{truth}\\)ä¹‹åä¸”è·\\(t_{truth}\\)æœ€è¿‘çš„æ—¶é—´ç‚¹è®¾ä¸º\\(t_{predict}\\)ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªé¢„å…ˆè®¾å®šçš„å®¹å¿èŒƒå›´\\(k\\)ï¼Œåªè¦\\(t_{predict}-t_{truth}\\leq k+1\\)é‚£ä¹ˆåœ¨é¢„æµ‹ç»“æœä¸­æ•´æ®µå¼‚å¸¸å°±ä¼šé‡ç½®ä¸º\\(1\\)ï¼Œå¦åˆ™å…¨éƒ¨é‡ç½®ä¸º\\(0\\)ã€‚ Results å®éªŒéƒ¨åˆ†ä½¿ç”¨äº†ä¸¤ç§è®­ç»ƒæ–¹å¼ï¼Œä¸€ç§æ˜¯cold-startï¼Œå³æŠŠæ‰€æœ‰æ•°æ®éƒ½ç”¨æ¥æµ‹è¯•ï¼Œå¦ä¸€ç§æ˜¯æŠŠæ•°æ®åˆ†ä¸ºè®­ç»ƒæµ‹è¯•ä¸¤éƒ¨åˆ†ï¼Œåœ¨è®­ç»ƒé›†ä¸Šè®­ç»ƒï¼Œæœ€ååœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œæµ‹è¯•ã€‚ä¸¤ç§æ–¹æ³•é€‚ç”¨çš„baselineä¸åŒï¼Œæœ€åç»“æœå¦‚Table 2å’ŒTable 3æ‰€ç¤ºï¼š åœ¨SRçš„å‚æ•°è®¾ç½®ä¸Šï¼Œ\\(h_q(f)\\)ä¸­çš„\\(q\\)ä¸º3ï¼Œå±€éƒ¨å¹³å‡æ‰€ç”¨çš„ç‚¹æ•°ç›®\\(z\\)ä¸º21ï¼Œé˜ˆå€¼\\(\\tau\\)ä¸º3ï¼Œä¼°è®¡ç‚¹çš„æ•°é‡\\(k\\)ä¸º5ï¼Œæ»‘åŠ¨çª—å£çš„å¤§å°\\(w\\)åœ¨KPIã€Yahooã€Microsoftä¸‰ä¸ªæ•°æ®é›†ä¸Šåˆ†åˆ«ä¸º1440ã€64å’Œ30ã€‚SR-CNNçš„\\(q\\)ï¼Œ\\(z\\)ï¼Œ\\(k\\)ï¼Œ\\(w\\)è®¾ç½®ä¸SRç›¸åŒã€‚ Additional Experiments with DNN æ–‡ä¸­è¿˜å¯¹æœ‰ç›‘ç£çš„æƒ…å†µè¿›è¡Œäº†æµ‹è¯•ï¼Œå…·ä½“åšæ³•æ˜¯ä»æ—¶é—´åºåˆ—æå–ç‰¹å¾ï¼Œç„¶åå°†Saliency Mapä¹Ÿä½œä¸ºç‰¹å¾å¼•å…¥ï¼Œæ„é€ ä¸€ä¸ªæœ‰ç›‘ç£çš„Neural Networkè¿›è¡Œæµ‹è¯•ã€‚ æå–çš„ç‰¹å¾å¦‚Table 5æ‰€ç¤ºï¼š ç¥ç»ç½‘ç»œçš„ç»“æ„ä¸ºä¸¤å±‚å…¨è¿æ¥å±‚ï¼Œå¹¶æ·»åŠ äº†Dropout Ratioä¸º0.5çš„Dropout Layerã€‚ä¸¤ä¸ªLayerä½¿ç”¨äº†\\(L_1=L_2=0.0001\\)çš„æ­£åˆ™åŒ–ã€‚åŒæ—¶ä¸ºäº†å¤„ç†æ ·æœ¬ä¸å¹³è¡¡çš„æƒ…å†µä½¿ç”¨äº†è¿‡é‡‡æ ·æ¥ä½¿æ­£è´Ÿæ ·æœ¬çš„æ¯”ä¾‹ä¸º\\(1:2\\)ã€‚ç»“æ„å¦‚Figure 7æ‰€ç¤ºï¼š è®­ç»ƒæµ‹è¯•é›†çš„æƒ…å†µå¦‚Table 6æ‰€ç¤ºï¼Œæœ€ç»ˆç»“æœå¦‚Table 7æ‰€ç¤ºï¼ŒP-Ræ›²çº¿å¦‚Figure 8æ‰€ç¤ºã€‚å¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†SRç‰¹å¾çš„DNNæ•ˆæœç”±äºæ²¡æœ‰ä½¿ç”¨SRç‰¹å¾çš„DNNã€‚","categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"}],"tags":[{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://qfxiao.me/tags/Machine-Learning/"},{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"},{"name":"Spectral","slug":"Spectral","permalink":"http://qfxiao.me/tags/Spectral/"}]}],"categories":[{"name":"Research","slug":"Research","permalink":"http://qfxiao.me/categories/Research/"},{"name":"Self-supervised Learning","slug":"Research/Self-supervised-Learning","permalink":"http://qfxiao.me/categories/Research/Self-supervised-Learning/"},{"name":"Anomaly Detection","slug":"Research/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Research/Anomaly-Detection/"},{"name":"Misc","slug":"Research/Misc","permalink":"http://qfxiao.me/categories/Research/Misc/"},{"name":"Technical Notes","slug":"Technical-Notes","permalink":"http://qfxiao.me/categories/Technical-Notes/"},{"name":"Machine Learning","slug":"Technical-Notes/Machine-Learning","permalink":"http://qfxiao.me/categories/Technical-Notes/Machine-Learning/"},{"name":"Anomaly Detection","slug":"Technical-Notes/Anomaly-Detection","permalink":"http://qfxiao.me/categories/Technical-Notes/Anomaly-Detection/"},{"name":"Representation Learning","slug":"Research/Representation-Learning","permalink":"http://qfxiao.me/categories/Research/Representation-Learning/"},{"name":"Notes","slug":"Research/Notes","permalink":"http://qfxiao.me/categories/Research/Notes/"},{"name":"Time Series Modeling","slug":"Research/Time-Series-Modeling","permalink":"http://qfxiao.me/categories/Research/Time-Series-Modeling/"},{"name":"Misc","slug":"Technical-Notes/Misc","permalink":"http://qfxiao.me/categories/Technical-Notes/Misc/"},{"name":"GAN","slug":"Research/GAN","permalink":"http://qfxiao.me/categories/Research/GAN/"},{"name":"Tutorial","slug":"Research/Tutorial","permalink":"http://qfxiao.me/categories/Research/Tutorial/"},{"name":"RNN","slug":"Research/RNN","permalink":"http://qfxiao.me/categories/Research/RNN/"},{"name":"Time Series Imputation","slug":"Research/Time-Series-Imputation","permalink":"http://qfxiao.me/categories/Research/Time-Series-Imputation/"}],"tags":[{"name":"Representation Learning","slug":"Representation-Learning","permalink":"http://qfxiao.me/tags/Representation-Learning/"},{"name":"Self-supervised Learning","slug":"Self-supervised-Learning","permalink":"http://qfxiao.me/tags/Self-supervised-Learning/"},{"name":"Anomaly Detection","slug":"Anomaly-Detection","permalink":"http://qfxiao.me/tags/Anomaly-Detection/"},{"name":"Papers","slug":"Papers","permalink":"http://qfxiao.me/tags/Papers/"},{"name":"Deep Learning","slug":"Deep-Learning","permalink":"http://qfxiao.me/tags/Deep-Learning/"},{"name":"Random Forest","slug":"Random-Forest","permalink":"http://qfxiao.me/tags/Random-Forest/"},{"name":"LOF","slug":"LOF","permalink":"http://qfxiao.me/tags/LOF/"},{"name":"OCSVM","slug":"OCSVM","permalink":"http://qfxiao.me/tags/OCSVM/"},{"name":"iForest","slug":"iForest","permalink":"http://qfxiao.me/tags/iForest/"},{"name":"Overfitting","slug":"Overfitting","permalink":"http://qfxiao.me/tags/Overfitting/"},{"name":"Bias","slug":"Bias","permalink":"http://qfxiao.me/tags/Bias/"},{"name":"Variance","slug":"Variance","permalink":"http://qfxiao.me/tags/Variance/"},{"name":"ID3","slug":"ID3","permalink":"http://qfxiao.me/tags/ID3/"},{"name":"C4.5","slug":"C4-5","permalink":"http://qfxiao.me/tags/C4-5/"},{"name":"CART","slug":"CART","permalink":"http://qfxiao.me/tags/CART/"},{"name":"SVM","slug":"SVM","permalink":"http://qfxiao.me/tags/SVM/"},{"name":"Linear Regression","slug":"Linear-Regression","permalink":"http://qfxiao.me/tags/Linear-Regression/"},{"name":"Boosting","slug":"Boosting","permalink":"http://qfxiao.me/tags/Boosting/"},{"name":"Adaboost","slug":"Adaboost","permalink":"http://qfxiao.me/tags/Adaboost/"},{"name":"GBDT","slug":"GBDT","permalink":"http://qfxiao.me/tags/GBDT/"},{"name":"XGBoost","slug":"XGBoost","permalink":"http://qfxiao.me/tags/XGBoost/"},{"name":"Self-Supervised Learning","slug":"Self-Supervised-Learning","permalink":"http://qfxiao.me/tags/Self-Supervised-Learning/"},{"name":"Statistics","slug":"Statistics","permalink":"http://qfxiao.me/tags/Statistics/"},{"name":"Probability","slug":"Probability","permalink":"http://qfxiao.me/tags/Probability/"},{"name":"Time Series","slug":"Time-Series","permalink":"http://qfxiao.me/tags/Time-Series/"},{"name":"Shapelet","slug":"Shapelet","permalink":"http://qfxiao.me/tags/Shapelet/"},{"name":"GAN","slug":"GAN","permalink":"http://qfxiao.me/tags/GAN/"},{"name":"Novelty Detection","slug":"Novelty-Detection","permalink":"http://qfxiao.me/tags/Novelty-Detection/"},{"name":"Pytorch","slug":"Pytorch","permalink":"http://qfxiao.me/tags/Pytorch/"},{"name":"Tensorflow","slug":"Tensorflow","permalink":"http://qfxiao.me/tags/Tensorflow/"},{"name":"Docker","slug":"Docker","permalink":"http://qfxiao.me/tags/Docker/"},{"name":"Transfer Learning","slug":"Transfer-Learning","permalink":"http://qfxiao.me/tags/Transfer-Learning/"},{"name":"Geant4","slug":"Geant4","permalink":"http://qfxiao.me/tags/Geant4/"},{"name":"VAE","slug":"VAE","permalink":"http://qfxiao.me/tags/VAE/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://qfxiao.me/tags/Machine-Learning/"},{"name":"Variational Inference","slug":"Variational-Inference","permalink":"http://qfxiao.me/tags/Variational-Inference/"},{"name":"RNN","slug":"RNN","permalink":"http://qfxiao.me/tags/RNN/"},{"name":"Flow-based Model","slug":"Flow-based-Model","permalink":"http://qfxiao.me/tags/Flow-based-Model/"},{"name":"Spectral","slug":"Spectral","permalink":"http://qfxiao.me/tags/Spectral/"}]}