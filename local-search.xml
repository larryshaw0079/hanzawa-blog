<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Grokking the Interview Coding Questions: High Frequency Problems</title>
    <link href="/2020/08/29/Grokking-the-Interview-Coding-Questions/"/>
    <url>/2020/08/29/Grokking-the-Interview-Coding-Questions/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡ä¸ä¼šå¯¹ç®—æ³•çš„åŸç†åšè¿‡å¤šçš„è®²è§£ï¼Œä¸»è¦æ˜¯è®°å½•å¸¸è§é—®é¢˜çš„æ€è·¯ã€‚ã€‚ã€‚</p><p>PSï¼šæœ¬æ–‡ä»£ç çš†é€šè¿‡LeetCodeæäº¤é€šè¿‡ã€‚ã€‚ã€‚</p><p>æ¨èä¸¤ä¸ªç½‘ç«™ï¼š</p><ul><li><p><a href="https://oi-wiki.org/" target="_blank" rel="noopener">ğŸ±â€ğŸOI WIKI</a></p></li><li><p><a href="https://en.cppreference.com/w/" target="_blank" rel="noopener">ğŸ““C++æ–‡æ¡£</a> ä¹Ÿæœ‰ä¸­æ–‡ç‰ˆ</p></li></ul><p>Still working on itğŸ˜€...</p><h1 id="sorting-arrays">Sorting &amp; Arrays</h1><h2 id="basic-sorting">Basic Sorting</h2><p><a href="https://leetcode-cn.com/problems/sort-an-array/" target="_blank" rel="noopener">ğŸ±â€ğŸ’»Leetcode 912</a></p><p>ä¸å¤šè¯´äº†ï¼Œéƒ½æ˜¯åŸºç¡€ï¼Œå‡ ä¸ª<span class="math inline">\(O(N^2)\)</span>çš„ç®—æ³•å®ç°èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¸»è¦æ˜¯ä¸‹é¢ä¸¤ä¸ªæ³¨æ„ä¸è¦å†™é”™ï¼š</p><ul><li>å¿«é€Ÿæ’åº</li></ul><pre><code class="hljs cpp"><span class="hljs-comment">// è¦ä¿®æ”¹åŸæ•°ç»„çš„å†…å®¹ï¼Œå¼•ç”¨&amp;æ˜¯å¿…é¡»çš„</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">QuickSort</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; &amp;arr)</span> </span>&#123;    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;&gt; ranges; <span class="hljs-comment">// ç”¨æ¥ä¿å­˜éœ€è¦è¿­ä»£çš„èŒƒå›´</span>    ranges.push_back(<span class="hljs-built_in">std</span>::make_pair(<span class="hljs-number">0</span>, arr.size()<span class="hljs-number">-1</span>)); <span class="hljs-comment">// åˆå§‹åŒ–ï¼Œé—­åŒºé—´</span>        <span class="hljs-keyword">while</span> (!ranges.empty()) &#123;        <span class="hljs-keyword">auto</span> range = ranges.back(); <span class="hljs-comment">// å–å‡ºæ ˆé¡¶</span>        ranges.pop_back();                <span class="hljs-keyword">if</span> (range.first &gt;= range.second) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// åªæœ‰ä¸€ä¸ªæ•°çš„æƒ…å†µç›´æ¥è·³è¿‡</span>                <span class="hljs-keyword">int</span> mid_val = arr[range.second]; <span class="hljs-comment">// æœ€åä¸€ä¸ªæ•°ä½œä¸ºanchor</span>        <span class="hljs-keyword">int</span> left = range.first, right = range.second<span class="hljs-number">-1</span>;                <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; arr[left] &lt; mid_val) left++;            <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; arr[right] &gt;= mid_val) right--;            <span class="hljs-built_in">std</span>::swap(arr[left], arr[right]);        &#125;                <span class="hljs-comment">// å¤„ç†ç‰¹æ®Šæƒ…å†µ</span>        <span class="hljs-keyword">if</span> (arr[left] &gt;= arr[range.second]) <span class="hljs-built_in">std</span>::swap(arr[left], arr[range.second]);        <span class="hljs-keyword">else</span> left++;                ranges.push_back(<span class="hljs-built_in">std</span>::make_pair(range.first, left<span class="hljs-number">-1</span>));        ranges.push_back(<span class="hljs-built_in">std</span>::make_pair(left+<span class="hljs-number">1</span>, range.second));    &#125;&#125;</code></pre><ul><li>å †æ’åº</li></ul><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">HeadAdjust</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; arr, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> end)</span> </span>&#123;    <span class="hljs-keyword">int</span> dad = start;    <span class="hljs-keyword">int</span> son = dad*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (son &lt;= end) &#123;            &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">HeapSort</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; arr)</span> </span>&#123;    &#125;</code></pre><h2 id="top-k-element-ç¬¬kå¤§å°å…ƒç´ ">Top K Element ç¬¬Kå¤§/å°å…ƒç´ </h2><p><a href="https://leetcode-cn.com/problems/kth-largest-element-in-an-array/" target="_blank" rel="noopener">ğŸ±â€ğŸ’»Leetcode 215</a> ï¼ˆåŒç±»é¢˜ï¼š<a href="https://leetcode-cn.com/problems/zui-xiao-de-kge-shu-lcof/" target="_blank" rel="noopener">ğŸ±â€ğŸ’»å‰‘æŒ‡Offer 40</a>ï¼‰</p><p><strong>é¢˜ç›®ä¸­è¯´äº†ç»™å®šçš„<span class="math inline">\(K\)</span>æ˜¯åˆæ³•çš„ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä»£ç æ²¡æœ‰æ£€æŸ¥<span class="math inline">\(K\)</span>çš„åˆæ³•æ€§</strong></p><ul><li>å…ˆæ’åºå†æ±‚è§£ <span class="math inline">\(O(N\log N)\)</span> ï¼ˆâ­ï¼‰</li></ul><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">findKthLargest</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;        <span class="hljs-built_in">std</span>::sort(nums.begin(), nums.end());        <span class="hljs-keyword">return</span> nums[nums.size()-k];    &#125;&#125;;</code></pre><ul><li>å † <span class="math inline">\(O(N\log K)\)</span> ï¼ˆâ­â­ï¼‰</li></ul><p>æ³¨æ„æ±‚æœ€å°çš„<span class="math inline">\(K\)</span>ä¸ªæ•°çš„è¯ç”¨å¤§é¡¶å †ï¼Œä¸ç„¶æŠŠå…¨éƒ¨æ•°pushåˆ°å †ä¸­ç„¶åä¸€ä¸ªä¸€ä¸ªå¼¹å‡ºçš„è¯å¤æ‚åº¦æ˜¯<span class="math inline">\(O(N\log N)\)</span>ï¼Œå’Œæ’åºæ²¡ä»€ä¹ˆåŒºåˆ«äº†ã€‚</p><p>ä½¿ç”¨<code>C++</code>è‡ªå¸¦<code>priority_queue</code>çš„ç‰ˆæœ¬ï¼š</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">TopK</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; arr, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-built_in">std</span>::priority_queue&lt;<span class="hljs-keyword">int</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;, <span class="hljs-built_in">std</span>::greater&lt;<span class="hljs-keyword">int</span>&gt;&gt; pq; <span class="hljs-comment">// greateræ˜¯å°é¡¶å †ï¼Œlessæ˜¯å¤§é¡¶å †</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> num : arr) &#123;        <span class="hljs-keyword">if</span> (pq.size() &lt; k) &#123;            pq.push(num);        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (num &gt; pq.top()) &#123;            <span class="hljs-comment">// å¦‚æœæ ˆé¡¶å…ƒç´ å¤§äºå½“å‰å…ƒç´ </span>            pq.pop();            pq.push(num);        &#125;    &#125;        <span class="hljs-keyword">return</span> pq.top();&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">findKthLargest</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;        <span class="hljs-keyword">return</span> TopK(nums, k);    &#125;&#125;;</code></pre><ul><li>å¿«æ’å˜ä½“ <span class="math inline">\(O(N)\)</span> ï¼ˆâ­â­â­ï¼‰</li></ul><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">TopK</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; arr, <span class="hljs-keyword">int</span> k)</span> </span>&#123;  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;&gt; ranges;  ranges.push_back(<span class="hljs-built_in">std</span>::make_pair(<span class="hljs-number">0</span>, arr.size()<span class="hljs-number">-1</span>));  <span class="hljs-keyword">while</span> (!ranges.empty()) &#123;    <span class="hljs-keyword">auto</span> range = ranges.back();    ranges.pop_back();    <span class="hljs-keyword">if</span> (range.first &gt;= range.second) &#123;      <span class="hljs-keyword">if</span> (range.first == k || range.second == k) &#123;        <span class="hljs-keyword">return</span> arr[k];      &#125;      <span class="hljs-keyword">continue</span>;    &#125;    <span class="hljs-keyword">int</span> mid_val = arr[range.second];    <span class="hljs-keyword">int</span> left = range.first, right = range.second<span class="hljs-number">-1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;      <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; arr[left] &lt; mid_val) left++;      <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; arr[right] &gt;= mid_val) right--;      <span class="hljs-built_in">std</span>::swap(arr[left], arr[right]);    &#125;    <span class="hljs-keyword">if</span> (arr[left] &gt;= arr[range.second]) <span class="hljs-built_in">std</span>::swap(arr[left], arr[range.second]);    <span class="hljs-keyword">else</span> left++;    <span class="hljs-keyword">if</span> (left == k) <span class="hljs-keyword">return</span> arr[left];    ranges.push_back(<span class="hljs-built_in">std</span>::make_pair(range.first, left<span class="hljs-number">-1</span>));    ranges.push_back(<span class="hljs-built_in">std</span>::make_pair(left+<span class="hljs-number">1</span>, range.second));  &#125;  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">findKthLargest</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;        <span class="hljs-keyword">return</span> TopK(nums, nums.size()-k);    &#125;&#125;;</code></pre><h1 id="list">List</h1><h2 id="add-two-numbers-é“¾è¡¨ç›¸åŠ ">Add Two Numbers é“¾è¡¨ç›¸åŠ </h2><p><a href="https://leetcode-cn.com/problems/add-two-numbers/" target="_blank" rel="noopener">ğŸ±â€ğŸ’»Leetcode 2</a></p><h2 id="intersection-of-two-lists-é“¾è¡¨ç›¸äº¤èŠ‚ç‚¹">Intersection of Two Lists é“¾è¡¨ç›¸äº¤èŠ‚ç‚¹</h2><p><a href="https://leetcode-cn.com/problems/intersection-of-two-linked-lists/" target="_blank" rel="noopener">ğŸ±â€ğŸ’»Leetcode 160</a></p><ul><li>HashTableæ³• <span class="math inline">\(O(M+N)\)</span>ï¼ˆâ­â­ï¼‰</li></ul><p>ç©ºé—´å¤æ‚åº¦<span class="math inline">\(O(M)\)</span>æˆ–<span class="math inline">\(O(N)\)</span>ï¼Œè¿™é‡Œä½¿ç”¨<code>unordered_set</code>å®ç°ï¼š</p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><span class="hljs-keyword">public</span>:    <span class="hljs-function">ListNode *<span class="hljs-title">getIntersectionNode</span><span class="hljs-params">(ListNode *headA, ListNode *headB)</span> </span>&#123;        <span class="hljs-keyword">if</span> (headA == <span class="hljs-literal">nullptr</span> || headB == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">unordered_set</span>&lt;ListNode*&gt; us;                ListNode* current = headA;        <span class="hljs-keyword">while</span> (current) &#123;            us.insert(current);            current = current-&gt;next;        &#125;        ListNode* res = <span class="hljs-literal">nullptr</span>;        current = headB;        <span class="hljs-keyword">while</span> (current) &#123;            <span class="hljs-keyword">if</span> (us.find(current) != us.end()) &#123;                res = current;                <span class="hljs-keyword">break</span>;            &#125;            current = current-&gt;next;        &#125;        <span class="hljs-keyword">return</span> res;    &#125;&#125;;</code></pre><ul><li>åŒæŒ‡é’ˆæ³• <span class="math inline">\(O(M+N)\)</span>ï¼ˆâ­â­â­ï¼‰</li></ul><p>ç©ºé—´å¤æ‚åº¦<span class="math inline">\(O(1)\)</span></p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><span class="hljs-keyword">public</span>:    <span class="hljs-function">ListNode *<span class="hljs-title">getIntersectionNode</span><span class="hljs-params">(ListNode *headA, ListNode *headB)</span> </span>&#123;        <span class="hljs-keyword">if</span> (headA == <span class="hljs-literal">nullptr</span> || headB == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;        ListNode* a = headA, *b = headB;        <span class="hljs-keyword">while</span> (a != b) &#123;            <span class="hljs-keyword">if</span> (a == <span class="hljs-literal">nullptr</span>) &#123;                a = headB;            &#125; <span class="hljs-keyword">else</span> &#123;                a = a-&gt;next;            &#125;            <span class="hljs-keyword">if</span> (b == <span class="hljs-literal">nullptr</span>) &#123;                b = headA;            &#125; <span class="hljs-keyword">else</span> &#123;                b = b-&gt;next;            &#125;        &#125;        <span class="hljs-keyword">return</span> a;    &#125;&#125;;</code></pre><h2 id="reverse-the-list-ç¿»è½¬é“¾è¡¨">Reverse the List ç¿»è½¬é“¾è¡¨</h2><p><a href="https://leetcode-cn.com/problems/reverse-linked-list/" target="_blank" rel="noopener">ğŸ±â€ğŸ’»Leetcode 206</a></p><p>é¢è¯•ä¸­å‡ºç°é¢‘ç‡è¿˜æŒºé«˜çš„</p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><span class="hljs-keyword">public</span>:    <span class="hljs-function">ListNode* <span class="hljs-title">enumerate</span><span class="hljs-params">(ListNode* head)</span> </span>&#123;        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; buffer;        <span class="hljs-keyword">while</span> (head != <span class="hljs-literal">nullptr</span>) &#123;            buffer.push_back(head-&gt;val);            head = head-&gt;next;        &#125;        ListNode* res = <span class="hljs-keyword">new</span> ListNode(buffer.back());        ListNode* current = res;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = buffer.size()<span class="hljs-number">-2</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;            current-&gt;next = <span class="hljs-keyword">new</span> ListNode(buffer[i]);            current = current-&gt;next;        &#125;        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-function">ListNode* <span class="hljs-title">reverseList</span><span class="hljs-params">(ListNode* head)</span> </span>&#123;        <span class="hljs-keyword">if</span> (head == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span> head;        <span class="hljs-keyword">return</span> enumerate(head);    &#125;&#125;;</code></pre><h2 id="merge-lists-åˆå¹¶2æˆ–kä¸ªé“¾è¡¨">Merge Lists åˆå¹¶ï¼ˆ2æˆ–Kä¸ªï¼‰é“¾è¡¨</h2><p><a href="https://leetcode-cn.com/problems/merge-k-sorted-lists/" target="_blank" rel="noopener">ğŸ±â€ğŸ’»Leetcode 23</a></p><p>æœ€ç®€å•çš„hardé¢˜ğŸ¤£ï¼Ÿï¼Ÿï¼Ÿä¼˜å…ˆé˜Ÿåˆ—æ³•å†™èµ·æ¥æ˜¯æœ€èˆ’æœçš„ï¼Œæ•ˆç‡ä¹Ÿæ˜¯æœ€é«˜çš„ï¼Œæ—¶é—´å¤æ‚åº¦<span class="math inline">\(O(nk\times\log nk)\)</span></p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span>    <span class="hljs-built_in">std</span>::priority_queue&lt;<span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-keyword">int</span>, ListNode*&gt;, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-keyword">int</span>, ListNode*&gt;&gt;, <span class="hljs-built_in">std</span>::greater&lt;<span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-keyword">int</span>, ListNode*&gt;&gt;&gt; q;<span class="hljs-keyword">public</span>:    <span class="hljs-function">ListNode* <span class="hljs-title">mergeKLists</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;ListNode*&gt;&amp; lists)</span> </span>&#123;        <span class="hljs-keyword">if</span> (lists.empty()) <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> <span class="hljs-built_in">list</span> : lists) &#123;            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">list</span> != <span class="hljs-literal">nullptr</span>) &#123;                q.push(<span class="hljs-built_in">std</span>::make_pair(<span class="hljs-built_in">list</span>-&gt;val, <span class="hljs-built_in">list</span>));            &#125;        &#125;        <span class="hljs-keyword">auto</span>* dummy = <span class="hljs-keyword">new</span> ListNode(<span class="hljs-number">-1</span>);        <span class="hljs-keyword">auto</span>* current = dummy;        <span class="hljs-keyword">while</span> (q.size()) &#123;            <span class="hljs-keyword">auto</span> pair = q.top();            <span class="hljs-keyword">auto</span>* p = pair.second;            q.pop();            current-&gt;next = p;            <span class="hljs-keyword">if</span> (p-&gt;next) q.push(<span class="hljs-built_in">std</span>::make_pair(p-&gt;next-&gt;val, p-&gt;next));            current = current-&gt;next;        &#125;        <span class="hljs-keyword">return</span> dummy-&gt;next;    &#125;&#125;;</code></pre><h2 id="sort-list-æ’åºé“¾è¡¨">Sort List æ’åºé“¾è¡¨</h2><p><a href="https://leetcode-cn.com/problems/sort-list/" target="_blank" rel="noopener">ğŸ±â€ğŸ’»Leetcode 148</a></p><h1 id="mathematics">Mathematics</h1><h2 id="power-of-two-åˆ¤æ–­2çš„å¹‚">Power of Two åˆ¤æ–­<span class="math inline">\(2\)</span>çš„å¹‚</h2><p><a href="https://leetcode-cn.com/problems/power-of-two/" target="_blank" rel="noopener">ğŸ±â€ğŸ’»Leetcode 231</a></p><p><span class="math inline">\(n\)</span>ä¸º<span class="math inline">\(2\)</span>çš„å¹‚åªéœ€æ£€æŸ¥<span class="math inline">\(n\)</span>ä¸<span class="math inline">\(n-1\)</span>çš„ä¸æ˜¯å¦ä¸º<span class="math inline">\(0\)</span>å³å¯ï¼Œå¦‚<span class="math inline">\(8\)</span>çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼ˆå‡è®¾åªæœ‰<span class="math inline">\(8\)</span>ä½ï¼‰ä¸º<code>[0001000]</code>ï¼Œ<span class="math inline">\(7\)</span>çš„äºŒè¿›åˆ¶ä¸º<code>[0000111]</code>ã€‚</p><p>ä¸€è¡Œè§£å†³ã€‚è®°å¾—åˆ¤æ–­å¤§äº<span class="math inline">\(0\)</span>ã€‚</p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">isPowerOfTwo</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;        <span class="hljs-keyword">return</span> n &gt; <span class="hljs-number">0</span> &amp;&amp; (n&amp;(n<span class="hljs-number">-1</span>))==<span class="hljs-number">0</span>;    &#125;&#125;;</code></pre><h1 id="graph">Graph</h1><h1 id="misc">Misc</h1><h2 id="single-number-åªå‡ºç°è¿‡ä¸€æ¬¡çš„æ•°å­—">Single Number åªå‡ºç°è¿‡ä¸€æ¬¡çš„æ•°å­—</h2><p><a href="https://leetcode-cn.com/problems/single-number/" target="_blank" rel="noopener">ğŸ±â€ğŸ’»Leetcode 136</a></p><p>è¿ç”¨ä½è¿ç®—çš„æ€§è´¨</p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">singleNumber</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; nums)</span> </span>&#123;        <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> i : nums) res ^= i;        <span class="hljs-keyword">return</span> res;    &#125;&#125;;</code></pre>]]></content>
    
    
    <categories>
      
      <category>Technical Notes</category>
      
      <category>Interview</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Algorithm</tag>
      
      <tag>Data Structure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Unsupervised Representation Learning by Predicting Random Distances</title>
    <link href="/2020/08/24/Unsupervised-Representation-Learning-by-Predicting-Random-Distances/"/>
    <url>/2020/08/24/Unsupervised-Representation-Learning-by-Predicting-Random-Distances/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>é’ˆå¯¹é«˜ç»´è¡¨æ ¼æ•°æ®çš„è¡¨ç¤ºå­¦ä¹ ï¼Œä½œè€…æå‡ºäº†åŸºäºé¢„æµ‹é¢„è®¡å˜æ¢åçš„è·ç¦»çš„æ— ç›‘ç£è¡¨ç¤ºå­¦ä¹ æ¡†æ¶RDPï¼Œå¹¶è¿›è¡Œäº†ç†è®ºä¸Šçš„è®¨è®ºã€‚To be finished...</p><p><a href="https://arxiv.org/abs/1912.12186" target="_blank" rel="noopener">è®ºæ–‡åœ°å€</a> <a href="https://github.com/billhhh/RDP" target="_blank" rel="noopener">ä»£ç åœ°å€</a></p><h1 id="proposed-method">Proposed Method</h1><h2 id="random-distance-prediction-model">Random Distance Prediction Model</h2><p>å¯¹äºå¾ˆå¤šä¸‹æ¸¸ä»»åŠ¡æ¥è¯´ï¼Œé«˜ç»´æ•°æ®å¯¹æ¨¡å‹æ•ˆç‡å’Œæ€§èƒ½éƒ½å¾ˆå¤§ï¼Œæ‰€ä»¥å­¦ä¹ ä½ç»´çš„æœ‰æ„ä¹‰ï¼ˆèƒ½å¤Ÿæœ€å¤§é™åº¦ä¿å­˜åŸå§‹ç©ºé—´çš„ä¿¡æ¯ï¼‰çš„è¡¨ç¤ºååˆ†é‡è¦ã€‚æœ¬æ–‡çš„å¤§è‡´æ€æƒ³æ˜¯ç»™å®šä¸€ä¸ªç¡®å®šçš„éšæœºæ˜ å°„å°†æ ·æœ¬æ˜ å°„åˆ°ä¸€ä¸ªæ–°çš„ç©ºé—´ï¼Œç„¶åæ„é€ æ•°æ®é›†ï¼Œè¾“å…¥æ—¶ä»»æ„ä¸€å¯¹æ ·æœ¬ï¼Œæ ‡ç­¾æ˜¯ä¸¤ä¸ªæ ·æœ¬åœ¨æ–°çš„ç©ºé—´çš„è·ç¦»ï¼Œä¹‹åè®­ç»ƒä¸€ä¸ªæ¨¡å‹æ¥å­¦ä¹ è¿™ä¸ªè·ç¦»ã€‚ä½œè€…è®¤ä¸ºé€šè¿‡è¯¥ä»»åŠ¡çš„è®­ç»ƒï¼Œæ¨¡å‹èƒ½å¤Ÿå­¦åˆ°æœ‰æ„ä¹‰çš„ä½ç»´è¡¨ç¤ºã€‚æ¨¡å‹çš„æ¡†æ¶å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2020/07/19/vRV32EgLiYkWaQN.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><p>å…¶ä¸­<span class="math inline">\(\phi(\mathbf x;\Theta):\mathbb R^D\mapsto\mathbb R^M\)</span>ä¸ºå­ªç”Ÿç¥ç»ç½‘ç»œï¼ˆSiamese Neural Networkï¼‰ï¼Œå°†æ•°æ®æ˜ å°„åˆ°<span class="math inline">\(M\)</span>çš„æ–°ç©ºé—´ã€‚æŸå¤±å‡½æ•°ä¸ºï¼š</p><p><span class="math display">\[\mathcal L_{rdp}(\mathbf x_i,\mathbf x_j)=l(\langle \phi(\mathbf x_i;\Theta),\phi(\mathbf x_j;\Theta)\rangle,\langle\eta(\mathbf x_i),\eta(\mathbf x_j)\rangle)\]</span></p><p>å…¶ä¸­<span class="math inline">\(\eta(\cdot)\)</span>ä¸ºå·²çŸ¥çš„æ˜ å°„ï¼Œ<span class="math inline">\(l(\cdot)\)</span>ä¸ºè¡¡é‡ä¸¤ä¸ªè¾“å…¥ç›¸ä¼¼ç¨‹åº¦çš„åº¦é‡ã€‚å…·ä½“çš„æ¥è¯´ï¼Œæ–‡ä¸­é€‰å–äº†ç®€å•çš„å®ç°æ–¹æ¡ˆï¼Œå³é‡‡ç”¨å†…ç§¯ä½œä¸ºæ˜ å°„åçš„æ ·æœ¬çš„è·ç¦»åº¦é‡ï¼š</p><p><span class="math display">\[\mathcal L_{rdp}(\mathbf x_i,\mathbf x_j)=\left(\phi(\mathbf x_i;\Theta)\cdot\phi(\mathbf x_j;\Theta)-\eta(\mathbf x_i)\cdot\eta(\mathbf x_j)\right)^2\]</span></p><p><span class="math inline">\(\eta(\cdot)\)</span>ä¸ºç°æˆçš„æ˜ å°„ã€‚è‡³äºä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Œå¯ä»¥å…ˆæ¥ç€çœ‹ä¸‹é¢åŸæ–‡ç»™å‡ºçš„ç†è®ºåˆ†æï¼Œç„¶åæˆ‘å†è¯´è¯´æˆ‘è‡ªå·±çš„ç†è§£ã€‚</p><h2 id="incorporating-task-dependent-complementary-auxiliary-loss">Incorporating Task-Dependent Complementary Auxiliary Loss</h2><p>å¯¹äºç‰¹å®šçš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œä½œè€…æå‡ºå¯ä»¥æ•´åˆé¢å¤–çš„è¯¯å·®å‡½æ•°æ¥æé«˜æ¨¡å‹è¡Œæ€§èƒ½ã€‚æ¯”å¦‚è¯´é’ˆå¯¹èšç±»ä»»åŠ¡å¯ä»¥ä½¿ç”¨é‡æ„è¯¯å·®ï¼š</p><p><span class="math display">\[\mathcal L_{aux}^{clu}(\mathbf x)=(\mathbf x-\phi^\prime(\phi(\mathbf x;\Theta); \Theta^\prime))^2\]</span></p><p>å…¶ä¸­<span class="math inline">\(\phi(\cdot)\)</span>å’Œ<span class="math inline">\(\phi^\prime(\cdot):\mathbb R^M\mapsto\mathbb R^D\)</span>åˆ†åˆ«ä¸ºç¼–ç å™¨å’Œè§£ç å™¨ã€‚</p><p>å¯¹äºå¼‚å¸¸æ£€æµ‹ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹å¼ï¼š <span class="math display">\[\mathcal L_{aux}^{ad}(\mathbf x)=(\phi(\mathbf x;\Theta)-\eta(\mathbf x))^2\]</span></p><p>è¿™ä¸€ä¸ªLossæœ¬æ¥æ˜¯å‡ºç°åœ¨å¼ºåŒ–å­¦ä¹ çš„è®ºæ–‡ä¸­ï¼Œç”¨æ¥æ£€æµ‹ä¸€ä¸ªçŠ¶æ€<span class="math inline">\(\mathbf x\)</span>å‡ºç°çš„é¢‘ç‡ï¼Œå¦‚æœé¢„æµ‹è¯¯å·®è¾ƒå°ï¼Œè¯´æ˜è¿™ä¸ªæ ·æœ¬ä¹‹å‰è§è¿‡æˆ–è§è¿‡ç±»ä¼¼çš„ï¼Œå¦åˆ™æ²¡æ€ä¹ˆè§è¿‡ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å¼‚å¸¸ã€‚ç”±äºæœ¬æ–‡çš„ç›®çš„ä¸»è¦æ˜¯é™ç»´åŠ ä¿ç•™åŸå§‹ç©ºé—´ä¿¡æ¯ï¼Œå¯ä»¥è®¤ä¸ºä½¿ç”¨çº¿æ€§å˜æ¢çš„è¯æ­¤ç›®çš„å·²ç»è¾¾åˆ°äº†ã€‚</p><h2 id="theoretical-analysis">Theoretical Analysis</h2><h3 id="using-linear-projection">Using Linear Projection</h3><p>è¿™é‡Œè®¨è®ºä½¿ç”¨çº¿æ€§æ˜ å°„çš„æƒ…å†µï¼Œè®¾æ•°æ®é›†<span class="math inline">\(\mathcal X\subset\mathbb R^{N\times D}\)</span>ï¼Œæ˜ å°„çŸ©é˜µ<span class="math inline">\(\mathbf A\subset\mathbb R^{K\times D}\)</span>ä¸ºä¸€éšæœºçŸ©é˜µï¼Œæ˜ å°„ä¹‹åçš„æ•°æ®ä¸º<span class="math inline">\(\mathbf A\mathcal X^\top\)</span>ã€‚å¯¹äº<span class="math inline">\(\epsilon\in(0,\frac{1}{2})\)</span>å’Œ<span class="math inline">\(K=\frac{20\log n}{\epsilon^2}\)</span>ï¼Œå­˜åœ¨<span class="math inline">\(f:\mathbb R^D\mapsto\mathbb R^K\)</span>ä½¿å¾—å¯¹äºæ‰€æœ‰çš„<span class="math inline">\(\mathbf x_i,\mathbf x_j\in\mathcal X\)</span>æœ‰ï¼š</p><p><span class="math display">\[(1-\epsilon)\parallel\mathbf x_i-\mathbf x_j \parallel^2\leq \parallel f(\mathbf x_i)-f(\mathbf x_j)\parallel^2\leq (1+\epsilon)\parallel\mathbf x_i-\mathbf x_j\parallel^2\]</span></p><p>å¦‚æœ<span class="math inline">\(\mathbf A\)</span>çš„æ¯ä¸ªå…ƒç´ ç‹¬ç«‹é‡‡æ ·è‡ªæ ‡å‡†æ­£æ€åˆ†å¸ƒé‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[\text{Pr}\left((1-\epsilon)\parallel\mathbf x\parallel^2\leq\parallel\frac{1}{\sqrt{K}}\mathbf A\mathbf x\parallel^2\leq(1+\epsilon)\parallel\mathbf x\parallel^2\right)\geq 1-2e^{\frac{-(\epsilon^2-\epsilon^3)K}{4}}\]</span></p><p>åœ¨è¯¥éšæœºæ˜ å°„ä¸‹æœ‰ï¼š</p><p><span class="math display">\[\text{Pr}(|\hat{\mathbf x}_i\cdot\hat{\mathbf x}_j-f(\hat{\mathbf x}_i)\cdot f(\hat{\mathbf x}_j)|\geq\epsilon)\leq 4e^{\frac{-(\epsilon^2-\epsilon^3)\cdot K}{4}}\]</span></p><p>ç›´è§‚çš„è§£é‡Šå°±æ˜¯è¯´ä½¿ç”¨çº¿æ€§æ˜ å°„çš„æƒ…å†µä¸‹ï¼Œåªè¦ä½¿ç”¨çš„å˜æ¢çŸ©é˜µé‡‡æ ·è‡ªæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œé‚£ä¹ˆå˜æ¢ä¹‹åæ ·æœ¬å¯¹ä¹‹é—´çš„è·ç¦»ä¿¡æ¯èƒ½å¤Ÿä»¥ä¸€å®šçš„æ¦‚ç‡ä¿ç•™ã€‚</p><h3 id="using-non-linear-projection">Using Non-Linear Projection</h3><p>è¿™é‡Œä½œè€…è¯•å›¾è¯´æ˜ï¼Œåœ¨æŸäº›æ¡ä»¶ä¸‹ï¼Œéçº¿æ€§éšæœºæ˜ å°„çš„ä½œç”¨å’Œæ ¸å‡½æ•°æ¥è¿‘ã€‚å¯¹äºä¸€ä¸ªç¡®å®šçš„éšæœºæ˜ å°„å‡½æ•°<span class="math inline">\(g:\mathbb R^D\mapsto\mathbb R^K\)</span>ï¼Œåœ¨æŸäº›ç‰¹å®šçš„æ¡ä»¶ä¸‹ï¼Œå‡½æ•°<span class="math inline">\(g\)</span>å’Œæ ¸å‡½æ•°å­˜åœ¨ä¸‹åˆ—å…³ç³»ï¼š</p><p><span class="math display">\[k(\mathbf x_i,\mathbf x_j)=\langle\psi(\mathbf x_i),\psi(\mathbf x_j)\rangle\approx g(\mathbf x_i)\cdot g(\mathbf x_j)\]</span></p><p>è¿™ä¸ªæ¡ä»¶æ˜¯å‡½æ•°<span class="math inline">\(g\)</span>ä¸ºä¸€ä¸ªä¹˜ä»¥ä¸€ä¸ªçº¿æ€§çŸ©é˜µ<span class="math inline">\(\mathbf A\)</span>ç„¶ååœ¨ç»è¿‡ä¸€ä¸ªå…·å¤‡å¹³ç§»ä¸å˜æ€§çš„å‚…é‡Œå¶åŸºå‡½æ•°ï¼ˆå¦‚cosineï¼‰ã€‚ç”±äºæ ¸å‡½æ•°èƒ½å¤Ÿä¿ç•™åŸå§‹ç©ºé—´çš„ä¿¡æ¯ï¼Œæ‰€ä»¥ä½œè€…è®¤ä¸ºä½¿ç”¨éçº¿æ€§å‡½æ•°ä¹Ÿèƒ½ä¿ç•™åŸå§‹ç©ºé—´çš„ä¿¡æ¯ã€‚</p><blockquote><p>PS: æ„Ÿè§‰ä½œè€…åœ¨ç†è®ºéƒ¨åˆ†çš„è®¨è®ºè¿˜æ˜¯æœ‰ç‚¹æ¨¡ç³Šï¼Œå› ä¸ºæŠŠä¸€ä¸ªéšæœºçš„æ˜ å°„ä½œä¸ºï¼ˆä¼ªï¼‰ç›‘ç£ä¿¡æ¯æ¥è¿›è¡Œå­¦ä¹ ï¼Œç¥ç»ç½‘ç»œå­¦åˆ°çš„ä¸ä¹Ÿå°±æ˜¯éšæœºå™ªå£°ä¿¡æ¯å—ï¼Ÿå¯¹äºè¿™ä¸ªæ–¹æ³•workçš„åŸå› ï¼Œæˆ‘åœ¨è¿™é‡Œä¸è´Ÿè´£ä»»çš„åˆ†æä¸€ä¸‹ã€‚</p></blockquote><h3 id="learning-class-structure-by-random-distance-prediction">Learning Class Structure by Random Distance Prediction</h3><p>è¿™ä¸€èŠ‚ä¸»è¦è§£é‡Šä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œ<span class="math inline">\(\phi(\cdot)\)</span>å­¦åˆ°çš„è¦æ¯”éšæœºæ˜ å°„<span class="math inline">\(\eta(\cdot)\)</span>è¦å¥½ã€‚æ¨¡å‹çš„ä¼˜åŒ–ç›®æ ‡å¯ä»¥å†™æˆå¦‚ä¸‹çš„å½¢å¼ï¼š</p><p><span class="math display">\[\mathop{\arg\min}_{\Theta}\sum_{\mathbf x_i,\mathbf x_j\in\mathcal X}(\phi(\mathbf x_i;\Theta)\cdot\phi(\mathbf x_j;\Theta)-y_{ij})^2\]</span></p><p>å…¶ä¸­<span class="math inline">\(y_{ij}=\eta(\mathbf x_i)\cdot\eta(\mathbf x_j)\)</span>ã€‚è®¾<span class="math inline">\(\mathbf Y_\eta\in\mathbb R^{N\times N}\)</span>ä¸ºè·ç¦»çŸ©é˜µã€‚è¿™ä¸ªç›®æ ‡å‡½æ•°æ˜¯åœ¨æœ€å°åŒ–æ¯ä¸€å¯¹æ ·æœ¬åœ¨ç»è¿‡<span class="math inline">\(\phi(\cdot)\)</span>å’Œ<span class="math inline">\(\eta(\cdot)\)</span>æ˜ å°„åä¹‹é—´çš„è·ç¦»çš„å·®è·ã€‚é€šè¿‡å…¬å¼(7)å’Œå…¬å¼(8)æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨åˆé€‚çš„æ¡ä»¶ä¸‹ï¼Œéšæœºæ˜ å°„<span class="math inline">\(\eta(\cdot)\)</span>èƒ½å¤Ÿä¿ç•™åŸå§‹ç©ºé—´çš„è·ç¦»ä¿¡æ¯ï¼ˆå³åŸå§‹ç©ºé—´ç›¸è¿‘çš„æ ·æœ¬åœ¨æ˜ å°„åä¹Ÿç›¸è¿‘ï¼‰ã€‚ä¸è¿‡ï¼Œä¸Šè¿°å…¬å¼çš„æˆç«‹éƒ½ä¾èµ–äºå¯¹æ•°æ®åˆ†å¸ƒçš„ä¸€å®šå‡è®¾ï¼Œå½“çœŸå®çš„æ•°æ®ä¸æ»¡è¶³æ¡ä»¶æ—¶ï¼Œç»“è®ºå°±ä¼šæœ‰æ‰€åå·®ã€‚</p><h1 id="experiments">Experiments</h1><h2 id="performance-evaluation-in-anomaly-detection">Performance Evaluation in Anomaly Detection</h2><h3 id="experimental-settings">Experimental Settings</h3><p><img src="https://i.loli.net/2020/07/20/3G7DNKjwfQkiIz4.png" srcset="/img/loading.gif" /></p><p>å¼‚å¸¸åˆ†æ•°å®šä¹‰ä¸º<span class="math inline">\(\mathcal S(\mathbf x)=(\phi(\mathbf x;\Theta)-\eta(\mathbf x))^2\)</span>ã€‚</p><h3 id="comparison-to-the-state-of-the-art-competing-methods">Comparison to the State-of-the-art Competing Methods</h3><p><img src="https://i.loli.net/2020/07/20/8Ie2Q3mpdPHtrYF.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/07/20/OEcQSvZmfBz1ACt.png" srcset="/img/loading.gif" /></p><h3 id="ablation-study">Ablation Study</h3><p><img src="https://i.loli.net/2020/07/20/7GtKlN8q5Mvygre.png" srcset="/img/loading.gif" /></p><h2 id="performance-evaluation-in-clustering">Performance Evaluation in Clustering</h2><h3 id="experimental-settings-1">Experimental Settings</h3><p><img src="https://i.loli.net/2020/07/20/9xW12MVkoXgFZ6J.png" srcset="/img/loading.gif" /></p><h3 id="comparison-to-the-state-of-the-art-competing-methods-1">Comparison to the State-of-the-art Competing Methods</h3><p><img src="https://i.loli.net/2020/07/20/pUZ64aX1xWiLf2q.png" srcset="/img/loading.gif" /></p><figure><img src="https://i.loli.net/2020/07/20/VrnXuJsymiMItUf.png" srcset="/img/loading.gif" alt="" /><figcaption>image-20200720014002063</figcaption></figure>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Representation Learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Representation Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Effective End-to-end Unsupervised Outlier Detection via Linear Priority of Discriminative Network</title>
    <link href="/2020/07/14/Effective-End-to-end-Unsupervised-Outlier-Detection-via-Linear-Priority-of-Discriminative-Network/"/>
    <url>/2020/07/14/Effective-End-to-end-Unsupervised-Outlier-Detection-via-Linear-Priority-of-Discriminative-Network/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡é’ˆå¯¹æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹æå‡ºäº†<span class="math inline">\(E^3\space{Outlier}\)</span>ã€‚ä½œè€…ä½¿ç”¨è‡ªç›‘ç£å­¦ä¹ çš„æ–¹æ³•ï¼Œé€šè¿‡æ„å»ºæœ‰ç›‘ç£ä»»åŠ¡åœ¨æ²¡æœ‰æ ‡ç­¾çš„æƒ…å†µä¸‹å­¦ä¹ é«˜å±‚è¯­ä¹‰ç‰¹å¾ã€‚PSï¼šè¿™ç¯‡æ–‡ç« çš„æ–¹æ³•å’ŒNIPS18ä¸Šçš„<em>Deep Anomaly Detection Using Geometric Transformations</em>ï¼ˆåé¢ç®€ç§°GEOMï¼‰é¢‡ä¸ºç›¸ä¼¼ï¼Œä½†æ˜¯ä¸çŸ¥ä¸ºå•¥æ²¡æœ‰åœ¨å®éªŒä¸­è¿›è¡Œæ¯”è¾ƒã€‚åé¢æˆ‘ä¼šåˆ†æä¸€äº›ä¸¤ç¯‡æ–‡ç« æ–¹æ³•ä¸Šçš„å¼‚åŒã€‚</p><h1 id="proposed-method">Proposed Method</h1><h2 id="surrogate-supervision-based-effective-representation-learning-for-uod">Surrogate Supervision Based Effective Representation Learning for UOD</h2><p>è¿™é‡Œä½œè€…æåˆ°äº†ä½¿ç”¨é‡æ„çš„æ¨¡å‹æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹çš„ä¸è¶³ï¼šé‡æ„æ¨¡å‹é‡‡ç”¨åƒç´ çº§åˆ«çš„æŸå¤±å‡½æ•°ï¼ˆå¦‚mean square errorï¼‰ï¼Œè€Œè¿™å¤ªè¿‡äºä¸¥æ ¼å’Œç»†èŠ‚ï¼Œå¹¶ä¸èƒ½å­¦åˆ°é«˜å±‚è¯­ä¹‰ç‰¹å¾ã€‚</p><p>ä¸ºæ­¤ï¼Œä½œè€…æå‡ºäº†<em>surrogate supervision based discriminative network</em> (SSD)ã€‚å…·ä½“æ“ä½œå’ŒGEOMç±»ä¼¼ï¼Œé¦–å…ˆé¢„å®šä¹‰å¤§å°ä¸º<span class="math inline">\(K\)</span>çš„å‡ ä½•å˜æ¢é›†åˆ<span class="math inline">\(\mathcal O=\{O(\cdot|y)\}_{y=1}^K\)</span>ã€‚å¯¹æ¯ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(\mathbf x\)</span>ï¼Œåœ¨ç»è¿‡<span class="math inline">\(K\)</span>ä¸ªé›†åˆå˜æ¢ä¹‹åä¼šå¾—åˆ°<span class="math inline">\(K\)</span>ä¸ªå˜æ¢åçš„æ ·æœ¬ï¼ˆç¬¬<span class="math inline">\(y\)</span>ä¸ªå˜æ¢äº§ç”Ÿçš„æ ·æœ¬å³è®°ä¸º<span class="math inline">\(\mathbf x^{(y)}=O(\mathbf x|y)\)</span>ï¼‰ï¼Œæ¯ä¸ªæ ·æœ¬å¯¹åº”çš„pseudo labelå³ä¸ºå˜æ¢çš„åºå·æˆ–è€…è¯´ç§ç±»ã€‚ä¹‹ååœ¨æ–°çš„æ•°æ®é›†ä¸Šï¼ˆå¤§å°ä¸ºåŸæ¥çš„<span class="math inline">\(K\)</span>å€ï¼‰è®­ç»ƒ<span class="math inline">\(K\)</span>åˆ†ç±»ç½‘ç»œã€‚ç½‘ç»œçš„è¾“å‡ºä¸º<span class="math inline">\(P(\mathbf x^{(y^\prime)}|\boldsymbol\theta)=[P^{(y)}(\mathbf x^{(y^\prime)}|\boldsymbol\theta)]_{y=1}^K\)</span>ï¼Œæ¯ä¸ªç»´åº¦ä»£è¡¨è¾“å…¥æ ·æœ¬å¯¹åº”çš„å˜æ¢çš„æ¦‚ç‡ã€‚æ€»çš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[\min_\theta\frac{1}{N}\sum_{i=1}^{N}\mathcal L_{SS}(\mathbf x_i|\theta)\]</span></p><p>å…¶ä¸­<span class="math inline">\(\mathcal L_{SS}(\mathbf x_i|\theta)\)</span>ä»£è¡¨æ¯ä¸ªæ ·æœ¬å¯¹åº”çš„Lossï¼Œè¿™ä¸ªLosså¯ä»¥ç”±åˆ†ç±»å™¨åœ¨<span class="math inline">\(K\)</span>ä¸ªå˜æ¢ä¸Šçš„äº¤å‰ç†µæŸå¤±æ¥ç¡®å®šï¼š</p><p><span class="math display">\[\mathcal L_{SS}(\mathbf x_i|\boldsymbol\theta)=-\frac{1}{K}\sum_{y=1}^K\log(P^{(y)}(\mathbf x_i^{(y)}|\boldsymbol\theta))=-\frac{1}{K}\sum_{y=1}^K\log(P^{(y)}(O(\mathbf x_i|y)|\boldsymbol\theta))\]</span> <img src="https://i.loli.net/2020/07/14/ULAdYpzsoGfFwtD.png" srcset="/img/loading.gif" /></p><p>å˜æ¢é›†åˆ<span class="math inline">\(\mathcal O\)</span>ç”±ä¸€ç³»åˆ—åŸºæœ¬å˜æ¢çš„ç»„åˆç¡®å®šã€‚ä½œè€…å°†è¿™äº›åŸºæœ¬å˜æ¢åˆ†ä¸ºäº†ï¼š1) æ—‹è½¬ 2) ç¿»è½¬ 3) å¹³ç§»ï¼ŒåŒ…æ‹¬æ¨ªå‘å’Œçºµå‘ 4) Patchç½®æ¢ï¼ˆå‚è€ƒå›¾1(a)ä¸­çš„Patch Re-arrangingï¼‰ã€‚æœ€ç»ˆçš„å˜æ¢é›†åˆ<span class="math inline">\(\mathcal O\)</span>ç”±ä¸‰ä¸ªå­é›†ç»„æˆï¼Œåˆ†åˆ«æ˜¯<span class="math inline">\(\mathcal O_{RA}\)</span>ï¼ˆä»£è¡¨Regular Affineï¼Œå…¶ä¸­æ¯ä¸ªå˜æ¢ä¸ºæ—‹è½¬<span class="math inline">\(90Â°\)</span>çš„å€æ•°ã€ç¿»è½¬ã€æ¨ªå‘å¹³ç§»å’Œçºµå‘å¹³ç§»è¿™å››ä¸ªåŸºæœ¬å˜æ¢çš„å åŠ ï¼‰ï¼Œ<span class="math inline">\(\mathcal O_{IA}\)</span>ï¼ˆä»£è¡¨Irregular Affineï¼Œå…¶ä¸­æ¯ä¸ªå˜æ¢ä¸ºè¿›è¡Œ<span class="math inline">\(30Â°\)</span>çš„å€æ•°ä¸”ä¸ä¸º<span class="math inline">\(90Â°\)</span>çš„å€æ•°è§’åº¦çš„æ—‹è½¬ã€ç¿»è½¬è¿™ä¸¤ä¸ªåŸºæœ¬å˜æ¢çš„å åŠ ï¼‰å’Œ<span class="math inline">\(\mathcal O_{PR}\)</span>ï¼ˆåªåŒ…å«Patch Re-arrangingï¼‰ã€‚</p><p>ä¸ºäº†éªŒè¯SSDå­¦åˆ°çš„ç‰¹å¾çš„æœ‰æ•ˆæ€§ï¼Œä½œè€…å°†CAEæå–çš„ç‰¹å¾å’ŒSSDæå–çš„ç‰¹å¾åˆ†åˆ«ç”¨å­¤ç«‹æ£®æ—è¿›è¡Œå¼‚å¸¸æ£€æµ‹ï¼Œå‘ç°SSDæ•ˆæœæ›´å¥½ï¼ˆè§å›¾1(b)ï¼‰ã€‚</p><p>åˆ°è¿™é‡Œä¸ºæ­¢æœ¬æ–‡å’ŒGEOMåŸºæœ¬æ²¡æœ‰å¤§çš„åŒºåˆ«ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯åœ¨æ‰€é‡‡ç”¨çš„å‡ ä½•å˜æ¢ä¸­ï¼Œé‡‡ç”¨äº†éçº¿æ€§å˜æ¢ï¼ˆè¿›è¡Œ<span class="math inline">\(30Â°\)</span>çš„å€æ•°ä¸”ä¸ä¸º<span class="math inline">\(90Â°\)</span>çš„å€æ•°è§’åº¦çš„æ—‹è½¬ï¼‰ã€‚è€Œåœ¨GEOMä¸­ï¼Œæåˆ°è¿‡ä½¿ç”¨éçº¿æ€§å˜æ¢çš„è¯æ•ˆæœä¼šæ¯”è¾ƒå·®ï¼Œè‡³äºå…·ä½“çš„å½±å“å¦‚ä½•ï¼Œå¯èƒ½éœ€è¦å®éªŒæ¥ç¡®å®šã€‚</p><h2 id="inlier-priority-the-foundation-of-end-to-end-uod">Inlier Priority: The Foundation of End-to-end UOD</h2><p>åœ¨è¿™é‡Œä½œè€…ä¸»è¦å¯¹åœ¨è®­ç»ƒé›†åŒ…å«å°‘é‡å¼‚å¸¸çš„æƒ…å†µä¸‹åšå‡ºçš„ç†è®ºåˆ†æï¼Œä½œè€…å°†å…¶ç§°ä¸º<em>Inlier Priority</em>ï¼ŒåŸå¥å¦‚ä¸‹ï¼š</p><blockquote><p><em>Inlier Priority</em>: Despite that inliers/outliersare indiscriminately fed into SSD for training, SSD will prioritize the minimization of inliersâ€™ loss.</p></blockquote><h3 id="priority-by-gradient-magnitude">Priority by Gradient Magnitude</h3><p>å¯¹äºç¬¬<span class="math inline">\(c\)</span>ä¸ªç±»æ¥è¯´ï¼Œè®¾<code>softmax</code>å±‚å’Œå€’æ•°ç¬¬äºŒå±‚ä¹‹é—´çš„æƒé‡çŸ©é˜µä¸º<span class="math inline">\(\mathbf w_c=[w_{s,c}]^{(L+1)}_{s=1}\)</span>ï¼ŒæŸå¤±å‡½æ•°è®°ä¸º<span class="math inline">\(\mathcal L\)</span>ï¼Œæ¢¯åº¦è®°ä¸º<span class="math inline">\(\nabla_{\mathbf w_c}\mathcal L=[\nabla_{w_{s,c}}\mathcal L]^{(L+1)}_{s=1}\)</span>ã€‚è®¾è®­ç»ƒé›†<span class="math inline">\(X^{(c)}\)</span>åŒ…å«<span class="math inline">\(N_{in}\)</span>ä¸ªæ­£å¸¸æ ·æœ¬ï¼Œ<span class="math inline">\(N_{out}\)</span>ä¸ªå¼‚å¸¸æ ·æœ¬ã€‚è®°æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬å¯¹åº”çš„æ¢¯åº¦åˆ†åˆ«ä¸º<span class="math inline">\(\parallel\nabla^{(in)}_{\mathbf w_c}\mathcal L\parallel\)</span>å’Œ<span class="math inline">\(\parallel\nabla^{(out)}_{\mathbf w_c}\mathcal L\parallel\)</span>ï¼Œåœ¨ç½‘ç»œåªæœ‰ä¸€ä¸ªéšå±‚ä¸”é‡‡ç”¨<code>Sigmoid</code>ä½œä¸ºæ¿€æ´»å‡½æ•°æ—¶ï¼Œä¸¤è€…æ¢¯åº¦çš„æœŸæœ›ä¹‹æ¯”æœ‰å¦‚ä¸‹å…³ç³»ï¼š</p><p><span class="math display">\[\frac{E(\parallel\nabla^{(in)}_{\mathbf w_c}\mathcal L\parallel^2)}{E(\parallel\nabla^{(out)}_{\mathbf w_c}\mathcal L\parallel^2)}\approx\frac{N^2_{in}}{N^2_{out}}\]</span></p><p>åœ¨è®­ç»ƒé›†ä¸­ï¼Œæ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬çš„æ•°é‡æ˜¯æä¸å‡è¡¡çš„ï¼Œ<span class="math inline">\(N_{in}\gg N_{out}\)</span>ï¼Œæ‰€ä»¥æœ‰<span class="math inline">\(E(\parallel\nabla^{(in)}_{\mathbf w_c}\mathcal L\parallel^2)\gg E(\parallel\nabla^{(out)}_{\mathbf w_c}\mathcal L\parallel^2)\)</span>ã€‚</p><p>åœ¨ä½¿ç”¨æ›´å¤æ‚çš„ç½‘ç»œæ—¶ï¼Œä½œè€…é€šè¿‡å®éªŒå±•ç¤ºäº†æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬å¯¹åº”çš„æ¢¯åº¦å¤§å°çš„æ¯”è¾ƒï¼š</p><p><img src="https://i.loli.net/2020/07/16/iPa7h9HWqrnZvgx.png" srcset="/img/loading.gif" /></p><h3 id="priority-by-network-updating-direction">Priority by Network Updating Direction</h3><p>è¿™é‡Œä½œè€…é€šè¿‡æ¢¯åº¦æ›´æ–°çš„æ–¹å‘æ¥è¿›è¡Œäº†ç†è®ºä¸Šçš„è§£é‡Šã€‚å¯¹äºä¸€ä¸ªBatchçš„æ•°æ®<span class="math inline">\(X\)</span>ï¼Œæ¢¯åº¦ä¸º<span class="math inline">\(-\nabla_\theta\mathcal L(X)=-\frac{1}{N}\sum_i\nabla_\theta\mathcal L(\mathbf x_i)\)</span>ï¼Œå¦‚æœå°†è¯¥æ¢¯åº¦åœ¨Batchä¸­æŸä¸€æ ·æœ¬<span class="math inline">\(\mathbf x_i\)</span>å¯¹åº”çš„æ¢¯åº¦çš„æ–¹å‘ä¸Šè¿›è¡Œåˆ†è§£<span class="math inline">\(-\nabla_\theta\mathcal L(\mathbf x_i):d_i=-\nabla_\theta\mathcal L(X)\cdot\frac{-\nabla_\theta\mathcal L(\mathbf x_i)}{\parallel -\nabla_\theta\mathcal L(\mathbf x_i)\parallel}\)</span>ï¼Œè¿™ä»£è¡¨äº†æ€»çš„Lossåœ¨å¤šå¤§ç¨‹åº¦ä¸Šå‡å°æ ·æœ¬<span class="math inline">\(\mathbf x_i\)</span>å¯¹åº”çš„Lossï¼Œç”±äºä¸€ä¸ªBatchå³åŒ…å«æ­£å¸¸æ ·æœ¬ï¼Œä¹Ÿå¯èƒ½åŒ…å«å¼‚å¸¸æ ·æœ¬ï¼Œæ‰€ä»¥ä½œè€…å°†ä¸¤è€…å¯¹åº”çš„æ¢¯åº¦æ–¹å‘è´¡çŒ®è¿›è¡Œäº†å¯è§†åŒ–ï¼š</p><p><img src="https://i.loli.net/2020/07/16/U5fVk8YOEGPx3Q7.png" srcset="/img/loading.gif" /></p><p>å¯ä»¥çœ‹åˆ°éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œæ­£å¸¸æ ·æœ¬å¯¹åº”çš„è´¡çŒ®æ›´é«˜ã€‚</p><p>PS: æˆ‘ä»¥ä¸ºä½œè€…ä¼šå¯¹åŸºäºå‡ ä½•å˜æ¢çš„å¼‚å¸¸æ£€æµ‹ä¸ºä»€ä¹ˆæœ‰æ•ˆåšä¸€äº›ç†è®ºä¸Šçš„è§£é‡Šï¼Œä¸è¿‡å´æ²¡æœ‰ã€‚è¿™é‡Œåªæ˜¯å¯¹åœ¨è®­ç»ƒé›†åŒ…å«å°‘é‡å¼‚å¸¸çš„æƒ…å†µä¸‹åšå‡ºçš„ç†è®ºåˆ†æï¼Œè€Œè¿™ä¸ªå®é™…ä¸Šç›´è§‰ä¸Šå°±å¾ˆæ˜¾ç„¶äº†ã€‚</p><h2 id="scoring-strategies-for-uod">Scoring Strategies for UOD</h2><p>ä½œè€…é‡‡ç”¨äº†ä¸‰ç§æ–¹æ³•æ¥è®¡ç®—å¼‚å¸¸åˆ†æ•°ï¼š</p><h3 id="pseudo-label-based-score-pl">Pseudo Label based Score (PL)</h3><p>å¯¹äºä¸€ä¸ªæµ‹è¯•æ ·æœ¬<span class="math inline">\(\mathbf x\)</span>ï¼Œå¯¹å…¶è¿›è¡Œ<span class="math inline">\(K\)</span>ä¸ªå‡ ä½•å˜æ¢ï¼Œé€šè¿‡åˆ†ç±»å™¨ä¼šå¾—åˆ°<span class="math inline">\(K\)</span>ä¸ªè¾“å‡ºï¼Œå¯¹äºç¬¬<span class="math inline">\(k\)</span>ä¸ªè¾“å‡ºï¼Œæˆ‘ä»¬åªå–å…¶ç¬¬<span class="math inline">\(k\)</span>ä¸ªåˆ†é‡ï¼Œæœ€åæŠŠä»–ä»¬åŠ èµ·æ¥é™¤ä»¥<span class="math inline">\(K\)</span>ï¼š</p><p><span class="math display">\[S_{pl}(\mathbf x)=\frac{1}{K}\sum_{y=1}^K P^{(y)}(\mathbf x^{(y)}|\boldsymbol\theta)\]</span></p><h3 id="maximum-probability-based-score-mp">Maximum Probability based Score (MP)</h3><p>è¿™é‡Œç¨æœ‰ä¸åŒï¼Œå¯¹äºç¬¬<span class="math inline">\(k\)</span>ä¸ªè¾“å‡ºï¼Œæˆ‘ä»¬å–å…¶å€¼æœ€å¤§çš„åˆ†é‡ï¼Œè€Œä¸æ˜¯ç¬¬<span class="math inline">\(k\)</span>ä¸ªåˆ†é‡ï¼š</p><p><span class="math display">\[S_{mp}(\mathbf x)=\frac{1}{K}\sum_{y=1}^K\max_t P^{(t)}(\mathbf x^{(y)}|\boldsymbol\theta)\]</span></p><h3 id="negative-entropy-based-score-ne">Negative Entropy based Score (NE)</h3><p>ä½œè€…è®¤ä¸ºï¼Œæ ‡ç­¾ä¸ºOne-Hotå‘é‡ï¼Œåˆ†ç±»å™¨çš„è¾“å‡ºåˆ†å¸ƒè¶Šâ€œå°–å³°â€å°±è¶Šæ¥è¿‘äºæ­£å¸¸æ ·æœ¬ï¼Œè€Œè¶Šâ€œå¹³å‡â€å°±è¶Šæ¥è¿‘äºå¼‚å¸¸æ ·æœ¬ï¼Œæ‰€ä»¥ä½œè€…æå‡ºä½¿ç”¨ç†µæ¥æè¿°åˆ†ç±»å™¨è¾“å‡ºçš„â€œå°–é”åº¦â€ï¼š <span class="math display">\[S_{ne}(\mathbf x)=-\frac{1}{K}\sum_{y=1}^K H(P(\mathbf x^{(y)}|\boldsymbol\theta))=\frac{1}{K}\sum_{y=1}^K\sum_{t=1}^K P^{(t)}(\mathbf x^{(y)}|\boldsymbol\theta)\log(P^{(t)}(\mathbf x^{(y)}|\boldsymbol\theta))\]</span> è¿™é‡Œä½œè€…å¯¹ç¬¬ä¸€ç§æ–¹æ³•å¾—åˆ°çš„ç»“æœè¿›è¡Œäº†å¯è§†åŒ–ï¼š</p><p><img src="https://i.loli.net/2020/07/16/PgzqXIdJ67s3BtG.png" srcset="/img/loading.gif" /></p><p>PSï¼šå¯¹æ¯”NIPS18 çš„Dirichlet Normality Score</p><ol type="1"><li>ä¹Ÿç”¨åˆ°äº†å…¨éƒ¨<span class="math inline">\(K\)</span>ä¸ªç»´åº¦çš„ä¿¡æ¯</li><li>ç›¸å½“äºå¯¹åˆ†ç±»å™¨çš„è¾“å‡ºåšäº†è¿ªåˆ©å…‹é›·åˆ†å¸ƒçš„å…ˆéªŒå‡è®¾ï¼Œç„¶åé€šè¿‡è®­ç»ƒé›†çš„è¾“å‡ºä¼°è®¡åˆ†å¸ƒå‚æ•°ã€‚å› ä¸ºç›´è§‰ä¸Šå¯¹äºæ­£å¸¸åˆ†å¸ƒæ¥è¯´ï¼Œåˆ†ç±»å™¨çš„è¾“å‡ºåˆ†å¸ƒå½¢çŠ¶ä¸Šéƒ½ç±»ä¼¼ä¸€ä¸ªå°–å³°ï¼Œä½†å¯¹äºä¸åŒçš„æ•°æ®é›†æ¥è¯´å…·ä½“å½¢çŠ¶è¿˜æ˜¯ä¼šæœ‰æ‰€å·®å¼‚</li></ol><h1 id="experiments">Experiments</h1><h2 id="experiment-setup">Experiment Setup</h2><p>æ•°æ®é›†ç”¨åˆ°äº†MNIST, Fashion-MNIST (F-MNIST) , CIFAR10, SVHNå’ŒCIFAR100ã€‚ä¸ºäº†æ¨¡æ‹Ÿæ— ç›‘ç£å¼‚å¸¸æ£€æµ‹çš„ç¯å¢ƒï¼Œäººä¸ºåœ¨è®­ç»ƒé›†ä¸­åŠ å…¥å¼‚å¸¸æ ·æœ¬ï¼Œå¼‚å¸¸çš„æ¯”ä¾‹<span class="math inline">\(\rho\)</span>ä»<span class="math inline">\(5\%\)</span>åˆ°<span class="math inline">\(25\%\)</span>ä»¥<span class="math inline">\(5\%\)</span>çš„æ­¥é•¿é€’å¢ã€‚è¯„æµ‹æ ‡å‡†é‡‡ç”¨AUPRå’ŒAUROCã€‚</p><h2 id="uod-performance-comparison-and-discussion">UOD Performance Comparison and Discussion</h2><p>ä¸‹è¡¨å±•ç¤ºäº†æ¨¡å‹æ€§èƒ½å¯¹æ¯”ç»“æœï¼š</p><p><img src="https://i.loli.net/2020/07/16/G3agKPuJBowFmIW.png" srcset="/img/loading.gif" /></p><p>ä¸‹å›¾å±•ç¤ºäº†åœ¨ä¸åŒçš„Outlier Ratioä¸‹çš„æ€§èƒ½å¯¹æ¯”ï¼š</p><p><img src="https://i.loli.net/2020/07/16/h6iYjBkrwQdFvMJ.png" srcset="/img/loading.gif" /></p><p>ä¸‹å›¾å±•ç¤ºäº†åœ¨ä¸åŒçš„å˜æ¢é›†åˆï¼Œç½‘ç»œç»“æ„ï¼Œå¼‚å¸¸åˆ†æ•°çš„æ¡ä»¶ä¸‹çš„æ€§èƒ½ï¼š</p><p><img src="https://i.loli.net/2020/07/16/waWAi7zI3QpOcf6.png" srcset="/img/loading.gif" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Self-Supervised Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PRML Notes 1.1: Probability Distributions - Binary and Multinomial Variables</title>
    <link href="/2020/06/22/PRML-Notes-1-1-Probability-Distributions-Binary-and-Multinomial-Variables/"/>
    <url>/2020/06/22/PRML-Notes-1-1-Probability-Distributions-Binary-and-Multinomial-Variables/</url>
    
    <content type="html"><![CDATA[<h1 id="overview">Overview</h1><p>è¿™æ˜¯PRML (Pattern Recognition and Machine Learning) ç¬¬äºŒç« <code>Probability Distributions</code>ç¬”è®°çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œä¸»è¦åŒ…æ‹¬<code>2.1. Binary Variables</code>å’Œ<code>2.2. Multinomial Variables</code>è¿™ä¸¤èŠ‚ã€‚</p><h1 id="probability-distributions-for-binary-variables">Probability Distributions for Binary Variables</h1><h2 id="intro">Intro</h2><p>è¿™ä¸€èŠ‚ä¸»è¦é’ˆå¯¹äºŒå€¼éšæœºå˜é‡çš„å»ºæ¨¡ï¼Œå³<span class="math inline">\(x\in\{0,1\}\)</span>ã€‚è¿™é‡Œå¯ä»¥æƒ³è±¡ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªç¡¬å¸ï¼Œ<span class="math inline">\(x=1\)</span>ä»£è¡¨æ­£é¢æœä¸Šï¼Œè€Œ<span class="math inline">\(x=0\)</span>ä»£è¡¨åé¢æœä¸Šï¼Œå¹¶ä¸”æ­£é¢æœä¸Šçš„æ¦‚ç‡ä¸º<span class="math inline">\(\mu\)</span>ï¼Œå³ï¼š <span class="math display">\[p(x=1|\mu)=\mu\]</span> å…¶ä¸­<span class="math inline">\(0\leqslant \mu \leqslant 1\)</span>ã€‚<span class="math inline">\(x\)</span>çš„æ¦‚ç‡åˆ†å¸ƒå¯ä»¥å†™ä¸ºï¼š <span class="math display">\[\text{Bern}(x|\mu)=\mu^x(1-\mu)^{1-x}\]</span> ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„<strong>ä¼¯åŠªåˆ©åˆ†å¸ƒ (Bernoulli Distribution)</strong>ã€‚å…¶å‡å€¼å’Œæ–¹å·®åˆ†åˆ«ä¸ºï¼š <span class="math display">\[\begin{align}\mathbb E[x]&amp;=\mu\\\text{var}[x] &amp;= \mu(1-\mu)\end{align}\]</span> ç°åœ¨æ¥è€ƒè™‘å‚æ•°ä¼°è®¡ä»»åŠ¡ã€‚å‡è®¾æˆ‘ä»¬æ­£åœ¨è¿›è¡Œä¸€ä¸ªæŠ•ç¡¬å¸çš„å®éªŒï¼Œæ¯ä¸€æ¬¡æŠ•å¸éƒ½æœä»ä¼¯åŠªåˆ©åˆ†å¸ƒä¸”ç›¸äº’ç‹¬ç«‹ï¼Œæˆ‘ä»¬å°†æ¯æ¬¡é‡‡é›†åˆ°çš„è§‚æµ‹å€¼ç»„æˆæ•°æ®é›†<span class="math inline">\(\mathcal D=\{x_1,\cdots,x_N\}\)</span>ï¼Œåˆ™ä¼¼ç„¶å‡½æ•°ä¸ºï¼š <span class="math display">\[p(\mathcal D|\mu)=\prod_{n=1}^N p(x_n|\mu)=\prod_{n=1}^N \mu^{x_n}(1-\mu)^{1-x_n}\]</span> å¦‚æœé‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°ï¼Œè¿™ç­‰ä»·äºæœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶ï¼š <span class="math display">\[\ln p(\mathcal D|\mu)=\sum_{n=1}^{N}\ln p(x_n|\mu)=\sum_{n=1}^N\{x_n\ln\mu+(1-x_n)\ln(1-\mu)\}\]</span> ä»¤å…¶å¯¼æ•°ä¸º0å¾—åˆ°æå€¼ç‚¹ï¼š <span class="math display">\[\mu_{ML}=\frac{1}{N}\sum_{n=1}^N x_n\]</span> è¿™ç›¸å½“äºæ ·æœ¬å‡å€¼ï¼Œä¸è¿‡è¿™æ ·åšä¼šæœ‰ä¸¥é‡çš„é—®é¢˜ã€‚å‡è®¾æˆ‘ä»¬çš„æ•°æ®é›†ä¸º<span class="math inline">\(\mathcal D=\{1,1,1\}\)</span>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªæ”¶é›†åˆ°äº†ä¸‰ä¸ªæ ·æœ¬ï¼Œå¹¶ä¸”éƒ½æ˜¯æ­£ä¾‹ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°<span class="math inline">\(\mu_{ML}=1\)</span>ï¼Œè€Œè¿™æ˜¾ç„¶æ˜¯ä¸¥é‡è¿‡æ‹Ÿåˆçš„ã€‚ç¨åæˆ‘ä»¬ä¼šè¯´è¯´å¦‚ä½•åº”å¯¹è¿™ç§æƒ…å†µï¼ˆåŠ å…¥å…ˆéªŒï¼‰ã€‚</p><h2 id="binomial-distribution">Binomial Distribution</h2><p>æˆ‘ä»¬åŒæ ·å¯ä»¥å¯¹å¤šæ¬¡ä¼¯åŠªåˆ©å®éªŒè¿›è¡Œæ¦‚ç‡å»ºæ¨¡ã€‚è®°<span class="math inline">\(m\)</span>ä¸ºæˆåŠŸçš„æ¬¡æ•°ï¼Œ<span class="math inline">\(N\)</span>ä¸ºæ•°æ®é›†å¤§å°ï¼Œå¯çŸ¥è¿™ä¸ªæ¦‚ç‡åº”è¯¥ä¸<span class="math inline">\(\mu^m(1-\mu)^{N-m}\)</span>æˆæ­£æ¯”ã€‚ä¹˜ä»¥æ ‡å‡†åŒ–ç³»æ•°åå³æˆ‘ä»¬ç†ŸçŸ¥çš„<strong>äºŒé¡¹åˆ†å¸ƒ (Binomial Distribution)</strong>ï¼š <span class="math display">\[\text{Bin}(m|N,\mu)=\binom{N}{m}\mu^m(1-\mu)^{N-m}\]</span></p><p>å…¶ä¸­ï¼š <span class="math display">\[\binom{N}{m}=\frac{N!}{(N-m)!m!}\]</span> å…¶å‡å€¼å’Œæ–¹å·®åˆ†åˆ«ä¸ºï¼š <span class="math display">\[\begin{align}\mathbb E[m]&amp;=N\mu\\\text{var}[m]&amp;=N\mu(1-\mu)\end{align}\]</span></p><h2 id="beta-distribution">Beta Distribution</h2><p>ç°åœ¨æˆ‘ä»¬æ¥è®¨è®ºå¦‚ä½•è§£å†³åˆšæ‰æåˆ°çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡è¿‡æ‹Ÿåˆé—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨è´å¶æ–¯çš„æ€è·¯ï¼Œå¯¹<span class="math inline">\(\mu\)</span>å¼•å…¥äº†å…ˆéªŒåˆ†å¸ƒ<span class="math inline">\(p(\mu)\)</span>ã€‚è€Œè¿™ä¸ªåˆ†å¸ƒéœ€è¦å…·æœ‰è‰¯å¥½çš„è§£é‡Šæ€§å’Œæ•°å­¦æ€§è´¨ã€‚</p><p>æ ¹æ®è´å¶æ–¯å®šç†ï¼š <span class="math display">\[p(\mu|\mathcal D)=\frac{p(\mathcal D|\mu)p(\mu)}{p(\mathcal D)}\]</span> è€Œ<span class="math inline">\(p(\mathcal D)=\int_0^1 p(\mathcal D|\mu)p(\mu)\mathrm d\mu\)</span>åªå—æ•°æ®é›†å½±å“ï¼Œè€Œæ•°æ®é›†æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ä¸ºå¸¸æ•°ï¼Œå› æ­¤<span class="math inline">\(p(\mu|\mathcal D)\propto p(\mathcal D|\mu)p(\mu)\)</span>ã€‚è€Œä¼¼ç„¶å‡½æ•°ä¸º<span class="math inline">\(\mu^x(1-\mu)^{1-x}\)</span>çš„ä¹˜ç§¯ï¼Œå¦‚æœå…ˆéªŒä¹Ÿé‡‡ç”¨<span class="math inline">\(\mu\)</span>å’Œ<span class="math inline">\(1-\mu\)</span>çš„å¹‚çš„ä¹˜ç§¯çš„å½¢å¼ï¼Œé‚£ä¹ˆåéªŒåˆ†å¸ƒä¹Ÿå°†å’Œå…ˆéªŒå½¢å¼ç›¸åŒï¼Œè¿™ç§æ€§è´¨åœ¨ç»Ÿè®¡å­¦ä¸­è¢«ç§°ä¸º<strong>å…ˆéªŒå…±è½­ (conjugacy)</strong>ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç»™å‡ºè¿™ä¸ªå…ˆéªŒåˆ†å¸ƒï¼Œå†æ¥åˆ†æå®ƒçš„æ€§è´¨ã€‚è¿™ä¸ªåˆ†å¸ƒå«åš<strong>Betaåˆ†å¸ƒ (Beta Distribution)</strong><span class="math inline">\(P(\mu|a,b)\sim \text{Beta}(a,b)\)</span>ï¼š <span class="math display">\[\begin{align}\text{Beta}(\mu|a,b) &amp;= \frac{\Gamma(a+b)}{\Gamma(a\Gamma(b)}\mu^{a-1}(1-\mu)^{b-1}\\ &amp;= \frac{1}{B(a,b)}\mu^{a-1}(1-\mu)^{b-1}\end{align}\]</span> <span class="math inline">\(B(\boldsymbol \alpha,\beta)\)</span>ç§°ä¸ºBå‡½æ•°ï¼Œä¸ºä¸€ä¸ªæ ‡å‡†åŒ–å‡½æ•°ï¼š <span class="math display">\[\begin{align}B(a,b) = \frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}\end{align}\]</span> å…¶ç›®çš„æ˜¯ä¸ºäº†ä½¿æ•´ä¸ªæ¦‚ç‡åˆ†å¸ƒç§¯åˆ†ç­‰äº1è€Œå­˜åœ¨çš„ã€‚Gammaå‡½æ•°çš„å®šä¹‰ä¸ºï¼š <span class="math display">\[\Gamma(x)=\int_0^{\infty}s^{x-1}e^{-s}\mathrm d s\]</span> Gammaå‡½æ•°æœ‰ä¸€ä¸ªæ€§è´¨ï¼š</p><p><span class="math display">\[\Gamma(x+1)=x\Gamma(x)\]</span> è¯æ˜ä¸ºï¼š <span class="math display">\[\begin{align*}\Gamma(x+1) &amp;= \int_{0}^{\infty} {s^{x} e^{-s} ds} \\&amp;= \big[s^{x} (-e^{-s})\big] \big|_{0}^{\infty} - \int_{0}^{\infty} {(x s^{x-1}) (-e^{-s}) ds} \\&amp;= (0 - 0) + x \int_{0}^{\infty} {s^{x-1} e^{-s} ds} \\&amp;= x \Gamma(x)\end{align*}\]</span></p><p>é™¤æ­¤ä¹‹å¤–ï¼š</p><p><span class="math display">\[\Gamma(1)=1\\\Gamma(\frac{1}{2})=\sqrt{\pi}\]</span></p><p>å¯ä»¥éªŒè¯ï¼š <span class="math display">\[\int_0^1\text{Beta}(\mu|a,b)\mathrm d\mu=1\]</span></p><p>Betaåˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ä¸ºï¼š</p><p><span class="math display">\[\mathbb E[\mu]=\frac{a}{a+b}\\\text{var}[\mu]=\frac{ab}{(a+b)^2(a+b+1)}\]</span></p><p>å› ä¸ºåéªŒåˆ†å¸ƒä¸å…ˆéªŒå’Œä¼¼ç„¶å‡½æ•°çš„ä¹˜ç§¯æˆæ¯”ä¾‹ï¼Œé‚£ä¹ˆï¼š <span class="math display">\[p(\mu|m,l,a,b)\propto\mu^{m+a-1}(1-\mu)^{l+b-1}\]</span></p><p>å…¶ä¸­<span class="math inline">\(l=N-m\)</span>ã€‚ä¹˜ä¸Šæ ‡å‡†åŒ–å› å­ï¼Œå°±å¾—åˆ°ï¼š <span class="math display">\[p(\mu|m,l,a,b)=\frac{\Gamma(m+a+l+b)}{\Gamma(m+a)\Gamma(l+b)}\mu^{m+a-1}(1-\mu)^{l+b-1}\]</span> å¾—åˆ°çš„ä»ç„¶æ˜¯Betaåˆ†å¸ƒï¼Œç›¸å½“äºæŠŠ<span class="math inline">\(a\rightarrow{m+a}\)</span>ï¼Œ<span class="math inline">\(b\rightarrow{l+b}\)</span>ã€‚åŒæ—¶ä¸éš¾å‘ç°ï¼Œå‚æ•°<span class="math inline">\(a\)</span>å’Œ<span class="math inline">\(b\)</span>éƒ½æœ‰æ¯”è¾ƒç›´è§‚çš„æ„ä¹‰ã€‚<span class="math inline">\(a\)</span>å¯ä»¥çœ‹ä½œæ˜¯å†å²è®°å½•ä¸­ï¼ŒæˆåŠŸçš„æ¬¡æ•°ï¼Œ<span class="math inline">\(b\)</span>å¯ä»¥çœ‹ä½œæ˜¯å†å²è®°å½•ä¸­å¤±è´¥çš„æ¬¡æ•°ï¼Œæ¯”å¦‚<span class="math inline">\(a=2\)</span>ï¼Œ<span class="math inline">\(b=3\)</span>ï¼Œæ ¹æ®ç»éªŒæˆåŠŸçš„æ¦‚ç‡åº”è¯¥åœ¨<span class="math inline">\(\frac{2}{2+3}=0.4\)</span>å·¦å³ï¼Œå³æˆ‘ä»¬çš„å…ˆéªŒä¸ºæˆåŠŸçš„æ¦‚ç‡ä¸º<span class="math inline">\(0.4\)</span>ï¼ˆè§ä¸‹å›¾å·¦ä¸‹è§’çš„å­å›¾ï¼‰ã€‚å¦‚æœåœ¨å®éªŒä¸­ï¼Œåˆè¿›è¡Œäº†<span class="math inline">\(7\)</span>æ¬¡å®éªŒï¼Œå…¶ä¸­<span class="math inline">\(m=6\)</span>ï¼Œ<span class="math inline">\(l=1\)</span>ï¼Œç”±äºæˆåŠŸçš„æ¬¡æ•°å˜å¤šäº†ï¼Œ<span class="math inline">\(a=2+6=8\)</span>ï¼Œ<span class="math inline">\(b=3+1=4\)</span>ï¼Œç›´è§‰ä¸Šæ¥è¯´æˆ‘ä»¬å¯¹æˆåŠŸæ¦‚ç‡çš„ä¼°è®¡åº”å½“ç›¸åº”æé«˜ï¼Œå¤§æ¦‚ä¸º<span class="math inline">\(\frac{8}{8+4}\approx 0.67\)</span>å·¦å³ã€‚è¿™æ—¶çš„Betaåˆ†å¸ƒå¦‚å³ä¸‹è§’çš„å›¾çš„æ ·å­ï¼Œä¹Ÿå°è¯äº†æˆ‘ä»¬çš„ç›´è§‰ã€‚</p><p><img src="https://i.loli.net/2020/06/25/3hcj18ELXl4iWy6.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä»¥ä¸‹ä¸ºä¸åŒå‚æ•°å¯¹åº”çš„Betaåˆ†å¸ƒçš„äº’åŠ¨æ¼”ç¤ºï¼š</p><div><iframe width="650px" height="450px" frameborder="0" style="dispaly:blockï¼›" src="http://qfxiao.me/html/beta_distribution_vis.html"></iframe></div><p>æœ€åï¼ŒBetaè¿˜æœ‰ä¸€ä¸ªæœ‰è¶£çš„åº”ç”¨å°±æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸æ–­æ¥æ”¶åˆ°æ–°çš„è§‚æµ‹æ•°æ®ï¼Œé‚£ä¹ˆæ—§çš„åéªŒåˆ†å¸ƒåˆ™å¯ä»¥ä½œä¸ºæ–°çš„å…ˆéªŒåˆ†å¸ƒå°†å‚æ•°æ›´æ–°ä¸‹å» ã€‚è¿™ç›¸å½“äºè¯´ï¼ŒåŸºäºå·²æœ‰çš„è§‚æµ‹æ•°æ®ï¼Œæˆ‘ä»¬æå‡ºä¸€ä¸ªå…ˆéªŒBetaåˆ†å¸ƒï¼Œç„¶åæ ¹æ®æ–°å¾—åˆ°çš„ä¸€æ‰¹è§‚æµ‹æ•°æ®ï¼Œç”¨å…ˆéªŒBetaåˆ†å¸ƒè®¡ç®—ä¸€ä¸ªä¼¼ç„¶å‡½æ•°ï¼Œå°†ä¼¼ç„¶å‡½æ•°å’Œå…ˆéªŒBetaåˆ†å¸ƒä¹˜èµ·æ¥ï¼Œå½’ä¸€åŒ–åå¾—åˆ°äº†æ–°çš„åéªŒåˆ†å¸ƒï¼Œåªè¦ä¸æ–­æœ‰æ–°çš„è§‚æµ‹æ•°æ®æ¥æ”¶åˆ°ï¼Œå°±å¯ä»¥æŠŠåéªŒåˆ†å¸ƒä½œä¸ºæ–°çš„å…ˆéªŒï¼Œä¸æ–­æ›´æ–°ä¸‹å»ã€‚è¿™æ ·åšçš„ä¼˜åŠ¿æ˜¯å¯¹äºå¤§æ•°æ®é›†ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ•´ä¸ªæ•°æ®é›†ï¼Œè€Œæ˜¯åªéœ€è¦ä¸€æ‰¹ä¸€æ‰¹çš„æ›´æ–°å³å¯ã€‚</p><h1 id="probability-distributions-for-multinomial-variables">Probability Distributions for Multinomial Variables</h1><h2 id="intro-1">Intro</h2><p>å‰é¢æˆ‘ä»¬è®¨è®ºäº†äºŒå€¼éšæœºå˜é‡ï¼Œç°åœ¨æˆ‘ä»¬å°†å…¶æ‰©å±•åˆ°å¤šå€¼å˜é‡ã€‚è®¾ä¸€ä¸ª<span class="math inline">\(K\)</span>ç»´å‘é‡<span class="math inline">\(\mathbf x\)</span>ï¼Œå½“<span class="math inline">\(x_k\)</span>ä¸º<span class="math inline">\(1\)</span>çš„æ—¶å€™å…¶ä»–å…ƒç´ éƒ½ä¸º<span class="math inline">\(0\)</span>ï¼Œå¦‚<span class="math inline">\(K=6,x_3=1\)</span>æ—¶<span class="math inline">\(\mathbf x\)</span>è¡¨ç¤ºä¸º<span class="math inline">\(\mathbf x=(0,0,1,0,0,0)^\top\)</span>ã€‚å¦‚æœ<span class="math inline">\(p(x_k=1)=\mu_k\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(\mathbf x\)</span>çš„æ¦‚ç‡åˆ†å¸ƒä¸ºï¼š <span class="math display">\[p(\mathbf x|\boldsymbol \mu)=\prod_{k=1}^{K}\mu_k^{x_k}\]</span> <span class="math inline">\(\mu_k\)</span>æ»¡è¶³<span class="math inline">\(\sum_k \mu_k=1\)</span>å’Œ<span class="math inline">\(\mu_k\geqslant 0\)</span>ï¼Œè¯¥åˆ†å¸ƒè¢«ç§°ä½œæ˜¯<strong>Categorical Distribution</strong>ã€‚æ˜“çŸ¥å…¶å‡å€¼ä¸ºï¼š <span class="math display">\[\begin{align}\mathbb E[\mathbf x|\boldsymbol \mu]=\sum_{\mathbf x}p(\mathbf x|\boldsymbol \mu)\mathbf x=\boldsymbol \mu\end{align}\]</span> å‡è®¾æˆ‘ä»¬æœ‰å¤§å°ä¸º<span class="math inline">\(N\)</span>çš„æ•°æ®é›†<span class="math inline">\(\mathcal D\)</span>ï¼Œæ¯ä¸ªæ ·æœ¬æœä»è¯¥åˆ†å¸ƒä¸”ç›¸äº’ç‹¬ç«‹ï¼Œé‚£ä¹ˆä¼¼ç„¶å‡½æ•°ï¼š <span class="math display">\[p(\mathcal D|\boldsymbol \mu)=\prod_{n=1}^N\prod_{k=1}^K \mu_k^{x_{nk}}=\prod_{k=1}^K \mu_k^{\sum_n x_{nk}}=\prod_{k=1}^K\mu_k^{m_k}\]</span> å…¶ä¸­<span class="math inline">\(m_k=\sum_n x_{nk}\)</span>ï¼Œå³<span class="math inline">\(x_k=1\)</span>çš„æ•°é‡ã€‚ä¸ºäº†æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶åŒæ—¶ä¿è¯<span class="math inline">\(\sum_k \mu_k=1\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼š <span class="math display">\[\sum_{k=1}^K m_k\ln \mu_k+\lambda\left(\sum_{k=1}^K\mu_k-1\right)\]</span> æˆ‘ä»¬å¾—åˆ°<span class="math inline">\(\mu_k=-m_k/\lambda\)</span>ã€‚é€šè¿‡<span class="math inline">\(\sum_k \mu_k=1\)</span>å¾—å‡º<span class="math inline">\(\lambda=-N\)</span>ï¼Œæ•…æœ€åæˆ‘ä»¬æœ‰ï¼š <span class="math display">\[\mu_k^{ML}=\frac{m_k}{N}\]</span></p><p>è¿™ç›¸å½“äºæ˜¯<span class="math inline">\(x_k=1\)</span>çš„æ•°é‡é™¤ä»¥æ€»æ•°ã€‚</p><h2 id="multinomial-distribution">Multinomial Distribution</h2><p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å¤šæ¬¡å®éªŒè¿›è¡Œå»ºæ¨¡ï¼Œå‡è®¾è¿›è¡Œ<span class="math inline">\(N\)</span>æ¬¡ç‹¬ç«‹å®éªŒï¼Œæ¦‚ç‡åˆ†å¸ƒå¯ä»¥å†™ä¸ºï¼š</p><p><span class="math display">\[\text{Mult}(m_1,m_2,\cdots,m_K|\boldsymbol\mu,N)=\binom{N}{m_1m_2\cdots m_K}\prod_{k=1}^K\mu_k^{m_k}\]</span></p><p>è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„<strong>å¤šé¡¹åˆ†å¸ƒ (Multinomial Distribution)</strong>ï¼Œå…¶ä¸­<span class="math inline">\(\binom{N}{m_1m_2\cdots m_K}\)</span>ä¸ºæ­£åˆ™åŒ–å› å­ï¼š <span class="math display">\[\binom{N}{m_1m_2\cdots m_K}=\frac{N!}{m_1!m_2!\cdots m_K!}\]</span> æ³¨æ„<span class="math inline">\(\sum\limits_{k=1}^K m_k=N\)</span>ã€‚</p><h2 id="dirichlet-distribution">Dirichlet Distribution</h2><p>æœ‰äº†å‰é¢Betaçš„å¯å‘ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥å¯¹å¤šé¡¹åˆ†å¸ƒçš„å‚æ•°<span class="math inline">\(\mu_k\)</span>å»ºç«‹å…±è½­å…ˆéªŒã€‚é¦–å…ˆæ ¹æ®ä¼¼ç„¶å‡½æ•°ï¼Œæˆ‘ä»¬çŸ¥é“å…ˆéªŒåº”å½“ä¸<span class="math inline">\(\mu_k\)</span>çš„å¹‚çš„ä¹˜ç§¯æˆæ¯”ä¾‹ï¼š</p><p><span class="math display">\[p(\boldsymbol \mu|\boldsymbol \alpha) \propto \prod_{k=1}^{K}\mu_k^{a_{k-1}}\]</span></p><p>å…¶ä¸­<span class="math inline">\(0\leqslant \mu_k\leqslant 1\)</span>ä¸”<span class="math inline">\(\sum_k\mu_k=1\)</span>ã€‚å’ŒBetaåˆ†å¸ƒä¸åŒï¼Œç”±äºè¦æ»¡è¶³<span class="math inline">\(\sum\mu_k=1\)</span>ï¼Œæ‰€ä»¥<span class="math inline">\(\{\mu_k\}\)</span>çš„å–å€¼ä¼šä½äº<span class="math inline">\(K-1\)</span>çš„å•çº¯å‹ä¸Šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/N8CSMvmlRz91Gqy.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>åŠ ä¸Šæ ‡å‡†åŒ–å› å­ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†æ‰€è°“çš„å…ˆéªŒåˆ†å¸ƒï¼Œç§°ä¹‹ä¸º<strong>è¿ªåˆ©å…‹é›·åˆ†å¸ƒ (Dirichlet Distribution)</strong>ï¼š <span class="math display">\[\text{Dir}(\boldsymbol \mu|\boldsymbol\alpha)=\frac{\Gamma(\alpha_0)}{\Gamma(\alpha_1)\cdots\Gamma(\alpha_K)}\prod_{k=1}^K\mu_k^{a_{k-1}}\]</span></p><p>å…¶ä¸­<span class="math inline">\(\Gamma(\cdot)\)</span>ä¸ºGammaå‡½æ•°ï¼Œ<span class="math inline">\(\alpha_0=\sum\limits_{k=1}^K\alpha_k\)</span>ã€‚ä¸‹å›¾ä¸ºä¸åŒæ¡ä»¶ä¸‹çš„è¿ªåˆ©å…‹é›·åˆ†å¸ƒçš„å¯è§†åŒ–ï¼š</p><p><img src="https://i.loli.net/2020/06/25/amGtuvPNoOM7kWZ.png" srcset="/img/loading.gif" /></p><p><span class="math inline">\(\boldsymbol \mu\)</span>çš„åéªŒä¸å…ˆéªŒå’Œä¼¼ç„¶å‡½æ•°çš„ä¹˜ç§¯æˆæ­£æ¯”ï¼š</p><p><span class="math display">\[p(\boldsymbol\mu|\mathcal D,\boldsymbol\alpha)\propto p(\mathcal D|\boldsymbol\mu)p(\boldsymbol\mu|\boldsymbol\alpha)\propto\prod_{k=1}^K \mu_k^{\alpha_k+m_k-1}\]</span></p><p>ä¸éš¾éªŒè¯ï¼š</p><p><span class="math display">\[\begin{align}p(\boldsymbol\mu|\mathcal D,\boldsymbol\alpha) &amp;= \text{Dir}(\boldsymbol\mu|\boldsymbol\alpha+\mathbf m)\\&amp;=\frac{\Gamma(\alpha_0+N)}{\Gamma(\alpha_1+m_1)\cdots\Gamma(\alpha_K+m_K)}\prod_{k=1}^K\mu_k^{\alpha_k+m_k-1}\end{align}\]</span></p><p>å³åéªŒåŒæ ·ä¸ºè¿ªåˆ©å…‹é›·åˆ†å¸ƒã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Statistics</tag>
      
      <tag>Probability</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Time2Graph: Revisiting Time Series Modeling with Dynamic Shapelets</title>
    <link href="/2020/06/13/Time2Graph-Revisiting-Time-Series-Modeling-with-Dynamic-Shapelets/"/>
    <url>/2020/06/13/Time2Graph-Revisiting-Time-Series-Modeling-with-Dynamic-Shapelets/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡æ—¨åœ¨æä¾›ä¸€ç§å¯è§£é‡Šçš„é«˜æ•ˆçš„æ—¶é—´åºåˆ—å»ºæ¨¡ï¼ˆè¡¨ç¤ºå­¦ä¹ ï¼‰æ–¹æ³•æ¥æ›´å¥½åœ°æœåŠ¡åˆ†ç±»ä»»åŠ¡ã€‚Shapeletåœ¨æ—¶é—´åºåˆ—åˆ†ç±»ä»»åŠ¡ä¸Šä½“ç°äº†è‰¯å¥½çš„å¯è§£é‡Šæ€§ã€‚ä¸è¿‡ä¼ ç»Ÿçš„åŸºäºShapeletçš„æ–¹æ³•å¿½ç•¥äº†Shapeletåœ¨ä¸åŒæ—¶é—´ç‰‡æ®µä¸Šçš„åŠ¨æ€æ€§ï¼Œå³æ•´ä¸ªæ—¶é—´ç»´åº¦ä¸Šä¸åŒçš„æ—¶é—´ç‰‡æ®µå¯èƒ½é€‚åˆç”¨ä¸åŒçš„Shapeletã€‚ä½œè€…åŸºäºæ­¤è®¾è®¡äº†åŠ¨æ€çš„<em>time-aware shapelet</em>ï¼Œå¹¶ä¸”å®šä¹‰äº†<em>shapelet evolution graph</em>æ¥æ•è·Shapeletåœ¨æ—¶é—´ç»´åº¦ä¸Šçš„åŠ¨æ€å˜åŒ–ã€‚</p><p><a href="https://arxiv.org/abs/1911.04143" target="_blank" rel="noopener">ğŸ“°Get Paper</a></p><h1 id="preliminaries">Preliminaries</h1><p>æ—¶é—´åºåˆ—é›†åˆ<span class="math inline">\(T=\{t_1,\cdots,t_{|T|}\}\)</span>åŒ…å«è‹¥å¹²æ¡æ—¶åºæ•°æ®<span class="math inline">\(t=\{x_1,\cdots,x_n\}\)</span>ã€‚ä¸€ä¸ª<span class="math inline">\(t\)</span>çš„ç‰‡æ®µ<span class="math inline">\(s\)</span>æ˜¯<span class="math inline">\(t\)</span>çš„ä¸€ä¸ªè¿ç»­å­åºåˆ—ã€‚å¦‚æœ<span class="math inline">\(t\)</span>èƒ½è¢«åˆ‡åˆ†æˆ<span class="math inline">\(m\)</span>ä¸ªé•¿åº¦éƒ½ä¸º<span class="math inline">\(l\)</span>çš„ç‰‡æ®µï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰<span class="math inline">\(t=\{\{x_{l*k+1},\cdots,x_{l*k+l}\},0\leq k\leq m-1\}\)</span>ã€‚ä¸¤ä¸ªé•¿åº¦ç›¸ç­‰çš„ç‰‡æ®µä¹‹é—´è·ç¦»å¾ˆå¥½åº¦é‡ï¼Œç›´æ¥è®¡ç®—æ¬§å¼è·ç¦»å³å¯ï¼Œé‚£ä¹ˆä¸¤ä¸ªç‰‡æ®µé•¿åº¦ä¸ç›¸ç­‰çš„æƒ…å†µå‘¢ï¼Ÿè¿™å°±éœ€è¦å¯¹å…¶ï¼ˆAlignmentï¼‰çš„æ¦‚å¿µã€‚</p><blockquote><p><strong>Definition 1 </strong> <strong><em>Alignment</em></strong>. ç»™å®šä¸¤ä¸ªé•¿åº¦åˆ†åˆ«ä¸º<span class="math inline">\(l_i\)</span>å’Œ<span class="math inline">\(l_j\)</span>çš„åºåˆ—<span class="math inline">\(s_i\)</span>å’Œ<span class="math inline">\(s_j\)</span>ï¼Œä¸€ä¸ª<em>alignment</em> <span class="math inline">\(a=(a_1,a_2)\)</span>æ˜¯ä¸€ä¸ªæ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„é•¿åº¦ä¸º<span class="math inline">\(p\)</span>çš„ä¸‹æ ‡åºåˆ—ï¼š <span class="math display">\[1\leq a_k(1)\leq\cdots\leq a_k(p)=l_k,\\a_k(n+1)-a_k(n)\leq 1,\\\text{for }k=i,j,\text{ and }1\leq n\leq p-1\]</span></p></blockquote><p>ä¸Šè¿°å…¬å¼å¯èƒ½æ¯”è¾ƒæŠ½è±¡ï¼Œå…¶å®çœ‹äº†ä¸‹å›¾å°±ä¸éš¾ç†è§£ï¼š</p><p><img src="https://i.loli.net/2020/07/07/UE2GtoYK1vhDpLi.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ç‰‡æ®µ<span class="math inline">\(s_i\)</span>ä¸­çš„æŸä¸ªç‚¹<span class="math inline">\(a\)</span>ï¼Œä¸ç‰‡æ®µ<span class="math inline">\(s_j\)</span>ä¸­çš„æŸä¸ªç‚¹<span class="math inline">\(b\)</span>å½¢æˆå¯¹åº”ï¼Œç„¶ååœ¨<span class="math inline">\(a\)</span>å’Œ<span class="math inline">\(b\)</span>ä¹‹é—´è¿ä¸€æ¡è™šæ‹Ÿçš„çº¿ï¼ˆä¸èƒ½ä¸å·²æœ‰çš„çº¿äº¤å‰ï¼‰ï¼Œä¸€ç›´è¿™ä¹ˆåšç›´åˆ°çŸ­çš„é‚£ä¸ªç‰‡æ®µä¸­çš„æ¯ä¸ªç‚¹éƒ½æ‰¾åˆ°å¯¹åº”ï¼Œå°±æ˜¯ä¸€ä¸ªåˆç†çš„<em>alignment</em>ã€‚å¯¹äºä¸¤ä¸ªé•¿åº¦ä¸ä¸€æ ·çš„ç‰‡æ®µ<span class="math inline">\(s_i\)</span>å’Œ<span class="math inline">\(s_j\)</span>ï¼Œä¼šæœ‰å¾ˆå¤šç§<em>alignment</em>ã€‚æˆ‘ä»¬æŠŠ<span class="math inline">\(s_i\)</span>å’Œ<span class="math inline">\(s_j\)</span>æ‰€æœ‰å¯èƒ½çš„<em>alignment</em>è®°ä¸º<span class="math inline">\(\mathcal{A}(s_i,s_j)\)</span>ã€‚åœ¨å®šä¹‰äº†<em>alignment</em>ä¹‹åå°±å¯ä»¥å®šä¹‰DTWäº†ã€‚DTW (<em>Dynamic Time Warping</em>) å®šä¹‰ä¸ºåœ¨ç»™å®šä¸€ä¸ªé¢„å®šä¹‰çš„è·ç¦»åº¦é‡<span class="math inline">\(\tau\)</span>å’Œæ‰€æœ‰å¯èƒ½çš„<em>alignment</em> <span class="math inline">\(\mathcal{A}(s_i,s_j)\)</span>çš„æƒ…å†µä¸‹ï¼Œæœ€å°çš„è·ç¦»<span class="math inline">\(\tau\)</span>ï¼š <span class="math display">\[d_\text{DTW}(s_i,s_j)=\min_{a\in\mathcal{A}(s_i,s_j)}\tau(s_i,s_j|a)\]</span></p><p>è¿›ä¸€æ­¥çš„ï¼Œå› ä¸ºæ—¶é—´åºåˆ—<span class="math inline">\(t\)</span>ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªç‰‡æ®µï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå­åºåˆ—<span class="math inline">\(s\)</span>å’Œæ—¶é—´åºåˆ—<span class="math inline">\(t\)</span>ä¹‹é—´çš„è·ç¦»åº¦é‡ï¼š <span class="math display">\[D(s,t)=\min_{1\leq k\leq m} d(s,s_k)\]</span></p><p>è¿™é‡Œ<span class="math inline">\(\boldsymbol s_k\)</span>ä¸ºæ—¶åº<span class="math inline">\(\boldsymbol t\)</span>åˆ†è§£æˆçš„ç‰‡æ®µã€‚ä¹‹åShapeletå¯ä»¥é€šè¿‡ç‰‡æ®µä¸æ—¶åºçš„è·ç¦»å®šä¹‰ä¸ºæœ€å…·æœ‰è¾¨è¯†åº¦çš„æœ‰ä»£è¡¨æ€§çš„ç‰‡æ®µï¼š</p><blockquote><p><strong>Definition 2 </strong> <strong>Shapelet. </strong>ä¸€ä¸ªShapelet <span class="math inline">\(\boldsymbol v\)</span>æ˜¯å¯¹äºç‰¹å®šç±»åˆ«æ—¶åºçš„æœ€å…·æœ‰ä»£è¡¨æ€§çš„ç‰‡æ®µã€‚è€ƒè™‘æ—¶åºåˆ†ç±»ä»»åŠ¡ï¼Œç»™å®šæ—¶åºé›†åˆ<span class="math inline">\(T\)</span>ï¼Œå¯ä»¥é€šè¿‡ä¸<span class="math inline">\(\boldsymbol v\)</span>ç›¸ä¼¼æˆ–ä¸ç›¸ä¼¼è€Œåˆ†æˆä¸¤ä¸ªå­é›†åˆï¼Œä¸<span class="math inline">\(\boldsymbol v\)</span>ç›¸ä¼¼çš„é›†åˆä¸<span class="math inline">\(\boldsymbol v\)</span>çš„è·ç¦»åº”å½“å°½é‡å°ï¼Œä¸<span class="math inline">\(\boldsymbol v\)</span>ä¸ç›¸ä¼¼çš„é›†åˆä¸<span class="math inline">\(\boldsymbol v\)</span>çš„è·ç¦»åº”å½“å°½é‡å¤§ï¼Œæ­¤æ—¶æŸå¤±å‡½æ•°å¯ä»¥å½¢å¼åŒ–ä¸ºï¼š <span class="math display">\[\mathcal L=-g(S_{pos}(\boldsymbol v,T),S_{neg}(\boldsymbol v,T))\]</span></p></blockquote><p><span class="math inline">\(\mathcal L\)</span>æè¿°äº†åœ¨shapelet <span class="math inline">\(\boldsymbol v\)</span>ä¸‹æ­£è´Ÿæ ·æœ¬é›†çš„ç›¸å¼‚æ€§ã€‚<span class="math inline">\(S_{*}(\boldsymbol v,T)\)</span>è¡¨ç¤ºç‰¹å®šæ—¶åºé›†åˆä¸<span class="math inline">\(\boldsymbol v\)</span>çš„è·ç¦»é›†åˆï¼Œ<span class="math inline">\(g(\cdot,\cdot)\)</span>ä¸ºæ¥å—ä¸¤ä¸ªæœ‰é™é›†åˆä¸ºè¾“å…¥çš„å¯å¾®å‡½æ•°ï¼Œå¹¶ä¸”èƒ½å¤Ÿåº¦é‡ä¸¤ä¸ªé›†åˆçš„è·ç¦»ã€‚</p><h1 id="framework">Framework</h1><p>æœ¬æ–‡ä¸»è¦æ˜¯æå‡ºäº†ä¸€ç§æ—¶é—´åºåˆ—è¡¨ç¤ºå­¦ä¹ æ–¹æ³•ã€‚åŸºäºShapeletåœ¨ä¸åŒçš„æ—¶é—´ç‰‡æ®µä¸Šçš„ä½œç”¨æ˜¯ä¸åŒçš„è§‚å¯Ÿï¼Œä½œè€…ä¸ºä¸åŒçš„æ—¶é—´ç‰‡æ®µèµ‹äºˆäº†ä¸åŒçš„Shapeletï¼Œè€Œä¸æ˜¯åƒä¼ ç»Ÿæ–¹æ³•ä¸€æ ·æ•´ä¸ªæ—¶åºå¯¹åº”ä¸€ä¸ªShapeletã€‚æ¥ç€åŸºäºè¿™äº›Shapeletä½œè€…æ„é€ äº†å›¾ï¼Œå¹¶é€šè¿‡å›¾åµŒå…¥å¾—åˆ°äº†åµŒå…¥å‘é‡ï¼Œä½œä¸ºæ—¶åºçš„è¡¨ç¤ºã€‚</p><p><img src="https://i.loli.net/2020/06/25/mKJH4c2EMAljavG.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><h2 id="time-aware-shapelet-extraction">Time-Aware Shapelet Extraction</h2><p>ç¬¬ä¸€æ­¥æ˜¯æ•è·Shapeletåœ¨æ—¶é—´ç»´åº¦ä¸Šçš„åŠ¨æ€å½±å“ã€‚æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå‚æ•°æ¥å®šé‡çš„æµ‹é‡shapeletåœ¨ä¸åŒæ—¶é—´ä¸Šçš„åŠ¨æ€æ€§ã€‚ç¬¬ä¸€ä¸ªæ˜¯å±€éƒ¨å› å­<span class="math inline">\(\boldsymbol w_n\)</span>ï¼Œç”¨æ¥æ§åˆ¶shapeletå†…éƒ¨<span class="math inline">\(n\)</span>ä¸ªå…ƒç´ çš„æƒé‡ï¼Œé‚£ä¹ˆshapelet <span class="math inline">\(\boldsymbol v\)</span>å’Œç‰‡æ®µ<span class="math inline">\(\boldsymbol s\)</span>çš„è·ç¦»ä¸ºï¼š <span class="math display">\[\begin{align}\hat{d}(\boldsymbol v,\boldsymbol s|\boldsymbol w) &amp;= \tau(\boldsymbol v,\boldsymbol s|\boldsymbol a^*,\boldsymbol w)\\&amp; = \left(\sum_{k=1}^{p}\boldsymbol w_{\boldsymbol a^*_1(k)}\cdot(\boldsymbol v_{\boldsymbol a^*_1(k)}-\boldsymbol s_{\boldsymbol a^*_2(k)})^2\right)^{\frac{1}{2}}\end{align}\]</span> å…¶ä¸­<span class="math inline">\(\boldsymbol a^*\)</span>ä¸ºDTWè·ç¦»ä¸‹çš„æœ€ä½³å¯¹é½ã€‚</p><p>ç¬¬äºŒä¸ªæ˜¯å…¨å±€å› ç´ <span class="math inline">\(\boldsymbol u_m\)</span>ï¼Œè¿™ä¸»è¦æ˜¯é€šè¿‡å¯¹ä¸åŒç‰‡æ®µ<span class="math inline">\(\boldsymbol s\)</span>æ–½åŠ ä¸åŒçš„æƒé‡å®ç°çš„ï¼Œäºæ˜¯shapelet <span class="math inline">\(\boldsymbol v\)</span>å’Œæ—¶é—´åºåˆ—<span class="math inline">\(\boldsymbol t\)</span>çš„è·ç¦»å¯ä»¥é‡å†™ä¸ºï¼š <span class="math display">\[\hat{D}(\boldsymbol v,\boldsymbol t|\boldsymbol w,\boldsymbol u)=\min_{1\leq k\leq m}\boldsymbol u_k\cdot\hat{d}(\boldsymbol v,\boldsymbol s_k|\boldsymbol w)\]</span> å…¶ä¸­<span class="math inline">\(\boldsymbol t\)</span>è¢«åˆ†å‰²ä¸º<span class="math inline">\(m\)</span>ä¸ªç‰‡æ®µï¼š<span class="math inline">\(\boldsymbol t=\{\boldsymbol s_1,\cdots,\boldsymbol s_m\}\)</span>ã€‚å¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œå…·ä½“çš„æ¥è¯´ï¼Œæˆ‘ä»¬å…ˆç”Ÿæˆä¸€å †Shapeletå€™é€‰é›†ï¼Œç„¶åé€šè¿‡æœ‰ç›‘ç£çš„æ–¹æ³•æ¥æŒ‘é€‰æœ€ä½³çš„Shapeletå’Œå¯¹åº”çš„å‚æ•°<span class="math inline">\(\boldsymbol w\)</span>å’Œ<span class="math inline">\(\boldsymbol u\)</span>ã€‚</p><p>è®¡ç®—shapeletå€™é€‰é›†çš„ç®—æ³•å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/srW4Shk79XBFL3U.png" srcset="/img/loading.gif" /></p><p>åœ¨è·å–äº†Shapeletå€™é€‰é›†åˆä¹‹åï¼Œæˆ‘ä»¬æœ‰å¸¦æœ‰æ ‡ç­¾çš„æ—¶åºé›†åˆ<span class="math inline">\(T\)</span>ï¼Œå¯¹äºæ¯ä¸€ä¸ªShapeletæˆ‘ä»¬å¯ä»¥ä¼˜åŒ–ï¼š</p><p><span class="math display">\[\hat{\mathcal L}=-g(S_{pos}(\boldsymbol v,T),S_{neg}(\boldsymbol v,T))+\lambda\parallel \boldsymbol w\parallel+\epsilon\parallel \boldsymbol u\parallel\]</span></p><p>æ¥è·å–æœ€ä¼˜çš„<span class="math inline">\(\hat{\boldsymbol w}\)</span>å’Œ<span class="math inline">\(\hat{\boldsymbol u}\)</span>ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æŒ‘é€‰å‡ºä½¿å¾—<span class="math inline">\(\hat{\mathcal L}\)</span>æœ€å°çš„å‰<span class="math inline">\(K\)</span>ä¸ªShapeletã€‚æ•´ä¸ªè¿‡ç¨‹çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/5b2TcjuBzlIFrPm.png" srcset="/img/loading.gif" /></p><h2 id="shapelet-evolution-graph">Shapelet Evolution Graph</h2><p>åœ¨è·å–äº†Shapeletä¹‹åï¼Œä¸ºäº†æ•è·Shapeletä¹‹é—´çš„ç›¸å…³æ€§ï¼Œæˆ‘ä»¬å®šä¹‰äº†<em>Shapelet Evolution Graph</em>ã€‚</p><blockquote><p><strong>Definition 3 Shapelet Evolution Graph. </strong> <em>Shapelet Evolution Graph</em>ä¸ºä¸€ä¸ªæœ‰å‘å¸¦æƒå›¾<span class="math inline">\(G=(V,E)\)</span>ï¼Œ<span class="math inline">\(V\)</span>ä¸º<span class="math inline">\(K\)</span>ä¸ªShapeletï¼Œæ¯æ¡å¸¦æœ‰æƒé‡<span class="math inline">\(w_{ij}\)</span>çš„è¾¹<span class="math inline">\(e_{ij}\in E\)</span>ä»£è¡¨ä¸¤ä¸ªShapelet <span class="math inline">\(\boldsymbol v_i \in V\)</span>å’Œ<span class="math inline">\(\boldsymbol v_j \in V\)</span>è¢«åˆ†é…ç»™ç›¸é‚»ç‰‡æ®µçš„æ¦‚ç‡ã€‚</p></blockquote><h3 id="graph-construction">Graph Construction</h3><p>è¿™é‡Œæ¥è¯´ä¸€ä¸‹ï¼Œå»ºå›¾çš„å…·ä½“è¿‡ç¨‹ã€‚é¦–å…ˆé¡¶ç‚¹ä¸ºShapeletï¼Œä¹‹åæ¥è¿›è¡Œè¾¹çš„æ„é€ ã€‚å¯¹äºæ¯ä¸€ä¸ªç‰‡æ®µ<span class="math inline">\(\boldsymbol s_i\)</span>ï¼Œæˆ‘ä»¬ä¼šè®¡ç®—Shapeletåˆ°è¯¥ç‰‡æ®µçš„è·ç¦»ï¼Œè·ç¦»è¶Šè¿‘ä»£è¡¨è¿™ä¸ªShapeletä¸ç‰‡æ®µè¶ŠåŒ¹é…ã€‚ä¹‹åä¼šè®¾å®šä¸€ä¸ªé˜ˆå€¼<span class="math inline">\(\delta\)</span>ï¼Œç„¶åå°†ä¸ç‰‡æ®µçš„è·ç¦»ä½äºè¿™ä¸ªé˜ˆå€¼çš„Shapeletåˆ†é…ç»™è¿™ä¸ªç‰‡æ®µï¼ˆä¸€ä¸ªShapeletå¯èƒ½ä¼šåˆ†é…ç»™å¤šä¸ªä¸åŒç‰‡æ®µï¼‰ã€‚å¯¹äº<span class="math inline">\(\boldsymbol s_i\)</span>çš„æ‰€æœ‰shapetletæˆ‘ä»¬è®°ä¸º<span class="math inline">\(\boldsymbol v_{i,*}\)</span>ï¼Œæˆ‘ä»¬ä¼šæŒ‰ç…§Shapeåˆ°ç‰‡æ®µçš„è·ç¦»è¿›è¡Œå½’ä¸€åŒ–ï¼š</p><p><span class="math display">\[\boldsymbol p_{i,j}=\frac{\max(\hat{d}_{i,*}(\boldsymbol v_{i,*},\boldsymbol s_i))-\hat{d}_{i,j}(\boldsymbol v_{i,j},\boldsymbol s_i)}{\max(\hat{d}_{i,*}(\boldsymbol v_{i,*},\boldsymbol s_i))-\min(\hat{d}_{i,*}(\boldsymbol v_{i,*},\boldsymbol s_i))}\]</span></p><p>å…¶ä¸­<span class="math inline">\(\hat{d}_{i,*}(\boldsymbol v_{i,*},\boldsymbol s_i)=\boldsymbol u_*[i]*\hat{d}(\boldsymbol v_{i,*},\boldsymbol s_i|\boldsymbol w_*)&lt;\delta\)</span>ã€‚è¿™æ ·å¯¹äºæ¯ä¸ªç‰‡æ®µ<span class="math inline">\(\boldsymbol s_i\)</span>æ‰€åˆ†é…çš„Shapeletå¯¹åº”çš„<span class="math inline">\(\boldsymbol p\)</span>ä¹‹å’Œä¼šç­‰äº<span class="math inline">\(1\)</span>ã€‚å¯¹æ¯ä¸€å¯¹ç›¸é‚»çš„ç‰‡æ®µ<span class="math inline">\((\boldsymbol s_i,\boldsymbol s_{i+1})\)</span>çš„Shapelet <span class="math inline">\(\boldsymbol v_{i,j}\)</span>å’Œ<span class="math inline">\(\boldsymbol v_{i+1,k}\)</span>ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€æ¡è¿æ¥<span class="math inline">\(\boldsymbol v_{*,j}\)</span>å’Œ<span class="math inline">\(\boldsymbol v_{*,k}\)</span>çš„è¾¹<span class="math inline">\(e_{j,k}\)</span>ï¼Œæƒé‡ä¸º<span class="math inline">\(\boldsymbol p_{i,j}\cdot\boldsymbol p_{i+1,k}\)</span>ã€‚æœ€åï¼Œæ‰€æœ‰é‡å¤çš„è¾¹ä¼šè¢«åˆå¹¶ã€‚</p><p><img src="https://i.loli.net/2020/07/07/FzGEbWJflHmQa9R.png" srcset="/img/loading.gif" style="zoom: 33%;" /></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå‡è®¾æœ‰ä¸¤ä¸ªç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µåˆ†é…äº†<span class="math inline">\(3\)</span>ä¸ªShapeletï¼ŒShapelet <span class="math inline">\(B\)</span>åœ¨ç‰‡æ®µ<span class="math inline">\(1\)</span>å¯¹åº”çš„æ¦‚ç‡æ˜¯<span class="math inline">\(p_{12}\)</span>ï¼ŒShapelet <span class="math inline">\(C\)</span>åœ¨ç‰‡æ®µ<span class="math inline">\(2\)</span>å¯¹åº”çš„æ¦‚ç‡æ˜¯<span class="math inline">\(p_{23}\)</span>ï¼Œé‚£ä¹ˆç”±äºç‰‡æ®µ<span class="math inline">\(1\)</span>å’Œ<span class="math inline">\(2\)</span>æ˜¯ç›¸é‚»ç‰‡æ®µï¼Œä¼šåœ¨<span class="math inline">\(B\)</span>å’Œ<span class="math inline">\(C\)</span>ä¹‹é—´è¿ä¸€æ¡è¾¹ï¼Œè¾¹çš„æƒé‡ä¸º<span class="math inline">\(p_{12}*p_{23}\)</span>ã€‚</p><p>å»ºå›¾çš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/aq9tGuApSbiC67c.png" srcset="/img/loading.gif" /></p><h2 id="representation-learning">Representation Learning</h2><p>ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨DeepWalkç®—æ³•æ¥è·å–è·å–æ¯ä¸ªç»“ç‚¹ï¼ˆShapeletï¼‰çš„åµŒå…¥è¡¨ç¤ºã€‚å¯¹äºæ—¶åº<span class="math inline">\(\boldsymbol t=\{\boldsymbol s_1,\cdots,\boldsymbol s_m\}\)</span>å³å¯¹åº”çš„Shapelet <span class="math inline">\(\{\boldsymbol v_{1,*},\cdots, v_{m,*}\}\)</span>å’Œå¯¹åº”çš„æ¦‚ç‡<span class="math inline">\(\{\boldsymbol p_{1,*},\cdots,\boldsymbol p_{m,*}\}\)</span>ï¼Œæ¯ä¸ªShaplet <span class="math inline">\(\boldsymbol v_{i,j}\)</span>çš„è¡¨ç¤ºè®°ä¸º<span class="math inline">\(\boldsymbol \mu(\boldsymbol v_{i,j})\)</span>ã€‚ç‰‡æ®µ<span class="math inline">\(\boldsymbol s_i\)</span>å¯¹åº”çš„åµŒå…¥å‘é‡ä¸ºå¯¹åº”çš„ShapeletåµŒå…¥å‘é‡ä¸å¯¹åº”çš„æ¦‚ç‡å€¼åŠ æƒæ±‚å’Œï¼š</p><p><span class="math display">\[\boldsymbol\Phi_i=\left(\sum_j p_{i,j}\cdot\boldsymbol \mu(\boldsymbol v_{i,j})\right),\space 1\leq i \leq m\]</span></p><p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/O5exTgsVLuRWQ42.png" srcset="/img/loading.gif" /></p><h1 id="experiments">Experiments</h1><h2 id="experimental-setup">Experimental Setup</h2><p>æ–‡ä¸­ç”¨äº†<em>Earthquakes</em> (EQS)ã€<em>WormsTwoClass</em> (WTC)ã€<em>Strawberry</em> (STB)ã€<em>Electricity Consumption Records</em> (ECR)å’Œ<em>Network Traffic Flow</em> (NTF) è¿™äº”ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­åä¸¤ä¸ªä¸ºä½œè€…è‡ªå·±æ”¶é›†çš„æ•°æ®é›†ã€‚äº”ä¸ªæ•°æ®é›†å¯¹åº”çš„ç»Ÿè®¡ä¿¡æ¯å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/zHjTKkUJB8fGwdi.png" srcset="/img/loading.gif" /></p><p>æ–‡ä¸­ä¸å¤šä¸ªBaselineè¿›è¡Œäº†æ¯”è¾ƒï¼ŒåŒ…æ‹¬:</p><ul><li><strong>Distance-based Models: </strong>æ–‡ä¸­ä½¿ç”¨äº†ä¸åŒçš„è·ç¦»åº¦é‡ä¸åŸºäº1-NNçš„æ¨¡å‹è¿›è¡Œç»„åˆï¼ŒåŒ…æ‹¬Euclidean Distance (ED)ã€Dynamic Time Warping (DTW)ã€Weighted DTW (WDTW)ã€Complexity-Invariant Distance (CID) å’Œ Derivative DTW (DDTW)ï¼›</li><li><strong>Feature-based Models: </strong>æ–‡ä¸­åˆ†åˆ«ä½¿ç”¨äº†æå–ç‰¹å¾ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ç­‰ï¼‰å’ŒåŸå§‹åºåˆ—æ¥è®­ç»ƒXGBoostã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜ä½¿ç”¨äº† Bag-of-Patterns (BoP)ã€Time Series Forest (TSF)ã€Elastic Ensembles (EE) å’Œ åŸºäºSAXçš„ Vector Space Model (SAXVSM)ï¼›</li><li><strong>Shapelet-based Models: </strong>è¿™éƒ¨åˆ†æ¨¡å‹åŒ…æ‹¬ Learn Time Series Shapelets (LS)ã€Fast Shapelets (FS)ã€å’Œ Learned Pattern Similarity (LPS)ï¼›</li><li><strong>Deep Learning Models: </strong>è¿™éƒ¨åˆ†æ¨¡å‹åŒ…æ‹¬MLPã€LSTMå’ŒVAEã€‚</li></ul><h2 id="comparison-results">Comparison Results</h2><p>å¯¹äºå‰ä¸‰ä¸ªå…¬å…±æ•°æ®é›†è¯„æµ‹æ ‡å‡†é‡‡ç”¨Accuracyï¼Œåä¸¤ä¸ªæ•°æ®é›†å› ä¸ºæ ·æœ¬ç±»æ¯”ä¸å‡è¡¡ï¼Œæ‰€ä»¥é‡‡ç”¨äº†Precisionã€Recallå’ŒF1ä½œä¸ºè¯„æµ‹æ ‡å‡†ã€‚ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/jxKFpDVXdmc5tbE.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>åœ¨EQSæ•°æ®é›†ä¸Šï¼ŒTime2Graphæ‰“è´¥äº†æ‰€æœ‰Baselineï¼Œè€Œåœ¨WTCå’ŒSTBè¿™ä¸¤ä¸ªæ•°æ®é›†ä¸Šä¹Ÿè¾¾åˆ°äº†è¾ƒå¥½çš„æ•ˆæœã€‚åœ¨ECRå’ŒNTFè¿™ä¸¤ä¸ªçœŸå®æ•°æ®é›†ä¸Šï¼ŒTime2Graphåœ¨F1ä¸Šæ‰“è´¥äº†æ‰€æœ‰Baselineã€‚</p><h2 id="parameter-analysis">Parameter Analysis</h2><p>æœ¬èŠ‚å¯¹Shapeletçš„æ•°é‡<span class="math inline">\(K\)</span>ã€åµŒå…¥ç»´åº¦<span class="math inline">\(B\)</span>å’Œç‰‡æ®µé•¿åº¦<span class="math inline">\(l\)</span>è¿›è¡Œäº†å‚æ•°åˆ†æã€‚ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/hPfqAvNnOlEBQuw.png" srcset="/img/loading.gif" /></p><h2 id="case-study-of-time-aware-shapelets">Case Study of Time-Aware Shapelets</h2><p>æœ¬èŠ‚ä½œè€…å¯¹æå‡ºçš„<em>Time-Aware Shapetlet</em>è¿›è¡Œäº†ç»†è‡´çš„æ¢ç©¶ã€‚ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ä¸åŒShapeletçš„åŒºåˆ†èƒ½åŠ›æ˜¯å¦ä¸åŒï¼Ÿä¸‹å›¾(a)é‡Œï¼Œä½œè€…åœ¨ä½¿ç”¨Shapeletè¿›è¡ŒäºŒåˆ†ç±»çš„ä»»åŠ¡ä¸­ï¼Œå°†ShapeletæŒ‰Lossï¼ˆå›¾ä¸­ç°è‰²çš„çº¿ï¼‰è¿›è¡Œæ’åºï¼Œå¹¶ä¸”ç»˜åˆ¶äº†å¯¹åº”çš„æ­£è´Ÿæ ·æœ¬è·ç¦»çš„KLæ•£åº¦ï¼ˆæ©˜çº¢è‰²çš„ç‚¹ï¼‰ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨Lossæ›²çº¿å’ŒKLæ•£åº¦å‘ˆåæ¯”å…³ç³»ã€‚KLæ•£åº¦è¶Šé«˜ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¯¥Shapeletçš„åŒºåˆ†åº¦è¶Šé«˜ï¼Œè¿™è¯´æ˜ä¸åŒShapeletçš„åŒºåˆ†åº¦çš„ç¡®ä¸åŒï¼Œå¹¶ä¸”è¿™ä¼šä¸æœ€ç»ˆæ•ˆæœç›´æ¥æŒ‚é’©ã€‚å›¾(b)å±•ç¤ºäº†ä¸åŒShapeletçš„å‡å€¼å’Œæ–¹å·®ï¼ˆåŸæ–‡æ²¡æœ‰è¯´æ¸…æ¥šæ˜¯ä»€ä¹ˆçš„å‡å€¼å’Œæ–¹å·®ï¼‰ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…å’Œæµè¡Œçš„Shapeletæå–ç®—æ³•<em>LS</em>è¿›è¡Œäº†æ¯”è¾ƒï¼Œå¦‚å›¾(c)å’Œå›¾(d)ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°å¯¹äºä¸åŒæ—¶é—´ï¼Œæœ¬æ–‡çš„ç®—æ³•æå–çš„Shapeletçš„ç¡®æ˜¯å…·æœ‰æ—¶é—´åŠ¨æ€æ€§çš„ã€‚</p><p><img src="https://i.loli.net/2020/06/25/ed5PwksC2l3OWE8.png" srcset="/img/loading.gif" /></p><h2 id="case-study-of-the-shapelet-evolution-graph">Case Study of the Shapelet Evolution Graph</h2><p>æœ¬èŠ‚ä½œè€…å¯¹<em>Shapelet Evolution Graph</em>è¿›è¡Œäº†ç»†è‡´çš„æ¢ç©¶ã€‚ä¸‹å›¾åˆ†åˆ«ä¸ºä¸€æœˆä»½å’Œä¸ƒæœˆä»½çš„<em>Shapelet Evolution Graph</em>ã€‚åœ¨ä¸€æœˆï¼Œ45å·Shapeletçš„åº¦è¾ƒå¤§ï¼Œè€Œä¸”å¯¹åº”çš„æ—¶é—´å› ç´ åœ¨ä¸€æœˆå’ŒäºŒæœˆä¹Ÿè¾ƒå¤§ï¼ˆå›¾ä¸­æ·±è‰²éƒ¨åˆ†ï¼‰ã€‚è¯´æ˜45å·Shapeletåœ¨ä¸€æœˆä»½å…·æœ‰ä»£è¡¨æ€§ã€‚è€Œåœ¨ä¸ƒæœˆï¼Œ45å·Shapeletçš„é‡è¦æ€§é™ä½ï¼Œè€Œ42å·Shapeletåœ¨ä¸ƒæœˆçš„é‡è¦æ€§å¾ˆé«˜ã€‚</p><p><img src="https://i.loli.net/2020/06/25/N2Vij8ODQaRuALJ.png" srcset="/img/loading.gif" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Time Series Modeling</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Shapelet</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Generative Probabilistic Novelty Detection with Adversarial Autoencoders</title>
    <link href="/2020/06/06/Generative-Probabilistic-Novelty-Detection-with-Adversarial-Autoencoders/"/>
    <url>/2020/06/06/Generative-Probabilistic-Novelty-Detection-with-Adversarial-Autoencoders/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>è¿™ç¯‡æ–‡ç« ä»‹ç»äº†ä¸€ç§åŸºäºæ¦‚ç‡åˆ†å¸ƒçš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯å‡è®¾æ­£å¸¸æ ·æœ¬æœä»å®šä¹‰åœ¨æµå½¢<span class="math inline">\(M\)</span>ä¸Šçš„åˆ†å¸ƒï¼Œè€Œå¯¹äºä»»æ„ä¸€ç‚¹<span class="math inline">\(\bar x\)</span>ï¼Œé€šè¿‡æŠ•å½±åˆ°æµå½¢<span class="math inline">\(M\)</span>ä¸Š<span class="math inline">\(x^\parallel\)</span>ï¼Œå¯ä»¥åˆ†è§£ä¸ºå¹³è¡Œäºåˆ‡ç©ºé—´çš„éƒ¨åˆ†<span class="math inline">\(x^\parallel\)</span>å’Œæ­£äº¤ä¸åˆ‡ç©ºé—´çš„éƒ¨åˆ†<span class="math inline">\(x^\bot\)</span>ã€‚åŸå§‹çš„åæ ‡<span class="math inline">\(\bar x\)</span>è¢«è½¬æ¢åˆ°<span class="math inline">\(x^\parallel\)</span>å±€éƒ¨åæ ‡ç³»ä¸­ï¼Œç„¶åä¼¼ç„¶é€šè¿‡è½¬æ¢åçš„åæ ‡ç³»è¿›è¡Œè®¡ç®—ã€‚</p><h1 id="methodology">Methodology</h1><h2 id="generative-probabilistic-novelty-detection">Generative Probabilistic Novelty Detection</h2><p>æˆ‘ä»¬å‡è®¾è®­ç»ƒæ•°æ®<span class="math inline">\(x_1,\cdots,x_N\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(x_i\in\mathbb{R}^m\)</span>ï¼Œä»ä¸€ä¸ªåˆ†å¸ƒé‡‡æ ·çš„æ¥ï¼Œå¹¶å¸¦æœ‰éšæœºå™ªå£°<span class="math inline">\(\xi\)</span>ï¼š <span class="math display">\[x_i=f(z_i)+\xi_i, \space\space\space i=1,\cdots,N\]</span> å…¶ä¸­<span class="math inline">\(z_i\in\mathbb{R}^n\)</span>ï¼Œ<span class="math inline">\(f:\Omega\mapsto\mathbb{R}^m\)</span>å®šä¹‰äº†ä¸€ä¸ª<span class="math inline">\(n\)</span>ç»´å¸¦å‚æµå½¢<span class="math inline">\(\mathcal{M}\equiv f(\Omega)\)</span>ã€‚æ³¨æ„è¿™é‡Œå™ªå£°çš„åŠ å…¥ä½¿å¾—æ ·æœ¬çš„å€¼åŸŸæ‰©å±•åˆ°äº†æ•´ä¸ªå®æ•°ç©ºé—´ã€‚åŒæ—¶å‡è®¾å­˜åœ¨<span class="math inline">\(g:\mathbb{R}^m\mapsto\mathbb{R}^n\)</span>ï¼Œå¯¹ä»»æ„<span class="math inline">\(x\in\mathcal{M}\)</span>éƒ½æœ‰<span class="math inline">\(f(g(x))=x\)</span>ã€‚<span class="math inline">\(f\)</span>å’Œ<span class="math inline">\(g\)</span>åé¢ä¼šé€šè¿‡ç¥ç»ç½‘ç»œå®ç°ã€‚</p><p>å¯¹äºä¸€ä¸ªæµ‹è¯•æ ·æœ¬<span class="math inline">\(\bar{x}\in\mathbb{R}^m\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å…¶åœ¨<span class="math inline">\(M\)</span>ä¸Šçš„æŠ•å½±ï¼Œè¿™æ˜¯é€šè¿‡é€†å˜æ¢<span class="math inline">\(\bar z = g(\bar x)\)</span>å¾—åˆ°å¯¹åº”<span class="math inline">\(z\)</span>çš„ç„¶åå†é€šè¿‡<span class="math inline">\(\bar x^{\parallel}=f(\bar z)\)</span>å¾—åˆ°ã€‚<span class="math inline">\(f\)</span>åœ¨<span class="math inline">\(\bar z\)</span>çš„ä¸€é˜¶æ³°å‹’å±•å¼€ä¸ºï¼š <span class="math display">\[f(z)=f(\bar z)+J_f(\bar z)(z-\bar z)+O(\parallel z-\bar z\parallel ^2)\]</span> <img src="https://i.loli.net/2020/06/25/oi9xKMO3ID7jANJ.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>å…¶ä¸­<span class="math inline">\(J_f(\bar z)\)</span>ä¸º<span class="math inline">\(f\)</span>åœ¨ç‚¹<span class="math inline">\(\bar z\)</span>çš„é›…å„æ¯”çŸ©é˜µã€‚<span class="math inline">\(\mathcal T=\text{span}(J_f(\bar z))\)</span>ä»£è¡¨ç‚¹<span class="math inline">\(\bar z\)</span>å¤„ç”±<span class="math inline">\(J_f(\bar z)\)</span>çš„<span class="math inline">\(n\)</span>ä¸ªç‹¬ç«‹å‘é‡ç»„æˆçš„åˆ‡ç©ºé—´ã€‚é€šè¿‡å¯¹<span class="math inline">\(J_f(\bar z)\)</span>è¿›è¡Œå¥‡å¼‚å€¼åˆ†è§£<span class="math inline">\(J_f(\bar z)=U^\parallel SV^\top\)</span>ã€‚ <span class="math display">\[\bar w=U^\top\bar x=\left[\begin{matrix}U^{\parallel^\top}\bar x\\ U^{\bot^\top}\bar x\end{matrix}\right]=\left[\begin{matrix}\bar w^\parallel\\ \bar w^\bot\end{matrix}\right]\]</span> åæ ‡<span class="math inline">\(\bar w\)</span>å¯ä»¥åˆ†è§£ä¸ºå¹³è¡Œäº<span class="math inline">\(\mathcal T\)</span>å’Œæ­£äº¤äº<span class="math inline">\(\mathcal T\)</span>ä¸¤éƒ¨åˆ†ã€‚</p><p>å®šä¹‰åœ¨æ–½åŠ å˜æ¢å‰åçš„åæ ‡ç³»ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p_X(x)\)</span>å’Œ<span class="math inline">\(p_W(w)\)</span>æ˜¯ç­‰ä»·çš„ï¼Œä¸è¿‡å¯¹äº<span class="math inline">\(p_W(w)\)</span>ï¼Œæˆ‘ä»¬å‡è®¾å¹³è¡Œéƒ¨åˆ†å’Œæ­£äº¤éƒ¨åˆ†æ˜¯ç‹¬ç«‹çš„ï¼Œå³ï¼š <span class="math display">\[p_X(x)=p_W(w)=p_W(w^\parallel,w^\bot)=p_{W^\parallel}(w^\parallel)p_{W^\bot}(w^\bot)\]</span> è¿™ä¸€å‡è®¾çš„ä¾æ®æ˜¯éšæœºå™ªå£°éƒ¨åˆ†å‡è®¾ä¸»è¦æ˜¯å¾€æµå½¢ä¹‹å¤–åç¦»çš„ï¼Œå³ä¸<span class="math inline">\(\mathcal T\)</span>æ­£äº¤ï¼Œæ‰€ä»¥<span class="math inline">\(W^\bot\)</span>ä¸»è¦æ˜¯åæ˜ å™ªå£°çš„éƒ¨åˆ†ã€‚è€Œå™ªå£°ä¸æ ·æœ¬åˆ†å¸ƒç›¸ç‹¬ç«‹çš„å‡è®¾æ˜¯åˆç†çš„ã€‚äºæ˜¯ï¼Œå¼‚å¸¸åˆ†æ•°å¯ä»¥å®šä¹‰ä¸ºï¼š <span class="math display">\[p_X(\bar x)=p_{W^\parallel}(\bar w^\parallel)p_{W^\bot}(\bar w^\bot)=\begin{cases}\geq \gamma \Rightarrow \text{Inlier}\\&lt;\gamma\Rightarrow\text{Outlier}\end{cases}\]</span></p><h2 id="computing-the-distribution-of-data-samples">Computing the Distribution of Data Samples</h2><p>ä¸Šé¢çš„å¼‚å¸¸åˆ†æ•°éœ€è¦è®¡ç®—<span class="math inline">\(p_{W^\parallel}(\bar w^\parallel)\)</span>å’Œ<span class="math inline">\(p_{W^\bot}(\bar w^\bot)\)</span>ã€‚ç»™å®šæµ‹è¯•æ ·æœ¬<span class="math inline">\(\bar x\)</span>ï¼ŒæŠ•å½±åˆ°æµå½¢<span class="math inline">\(\bar x^\parallel=f(g(\bar x))\)</span>ã€‚<span class="math inline">\(\bar w^\parallel\)</span>å¯ä»¥é‡å†™ä¸º<span class="math inline">\(\bar w^\parallel=U^{\parallel^\top}\bar x=U^{\parallel^\top}(\bar x-\bar x^{\parallel})+U^{\parallel^\top}\bar x^\parallel=U^{\parallel^\top}\bar x^\parallel\)</span>ï¼Œå³æˆ‘ä»¬å‡è®¾<span class="math inline">\(U^{\parallel^\top}(\bar x-\bar x^\parallel)\approx 0\)</span>ã€‚äºæ˜¯æœ‰<span class="math inline">\(w^\parallel(z)=U^{\parallel^\top}f(\bar z)+SV^\top(z-\bar z)+O(\parallel z-\bar z\parallel^2)\)</span>ã€‚</p><p>å¦‚æœ<span class="math inline">\(Z\)</span>ä¸ºå®šä¹‰åœ¨æµå½¢ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒï¼Œé‚£ä¹ˆï¼š <span class="math display">\[p_{W^\parallel}(w^\parallel)=|\text{det}S^{-1}|p_Z(z)\]</span> <span class="math inline">\(p_{W^\bot}(w^\bot)\)</span>ç”±åŠå¾„ä¸º<span class="math inline">\(\parallel w^\bot\parallel\)</span>çš„è¶…çƒä½“<span class="math inline">\(\mathcal S^{m-n-1}\)</span>æ¥è¿›è¡Œä¼°è®¡ï¼š <span class="math display">\[p_{W^\bot}(w^\bot)\approx\frac{\Gamma(\frac{m-n}{2})}{2\pi^{\frac{m-n}{2}}\parallel w^\bot\parallel^{m-n}}p_{\parallel W^\bot\parallel}(\parallel w^\bot\parallel)\]</span></p><p>å…¶ä¸­<span class="math inline">\(\Gamma(\cdot)\)</span>ä»£è¡¨Gammaå‡½æ•°ã€‚</p><h2 id="manifold-learning-with-adversarial-autoencoders">Manifold Learning with Adversarial Autoencoders</h2><p>ä¸ºäº†å­¦ä¹ æ˜ å°„<span class="math inline">\(f\)</span>å’Œ<span class="math inline">\(g\)</span>ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†AAEæ¡†æ¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/sQhO3D4gKJqBPXv.png" srcset="/img/loading.gif" style="zoom: 67%;" /></p><p>é™¤äº†å¸¸è§„çš„AAEå¤–ï¼Œæˆ‘ä»¬è¿˜ä¸º<span class="math inline">\(x\)</span>æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„åˆ¤åˆ«å™¨ã€‚</p><h3 id="adversarial-losses">Adversarial Losses</h3><p>å¯¹äºéšå˜é‡<span class="math inline">\(z\)</span>ï¼Œå¯¹æŠ—æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[\mathcal L_{adv-d_z}(x,g,D_z)=E[\log(D_z(\mathcal N(0,1)))]+E[\log(1-D_z(g(x)))]\]</span> å¯¹äºæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œå¯¹æŠ—æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[\mathcal L_{adv-d_x}(x,D_x,f)=E[\log(D_x(x))]+E[\log(1-D_x(f(\mathcal N(0,1))))]\]</span></p><h3 id="autoencoder-loss">Autoencoder Loss</h3><p><span class="math display">\[\mathcal L_\text{error}(x,g,f)=-E_z[\log(p(f(g(x))|x))]\]</span></p><h3 id="full-objective">Full Objective</h3><p><span class="math display">\[\mathcal L(x,g,D_z,D_x,f)=\mathcal L_{adv-d_z}+\mathcal L_{adv-d_x}+\lambda \mathcal L_\text{error}\]</span></p><p>ä¸‹å›¾ä¸ºæ¨¡å‹é‡æ„çš„ä¾‹å­ï¼š</p><p><img src="https://i.loli.net/2020/06/25/i7ytlgjoIbYV6uF.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h1 id="experiments">Experiments</h1><h2 id="datasets">Datasets</h2><ul><li><strong>MNIST. </strong> æ‰‹å†Œæ•°å­—è¯†åˆ«æ•°æ®é›†ã€‚</li><li><strong>The Coil-100. </strong>åŒ…å«7200å¼ 100ä¸ªä¸åŒç‰©ä½“çš„ä¸åŒè§’åº¦çš„å›¾ç‰‡ã€‚</li><li><strong>Fashion-MNIST. </strong> æ‰‹å†Œæ•°å­—è¯†åˆ«æ•°æ®é›†å½©è‰²ç‰ˆã€‚</li><li><strong>Others. </strong> å‰ä¸‰ä¸ªæ•°æ®é›†éƒ½æ˜¯é‡‡ç”¨ä¸€ä¸ªç±»ä½œä¸ºinlierï¼Œè€Œå…¶ä»–ç±»ä½œä¸ºoutlierã€‚åœ¨è¿™ä¸€è®¾ç½®ä¸­inlieré‡‡æ ·è‡ªæ•°æ®é›†CIFAR-10(CIFAR-100)ï¼Œè€Œoutlieré‡‡æ ·è‡ªTinyImageNetã€LSUNå’ŒiSUNã€‚</li></ul><h2 id="results">Results</h2><h3 id="mnist-dataset">MNIST Dataset</h3><p><img src="https://i.loli.net/2020/06/25/5a71oidmK2ZGLyh.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/25/4lcGeHDrhbdKN5W.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="coil-100-dataset">Coil-100 Dataset</h3><p><img src="https://i.loli.net/2020/06/25/ofVGBgR7a3WmyvU.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="fashion-mnist">Fashion-MNIST</h3><p><img src="https://i.loli.net/2020/06/25/avURoBw6ny8SIEq.png" srcset="/img/loading.gif" /></p><h3 id="cifar-10-cifar-100">CIFAR-10 (CIFAR-100)</h3><p><img src="https://i.loli.net/2020/06/25/piteKy1m9kvQ6EU.png" srcset="/img/loading.gif" style="zoom: 67%;" /></p><h3 id="ablation">Ablation</h3><p><img src="https://i.loli.net/2020/06/25/xgni9wBtYkheGZq.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/25/idhqkCbAKvzMt68.png" srcset="/img/loading.gif" style="zoom:67%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>GAN</tag>
      
      <tag>Novelty Detection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Estimate the Implicit Likelihoods of GANs with Application to Anomaly Detection</title>
    <link href="/2020/06/06/Estimate-the-Implicit-Likelihoods-of-GANs-with-Application-to-Anomaly-Detection/"/>
    <url>/2020/06/06/Estimate-the-Implicit-Likelihoods-of-GANs-with-Application-to-Anomaly-Detection/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><h1 id="preliminaries">Preliminaries</h1><h2 id="flow-based-models-recap">Flow-based Models Recap</h2><h3 id="jacobian-matrix-and-determinant">Jacobian Matrix and Determinant</h3><p>è®¾å‡½æ•°<span class="math inline">\(f:\mathbb{R}^n\mapsto\mathbb{R}^m\)</span>ï¼Œç”±<span class="math inline">\(f\)</span>çš„ä¸€é˜¶åå¯¼æ•°ç»„æˆçš„çŸ©é˜µå«åšJacobiançŸ©é˜µï¼š <span class="math display">\[\mathbf J=\left[\begin{matrix}\frac{\partial f_1}{\partial x_1} &amp;\cdots &amp;\frac{\partial f_1}{\partial x_n}\\\vdots &amp;\ddots &amp;\vdots\\\frac{\partial f_m}{\partial x_1}&amp; \dots&amp; \frac{\partial f_m}{\partial x_n}\end{matrix}\right]\]</span></p><h3 id="change-of-variable-theorem">Change of Variable Theorem</h3><p>ç»™å®šå·²çŸ¥æ¦‚ç‡åˆ†å¸ƒçš„éšæœºå˜é‡<span class="math inline">\(z\sim\pi(z)\)</span>ï¼Œæ–°éšæœºå˜é‡ç”±å¯é€†æ˜ å°„<span class="math inline">\(f\)</span>ç»™å‡º<span class="math inline">\(x=f(z)\)</span>ï¼Œ<span class="math inline">\(z=f^{-1}(x)\)</span>ã€‚ç”±äºï¼š <span class="math display">\[\int p(x)\mathrm{d}x=\int \pi(z)\mathrm d z=1\]</span> æ‰€ä»¥<span class="math inline">\(p(x)\)</span>å¯ä»¥ç”±ä¸‹å¼å¾—åˆ°ï¼š <span class="math display">\[p(x)=\pi(z)\left|\frac{\mathrm d z}{\mathrm d x}\right|=\pi(f^{-1}(x))\left|\frac{\mathrm d f^{-1}}{\mathrm d x}\right|=\pi(f^{-1}(x))|(f^{-1})^\prime(x)|\]</span> <span class="math inline">\(\frac{\mathrm d f^{-1}}{\mathrm d x}\)</span>ç›¸å½“äºå¯¹é€†å‡½æ•°<span class="math inline">\(f^{-1}\)</span>æ±‚å¯¼ï¼Œè€Œ<span class="math inline">\(z=f^{-1}(x)\)</span>ã€‚</p><p>å¯¹äºå¤šå˜é‡çš„æƒ…å†µï¼š <span class="math display">\[\mathbf z\sim \pi(\mathbf z), \mathbf x=f(\mathbf z),\mathbf z = f^{-1}(\mathbf x)\\p(\mathbf x) = \pi(\mathbf z)\left|\text{det}\frac{\mathrm d \mathbf z}{\mathrm d \mathbf x}\right|= \pi(f^{-1}(\mathbf x))\left|\text{det}\frac{\mathrm d f^{-1}}{\mathrm d \mathbf x}\right|\]</span> <span class="math inline">\(\left|\text{det}\frac{\mathrm d f^{-1}}{\mathrm d \mathbf x}\right|\)</span>ä¸ºé€†å‡½æ•°JacobiançŸ©é˜µè¡Œåˆ—å¼çš„ç»å¯¹å€¼ã€‚</p><h2 id="deep-generative-models-as-manifolds">Deep Generative Models as Manifolds</h2><p>ä¸€ä¸ªæ·±åº¦ç”Ÿæˆæ¨¡å‹å¯ä»¥è¡¨ç¤ºä¸ºä»ä½ç»´éšç©ºé—´<span class="math inline">\(\mathcal Z \subseteq R^d\)</span>æ˜ å°„åˆ°æµå½¢<span class="math inline">\(\mathcal M\subseteq R^D\)</span>çš„åµŒå…¥å‡½æ•°<span class="math inline">\(g:\mathcal Z\rightarrow \mathcal X\)</span>ï¼Œ<span class="math inline">\(D \ll d\)</span>ã€‚é€šå¸¸å‡è®¾<span class="math inline">\(g\)</span>ä¸ºå…‰æ»‘æ˜ å°„ï¼Œé‚£ä¹ˆ<span class="math inline">\(\mathcal M\)</span>ä¸ºä¸€ä¸ªåµŒå…¥æµå½¢ã€‚<span class="math inline">\(g\)</span>åœ¨<span class="math inline">\(z\in\mathcal Z\)</span>çš„é›…å„æ¯”çŸ©é˜µ<span class="math inline">\(\mathbf J_g(z)\)</span>æä¾›äº†åœ¨<span class="math inline">\(x=g(z)\in\mathcal X\)</span>å¤„çš„åˆ‡ç©ºé—´ï¼Œå³<span class="math inline">\(\mathbf J_g:T_z\mathcal Z\rightarrow T_x\mathcal X\)</span>ã€‚è¿™ä¸ªæ˜ å°„ä¸æ˜¯æ»¡å°„ï¼Œå¹¶ä¸”å€¼åŸŸé™åˆ¶åœ¨æµå½¢<span class="math inline">\(\mathcal M\)</span>åœ¨<span class="math inline">\(x=g(z)\)</span>çš„åˆ‡ç©ºé—´ï¼Œè®°ä¸º<span class="math inline">\(T_x\mathcal M\)</span>ã€‚<span class="math inline">\(\mathcal M\)</span>ä¸çœŸå®æ•°æ®æµå½¢æ¥è¿‘ï¼Œå³<span class="math inline">\(\mathcal M_{data}\)</span>ã€‚</p><p>è€ƒè™‘ä¸€ä¸ªå®šä¹‰åœ¨éšç©ºé—´<span class="math inline">\(\mathcal Z\)</span>æ¯ä¸€ç‚¹<span class="math inline">\(z\)</span>ä¸Šçš„Riemannian metricï¼š <span class="math display">\[\mathbf M(z)=\mathbf J_g(z)^\top\mathbf J_g(z)\]</span> ç»™å®šä¸¤ä¸ªåˆ‡ç©ºé—´å‘é‡<span class="math inline">\(u,v\in T_z\in\mathcal Z\)</span>ï¼Œä»–ä»¬çš„å†…ç§¯å®šä¹‰ä¸º<span class="math inline">\(&lt;u,v&gt;=u^\top \mathbf M(z)v\)</span>ã€‚</p><p>è€ƒè™‘ä¸€ä¸ªå…‰æ»‘æ›²çº¿<span class="math inline">\(\gamma:t\in[a,b]\rightarrow\mathcal Z\)</span>ï¼Œ <span class="math display">\[L(\gamma)=\int^b_a\sqrt{\hat{\gamma}(t)^\top M_{\gamma(t)}\hat{\gamma}(t)}\mathrm d t\]</span></p><h2 id="change-of-variable-on-manifolds">Change of Variable on Manifolds</h2><p>åœ¨æµå½¢ä¸Šçš„<strong>Change of Variable Theorem</strong>æ˜¯ç±»ä¼¼çš„ï¼š</p><p><span class="math display">\[p_\mathcal{X}(x)=p_\mathcal{Z}(g^{-1}(x))\text{det}(\mathbf J_g(g^{-1}(x))^\top\mathbf J_g(g^{-1}(x)))^{-\frac{1}{2}}\]</span></p><p>æˆ‘ä»¬å‡è®¾éšç©ºé—´åˆ†å¸ƒ<span class="math inline">\(p_\mathcal{Z}\)</span>æœä»æ ‡å‡†æ­£æ€å…ˆéªŒåˆ†å¸ƒ<span class="math inline">\(N(0,\mathbf I_d)\)</span>ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡º<span class="math inline">\(x\)</span>çš„ä¼¼ç„¶ï¼š</p><p><span class="math display">\[\log(p_\mathcal{X}(g(z)))=\log(p_\mathcal{Z}(z))-\frac{1}{2}\log(\text{det}(\mathbf J_g(z)^\top\mathbf J_g(z)))\]</span></p><p>é€šå¸¸æˆ‘ä»¬æ²¡æ³•çŸ¥é“çœŸå®ä¸–ç•Œä¸­<span class="math inline">\(\mathcal M_{data}\)</span>çš„åˆ‡ç©ºé—´ç»´åº¦æ˜¯å¤šå°‘ï¼Œè®¾å®š<span class="math inline">\(d=\text{dim}\mathcal Z&gt;T_x\mathcal M_{data}\)</span>ä¼šå¯¼è‡´<span class="math inline">\(\mathbf J_g\)</span>ä¸æ˜¯æ»¡ç§©çŸ©é˜µï¼Œè¿™æ—¶<span class="math inline">\(\text{det}(\mathbf J_g(z)^\top\mathbf J_g(z))=0\)</span>ï¼Œå³æ— æ³•åº”ç”¨ä¸Šå¼è®¡ç®—ä¼¼ç„¶ã€‚</p><h2 id="density-estimation-with-neural-networks">Density Estimation with Neural Networks</h2><h2 id="anomaly-detection-with-generative-models">Anomaly Detection with Generative Models</h2><h1 id="proposed-method">Proposed Method</h1><p>å¯¹äºGANæ¨¡å‹ï¼Œç»™å®šéšå˜é‡<span class="math inline">\(z\)</span>å’Œç”Ÿæˆå™¨<span class="math inline">\(g\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¬å¼(8)è®¡ç®—ç”Ÿæˆæ ·æœ¬<span class="math inline">\(g(z)\)</span>çš„å¯¹æ•°ä¼¼ç„¶ï¼Œä¸ºäº†ä¿è¯JacobiançŸ©é˜µä¸ºæ»¡ç§©ï¼Œæˆ‘ä»¬å¯ä»¥é€‰å®šè¾ƒä½çš„éšå˜é‡ç»´åº¦<span class="math inline">\(d\)</span>ï¼Œä¸è¿‡è¿™æ ·ä¼šä¼¤å®³GANæ¨¡å‹çš„æ€§èƒ½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ª<em>inference network</em>æ¥å°†<span class="math inline">\(x\)</span>æ˜ å°„å›<span class="math inline">\(z\)</span>ï¼Œ</p><h2 id="the-variance-network-of-the-generator">The Variance Network of the Generator</h2><p>æ–‡ä¸­å¯¹ç”Ÿæˆå™¨<span class="math inline">\(g\)</span>è¿›è¡Œäº†æ‰©å±•ï¼š</p><p><span class="math display">\[f(z) = g(z) + \sigma(z)\odot\epsilon,\\g:\mathcal Z\rightarrow\mathcal X, \sigma:\mathcal Z\rightarrow\mathbb{R},\epsilon\sim N(0,\mathbf I_D)\]</span></p><p><span class="math inline">\(g\)</span>ä»£è¡¨å‡å€¼ï¼Œ<span class="math inline">\(\sigma\)</span>ä»£è¡¨æ–¹å·®ï¼Œå®é™…ä¸Š<span class="math inline">\(\mathbb E_{\epsilon\sim N(0,\mathbf I_D)}f(z)=g(z)\)</span>ã€‚ä¸ºäº†ä¿è¯æ–¹å·®åœ¨å°‘æ ·æœ¬æˆ–æ— æ ·æœ¬çš„åŒºåŸŸæ›´å¤§ï¼Œæ–¹å·®ç½‘ç»œé‡‡ç”¨RBFç½‘ç»œå®ç°ã€‚</p><blockquote><p>RBFç½‘ç»œï¼š <span class="math display">\[h(x)=\exp\left(-\frac{(x-c)^2}{r^2}\right)\]</span> <img src="https://i.loli.net/2020/06/25/ho5FJsOBjxi2G78.png" srcset="/img/loading.gif" style="zoom: 80%;" /></p><p><img src="https://i.loli.net/2020/06/25/rtRLwyK2VigOvTh.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p></blockquote><p>é¦–å…ˆï¼Œä»éšç©ºé—´é‡‡æ ·å¤§é‡çš„æ ·æœ¬ï¼Œä¹‹åä½¿ç”¨<strong>K-means</strong>ç®—æ³•å°†å…¶åˆ†ä¸º<span class="math inline">\(K\)</span>ä¸ªèšç°‡ï¼Œ<span class="math inline">\(c_k\)</span>ä¸ºç¬¬<span class="math inline">\(k\)</span>ä¸ªç°‡çš„ä¸­å¿ƒï¼Œ<span class="math inline">\(C_k\)</span>ä¸ºç¬¬<span class="math inline">\(k\)</span>ä¸ªç°‡çš„æ ·æœ¬æ•°é‡ã€‚å¯¹äºä»»ä½•æ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œä¸ºäº†è®¡ç®—å…¶å¯¹åº”çš„æ–¹å·®ï¼Œéœ€è¦ç”¨ä¸€ä¸ª<em>inference network</em> <span class="math inline">\(h\)</span>æ¥å°†å…¶æ˜ å°„åˆ°éšç©ºé—´ï¼Œå³<span class="math inline">\(z=h(x)\)</span>ã€‚RBFç½‘ç»œé€šè¿‡è¾“å…¥<span class="math inline">\(z\)</span>åˆ°æ¯ä¸ªç°‡ä¸­å¿ƒçš„è·ç¦»æ¥è¿”å›<span class="math inline">\(x\)</span>å¯¹åº”çš„æ–¹å·®ï¼ŒRBFå‡½æ•°ç”±ä¸‹å¼ç»™å‡ºï¼š <span class="math display">\[\sigma(z)=(\mathbf W^2\mathbf v(z))^{-\frac{1}{2}},\\v_k(z) = \exp(-\lambda_k\parallel z-c_k\parallel^2_2), \space k=1,\cdots,K\\\lambda_k=\frac{1}{2}\left(\frac{a}{|C_k|}\sum_{z_j\in C_k}\parallel z_j-c_k\parallel_2\right)^{-2}\]</span></p><p>å…¶ä¸­<span class="math inline">\(\alpha\)</span>ä¸ºæ ¸çš„è¶…å‚æ•°ï¼Œ<span class="math inline">\(\mathbf W\)</span>ä¸ºæ¨¡å‹å‚æ•°ã€‚ç»™å®šç”Ÿæˆå™¨<span class="math inline">\(g\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æœ€å°åŒ–<span class="math inline">\(f(z)\)</span>å’Œ<span class="math inline">\(x\)</span>ä¹‹é—´çš„è·ç¦»æ¥ä¼˜åŒ–å‚æ•°<span class="math inline">\(\mathbf W\)</span>ã€‚</p><p><span class="math display">\[\begin{align}\bar{\mathbf M}^z_f&amp;=\mathbb E_{\epsilon\sim N(0,\mathbf I_D)}\mathbf J_f^\top(z)\mathbf J_f(z)\\&amp;=\mathbf J_g^\top(z)\mathbf J_g(z)+\mathbf J_\sigma^\top(z)\mathbf J_\sigma(z)\end{align}\]</span></p><blockquote><p><strong>LEMMA 1. </strong> å¯¹äº<span class="math inline">\(K\geq \text{dim}(\mathcal Z)+1\)</span>å’Œæ»¡ç§©çŸ©é˜µ<span class="math inline">\(\mathbf W^2\)</span>ï¼Œ<span class="math inline">\(\bar{\mathbf M}_f^z\)</span>ä¸ºä¸€ä¸ªæ»¡ç§©çŸ©é˜µã€‚ç”Ÿæˆæ ·æœ¬çš„å¯¹æ•°ä¼¼ç„¶ç”±ä¸‹å¼ç»™å‡ºï¼š <span class="math display">\[\mathbb E_{\epsilon\sim N(0,\mathbf I_D)}\log(p_\mathcal{X}(f(z)))=\log(p_\mathcal{Z}(z))-\frac{1}{2}\log(\text{det}(\bar{\mathbf M}_f^z))\]</span></p></blockquote><h2 id="the-inference-network-learning">The Inference Network Learning</h2><p><img src="https://i.loli.net/2020/06/25/AZfIrq2v8RVipj1.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><span class="math display">\[\max_{h,\sigma}\mathbb E_{x\sim p_{data}(x)}\left[\log(p(x|z))|_{z=h(x)}\right]\]</span></p><p><span class="math inline">\(p(x|z)\)</span></p><p><span class="math display">\[\max_{h,\sigma}\mathbb E_{x\sim p_{data}(x), z=h(x)}\left[\log(p(x|z))-\text{KL}\right]\]</span></p><blockquote><p><strong>LEMMA 2. </strong> <span class="math display">\[f(z)\sim GP(g(z), \Lambda_\sigma)\]</span></p></blockquote><p><span class="math display">\[L_{h,\sigma}=\mathbb E_{x\sim p_{data}}\left[\sum_{i=1}^D[-\frac{1}{2}(g_i(h(x))-x_i)^2/\sigma_i^2(h(x))-\log\sigma_i(h(x))]-\text{KL}(q(z|x)\parallel p(z))\right]\]</span></p><h2 id="stabilize-training">Stabilize Training</h2><p><span class="math display">\[\min_{g,h}\mathbb E_{z\sim p(z)}[\parallel z-h(g(z))\parallel^2]\]</span></p><h2 id="algorithm">Algorithm</h2><p><img src="https://i.loli.net/2020/06/25/PjJF9wBM2XS38TQ.png" srcset="/img/loading.gif" style="zoom: 80%;" /></p><blockquote><p><strong>LEMMA 3. </strong></p></blockquote><h1 id="experiments">Experiments</h1><p><img src="https://i.loli.net/2020/06/25/GlqvJFOtEnbNoUP.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><img src="https://i.loli.net/2020/06/25/Z8yDQU9McsT5GXI.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><img src="https://i.loli.net/2020/06/25/NmBten8igTUV76L.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><img src="https://i.loli.net/2020/06/25/8phKZkiRxdLyBT6.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/25/noBqN9gWfPuFy8w.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><img src="https://i.loli.net/2020/06/25/sJnwi5RzLAU3D6x.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><img src="https://i.loli.net/2020/06/25/OvtLenWDSEi37lX.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><img src="https://i.loli.net/2020/06/25/TIJbpsvGkwz3rVF.png" srcset="/img/loading.gif" style="zoom:67%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>GAN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Classification-based Anomaly Detection for General Data</title>
    <link href="/2020/06/02/Classification-based-Anomaly-Detection-for-General-Data/"/>
    <url>/2020/06/02/Classification-based-Anomaly-Detection-for-General-Data/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡ä¸»è¦æ˜¯å¯¹<a href="http://qfxiao.me/2020/06/01/Deep-Anomaly-Detection-Using-Geometric-Transformations/">NIPS18è¿™ç¯‡å¼‚å¸¸æ£€æµ‹æ–‡ç« </a>çš„æ”¹è¿›ï¼Œé¦–å…ˆæ˜¯åˆ©ç”¨äº†æ ‡ç­¾ä¿¡æ¯æ¥æå‡ç®—æ³•çš„è¡¨ç°ï¼Œå…¶æ¬¡æ˜¯å°†ç®—æ³•æ‰©å±•åˆ°äº†éå›¾åƒæ•°æ®ã€‚ä½œè€…å¯¹ç°æœ‰çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•è¿›è¡Œäº†å›é¡¾ï¼š</p><ul><li><strong>Reconstruction Methodsï¼š </strong>è¿™ä¸€éƒ¨åˆ†æ–¹æ³•å‡è®¾å¼‚å¸¸æ ·æœ¬å’Œæ­£å¸¸æ ·æœ¬èƒ½å¤Ÿé€šè¿‡é‡æ„ä»»åŠ¡æ¥è¿›è¡ŒåŒºåˆ†ã€‚é€šè¿‡åœ¨æ­£å¸¸æ ·æœ¬ä¸Šå­¦ä¹ é‡æ„ä»»åŠ¡ï¼Œä¹‹åå¯¹äºæ­£å¸¸æ ·æœ¬ï¼Œæ¨¡å‹èƒ½å¤Ÿå¾ˆå¥½åœ°è¿›è¡Œé‡æ„ï¼Œè€Œå¼‚å¸¸æ ·æœ¬åˆ™ä¼šæœ‰è¾ƒé«˜çš„é‡æ„è¯¯å·®ã€‚</li><li><strong>Distributional Methodsï¼š </strong>è¿™ä¸€éƒ¨åˆ†æ–¹æ³•å°†å¼‚å¸¸æ£€æµ‹çœ‹ä½œæ˜¯å¯†åº¦ä¼°è®¡é—®é¢˜ã€‚é€šè¿‡å¯¹æ­£å¸¸æ ·æœ¬çš„åˆ†å¸ƒè¿›è¡Œä¼°è®¡ï¼Œå¼‚å¸¸æ ·æœ¬åœ¨è¯¥æ­£å¸¸åˆ†å¸ƒä¸‹çš„ä¼¼ç„¶å°†ä¼šå¾ˆä½ã€‚</li><li><strong>Classification-based Methodsï¼š </strong>è¿™ä¸€éƒ¨åˆ†æ–¹æ³•ä¸»è¦æ˜¯æŒ‡çš„å•åˆ†ç±»æ–¹æ³•å’Œé€šè¿‡å‡ ä½•å˜æ¢æ„é€ åˆ†ç±»ä»»åŠ¡çš„æ–¹æ³•ã€‚æœ¬æ–‡ä½¿ç”¨çš„å°±æ˜¯è¿™ç±»æ–¹æ³•ã€‚</li></ul><h1 id="proposed-method">Proposed Method</h1><h2 id="classification-based-anomaly-detection">Classification-based Anomaly Detection</h2><p>å‡è®¾æ‰€æœ‰æ•°æ®ä½äºç©ºé—´<span class="math inline">\(R^L\)</span>å†…ï¼Œè€Œæ­£å¸¸æ•°æ®ä½äºå­ç©ºé—´<span class="math inline">\(X\subset R^L\)</span>å†…ã€‚æˆ‘ä»¬å‡è®¾æ‰€æœ‰çš„å¼‚å¸¸æ ·æœ¬ä½äº<span class="math inline">\(X\)</span>ä¹‹å¤–ã€‚ä¸ºäº†æ£€æµ‹å¼‚å¸¸ï¼Œæˆ‘ä»¬å¸Œæœ›å­¦ä¹ ä¸€ä¸ªåˆ†ç±»å™¨<span class="math inline">\(C\)</span>ä½¿å¾—å¯¹äºæ‰€æœ‰çš„<span class="math inline">\(x\in X\)</span>æœ‰<span class="math inline">\(C(x)=1\)</span>ï¼Œè€Œå¯¹æ‰€æœ‰çš„<span class="math inline">\(x\in R^L\backslash X\)</span>æœ‰<span class="math inline">\(C(x)=0\)</span>ã€‚</p><p>å•åˆ†ç±»æ–¹æ³•çš„æ€æƒ³æ˜¯ç›´æ¥å­¦ä¹ <span class="math inline">\(P(x\in X)\)</span>ï¼Œä»£è¡¨çš„æ–¹æ³•æœ‰One-Class SVMï¼ŒDSVDDç­‰ã€‚ä¼ ç»Ÿçš„OC-SVMç›´æ¥åœ¨åŸå§‹ç©ºé—´æˆ–è€…æ ¸ç©ºé—´å­¦ä¹ åˆ†ç±»å™¨ã€‚æ¯”è¾ƒæ–°çš„æ–¹æ³•ï¼Œå¦‚Deep-SVDDåˆ™æ˜¯å…ˆå°†æ ·æœ¬è½¬æ¢åˆ°ä¸€ä¸ªç‰¹å¾ç©ºé—´ï¼Œç„¶ååœ¨è¿™ä¸ªç‰¹å¾ç©ºé—´ä¸Šå­¦ä¹ ä½¿å¾—åŠå¾„<span class="math inline">\(R\)</span>æœ€å°çš„è¶…çƒä½“ï¼ˆçƒå¿ƒ<span class="math inline">\(c_0\)</span>ï¼‰ï¼Œæ¥è¦†ç›–ä½æ‰€æœ‰æ­£å¸¸æ ·æœ¬ã€‚å¼‚å¸¸çš„åˆ¤å®šåˆ™é€šè¿‡è®¡ç®—<span class="math inline">\(\parallel f(x)-c_0\parallel^2-R^2\)</span>æ¥å®ç°ã€‚ä¸è¿‡å­¦ä¹ ä¸€ä¸ªå¥½çš„æ ·æœ¬åˆ°ç‰¹å¾ç©ºé—´çš„å˜æ¢å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¯´<span class="math inline">\(f(x)=0, \forall x \in X\)</span>å°±æ˜¯ä¸€ä¸ªä½¿å¾—è¶…çƒä½“æœ€å°çš„è§£ã€‚æ‰€ä»¥éœ€è¦å¾ˆå¤štrickæ¥é¿å…è¯¸å¦‚æ­¤ç±»çš„æƒ…å†µã€‚</p><p><em>Geometric-transformation classification</em> (GEOM) åˆ™å°†æ•°æ®ç©ºé—´<span class="math inline">\(X\)</span>é€šè¿‡<span class="math inline">\(M\)</span>ä¸ªå‡ ä½•å˜æ¢è½¬æ¢åˆ°ä¸€ç³»åˆ—å­ç©ºé—´<span class="math inline">\(X_1,\cdots,X_M\)</span>ã€‚ä¹‹åè®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨æ¥é¢„æµ‹æ ·æœ¬<span class="math inline">\(T(x,m)\)</span>å¯¹åº”çš„å‡ ä½•å˜æ¢çš„ç§ç±»<span class="math inline">\(m\)</span>ã€‚è½¬æ¢åçš„æ­£å¸¸å›¾ç‰‡ç©ºé—´è®°ä¸º<span class="math inline">\(\cup_m X_m\)</span>ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•å°è¯•ä¼°è®¡ä»¥ä¸‹æ¡ä»¶æ¦‚ç‡ï¼š <span class="math display">\[P(m^\prime|T(x,m))=\frac{P(T(x,m)\in X_{m^\prime})P(m^\prime)}{\sum_{\bar{m}}P(T(x,m)\in X_{\bar{m}})P(\tilde{m})}-\frac{P(T(x,m)\in X_{m^\prime})}{\sum_{\bar{m}}P(T(x,m)\in X_{\bar{m}})}\]</span></p><p>å¯¹äºå¼‚å¸¸çš„æ ·æœ¬<span class="math inline">\(x\in R^L\backslash X\)</span>ï¼Œåœ¨ç»è¿‡å‡ ä½•å˜æ¢ä¹‹åï¼Œéƒ½ä¸ä¼šä½äºæ­£ç¡®çš„å­ç©ºé—´ä¸­ï¼Œå³<span class="math inline">\(T(x,m)\in R^L\backslash X_m\)</span>ã€‚ä¹‹åï¼Œä½¿ç”¨<span class="math inline">\(P(m|T(x,m))\)</span>æ¥åˆ¤å®šå¼‚å¸¸ã€‚</p><p>ä½œè€…è®¤ä¸ºï¼Œè¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯åˆ†ç±»å™¨<span class="math inline">\(P(m^\prime|T(x,m))\)</span>åªåœ¨æ­£å¸¸æ•°æ®ä¸Šè®­ç»ƒï¼Œè€Œå¯¹äºå¼‚å¸¸æ ·æœ¬çš„å¼‚å¸¸åˆ†æ•°ä¼šå‡ºç°æ–¹å·®å¾ˆå¤§çš„é—®é¢˜ã€‚</p><p>ä¸€ç§è§£å†³æ–¹å¼æ˜¯åŠ å…¥å¼‚å¸¸æ ·æœ¬è¿›è¡Œè®­ç»ƒï¼Œä½†æ˜¯ä½œè€…è®¤ä¸ºåœ¨æœ‰çš„ä»»åŠ¡ä¸­æ ‡ç­¾å¾ˆéš¾è·å–ï¼Œäºæ˜¯ä½œè€…ä½¿ç”¨äº†å¦å¤–ä¸€ç§æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="distance-based-multiple-transformation-classification">Distance-based Multiple Transformation Classification</h2><p>å’ŒGEOMä¸€æ ·ï¼Œå…ˆå¯¹æ¯ä¸ªæ ·æœ¬è¿›è¡Œ<span class="math inline">\(M\)</span>ä¸ªå‡ ä½•å˜æ¢ï¼Œç„¶åå­¦ä¹ ä¸€ä¸ªç‰¹å¾æå–å™¨<span class="math inline">\(f(x)\)</span>ï¼Œå°†<span class="math inline">\(X_m\)</span>æ˜ å°„åˆ°ç‰¹å¾ç©ºé—´ã€‚ä¹‹åå’ŒOC-SVMç±»ä¼¼ï¼Œå‡è®¾ç‰¹å¾<span class="math inline">\(\{f(x)|x\in X_m\}\)</span>ä¸ºçƒå¿ƒä¸º<span class="math inline">\(c_m=\frac{1}{N}\sum_{x\in X} f(T(x,m))\)</span>çš„è¶…çƒä½“ã€‚æ ·æœ¬å±äºæŸä¸€ç±»<span class="math inline">\(m^\prime\)</span>çš„æ¦‚ç‡ç”±ä¸‹å¼ç»™å‡ºï¼š</p><p><span class="math display">\[P(m^\prime|T(x,m))=\frac{e^{-\parallel f(T(x,m))-c_{m^\prime}\parallel^2}}{\sum_{\bar m}e^{-\parallel f(T(x,m))-c_{\bar m}\parallel^2}}\]</span></p><p>ç›®æ ‡å‡½æ•°é‡‡ç”¨çš„æ˜¯Triplet Lossï¼š</p><p><span class="math display">\[L=\sum_i\max(\parallel f(T(x_i,m))-c_m\parallel^2+s-\min_{m^\prime\neq m}\parallel f(T(x_i,m))-c_{m^\prime}\parallel^2,0)\]</span></p><p><span class="math inline">\(\parallel f(T(x_i,m))-c_m\parallel^2\)</span>ç›¸å½“äºæœ€å°åŒ–äº†ç±»å†…è·ç¦»ï¼Œ<span class="math inline">\(\min_{m^\prime\neq m}\parallel f(T(x_i,m))-c_{m^\prime}\parallel^2\)</span>æœ€å¤§åŒ–äº†æ¯ä¸ªç±»å¯¹åº”çš„é›†ç°‡é—´è·ç¦»ã€‚åœ¨æ£€æµ‹é˜¶æ®µï¼Œä¸ºäº†é¿å…ä¸€äº›æ•°å€¼é—®é¢˜ï¼Œä½œè€…åšäº†ä¸€äº›å¹³æ»‘æ“ä½œï¼š</p><p><span class="math display">\[\tilde P(m^\prime|T(x,m))=\frac{e^{-\parallel f(T(x,m))-c_{m^\prime}\parallel^2+\epsilon}}{\sum_{\tilde m}e^{-\parallel f(T(x,m))-c_{\tilde m}\parallel^2+M\cdot\epsilon}}\]</span></p><p>æœ€åçš„è¯„åˆ¤åˆ†æ•°ç”±ä¸‹å¼ç»™å‡ºï¼š</p><p><span class="math display">\[Score(x)=-\log P(x\in X)=-\sum_m\log \tilde{P}(T(x,m)\in X_m)=-\sum_m\log\tilde{P}(m|T(x,m))\]</span></p><p>ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/r48h1RJxcXF6YDM.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="parameterizing-the-set-of-transformations">Parameterizing the Set of Transformations</h2><p>åœ¨GEOMä¸­ï¼Œç”±äºä½¿ç”¨çš„å‡ ä½•å˜æ¢éƒ½æ˜¯é’ˆå¯¹å›¾åƒçš„ï¼Œæ‰€ä»¥å¯¹äºå…¶ä»–ç±»å‹çš„æ•°æ®å¹¶ä¸é€‚ç”¨ã€‚æœ¬æ–‡ä¸­ä½œè€…å¯¹éå›¾åƒæ•°æ®è®¾è®¡äº†ä»¥ä¸‹å˜æ¢ï¼š</p><p><span class="math display">\[T(x,m)=W_mx+b_m\]</span></p><p>ä¸åŒçš„å‚æ•°<span class="math inline">\(W_m\)</span>å’Œ<span class="math inline">\(b_m\)</span>å³ä¸ºä¸åŒçš„å‡ ä½•å˜æ¢ï¼Œå¯ä»¥è€ƒè™‘é‡‡ç”¨éšæœºé‡‡æ ·çš„æ–¹å¼ã€‚</p><h1 id="experiments">Experiments</h1><h2 id="image-experiments">Image Experiments</h2><p>å¯¹äºå›¾åƒæ•°æ®çš„å¼‚å¸¸æ£€æµ‹å®éªŒï¼Œä½œè€…é‡‡ç”¨äº†CIFAR10ã€FasionMNISTè¿™ä¸¤ä¸ªæ•°æ®é›†ï¼Œå®éªŒç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/j4Y29tB6k1Aipgo.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><img src="https://i.loli.net/2020/06/24/D3opwrLnSGmcsyM.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="tabular-data-experiments">Tabular Data Experiments</h2><p>å¯¹äºéå›¾åƒæ•°æ®ï¼Œä½œè€…é‡‡ç”¨äº†å‡ ä¸ªå°çš„æ•°æ®é›†ï¼šArrhythmiaã€Thyroidã€KDDå’ŒKDDRevã€‚é‡‡ç”¨çš„BaselineåŒ…æ‹¬OC-SVMã€E2E-AEã€LOFã€DAGMMå’ŒFB-AE (Feature Bagging Autoencoder)ã€‚å¯¹äºå‡ ä½•å˜æ¢çš„å‚æ•°ï¼Œé‡‡æ ·è‡ªæ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/e6PfIDOVwlzrSWi.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h1 id="remark">Remark</h1><p>ç»“åˆ<a href="https://openreview.net/forum?id=H1lK_lBtvS" target="_blank" rel="noopener">OpenReview</a>ä¸Šçš„ä¸€äº›è®¨è®ºï¼Œè¿™é‡Œæå‡ºä¸€äº›é—®é¢˜å’Œæ€»ç»“ï¼š</p><ul><li>KDDæ•°æ®é›†å¤ªç®€å•äº†ï¼Œæ­£å¸¸ã€å¼‚å¸¸æ ·æœ¬èƒ½å¤Ÿå¾ˆå®¹æ˜“è¢«åˆ†å¼€ï¼›</li><li>å¯¹äºå›¾åƒæ•°æ®ä½œè€…åªä½¿ç”¨äº†CIFAR10å’ŒFashionMNISTè¿™ä¸¤ä¸ªæ¯”è¾ƒå°çš„æ•°æ®é›†ï¼Œè€Œåœ¨GEOMä¸­è¿˜ä½¿ç”¨äº†CIFAR100å’ŒCatsVsDogsã€‚å¹¶ä¸”GEOMåŸæ–‡ä¸­æåˆ°æ•°æ®é›†ï¼ˆæŒ‡å›¾åƒå¤§å°ï¼‰è¶Šå¤§ï¼ŒGEOMçš„ä¼˜åŠ¿å°±è¶Šæ˜æ˜¾ï¼Œæ‰€ä»¥åœ¨æœ¬æ–‡çš„å®éªŒä¸­åªä½¿ç”¨è¿™ä¸¤ä¸ªæ•°æ®é›†è¯´æœåŠ›ç•¥æ˜¾ä¸å¤Ÿï¼›</li><li>å…³äºè¯„æµ‹æ ‡å‡†çš„é—®é¢˜ï¼Œä½œè€…åœ¨å›¾åƒæ•°æ®ä¸­ç”¨çš„æ˜¯AUROCï¼Œè€Œéå›¾åƒæ•°æ®ç”¨çš„æ˜¯F1 scoreã€‚åƒAUPRã€AUROCè¿™ç§è¯„æµ‹æ ‡å‡†å¾€å¾€æ›´åŠ å…¨é¢ï¼Œè€ŒF1 scoreä¾èµ–äºé˜ˆå€¼çš„é€‰å–ã€‚å¦‚æœæ˜¯éå†é˜ˆå€¼æ‰¾åˆ°æœ€å¥½çš„é‚£ä¸ªF1 scoreï¼Œåˆ™æ— æ³•å…¨é¢è€ƒå¯Ÿæ¨¡å‹çš„é²æ£’æ€§ï¼Œæ¨¡å‹æœ‰å¯èƒ½åªæ˜¯åœ¨ç‰¹å®šçš„é˜ˆå€¼ä¸‹è¡¨ç°å¾ˆå¥½ï¼Œè€Œé˜ˆå€¼ç¨å¾®åå·®ä¸€ä¸‹æ€§èƒ½å¯èƒ½å°±ä¼šå¤§å¹…ä¸‹é™ã€‚æˆ‘çœ‹åˆ°çš„å¤§å¤šæ•°å¼‚å¸¸æ£€æµ‹æ–‡ç« éƒ½æ˜¯ä½¿ç”¨AUROCæˆ–è€…F1åŠ ä¸ŠAUROCä½œä¸ºè¯„æµ‹æŒ‡æ ‡ï¼›</li><li>æ–‡ä¸­åœ¨ç¬¬äºŒèŠ‚â€œCLASSIFICATION-BASED ANOMALY DETECTIONâ€çš„æœ«å°¾ä¸¤æ®µå…³äºGEOMæ–¹æ³•çš„ç¼ºç‚¹è¯´çš„å¾ˆæ¨¡ç³Šã€‚å¼‚å¸¸åˆ†æ•°çš„æ–¹å·®å¤§åˆ°åº•æŒ‡çš„æ˜¯ä»€ä¹ˆï¼›</li><li>å…³äºä½œè€…æå‡ºçš„å˜æ¢<span class="math inline">\(T(x,m)=W_mx+b_m\)</span>å¹¶æ²¡æœ‰ç”¨åˆ°å›¾åƒæ•°æ®çš„å®éªŒä¸Šï¼Œè€Œä¸”åœ¨å®éªŒä¸­<span class="math inline">\(b_m\)</span>è¿™ä¸ªå‚æ•°å®é™…ä¸Šæ˜¯è¢«å¿½ç•¥æ‰äº†çš„ï¼Œ<span class="math inline">\(b_m\)</span>çš„ä½œç”¨ç©¶ç«Ÿå¦‚ä½•ä¸å¾—è€ŒçŸ¥ã€‚è€Œä¸”GEOMä¸­çš„å‡ ä½•å˜æ¢çš„Motivationåœ¨åŸæ–‡ä¸­æ˜¯åšäº†å®éªŒå……åˆ†è®¨è®ºäº†çš„ï¼ŒGEOMçš„ä½œè€…è®¤ä¸ºè¿™äº›å‡ ä½•å˜æ¢ä¿ç•™äº†å›¾åƒçš„é«˜é˜¶è¯­ä¹‰ä¿¡æ¯ã€‚è€Œæœ¬æ–‡ä¸­çš„å˜æ¢ä¸­çš„å‚æ•°åªæ˜¯éšæœºé‡‡æ ·è€Œæ¥ï¼Œå¹¶ä¸å­˜åœ¨è¯´ä¿ç•™åŸå§‹æ•°æ®ä¸­çš„ç»“æ„ä¿¡æ¯ã€‚å¦‚æœå¿½ç•¥æ‰è¿™ä¸€å±‚å˜æ¢ï¼Œé‚£å°±ç±»ä¼¼äºåŠ äº†ç¥ç»ç½‘ç»œæå–ç‰¹å¾çš„OC-SVMã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢å‘OpenPAIçš„Dockeré•œåƒé…ç½®åŠOpenPAIåŸºæœ¬ä½¿ç”¨æ–¹æ³•</title>
    <link href="/2020/06/02/%E9%9D%A2%E5%90%91OpenPAI%E7%9A%84Docker%E9%95%9C%E5%83%8F%E9%85%8D%E7%BD%AE%E5%8F%8AOpenPAI%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <url>/2020/06/02/%E9%9D%A2%E5%90%91OpenPAI%E7%9A%84Docker%E9%95%9C%E5%83%8F%E9%85%8D%E7%BD%AE%E5%8F%8AOpenPAI%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>å®éªŒå®¤æœåŠ¡å™¨é›†ç¾¤é‡‡ç”¨OpenPAIæ¥è¿›è¡ŒGPUèµ„æºçš„ç®¡ç†ï¼Œè€ŒOpenPAIé‡‡ç”¨äº†Dockerä½œä¸ºåŸºç¡€ï¼Œå³ä»£ç éƒ½æ”¾åœ¨Dockerå®¹å™¨ä¸­è¿è¡Œã€‚ç”±äºDockerçš„ä½¿ç”¨ã€Dockeré•œåƒçš„é…ç½®éƒ½æœ‰ä¸€å®šçš„é—¨æ§›ï¼Œæ‰€ä»¥è¿™é‡Œå†™ä¸€ç¯‡Tutorialæ¥è¿›è¡Œä»‹ç»ã€‚æœ¬æ–‡ä¸æ˜¯ç½‘ä¸Šèµ„æ–™çš„æ‹¼å‡‘ï¼Œè€Œæ˜¯ç»è¿‡æœ¬äººèµ°å¼¯è·¯è¸©å‘å½¢æˆçš„"Best practice"ã€‚ä¸»è¦å†…å®¹åŒ…æ‹¬Dockerçš„ä»‹ç»ã€Dockerçš„åŸºæœ¬ä½¿ç”¨ã€å¦‚ä½•é…ç½®è‡ªå·±çš„Dockeré•œåƒä»¥åŠOpenPAIå¹³å°çš„åŸºæœ¬ä½¿ç”¨ï¼Œä½†ä¸åŒ…æ‹¬Dockerå’ŒOpenPAIçš„å®‰è£…ã€‚</p><blockquote><p>2020.8.1 Update: åŠ å…¥é€šè¿‡HDFSè¯»å–å®¹å™¨ä¿å­˜çš„æ–‡ä»¶çš„æ–¹æ³•</p></blockquote><h1 id="docker-from-scratch">Docker from Scratch</h1><p>è¦ç†è§£Dockeræ˜¯ä»€ä¹ˆï¼Œä»è™šæ‹Ÿæœºå¼€å§‹è®²å¯èƒ½ä¼šæ¯”è¾ƒå¥½ç†è§£ã€‚è™šæ‹Ÿæœºå¤§å®¶å¯èƒ½éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œæ¯”å¦‚è¯´æˆ‘ç”¨çš„ç³»ç»Ÿæ˜¯Windowsï¼Œä½†æˆ‘éœ€è¦Linuxç³»ç»Ÿæ¥ä½œä¸ºä¸€ä¸ªFlaskç¼–å†™çš„ç½‘ç«™çš„æœåŠ¡å™¨ï¼Œä½†æ˜¯åˆä¸æƒ³å•ç‹¬å®‰è£…Linuxç³»ç»Ÿï¼Œäºæ˜¯å¯ä»¥ä½¿ç”¨è™šæ‹Ÿæœºæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®‰è£…VMWare Workstationï¼Œå»å®˜ç½‘ä¸‹è½½Ubuntuç³»ç»Ÿé•œåƒï¼Œç„¶ååœ¨VMWareä¸­å®‰è£…å¥½ç³»ç»Ÿï¼Œç„¶åä»å¤´é…ç½®Flaskç›¸å…³ç¯å¢ƒã€‚å®é™…ä¸Šæˆ‘éœ€è¦çš„ä»…ä»…æ˜¯ä¸€ä¸ªFlaskè¿è¡Œç¯å¢ƒè€Œå·²ï¼Œè€Œä½¿ç”¨è™šæ‹Ÿæœºå´éœ€è¦å¦‚æ­¤â€œå¤§è´¹å‘¨ç« â€ï¼Œè¿™æ—¶Dockerå‡ºç°äº†ï¼Œç½‘ä¸Šæœ‰å¤§é‡ç°æˆçš„Flask Dockeré•œåƒï¼Œé…ç½®å¥½äº†ä½ æ‰€éœ€çš„Flaskç¯å¢ƒï¼Œä½ åªéœ€è¦ä¸‹è½½è¿™äº›é•œåƒï¼Œç„¶åè¿è¡Œå®ƒï¼Œä½ å°±å¾—åˆ°äº†ä¸€ä¸ªFlaskè¿è¡Œç¯å¢ƒï¼Œè€Œä¸ä½ å½“å‰ä½¿ç”¨çš„ç³»ç»Ÿæ— å…³ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªTomcatçš„è¿è¡Œç¯å¢ƒï¼Œé‚£ä¹ˆå»æ‰¾ä¸€ä¸ªTomcatçš„Dockeré•œåƒå°±è¡Œã€‚Dockerå°†éœ€æ±‚æˆ–è€…è¯´æœåŠ¡ç»‘å®šåœ¨äº†Dockeré•œåƒä¸­ï¼ˆ<strong>è½»é‡åŒ–</strong>ï¼Œä¸€ä¸ªéœ€æ±‚å¯¹åº”ä¸€ä¸ªDockeré•œåƒï¼Œæ¯ä¸ªé•œåƒéƒ½å¾ˆå°ï¼‰ï¼Œä½ æœ‰ä»€ä¹ˆéœ€æ±‚ï¼Œå»æ‰¾ç›¸åº”çš„é•œåƒå³å¯ï¼ˆæˆ–è€…è‡ªå·±å†™ä¸€ä¸ªï¼‰ï¼Œé•œåƒçš„è¿è¡Œæ˜¯ä»¥è™šæ‹Ÿæœºçš„å½¢å¼å­˜åœ¨ï¼Œæ‰€ä»¥ä»–ä»¬ä¹‹é—´ä¹Ÿæ˜¯äº’ä¸å¹²æ‰°çš„ã€‚åŒæ—¶ï¼Œä½ åœ¨å†™å¥½ä¸€ä¸ªDockeré•œåƒä¹‹åï¼Œä½ è¿˜å¯ä»¥<strong>åˆ†äº«</strong>ç»™åˆ«äººï¼Œè¿™æ ·å…¶ä»–äººå°±ä¸ç”¨é‡æ–°é…ç½®ï¼Œç›´æ¥è¿è¡Œä½ ç»™ä»–çš„é•œåƒå³å¯ã€‚Dockeræœ‰ä¸¤ä¸ªæ¯”è¾ƒå…³é”®çš„æ¦‚å¿µï¼š</p><ul><li><strong>é•œåƒ Imagesï¼š</strong> è¿™é‡Œçš„é•œåƒä¸æ˜¯æŒ‡æˆ‘ä»¬å®‰è£…ç³»ç»Ÿæ—¶ä¸‹è½½çš„ISOé•œåƒï¼ŒDockeré•œåƒå°±æ˜¯æŠŠä½ éœ€è¦çš„ä¸œè¥¿ï¼ˆä¸€ä¸ªç³»ç»Ÿ+éœ€è¦çš„æœåŠ¡ï¼‰é›†ä¸­åˆ°ä¸€èµ·ï¼Œç›¸å½“äºåšèœçš„èœè°±ï¼›</li><li><strong>å®¹å™¨ Containersï¼š</strong> å¦‚æœä¸€ä¸ªDockeré•œåƒå¯åŠ¨äº†ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ä¸€ä¸ªDockerå®¹å™¨äº§ç”Ÿï¼Œç›¸å½“äºæŒ‰ç…§èœè°±åšå‡ºæ¥çš„èœã€‚</li></ul><p><img src="https://i.loli.net/2020/06/24/H2x9mnPwkVQyO6p.png" srcset="/img/loading.gif" alt="img" style="zoom: 33%;" /></p><p><img src="https://i.loli.net/2020/06/24/7k6S3yecX2lbvQY.png" srcset="/img/loading.gif" alt="img" style="zoom: 33%;" /></p><p>è¿™ä¸€èŠ‚æˆ‘ä»¬å…ˆä¸è®¨è®ºå¦‚ä½•è‡ªå·±å†™Dockeré•œåƒï¼Œåªæ˜¯å…ˆè®¨è®ºDockerçš„åŸºæœ¬æ“ä½œã€‚</p><h2 id="basic-operations">Basic Operations</h2><p>Dockeræ–°å®‰è£…å¥½å½“ç„¶æ˜¯æ²¡æœ‰ä»€ä¹ˆé•œåƒçš„ï¼Œé¦–å…ˆæˆ‘ä»¬ä½¿ç”¨<code>docker pull hello-world</code>æ¥ä¸‹è½½ä¸€ä¸ªæµ‹è¯•é•œåƒã€‚</p><blockquote><p>æ‹‰å–é•œåƒ <code>docker pull &lt;image_name&gt;</code></p></blockquote><p>åœ¨è¾“å…¥ä¹‹åï¼ŒDockerä¼šè‡ªåŠ¨åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸ŠæŸ¥æ‰¾å¯¹åº”çš„é•œåƒè¿›è¡Œä¸‹è½½ã€‚ç”±äºæˆ‘çš„ç”µè„‘ä¸Šå·²ç»æœ‰è¿™ä¸ªé•œåƒäº†ï¼Œæ‰€ä»¥æ˜¾ç¤ºæ˜¯ä¸‹é¢çš„æ ·å­ï¼š</p><p><img src="https://i.loli.net/2020/06/24/rvqcAwzOYJtF6T8.png" srcset="/img/loading.gif" /></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¾“å…¥<code>docker run hello-world</code>è¿è¡Œè¿™ä¸ªé•œåƒã€‚</p><blockquote><p>è¿è¡Œé•œåƒ<code>docker run &lt;image_name&gt;</code></p></blockquote><p>å¯ä»¥çœ‹åˆ°ï¼ŒDockerè¾“å‡ºäº†ä¸€äº›ä¿¡æ¯å°±è‡ªå·±é€€å‡ºäº†ï¼Œè¿™å’Œæˆ‘ä»¬ç†è§£çš„è™šæ‹Ÿæœºä¸å¤ªä¸€æ ·ã€‚åœ¨Dockeré‡Œé¢ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿï¼Œç”¨æˆ·åœ¨è¿è¡Œä¹‹åå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨è¿™ä¸ªæ“ä½œç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„æœåŠ¡ï¼Œé»˜è®¤è¿è¡Œå®Œä¸€äº›æŒ‡ä»¤å°±é€€å‡ºäº†ã€‚è¿™é‡Œçš„<code>hello-world</code>é•œåƒè¿™æ˜¯è¾“å‡ºäº†ä¸€äº›ä¿¡æ¯åå°±è‡ªåŠ¨é€€å‡ºäº†ï¼Œå› ä¸ºè¿™å°±æ˜¯è¿™ä¸ªé•œåƒçš„å…¨éƒ¨å†…å®¹ã€‚</p><p><img src="https://i.loli.net/2020/06/24/Zb1VKjFyMh8gHf2.png" srcset="/img/loading.gif" /></p><p>æˆ‘ä»¬å°è¯•æ¥è¿è¡Œä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿï¼Œå…ˆç”¨<code>docker pull ubuntu</code>æ‹‰å–Ubuntu Dockeré•œåƒï¼š</p><p><img src="https://i.loli.net/2020/06/24/zEerb2gPwYWX8O7.png" srcset="/img/loading.gif" /></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ï¼š</p><p><img src="https://i.loli.net/2020/06/24/6cMz1WGH4fgpBsS.png" srcset="/img/loading.gif" /></p><blockquote><p><code>-it</code>çš„æ„æ€æ˜¯ä»€ä¹ˆï¼Ÿæ ¹æ®<code>docker run --help</code>ï¼š</p><pre><code class="hljs routeros">-i, --interactive                    Keep STDIN open even <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> attached    --ip string                      IPv4<span class="hljs-built_in"> address </span>(e.g., 172.30.100.104)    --ip6 string                    <span class="hljs-built_in"> IPv6 address </span>(e.g., 2001:db8::33)    --ipc string                     IPC mode <span class="hljs-keyword">to</span> use    --isolation string               Container isolation technology    --kernel-memory bytes            Kernel memory limit-t, --tty                            Allocate a pseudo-TTY    --ulimit ulimit                  Ulimit options (default [])Copy</code></pre><p>å…¶å®<code>-it</code>æ˜¯<code>-i</code>å’Œ<code>-t</code>çš„åˆå¹¶å†™æ³•ï¼Œæ„æ€æ˜¯è¿è¡Œåè¿›å…¥è¿™ä¸ªå®¹å™¨å¹¶ä¸”å¯ç”¨shellï¼Œä¸ç„¶è¿è¡Œä¹‹åå°±ä¼šæ”¾åˆ°åå°è€Œä¸ä¼šè¿›å…¥å®¹å™¨ä¸­ã€‚è€Œ<code>--rm</code>åˆ™ä»£è¡¨å®¹å™¨é€€å‡ºä¹‹åä¼šè¢«åˆ é™¤ï¼ˆé•œåƒä¸ä¼šè¢«åˆ é™¤ï¼‰ï¼Œæ¯æ¬¡è¿è¡Œå®é™…ä¸Šä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œå¦‚æœä¸åŠ <code>--rm</code>æˆ–é€€å‡ºä¹‹åä¸æ‰‹åŠ¨åˆ é™¤çš„è¯ä¼šçœ‹åˆ°ä¸€å †åœæ­¢è¿è¡Œçš„å®¹å™¨ã€‚</p></blockquote><p>è¾“å…¥<code>cat /etc/issue</code>å¯ä»¥çœ‹åˆ°é»˜è®¤æ‹‰å–çš„æ˜¯æœ€æ–°çš„Ubuntu 20.04 LTSï¼š</p><p><img src="https://i.loli.net/2020/06/24/wldBMFtx3eIk98C.png" srcset="/img/loading.gif" /></p><h1 id="build-customized-docker-images">Build Customized Docker Images</h1><p>å¦‚æœæ²¡æœ‰ç°æˆçš„Dockeré•œåƒèƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘è‡ªå·±å†™ä¸€ä¸ªã€‚è¦è‡ªå®šä¹‰ä¸€ä¸ªDockeré•œåƒéœ€è¦ä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯ç¼–å†™Dockerfileï¼Œç¬¬äºŒæ­¥æ˜¯ä½¿ç”¨<code>docker build</code>å‘½ä»¤æ„å»ºé•œåƒã€‚Dockerfileå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œæè¿°äº†æˆ‘ä»¬æ„å»ºé•œåƒæ‰€éœ€è¦çš„å…¨éƒ¨å‘½ä»¤ï¼Œæ¯”å¦‚è¦æ„å»ºä¸€ä¸ªç”¨äºPythonç§‘å­¦è®¡ç®—çš„Dockeré•œåƒï¼Œæˆ‘ä»¬éœ€è¦åœ¨Dockerfileä¸­ç¼–å†™å®‰è£…Pythonçš„å‘½ä»¤ï¼Œå®‰è£…Numpyã€Scipyç­‰å¸¸ç”¨åŒ…çš„å‘½ä»¤ç­‰ç­‰ã€‚æˆ‘ä»¬å…ˆæ¥ä¸Šæ‰‹ç¼–å†™Dockerfileï¼Œè¿™é‡Œæˆ‘å‡†å¤‡å†™ä¸€ä¸ªåŒ…å«<a href="https://hexo.io/" target="_blank" rel="noopener">hexoåšå®¢æ¡†æ¶</a>çš„é•œåƒï¼Œè¿™ä¸ªæ¡†æ¶éœ€è¦nodeä½œä¸ºåŸºç¡€ç¯å¢ƒï¼Œä¸è¿‡æˆ‘ä»¬ä¸éœ€è¦åœ¨Dockerfileé‡Œå†™å®‰è£…nodeçš„å‘½ä»¤ã€‚å› ä¸ºç±»ä¼¼äº<code>C++</code>æˆ–<code>Python</code>ä¸­çš„å¯¹è±¡çš„ç»§æ‰¿ï¼ŒDockerfileä¹Ÿå¯ä»¥â€œç»§æ‰¿â€ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸å¿…ä»å¤´å†™èµ·ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å®Œæ•´çš„Dockfileå’Œæ•ˆæœï¼Œå†æ¥ä¸€ä¸€è§£é‡Šã€‚</p><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> node--------------------------------------------------------------<span class="hljs-keyword">RUN</span><span class="bash"> npm install -g hexo-cli</span><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">4000</span><span class="hljs-keyword">CMD</span><span class="bash"> hexo init blog &amp;&amp; <span class="hljs-built_in">cd</span> blog &amp;&amp; hexo generate &amp;&amp; hexo serverCopy</span></code></pre><p>è¿è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°DockeræŒ‰ç…§æˆ‘ä»¬å†™çš„Dockerfileä¸€è¡Œä¸€è¡Œçš„è¿›è¡Œé•œåƒçš„æ„å»ºï¼š</p><p><img src="https://i.loli.net/2020/06/24/tZ3JW4SPNhxUwEn.png" srcset="/img/loading.gif" /></p><p>ç°åœ¨æ¥è§£é‡ŠDocerfileé‡Œçš„å†…å®¹ã€‚<code>FROM &lt;docker image&gt;</code>è¡¨ç¤ºç»§æ‰¿å…¶ä»–çš„é•œåƒï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨nodeå®˜æ–¹çš„é•œåƒã€‚æ¥ä¸‹æ¥æ˜¯å®‰è£…hexoï¼Œ<code>RUN &lt;command&gt;</code>è¡¨ç¤ºæ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨<code>npm install -g hexo-cli</code>è¿›è¡Œå®‰è£…ã€‚ç”±äºè¦æµè§ˆåšå®¢ç½‘é¡µéœ€è¦å¼€æ”¾ç«¯å£ï¼Œè€ŒDockerå®¹å™¨è¿è¡Œçš„æ—¶å€™å’Œå¤–éƒ¨ä¸»æœºæ˜¯å®Œå…¨éš”æ–­çš„ï¼Œè¦ä½¿å¤–éƒ¨ä¸»æœºè®¿é—®Dockerå®¹å™¨ç«¯å£ï¼Œéœ€è¦æš´éœ²ç«¯å£ã€‚<code>EXPOSE &lt;port&gt;</code>ä»£è¡¨æš´éœ²ç«¯å£ï¼Œè¿™é‡Œç”¨çš„æ˜¯4000ç«¯å£ã€‚ä¹‹åæ˜¯åˆ›å»ºåšå®¢å’Œå¯åŠ¨æœ¬åœ°æœåŠ¡ï¼Œ<code>CMD &lt;command&gt;</code>å’Œ<code>RUN &lt;command&gt;</code>çš„åŒºåˆ«æ˜¯RUNä¼šåœ¨æ„å»ºçš„æ—¶å€™æ‰§è¡Œï¼Œè€ŒCMDæ˜¯åœ¨å®¹å™¨å¯åŠ¨ä¹‹åæ‰ä¼šæ‰§è¡Œã€‚<code>hexo init blog &amp;&amp; cd blog &amp;&amp; hexo generate &amp;&amp; hexo server</code>åˆ†åˆ«ä»£è¡¨åˆå§‹åŒ–åšå®¢ã€è¿›å…¥åšå®¢æ‰€åœ¨æ–‡ä»¶å¤¹ã€ç”Ÿæˆåšå®¢ç½‘ç«™ã€å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ã€‚æ›´å¤šæŒ‡ä»¤å¯ä»¥å‚è€ƒ<a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨<code>docker build -t test_hexo .</code>å‘½ä»¤æ„å»ºé•œåƒã€‚</p><blockquote><p>æ„å»ºé•œåƒ <code>docker build -t &lt;image_name&gt; &lt;direcotry&gt;</code></p></blockquote><p>è¿è¡Œé•œåƒï¼š</p><p><img src="https://i.loli.net/2020/06/24/m4FSe15kMIDCHXy.png" srcset="/img/loading.gif" /></p><p>å¯ä»¥çœ‹åˆ°å®¹å™¨å¯åŠ¨åå¼€å§‹æ‰§è¡Œåšå®¢åˆå§‹åŒ–ã€‚</p><p><img src="https://i.loli.net/2020/06/24/BEdibvgPTMz4sn8.png" srcset="/img/loading.gif" /></p><p>æœ€ååœ¨<code>locahost:4000</code>ä¸Šå¯åŠ¨äº†ä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥è¿™ä¸ªåœ°å€ï¼Œå¯ä»¥çœ‹åˆ°åˆšåˆšæ„å»ºå¥½çš„åšå®¢ï¼š</p><p><img src="https://i.loli.net/2020/06/24/vmSUb5QH6l4afzF.png" srcset="/img/loading.gif" /></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨Dockerfileä¸­æˆ‘ä»¬æš´éœ²äº†4000ç«¯å£ï¼Œä½¿ç”¨<code>-p</code>æ ‡ç­¾å¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼š<code>docker run -p &lt;docker_port&gt;:&lt;local_port&gt; &lt;image_name&gt;</code>ã€‚æ¯”å¦‚<code>docker run -p 9999:8888 xxxx</code>ä»£è¡¨å°†Dockerå®¹å™¨ä¸­çš„9999ç«¯å£è½¬å‘åˆ°å¤–éƒ¨ä¸»æœºçš„8888ç«¯å£ã€‚å¦‚æœä½ æ˜¯åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šä½¿ç”¨çš„Dockerï¼Œé‚£ä¹ˆç«¯å£åªæ˜¯è¢«è½¬å‘åˆ°äº†è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œè¿˜å¾—æ‰‹åŠ¨å°†è¿œç¨‹æœåŠ¡å™¨å†è½¬å‘åˆ°ä½ æœ¬æœºä¸Šæ‰èƒ½ç›´æ¥åœ¨æœ¬æœºæµè§ˆå™¨ä¸Šçœ‹åˆ°é¡µé¢ã€‚</p><h2 id="build-docker-images-with-aliyun-container-registry">Build Docker Images with Aliyun Container Registry</h2><p>å› ä¸ºæŸäº›åŸå› ï¼Œå¦‚æœåœ¨æ„å»ºé•œåƒçš„æ—¶å€™éœ€è¦é€šè¿‡<code>apt-get update</code>æ›´æ–°æºï¼Œä¼šå‘ç°æ— è®ºå¦‚ä½•éƒ½ä¼šå¡ä½ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨<a href="https://cr.console.aliyun.com/" target="_blank" rel="noopener">é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡</a>ï¼Œåœ¨é˜¿é‡Œçš„æœåŠ¡å™¨ä¸Šæ„å»ºå¥½é•œåƒï¼Œå†æ‹‰å–åˆ°è‡ªå·±çš„æœºå™¨ä¸Šã€‚æ³¨å†Œå¥½å¸å·ä¹‹åï¼Œç‚¹å‡»åˆ›å»ºé•œåƒä»“åº“ï¼š</p><p><img src="https://i.loli.net/2020/06/24/u4DGHv3En1iLI5z.png" srcset="/img/loading.gif" /></p><p>è¿™é‡Œä»“åº“ç±»å‹å¦‚æœæ²¡æœ‰ç‰¹æ®Šéœ€æ±‚å»ºè®®ä½¿ç”¨å…¬å¼€ï¼Œç„¶åå¡«å†™ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼š</p><p><img src="https://i.loli.net/2020/06/24/Qipw5hAg136afnL.png" srcset="/img/loading.gif" /></p><p>ä¹‹åè®¾ç½®ä»£ç æºï¼Œå…¶å®å°±æ˜¯å‘Šè¯‰é˜¿é‡Œäº‘ä»å“ªå„¿è·å–Dockerfileï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯Githubï¼Œæ‰€ä»¥éœ€è¦å…ˆåœ¨é˜¿é‡Œäº‘ä¸­å…³è”Githubè´¦å·ï¼Œç„¶ååœ¨Githubä¸­åˆ›å»ºä¸€ä¸ªç”¨æ¥æ”¾Dockerfileçš„ä»“åº“ã€‚æ„å»ºè®¾ç½®é‡Œæœ‰ä¸€ä¸ªâ€œæµ·å¤–æœºå™¨æ„å»ºâ€ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬ä½¿ç”¨é˜¿é‡Œäº‘å®¹å™¨æœåŠ¡çš„ä¸»è¦ç›®çš„ï¼Œå‹¾é€‰ã€‚</p><p><img src="https://i.loli.net/2020/06/24/ksvZJG9lKfdh6aR.png" srcset="/img/loading.gif" /></p><p>é•œåƒä»“åº“åˆ›å»ºå¥½ä¹‹åï¼Œç‚¹è¿›å»ï¼Œåœ¨æ„å»ºé¡µé¢ç‚¹å‡»æ·»åŠ è§„åˆ™ï¼š</p><p><img src="https://i.loli.net/2020/06/24/irBm3QcqjVhGMsv.png" srcset="/img/loading.gif" /></p><p>æŒ‰ä¸‹å›¾è¿›è¡Œè®¾ç½®å³å¯ï¼Œé•œåƒç‰ˆæœ¬å°±æ˜¯ä½ æƒ³è¦çš„é•œåƒåå­—ï¼š</p><p><img src="https://i.loli.net/2020/06/24/7pAFvM8CJQbq6mU.png" srcset="/img/loading.gif" /></p><p>ç‚¹å‡»â€œç«‹å³æ„å»ºâ€ï¼š</p><p><img src="https://i.loli.net/2020/06/24/GlMwqDInL7zVOpf.png" srcset="/img/loading.gif" /></p><p>ç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œå¦‚æœæ„å»ºæˆåŠŸï¼Œä¾¿å¯ä»¥è¿›è¡Œæ‹‰å–äº†ï¼Œåœ¨é•œåƒä»“åº“çš„åŸºæœ¬ä¿¡æ¯é¡µé¢å¯ä»¥çœ‹åˆ°åœ°å€ï¼š</p><p><img src="https://i.loli.net/2020/06/24/57jmEv8PYkr2nQG.png" srcset="/img/loading.gif" /></p><p>å°†é˜¿é‡Œäº‘ä¸Šçš„é•œåƒæ‹‰å–åˆ°æœ¬æœºä¹‹åä¸€èˆ¬ä¼šæƒ³è¦å¯¹é•œåƒæ”¹åï¼Œå¯ä»¥ä½¿ç”¨<code>docker tag &lt;old_name&gt; &lt;new_name&gt;</code>ã€‚</p><h1 id="build-docker-images-for-deep-learning">Build Docker Images for Deep Learning</h1><h2 id="startup">Startup</h2><p>åœ¨Dockerä¸­é…ç½®é€‚ç”¨äºOpenPAIçš„æ·±åº¦å­¦ä¹ é•œåƒä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ï¼Œä¼šæœ‰å¾ˆå¤šçš„å‘ï¼Œè¿™é‡Œä¸“é—¨è¯´ä¸€ä¸‹å¦‚ä½•é…ç½®ã€‚æ¨èåœ¨é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ä¸­è¿›è¡Œæ„å»ºï¼Œä¼šå°‘å¾ˆå¤šéº»çƒ¦ã€‚</p><p>ç¬¬ä¸€æ­¥æ˜¯åˆå§‹é•œåƒï¼Œç”±äºéœ€è¦ç”¨åˆ°CUDAï¼Œè¿™é‡Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼ˆæ¯”å¦‚ä¸åŒCUDAç‰ˆæœ¬æ”¯æŒçš„GPUé©±åŠ¨ç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œè¿˜æœ‰Tensorflowä¸åŒç‰ˆæœ¬å¯¹CUDAå’ŒcuDNNè¦æ±‚ä¹Ÿä¸ä¸€æ ·ï¼‰ä»Nvidiaçš„Dockerhub<a href="https://hub.docker.com/r/nvidia/cuda" target="_blank" rel="noopener">å®˜æ–¹é¡µé¢</a>é€‰æ‹©åˆé€‚çš„CUDAå’ŒcuDNNç‰ˆæœ¬ï¼š</p><p><img src="https://i.loli.net/2020/06/24/pftdhmHiWkTq8Fj.png" srcset="/img/loading.gif" /></p><p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©CUDA10.1 + cuDNN7ï¼š</p><pre><code class="hljs angelscript">FROM nvidia/cuda:<span class="hljs-number">10.1</span>-cudnn7-devel-ubuntu18<span class="hljs-number">.04</span>Copy</code></pre><p>è¿™ä¸€æ¡ä¸»è¦æ˜¯è§£å†³ä¹±ç é—®é¢˜ä»¥åŠå®šä¹‰ç”¨åˆ°çš„è½¯ä»¶åŒ…çš„ç‰ˆæœ¬ï¼Œè¿™é‡ŒMinicondaç‰ˆæœ¬è®¾ç½®ä¸º4.5.4çš„åŸå› æ˜¯è¿™æ˜¯æœ€åä¸€ä¸ªè‡ªå¸¦Python3.6çš„ç‰ˆæœ¬ï¼Œæˆ‘åœ¨è¿™å„¿ä¸ºäº†ç¨³å®šæ‰€ä»¥ç”¨äº†Python3.6ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å®‰è£…æœ€æ–°ç‰ˆçš„Minicondaï¼š</p><pre><code class="hljs routeros">ENV <span class="hljs-attribute">LANG</span>=C.UTF-8 <span class="hljs-attribute">LC_ALL</span>=C.UTF-8ENV <span class="hljs-attribute">HADOOP_VERSION</span>=2.7.2LABEL <span class="hljs-attribute">HADOOP_VERSION</span>=2.7.2ENV <span class="hljs-attribute">MINICONDA_VERSION</span>=4.5.4Copy</code></pre><p>æ¥ä¸‹æ¥å®‰è£…å¿…é¡»çš„åŒ…ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®éœ€æ±‚è‡ªè¡Œè°ƒæ•´ï¼Œ<code>-y</code>æ ‡ç­¾ä»£è¡¨Yesï¼Œå³è‡ªåŠ¨åŒæ„å®‰è£…ï¼š</p><pre><code class="hljs livescript">RUN DEBIAN_FRONTEND=noninteractive &amp;&amp; <span class="hljs-string">\</span>    apt-get -y update &amp;&amp; <span class="hljs-string">\</span>    apt-get -y install build-essential <span class="hljs-string">\</span>        wget <span class="hljs-string">\</span>        git <span class="hljs-string">\</span>        curl <span class="hljs-string">\</span>        unzip <span class="hljs-string">\</span>        automake <span class="hljs-string">\</span>        openjdk-<span class="hljs-number">8</span>-jdk <span class="hljs-string">\</span>        openssh-server <span class="hljs-string">\</span>        openssh-client <span class="hljs-string">\</span>        lsof <span class="hljs-string">\</span>        libcupti-dev &amp;&amp; <span class="hljs-string">\</span>    apt-get clean &amp;&amp; <span class="hljs-string">\</span>    rm -rf <span class="hljs-regexp">/var/lib/apt/lists/</span>*Copy</code></pre><p>å®‰è£…Minicondaå¹¶è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œ<code>-b</code>æ ‡ç­¾å¯ä»¥è®©Minicondaæ— äº¤äº’è‡ªåŠ¨å®‰è£…ï¼š</p><pre><code class="hljs awk">RUN wget --quiet https:<span class="hljs-regexp">//</span>repo.anaconda.com<span class="hljs-regexp">/miniconda/</span>Miniconda3-<span class="hljs-variable">$&#123;MINICONDA_VERSION&#125;</span>-Linux-x86_64.sh &amp;&amp; <span class="hljs-regexp">/bin/</span>bash Miniconda3-<span class="hljs-variable">$&#123;MINICONDA_VERSION&#125;</span>-Linux-x86_64.sh -b -p <span class="hljs-regexp">/opt/mi</span>niconda \&amp;&amp; rm Miniconda3-<span class="hljs-variable">$&#123;MINICONDA_VERSION&#125;</span>-Linux-x86_64.shENV PATH <span class="hljs-regexp">/opt/mi</span>niconda<span class="hljs-regexp">/bin:$PATHCopy</span></code></pre><p>å®‰è£…Hadoopï¼ŒOpenPAIå¹³å°ä¼šç”¨åˆ°ï¼š</p><pre><code class="hljs awk">RUN wget -qO- http:<span class="hljs-regexp">//</span>archive.apache.org<span class="hljs-regexp">/dist/</span>hadoop<span class="hljs-regexp">/common/</span>hadoop-<span class="hljs-variable">$&#123;HADOOP_VERSION&#125;</span><span class="hljs-regexp">/hadoop-$&#123;HADOOP_VERSION&#125;.tar.gz | \</span><span class="hljs-regexp">    tar xz -C /u</span>sr<span class="hljs-regexp">/local &amp;&amp; \</span><span class="hljs-regexp">    mv /u</span>sr<span class="hljs-regexp">/local/</span>hadoop-<span class="hljs-variable">$&#123;HADOOP_VERSION&#125;</span> <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/hadoopCopy</span></code></pre><p><code>ENV</code>çš„ä½œç”¨æ˜¯é…ç½®ç¯å¢ƒå˜é‡ã€‚é…ç½®JAVAå’ŒHadoopç¯å¢ƒå˜é‡ï¼š</p><pre><code class="hljs routeros">ENV <span class="hljs-attribute">JAVA_HOME</span>=/usr/lib/jvm/java-8-openjdk-amd64 \    <span class="hljs-attribute">HADOOP_INSTALL</span>=/usr/local/hadoop \    <span class="hljs-attribute">NVIDIA_VISIBLE_DEVICES</span>=allENV <span class="hljs-attribute">HADOOP_PREFIX</span>=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span> \    <span class="hljs-attribute">HADOOP_BIN_DIR</span>=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span>/bin \    <span class="hljs-attribute">HADOOP_SBIN_DIR</span>=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span>/sbin \    <span class="hljs-attribute">HADOOP_HDFS_HOME</span>=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span> \    <span class="hljs-attribute">HADOOP_COMMON_LIB_NATIVE_DIR</span>=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span>/lib/native \    <span class="hljs-attribute">HADOOP_OPTS</span>=<span class="hljs-string">"-Djava.library.path=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span>/lib/native"</span>Copy</code></pre><p>è®¾ç½®PATHç¯å¢ƒå˜é‡ï¼š</p><pre><code class="hljs elixir">ENV PATH=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/nvidia/bin</span><span class="hljs-symbol">:/usr/local/cuda/bin</span><span class="hljs-symbol">:/usr/local/sbin</span><span class="hljs-symbol">:/usr/local/bin</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/usr/bin</span><span class="hljs-symbol">:/sbin</span><span class="hljs-symbol">:/bin</span><span class="hljs-symbol">:</span><span class="hljs-variable">$&#123;</span>HADOOP_BIN_DIR&#125;<span class="hljs-symbol">:</span><span class="hljs-variable">$&#123;</span>HADOOP_SBIN_DIR&#125; \LD_LIBRARY_PATH=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/extras</span><span class="hljs-regexp">/CUPTI/lib</span><span class="hljs-symbol">:/usr/local/cuda/extras/CUPTI/lib64</span><span class="hljs-symbol">:/usr/local/nvidia/lib</span><span class="hljs-symbol">:/usr/local/nvidia/lib64</span><span class="hljs-symbol">:/usr/local/cuda/lib64</span><span class="hljs-symbol">:/usr/local/cuda/targets/x86_64-linux/lib/stubs</span><span class="hljs-symbol">:</span><span class="hljs-variable">$&#123;</span>JAVA_HOME&#125;/jre/lib/amd64/serverCopy</code></pre><p>å®Œæ•´çš„Dockerfileå¦‚ä¸‹ï¼š</p><pre><code class="hljs crystal">FROM nvidia/<span class="hljs-symbol">cuda:</span><span class="hljs-number">10.1</span>-cudnn7-devel-ubuntu18.<span class="hljs-number">0</span>4ENV LANG=C.UTF-<span class="hljs-number">8</span> LC_ALL=C.UTF-<span class="hljs-number">8</span>ENV HADOOP_VERSION=<span class="hljs-number">2.7</span>.<span class="hljs-number">2</span>LABEL HADOOP_VERSION=<span class="hljs-number">2.7</span>.<span class="hljs-number">2</span>ENV MINICONDA_VERSION=<span class="hljs-number">4.5</span>.<span class="hljs-number">4</span>RUN DEBIAN_FRONTEND=noninteractive &amp;&amp; \    apt-get -y update &amp;&amp; \    apt-get -y install build-essential \        wget \        git \        curl \        unzip \        automake \        openjdk-<span class="hljs-number">8</span>-jdk \        openssh-server \        openssh-client \        lsof \        libcupti-dev &amp;&amp; \    apt-get clean &amp;&amp; \    rm -rf /var/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">apt</span>/<span class="hljs-title">lists</span>/*</span>RUN wget --quiet <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/repo.anaconda.com/miniconda</span><span class="hljs-regexp">/Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh &amp;&amp; /bin</span><span class="hljs-regexp">/bash Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh -b -p /opt</span><span class="hljs-regexp">/miniconda \</span><span class="hljs-regexp">&amp;&amp; rm Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh</span><span class="hljs-regexp">ENV PATH /opt</span><span class="hljs-regexp">/miniconda/bin</span>:$PATH    RUN wget -qO- <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/archive.apache.org/dist</span><span class="hljs-regexp">/hadoop/common</span><span class="hljs-regexp">/hadoop-$&#123;HADOOP_VERSION&#125;/hadoop</span>-$&#123;HADOOP_VERSION&#125;.tar.gz | \    tar xz -C /usr/local &amp;&amp; \    mv /usr/local/hadoop-$&#123;HADOOP_VERSION&#125; /usr/local/hadoop    ENV JAVA_HOME=<span class="hljs-regexp">/usr/lib</span><span class="hljs-regexp">/jvm/java</span>-<span class="hljs-number">8</span>-openjdk-amd64 \    HADOOP_INSTALL=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/hadoop \</span><span class="hljs-regexp">    NVIDIA_VISIBLE_DEVICES=all</span><span class="hljs-regexp"></span><span class="hljs-regexp">ENV HADOOP_PREFIX=$&#123;HADOOP_INSTALL&#125; \</span><span class="hljs-regexp">    HADOOP_BIN_DIR=$&#123;HADOOP_INSTALL&#125;/bin</span> \    HADOOP_SBIN_DIR=$&#123;HADOOP_INSTALL&#125;/sbin \    HADOOP_HDFS_HOME=$&#123;HADOOP_INSTALL&#125; \    HADOOP_COMMON_LIB_NATIVE_DIR=$&#123;HADOOP_INSTALL&#125;/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">native</span> \</span>    HADOOP_OPTS=<span class="hljs-string">"-Djava.library.path=$&#123;HADOOP_INSTALL&#125;/lib/native"</span>ENV PATH=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/nvidia/bin</span>:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/bin</span>:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/sbin:/usr</span><span class="hljs-regexp">/local/bin</span>:<span class="hljs-regexp">/usr/sbin</span>:<span class="hljs-regexp">/usr/bin</span>:<span class="hljs-regexp">/sbin:/bin</span>:$&#123;HADOOP_BIN_DIR&#125;:$&#123;HADOOP_SBIN_DIR&#125;:$PATH \LD_LIBRARY_PATH=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/extras</span><span class="hljs-regexp">/CUPTI/lib</span>:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/extras</span><span class="hljs-regexp">/CUPTI/lib</span>64:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/nvidia/lib</span>:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/nvidia/lib</span>64:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/lib</span>64:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/targets</span><span class="hljs-regexp">/x86_64-linux/lib</span><span class="hljs-regexp">/stubs:$&#123;JAVA_HOME&#125;/jre</span><span class="hljs-regexp">/lib/amd</span>64/serverCopy</code></pre><p>å»ºè®®å…ˆæŠŠè¿™ä¸€éƒ¨åˆ†è¿›è¡Œæ„å»ºï¼Œä½œä¸ºåŸºç¡€é•œåƒï¼Œåé¢è¦é…ç½®å…¶ä»–ç¯å¢ƒï¼ˆå¦‚å®‰è£…Pytorchæ¡†æ¶ç™»ï¼‰ï¼Œå°±ä¸ç”¨é‡å¤æ„å»ºè¿™éƒ¨åˆ†ï¼Œè¿˜å‡å°‘äº†å‡ºé”™çš„å¯èƒ½æ€§ã€‚è¿™é‡Œè¯´ä¸€ä¸‹ï¼Œå¯åŠ¨å¸¦CUDAçš„Dockeré•œåƒéœ€è¦åœ¨<code>docker run</code>åŠ ä¸Šé¢å¤–çš„å‚æ•°<code>--runtime nvidia</code>ã€‚</p><p>æ¥ä¸‹æ¥å®‰è£…æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚</p><h2 id="configure-pytorch">Configure PyTorch</h2><p>å‡è®¾ä¸Šé¢çš„é•œåƒæˆ‘ä»¬å‘½åä¸ºxiaoqinfeng/baseï¼Œé‚£ä¹ˆæ„å»ºPyTorchçš„Dockerfileå¯ä»¥åƒä¸‹é¢è¿™ä¹ˆå†™ï¼š</p><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> xiaoqinfeng/base<span class="hljs-keyword">RUN</span><span class="bash"> pip install -U pip</span><span class="hljs-keyword">RUN</span><span class="bash"> pip install numpy scipy pandas matplotlib tqdm</span><span class="hljs-keyword">RUN</span><span class="bash"> pip install torch==1.5.0+cu101 torchvision==0.6.0+cu101 -f https://download.pytorch.org/whl/torch_stable.htmlCopy</span></code></pre><p>å› ä¸ºè¿™é‡Œæˆ‘ç”¨çš„CUDA10.1ï¼Œå…¶ä»–ç‰ˆæœ¬çš„CUDAå®‰è£…æŒ‡ä»¤å¯èƒ½ä¸å¤ªä¸€æ ·ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener">å®˜ç½‘</a>ã€‚</p><h2 id="configure-tensorflow">Configure Tensorflow</h2><p>å¦‚æœæ˜¯å®‰è£…Tensorflowï¼Œé‚£ä¹ˆæ„å»ºTensorflowçš„Dockerfileå¯ä»¥åƒä¸‹é¢è¿™ä¹ˆå†™ï¼š</p><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> xiaoqinfeng/base<span class="hljs-keyword">RUN</span><span class="bash"> pip install -U pip</span><span class="hljs-keyword">RUN</span><span class="bash"> pip install numpy scipy pandas matplotlib tqdm tensorflow-gpuCopy</span></code></pre><p>è¿™é‡Œä¼šè‡ªåŠ¨å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Tensorflow2ã€‚Tensorflowä¸åŒç‰ˆæœ¬å¯¹CUDAå’ŒcuDNNç‰ˆæœ¬ç”šè‡³Pythonç‰ˆæœ¬çš„æ”¯æŒéƒ½ä¸å¤ªä¸€æ ·ï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.tensorflow.org/install/source#linux" target="_blank" rel="noopener">å®˜ç½‘</a>çš„è¯´æ˜ã€‚</p><h1 id="deep-learning-with-openpai">Deep Learning with OpenPAI</h1><h2 id="what-is-openpai">What is OpenPAI</h2><p>OpenPAIæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ·±åº¦å­¦ä¹ è®¡ç®—èµ„æºç®¡ç†å¹³å°ï¼Œå¯¹äºæˆ‘ä»¬ç”¨æˆ·æ¥è¯´ï¼Œåªéœ€è¦å®šä¹‰å¥½Dockeré•œåƒï¼Œç„¶åç¼–å†™å¥½ä»»åŠ¡è®¾ç½®ï¼Œæäº¤åˆ°å¹³å°ä¹‹åï¼Œå¹³å°ä¾¿ä¼šè‡ªåŠ¨åˆ†é…è®¡ç®—èµ„æºæ¥è¿è¡Œä»»åŠ¡ã€‚</p><p>OpenPAIç•Œé¢ï¼š</p><p><img src="https://i.loli.net/2020/06/24/CDrZjgYR7lNcieh.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><p><img src="https://i.loli.net/2020/06/24/FGJpVCbls7YP4aM.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><p>ä¸‹é¢æˆ‘ä»¬æ¥è®²è®²æ€ä¹ˆå‘OpenPAIå¹³å°æäº¤ä»»åŠ¡ã€‚</p><h2 id="submit-jobs-to-openpai">Submit Jobs to OpenPAI</h2><h3 id="pack-code-data-files">Pack Code &amp; Data Files</h3><p>å‡è®¾ä½ å·²ç»å®Œæˆäº†ä»£ç çš„ç¼–å†™å’Œæµ‹è¯•ï¼Œä½ çš„ç›®å½•ç»“æ„å¯èƒ½çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼š</p><pre><code class="hljs css">.â”œâ”€â”€ <span class="hljs-selector-tag">README</span><span class="hljs-selector-class">.md</span>â”œâ”€â”€ <span class="hljs-selector-tag">data</span>â”‚   â””â”€â”€ <span class="hljs-selector-tag">dataset</span><span class="hljs-selector-class">.csv</span>â”œâ”€â”€ <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.py</span>â””â”€â”€ <span class="hljs-selector-tag">src</span>    â”œâ”€â”€ <span class="hljs-selector-tag">data</span><span class="hljs-selector-class">.py</span>    â””â”€â”€ <span class="hljs-selector-tag">net</span><span class="hljs-selector-class">.pyCopy</span></code></pre><p>å› ä¸ºOpenPAIä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿå®¹å™¨æ¥è¿è¡Œä½ çš„ä»£ç ï¼Œæ‰€ä»¥ä½ çš„æ•°æ®å’Œä»£ç å¿…é¡»è¦ä»¥æŸç§æ–¹å¼ä¼ é€åˆ°OpenPAIä¸Šçš„è™šæ‹Ÿå®¹å™¨ä¸­ã€‚æˆ‘ä»¬å…ˆæ¥æ‰“åŒ…ï¼Œåœ¨ä»£ç ç›®å½•ä¸‹æ‰§è¡Œ<code>tar -cvf files.tar ./</code>ã€‚ä¹‹åï¼Œè¿è¡Œ<code>python -m http.server &lt;port&gt;</code>ã€‚æ‰“å¼€æµè§ˆå™¨è¾“å…¥<code>&lt;server_ip&gt;:&lt;port&gt;</code>åº”è¯¥å°±èƒ½çœ‹åˆ°ä½ çš„æ–‡ä»¶äº†ï¼š</p><p><img src="https://i.loli.net/2020/06/24/Cbgiw3XKnGYsNHp.png" srcset="/img/loading.gif" /></p><p>ç”±äºè¿™ä¸ªhttpè¿›ç¨‹éœ€è¦ä¸€ç›´è¿è¡Œï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨<code>screen</code>æ”¾åˆ°åå°æ‰§è¡Œã€‚</p><h3 id="configure-tasks">Configure Tasks</h3><p>åƒOpenPAIæäº¤ä»»åŠ¡å¯ä»¥é‡‡ç”¨ç½‘é¡µæäº¤ä¹Ÿå¯ä»¥ä½¿ç”¨VSCodeæ’ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç½‘é¡µæäº¤ã€‚ç™»å…¥OpenPAIç•Œé¢ï¼Œç‚¹å‡»Submit Jobï¼š</p><p><img src="https://i.loli.net/2020/06/24/bhXAcJfOmo8RtT2.png" srcset="/img/loading.gif" /></p><p>å¯ä»¥çœ‹åˆ°æäº¤ä»»åŠ¡çš„ç•Œé¢ï¼š</p><p><img src="https://i.loli.net/2020/06/24/KME8GuN49gyY1ph.png" srcset="/img/loading.gif" /></p><p>Job nameå¤§å®¶å¯ä»¥è‡ªå·±è®¾ç½®ã€‚åœ¨Commandä¸€æ ï¼Œæ˜¯æ‰§è¡Œä»»åŠ¡æ‰€éœ€çš„å…¨éƒ¨å‘½ä»¤ï¼Œé¦–å…ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯å°†ä»£ç æ•°æ®å‹ç¼©åŒ…ä¸‹è½½åˆ°å®¹å™¨ä¸­å¹¶è§£å‹ï¼š</p><pre><code class="hljs elixir">wget &lt;server_ip&gt;<span class="hljs-symbol">:&lt;port&gt;/files</span>.tartar -xvf files.tarCopy</code></pre><p>ç„¶åæ˜¯è¿è¡Œä»£ç ï¼Œå‡è®¾æˆ‘è¿™é‡Œçš„ä»»åŠ¡æ¯”è¾ƒç®€å•ï¼Œåªæœ‰ä¸€è¡Œmain.pyçš„è°ƒç”¨ï¼š</p><pre><code class="hljs css"><span class="hljs-selector-tag">python</span> <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.pyCopy</span></code></pre><p>å¦‚æœä»»åŠ¡çš„æ‰§è¡Œæ¯”è¾ƒå¤æ‚ï¼Œä¹Ÿåªéœ€æŠŠå‘½ä»¤å¡«åˆ°Commandé‡Œå³å¯ï¼ŒOpenPAIä¼šè‡ªåŠ¨æ‰§è¡Œã€‚æ¥ä¸‹æ¥æ˜¯è®¾ç½®é…ç½®ï¼Œå¯ä»¥é€‰GPUçš„æ•°é‡ï¼Œå†…å­˜å¤§å°ç­‰ç­‰ï¼š</p><p><img src="https://i.loli.net/2020/06/24/T7ryOxjpJP4FWYR.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ç„¶åæ˜¯é•œåƒçš„é€‰æ‹©ï¼š</p><p><img src="https://i.loli.net/2020/06/24/3n7SpNlsLjBRvgE.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>è¦æ³¨æ„åœ¨æœ¬æœºä¸Šæ„å»ºå¥½é•œåƒä¹‹åï¼Œéœ€è¦æŠŠé•œåƒé‡å‘½åä¸º<code>&lt;repository_address&gt;/&lt;image_name&gt;</code>çš„æ ¼å¼ï¼ˆæˆ‘ä»¬çš„<code>&lt;repository&gt;</code>æ˜¯<code>lin-ai-27:5000</code>ï¼Œå‡è®¾æˆ‘çš„é•œåƒåæ˜¯<code>xiaoqinfeng/pytorch</code>ï¼Œé‚£å°±æ˜¯æ”¹æˆ<code>lin-ai-27:5000/xiaoqinfeng/pytorch</code>ï¼‰ï¼Œç„¶åæ‰§è¡Œ<code>docker push</code>æ¨é€åˆ°Dockeré•œåƒæœåŠ¡å™¨ä¸Šæ‰èƒ½åœ¨OpenPAIä¸Šä½¿ç”¨ã€‚</p><p>æäº¤ä¹‹åï¼Œå¯ä»¥åœ¨Jobsç•Œé¢çœ‹åˆ°ä»»åŠ¡çš„è¿è¡Œæƒ…å†µï¼š</p><p><img src="https://i.loli.net/2020/06/24/ZD4cUgOCIqnyHdB.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><h1 id="misc">Misc</h1><h2 id="store-files-in-containers">Store Files in Containers</h2><p>æˆ‘ä»¬å¾€å¾€éœ€è¦åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ä¿å­˜æ–‡ä»¶ï¼Œå¦‚checkpointsç­‰ã€‚åœ¨OpenPAIä¸Šæ‰§è¡Œç¨‹åºçš„è¯æ–‡ä»¶æ˜¯ä¿å­˜åœ¨ç¨‹åºä¸­çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨è¿è¡Œå®Œä¹‹åæŠŠæ–‡ä»¶å¤åˆ¶åˆ°æœ¬åœ°ç”µè„‘ä¸Šå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±éœ€è¦åœ¨ä»»åŠ¡çš„é…ç½®æ–‡ä»¶é‡ŒåŠ ä¸Šå¤åˆ¶æ–‡ä»¶åˆ°HDFSçš„è¯­å¥ã€‚é¦–å…ˆç¡®è®¤ä½ çš„HDFSçš„URLï¼šå¦‚<code>hdfs://172.31.246.52:9000/ä½ çš„OpenPAIç”¨æˆ·å/</code>ã€‚</p><p>å¦‚æœè¦åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨<code>hdfs dfs -mkdir -p &lt;HDFS URL&gt;+&lt;New Folder&gt;</code>ã€‚è¿™é‡Œ<code>&lt;New Folder&gt;</code>æ˜¯ä½ è¦åˆ›å»ºçš„çš„æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œç”¨èµ·æ¥å’ŒLinuxçš„<code>mkdir</code>å‘½ä»¤å…¶å®æ˜¯å·®ä¸å¤šçš„ã€‚</p><p>è¦å¤åˆ¶æ–‡ä»¶ï¼ˆå¤¹ï¼‰åˆ™ä½¿ç”¨<code>hdfs dfs -cp &lt;Source Dir&gt; &lt;Dest Dir&gt;</code>ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Technical Notes</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Pytorch</tag>
      
      <tag>Tensorflow</tag>
      
      <tag>Docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ubuntu20.04LTS æ·±åº¦å­¦ä¹ ç¯å¢ƒé…ç½® CUDA10.2 + cuDNN7.6.5 + Tensorflow + Pytorch</title>
    <link href="/2020/06/02/Ubuntu20-4LTS-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-CUDA10-2-cuDNN7-6-5-Tensorflow-Pytorch/"/>
    <url>/2020/06/02/Ubuntu20-4LTS-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-CUDA10-2-cuDNN7-6-5-Tensorflow-Pytorch/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>Ubuntuçš„æœ€æ–°LTSç‰ˆæœ¬ä¹Ÿæ›´æ–°åˆ°äº†20.04ï¼Œåœ¨ç»™æ–°æœºå™¨é…ç½®æ·±åº¦å­¦ä¹ ç¯å¢ƒçš„æ—¶å€™å‘ç°æ¯”ä»¥å‰å®¹æ˜“äº†è®¸å¤šï¼Œç‰¹æ­¤å†™ä¸€ç¯‡Tutorialã€‚è¿™é‡Œçš„å®‰è£…æ–¹æ³•åªé’ˆå¯¹Ubuntu20.04LTSï¼Œå¯¹äºå…¶ä»–ç‰ˆæœ¬çš„ç³»ç»Ÿå¯èƒ½ä¸å¤ªé€‚ç”¨ã€‚</p><h1 id="install-gpu-drivers">Install GPU Drivers</h1><p>è¿™é‡Œå‡è®¾å®‰è£…ç³»ç»Ÿä¹‹åå·²ç»åšå¥½äº†å¿…è¦çš„é…ç½®ï¼ˆå®‰è£…å¸¸ç”¨è½¯ä»¶ä¾èµ–ã€ä¿®æ”¹å›½å†…æºç­‰ï¼‰ã€‚Ubuntu20.04ä¸­GPUé©±åŠ¨å¯ä»¥ç›´æ¥é€šè¿‡GUIç•Œé¢å®‰è£…ï¼Œååˆ†æ–¹ä¾¿ï¼Œæ–¹æ³•æ˜¯æ‰¾åˆ°è½¯ä»¶ä¸æ›´æ–° (Software &amp; Updates)ï¼Œåœ¨é™„åŠ é©±åŠ¨ (additional drivers) é€‰é¡¹å¡ä¸­é€‰æ‹©é©±åŠ¨ç‰ˆæœ¬ï¼Œä¸€èˆ¬æ˜¯é€‰æ‹©â€œä¸“æœ‰ï¼Œtestedâ€ (proprietary, tested) é‚£ä¸ªï¼Œä¹‹åç‚¹Apply Changesï¼Œé‡å¯ã€‚</p><p><img src="https://i.loli.net/2020/06/24/xevtVosYOH7D68I.png" srcset="/img/loading.gif" /></p><h1 id="install-cuda-cudnn">Install CUDA &amp; cuDNN</h1><p>è¿™é‡Œé€‰æ‹©apt-getçš„æ–¹å¼å®‰è£…CUDAï¼š</p><pre><code class="hljs bash">sudo apt-get install nvidia-cuda-toolkit</code></pre><p>è¾“å…¥<code>nvcc --version</code>å¯ä»¥æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸï¼Œè¾“å…¥<code>nvidia-smi</code>å¯ä»¥çœ‹åˆ°GPUä¿¡æ¯å’ŒCUDAç‰ˆæœ¬ã€‚</p><p>ä¹‹åå®‰è£…cuDNNï¼Œè¿›å…¥<a href="https://developer.nvidia.com/cudnn" target="_blank" rel="noopener">å®˜ç½‘</a>ï¼Œé€‰æ‹©Download cuDNNï¼š</p><p><img src="https://i.loli.net/2020/06/24/VYBRoINFDC9ObA1.png" srcset="/img/loading.gif" /></p><p>ä¼šè¦æ±‚ç™»å½•ï¼Œå¦‚æœæ²¡æœ‰è´¦å·çš„æ³¨å†Œä¸€ä¸ªå³å¯ã€‚åœ¨è¿™é‡Œæ ¹æ®CUDAç‰ˆæœ¬é€‰æ‹©é€‚åˆçš„cuDNNï¼Œæˆ‘è¿™é‡Œæ˜¯CUDA10.2ã€‚æˆ‘ä»¬é€‰æ‹©debåŒ…çš„æ–¹å¼å®‰è£…ï¼Œä¸‹è½½ä¸‹å›¾ä¸­åœˆå‡ºæ¥çš„ä¸‰ä¸ªdebåŒ…ï¼Œä¾æ¬¡ç”¨<code>sudo dpkg -i xxx.deb</code>å‘½ä»¤å®‰è£…ã€‚</p><p><img src="https://i.loli.net/2020/06/24/qcDG5t3JY6vfoQM.png" srcset="/img/loading.gif" /></p><h1 id="configure-python">Configure Python</h1><p>ä¸ºäº†æ›´å¥½åœ°ç®¡ç†PythonåŒ…å’Œè™šæ‹Ÿç¯å¢ƒï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…Anacondaã€‚ä½¿ç”¨Anacondaä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œè™šæ‹Ÿç¯å¢ƒä¹‹é—´äº’ä¸å¹²æ‰°ã€‚åšç§‘å­¦å®éªŒæˆ‘ä»¬ä¸€èˆ¬éœ€è¦å®‰è£…å¤§é‡çš„PythonåŒ…ï¼Œæœ‰çš„åŒ…ä¹‹é—´ç”šè‡³è¿˜æœ‰å†²çªï¼Œå¦‚æœæˆ‘ä»¬æŠŠä»–ä»¬éƒ½å®‰è£…åœ¨åŒä¸€ä¸ªç¯å¢ƒä¸‹å°±ä¼šéš¾ä»¥ç®¡ç†ï¼Œç”šè‡³å‡ºå†²çªã€‚è€Œæœ‰äº†è™šæ‹Ÿç¯å¢ƒä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸åŒéœ€æ±‚æ”¾åœ¨ä¸åŒè™šæ‹Ÿç¯å¢ƒä¸­ï¼Œæ¯”å¦‚æ·±åº¦å­¦ä¹ å¼€å‘æ”¾åœ¨ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒä¸­ï¼ˆå®‰è£…Tensorflowç­‰ï¼‰ï¼Œç½‘ç«™å¼€å‘æ”¾åœ¨ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒä¸­ï¼ˆå®‰è£…Flaskç­‰ï¼‰ã€‚Anacondaé»˜è®¤è‡ªå¸¦å¤§é‡çš„åŒ…ï¼Œä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬ä¼šåˆ›å»ºæ–°çš„è™šæ‹Ÿç¯å¢ƒå»å®‰è£…æ–°çš„åŒ…ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬é€‰ç”¨Minicondaã€‚Minicondaå’ŒAnacondaå”¯ä¸€çš„åŒºåˆ«æ˜¯ä¸ä¼šè‡ªå¸¦å¤§é‡PythonåŒ…ï¼Œè¿™é‡Œå¤§å®¶è‡ªè¡Œé€‰æ‹©ã€‚Anacondaå›½å†…é•œåƒä¸‹è½½åœ°å€ä¸ºï¼šhttps://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/ï¼ŒMinicondaå›½å†…é•œåƒä¸‹è½½åœ°å€ä¸ºï¼šhttps://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/ã€‚</p><p>æ¯”å¦‚è¯´æˆ‘ä»¬ä¸‹è½½çš„æ˜¯<code>Miniconda3-py38_4.8.2-Linux-x86_64.sh</code>ï¼Œæ‰§è¡Œ<code>bash Miniconda3-py38_4.8.2-Linux-x86_64.sh</code>å³å¯å®‰è£…ã€‚æ˜¾ç¤ºä¸€å¤§å±ç”¨æˆ·åè®®å“ªå„¿æŒ‰<code>q</code>å¯ä»¥ç›´æ¥è·³è¿‡ï¼Œå…¶ä»–é€‰é¡¹çš„é»˜è®¤çš„è¾“å…¥<code>yes</code>å³å¯ã€‚åœ¨æç¤ºæ˜¯å¦éœ€è¦conda initçš„æ—¶å€™è®°å¾—è¾“å…¥<code>yes</code>ã€‚</p><p>å®‰è£…æˆåŠŸä¹‹åï¼Œé‡å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œå¯ä»¥çœ‹åˆ°ç°åœ¨å¤„äº<code>base</code>ç¯å¢ƒä¸­ï¼š</p><p><img src="https://i.loli.net/2020/06/24/giml1UKzWuyqTjr.png" srcset="/img/loading.gif" /></p><p>æˆ‘ä»¬å…ˆé…ç½®ä¸€ä¸‹å›½å†…é•œåƒï¼Œæ‰§è¡Œ</p><pre><code class="hljs bash">vim ~/.condarc</code></pre><p>ç„¶åç²˜è´´ä¸‹åˆ—æ–‡æœ¬ä½¿ç”¨æ¸…åæºï¼š</p><pre><code class="hljs less"><span class="hljs-attribute">channels</span>:  - defaults<span class="hljs-attribute">show_channel_urls</span>: true<span class="hljs-attribute">channel_alias</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda</span><span class="hljs-attribute">default_channels</span>:  - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main</span>  - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free</span>  - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r</span>  - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/pro</span>  - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2</span><span class="hljs-attribute">custom_channels</span>:  <span class="hljs-attribute">conda-forge</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span>  <span class="hljs-attribute">msys2</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span>  <span class="hljs-attribute">bioconda</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span>  <span class="hljs-attribute">menpo</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span>  <span class="hljs-attribute">pytorch</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span>  <span class="hljs-attribute">simpleitk</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span></code></pre><p>ä¹‹åæˆ‘ä»¬è¾“å…¥<code>conda create -n &lt;your_name&gt;</code>åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒï¼Œå¦‚æœéœ€è¦æŒ‡å®šPythonç‰ˆæœ¬ï¼Œåˆ™<code>conda create --n &lt;your_name&gt; python=&lt;python_version&gt;</code>ã€‚ä¹‹åè¾“å…¥<code>conda activate &lt;your_name&gt;</code>è¿›å…¥è™šæ‹Ÿç¯å¢ƒï¼Œå¦‚æœéœ€è¦é€€å‡ºï¼Œåˆ™ä½¿ç”¨<code>conda deactivate</code>ã€‚</p><p>å®‰è£…å¸¸ç”¨åŒ…ï¼š</p><pre><code class="hljs bash">conda install --yes numpy scipy pandas matplotlib tqdm pip jupyter</code></pre><p><code>--yes</code>çš„ä½œç”¨æ˜¯æ‰‹åŠ¨è¾“å…¥<code>y</code>æ¥ç¡®è®¤æ˜¯å¦å®‰è£…ï¼Œè¿™é‡Œåˆ—å‡ºçš„æ˜¯ä¸€äº›æœ€å¸¸ç”¨çš„PythonåŒ…ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è‡ªè¡Œè°ƒæ•´ã€‚<code>conda install</code>ä¸ºAnacondaä¸­å®‰è£…PythonåŒ…çš„æ–¹å¼ã€‚</p><h1 id="install-pytorch">Install PyTorch</h1><p>è¿™é‡Œæ¥å®‰è£…PyTorchç¯å¢ƒï¼Œæ¨èä½¿ç”¨<code>conda create -n pytorch</code>åˆ›å»ºä¸€ä¸ªä¸“æœ‰è™šæ‹Ÿç¯å¢ƒï¼Œç„¶åä½¿ç”¨<code>conda install</code>å®‰è£…å¸¸ç”¨åŒ…ã€‚å¯¹äºå®‰è£…PyTorchï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>conda</code>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>pip</code>å®‰è£…ã€‚<code>pip</code>æ˜¯å¦å¤–ä¸€ä¸ªå®‰è£…PythonåŒ…çš„å·¥å…·ï¼Œç”±äºä¸æ£€æŸ¥ä¾èµ–æ‰€ä»¥æ¯”<code>conda</code>å®‰è£…é€Ÿåº¦å¿«ï¼Œè€Œä¸”åŒ…çš„æ•°é‡æ¯”<code>conda</code>å¤šï¼Œä½¿ç”¨ä¹Ÿæ›´å¹¿æ³›ã€‚åŒæ ·<code>pip</code>ä¹Ÿå¯ä»¥ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿä¸‹è½½ï¼Œè¯¦è§https://mirrors.tuna.tsinghua.edu.cn/help/pypi/ã€‚</p><p>å¯¹äºCUDA10.2ï¼Œå®˜æ–¹ç»™å‡ºçš„ç”¨<code>conda</code>å®‰è£…PyTorchçš„å‘½ä»¤æ˜¯ï¼š</p><pre><code class="hljs bash">conda install pytorch torchvision cudatoolkit=10.2 -c pytorch</code></pre><p>ç”¨<code>pip</code>å®‰è£…PyTorchçš„å‘½ä»¤æ˜¯ï¼š</p><pre><code class="hljs bash">pip install torch torchvision</code></pre><p>å¯¹äºå…¶ä»–ç‰ˆæœ¬çš„CUDAå®‰è£…å‘½ä»¤å¯èƒ½ä¸ä¸€æ ·ï¼Œå¯ä»¥å»<a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener">å®˜ç½‘</a>æŸ¥çœ‹ã€‚</p><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•GPUç‰ˆæœ¬çš„PyTorchæ˜¯å¦æ­£å¸¸å·¥ä½œï¼š</p><pre><code class="hljs bash">python -c <span class="hljs-string">"import torch; print(torch.cuda.is_available())"</span></code></pre><h1 id="install-tensorflow">Install Tensorflow</h1><p>å®‰è£…Tensorflowç¯å¢ƒåŒæ ·æ¨èåˆ›å»ºä¸€ä¸ªä¸“æœ‰è™šæ‹Ÿç¯å¢ƒã€‚å¯¹äºTensorflow2çš„å®‰è£…ï¼Œä½¿ç”¨<code>pip</code>ååˆ†æ–¹ä¾¿ï¼Œä½¿ç”¨</p><pre><code class="hljs bash">pip install tensorflow tensorflow-gpu</code></pre><p>å³å¯ã€‚è¦å®‰è£…å…¶ä»–ç‰ˆæœ¬çš„Tensorflowå¯ä»¥ä½¿ç”¨<code>pip install tensorflow==&lt;tf_version&gt; tensorflow-gpu==&lt;tf_version&gt;</code>æ¥æŒ‡å®šç‰ˆæœ¬ã€‚ä¸è¿‡ä¸åŒç‰ˆæœ¬çš„Tensorflowè¦æ±‚çš„CUDAç‰ˆæœ¬éƒ½æœ‰æ‰€ä¸åŒï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.tensorflow.org/install/source#linux" target="_blank" rel="noopener">å®˜ç½‘</a>çš„è¯´æ˜ã€‚</p><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•GPUç‰ˆæœ¬çš„Tensorflowæ˜¯å¦æ­£å¸¸å·¥ä½œï¼š</p><pre><code class="hljs bash">python -c <span class="hljs-string">"import tensorflow as tf; tf.config.list_physical_devices('GPU')"</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>Technical Notes</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Pytorch</tag>
      
      <tag>Tensorflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Deep Anomaly Detection Using Geometric Transformations</title>
    <link href="/2020/06/01/Deep-Anomaly-Detection-Using-Geometric-Transformations/"/>
    <url>/2020/06/01/Deep-Anomaly-Detection-Using-Geometric-Transformations/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡è€ƒè™‘å›¾åƒæ•°æ®çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜ã€‚ä¸åŸºäºé‡æ„çš„æ–¹æ³•ä¸åŒï¼Œæœ¬æ–‡æå‡ºçš„æ–¹æ³•é€šè¿‡å¯¹æ­£å¸¸å›¾ç‰‡æ–½åŠ ä¸åŒçš„å‡ ä½•å˜æ¢ä¹‹åï¼Œè®­ç»ƒä¸€ä¸ªå¤šåˆ†ç±»å™¨å°†æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹é—®é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªæœ‰ç›‘ç£é—®é¢˜ã€‚æœ¬æ–¹æ³•èƒŒåçš„ç›´è§‰æ˜¯åœ¨è®­ç»ƒèƒ½å¤Ÿåˆ†è¾¨ä¸åŒå˜æ¢åçš„å›¾ç‰‡ä¹‹åï¼Œåˆ†ç±»å™¨ä¸€å®šå­¦å¾—äº†ä¸€äº›æ˜¾è‘—çš„å‡ ä½•ç‰¹å¾ï¼Œè¿™äº›å‡ ä½•ç‰¹å¾æ˜¯æ­£å¸¸ç±»åˆ«ç‹¬æœ‰çš„ã€‚</p><h1 id="proposed-method">Proposed Method</h1><h2 id="problem-statement">Problem Statement</h2><p>æœ¬æ–‡è€ƒè™‘é’ˆå¯¹å›¾åƒçš„å¼‚å¸¸æ£€æµ‹ã€‚è®°<span class="math inline">\(\mathcal X\)</span>ä¸ºæ‰€æœ‰è‡ªç„¶å›¾åƒçš„ç©ºé—´ï¼Œ<span class="math inline">\(X\subseteq\mathcal X\)</span>ä¸ºæ­£å¸¸å›¾åƒé›†åˆã€‚ç»™å®šæ•°æ®é›†<span class="math inline">\(S\subseteq X\)</span>ï¼Œå¼‚å¸¸æ£€æµ‹çš„ç›®çš„æ˜¯å­¦ä¹ ä¸€ä¸ªåˆ†ç±»å™¨<span class="math inline">\(h_S(x):\mathcal X\rightarrow\{0,1\}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(h_S(x)=1\Leftrightarrow x\in X\)</span>ã€‚</p><p>ä¸ºäº†å…¼é¡¾æŸ¥å‡†ç‡å’ŒæŸ¥å…¨ç‡ï¼Œå¸¸ç”¨çš„è®¾ç½®æ˜¯å­¦ä¹ ä¸€ä¸ªæ‰“åˆ†å‡½æ•°<span class="math inline">\(n_S(x):\mathcal X\rightarrow\mathbb R\)</span>ï¼Œåˆ†æ•°è¶Šé«˜ä»£è¡¨æ ·æœ¬å±äº<span class="math inline">\(X\)</span>çš„æ¦‚ç‡è¶Šå¤§ã€‚ä¹‹åï¼Œé€šè¿‡è®¾å®šé˜ˆå€¼ï¼Œä¾¿å¯ä»¥æ„å»ºå¼‚å¸¸åˆ†ç±»å™¨ï¼š <span class="math display">\[\begin{align}h_S^\lambda(x)=\begin{cases}1 &amp; n_S(x)\leq\lambda\\0 &amp; n_S(x)&lt;\lambda\end{cases}\end{align}\]</span></p><h2 id="discriminative-learning-of-an-anomaly-scoring-function-using-geometric-transformations">Discriminative Learning of an Anomaly Scoring Function Using Geometric Transformations</h2><p>æœ‰åˆå§‹æ•°æ®é›†<span class="math inline">\(S\)</span>ï¼Œå‡ ä½•å˜æ¢é›†åˆ<span class="math inline">\(\mathcal T\)</span>ï¼Œé€šè¿‡å¯¹<span class="math inline">\(S\)</span>ä¸­æ¯ä¸ªæ ·æœ¬æ–½åŠ è¿™<span class="math inline">\(|\mathcal T|\)</span>ä¸ªå‡ ä½•å˜æ¢å¾—åˆ°æ–°æ•°æ®é›†è®°ä¸º<span class="math inline">\(S_\mathcal{T}\)</span>ï¼Œä¸”<span class="math inline">\(S_\mathcal{T}\)</span>ä¸­æ¯ä¸ªæ ·æœ¬çš„æ ‡ç­¾ä¸ºå˜æ¢çš„åºå·ã€‚ä¹‹åï¼Œåœ¨<span class="math inline">\(S_\mathcal{T}\)</span>ä¸Šè®­ç»ƒä¸€ä¸ª<span class="math inline">\(|\mathcal T|\)</span>åˆ†ç±»å™¨ã€‚åœ¨æµ‹è¯•é˜¶æ®µï¼Œå¯¹æµ‹è¯•æ ·æœ¬åŒæ ·æ–½åŠ <span class="math inline">\(|\mathcal T|\)</span>ä¸ªå‡ ä½•å˜æ¢ï¼Œåˆ†ç±»å™¨ä¼šç»™å‡ºç»è¿‡<span class="math inline">\(\mathrm{softmax}\)</span>çš„è¾“å‡ºå‘é‡ï¼Œæœ€ç»ˆçš„å¼‚å¸¸åˆ†æ•°ç”±ç»è¿‡è¾“å‡ºçš„å‘é‡æ„é€ çš„åˆ†å¸ƒå¯¹æ•°ä¼¼ç„¶å¾—æ¥ã€‚</p><h3 id="creating-and-learning-the-self-labeled-dataset">Creating and Learning the Self-Labeled Dataset</h3><p>è®¾<span class="math inline">\(\mathcal T=\{T_0,T_1,\cdots,T_{k-1}\}\)</span>ä¸ºå‡ ä½•å˜æ¢é›†åˆï¼Œ<span class="math inline">\(1\leq i\leq k-1,\space T_i:\mathcal X\rightarrow \mathcal X\)</span>ï¼Œä¸”<span class="math inline">\(T_0(x)=x\)</span>ã€‚<span class="math inline">\(S_\mathcal{T}\)</span>å®šä¹‰ä¸ºï¼š</p><p><span class="math display">\[S_\mathcal T=\{(T_j(x),j):x\in S,T_j\in\mathcal T\}\]</span> å¯¹äºæ¯ä¸ª<span class="math inline">\(x\in S\)</span>ï¼Œ<span class="math inline">\(j\)</span>ä¸º<span class="math inline">\(T_j(x)\)</span>çš„æ ‡ç­¾ã€‚æˆ‘ä»¬ç›´æ¥å­¦ä¹ ä¸€ä¸ª<span class="math inline">\(K\)</span>ç±»åˆ†ç±»å™¨<span class="math inline">\(f_\theta\)</span>ï¼Œæ¥é¢„æµ‹è¾“å…¥æ ·æœ¬å¯¹åº”çš„å‡ ä½•å˜æ¢ç§ç±»ï¼Œè¿™ç›¸å½“äºæ˜¯ä¸€ä¸ªå›¾åƒåˆ†ç±»é—®é¢˜ã€‚</p><p><img src="https://i.loli.net/2020/06/24/XBFKcPio64u3U1C.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="dirichlet-normality-score">Dirichlet Normality Score</h3><p>æ¥ä¸‹æ¥è¦åšçš„æ˜¯å¦‚ä½•å®šä¹‰å¼‚å¸¸åˆ†æ•°ï¼Œè®°ä¸º<span class="math inline">\(n_S(x)\)</span>ï¼Œè¿™æ˜¯æ–‡ä¸­çš„ä¸€ä¸ªé‡è¦çš„éƒ¨åˆ†ã€‚è®¾å‡ ä½•å˜æ¢é›†åˆ<span class="math inline">\(\mathcal T=\{T_0,T_1,\cdots,T_{k-1}\}\)</span>ï¼Œä¸”<span class="math inline">\(k\)</span>åˆ†ç±»å™¨<span class="math inline">\(f_\theta\)</span>åœ¨<span class="math inline">\(S_\mathcal{T}\)</span>ä¸Šå®Œæˆè®­ç»ƒã€‚å¯¹äºä»»æ„ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œä»¤<span class="math inline">\(\mathbf y(x)=\text{softmax}(f_{\theta}(x))\)</span>ï¼Œå³åˆ†ç±»å™¨<span class="math inline">\(f_\theta\)</span>è¾“å‡ºçš„<span class="math inline">\(\text{softmax}\)</span>ä¹‹åçš„å‘é‡ã€‚å¼‚å¸¸åˆ†æ•°<span class="math inline">\(n_S(x)\)</span>å®šä¹‰ä¸ºï¼š</p><p><span class="math display">\[n_S(x)=\sum\limits_{i=0}^{k-1}\log p(\mathbf y(T_i(x))|T_i)\]</span></p><p>è¯¥å¼‚å¸¸åˆ†æ•°å®šä¹‰ä¸ºæ¯ä¸ªç±»åˆ«ä¸Šï¼Œåœ¨å‡ ä½•å˜æ¢<span class="math inline">\(T_i\)</span>çš„æ¡ä»¶ä¸‹ï¼Œè¾“å‡ºçš„<span class="math inline">\(\mathbf y\)</span>çš„å¯¹æ•°ä¼¼ç„¶ä¹‹å’Œã€‚åœ¨æ–‡ä¸­ï¼Œä½œè€…å‡è®¾<span class="math inline">\(\mathbf y(T_i(x)|T_i\)</span>æœä»è¿ªåˆ©å…‹é›·åˆ†å¸ƒï¼š<span class="math inline">\(\mathbf y(T_i(x))|T_i\sim\text{Dir}(\boldsymbol \alpha_i)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\boldsymbol \alpha_i\in\mathbb R^k_+\)</span>ï¼Œ<span class="math inline">\(x\sim p_X(x)\)</span>ï¼Œ<span class="math inline">\(i\sim\text{Uni}(0,k-1)\)</span>ï¼Œè€Œ<span class="math inline">\(p_X(x)\)</span>ä»£è¡¨æ­£å¸¸æ ·æœ¬çš„çœŸå®æ•°æ®åˆ†å¸ƒã€‚äºæ˜¯ï¼š</p><p><span class="math display">\[n_S(x)=\sum_{i=0}^{k-1}\left[\log\Gamma(\sum_{j=0}^{k-1}[\tilde{\boldsymbol\alpha}_i]_j)-\sum_{j=0}^{k-1}\log\Gamma([\tilde{\boldsymbol\alpha}_i]_j)+\sum_{j=0}^{k-1}([\tilde{\boldsymbol\alpha}_i]_j-1)\log\mathbf y(T_i(x))_j\right]\]</span></p><p>å› ä¸º<span class="math inline">\(\tilde{\alpha}_i\)</span>ç›¸å¯¹äº<span class="math inline">\(x\)</span>æ¥è¯´æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¿½ç•¥ï¼Œäºæ˜¯å¼å­ç®€åŒ–ä¸ºï¼š <span class="math display">\[n_S(x)=\sum_{i=0}^{k-1}\sum_{j=0}^{k-1}([\tilde{\boldsymbol\alpha}_i]_j-1)\log\mathbf y(T_i(x))_j=\sum_{i=0}^{k-1}(\tilde{\boldsymbol \alpha}_i-1)\cdot\log\mathbf y(T_i(x))\]</span></p><p>æ³¨æ„è¿™é‡Œçš„æ¯ä¸ª<span class="math inline">\(\boldsymbol \alpha_i\)</span>éƒ½æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå³å¯¹äºæ¯ä¸ªå˜æ¢<span class="math inline">\(i\)</span>ï¼Œéƒ½å¯¹åº”ä¸€ä¸ªè¿ªåˆ©å…‹é›·åˆ†å¸ƒï¼Œå…¶å‚æ•°ä¸º<span class="math inline">\(\boldsymbol\alpha_i\)</span>ï¼›åœ¨å¯¹è®­ç»ƒé›†è¿›è¡Œç¬¬<span class="math inline">\(i\)</span>ä¸ªå‡ ä½•å˜æ¢ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°äº†<span class="math inline">\(\{T_i(x)\}\)</span>ï¼Œç„¶ååˆ†ç±»å™¨<span class="math inline">\(f_\theta(\cdot)\)</span>çš„è¾“å‡º<span class="math inline">\(\mathbf y(T_i(x))\)</span>ç›¸å½“äºè¿ªåˆ©å…‹é›·åˆ†å¸ƒçš„è§‚æµ‹å€¼ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è§‚æµ‹å€¼æ¥ä¼°è®¡å‚æ•°<span class="math inline">\(\boldsymbol \alpha_i\)</span>ï¼Œç„¶åæ ¹æ®è¿™ä¸ªå‚æ•°æ¥è®¡ç®—<span class="math inline">\(n_S(x)\)</span>ã€‚å¯¹äº<span class="math inline">\(\boldsymbol\alpha_i\)</span>ï¼Œå¯ä»¥çŸ¥é“å…¶ç¬¬<span class="math inline">\(i\)</span>ä¸ªåˆ†é‡åº”è¯¥æ˜¯ç›¸å¯¹æ¯”è¾ƒå¤§çš„ï¼Œä¸‹é¢æ˜¯è¿è¡Œå®˜æ–¹ä»£ç å¾—åˆ°çš„<span class="math inline">\(\boldsymbol\alpha_i\)</span>çš„ç»“æœï¼ˆ<span class="math inline">\(i=69\)</span>ï¼Œ<span class="math inline">\(i\)</span>ä»<span class="math inline">\(0\)</span>å¼€å§‹ï¼Œæ€»å…±ä¸º<span class="math inline">\(72\)</span>ç»´ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°ç¬¬<span class="math inline">\(69\)</span>ä¸ªåˆ†é‡æ˜¯æœ€å¤§çš„ã€‚</p><pre><code class="hljs bash">[INFO] value of mle_alpha_t: [ 0.10228925  0.08997199  0.13083569  0.10862965  0.09811163  0.08527119  0.17637901  0.27628416  0.12873376  0.19197053  0.11587154  0.09873095  0.12700618  0.07688542  0.10488203  0.12499191  0.11637607  0.07739511  0.13049147  0.51031647  0.20546597  0.15558449  0.09288609  0.12134945  0.09324992  0.14650162  0.16281216  0.11827823  0.08214853  0.15618336  0.28129761  0.45293697  0.11485838  1.78598954  0.16556983  0.1141158  0.10909459  0.13916602  0.11563799  0.07309986  0.11049714  0.12974086  0.15930642  0.13714361  0.13938356  0.70619553  0.11174039  0.07201538  0.16626109  0.12153727  0.09548811  0.07940956  0.15832209  0.11035474  0.12487912  0.16937875  0.23212662  0.37041831  0.08557451  0.0839439  0.09924258  0.39766872  0.14917286  0.08704662  0.09554555  0.31047109  0.24504759  0.16812463  0.11508187 63.98878807  0.12971073  0.07972932]</code></pre><p>ä¸‹å›¾ä¹Ÿå±•ç¤ºäº†å¯¹äºæ¯ä¸ªå˜æ¢<span class="math inline">\(i\)</span>ï¼Œ<span class="math inline">\(\mathbf y(T_i(x)|T_i\)</span>åˆ†å¸ƒçš„æƒ…å†µï¼š</p><p><img src="https://i.loli.net/2020/06/23/fLkst4i7Hu6PhQl.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä½œè€…è¿˜ç»™å‡ºäº†ä¸€ç§ç®€åŒ–çš„å½¢å¼ï¼Œ<span class="math inline">\(\hat{n}_S(x)=\frac{1}{k}\sum^{k-1}_{j=0}[\mathbf y(T_j(x))]_j\)</span>ã€‚ç›¸å½“äºè¯´ï¼Œå¯¹äºæ¯ä¸ªå˜æ¢<span class="math inline">\(T_i\)</span>åˆ†ç±»å™¨éƒ½ä¼šç»™å‡ºä¸€ä¸ª<span class="math inline">\(\text{softmax}\)</span>å‘é‡ï¼Œå–å…¶ç¬¬<span class="math inline">\(i\)</span>ä¸ªåˆ†é‡<span class="math inline">\([\mathbf y(T_j(x))]_j\)</span>ï¼Œç„¶åæŠŠæ¯ä¸ªå˜æ¢å¯¹åº”çš„<span class="math inline">\([\mathbf y(T_j(x))]_j\)</span>åŠ èµ·æ¥ã€‚</p><p>æ•´ä¸ªç®—æ³•çš„æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/23/z8MpdeoD6ZGavlN.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>è¿™é‡Œç»“åˆä½œè€…çš„æºä»£ç ç®€å•è¯´ä¸€ä¸‹æ£€æµ‹é˜¶æ®µçš„æµç¨‹ã€‚</p><hr /><pre><code class="hljs python"><span class="hljs-keyword">for</span> t_ind <span class="hljs-keyword">in</span> range(transformer.n_transforms):        observed_dirichlet = mdl.predict(transformer.transform_batch(observed_data, [t_ind] * len(observed_data)), batch_size=<span class="hljs-number">1024</span>)</code></pre><p>åœ¨è®­ç»ƒå¥½æ¨¡å‹ä¹‹åï¼Œå¯¹äºè®­ç»ƒé›†çš„æ‰€æœ‰æ ·æœ¬ï¼Œå¯¹å…¶è¿›è¡Œ<span class="math inline">\(K\)</span>ä¸ªå‡ ä½•å˜æ¢ä¹‹åï¼Œå¾—åˆ°<span class="math inline">\(K\)</span>ä¸ªæ ·æœ¬<span class="math inline">\(\{T_i(x)\}\)</span>ï¼Œå¯¹äºæ‰€æœ‰ç¬¬<span class="math inline">\(i\)</span>ä¸ªå‡ ä½•å˜æ¢å¯¹åº”çš„æ ·æœ¬<span class="math inline">\(\{T_i(x)\}\)</span>ï¼Œé€šè¿‡åˆ†ç±»å™¨<span class="math inline">\(f_\theta\)</span>ä¼šç»™å‡ºè¾“å‡º<span class="math inline">\(\mathbf y(T_i(x))\)</span>ã€‚è¿™é‡Œå¯¹åº”ç®—æ³•ä¸­çš„ç¬¬<span class="math inline">\(7-8\)</span>è¡Œï¼Œè¿™ä¸ª<code>observed_dirichlet</code>å°±æ˜¯<span class="math inline">\(S_i\)</span>ã€‚</p><hr /><pre><code class="hljs python">log_p_hat_train = np.log(observed_dirichlet).mean(axis=<span class="hljs-number">0</span>)alpha_sum_approx = calc_approx_alpha_sum(observed_dirichlet)alpha_0 = observed_dirichlet.mean(axis=<span class="hljs-number">0</span>) * alpha_sum_approx</code></pre><p>ä¹‹åè¿™éƒ¨åˆ†ä¸»è¦å¯¹åº”ç®—æ³•ä¸­çš„<span class="math inline">\(9-11\)</span>è¡Œã€‚ä½œè€…æŠŠæ‰€æœ‰çš„ç¬¬<span class="math inline">\(i\)</span>ä¸ªå˜æ¢ï¼Œåˆ†ç±»å™¨çš„è¾“å‡ºçš„é›†åˆï¼ˆä¹Ÿå°±æ˜¯å˜é‡<code>observed_dirichlet</code>ï¼‰è®°ä¸º<span class="math inline">\(S_i\)</span>ï¼Œ<span class="math inline">\(\bar s\)</span>ä¸º<span class="math inline">\(S_i\)</span>çš„å¹³å‡ï¼Œ<span class="math inline">\(\bar l\)</span>ä¸º<span class="math inline">\(S_i\)</span>å¯¹æ•°çš„å¹³å‡ï¼ˆå˜é‡<code>log_p_hat_train</code>ï¼‰ï¼Œåˆå§‹å€¼<span class="math inline">\(\tilde{\alpha}_i\)</span>ç”±<span class="math inline">\(\bar s\frac{(k-1)(-\Psi(1))}{\bar s\cdot\log\bar s-\bar s\cdot\bar l}\)</span>ç»™å‡ºï¼ˆå˜é‡<code>alpha_0</code>ï¼‰ã€‚å‡½æ•°<code>calc_approx_alpha_sum</code>å®ç°çš„æ˜¯ç®—æ³•ä¸­ç¬¬<span class="math inline">\(11\)</span>è¡Œçš„<span class="math inline">\(\frac{(k-1)(-\Psi(1))}{\bar s\cdot\log\bar s-\bar s\cdot\bar l}\)</span>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calc_approx_alpha_sum</span><span class="hljs-params">(observations)</span>:</span>    N = len(observations)    f = np.mean(observations, axis=<span class="hljs-number">0</span>)    <span class="hljs-keyword">return</span> (N * (len(f) - <span class="hljs-number">1</span>) * (-psi(<span class="hljs-number">1</span>))) / (        N * np.sum(f * np.log(f)) - np.sum(f * np.sum(np.log(observations), axis=<span class="hljs-number">0</span>)))</code></pre><hr /><pre><code class="hljs python">mle_alpha_t = fixed_point_dirichlet_mle(alpha_0, log_p_hat_train)</code></pre><p>è¿™é‡Œå¯¹åº”ç®—æ³•ä¸­çš„<span class="math inline">\(12-14\)</span>è¡Œï¼Œå³é‡å¤<span class="math inline">\(\tilde\alpha_i\leftarrow\Psi^{-1}\left(\Psi(\sum_j[\alpha_i]_j)+\bar l\right)\)</span>æ¥ä¼°è®¡<span class="math inline">\(\alpha\)</span>ï¼Œå‡½æ•°<code>fixed_point_dirichlet_mle</code>ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fixed_point_dirichlet_mle</span><span class="hljs-params">(alpha_init, log_p_hat, max_iter=<span class="hljs-number">1000</span>)</span>:</span>    alpha_new = alpha_old = alpha_init    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(max_iter):        alpha_new = inv_psi(psi(np.sum(alpha_old)) + log_p_hat)        <span class="hljs-keyword">if</span> np.sqrt(np.sum((alpha_old - alpha_new) ** <span class="hljs-number">2</span>)) &lt; <span class="hljs-number">1e-9</span>:            <span class="hljs-keyword">break</span>        alpha_old = alpha_new    <span class="hljs-keyword">return</span> alpha_new</code></pre><p><span class="math inline">\(\Psi^{-1}(\cdot)\)</span>æ˜¯é€šè¿‡æ•°å€¼æ–¹æ³•æ¥ä¼°è®¡çš„ï¼š</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inv_psi</span><span class="hljs-params">(y, iters=<span class="hljs-number">5</span>)</span>:</span>    <span class="hljs-comment"># initial estimate</span>    cond = y &gt;= <span class="hljs-number">-2.22</span>    x = cond * (np.exp(y) + <span class="hljs-number">0.5</span>) + (<span class="hljs-number">1</span> - cond) * <span class="hljs-number">-1</span> / (y - psi(<span class="hljs-number">1</span>))    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(iters):        x = x - (psi(x) - y) / polygamma(<span class="hljs-number">1</span>, x)    <span class="hljs-keyword">return</span> x</code></pre><hr /><p>æœ€åï¼Œåœ¨å¾—åˆ°å¯¹<span class="math inline">\(\alpha\)</span>çš„ä¼°è®¡ä¹‹åï¼Œå¯ä»¥æ¥è®¡ç®—æµ‹è¯•æ ·æœ¬çš„åˆ†æ•°äº†ã€‚è¿™é‡Œå¯¹åº”çš„æ˜¯ç®—æ³•ä¸­çš„ç¬¬<span class="math inline">\(16\)</span>è¡Œã€‚</p><pre><code class="hljs python">x_test_p = mdl.predict(transformer.transform_batch(x_test, [t_ind] * len(x_test)), batch_size=<span class="hljs-number">1024</span>)scores += dirichlet_normality_score(mle_alpha_t, x_test_p)</code></pre><p>å‡½æ•°<code>dirichlet_normality_score</code>ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dirichlet_normality_score</span><span class="hljs-params">(alpha, p)</span>:</span>    <span class="hljs-keyword">return</span> np.sum((alpha - <span class="hljs-number">1</span>) * np.log(p), axis=<span class="hljs-number">-1</span>)</code></pre><h1 id="experiments">Experiments</h1><h2 id="baselines">Baselines</h2><p>æ–‡ä¸­ç”¨åˆ°äº†å¦‚ä¸‹çš„Baselineï¼š</p><ul><li><strong>One-class SVM. </strong>å•ç±»æ”¯æŒå‘é‡æœºï¼Œä½œè€…ä½¿ç”¨äº†ä¸‰ä¸ªå˜ä½“ï¼Œåˆ†åˆ«ä¸º<strong>RAW-OC-SVM</strong>â€”â€”ä½¿ç”¨åŸå§‹æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œ<strong>CAE-OC-SVM</strong>â€”â€”ä½¿ç”¨ä¸€ä¸ªå·ç§¯è‡ªç¼–ç å™¨æ¥è·å¾—ä½ç»´è¡¨ç¤ºä½œä¸ºè¾“å…¥å’Œ<strong>E2E-OC-SVM</strong>â€”â€”å…¨åä¸º<strong>One-Class Deep Support Vector Data Description</strong>ï¼›</li><li><strong>Deep structured energy-based models. </strong></li><li><strong>Deep Autoencoding Gaussian Mixture Model. </strong></li><li><strong>Generative Adversarial Networks. </strong></li></ul><h2 id="datasets">Datasets</h2><p>æ–‡ä¸­ç”¨åˆ°äº†ä¸€ä¸‹å‡ ä¸ªæ•°æ®é›†ï¼š</p><ul><li><strong>CIFAR-10</strong></li><li><strong>CIFAR-100</strong></li><li><strong>Fashion-MNIST</strong></li><li><strong>CatsVsDogs</strong></li></ul><p>åœ¨å®éªŒä¸­æ‰€æœ‰å›¾ç‰‡éƒ½è¢«å½’ä¸€åŒ–åˆ°<span class="math inline">\([-1,1]\)</span>çš„èŒƒå›´ã€‚</p><h2 id="experimental-protocol">Experimental Protocol</h2><p>è®¾æ•°æ®é›†æœ‰<span class="math inline">\(C\)</span>ä¸ªç±»ï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œ<span class="math inline">\(C\)</span>æ¬¡å®éªŒï¼Œåœ¨ç¬¬<span class="math inline">\(c\)</span>æ¬¡å®éªŒ (<span class="math inline">\(1\leq c \leq C\)</span>)ä¸­æˆ‘ä»¬ä¼šå°†ç¬¬<span class="math inline">\(c\)</span>ä¸ªç±»ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œè€Œå…¶ä»–ç±»ä½œä¸ºå¼‚å¸¸æ ·æœ¬ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œè®­ç»ƒé›†åªåŒ…å«æ­£å¸¸æ ·æœ¬ï¼Œè€Œåœ¨æµ‹è¯•é˜¶æ®µåˆ™ä¼šæœ‰æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬ã€‚åœ¨è·å¾—å¼‚å¸¸åˆ†æ•°ä¹‹åï¼Œé˜ˆå€¼<span class="math inline">\(\lambda\)</span>åˆ™æ ¹æ®ROCæ›²çº¿ä¸‹é¢ç§¯é€‰æ‹©ã€‚</p><p>å®éªŒä¸­ä½¿ç”¨çš„å‡ ä½•å˜æ¢åŸºäºä»¥ä¸‹ä¸‰ç§åŸºå˜æ¢ï¼š</p><ul><li><strong>Horizontal flip: </strong> è®°ä¸º<span class="math inline">\(T_b^{flip}(x)\)</span>ï¼Œ<span class="math inline">\(b\in\{T,F\}\)</span>ä»£è¡¨æ˜¯å¦ç¿»è½¬ï¼›</li><li><strong>Translation: </strong> è®°ä¸º<span class="math inline">\(T_{s_h,s_w}^{trans}(x)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(s_h,s_w\in\{-1,0,1\}\)</span>ã€‚åœ¨é•¿å®½ä¸¤ä¸ªç»´åº¦ä¸Šä½ç§»åˆ†åˆ«ä¸º<span class="math inline">\(0.25\)</span>é«˜åº¦å’Œ<span class="math inline">\(0.25\)</span>å®½åº¦ï¼Œè¿™ä¸¤ä¸ªç»´åº¦å‘ç”Ÿä½ç§»çš„æ–¹å‘ç”±<span class="math inline">\(s_h\)</span>å’Œ<span class="math inline">\(s_w\)</span>å†³å®šï¼Œå½“<span class="math inline">\(s_h=s_w=0\)</span>æ—¶ä»£è¡¨ä¸ç§»åŠ¨ï¼›</li><li><strong>Rotation by multiples 90 degrees: </strong> è®°ä¸º<span class="math inline">\(T_k^{rot}(x)\)</span>ï¼Œ<span class="math inline">\(k\in\{0,1,2,3\}\)</span>ã€‚æ—‹è½¬<span class="math inline">\(k\times90\)</span>åº¦ã€‚</li></ul><p>å°†ä¸‰ç§åŸºå˜æ¢å åŠ æœ‰ï¼š <span class="math display">\[\mathcal T=\left\{ T_k^{rot}\circ T_{s_h,s_w}^{trans}\circ T_b^{flip} : \begin{matrix} b &amp;\in \{T,F\}\\ s_h,s_w&amp;\in\{-1,0,1\}\\ k&amp;\in\{0,1,2,3\} \end{matrix} \right\}\]</span> æœ€ç»ˆå‡ ä½•å˜æ¢ç§æ•°ä¸º<span class="math inline">\(2\times3\times3\times4=72\)</span>ç§ã€‚</p><p>åˆ†ç±»å™¨æ¨¡å‹ä½¿ç”¨çš„æ˜¯<strong>Wide Residual Network</strong>ï¼Œä¼˜åŒ–å™¨ä¸ºAdamï¼ŒBatch sizeä¸º128ï¼Œè®­ç»ƒè½®æ•°ä¸º200ã€‚</p><h2 id="results">Results</h2><p>ä¸‹é¢æ˜¯ä¸åŒæ–¹æ³•åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„å®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/24/gHZohrvz9MGYmxi.png" srcset="/img/loading.gif" /></p><p>è¯„æµ‹æ ‡å‡†ä½¿ç”¨çš„æ˜¯AUROCã€‚ä½œè€…å…³äºç»“æœçš„åˆ†æä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol type="1"><li>åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ç®—æ³•éƒ½æ¯”Baselineè¦å¥½ï¼Œè€Œä¸”æ˜¯è¶Šå¤§çš„æ•°æ®é›†æ•ˆæœè¶Šå¥½ã€‚CatsVsDogsæ•°æ®é›†æ¯å¼ å›¾ç‰‡çš„å¤§å°æ¯”å…¶ä»–å‡ ä¸ªæ•°æ®é›†éƒ½è¦å¤§ï¼Œè€ŒBaselineåœ¨è¿™ä¸ªæ•°æ®é›†ä¸Šçš„ç»“æœéƒ½åœ¨<span class="math inline">\(50\%\)</span>æˆ–ä¸åˆ°<span class="math inline">\(50\%\)</span>ï¼Œè¿™åŸºæœ¬ç­‰åŒäºççŒœï¼›</li><li>åœ¨CIFAR-100æ•°æ®é›†é‡Œï¼Œç”±äºå°†è¿™100ç±»èšåˆä¸ºäº†20ç±»ï¼Œæ‰€ä»¥å­˜åœ¨ç±»å†…æ ·æœ¬å·®å¼‚å¤§çš„é—®é¢˜ã€‚æ¯”å¦‚åœ¨ç±»<span class="math inline">\(5\)</span>ã€ç±»<span class="math inline">\(7\)</span>å’Œç±»<span class="math inline">\(13\)</span>ä¸Šï¼Œæ¨¡å‹è¡¨ç°å°±ä¸å¤Ÿå¥½ï¼›</li><li>åœ¨Fashion-MNISTæ•°æ®é›†ä¸Šå‡ ä¹æ‰€æœ‰æ–¹æ³•ï¼ˆé™¤äº†DAGMMï¼‰éƒ½è¡¨ç°å¾ˆå¥½ã€‚</li></ol><h2 id="on-the-intuition-for-using-geometric-transformations">On the Intuition for Using Geometric Transformations</h2><p>è¿™é‡Œä½œè€…å¯¹æ‰€é€‰ç”¨çš„å‡ ä½•å˜æ¢åšäº†ä¸€äº›è§£é‡Šã€‚å®éªŒä¸­é€‰ç”¨çš„ä¸‰ç§åŸºæœ¬å‡ ä½•å˜æ¢éƒ½æ˜¯å¯é€†çš„çº¿æ€§å‡ ä½•å˜æ¢ï¼ˆä¸”ä¸ºåŒå°„ï¼‰ï¼Œä½œè€…ä¹Ÿè¯•è¿‡ä¸€äº›å¤æ‚çš„éçº¿æ€§å˜æ¢ï¼Œå¦‚é«˜æ–¯æ¨¡ç³Šã€é”åŒ–ã€ä¼½é©¬æ ¡æ­£ç­‰ç­‰ï¼Œä½†æ˜¯æ•ˆæœå¹¶ä¸å¥½ã€‚</p><p>ä½œè€…è®¤ä¸ºåˆ†ç±»å™¨èƒ½å¤Ÿåˆ†è¾¨ä¸åŒå˜æ¢çš„èƒ½åŠ›ä¸æœ€ç»ˆæ€§èƒ½æˆæ­£æ¯”ï¼Œä¸ºäº†éªŒè¯è¿™ä¸€ç‚¹ï¼Œè¿›è¡Œäº†<span class="math inline">\(3\)</span>ä¸ªå®éªŒã€‚ä»MNISTæ•°æ®é›†é€‰æ‹©ä¸€ä¸ªæ•°å­—ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œå‡ ä½•å˜æ¢åªé‡‡ç”¨ä¸¤ä¸ªï¼Œç„¶åé€‰æ‹©å¦ä¸€ä¸ªæ•°å­—ä½œä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><ul><li><strong>Normal digit: 8ï¼ŒAnomaly: 3ï¼ŒTransformations: Identity and horizontal flip. </strong>ç”±äºæ•°å­—<span class="math inline">\(8\)</span>æ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥è¦è®©åˆ†ç±»å™¨åˆ†è¾¨åŸå§‹çš„<span class="math inline">\(8\)</span>å’Œç¿»è½¬ä¹‹åçš„<span class="math inline">\(8\)</span>æ˜¯å¾ˆéš¾çš„ï¼ŒAUROCåªæœ‰<span class="math inline">\(0.646\)</span>ï¼›</li><li><strong>Normal digit: 3ï¼ŒAnomaly: 8ï¼ŒTransformations: Identity and horizontal flip. </strong>è¿™é‡ŒæŠŠ<span class="math inline">\(3\)</span>ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œç”±äº<span class="math inline">\(3\)</span>ä¸æ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥ä¸¤ç§å˜æ¢æ˜¯å¯ä»¥åˆ†è¾¨çš„ï¼ŒAUROCè¾¾åˆ°äº†<span class="math inline">\(0.957\)</span>ï¼›</li><li><strong>Normal digit: 8ï¼ŒAnomaly: 3ï¼ŒTransformations: Identity and translation by 7 pixels. </strong>åŒæ ·æ˜¯æŠŠ<span class="math inline">\(8\)</span>ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œä½†å˜æ¢ç”¨çš„æ˜¯å¹³ç§»ï¼ŒAUROCè¾¾åˆ°äº†<span class="math inline">\(0.919\)</span>ã€‚</li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜è®¾è®¡äº†ä¸€ä¸ªå®éªŒï¼Œç›®çš„æ˜¯æµ‹è¯•ä»€ä¹ˆæ ·çš„å›¾åƒä¼šè·å¾—è¾ƒé«˜çš„åˆ†æ•°<span class="math inline">\(n_S(x)\)</span>ã€‚åœ¨ç»™å®šè®­ç»ƒå¥½çš„åˆ†ç±»å™¨çš„æƒ…å†µä¸‹ï¼Œä¼˜åŒ–è¾“å…¥çš„å›¾åƒï¼Œç›®æ ‡å‡½æ•°æ˜¯æœ€å¤§åŒ–åˆ†æ•°<span class="math inline">\(n_S(x)\)</span>ã€‚ä¸‹å›¾ä¸ºå®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/24/8Pi4EKCRuBXrYgp.png" srcset="/img/loading.gif" /></p><p>åœ¨å·¦å›¾ä¸­ï¼Œå°†æ•°å­—<span class="math inline">\(3\)</span>ä½œä¸ºæ­£å¸¸æ ·æœ¬è®­ç»ƒçš„åˆ†ç±»å™¨ã€åŸå§‹è¾“å…¥ä¸ºæ•°å­—<span class="math inline">\(0\)</span>çš„å›¾ç‰‡æ—¶ï¼Œéšç€ä¼˜åŒ–çš„è¿›è¡Œï¼Œå›¾ç‰‡æ…¢æ…¢åœ°å˜å¾—åƒæ•°å­—<span class="math inline">\(3\)</span>ã€‚åœ¨å³å›¾ä¸­ï¼ŒåŒæ ·æ˜¯å°†æ•°å­—<span class="math inline">\(3\)</span>ä½œä¸ºæ­£å¸¸æ ·æœ¬è®­ç»ƒçš„åˆ†ç±»å™¨ï¼Œä¸è¿‡åŸå§‹è¾“å…¥ä¹Ÿæ˜¯æ•°å­—<span class="math inline">\(3\)</span>ï¼Œè¿™æ—¶å›¾åƒå´æ²¡æœ‰æ€ä¹ˆå˜åŒ–ã€‚</p><h1 id="remark">Remark</h1><ul><li>æ–‡ä¸­æåˆ°çš„åœ¨CIFAR100æ•°æ®çš„å®éªŒä¸Šï¼Œç”±äºç±»é—´å·®å¼‚æ¯”è¾ƒå¤§å¯¼è‡´æ•ˆæœè¾ƒå·®ï¼Œé‚£ä¹ˆå¾ˆè‡ªç„¶åœ°ï¼Œä¸åŒçš„å˜æ¢æ ·æœ¬å¯¹åº”çš„é›†ç°‡å®é™…ä¸Šåº”å½“è¶³å¤Ÿåˆ†å¼€ï¼Œé›†ç°‡å†…çš„æ ·æœ¬è¦è¶³å¤Ÿè¿›ï¼Œè¿™æ ·å¯¹äºåˆ†ç±»å™¨æ¥è¯´æ‰èƒ½æ¯”è¾ƒå¥½çš„åˆ†ç±»ã€‚ä¸è¿‡é‡‡ç”¨çš„å‡ ä½•å˜æ¢å¹¶æ²¡æœ‰é’ˆå¯¹è¿™ä¸€ç‚¹è¿›è¡Œç‰¹åˆ«è®¾è®¡ï¼›</li><li>æ–‡ä¸­å¼ºè°ƒäº†æ‰€ä½¿ç”¨çš„å˜æ¢ä¸ºå‡ ä½•å˜æ¢ï¼Œå…¶å®é™¤æ­¤ä¹‹å¤–ï¼Œæ‰€ä½¿ç”¨çš„å˜æ¢è¿˜éƒ½æ˜¯å¯ä»¥ç”¨çŸ©é˜µè¡¨ç¤ºçš„å¯é€†çš„å˜æ¢ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cross-dataset Time Series Anomaly Detection for Cloud Systems</title>
    <link href="/2020/06/01/Cross-dataset-Time-Series-Anomaly-Detection-for-Cloud-Systems/"/>
    <url>/2020/06/01/Cross-dataset-Time-Series-Anomaly-Detection-for-Cloud-Systems/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§ç”¨äºäº‘è®¡ç®—å¹³å°çš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¡†æ¶ã€‚ä¸ºäº†è§£å†³æ ‡ç­¾ä¸è¶³çš„é—®é¢˜ï¼Œæ–‡ä¸­ä½¿ç”¨äº†è¿ç§»å­¦ä¹ çš„æ–¹æ³•ï¼Œå³åœ¨æœ‰æ ‡ç­¾çš„source domainä¸Šè®­ç»ƒæ¨¡å‹ï¼Œåœ¨æ²¡æœ‰æ ‡ç­¾çš„target domainä¸Šæ£€æµ‹ã€‚åŒæ—¶ï¼Œæ–‡ä¸­è¿˜ä½¿ç”¨äº†ä¸»åŠ¨å­¦ä¹ çš„æ–¹æ³•æ¥æŒ‘é€‰æœ€æœ‰ä»·å€¼çš„æ— æ ‡ç­¾æ ·æœ¬è¿›è¡Œæ ‡è®°ã€‚</p><p><a href="https://www.usenix.org/system/files/atc19-zhang-xu.pdf" target="_blank" rel="noopener">ğŸ“°Get Paper</a></p><h1 id="background">Background</h1><p>é’ˆå¯¹äº‘è®¡ç®—å¹³å°æ•°æ®çš„å¼‚å¸¸æ£€æµ‹é€šå¸¸æ˜¯åº”ç”¨åœ¨äº‘ç›‘æ§æ•°æ®ï¼Œå¦‚KPIã€CPUä½¿ç”¨ç‡ã€ç³»ç»Ÿè´Ÿè½½ç­‰æ—¶åºæ•°æ®ä¸Šã€‚å’Œä¼ ç»Ÿçš„å¼‚å¸¸æ£€æµ‹ä¸ä¸€æ ·çš„æ˜¯ï¼Œæ—¶åºå¼‚å¸¸æ£€æµ‹å¾€å¾€æ›´éš¾ï¼Œæ–‡ä¸­æ€»ç»“äº†ä»¥ä¸‹å‡ ä¸ªæŒ‘æˆ˜ï¼š</p><ul><li>å¼‚å¸¸ç‰¹å¾çš„å·®å¼‚æ€§ã€‚åœ¨ä¸åŒçš„äº‘æœåŠ¡ç³»ç»Ÿä¸­ï¼Œå¯¹å¼‚å¸¸çš„å®¹å¿åº¦æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥å¯¹æ¯ä¸ªåœºæ™¯æˆ–ç³»ç»Ÿç»„ä»¶è®¾ç½®å‡†ç¡®çš„é˜ˆå€¼æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹æ˜¯ååˆ†å›°éš¾çš„ï¼›</li><li>æ—¶é—´ä¾èµ–æ€§ã€‚è¯¥å¼‚å¸¸æ£€æµ‹é—®é¢˜å¤„ç†çš„æ˜¯æ—¶é—´åºåˆ—æ•°æ®ï¼Œè€Œä¼ ç»Ÿçš„å¼‚å¸¸æ£€æµ‹å¹¶ä¸ä¼šè€ƒè™‘æ—¶é—´ä¾èµ–æ€§ï¼›</li><li>æ— ç›‘ç£å­¦ä¹ çš„æ€§èƒ½é—®é¢˜ã€‚æ— ç›‘ç£çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„æ€§èƒ½æœ‰é™ï¼Œä¼šå¸¦æ¥å¤§é‡çš„è¯¯æŠ¥ï¼›</li><li>æœ‰ç›‘ç£å­¦ä¹ éœ€è¦å¤§é‡æ ‡ç­¾ã€‚</li></ul><h1 id="proposed-approach">Proposed Approach</h1><p>ä¸ºäº†è§£å†³ä¸Šè¿°æŒ‘æˆ˜ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ä¸ªæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¡†æ¶ATAD (Active Transfer Anomaly Detection)ã€‚è¯¥æ¡†æ¶ç»“åˆäº†è¿ç§»å­¦ä¹ æŠ€æœ¯å’Œä¸»åŠ¨å­¦ä¹ æŠ€æœ¯ï¼Œç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/jOB4rC2gnH9VcQW.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>æœªæ ‡è®°æ•°æ®<span class="math inline">\(T_u\)</span>æ˜¯æˆ‘ä»¬è¦æ£€æµ‹çš„ç›®æ ‡æ•°æ® (target domain)ï¼Œæ ‡è®°æ•°æ®<span class="math inline">\(T_l\)</span>æ˜¯æˆ‘ä»¬çš„æºæ•°æ® (source domain)ï¼Œå¯ä»¥æ˜¯å¼€æºæ•°æ®æˆ–è€…æ˜¯å…¶ä»–ç³»ç»Ÿçš„ç›‘æ§æ•°æ®ã€‚</p><h2 id="transfer-learning-component">Transfer Learning Component</h2><p>åœ¨åº”ç”¨è¿ç§»å­¦ä¹ æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªå› ç´ ï¼š</p><ul><li>æˆ‘ä»¬å¤„ç†çš„æ˜¯æ—¶é—´åºåˆ—æ•°æ®ï¼Œå³åœ¨ä¸åŒçš„æ—¶é—´ç‚¹ä¸Šæ ·æœ¬ä¹‹é—´ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå–äº†ä¸åŒçš„ç‰¹å¾ï¼Œæ¯ä¸€ä¸ªæ—¶é—´ç‚¹è¢«è½¬æ¢ä¸ºäº†é«˜ç»´çš„ç‰¹å¾å‘é‡ï¼Œä¸”æ¯ä¸ªæ—¶é—´ç‚¹é™„è¿‘çš„èƒŒæ™¯ä¿¡æ¯è¢«ä¿å­˜åœ¨äº†ç‰¹å¾å‘é‡ä¹‹ä¸­ï¼›</li><li>æ—¶é—´åºåˆ—çš„ç²’åº¦ã€‚ç²—ç²’åº¦çš„è¿ç§»å­¦ä¹ ä¸åˆ©äºå‘ç°å¼‚å¸¸ï¼Œæœ¬æ–‡é‡‡ç”¨ç»†ç²’åº¦ï¼Œå³æ•°æ®ç‚¹çº§åˆ«çš„è¿ç§»å­¦ä¹ ï¼›</li><li>è¿ç§»å­¦ä¹ éœ€è¦source domainå’Œtarget domainå…·æœ‰æ½œåœ¨çš„ç›¸ä¼¼æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹source domainä¸­çš„æ ·æœ¬è¿›è¡Œè¿‡æ»¤ã€‚</li></ul><p><img src="https://i.loli.net/2020/06/25/aM7Qvt6DwGXnThm.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="feature-identification">Feature Identification</h3><p>è¿™ä¸€èŠ‚æè¿°ç‰¹å¾å·¥ç¨‹ä¸­ç”¨åˆ°çš„ç‰¹å¾ã€‚åœ¨æå–ç‰¹å¾ä¹‹å‰ï¼Œæ–‡ä¸­ä½¿ç”¨äº†ç¦»æ•£å‚…é‡Œå¶å˜æ¢æ¥è¯†åˆ«æ—¶é—´åºåˆ—çš„å‘¨æœŸ<span class="math inline">\(p\)</span>ï¼Œå¹¶ä¸ºåé¢æ»‘åŠ¨çª—å£çš„å¤§å°åŸåˆ™ä½œå‚è€ƒã€‚</p><h4 id="statistical-features">Statistical Features</h4><p>ç»Ÿè®¡ç‰¹å¾åŒ…å«äº†ä¸€äº›åŸºæœ¬çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¦‚å‡å€¼ã€æ–¹å·®ç­‰ï¼Œç”¨åˆ°çš„ç‰¹å¾å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/jI9EbCy1XueDViw.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>è¡¨ä¸­çš„ç»Ÿè®¡ç‰¹å¾éƒ½æ˜¯åŸºäºå¤§å°ç­‰äºå‘¨æœŸ<span class="math inline">\(p\)</span>çš„æ»‘åŠ¨çª—å£çš„ã€‚</p><h4 id="forecasting-error-features">Forecasting Error Features</h4><p>ä½¿ç”¨é¢„æµ‹ç‰¹å¾çš„ç†ç”±æ˜¯å¦‚æœä¸€ä¸ªæ•°æ®ç‚¹åç¦»é¢„æµ‹å€¼å¾ˆè¿œï¼Œé‚£ä¹ˆå®ƒå¾ˆæœ‰å¯èƒ½æ˜¯å¼‚å¸¸ã€‚æ–‡ä¸­ä½¿ç”¨äº†å¤šç§æ—¶é—´åºåˆ—é¢„æµ‹æ¨¡å‹ï¼Œå¦‚SARIMAã€Holtã€Holt-Wintersã€STLç­‰ã€‚æœ€ç»ˆçš„é¢„æµ‹ç»“æœä½¿ç”¨ä¸‹å¼æ¥åŠ æƒé›†æˆï¼š <span class="math display">\[\hat{Y}_t=\sum\limits_{m=1}^{M}\frac{\hat{Y}_{m,t}}{M-1}\left(1-\frac{RMSE_{m,t}}{\sum\limits_{n=1}^M RMSE_{n,t}}\right)\]</span> <span class="math inline">\(M\)</span>ä»£è¡¨<span class="math inline">\(M\)</span>ä¸ªä¸åŒæ¨¡å‹ï¼Œ<span class="math inline">\(RMSE_{m,t}\)</span>ä»£è¡¨æ¨¡å‹<span class="math inline">\(m\)</span>åœ¨æ—¶é—´<span class="math inline">\(t\)</span>çš„<span class="math inline">\(RMSE\)</span>ï¼Œ<span class="math inline">\(\hat{Y}_t\)</span>æ˜¯åœ¨æ—¶é—´<span class="math inline">\(t\)</span>çš„æœ€ç»ˆé¢„æµ‹ç»“æœã€‚ä¹‹åï¼Œä½¿ç”¨ä¸‹è¡¨ä¸­çš„Metricsæ¥è®¡ç®—ä¸åŒé¢„æµ‹ç‰¹å¾ï¼š</p><p><img src="https://i.loli.net/2020/06/25/wRmfHj5xFcsLIXp.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>åŒæ ·çš„ï¼Œä¸Šè¿°ç‰¹å¾éƒ½æ˜¯åŸºäºçª—å£çš„ã€‚</p><h4 id="temporal-features">Temporal Features</h4><p>è¿™ä¸€éƒ¨åˆ†æ˜¯ä¸€äº›æ—¶é—´åºåˆ—ç›¸å…³ç‰¹å¾ï¼š</p><p><img src="https://i.loli.net/2020/06/25/mnBrzjfgV716yiR.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>æœ€åï¼Œæ€»å…±æå–äº†37ä¸ªç‰¹å¾ï¼Œå¹¶ä¸”æ¯ä¸ªç‰¹å¾éƒ½è¿›è¡Œäº†æ­£åˆ™åŒ–ã€‚</p><h3 id="the-transfer-between-source-domain-and-target-domain">The Transfer between Source Domain and Target Domain</h3><p>æœ¬æ–‡ç»“åˆäº†åŸºäºå®ä¾‹çš„è¿ç§»å­¦ä¹ (<strong>Instance-based Transfer Learning</strong>)å’ŒåŸºäºç‰¹å¾çš„è¿ç§»å­¦ä¹ (<strong>Feature-based Transfer Learning</strong>)ã€‚</p><p>é¦–å…ˆï¼Œsource domainä¸­çš„æ•°æ®å·®å¼‚æ€§æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸target domainç›¸ä¼¼çš„æ ·æœ¬ã€‚</p><p>åŸºäºå®ä¾‹çš„è¿ç§»å­¦ä¹ (<strong>Instance-based Transfer Learning</strong>)çš„æ€æƒ³æ˜¯é€‰æ‹©source domainä¸­ä¸target domainç›¸ä¼¼çš„æ ·æœ¬ã€‚å¯¹äºsource domainï¼Œåœ¨å°†æ—¶é—´åºåˆ—<span class="math inline">\(T_l\)</span>è½¬æ¢ä¸ºç‰¹å¾<span class="math inline">\(F_l\)</span>ä¹‹åï¼Œæœ¬æ–‡ä½¿ç”¨<span class="math inline">\(K-means\)</span>ç®—æ³•å°†<span class="math inline">\(F_l\)</span>åˆ†æˆè‹¥å¹²ä¸ªç°‡ã€‚æ¯ä¸ªç°‡<span class="math inline">\(F_l^i, i\in[1,K]\)</span>æ˜¯<span class="math inline">\(F_l\)</span>çš„ä¸é‡å å­é›†ã€‚ä¸ºäº†é€‰æ‹©åˆé€‚çš„æ ·æœ¬ï¼Œæˆ‘ä»¬è®¡ç®—äº†target domainä¸­çš„æ ·æœ¬å’Œæ¯ä¸ªç°‡ä¸­å¿ƒç‚¹çš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œç„¶åæ ·æœ¬ä¼šå’Œè·ç¦»æœ€è¿‘çš„ç°‡<span class="math inline">\(F_l^i\)</span>è”ç³»èµ·æ¥ã€‚</p><p>ä¹‹åï¼Œä¸ºäº†ä½¿source domainå’Œtarget domainåœ¨ç‰¹å¾ç©ºé—´çš„å·®åˆ«æ›´å°ï¼Œä½œè€…åœ¨æ¯ä¸ªç°‡ä¸Šä½¿ç”¨äº†<strong>CORrelation ALignment</strong> (CORAL) ç®—æ³•ã€‚CORALæ˜¯ä¸€ç§é¢†åŸŸé€‚åº”ç®—æ³• (<strong>Domain Adaption</strong>)ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯å¯¹source domainå’Œtarget domainè¿›è¡Œçº¿æ€§å˜æ¢ä½¿å…¶äºŒé˜¶ç»Ÿè®¡ä¿¡æ¯ï¼ˆå³åæ–¹å·®çŸ©é˜µï¼‰çš„å·®åˆ«æœ€å°åŒ–ï¼š <span class="math display">\[\min_A\parallel A^\top C^i_lA-C^i_u\parallel_F^2\]</span></p><p>åœ¨æœ€åä¸€æ­¥ï¼Œä½œè€…åœ¨æ¯ä¸€ä¸ªsub source domain <span class="math inline">\(\hat{F}_l^i\)</span>è®­ç»ƒäº†æœ‰ç›‘ç£æ¨¡å‹ï¼ˆéšæœºæ£®æ—æˆ–SVMï¼‰ï¼Œæ‰€ä»¥æœ€åæˆ‘ä»¬å¾—åˆ°äº†<span class="math inline">\(K\)</span>ä¸ªåŸºæ¨¡å‹ã€‚</p><h2 id="active-learning-component">Active Learning Component</h2><p>ç”±äºæ•°æ®çš„å·®å¼‚æ€§å’Œå¤æ‚æ€§å¤ªå¤§ï¼Œä»…ä»…ä½¿ç”¨è¿ç§»å­¦ä¹ çš„æŠ€æœ¯ä¸è¶³ä»¥è¾¾åˆ°å¾ˆå¥½çš„æ•ˆæœã€‚åœ¨ATADä¸­ï¼Œä½œè€…ä½¿ç”¨äº†ä¸»åŠ¨å­¦ä¹ æŠ€æœ¯æ¥ç”¨è¾ƒå°‘çš„æˆæœ¬æ ‡æ³¨æœ€æœ‰ä»·å€¼çš„æ ·æœ¬æ¥æå‡æ€§èƒ½ã€‚æœ¬æ–‡ä¸­ä½¿ç”¨åŸºäº<strong>Uncertainty</strong>å’Œ<strong>Context Diversity</strong>çš„ä¸»åŠ¨å­¦ä¹ ã€‚</p><h3 id="uncertainty">Uncertainty</h3><p>å¤§å¤šæ•°ä¸»åŠ¨å­¦ä¹ ç®—æ³•ä½¿ç”¨ä¸ç¡®å®šæ€§ (Uncertainty) æ¥ä½œä¸ºé€‰æ‹©è¦æ ‡è®°çš„æ ·æœ¬çš„å‡†åˆ™ã€‚ <span class="math display">\[Uncertainty=-|Prob(Normal)-Prob(Anomaly)|\]</span> å…¶ä¸­çš„<span class="math inline">\(Prob\)</span>ç”±åŸºæ¨¡å‹ç»™å‡ºã€‚</p><h3 id="context-diversity">Context Diversity</h3><p>å¤šæ ·æ€§ (Diversity) ä¹Ÿæ˜¯ä¸€ä¸ªé€‰æ‹©è¦æ ‡è®°æ ·æœ¬çš„é‡è¦å‚è€ƒã€‚å¦‚æœæœ‰ä¸¤ä¸ªç›¸ä¼¼çš„æ ·æœ¬ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦å°†ä»–ä»¬éƒ½æ ‡è®°ã€‚</p><p>æ—¶é—´ä¸Šç›¸é‚»çš„æ ·æœ¬å¾€å¾€ä¹Ÿæ˜¯ç›¸ä¼¼çš„ã€‚</p><p>å…·ä½“çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¯¹æ‰€æœ‰æ ·æœ¬æŒ‰ç…§<strong>Uncertainty</strong>æ’åºï¼Œç„¶åè¿›è¡Œä¸€æ¬¡æ‰«æï¼Œå¦‚æœå½“å‰æ ·æœ¬åœ¨å€™é€‰é›†ä¸­æŸä¸ªæ ·æœ¬çš„<strong>Context</strong>ä¹‹ä¸­ï¼Œæˆ‘ä»¬åˆ™å¿½ç•¥å½“å‰æ ·æœ¬ï¼Œå› ä¸ºè¿™ä»£è¡¨å½“å‰æ ·æœ¬å’Œå€™é€‰é›†ä¸­çš„é‚£ä¸ªæ ·æœ¬æ˜¯ç›¸ä¼¼çš„ã€‚å¦‚æœä¸åœ¨<strong>Context</strong>ä¹‹ä¸­ï¼Œæˆ‘ä»¬åˆ™å°†è¯¥æ ·æœ¬åŠ å…¥å€™é€‰é›†ä¸­ã€‚</p><p>åˆ¤æ–­æ˜¯å¦åœ¨æŸä¸ªæ ·æœ¬çš„<strong>Context</strong>ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç›´æ¥åˆ¤æ–­æ˜¯å¦è½åœ¨åŒºé—´<span class="math inline">\([t-\alpha,t+\alpha]\)</span>ä¸­å°±æ˜¯äº†ã€‚</p><p><img src="https://i.loli.net/2020/06/25/nci9PvGDEdjky5R.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä¸»åŠ¨å­¦ä¹ æ¨¡å—çš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/RqonKfQS3IWw6Gb.png" srcset="/img/loading.gif" style="zoom: 80%;" /></p><h1 id="experiments">Experiments</h1><p>åœ¨å®éªŒéƒ¨åˆ†ï¼Œä½œè€…è¯•å›¾å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</p><ol type="1"><li>ATADçš„æ•ˆæœå¦‚ä½•ï¼Ÿ</li><li>è¿ç§»å­¦ä¹ æ¨¡å—çš„æœ‰æ•ˆæ€§å¦‚ä½•ï¼Ÿ</li><li>ä¸»åŠ¨å­¦ä¹ æ¨¡å—çš„æœ‰æ•ˆæ€§å¦‚ä½•ï¼Ÿ</li><li>ATADåœ¨åŸºäºå…¬å¼€æ•°æ®æ—¶å¯¹å…¬å¸å†…éƒ¨æ•°æ®æ£€æµ‹æ•ˆæœå¦‚ä½•ï¼Ÿ</li></ol><h2 id="dataset-and-setup">Dataset and Setup</h2><p>ä¸‹è¡¨æ˜¯ç”¨åˆ°çš„æ•°æ®é›†çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼š</p><p><img src="https://i.loli.net/2020/06/25/HDNGCrYOxezLwaB.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="evaluation-metric">Evaluation Metric</h2><p>è¯„æµ‹æ ‡å‡†ä½¿ç”¨çš„æ˜¯F1-scoreï¼š <span class="math display">\[F1=\frac{2\cdot P\cdot R}{P+R}, \space P=\frac{TP}{TP+FP}, \space R=\frac{TP}{TP+FN}\]</span></p><h2 id="results">Results</h2><h3 id="rq1-how-effective-is-atad">RQ1: How effective is ATAD?</h3><p>BaselineåŒ…æ‹¬å­¤ç«‹æ£®æ—ã€K-Sigmaã€S-H-ESDå’Œéšæœºæ£®æ—ã€‚</p><p>æœ€ç»ˆç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/HMneBzlkR7Qg4TN.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä¸ºäº†è¯„æµ‹ATADåˆ©ç”¨æ ‡ç­¾çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†RFåœ¨è¾¾åˆ°å’ŒATADç›¸ä¼¼F1 scoreæƒ…å†µä¸‹æ‰€éœ€æ ‡ç­¾çš„æ•°é‡ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/fcoXhCL43yVwYes.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="rq2-how-effective-is-the-transfer-learning-component">RQ2: How effective is the Transfer Learning Component?</h3><p>æˆ‘ä»¬ä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢æ¥æ¢ç©¶æ¨¡å‹è¿ç§»çŸ¥è¯†çš„èƒ½åŠ›ï¼š</p><ul><li>ä½¿ç”¨æ–‡ä¸­æ‰€ç”¨åˆ°çš„ç‰¹å¾çš„é‡è¦æ€§</li><li>æœ¬æ¨¡å‹è¿ç§»çŸ¥è¯†çš„èƒ½åŠ›</li></ul><p>å¯¹äºç¬¬ä¸€ç‚¹ï¼Œä½œè€…æå‡ºä¼ ç»Ÿçš„æ–¹æ³•ä¸€èˆ¬åªæå–äº†ç»Ÿè®¡ç‰¹å¾ï¼Œè€Œæœ¬æ–‡è¿˜æå–äº†å¤šç§å…¶ä»–ç‰¹å¾ã€‚ä½œè€…å¯¹æå–ä¸åŒç‰¹å¾è¿›è¡Œäº†æ¯”è¾ƒè¯•éªŒï¼Œç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/QV2eWzoOxGS6qJd.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜å±•ç¤ºäº†ä¸åŒæ•°æ®é›†ä¸‹å‰10æœ‰æ•ˆçš„ç‰¹å¾ï¼š</p><p><img src="https://i.loli.net/2020/06/25/QXYcP9V3xmJeIq5.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>å¯¹äºç¬¬äºŒç‚¹ï¼Œä½œè€…æ¯”è¾ƒäº†æ˜¯å¦ä½¿ç”¨æ–‡ä¸­çš„é¢†åŸŸé€‚åº”ç®—æ³•CORALï¼Œåœ¨è¾¾åˆ°ç›¸ä¼¼F1 scoreä¸‹æ‰€éœ€çš„æ ‡ç­¾æ•°ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/JKFf4XngPBdGm3V.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="rq3-how-effective-is-the-active-learning-component">RQ3: How effective is the Active Learning component?</h3><p>ä¸ºäº†éªŒè¯æœ¬æ–‡æ‰€ç”¨çš„ä¸»åŠ¨å­¦ä¹ çš„æœ‰æ•ˆæ€§ï¼Œä½œè€…è¿›è¡Œäº†å¯¹æ¯”è¯•éªŒã€‚ç¬¬ä¸€ä¸ªæ¨¡å‹ (Supervised model) ä½¿ç”¨å…¨éƒ¨æ ‡ç­¾ä½†ä¸ä½¿ç”¨è¿ç§»å­¦ä¹ è®­ç»ƒï¼Œç¬¬äºŒä¸ª (NaÃ¯ve) ä¸ºåªä½¿ç”¨ä¸»åŠ¨å­¦ä¹ è€Œä¸ä½¿ç”¨è¿ç§»å­¦ä¹ ï¼Œç¬¬ä¸‰ä¸ªä¸ºæœ¬æ–‡æå‡ºçš„æ¨¡å‹ã€‚ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸ºäº†è¾¾åˆ°ç›¸ä¼¼çš„æ€§èƒ½ï¼Œä¸åŒæ¨¡å‹éœ€è¦çš„æ ‡ç­¾æ•°ã€‚</p><p><img src="https://i.loli.net/2020/06/25/jcXphwBmR8J6SeU.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä¸‹è¡¨å±•ç¤ºäº†ä½¿ç”¨ä¸åŒä¸»åŠ¨å­¦ä¹ ç­–ç•¥ (U - conventional uncertainty method, UCD - æœ¬æ–‡ä½¿ç”¨çš„æ–¹æ³•, random - éšæœºé€‰æ‹©) è¿›è¡Œæ ‡è®°å¾—åˆ°çš„ç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/pe24P9gFJfQVrKM.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>åŒæ—¶ä½œè€…è¿˜å¯¹ä¸åŒ<span class="math inline">\(\alpha\)</span>çš„é€‰æ‹©è¿›è¡Œäº†å®éªŒï¼š</p><p><img src="https://i.loli.net/2020/06/25/ifRhv85IqaVw7gx.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="rq4-how-effective-is-atad-in-detecting-anomalies-in-a-companys-local-dataset-based-on-public-datasets">RQ4: How effective is ATAD in detecting anomalies in a companyâ€™s local dataset based on public datasets?</h3><p>è¿™é‡Œä½œè€…å¯¹æ¯”äº†ä¸åŒæ–¹æ³•åœ¨å¾®è½¯å†…éƒ¨æ•°æ®é›†ä¸Šçš„ç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/5oi3rcGugKXmTha.png" srcset="/img/loading.gif" style="zoom:67%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Transfer Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Learning Representations of Ultrahigh-dimensional Data for Random Distance-based Outlier Detection</title>
    <link href="/2020/05/06/Learning-Representations-of-Ultrahigh-dimensional-Data-for-Random-Distance-based-Outlier-Detection/"/>
    <url>/2020/05/06/Learning-Representations-of-Ultrahigh-dimensional-Data-for-Random-Distance-based-Outlier-Detection/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡æå‡ºäº†ä¸€ç§é’ˆå¯¹é«˜ç»´æ•°æ®å¼‚å¸¸æ£€æµ‹çš„è¡¨ç¤ºå­¦ä¹ æ–¹æ³•ã€‚æ–‡ä¸­æå‡ºäº†<strong>RAMODO</strong>æ¡†æ¶ï¼Œä¸€ç§åŸºäºæ’åºçš„ç»“åˆè¡¨ç¤ºå­¦ä¹ å’Œå¼‚å¸¸æ£€æµ‹çš„æ— ç›‘ç£æ¡†æ¶ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒåŸºäº<strong>RAMODO</strong>ï¼Œæ–‡ä¸­è¿˜æå‡ºäº†åŸºäºæ­¤æ¡†æ¶çš„æ¨¡å‹<strong>REPEN</strong>ã€‚</p><p><a href="https://arxiv.org/pdf/1806.04808" target="_blank" rel="noopener">PaperğŸ“°</a></p><h1 id="proposed-method">Proposed Method</h1><h2 id="the-proposed-framework-ramodo">The Proposed Framework: <strong>RAMODO</strong></h2><h3 id="problem-statement">Problem Statement</h3><p>æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºé«˜ç»´æ•°æ®å­¦ä¹ ä½ç»´è¡¨ç¤ºï¼ŒåŒæ—¶åœ¨å­¦åˆ°çš„ä½ç»´è¡¨ç¤ºä¸­èƒ½å¤Ÿæ›´å¥½åœ°è¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€‚è®¾æœ‰æ•°æ®é›†<span class="math inline">\(\mathcal{X}=\{\mathbf x_1,\mathbf x_2,\cdots, \mathbf x_N\}\)</span> (<span class="math inline">\(\mathbf x_i\in \mathbb{R}^D\)</span>) å’Œä¸€ä¸ªåŸºäºéšæœºè·ç¦»çš„å¼‚å¸¸æ£€æµ‹å™¨<span class="math inline">\(\phi:\mathcal{X}\mapsto \mathbb{R}\)</span>ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªè¡¨ç¤ºå‡½æ•°<span class="math inline">\(f:\mathcal{X}\mapsto\mathbb{R}^M (M\ll D)\)</span>ä½¿å¾—å¯¹äºæ‰€æœ‰å¼‚å¸¸æ ·æœ¬<span class="math inline">\(\mathbf x_i\)</span>å’Œæ­£å¸¸æ ·æœ¬<span class="math inline">\(\mathbf x_j\)</span>éƒ½æœ‰<span class="math inline">\(\phi(f(\mathbf x_i))&gt;\phi(f(\mathbf x_j))\)</span>ã€‚</p><h3 id="ranking-model-based-representation-learning-framework">Ranking Model-based Representation Learning Framework</h3><p><strong>RAMODO</strong>åŸºäº<em>pairwise ranking model</em>ã€‚ç¬¬ä¸€æ­¥æ˜¯é€šè¿‡ä¸€å®šçš„é¢„å¤„ç†ç®—æ³•ï¼ˆåŸæ–‡ä¸­ç§°ä¸º<em>outlier thresholding</em>ï¼‰å°†æ•°æ®åˆ’åˆ†ä¸ºinlierå€™é€‰é›†å’Œoutlierå€™é€‰é›†ï¼›ç¬¬äºŒæ­¥é€šè¿‡éšæœºä»inlierå€™é€‰é›†é‡‡æ ·<span class="math inline">\(n\)</span>ä¸ªæ ·æœ¬ç”Ÿæˆquery set <span class="math inline">\((\mathbf x_i,\cdots,\mathbf x_{i+n-1})\)</span>ï¼Œä»inlierå€™é€‰é›†é‡‡æ ·ä¸€ä¸ªæ ·æœ¬ç”Ÿæˆ<em>positive example</em> <span class="math inline">\((\mathbf x^+)\)</span>ï¼Œä»outlierå€™é€‰é›†é‡‡æ ·ä¸€ä¸ªæ ·æœ¬ç”Ÿæˆ<em>negative example</em> <span class="math inline">\((\mathbf x^-)\)</span>ï¼Œå°†ä¸‰è€…ç»„åˆç”Ÿæˆ <em>metatriplet</em> <span class="math inline">\(T=(&lt;\mathbf x_i,\cdots,\mathbf x_{i+n-1}&gt;,\mathbf x^+,\mathbf x^-)\)</span>ï¼›ç¬¬ä¸‰æ­¥é€šè¿‡ç¥ç»ç½‘ç»œ<span class="math inline">\(f\)</span>å­¦ä¹ è¡¨ç¤ºï¼›ç¬¬å››æ­¥é€šè¿‡<em>outlier score-based ranking loss</em> <span class="math inline">\(L(\phi(f(\mathbf x^+)|&lt;f(\mathbf x_i),\cdots,f(\mathbf x_{i+n-1})&gt;),\phi(f(\mathbf x^-)|&lt;f(\mathbf x_i),\cdots,f(\mathbf x_{i+n-1})&gt;))\)</span>æ¥è¿›è¡Œä¼˜åŒ–ï¼Œå…¶ä¸­<span class="math inline">\(\phi(\cdot|\cdot)\)</span>ä¸ºåŸºäºè·ç¦»çš„å¼‚å¸¸æ£€æµ‹å™¨ã€‚</p><p><img src="https://i.loli.net/2020/06/25/4I7fx5ZjBhueUDz.png" srcset="/img/loading.gif" /></p><h2 id="a-ramodo-instance-repen">A <strong>RAMODO</strong> Instance: <strong>REPEN</strong></h2><p><strong>REPEN</strong>ä¸º<strong>RAMODO</strong>çš„å®ä¾‹æ¨¡å‹ï¼Œä½¿ç”¨Spä½œä¸ºå¼‚å¸¸æ£€æµ‹å™¨ã€‚</p><h3 id="outlier-thresholding-using-state-of-the-art-detectors-and-cantellis-inequality">Outlier Thresholding Using State-of-the-art Detectors and Cantelli's Inequality</h3><p>ç¬¬ä¸€æ­¥ä½¿ç”¨Spä½œä¸ºåŸºç¡€è·å¾—åˆå§‹anomaly scoreï¼š</p><blockquote><p><strong>Definition 1</strong> (<em>Sp-based Outlier Scoring</em>). ç»™å®šæ ·æœ¬<span class="math inline">\(x_i\)</span>ï¼ŒSp ä»¥ä»¥ä¸‹æ–¹å¼å®šä¹‰è¯¥æ ·æœ¬çš„å¼‚å¸¸ç¨‹åº¦ï¼š <span class="math display">\[r_i=\frac{1}{m}\sum\limits_{j=1}^m nn\_dist(\mathbf x_i|\mathcal{S}_j)\]</span> å…¶ä¸­<span class="math inline">\(\mathcal S_j\subset \mathcal X\)</span>ä¸ºæ•°æ®é›†éšæœºé‡‡æ ·çš„å­é›†ï¼Œ<span class="math inline">\(m\)</span>ä¸ºé›†æˆå¤§å°ï¼Œ<span class="math inline">\(nn_dist(\cdot|\cdot)\)</span>ä¸º<span class="math inline">\(\mathcal S_j\)</span>ä¸­æœ€è¿‘é‚»å±…çš„è·ç¦»ã€‚</p></blockquote><p>æ¥ç€é€šè¿‡<em>Cantelli's Inequality</em>æ¥å®šä¹‰<em>Pseudo Outlier</em>ï¼š</p><blockquote><p><strong>Definition 2 </strong>(<em>Cantelli's Inequality-based Outlier Thresholding</em>). ç»™å®šå¼‚å¸¸åˆ†æ•°å‘é‡<span class="math inline">\(\mathbf r\in\mathbb R^N\)</span>ï¼Œæ›´é«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ›´é«˜çš„å¯èƒ½æ€§ä¸ºå¼‚å¸¸ï¼Œè®¾<span class="math inline">\(\mu\)</span>å’Œ<span class="math inline">\(\delta^2\)</span>åˆ†åˆ«ä¸ºå‡å€¼å’Œæ–¹å·®ï¼Œ<em>Outlier</em>å€™é€‰é›†ç”±ä»¥ä¸‹æ–¹å¼ç¡®å®šï¼š <span class="math display">\[\mathcal{O}=\{\mathbf x_i|r_i \geq \mu + \alpha\delta\}, \space\forall \mathbf x_i\in\mathcal X, \space r_i\in\mathbf r\]</span> å…¶ä¸­<span class="math inline">\(\alpha\geq 0\)</span>ä¸ºè‡ªå®šä¹‰çš„é˜ˆå€¼ã€‚</p></blockquote><p><em>Inlier</em>å€™é€‰é›†<span class="math inline">\(\mathcal I=\mathcal X\backslash \mathcal O\)</span>ã€‚</p><h3 id="triplet-sampling-based-on-outlier-scores">Triplet Sampling Based on Outlier Scores</h3><p>é¦–å…ˆï¼Œä»<span class="math inline">\(\mathcal I\)</span>é‡‡æ ·ä¸€å®šæ•°é‡çš„æ ·æœ¬ç»„æˆ<em>query set</em>ï¼Œæ¯ä¸ªæ ·æœ¬è¢«é‡‡æ ·çš„æ¦‚ç‡ä¸å…¶å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°æœ‰å…³ï¼š</p><p><span class="math display">\[p(\mathbf x_i)=\frac{\mathbb Z-r_i}{\sum_{t=1}^{|\mathcal I|}[\mathbb Z-r_t]}\]</span></p><p>å…¶ä¸­<span class="math inline">\(\mathbb Z=\sum_{t=1}^{|\mathcal I|}r_t\)</span>ã€‚</p><p>ä¹‹åä»<em>inlier set</em>ä¸­å‡åŒ€éšæœºé‡‡æ ·ä¸€ä¸ª<em>positive sample</em> <span class="math inline">\(\mathbf x^+\)</span>ã€‚æœ€åä»<em>outlier set</em>ä¸­æ ¹æ®ä»¥ä¸‹æ¦‚ç‡é‡‡æ ·ä¸€ä¸ª<em>negative sample</em> <span class="math inline">\(\mathbf x^-\)</span>ï¼š <span class="math display">\[p(\mathbf x_j)=\frac{r_j}{\sum_{t=1}^{|\mathcal O|}r_t}\]</span></p><h3 id="a-shallow-data-representation">A Shallow Data Representation</h3><p>å•å±‚ç¥ç»ç½‘ç»œç”¨æ¥è·å¾—æµ…å±‚çš„è¡¨ç¤ºï¼š</p><blockquote><p><strong>Definition 3 </strong>(<em>Single-layer Fully-connected Representations</em>) ç»™å®šè¾“å…¥<span class="math inline">\(x\)</span>ï¼Œ <span class="math display">\[f_\Theta(\mathbf x)=\{\psi(\mathbf w_1^\top\mathbf x),\psi(\mathbf w_2^\top\mathbf x),\cdots,\psi(\mathbf w_M^\top\mathbf x)\}\]</span> å…¶ä¸­<span class="math inline">\(\psi(\cdot)\)</span>ä¸ºæ¿€æ´»å‡½æ•°ï¼Œ<span class="math inline">\(\mathbf w\)</span>ä¸ºæƒé‡çŸ©é˜µã€‚</p></blockquote><h3 id="ranking-loss-using-random-nearest-neighbor-distance-based-outlier-scores">Ranking Loss Using Random Nearest Neighbor Distance-based Outlier Scores</h3><p>è®¾<span class="math inline">\(\mathcal{Q}=&lt;f_\Theta(\mathbf x_i),\cdots,f_\Theta(\mathbf x_{i+n-1})&gt;\)</span>ä¸º<em>query set</em>ï¼Œç»™å®šæ ·æœ¬<span class="math inline">\(\mathbf x\)</span>ï¼Œ<strong>REPEN</strong>æ ¹æ®æœ€è¿‘é‚»è·ç¦»å®šä¹‰äº†<span class="math inline">\(f_\Theta(\mathbf x)\)</span>çš„å¼‚å¸¸ç¨‹åº¦ï¼š <span class="math display">\[\phi(f_\Theta(\mathbf x)|\mathcal{Q})=nn\_dist(f_\Theta(\mathbf x)|\mathcal Q)\]</span> å› æ­¤ï¼Œç»™å®šä¸‰å…ƒç»„<span class="math inline">\(T=(\mathcal Q,f_\Theta(\mathbf x^+),f_\Theta(\mathbf x^-))\)</span>ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦å¾—è¡¨ç¤º<span class="math inline">\(f(\cdot)\)</span>ä½¿å¾—ï¼š <span class="math display">\[nn\_dist(f_\Theta(\mathbf x^+)|\mathcal Q)&lt;nn\_dist(f_\Theta(\mathbf x^-)|\mathcal Q)\]</span> æŸå¤±å‡½æ•°ï¼š <span class="math display">\[J(\Theta;T)=L(\phi(f_\Theta(\mathbf x^+)|\mathcal Q),\phi(f_\Theta(\mathbf x^-)|\mathcal Q))=\\\max\{0, c+nn\_dist(f_\Theta(\mathbf x^+)|\mathcal Q)-nn\_dist(f_\Theta(\mathbf x^-)|\mathcal Q)\}\]</span> å…¶ä¸­<span class="math inline">\(c\)</span>ä¸ºè¾¹ç•Œå‚æ•°ã€‚ç»™å®šä¸€ç³»åˆ—ä¸‰å…ƒç»„ï¼Œæœ€ç»ˆä¼˜åŒ–ç›®æ ‡å¦‚ä¸‹ï¼š <span class="math display">\[\mathop{\text{arg min}}\limits_{\Theta}\frac{1}{|\mathcal{T}|}\sum\limits_{i=1}^{|\mathcal T|}J(\Theta;T_i)\]</span></p><h3 id="the-algorithm-and-its-time-complexity">The Algorithm and Its Time Complexity</h3><p><img src="https://i.loli.net/2020/06/25/eYtKHBJ7szCgjNa.png" srcset="/img/loading.gif" /></p><h3 id="leveraging-a-few-labeled-outliers-to-improve-triplet-sampling">Leveraging A Few Labeled Outliers to Improve Triplet Sampling</h3><h1 id="experiments">Experiments</h1><h2 id="datasets">Datasets</h2><ul><li>ADï¼šç½‘ç»œå¹¿å‘Šæ£€æµ‹</li><li>LCï¼šè‚ºç™Œç–¾ç—…ç›‘æµ‹</li><li>p53ï¼šå¼‚å¸¸è›‹ç™½è´¨æ´»åŠ¨æ£€æµ‹</li><li>R8ï¼šæ–‡æœ¬åˆ†ç±»</li><li>News20ï¼šæ–‡æœ¬åˆ†ç±»</li><li>URLï¼šå¼‚å¸¸ç½‘å€æ£€æµ‹</li><li>Webspamï¼šPascal Large Scale LearningChallenge</li></ul><h2 id="effectiveness-in-real-world-data-with-thousands-to-millions-of-features">Effectiveness in Real-world Data with Thousands to Millions of Features</h2><p>ä½œè€…åˆ†åˆ«ä½¿ç”¨åŸå§‹ç‰¹å¾å’Œ<em>REPEN</em>å­¦åˆ°çš„ç‰¹å¾è¿›è¡Œå¼‚å¸¸æ£€æµ‹ï¼ŒIMPä»£è¡¨æ€§èƒ½æå‡æ¯”ä¾‹ï¼ŒSUä»£è¡¨åŠ é€Ÿæ¯”ä¾‹ã€‚</p><p><img src="https://i.loli.net/2020/06/25/mvUiE1NzyTwOgV8.png" srcset="/img/loading.gif" /></p><h2 id="comparing-to-state-of-the-art-representation-learning-competitors">Comparing to State-of-the-art Representation Learning Competitors</h2><ul><li><strong>AE: </strong>è‡ªç¼–ç å™¨</li><li><strong>HLLE: </strong> <em>Hessian Locally Linear Embedding</em></li><li><strong>SRP: </strong> <em>Sparse Random Projection</em></li><li><strong>CoP: </strong> <em>Coherent Pursuit</em></li></ul><p><img src="https://i.loli.net/2020/06/25/yQumCRNrHAheJ34.png" srcset="/img/loading.gif" /></p><h2 id="the-capability-of-leveraging-labeled-outliers-as-prior-knowledge">The Capability of Leveraging Labeled Outliers as Prior Knowledge</h2><p><img src="https://i.loli.net/2020/06/25/NOLfKQd2u1JMPtp.png" srcset="/img/loading.gif" /></p><h2 id="sensitivity-test-w.r.t.-the-representation-dimension">Sensitivity Test w.r.t. the Representation Dimension</h2><p><img src="https://i.loli.net/2020/06/25/BoGjY5SEu6vrK3X.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/25/Rlx7Df9Hvsjp2Eg.png" srcset="/img/loading.gif" /></p><p>æ–‡ä¸­æåˆ°äº†å¯¹äºR8ã€URLã€News20è¿™ä¸‰ä¸ªæ•°æ®é›†åœ¨ç»´åº¦<span class="math inline">\(M=1\)</span>çš„æ—¶å€™è¡¨ç°å’Œå…¶ä»–ç»´åº¦ä¸€æ ·å¥½ï¼Œä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯åœ¨è¿™å‡ ä¸ªæ•°æ®é›†ä¸­å¼‚å¸¸éƒ¨åˆ†æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œæ‰€ä»¥1ç»´å°±è¶³å¤Ÿäº†ï¼Œå¦ä¸€ä¸ªè§£é‡Šæ˜¯ä¼˜åŒ–é—®é¢˜ã€‚</p><h2 id="scalability-test">Scalability Test</h2><p><img src="https://i.loli.net/2020/06/25/1JfUclWyFYgLdNp.png" srcset="/img/loading.gif" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Representation Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Deep Weakly-supervised Anomaly Detection</title>
    <link href="/2020/03/30/Deep-Weakly-supervised-Anomaly-Detection/"/>
    <url>/2020/03/30/Deep-Weakly-supervised-Anomaly-Detection/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>åœ¨æ–‡çŒ®ä¸­ï¼Œå› ä¸ºæ ‡æ³¨æˆæœ¬çš„æ˜‚è´µï¼Œæ— ç›‘ç£æ–¹æ³•å æ®äº†å¼‚å¸¸æ£€æµ‹çš„ä¸»è¦ä½ç½®ã€‚ç„¶è€Œï¼Œåœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰å°‘é‡æ ‡ç­¾ï¼Œå¦‚ä½•åˆ©ç”¨è¿™éƒ¨åˆ†æ ‡ç­¾ä¿¡æ¯å°±æˆä¸ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œä½œè€…å°†å…¶ç§°ä¹‹ä¸º<em>anomaly-informed modeling</em>ã€‚ä½œè€…æå‡ºäº†ä¸¤ç‚¹æŒ‘æˆ˜ï¼š</p><ol type="1"><li>å°‘é‡æ ‡ç­¾å¯èƒ½æ— æ³•æä¾›æ‰€æœ‰ç±»å‹å¼‚å¸¸çš„ä¿¡æ¯ï¼›</li><li>å¤§éƒ¨åˆ†æ— æ ‡ç­¾æ•°æ®ä¸ºæ­£å¸¸æ ·æœ¬ï¼Œä½†å…¶ä¸­åŒ…å«å°‘éƒ¨åˆ†å¼‚å¸¸ï¼ˆæ±¡æŸ“ï¼‰ã€‚</li></ol><p>ä½œè€…æå‡ºäº†åŸºäºpairwise relation learningçš„æ–¹æ³•æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚æ–‡ç« çš„ä¸»è¦è´¡çŒ®å¦‚ä¸‹ï¼š</p><ol type="1"><li>æå‡ºäº†ä¸€ç§åŸºäºpairing-based data augmentationå’Œordinal regressionæ¥è¿›è¡Œå¼±ç›‘ç£å¼‚å¸¸æ£€æµ‹çš„æ¡†æ¶</li><li>åŸºäºè¯¥æ¡†æ¶æå‡ºäº†PReNetï¼Œä¸€ç§åŸºäºåŒæµordinal regressionçš„ç½‘ç»œ</li><li>ä»ç†è®ºå’Œå®è·µè§’åº¦åˆ†æäº†æ–¹æ³•çš„æœ‰æ•ˆæ€§</li><li>åœ¨40ä¸ªçœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®Œå–„çš„å®éªŒ</li></ol><h1 id="proposed-method">Proposed Method</h1><h2 id="learning-anomaly-scores-by-predicting-pairwise-relation">Learning Anomaly Scores by Predicting Pairwise Relation</h2><h3 id="problem-formulation">Problem Formulation</h3><p>ç»™å®šæ•°æ®é›†<span class="math inline">\(\mathcal{X}=\{\mathbf{x}_1,\mathbf {x}_2,\cdots,\mathbf{x}_N,\mathbf{x}_{N+1},\cdots,\mathbf{x}_{N+K}\}\)</span>ï¼ŒåŒ…å«ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯äº”æ ‡ç­¾æ•°æ®<span class="math inline">\(\mathcal{U}=\{\mathbf{x}_1,\mathbf {x}_2,\cdots,\mathbf{x}_N\}\)</span>ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æœ‰æ ‡ç­¾å¼‚å¸¸æ•°æ®<span class="math inline">\(\mathcal{A}=\{\mathbf{x}_{N+1},\cdots,\mathbf{x}_{N+K}\}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(K\ll N\)</span>ã€‚æˆ‘ä»¬çš„ä»»åŠ¡ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªæ‰“åˆ†å‡½æ•°<span class="math inline">\(\phi:\mathcal{X}\mapsto \mathbb{R}\)</span>ï¼Œä½¿å¾—å¯¹ä»»ä»»æ„å¼‚å¸¸æ ·æœ¬çš„æ‰“åˆ†é«˜äºä»»æ„æ­£å¸¸æ ·æœ¬ã€‚</p><p>åœ¨è¿™ä¸ªFormulationé‡Œï¼Œä½œè€…å°†å…³ç³»å­¦ä¹ å’Œå¼‚å¸¸æ‰“åˆ†ç»Ÿä¸€äº†èµ·æ¥ã€‚é¦–å…ˆï¼Œè¾“å…¥çš„æ•°æ®é›†ä¸å†æ˜¯åŸå§‹æ ·æœ¬ï¼Œè€Œæ˜¯æ ·æœ¬å¯¹ã€‚æ ·æœ¬å¯¹åŒ…å«ä¸‰ç§ï¼š<em>anomaly-anomaly</em>ï¼Œ<em>anomaly-unlabeled</em>ï¼Œ<em>unlabeled-unlabeled</em>ï¼Œè®°ä¸º<span class="math inline">\(C_{\{\mathbf{a},\mathbf{a}\}}\)</span>ï¼Œ<span class="math inline">\(C_{\{\mathbf{a},\mathbf{u}\}}\)</span>ï¼Œ<span class="math inline">\(C_{\{\mathbf{u},\mathbf{u}\}}\)</span>ã€‚æ¯ä¸€ä¸ªæ ·æœ¬å¯¹åŒ…å«ä¸€ä¸ªæ ‡ç­¾<span class="math inline">\(y\)</span>ï¼Œè¡¨ç¤ºè¯¥pairå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°ï¼Œæ•´ä¸ªè¾“å…¥æ•°æ®é›†<span class="math inline">\(\mathcal{P}=\{\{\mathbf{x}_i,\mathbf{x}_j,y_{ij}\}|\mathbf{x}_i,\mathbf{x}_j\in\mathcal{X} \space\text{and}\space y_{ij}\in\mathbb{N}\}\)</span>ã€‚å› ä¸ºæœ‰<span class="math inline">\(y_{\{\mathbf a,\mathbf a\}}&gt;y_{\{\mathbf a,\mathbf u\}}&gt;y_{\{\mathbf u,\mathbf u\}}\)</span>ï¼Œæ‰€ä»¥å¯¹å…³ç³»çš„å­¦ä¹ ä¹Ÿæ˜¯å¯¹å¼‚å¸¸æ‰“åˆ†çš„å­¦ä¹ ã€‚</p><h3 id="the-instantiated-model-prenet">The Instantiated Model: PReNET</h3><p>ä¸‹å›¾ä¸ºæ¨¡å‹ç¤ºæ„å›¾ï¼Œ<strong>Data Augmentation</strong>æ¨¡å—è´Ÿè´£äº§ç”Ÿpairæ•°æ®ï¼Œ<strong>End-to-End Anomaly Score Learner <span class="math inline">\(\phi\)</span></strong> æ¨¡å—è´Ÿè´£å…³ç³»å­¦ä¹ ï¼ˆå¼‚å¸¸æ‰“åˆ†ï¼‰ã€‚</p><p><img src="https://i.loli.net/2020/06/25/6ZF3w9v1Lux5t4Q.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h4 id="data-argumentation-by-pairing">Data Argumentation by Pairing</h4><p>æ•°æ®çš„äº§ç”Ÿåˆ†ä¸ºä¸¤æ­¥ï¼š</p><ol type="1"><li>ä»<span class="math inline">\(\mathcal{A}\)</span>å’Œ<span class="math inline">\(\mathcal{U}\)</span>ä¸Šéšæœºé‡‡æ ·ï¼Œç»„æˆpairï¼›</li><li>å¯¹æ¯ä¸ªpairæ‰“ä¸Šæ¬¡åº(ordinal class feature) æ ‡ç­¾<span class="math inline">\(\mathbf{y}\)</span>ã€‚</li></ol><p>éƒ¨åˆ†<span class="math inline">\(C_{\{\mathbf{a},\mathbf{u}\}}\)</span>å’Œ<span class="math inline">\(C_{\{\mathbf{u},\mathbf{u}\}}\)</span>å¯èƒ½åŒ…å«å¼‚å¸¸æ±¡æŸ“ï¼Œå› ä¸ºåœ¨<span class="math inline">\(\mathcal{U}\)</span>ä¸­å¯èƒ½ä¼šæœ‰æœªæ ‡è®°çš„å¼‚å¸¸æ ·æœ¬ã€‚</p><h4 id="end-to-end-anomaly-score-learner">End-to-End Anomaly Score Learner</h4><p>ä»¤<span class="math inline">\(\mathcal{Z}\in\mathbb{R}^M\)</span>ä¸ºä¸­é—´è¡¨ç¤ºç©ºé—´ï¼Œé‚£ä¹ˆ<strong>Score Learner</strong>å¯ä»¥æ‹†è§£ä¸ºç‰¹å¾å­¦ä¹ <span class="math inline">\(\psi(\cdot;\Theta_r):\mathcal{X}\mapsto \mathcal{Z}\)</span>å’Œæ‰“åˆ†å‡½æ•°<span class="math inline">\(\eta((\cdot,\cdot);\Theta_s):(\mathcal{Z},\mathcal{Z})\mapsto\mathbb{R}\)</span>ä¸¤éƒ¨åˆ†ï¼Œä¸¤éƒ¨åˆ†éƒ½ç”±ç¥ç»ç½‘ç»œç»„æˆã€‚</p><h4 id="ordinal-regression">Ordinal Regression</h4><p>æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š <span class="math display">\[L\left(\phi((\mathbf x_i,\mathbf x_j);\Theta),y_{ij}\right)=|y_{ij}-\phi((\mathbf x_i,\mathbf x_j);\Theta)|\]</span> é‡‡ç”¨ç»å¯¹å€¼è€Œä¸æ˜¯å‡æ–¹è¯¯å·®çš„åŸå› æ˜¯ä¸ºäº†å‡å°‘å¼‚å¸¸æ±¡æŸ“çš„å½±å“ã€‚é»˜è®¤<span class="math inline">\(y_{\{\mathbf a,\mathbf a\}}=8\)</span>ï¼Œ<span class="math inline">\(y_{\{\mathbf a,\mathbf u\}}=4\)</span>ï¼Œ<span class="math inline">\(y_{\{\mathbf u,\mathbf u\}}=0\)</span>ã€‚æœ€åçš„ä¼˜åŒ–å‡½æ•°å¯ä»¥å†™ä¸ºï¼š <span class="math display">\[\mathop{\text{argmin}}\limits_{\Theta}\frac{1}{|\mathcal{B}|}\sum\limits_{\{\mathbf x_i,\mathbf x_j, y_{ij}\}\in\mathcal{B}}|y_{ij}-\phi((\mathbf x_i,\mathbf x_j);\Theta)|+\lambda R(\Theta)\]</span> <span class="math inline">\(\mathcal{B}\)</span>ä¸ºä¸€ä¸ªbatchï¼Œ<span class="math inline">\(R(\Theta)\)</span>ä¸ºæ­£åˆ™é¡¹ã€‚</p><h3 id="anomaly-detection-using-prenet">Anomaly Detection Using PReNet</h3><h4 id="training-stage">Training Stage</h4><p>è®­ç»ƒæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/oR6uTL3c7HMpwD4.png" srcset="/img/loading.gif" style="zoom: 80%;" /></p><p>ä¸ºäº†ä¿è¯è®­ç»ƒæ ·æœ¬ç±»åˆ«çš„å¹³è¡¡ï¼Œ<span class="math inline">\(\frac{|\mathcal{B}|}{2}\)</span>çš„æ ·æœ¬é‡‡æ ·è‡ª<span class="math inline">\(C_{\{\mathbf u,\mathbf u\}}\)</span>ï¼Œé‡‡æ ·è‡ª<span class="math inline">\(C_{\{\mathbf a,\mathbf u\}}\)</span>å’Œ<span class="math display">\[C_{\{\mathbf a,\mathbf a\}}\]</span>çš„æ ·æœ¬éƒ½å <span class="math inline">\(\frac{|\mathcal{B}|}{4}\)</span>ã€‚</p><h4 id="anomaly-scoring-stage">Anomaly Scoring Stage</h4><p>åœ¨æµ‹è¯•é˜¶æ®µï¼Œç»™å®šæµ‹è¯•æ ·æœ¬<span class="math inline">\(\mathbf{x}_k\)</span>ï¼Œå…ˆåˆ†åˆ«ä»<span class="math inline">\(\mathcal{A}\)</span>å’Œ<span class="math inline">\(\mathcal{U}\)</span>é‡‡æ ·ï¼Œç„¶åå®šä¹‰ä»¥ä¸‹<em>anomaly score</em>ï¼š <span class="math display">\[s_{\mathbf{x}_k}=\frac{1}{2E}\left[\sum\limits_{i=1}^E\phi((\mathbf a_i,\mathbf x_k);\Theta^*)+\sum\limits_{j=1}^E\phi((\mathbf x_k,\mathbf u_j);\Theta^*)\right]\]</span> <span class="math inline">\(\mathbf a_i\)</span>å’Œ<span class="math inline">\(\mathbf u_j\)</span>ä¸ºéšæœºé‡‡æ ·å¾—åˆ°çš„å¼‚å¸¸æ ·æœ¬å’Œæ­£å¸¸æ ·æœ¬ï¼Œé‡‡æ ·å¤§å°<span class="math inline">\(E\)</span>é»˜è®¤ä¸º30ã€‚</p><h1 id="experiments">Experiments</h1><p>å®éªŒéƒ¨åˆ†ä¸»è¦æ˜¯å›ç­”ä»¥ä¸‹å››ä¸ªé—®é¢˜ï¼š</p><ol type="1"><li>åœ¨æœ‰é™çš„æ ‡ç­¾å¼‚å¸¸æƒ…å†µä¸‹ï¼ŒPReNetèƒ½å¦æœ‰æ•ˆåœ°æ£€æµ‹å·²çŸ¥å’ŒæœªçŸ¥çš„å¼‚å¸¸ï¼›</li><li>åœ¨ä¸åŒæ•°é‡æ ‡ç­¾å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼ŒPReNetçš„è¡¨ç°å¦‚ä½•ï¼›</li><li>PReNetå¯¹å¼‚å¸¸æ±¡æŸ“çš„é²æ£’æ€§å¦‚ä½•ï¼›</li><li>PReNetä¸åŒç»„ä»¶çš„é‡è¦æ€§å¦‚ä½•ã€‚</li></ol><h2 id="datasets">Datasets</h2><p>å®éªŒä¸€å…±ç”¨åˆ°äº†40ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­12ä¸ªç”¨æ¥è¯„æµ‹ç®—æ³•æ£€æµ‹å·²çŸ¥çš„å¼‚å¸¸çš„èƒ½åŠ›ï¼ˆå¦‚Table 2æ‰€ç¤ºï¼‰ï¼Œ28ä¸ªç”¨æ¥è¯„æµ‹ç®—æ³•æ£€æµ‹æœªçŸ¥çš„å¼‚å¸¸çš„èƒ½åŠ›ï¼ˆå¦‚Table 3æ‰€ç¤ºï¼‰ã€‚</p><h2 id="competing-methods-and-parameter-settings">Competing Methods and Parameter Settings</h2><p>ç”¨åˆ°çš„baselineæœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p><ul><li>DevNetï¼šåŒä¸€ä½œè€…åœ¨KDD2019æå‡ºçš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶</li><li>Deep support vector data description (DSVDD)ï¼šæ·±åº¦æ”¯æŒå‘é‡æ•°æ®æè¿°</li><li>Prototypical networkï¼š few-shot classificationä¸­çš„ä¸€ç§æ¨¡å‹</li><li>iForestï¼šå­¤ç«‹æ£®æ—</li></ul><h2 id="performance-evaluation-metrics">Performance Evaluation Metrics</h2><p>ç”¨åˆ°çš„Metricsä¸ºAUC-ROCå’ŒAUC-PRã€‚</p><h2 id="detection-of-known-anomalies">Detection of Known Anomalies</h2><p>åœ¨æœ¬å®éªŒä¸­ï¼Œå¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹ï¼ˆ2%ï¼‰å’Œæœ‰æ ‡è®°å¼‚å¸¸æ ·æœ¬çš„æ•°é‡ï¼ˆ60ï¼‰æ˜¯å›ºå®šçš„ï¼Œä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/BfhVE9z8DWipAM6.png" srcset="/img/loading.gif" style="zoom: 80%;" /></p><h2 id="detection-of-unknown-anomalies">Detection of Unknown Anomalies</h2><p>åœ¨æœ¬å®éªŒä¸­ï¼Œå¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹ï¼ˆ2%ï¼‰å’Œæœ‰æ ‡è®°å¼‚å¸¸æ ·æœ¬çš„æ•°é‡ï¼ˆ60ï¼‰åŒæ ·æ˜¯å›ºå®šçš„ï¼Œä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/9GM8XTYiSLUn2Ar.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><p><img src="https://i.loli.net/2020/06/25/4RxrGZWLqHNnXco.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><h2 id="availability-of-known-anomalies">Availability of Known Anomalies</h2><p>æœ¬å®éªŒä¸»è¦æ˜¯ç ”ç©¶ä¸åŒæ•°é‡æ ‡æ³¨å¼‚å¸¸æ ·æœ¬çš„æ¡ä»¶ä¸‹ï¼Œç®—æ³•çš„æ€§èƒ½å¦‚ä½•ã€‚å¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹å›ºå®šï¼ˆ2%ï¼‰ï¼Œæ ‡æ³¨å¼‚å¸¸çš„æ•°é‡ä»15åˆ°120å˜åŒ–ã€‚å®éªŒç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/x4Hf3lU5JO71bvo.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><h2 id="further-analysis-of-prenet">Further Analysis of PReNet</h2><h3 id="tolerance-to-anomaly-contamination-in-unlabeled-data">Tolerance to Anomaly Contamination in Unlabeled Data</h3><p>æœ¬å®éªŒä¸»è¦ç ”ç©¶ä¸åŒå¼‚å¸¸æ±¡æŸ“æ¯”ä¾‹ä¸‹ï¼Œç®—æ³•çš„æ€§èƒ½ï¼Œå³æ¢ç©¶ç®—æ³•å¯¹å¼‚å¸¸æ±¡æŸ“çš„é²æ£’æ€§ã€‚æ ‡æ³¨å¼‚å¸¸æ ·æœ¬çš„æ•°é‡æ’å®šï¼ˆ60ï¼‰ï¼Œå¼‚å¸¸æ±¡æŸ“æ¯”ä¾‹åœ¨<span class="math inline">\(\{0\%,2\%,5\%,10\%\}\)</span>ä¸­å˜åŒ–ã€‚å®éªŒç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/TGYCJUs8LlmreNV.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><h3 id="ablation-study">Ablation Study</h3><p>è¿™ä¸€èŠ‚æ˜¯æ¶ˆèå®éªŒï¼Œåˆ†åˆ«è®¾ç½®äº†å››ä¸ªå˜ä½“ï¼š</p><ul><li><strong>BOR: </strong>æŸå¤±å‡½æ•°æ›¿æ¢æˆäº†äºŒå€¼å›å½’<em>Binary Ordinal Regression</em>ï¼›</li><li><strong>OSNet: </strong>å°†åŒæµç»“æ„ç®€åŒ–ä¸ºå•æµï¼›</li><li><strong>LDM: </strong>å°†ç½‘ç»œä¸­çš„éšè—å±‚å»é™¤ï¼›</li><li><strong>A2H: </strong>åŠ å…¥äº†é¢å¤–çš„éšè—å±‚ï¼Œå¹¶ä¸”åŠ å…¥äº†<span class="math inline">\(\ell_2\)</span>-normé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</li></ul><p><img src="https://i.loli.net/2020/06/25/oR7qlZWfepFT8jK.png" srcset="/img/loading.gif" style="zoom:80%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Discovering Physical Concepts with Neural Networks</title>
    <link href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/"/>
    <url>/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>å¦‚é¢˜ç›®æ‰€ç¤ºï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥å‘æ˜ç‰©ç†æ¦‚å¿µã€‚å…¶æ€è·¯æ˜¯ä»å®éªŒæ•°æ®å­¦åˆ°è¡¨ç¤ºï¼Œç„¶åç”¨å­¦åˆ°çš„è¡¨ç¤ºæ¥å›ç­”ç‰©ç†é—®é¢˜ï¼Œç”±æ­¤ç‰©ç†æ¦‚å¿µå¯ä»¥ä»å­¦åˆ°çš„è¡¨ç¤ºæ¥æå–å‡ºã€‚ä½œè€…è¿›è¡Œäº†4ä¸ªå®éªŒï¼š</p><ol type="1"><li>åœ¨é˜»å°¼æŒ¯åŠ¨å®éªŒä¸­ï¼Œæ¨¡å‹å­¦åˆ°äº†ç›¸å…³çš„ç‰©ç†å‚æ•°ï¼›</li><li>åœ¨è§’åŠ¨é‡å®ˆæ’å®éªŒä¸­ï¼Œæ¨¡å‹é¢„æµ‹äº†è´¨ç‚¹çš„è¿åŠ¨ï¼›</li><li>ç»™å®šé‡å­ç³»ç»Ÿçš„è§‚æµ‹æ•°æ®ï¼Œæ¨¡å‹æ­£ç¡®çš„è¯†åˆ«å‡ºäº†é‡å­çŠ¶æ€çš„è‡ªç”±åº¦ï¼›</li><li>ç»™å®šä»åœ°çƒè§‚æµ‹çš„å¤ªé˜³å’Œç«æ˜Ÿçš„ä½ç½®æ—¶é—´åºåˆ—æ•°æ®ï¼Œæ¨¡å‹å‘ç°äº†æ—¥å¿ƒè¯´æ¨¡å‹ã€‚</li></ol><h1 id="preliminaries">Preliminaries</h1><p>ä½œè€…åœ¨é™„å½•ä¸­å¯¹ç¥ç»ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†è¿›è¡Œäº†ä»‹ç»ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œåªæˆªå–äº†ä¸€äº›ç›¸å¯¹å‰æ²¿çš„å†…å®¹ã€‚</p><p><img src="https://i.loli.net/2020/06/25/yh5Wj9AQmd6nsFC.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="variational-autoencoders">Variational Autoencoders</h2><p>æœ¬æ–‡ç”¨åˆ°çš„æ¨¡å‹åŸºç¡€æ˜¯VAEï¼š</p><p><img src="https://i.loli.net/2020/06/25/zCnYjVEZHdbqAD3.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="representation-learning">Representation Learning</h3><p><em>Representation learning</em>çš„ä¸»è¦ç›®æ ‡æ˜¯å°†æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªéšå‘é‡ (encoder)ï¼Œä¸ºäº†ä¿è¯éšå‘é‡åŒ…å«äº†æ‰€æœ‰ç›¸å…³ä¿¡æ¯ï¼Œ é‚£ä¹ˆåº”è¯¥èƒ½å¤Ÿä»éšå‘é‡è¿˜åŸåŸæ•°æ® (decoder)ã€‚ä¼ ç»Ÿçš„Autoencoderæ˜¯è¿™ä¸ªæ€æƒ³çš„æœ€ç®€å•å®ç°ï¼Œè€ŒVAEåˆ™å°†AEå’Œ<em>Variational Inference</em>ç»“åˆäº†èµ·æ¥ï¼Œæ˜¯ä¸€ç§ç»å…¸çš„ç”Ÿæˆå¼æ¨¡å‹ã€‚ç°åœ¨å¾ˆå¤šç ”ç©¶å…³æ³¨<em>Disentangled Representation Learning</em>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿæ— ç›‘ç£åœ°å­¦ä¹ æ•°æ®ï¼Œä»ä¸­å­¦åˆ°æœ‰æ„ä¹‰çš„è¡¨ç¤ºã€‚</p><h3 id="boldsymbol-beta-vae"><span class="math inline">\(\boldsymbol \beta\)</span>-VAE</h3><p><span class="math inline">\(\beta\)</span>-VAEæ˜¯ä¸€ç§ç‰¹æ®Šçš„VAEï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç»å…¸çš„<em>Disentangled Representation Learning</em>æ¨¡å‹ï¼Œå®ƒå’ŒVAEä¸»è¦çš„åŒºåˆ«æ˜¯å¯¹KLæ•£åº¦ä¸€é¡¹åŠ ä¸Šäº†æƒé‡<span class="math inline">\(\beta\)</span>è¿›è¡Œè°ƒèŠ‚ï¼š <span class="math display">\[C_\beta(x)=-\left[\mathbb{E}_{z\sim p_\phi(z|x)}\log p_\theta(x|z)\right] + \beta D_\text{KL}\left[p_\phi(z|x)\parallel h(z)\right]\]</span> å¦‚æœå‡è®¾<span class="math inline">\(p_\phi(z|x)=\mathcal{N}(\mu,\sigma)\)</span>ï¼Œé‚£ä¹ˆæŸå¤±å‡½æ•°å¯ä»¥è¿›è¡Œç®€åŒ–ï¼š <span class="math display">\[C_\beta(x)=\parallel \hat{x} - x \parallel^2_2-\frac{\beta}{2}\left(\sum\limits_i\log(\sigma_i^2)-\mu_i^2-\sigma_i^2\right)+C\]</span></p><h1 id="network-structure">Network Structure</h1><h2 id="network-structure-scinet">Network Structure: <em>SciNet</em></h2><p>æ¨¡ä»¿ç‰©ç†å­¦å®¶å»ºæ¨¡ç‰©ç†é—®é¢˜çš„è¿‡ç¨‹ï¼Œä½œè€…æå‡ºäº†<em>SciNet</em>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/uWd1lOUFxXgQJ7f.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ç‰©ç†å­¦å®¶åœ¨å»ºæ¨¡ç‰©ç†é—®é¢˜çš„æ—¶å€™ï¼Œå¾€å¾€æ˜¯ä»ä¸€äº›å®éªŒæ•°æ®å‡ºå‘ï¼Œæ ¹æ®ç‰©ç†å¸¸è¯†æå–æ›´åŠ ç²¾ç»ƒçš„è¡¨ç¤ºï¼Œç„¶åç”¨å­¦åˆ°çš„è¡¨ç¤ºæ¥å›ç­”ç‰©ç†é—®é¢˜ã€‚</p><p>å¯¹äºå•çº¯çš„è¾“å…¥è¾“å‡ºé—®é¢˜ï¼Œ<em>SciNet</em>å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ˜ å°„ï¼Œ<span class="math inline">\(F:\mathcal{O}\times\mathcal{Q}\rightarrow\mathcal{A}\)</span>ã€‚<span class="math inline">\(\mathcal{O}\)</span>æ˜¯å¯èƒ½çš„å®éªŒæ•°æ®é›†åˆï¼Œ<span class="math inline">\(\mathcal{Q}\)</span>æ˜¯å¯èƒ½çš„é—®é¢˜é›†åˆï¼Œ<span class="math inline">\(\mathcal{A}\)</span>æ˜¯å¯èƒ½çš„ç­”æ¡ˆé›†åˆã€‚å¯ä»¥å°†å…¶åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼šç¼–ç è¿‡ç¨‹<span class="math inline">\(E:\mathcal{O}\rightarrow\mathcal{R}\)</span>ä»å®éªŒæ•°æ®å­¦åˆ°è¡¨ç¤ºï¼Œè§£ç è¿‡ç¨‹<span class="math inline">\(D:\mathcal{R}\times \mathcal{Q}\rightarrow \mathcal{A}\)</span>æ ¹æ®ç»™å®šçš„é—®é¢˜ä»è¡¨ç¤ºæ¥å›ç­”é—®é¢˜ã€‚ç”±æ­¤ï¼Œ<span class="math inline">\(F(o,q)=D(E(o),q)\)</span>ã€‚åœ¨å®ç°æ–¹é¢ï¼Œ<em>SciNet</em>é‡‡ç”¨çš„æ˜¯å…¨è¿æ¥ç½‘ç»œã€‚</p><h2 id="training-and-testing-scinet">Training and Testing <em>SciNet</em></h2><p>ç”¨æ¥è®­ç»ƒçš„æ•°æ®å½¢å¼ä¸º<span class="math inline">\((o,q,a_{cor}(o,q))\)</span>ï¼Œè§‚æµ‹<span class="math inline">\(o\)</span>å’Œé—®é¢˜<span class="math inline">\(q\)</span>åˆ†åˆ«ä»è§‚æµ‹é›†<span class="math inline">\(\mathcal{O}\)</span>å’Œé—®é¢˜é›†<span class="math inline">\(\mathcal{Q}\)</span>é€‰å‡ºï¼Œ<span class="math inline">\(a_{cor}(o,q)\)</span>ä¸ºå¯¹åº”çš„æ­£ç¡®ç­”æ¡ˆã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å‡†ç¡®åº¦å°½é‡é«˜ï¼Œå¹¶ä¸”å­¦åˆ°<em>minimal uncorrelated representations</em>ã€‚ä¸ºæ­¤ï¼Œä½œè€…é‡‡ç”¨<em>disentangling variational autoencoder</em>ä½œä¸ºæ¨¡å‹ã€‚</p><h1 id="results">Results</h1><p>åœ¨æ–‡ä¸­ï¼Œä½œè€…è¿›è¡Œäº†4ä¸ªå®éªŒæ¥éªŒè¯æ¨¡å‹çš„æœ‰æ•ˆæ€§ã€‚</p><h2 id="damped-pendulum">Damped Pendulum</h2><p>é˜»å°¼æŒ¯åŠ¨å®éªŒï¼š</p><ul><li><p>ä»»åŠ¡ï¼šé¢„æµ‹ä¸€ç»´é˜»å°¼æŒ¯åŠ¨åœ¨ä¸åŒæ—¶é—´çš„ä½ç½®ã€‚</p></li><li><p>ç‰©ç†æ¨¡å‹ï¼š<span class="math inline">\(-kx-b\dot{x}=m\ddot{x}\)</span>ï¼Œ<span class="math inline">\(k\)</span>ä¸ºå¼¹æ€§æ¨¡é‡ï¼Œ<span class="math inline">\(b\)</span>ä¸ºé˜»å°¼ç³»æ•°ï¼Œé€šè§£ä¸º<span class="math inline">\(x(t)=A_0e^{-\frac{b}{2m}t}\cos(\omega t+\delta_0), \space \omega=\sqrt{\frac{k}{m}}\sqrt{1-\frac{b^2}{4mk}}\)</span></p></li><li><p>è§‚æµ‹æ•°æ®ï¼šä½ç½®æ—¶é—´åºåˆ—æ•°æ®<span class="math inline">\(o=[x(t_i)]_{i\in\{1,\cdots,50\}}\in\mathbb{R}^{50}\)</span>ï¼Œæ—¶é—´é—´éš”ç›¸ç­‰ï¼Œè´¨é‡<span class="math inline">\(m=1\text{kg}\)</span>ï¼ŒæŒ¯å¹…<span class="math inline">\(A_0=1\text{m}\)</span>ï¼Œç›¸ä½<span class="math inline">\(\delta_0=0\)</span>ï¼Œå¼¹æ€§æ¨¡é‡<span class="math inline">\(k\in[5,10]\text{kg}/\text{s}^2\)</span>ï¼Œé˜»å°¼ç³»æ•°<span class="math inline">\(b\in[0.5,1]\text{kg}/\text{s}\)</span>ã€‚</p></li><li><p>é—®é¢˜ï¼šé¢„æµ‹<span class="math inline">\(q=t_\text{pred}\in\mathbb{R}\)</span></p></li></ul><p><img src="https://i.loli.net/2020/06/25/yWGzxo4eFKmABul.png" srcset="/img/loading.gif" /></p><p>éšå˜é‡å¤§å°è®¾ç½®ä¸º3ï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/Q4PKa3pm2htekqd.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>(b)ä¸­çš„ä¸‰å¹…å›¾åˆ†åˆ«æ˜¯å­¦åˆ°çš„ä¸‰ä¸ªéšå˜é‡å’Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„å‚æ•°<span class="math inline">\(k\)</span>å’Œ<span class="math inline">\(b\)</span>çš„å…³ç³»å›¾ã€‚ç¬¬ä¸€å¹…å›¾ä¸­å˜é‡<span class="math inline">\(1\)</span>ä¸<span class="math inline">\(b\)</span>å‡ ä¹å®Œå…¨çº¿æ€§ç›¸å…³ï¼Œä¸<span class="math inline">\(k\)</span>åŸºäºçº¿æ€§æ— å…³ï¼Œå˜é‡<span class="math inline">\(2\)</span>åªå’Œ<span class="math inline">\(k\)</span>ç›¸å…³ã€‚å˜é‡<span class="math inline">\(3\)</span>å‡ ä¹ä¸ºä¸€ä¸ªå¸¸æ•°ï¼Œæ•…ä¸æä¾›é¢å¤–çš„ä¿¡æ¯ã€‚ç”±æ­¤ä½œè€…è®¤ä¸º<em>SciNet</em>å­¦åˆ°äº†æˆ‘ä»¬å…³å¿ƒçš„ä¸¤ä¸ªå‚æ•°çš„çŸ¥è¯†ã€‚</p><h2 id="conservation-of-angular-momentum">Conservation of Angular Momentum</h2><p>è§’åŠ¨é‡å®ˆæ’å®éªŒï¼š</p><ul><li>ä»»åŠ¡ï¼šé¢„æµ‹ä¸€ä¸ªç”±é•¿åº¦ä¸º<span class="math inline">\(r\)</span>çš„ç»³å­æ†ç»‘ç€çš„æ—‹è½¬è´¨ç‚¹åœ¨ä½ç½®<span class="math inline">\((0,r)\)</span>ç»ä¸€ä¸ªè‡ªç”±è´¨ç‚¹æ’å‡»åçš„ä½ç½®</li><li>ç‰©ç†æ¨¡å‹ï¼šç»™å®šæ’å‡»ä¹‹å‰çš„è§’åŠ¨é‡ï¼Œè‡ªç”±è´¨ç‚¹æ’å‡»ä¹‹åçš„é€Ÿåº¦ï¼Œæ—‹è½¬è´¨ç‚¹åœ¨æ’å‡»ä¹‹ååœ¨æ—¶é—´<span class="math inline">\(t_\text{pred}^\prime\)</span>çš„ä½ç½®å¯ä»¥ç”±è§’åŠ¨é‡å®ˆæ’å®šå¾‹ç»™å‡ºï¼š</li></ul><p><span class="math display">\[J=m_\text{rot}r^2\omega-rm_\text{free}(\mathbf{v}_\text{free})_x=m_\text{rot}r^2\omega^\prime-rm_\text{free}(\mathbf{v}^\prime_\text{free})_x=J^\prime\]</span></p><ul><li>è§‚æµ‹æ•°æ®ï¼šåœ¨æ’å‡»ä¹‹å‰ä¸¤ä¸ªè´¨ç‚¹çš„ä½ç½®æ•°æ®<span class="math inline">\(o=[(t_i^\text{rot},q_\text{rot}(t_i^\text{rot})),(t_i^\text{free},q_\text{free}(t_i^\text{free}))]_{i\in\{1,\cdots,5\}}\)</span>ï¼Œè´¨é‡ä¸ºå›ºå®šå€¼ï¼ŒåŠå¾„<span class="math inline">\(r\)</span>ä¹Ÿä¸ºå›ºå®šå€¼ã€‚æ•°æ®æ·»åŠ é«˜æ–¯å™ªå£°ã€‚</li><li>é—®é¢˜ï¼šé¢„æµ‹æ’å‡»ä¹‹åè‡ªç”±è´¨ç‚¹åœ¨æ—¶é—´<span class="math inline">\(t_\text{pred}^\prime\)</span>çš„ä½ç½®</li></ul><p><img src="https://i.loli.net/2020/06/25/SKfJLxl1QmuzFt9.png" srcset="/img/loading.gif" /></p><p>å®éªŒå®¤æ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/qimk9ZYBe7UPs3z.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>å®éªŒç»“æœè¡¨æ˜<em>SciNet</em>èƒ½å¤Ÿæ­£ç¡®é¢„æµ‹è´¨ç‚¹æ’å‡»ä¹‹åçš„ä½ç½®ï¼ŒåŒæ—¶å¯¹å™ªéŸ³é²æ£’ã€‚æ ¹æ®(b)ï¼Œéšå˜é‡å’Œè§’åŠ¨é‡å­˜åœ¨çº¿æ€§ç›¸å…³å…³ç³»ï¼Œä½œè€…è®¤ä¸º<em>SciNet</em>å­¦åˆ°äº†å®ˆæ’çš„åŠ¨é‡è¿™ä¸€æ¦‚å¿µã€‚</p><h2 id="representation-of-qubits">Representation of Qubits</h2><p>é‡å­æ¯”ç‰¹å®éªŒï¼š</p><ul><li>ä»»åŠ¡ï¼šé¢„æµ‹åœ¨<span class="math inline">\(n=1,2\)</span>çš„çº¯<span class="math inline">\(n\)</span>é‡å­ä½çŠ¶æ€<span class="math inline">\(\psi\in\mathbb{C}^{2^n}\)</span>ä¸‹ä»»ä½•äºŒè¿›åˆ¶æŠ•å½±æµ‹é‡<span class="math inline">\(\omega\in\mathbb{C}^{2^n}\)</span>çš„æµ‹é‡æ¦‚ç‡ã€‚</li><li>ç‰©ç†æ¨¡å‹ï¼šåœ¨æ‰§è¡Œæµ‹é‡<span class="math inline">\(\omega\in\mathbb{C}^{2^n}\)</span>çš„çŠ¶æ€<span class="math inline">\(\psi\in\mathbb{C}^{2^n}\)</span>ä¸‹æµ‹é‡0çš„æ¦‚ç‡<span class="math inline">\(p(\omega,\psi)\)</span>ç”±<span class="math inline">\(p(\omega,\psi)=|\left&lt;\omega,\psi\right&gt;|^2\)</span>ç»™å®š</li><li>è§‚æµ‹æ•°æ®ï¼šçŠ¶æ€<span class="math inline">\(\psi: o=[p(\alpha_i,\psi)]_{i\in\{i,\cdots,n_1\}}\)</span>çš„æ“ä½œå‚æ•°åŒ–ï¼šè¡¨ç¤ºä¸€ç»„å›ºå®šçš„éšæœºäºŒå…ƒå°„å½±æµ‹é‡å€¼<span class="math inline">\(\mathcal{M}_1=\{\alpha_1,\cdots,\alpha_{n_1}\}\)</span>ï¼ˆä¸€ä¸ªé‡å­ä½<span class="math inline">\(n_1 = 10\)</span>ï¼Œä¸¤ä¸ªé‡å­ä½<span class="math inline">\(n_1 = 30\)</span>ï¼‰</li><li>é—®é¢˜ï¼šå¯¹äºå›ºå®šçš„ä¸€ç»„éšæœºäºŒå…ƒå°„å½±æµ‹é‡<span class="math inline">\(\mathcal{M}_2=\{\beta_1,\cdots,\beta_{n_2}\}\)</span>ï¼Œæµ‹é‡<span class="math inline">\(\omega:q=[p(\beta_i,\omega)]_{i\in\{1,\cdots,n_2\}}\)</span>çš„Operationalå‚æ•°åŒ–ï¼ˆä¸€ä¸ªé‡å­ä½<span class="math inline">\(n_2 = 10\)</span>ï¼Œä¸¤ä¸ªé‡å­ä½<span class="math inline">\(n_2 = 30\)</span>ï¼‰</li></ul><p><img src="https://i.loli.net/2020/06/25/8lY1LBsQCZUwX2I.png" srcset="/img/loading.gif" /></p><p>å®éªŒç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/ZTRKfzb63Jrvk5C.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>é€šè¿‡å®éªŒå‘ç°ï¼Œ<em>SciNet</em>å¯ä»¥åœ¨ä¸æä¾›å…ˆéªŒç‰©ç†çŸ¥è¯†çš„æ¡ä»¶ä¸‹ç¡®å®šè¡¨è¿°çŠ¶æ€<span class="math inline">\(\psi\)</span>æœ€å°çš„å‚æ•°æ•°é‡ã€‚åŒæ—¶ï¼Œ<em>SciNet</em>è¿˜èƒ½åˆ†è¾¨<em>tomographically complete</em>å’Œ<em>tomographically incomplete</em>ã€‚</p><h2 id="heliocentric-model-of-the-solar-system">Heliocentric Model of the Solar System</h2><p>æ—¥å¿ƒè¯´æ¨¡å‹ï¼š</p><ul><li>é—®é¢˜ï¼šåœ¨ç»™å®šåˆå§‹æ¡ä»¶ä¸‹é¢„æµ‹ç›¸å¯¹ä¸åœ°çƒçš„å¤ªé˜³å’Œç«æ˜Ÿçš„è§’åº¦<span class="math inline">\(\theta_M(t)\)</span>å’Œ<span class="math inline">\(\theta_S(t)\)</span></li><li>ç‰©ç†æ¨¡å‹ï¼šåœ°çƒå’Œç«æ˜Ÿå›´ç»•å¤ªé˜³ä»¥ä¸€å®šè§’é€Ÿåº¦åšè¿‘ä¼¼åœ†å‘¨è¿åŠ¨</li><li>è§‚æµ‹æ•°æ®ï¼šç»™å®šåˆå§‹è§’åº¦ï¼Œéšæœºé€‰æ‹©å‘¨å‘¨æœŸçš„å“¥ç™½å°¼çš„è§‚æµ‹æ•°æ®</li></ul><p><img src="https://i.loli.net/2020/06/25/vXl3Ae4RpzibrmY.png" srcset="/img/loading.gif" /></p><p>æ¨¡å‹çš„å®ç°ç¨æœ‰å˜åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/XnsYqcRS6izZGEm.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>è¿™æ ·ï¼Œå¯¹äºä¸åŒæ—¶é—´éƒ½å¯¹åº”ä¸€ä¸ªéšå˜é‡<span class="math inline">\(r(t_i)\)</span>ï¼Œè€Œä¸”éšå˜é‡æ˜¯æ—¶é—´ä¾èµ–çš„ï¼Œå¯¹äºä¸€ä¸ªéšå˜é‡<span class="math inline">\(r(t_i)\)</span>æœ‰ä¸€ä¸ªè§£ç å™¨æ¥è¾“å‡ºç­”æ¡ˆã€‚</p><p><img src="https://i.loli.net/2020/06/25/az3UmkchyFWevP7.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>å®éªŒç»“æœè¡¨ç¤ºï¼Œ<em>SciNet</em>ä¸ä»…æ­£ç¡®é¢„æµ‹äº†å¤ªé˜³å’Œç«æ˜Ÿç›¸å¯¹åœ°çƒçš„è§’åº¦ï¼ŒåŒæ—¶éšå˜é‡æ­ç¤ºäº†ç«æ˜Ÿå’Œåœ°çƒç›¸å¯¹å¤ªé˜³çš„è§’åº¦ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Deep Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Transfer Anomaly Detection by Inferring Latent Domain Representations</title>
    <link href="/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/"/>
    <url>/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>ä½œè€…æå‡ºäº†ä¸€ç§åˆ©ç”¨è¿ç§»å­¦ä¹ æå‡target domainå¼‚å¸¸æ£€æµ‹æ€§èƒ½çš„ç®—æ³•ã€‚æ–‡ä¸­æŒ‡å‡ºç°æœ‰çš„åŸºäºè¿ç§»å­¦ä¹ çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•éœ€è¦å¯¹æ¯ä¸ª target domain è¿›è¡Œå•ç‹¬è®­ç»ƒï¼Œè¿™æ ·åšä¼šå¸¦æ¥å¾ˆå¤§çš„è®¡ç®—å¼€é”€ã€‚æœ¬æ–‡é€šè¿‡<em>latent domain vectors</em>æ¥å®ç°æ— éœ€é‡æ–°è®­ç»ƒçš„å¼‚å¸¸æ£€æµ‹ã€‚<em>latent domain vectors</em>æ˜¯domainçš„ä¸€ç§éšå«è¡¨ç¤ºï¼Œé€šè¿‡è¯¥domainä¸­çš„æ­£å¸¸æ ·æœ¬å¾—åˆ°ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œ<em>anomaly score function</em>é€šè¿‡Auto-encoderå¾—åˆ°ã€‚</p><h1 id="proposed-method">Proposed Method</h1><h2 id="task">Task</h2><p>ä»¤<span class="math inline">\(\mathbf{X}_d^+:=\{\mathbf{x}^+_{dn}\}^{N^+_d}_{n=1}\)</span>ä¸ºç¬¬<span class="math inline">\(d\)</span>ä¸ªdomainçš„å¼‚å¸¸æ ·æœ¬é›†ï¼Œ<span class="math inline">\(\mathbf{x}_{dn}^+\in\mathbb{R}^M\)</span>ä¸ºå…¶ä¸­ç¬¬<span class="math inline">\(n\)</span>ä¸ªæ ·æœ¬çš„<span class="math inline">\(M\)</span>ç»´ç‰¹å¾å‘é‡ï¼Œ<span class="math inline">\(N^+_d\)</span>ä¸ºç¬¬<span class="math inline">\(d\)</span>ä¸ªdomainå¼‚å¸¸æ ·æœ¬çš„æ•°é‡ã€‚</p><p>ç±»ä¼¼çš„ï¼Œä»¤<span class="math inline">\(\mathbf{X}_d^-:=\{\mathbf{x}^-_{dn}\}^{N^-_d}_{n=1}\)</span>ä¸ºç¬¬<span class="math inline">\(d\)</span>ä¸ªdomainçš„æ­£å¸¸æ ·æœ¬é›†ã€‚æˆ‘ä»¬å‡è®¾å¯¹äºæ¯ä¸ªdomainéƒ½æœ‰<span class="math inline">\(N^+_d\ll N^-_d\)</span>ï¼Œä¸”ç‰¹å¾å‘é‡ç»´åº¦éƒ½ä¸º<span class="math inline">\(M\)</span>ã€‚</p><p>å‡è®¾åœ¨ source domain <span class="math inline">\(D_S\)</span>éƒ½æœ‰æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬ï¼Œè®°ä¸º<span class="math inline">\(\{\mathbf{X}^+_d\cup\mathbf{X}_d^-\}^{D_S}_{d=1}\)</span>ï¼Œåœ¨ target domain <span class="math inline">\(D_T\)</span>åªæœ‰æ­£å¸¸æ ·æœ¬<span class="math inline">\(\{\mathbf{X}_d^-\}^{D_S+D_T}_{d=D_S+1}\)</span>ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¾—åˆ°ä¸€ä¸ªå¯¹äº target domain åˆé€‚çš„ domain-specific çš„å¼‚å¸¸æ‰“åˆ†å‡½æ•°ã€‚</p><p><img src="https://i.loli.net/2020/06/25/KW2YgScfVZN7Fjz.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="domain-specific-anomaly-score-function">Domain-specific Anomaly Score Function</h2><p>æˆ‘ä»¬åŸºäºAuto-encoderå®šä¹‰å¼‚å¸¸æ‰“åˆ†å‡½æ•°ã€‚å¯¹äºæ¯ä¸ªdomainï¼Œæˆ‘ä»¬å‡è®¾å­˜åœ¨ä¸€ä¸ª<span class="math inline">\(K\)</span>ç»´çš„éšå˜é‡<span class="math inline">\(\mathbf{z}_d\in\mathbb{R}^K\)</span>ã€‚å¯¹äºç¬¬<span class="math inline">\(d\)</span>ä¸ª domainï¼Œå¼‚å¸¸æ‰“åˆ†å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š <span class="math display">\[s_\theta(\mathbf{x}_{dn}|\mathbf{z}_d):=\parallel\mathbf{x}_{dn}-G_{\theta_G}(F_{\theta_F}(\mathbf{x}_{dn},\mathbf{z}_d))\parallel^2\]</span> å…¶ä¸­å‚æ•°<span class="math inline">\(\theta:=(\theta_G,\theta_F)\)</span>åœ¨æ‰€æœ‰ domain ä¹‹é—´å…±äº«ã€‚</p><h2 id="models-for-latent-domain-vectors">Models for Latent Domain Vectors</h2><p>éšå˜é‡<span class="math inline">\(\mathbf{z}_d\)</span>æ˜¯æ— æ³•è§‚æµ‹åˆ°çš„ï¼Œåªèƒ½é€šè¿‡æ•°æ®æ¥ä¼°è®¡ã€‚é¦–å…ˆ<span class="math inline">\(\mathbf{z}_d\)</span>åœ¨<span class="math inline">\(\mathbf{X}_d^-\)</span>æ¡ä»¶ä¸‹çš„æ¡ä»¶åˆ†å¸ƒå‡è®¾ä¸ºé«˜æ–¯åˆ†å¸ƒï¼š</p><p><span class="math display">\[q_\theta(\mathbf{z}_d|\mathbf{X}_d^-):=\mathcal{N}(\mathbf{z}_d|\mu_\phi(\mathbf{X}_d^-),\text{diag}(\sigma_\phi^2(\mathbf{X}_d^-)))\]</span> å…¶ä¸­å‡å€¼<span class="math inline">\(\mu_\phi(\mathbf{X}_d^-)\in\mathbb{R}^K\)</span>å’Œæ–¹å·®<span class="math inline">\(\sigma^2_\phi(\mathbf{X}_d^-)\in\mathbb{R}^K_+\)</span>ç”±ç¥ç»ç½‘ç»œå»ºæ¨¡ï¼Œä¸”åœ¨æ‰€æœ‰ domain ä¹‹é—´å…±äº«ã€‚åœ¨<span class="math inline">\(\mathbf{X}_d^-\)</span>ç»™å®šçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¾¿èƒ½å¤Ÿæ¨æ–­å‡ºè¯¥ domain å¯¹åº”çš„éšå˜é‡ï¼Œ</p><p><span class="math inline">\(q_\phi\)</span>çš„è¾“å…¥ä¸ºæ­£å¸¸æ ·æœ¬çš„é›†åˆï¼Œæ•…ç¥ç»ç½‘ç»œéœ€è¦æ»¡è¶³<em>permutation invariant</em>ã€‚<span class="math inline">\(\tau(\mathbf{X}_d^-)=\rho(\sum_{n=1}^{N_d^-}\eta(\mathbf{x}_{dn}^-))\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\tau(\mathbf{X}_d^-)\)</span>è¡¨ç¤º<span class="math inline">\(\mu_\phi(\mathbf{X_d^-})\)</span>æˆ–<span class="math inline">\(\ln\sigma_\phi^2(\mathbf{X}_d^-)\)</span>ï¼Œ<span class="math inline">\(\rho\)</span>å’Œ<span class="math inline">\(\eta\)</span>ä¸ºç¥ç»ç½‘ç»œï¼Œ</p><h2 id="objective-function">Objective Function</h2><p>ç›®æ ‡å‡½æ•°ç”±anomaly scoreå‡½æ•°å’Œéšå˜é‡ç»„æˆã€‚ç¬¬<span class="math inline">\(d\)</span>ä¸ªdomainåœ¨å¯¹åº”çš„éšå˜é‡<span class="math inline">\(\mathbf{z}_d\)</span>æ¡ä»¶ä¸‹çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p><p><span class="math display">\[L_d(\theta|\mathbf{z}_d):=\frac{1}{N_d^-}\sum\limits_{n=1}^{N_d^-}s_\theta(\mathbf{x}_{dn}^-|\mathbf{z}_d)-\frac{\lambda}{N_d^-N_d^+}\sum\limits_{n,m=1}^{N_d^-,N_d^+}f(s_\theta(\mathbf{x}_{dm}^+|\mathbf{z}_d)-s_\theta(\mathbf{x}_{dn}^-|\mathbf{z}_d))\]</span></p><p>å…¶ä¸­<span class="math inline">\(\lambda\geq 0\)</span>ä¸ºè¶…å‚æ•°ï¼Œ<span class="math inline">\(f\)</span>ä¸ºsigmoidå‡½æ•°ã€‚å…¬å¼çš„ç¬¬ä¸€é¡¹è¡¨ç¤ºç¬¬<span class="math inline">\(d\)</span>ä¸ªdomainæ­£å¸¸æ ·æœ¬å¯¹åº”çš„<em>anomaly score</em>ã€‚ç¬¬äºŒé¡¹ä¸ºå¯å¾®åˆ†çš„AUCã€‚å¼‚å¸¸æ ·æœ¬çš„<em>anomaly score</em>åº”å½“å¤§äºæ­£å¸¸æ ·æœ¬ï¼Œæ‰€ä»¥å¯¹ä»»ä½•<span class="math inline">\(\mathbf x_{dm}^+\in\mathbf X_d^+, \mathbf x_{dn}^-\in\mathbf X_d^-\)</span>æœ‰<span class="math inline">\(s_\theta(\mathbf x_{dm}^+|\mathbf z_d)&gt;s_\theta(\mathbf x_{dn}^-|\mathbf z_d)\)</span>ã€‚ç¬¬äºŒé¡¹<span class="math inline">\(\frac{\lambda}{N_d^-N_d^+}\sum\limits_{n,m=1}^{N_d^-,N_d^+}f(s_\theta(\mathbf{x}_{dm}^+|\mathbf{z}_d)-s_\theta(\mathbf{x}_{dn}^-|\mathbf{z}_d))\)</span>çš„å–å€¼èŒƒå›´æ˜¯<span class="math inline">\([0,1]\)</span>ï¼Œå½“æ‰€æœ‰çš„<span class="math inline">\(s_\theta(\mathbf{x}_{dm}^+|\mathbf{z}_d)\gg s_\theta(\mathbf{x}_{dm}^-|\mathbf{z}_d)\)</span>æ—¶è¯¥é¡¹ä¸º1ï¼Œå½“æ‰€æœ‰çš„<span class="math inline">\(s_\theta(\mathbf{x}_{dm}^+|\mathbf{z}_d)\ll s_\theta(\mathbf{x}_{dm}^-|\mathbf{z}_d)\)</span>æ—¶è¯¥é¡¹ä¸º0ï¼Œæ‰€ä»¥æœ€å°åŒ–è¯¥é¡¹çš„ç›¸åæ•°ç›¸å½“äºé¼“åŠ±<span class="math inline">\(s_\theta(\mathbf{x}_{dm}^+|\mathbf{z}_d)\gg s_\theta(\mathbf{x}_{dm}^-|\mathbf{z}_d)\)</span>ã€‚</p><p>å› ä¸ºéšå˜é‡<span class="math inline">\(\mathbf z_d\)</span>åŒ…å«ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ç›®æ ‡å‡½æ•°é‡Œè€ƒè™‘è¿™ä¸€ç‚¹ï¼š <span class="math display">\[\mathcal{L}_d(\theta,\phi):=\mathbb{E}_{q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)}\left[L_d(\theta|\mathbf{z}_d)\right]+\beta D_\text{KL}(q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)\parallel p(\mathbf{z_d}))\]</span></p><p>ç¬¬ä¸€é¡¹æ˜¯<span class="math inline">\(L_d(\theta|\mathbf z_d)\)</span>å…³äº<span class="math inline">\(q_\phi(\mathbf z_d|\mathbf X_d^-)\)</span>çš„æœŸæœ›ï¼Œç¬¬äºŒé¡¹æ˜¯<span class="math inline">\(q_\phi(\mathbf z_d|\mathbf X_d^-)\)</span>å’Œ<span class="math inline">\(p(\mathbf z_d):=\mathcal{N}(\boldsymbol 0,\boldsymbol I)\)</span>çš„KLæ•£åº¦ã€‚ç¬¬ä¸€é¡¹å¯ä»¥ç”¨<em>monte carlo</em>ä¼°è®¡<span class="math inline">\(\mathbb{E}_{q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)}\left[L_d(\theta|\mathbf{z}_d)\right]\approx\frac{1}{L}\sum_{\ell=1}^L L_d(\theta|\mathbf z_d^{(\ell)})\)</span>ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜éœ€è¦ç”¨åˆ°<em>reparametrization trick</em>ã€‚</p><p>å¯¹äºç¬¬<span class="math inline">\(d\)</span>ä¸ªtarget domainï¼Œå› ä¸ºæ²¡æœ‰å¼‚å¸¸æ ·æœ¬ï¼ˆå‡è®¾ï¼‰ï¼Œæ‰€ä»¥<span class="math inline">\(L_d(\theta|\mathbf{z}_d):=\frac{1}{N_d^-}\sum\limits_{n=1}^{N_d^-}s_\theta(\mathbf{x}_{dn}^-|\mathbf{z}_d)\)</span>ï¼Œæœ‰ï¼š <span class="math display">\[\mathcal{L}_d(\theta,\phi):=\mathbb{E}_{q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)}\left[\frac{1}{N_d^-}\sum\limits_{n=1}^{N_d^-}s_\theta(\mathbf{x}_{dn}^-|\mathbf{z}_d)\right]+\beta D_\text{KL}(q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)\parallel p(\mathbf{z}_d))\]</span></p><p>æ‰€ä»¥æ€»çš„æŸå¤±å‡½æ•°ä¸ºå„domainå¯¹åº”çš„æŸå¤±å‡½æ•°ä¹‹å’Œ<span class="math inline">\(\mathcal{L}(\theta,\phi):=\sum_{d=1}^{D_S+D_T}\alpha_d\mathcal{L}_d(\theta,\phi)\)</span>ã€‚</p><h2 id="inference">Inference</h2><p>è®­ç»ƒå¥½ä¹‹åï¼Œdomain-specificçš„<em>anomaly score</em>å¯ä»¥ç”±ä¸‹å¼è®¡ç®—å‡ºï¼š</p><p><span class="math display">\[s(\mathbf{x}_{d^\prime}):=\int s_{\theta_*}(\mathbf{x_{d^\prime}}|\mathbf{z}_{d^\prime})q_{\phi_*}(\mathbf{z}_{d^\prime}|\mathbf{X}_{d^\prime}^-)\mathrm{d}\mathbf{z}_{d^\prime}\approx\frac{1}{L}\sum\limits_{\ell=1}^L s_{\theta_*}(\mathbf{x}_{d^\prime}|\mathbf{z}_{d^\prime}^{(\ell)})\]</span></p><h1 id="experiments">Experiments</h1><h2 id="data">Data</h2><p>å®éªŒåŒ…å«äº”ä¸ªæ•°æ®é›†ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆæˆæ•°æ®é›†ã€‚å¦‚ä¸‹å›¾(a)æ‰€ç¤ºï¼Œå›´ç»•<span class="math inline">\((0,0)\)</span>æœ‰<span class="math inline">\(8\)</span>ä¸ªåœˆï¼Œæ¯ä¸ªåœˆåŒ…å«äº†ä¸€ä¸ªå†…åœˆä½œä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œç¬¬<span class="math inline">\(7\)</span>ä¸ªåœˆè¢«é€‰ä¸ºtarget domainï¼Œå…¶ä½™çš„ä¸ºsource domainã€‚ç¬¬äºŒä¸ªæ˜¯MNIST-rï¼Œæ˜¯åŠ å…¥æ—‹è½¬çš„MNISTï¼ŒåŒ…å«6ä¸ªdomainï¼Œå…¶ä¸­æ•°å­—â€œ4â€è¢«é€‰ä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œå…¶ä½™ä¸ºæ­£å¸¸ã€‚ç¬¬ä¸‰ä¸ªä¸ºAnuran Callsï¼ŒåŒ…å«5ä¸ªdomainã€‚ç¬¬å››ä¸ªæ˜¯Landmineï¼Œä¸»è¦ç”¨åœ¨å¤šä»»åŠ¡å­¦ä¹ ä¸­ã€‚ç¬¬äº”ä¸ªæ˜¯IoTï¼Œç½‘ç»œæµé‡æ•°æ®ï¼ŒåŒ…å«8ä¸ªdomainã€‚</p><p><img src="https://i.loli.net/2020/06/25/6WLAfMwJPuN5Ov9.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><h2 id="comparison-methods">Comparison Methods</h2><p>å¯¹æ¯”çš„baselineåŒ…æ‹¬NNï¼ˆæ™®é€šå¤šå±‚ç¥ç»ç½‘ç»œï¼‰ï¼ŒNNAUCï¼ˆåŠ å…¥å¯å¾®åˆ†AUCä½œä¸ºæŸå¤±å‡½æ•°ï¼‰ï¼ŒAEï¼ˆæ™®é€šAutoencoerï¼‰ï¼ŒAEAUCï¼ˆåŠ å…¥å¯å¾®åˆ†AUCçš„AEï¼‰ï¼ŒOSVMï¼ˆå•ç±»æ”¯æŒå‘é‡æœºï¼‰ï¼ŒCCSAï¼ŒTOSVMå’ŒOTLã€‚</p><h2 id="results">Results</h2><p>4ä¸ªçœŸå®æ•°æ®é›†çš„ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/nfkwTVexRNqyFMY.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><p><img src="https://i.loli.net/2020/06/25/QaMskTZALyeiFI1.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><p><img src="https://i.loli.net/2020/06/25/F7VTyeHMz8mK2uJ.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><p><img src="https://i.loli.net/2020/06/25/B32UmgXcwGhZYk1.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><p>è¡¨5ä¸ºè€ƒè™‘éšå˜é‡ä¸ç¡®å®šæ€§çš„ablation studyã€‚å°†åŸæ¥çš„å…¬å¼<span class="math inline">\(\mathcal{L}_d(\theta,\phi):=\mathbb{E}_{q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)}\left[L_d(\theta|\mathbf{z}_d)\right]+\beta D_\text{KL}(q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)\parallel p(\mathbf{z_d}))\)</span>ä¸­<span class="math inline">\(q_\phi(\mathbf z_d|\mathbf X_d^-)\)</span>ç”¨è¿ªåˆ©å…‹é›·åˆ†å¸ƒ<span class="math inline">\(q_\phi(\mathbf z_d|\mathbf X_d^-)=\delta(\mathbf z_d-\mu_\phi(\mathbf X_d^-))\)</span>ä»£æ›¿å¹¶ä¸”å»æ‰KLæ•£åº¦ã€‚</p><p><img src="https://i.loli.net/2020/06/25/yUHcTBzixsMlY7f.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><p>è¡¨6å±•ç¤ºäº†ä¸åŒå¼‚å¸¸æ¯”ä¾‹å¯¹æ•ˆæœçš„å½±å“ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Transfer Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Deep Anomaly Detection with Deviation Networks</title>
    <link href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/"/>
    <url>/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡å…³æ³¨<code>Deep Anomaly Detection</code>ï¼Œä¹Ÿå°±æ˜¯ç”¨æ·±åº¦å­¦ä¹ çš„æ–¹æ³•æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€‚æ–‡ä¸­æåˆ°ç°æœ‰çš„<code>Deep Anomaly Detection</code>å­˜åœ¨ä¸¤ä¸ªå¼Šç«¯ï¼šä¸€ä¸ªæ˜¯é‡‡ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•æ¥è¿›è¡Œç‰¹å¾å­¦ä¹ ï¼Œç„¶åé€šè¿‡ä¸‹æ¸¸ä»»åŠ¡å¾—åˆ°<code>Anomaly Score</code>ï¼Œç›¸æ¯”æ–‡ä¸­End-to-Endçš„<code>Anomaly Score</code>å­¦ä¹ ï¼Œå­˜åœ¨ä¼˜åŒ–ä¸å……åˆ†çš„é£é™©ï¼›å¦ä¸€ä¸ªæ˜¯ç°æœ‰çš„æ–¹æ³•ä¸»è¦æ˜¯æ— ç›‘ç£å­¦ä¹ ï¼Œæ— æ³•åˆ©ç”¨å·²çŸ¥çš„ä¿¡æ¯ï¼ˆå¦‚å°‘é‡æ ‡ç­¾ï¼‰ã€‚ä¸ºæ­¤ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œæ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p><p>æœ¬æ–‡çš„ä¸»è¦è´¡çŒ®å¦‚ä¸‹ï¼š</p><ul><li>æå‡ºäº†ä¸€ç§ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œç›´æ¥å­¦ä¹ <code>Anomaly Score</code>å¹¶ä¸”å¯ä»¥åˆ©ç”¨å·²çŸ¥ä¿¡æ¯ï¼›</li><li>åŸºäºæå‡ºçš„æ¡†æ¶ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ç§å®ä¾‹æ–¹æ³• (DevNet)ã€‚</li></ul><p><img src="https://i.loli.net/2020/06/25/XT7fqQRWEOuocgy.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h1 id="proposed-model">Proposed Model</h1><h2 id="end-to-end-anomaly-score-learning">End-To-End Anomaly Score Learning</h2><h3 id="problem-statement">Problem Statement</h3><p>ä¸ºäº†åŒºåˆ«äºä¼ ç»Ÿçš„ä¸¤é˜¶æ®µå¼‚å¸¸æ£€æµ‹ï¼ˆå…ˆå­¦ä¹ ç‰¹å¾è¡¨ç¤ºï¼Œç„¶ååœ¨å­¦åˆ°çš„ç‰¹å¾ä¸Šå®šä¹‰ä¸€ä¸ª<code>anomaly measure</code>æ¥å¾—åˆ°<code>anomaly score</code>ï¼‰ï¼Œä½œè€…å¯¹ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜é‡æ–°è¿›è¡Œå½¢å¼åŒ–ã€‚</p><p>ç»™å®š<span class="math inline">\(N+K\)</span>ä¸ªæ ·æœ¬<span class="math inline">\(\mathcal{X}=\{\boldsymbol x_1,\boldsymbol x_2,\cdots,\boldsymbol x_N,\boldsymbol x_{N+1},\cdots,\boldsymbol x_{N+K}\}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\boldsymbol x_i\in\mathbb{R}^D\)</span>ï¼Œæ— æ ‡ç­¾æ ·æœ¬é›†<span class="math inline">\(\mathcal{U}=\{\boldsymbol x_1,\boldsymbol x_2,\cdots,\boldsymbol x_N\}\)</span>ï¼Œæœ‰æ ‡ç­¾æ ·æœ¬é›†<span class="math inline">\(\mathcal{K}=\{\boldsymbol x_{N+1},\cdots,\boldsymbol x_{N+K}\}\)</span>ï¼Œä¸”<span class="math inline">\(K\ll N\)</span>ã€‚å¼‚å¸¸æ£€æµ‹çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ª<code>anomaly scoring function</code><span class="math inline">\(\phi:\mathcal{X}\mapsto\mathbb{R}\)</span>ä½¿å¾—<span class="math inline">\(\phi(\boldsymbol x_i)&gt;\phi(\boldsymbol x_j)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\boldsymbol x_i\)</span>ä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œ<span class="math inline">\(\boldsymbol x_j\)</span>ä¸ºæ­£å¸¸æ ·æœ¬ã€‚</p><h3 id="the-proposed-framework">The Proposed Framework</h3><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ç§é€šç”¨å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œæ¨¡å‹æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>æ¨¡å‹æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/ZuE1mb2Ytv6Jdl7.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><p>ä¸»è¦åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ol type="1"><li><em>anomaly scoring network</em>. å›¾ä¸­å·¦è¾¹çš„éƒ¨åˆ†ï¼Œä¸€ä¸ªå‡½æ•°<span class="math inline">\(\phi\)</span>ï¼Œè¾“å…¥æ ·æœ¬<span class="math inline">\(\mathbf{x}\)</span>ï¼Œè¾“å‡º<code>anomaly score</code></li><li><em>reference score generator</em>. å›¾ä¸­å³è¾¹çš„éƒ¨åˆ†ã€‚åªæœ‰ä¸€ä¸ª<em>anomaly scoring network</em>å¹¶ä¸èƒ½è¿›è¡Œè®­ç»ƒï¼Œéœ€è¦è®­ç»ƒçš„ç›®æ ‡ã€‚ä¸ºæ­¤åŠ å…¥<em>reference score generator</em>ï¼Œè¾“å…¥ä¸ºéšæœºé€‰æ‹©çš„<span class="math inline">\(l\)</span>ä¸ªæ­£å¸¸æ ·æœ¬ï¼Œè¾“å‡º<code>reference score</code>ï¼ˆè¿™<span class="math inline">\(l\)</span>ä¸ªæ­£å¸¸æ ·æœ¬<code>anomaly score</code>çš„å‡å€¼ï¼Œè®°ä¸º<span class="math inline">\(\mu_\mathcal{R}\)</span>ï¼‰</li><li><em>deviation loss</em>. <span class="math inline">\(\phi(\mathbf{x})\)</span>ï¼Œ<span class="math inline">\(\mu_\mathcal{R}\)</span>åŠå¯¹åº”çš„æ ‡å‡†å·®<span class="math inline">\(\sigma_\mathcal{R}\)</span>ä½œä¸º<code>deviation loss</code>å‡½æ•°çš„è¾“å…¥ã€‚å› ä¸º<span class="math inline">\(\mu_\mathcal{R}\)</span>å’Œ<span class="math inline">\(\sigma_\mathcal{R}\)</span>å¯¹åº”æ­£å¸¸æ ·æœ¬é›†çš„å‡å€¼å’Œæ–¹å·®ï¼Œé‚£ä¹ˆå¼‚å¸¸æ ·æœ¬çš„<code>anomaly score</code>åº”è¯¥å’Œ<span class="math inline">\(\mu_\mathcal{R}\)</span>å·®åˆ«æ¯”è¾ƒå¤§ï¼Œè€Œæ­£å¸¸æ ·æœ¬åˆ™åº”è¯¥æ¥è¿‘<span class="math inline">\(\mu_\mathcal{R}\)</span>ã€‚</li></ol><h2 id="deviation-networks">Deviation Networks</h2><p>ä¸‹é¢æ˜¯ä¸Šè¿°ä¸‰ä¸ªéƒ¨ä»¶çš„å…·ä½“å®ç°ã€‚</p><h3 id="end-to-end-anomaly-scoring-network">End-To-End Anomaly Scoring Network</h3><p>è®°<span class="math inline">\(\mathcal{Q}\in\mathbb{R}^M\)</span>ä¸ºä¸­é—´è¡¨ç¤ºç©ºé—´ï¼Œ<code>anomaly scoring network</code><span class="math inline">\(\phi(\cdot;\Theta):\mathcal{X}\mapsto\mathbb{R}\)</span>å¯ä»¥å®šä¹‰ä¸ºæ•°æ®è¡¨ç¤ºå­¦ä¹ <span class="math inline">\(\psi(\cdot;\Theta_t):\mathcal{X}\mapsto\mathcal{Q}\)</span>å’Œå¼‚å¸¸åˆ†æ•°å­¦ä¹ <span class="math inline">\(\eta(\cdot;\Theta_s):\mathcal{Q}\mapsto\mathbb{R}\)</span>ä¸¤é˜¶æ®µçš„ç»„åˆï¼Œå…¶ä¸­<span class="math inline">\(\Theta=\{\Theta_t,\Theta_s\}\)</span>ã€‚</p><p><span class="math inline">\(\psi(\cdot;\Theta_t)\)</span>å¯ä»¥ç”¨ä¸€ä¸ª<span class="math inline">\(H\)</span>å±‚ç¥ç»ç½‘ç»œæ¥å®ç°ï¼š <span class="math display">\[\mathrm{q}=\psi(\mathbf{x};\Theta_t)\]</span> å…¶ä¸­<span class="math inline">\(\mathbf{x}\in\mathcal{X}\)</span>ï¼Œ<span class="math inline">\(\mathrm{q}\in\mathcal{Q}\)</span>ã€‚</p><p><span class="math inline">\(\eta(\cdot;\Theta_s)\)</span>å¯ä»¥ç”¨ä¸€ä¸ªå•å±‚çš„ç¥ç»ç½‘ç»œæ¥å®ç°ï¼š <span class="math display">\[\eta(\mathrm q;\Theta_s)=\sum\limits_{i=1}^M w_i^oq_i+w_{M+1}^o\]</span> å…¶ä¸­<span class="math inline">\(\mathrm q\in\mathcal Q\)</span>ï¼Œ<span class="math inline">\(\Theta_s=\{\mathbf{w}^o\}\)</span>ã€‚</p><p>æ‰€ä»¥æœ‰ï¼š <span class="math display">\[\phi(\mathbf{x};\Theta)=\eta(\psi(\mathbf{x};\Theta_t);\Theta_s)\]</span></p><h3 id="gaussian-prior-based-reference-scores">Gaussian Prior-based Reference Scores</h3><p>æœ‰ä¸¤ç§æ–¹æ³•æ¥è·å¾—<span class="math inline">\(\mu_\mathcal{R}\)</span>ï¼Œä¸€ç§æ˜¯data-drivenï¼Œä¸€ç§æ˜¯prior-drivenã€‚å¦‚æœæ˜¯data-drivençš„è¯åˆ™é‡‡ç”¨å¦ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œæ–‡ä¸­è¡¨ç¤ºä¸ºäº†æ›´å¥½çš„è§£é‡Šæ€§å’Œè®¡ç®—æ•ˆç‡ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ˜¯prior-drivenã€‚ <span class="math display">\[\begin{align}r_1,r_2,\cdots,r_l\sim \mathcal{N}(\mu,\sigma^2),\\\mu_\mathcal{R}=\frac{1}{l}\sum\limits_{i=1}^l r_i\end{align}\]</span> åœ¨æ–‡ä¸­ï¼Œé‡‡ç”¨çš„prioræ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒã€‚</p><h2 id="z-score-based-deviation-loss">Z-Score Based Deviation Loss</h2><p><em>anomaly scoring network</em>çš„ä¼˜åŒ–ç›®æ ‡å¯ä»¥å®šä¹‰ä¸ºZ-Scoreçš„æ–¹å¼ï¼š <span class="math display">\[dev(\boldsymbol x)=\frac{\phi(\boldsymbol x;\Theta)-\mu_{\mathcal{R}}}{\sigma_{\mathcal{R}}}\]</span> <span class="math inline">\(dev(\boldsymbol x)\)</span>å¯ä»¥çœ‹ä½œæ˜¯æ ·æœ¬åç¦»æ ‡å‡†çš„ç¨‹åº¦ï¼Œè€Œæˆ‘ä»¬è‚¯å®šå¸Œæœ›å¼‚å¸¸æ ·æœ¬åç¦»æ ‡å‡†è¶Šå¤§ï¼Œæ­£å¸¸æ ·æœ¬è¶Šæ¥è¿‘æ ‡å‡†ã€‚æ–‡ä¸­é‡‡ç”¨çš„æŸå¤±å‡½æ•°æ˜¯<code>Contrastive Loss</code>ï¼š <span class="math display">\[L(\phi(\boldsymbol x;\Theta),\mu_\mathcal{R},\sigma_\mathcal{R})=(1-y)|dev(\boldsymbol x)| + y \max(0, a - dev(\boldsymbol x))\]</span> <code>Contrastive Loss</code>çš„ç›´è§‚è§£é‡Šå¯ä»¥çœ‹ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2020/06/25/aPbSipCsk2JwNcD.png" srcset="/img/loading.gif" style="zoom: 33%;" /></p><p>å¯¹äºè´Ÿä¾‹ï¼ˆæ­£å¸¸ï¼‰ï¼Œä¼˜åŒ–è¿‡ç¨‹å°†ä»–ä»¬å°½é‡å‘åŸç‚¹é è¿‘ï¼Œå¯¹äºæ­£ä¾‹ï¼ˆå¼‚å¸¸ï¼‰ï¼Œä¼˜åŒ–è¿‡ç¨‹å°†ä»–ä»¬æ‹‰å‘è¾¹ç•Œã€‚</p><h2 id="the-devnet-algorithm">The DevNet Algorithm</h2><p><code>DevNet</code>çš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/km9H5DoNRbOQ784.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="interpretability-of-anomaly-scores">Interpretability of Anomaly Scores</h2><p>å› ä¸º<em>reference score generator</em>é€‰æ‹©çš„æ˜¯ç¡®å®šçš„é«˜æ–¯åˆ†å¸ƒï¼Œäºæ˜¯å¯ä»¥ç”¨æ¦‚ç‡è®ºç»™å‡ºä¸€äº›è§£é‡Šæ€§ã€‚ä½œè€…ç»™å‡ºäº†ä¸€ä¸ªç»“è®ºï¼Œ</p><blockquote><p><strong>PROPOSITION</strong>ï¼š è®¾<span class="math inline">\(\boldsymbol x\in\mathcal{X}\)</span>ï¼Œ<span class="math inline">\(z_p\)</span>ä¸º<span class="math inline">\(\mathcal{N}(\mu,\sigma^2)\)</span>çš„åˆ†ä½æ•°ï¼Œé‚£ä¹ˆ<span class="math inline">\(\phi(\boldsymbol x)\)</span>åœ¨åŒºé—´<span class="math inline">\(\mu\pm z_p\sigma\)</span>çš„æ¦‚ç‡ä¸º<span class="math inline">\(2(1-p)\)</span>ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼Œå‡è®¾<span class="math inline">\(p=0.95\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(z_{0.95}=1.96\)</span>ï¼Œè¡¨ç¤ºå¼‚å¸¸åˆ†æ•°é«˜äº1.96çš„æ ·æœ¬å°†ä»¥0.95çš„ç½®ä¿¡åº¦ä¸ºå¼‚å¸¸ã€‚</p><h1 id="experiment">Experiment</h1><p>å®éªŒç”¨åˆ°äº†9ä¸ªæ•°æ®é›†ï¼Œ4ä¸ªBaseline (REPENï¼ŒDSVDDï¼ŒFSNETï¼ŒiForest)ï¼Œä»¥åŠROCå’ŒPRæ›²çº¿ä¸¤ç§è¯„æµ‹æ ‡å‡†ã€‚</p><h2 id="effectiveness-in-real-world-data-sets">Effectiveness in Real-world Data Sets</h2><h3 id="experiment-settings">Experiment Settings</h3><p>è¿™ä¸€ä¸ªå®éªŒä¸»è¦æ˜¯ä¸ºäº†éªŒè¯ç®—æ³•åœ¨çœŸå®åœºæ™¯ä¸‹çš„æ•ˆæœï¼Œå³å¤§é‡æ— æ ‡ç­¾æ•°æ®å’Œæå°‘é‡æ ‡ç­¾æ•°æ®ã€‚è®­ç»ƒé›†åŒ…å«ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯æ— æ ‡ç­¾æ•°æ®<span class="math inline">\(\mathcal{U}\)</span>,åŒ…å«<span class="math inline">\(2\%\)</span>çš„å¼‚å¸¸æ ·æœ¬ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æœ‰æ ‡ç­¾æ•°æ®<span class="math inline">\(\mathcal{K}\)</span>ï¼Œç”±éšæœºé‡‡æ ·<span class="math inline">\(0.005\%-1\%\)</span>çš„è®­ç»ƒæ•°æ®å’Œ<span class="math inline">\(0.08\%-6\%\)</span>çš„å¼‚å¸¸æ ·æœ¬ç»„æˆã€‚</p><h3 id="findings">Findings</h3><p>å®éªŒç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/DKqxJROngML8IS2.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><p>ä»ç»“æœä¸Šçœ‹æ¥ï¼Œæœ¬æ–‡æå‡ºçš„æ–¹æ³•åœ¨æ‰€æœ‰æ•°æ®é›†ä¸Šéƒ½æ¯”Baselineå¥½ï¼Œè¯´æ˜<code>DevNet</code>ç«¯åˆ°ç«¯ç›´æ¥ä¼˜åŒ–<code>Anomaly Score</code>çš„æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚</p><h2 id="data-efficiency">Data Efficiency</h2><h3 id="experiment-settings-1">Experiment Settings</h3><p>è¿™ä¸€ä¸ªå®éªŒä¸»è¦æ˜¯ä¸ºäº†æ¢ç©¶åŸºäºæ·±åº¦çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„<em>data efficiency</em>ã€‚å’Œä¸Šä¸€ä¸ªå®éªŒä¸€æ ·ï¼Œæ— æ ‡ç­¾æ•°æ®é›†åŒ…å«<span class="math inline">\(2\%\)</span>çš„å¼‚å¸¸ï¼Œè€Œæœ‰æ ‡ç­¾çš„å¼‚å¸¸æ•°é‡ä»<span class="math inline">\(5\)</span>åˆ°<span class="math inline">\(120\)</span>ä¸ç­‰ã€‚æœ¬å®éªŒè¯•å›¾å›ç­”ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li><code>DevNet</code>çš„<em>data efficiency</em>å¦‚ä½•ï¼Ÿ</li><li>åŸºäºæ·±åº¦çš„æ–¹æ³•åœ¨å¤šå¤§ç¨‹åº¦ä¸Šèƒ½å¤Ÿåˆ©ç”¨æ ‡ç­¾ä¿¡æ¯ï¼Ÿ</li></ul><h3 id="findings-1">Findings</h3><p>åœ¨å‡ ä¸ªåŸºäºæ·±åº¦çš„Baselineä¸­ï¼Œ<code>DevNet</code>çš„æ•ˆæœæ˜¯æœ€å¥½çš„ï¼ŒåŒæ—¶åœ¨æœ‰æ ‡ç­¾å¼‚å¸¸éå¸¸æœ‰é™çš„æƒ…å†µä¸‹ï¼Œ<code>DevNet</code>ä¹Ÿèƒ½å¾ˆå¥½çš„åˆ©ç”¨æ ‡ç­¾ä¿¡æ¯ï¼Œè¾¾åˆ°æ›´å¥½çš„æ•ˆæœã€‚</p><p><img src="https://i.loli.net/2020/06/25/iIWGBPosKCuxbRF.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="robustness-w.r.t.-anomaly-contamination">Robustness w.r.t. Anomaly Contamination</h2><h3 id="experiment-settings-2">Experiment Settings</h3><p>åœ¨ç¬¬ä¸€ä¸ªå®éªŒä¸­ï¼Œæ— æ ‡ç­¾æ•°æ®é›†<span class="math inline">\(\mathcal{U}\)</span>åŒ…å«çš„æ˜¯å›ºå®šçš„å¼‚å¸¸æ¯”ä¾‹<span class="math inline">\(2\%\)</span>ï¼Œè€Œåœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½œè€…æµ‹è¯•äº†ä»<span class="math inline">\(0\%\)</span>åˆ°<span class="math inline">\(20\%\)</span>ä¹‹é—´ä¸åŒå¼‚å¸¸æ¯”ä¾‹æ¥æµ‹è¯•ç®—æ³•çš„é²æ£’æ€§ï¼ˆå³ä½¿<span class="math inline">\(\mathcal{U}\)</span>ä¸­åŒ…å«å¼‚å¸¸ï¼Œç”±äºæ²¡æœ‰æ ‡ç­¾ï¼Œåœ¨è®­ç»ƒçš„æ—¶å€™ä»ç„¶å‡è®¾éƒ½ä¸ºæ­£å¸¸æ¥è¿›è¡Œè®­ç»ƒï¼‰ã€‚æœ¬å®éªŒè¯•å›¾å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li>åŸºäºæ·±åº¦çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„é²æ£’æ€§å¦‚ä½•ï¼Ÿ</li><li>å½“è®­ç»ƒé›†ä¸­å¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹è¾ƒé«˜çš„æ—¶å€™åŸºäºæ·±åº¦çš„æ–¹æ³•èƒ½å¦æ‰“è´¥æ— ç›‘ç£çš„æ–¹æ³•ï¼Ÿ</li></ul><h3 id="findings-2">Findings</h3><p>ä¸‹å›¾ä¸ºå®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/JCnIjLOc84RFP2V.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä»ç»“æœä¸Šæ¥çœ‹ï¼Œ<code>DevNet</code>æ¯”å…¶ä»–åŸºäºæ·±åº¦çš„æ–¹æ³•é²æ£’æ€§æ›´å¥½ï¼ŒåŒæ—¶åœ¨é«˜å¼‚å¸¸æ±¡æŸ“çš„æƒ…å†µä¸‹ä»ç„¶æ¯”çº¯æ— ç›‘ç£æ–¹æ³•æ•ˆæœè¦å¥½ã€‚</p><h2 id="ablation-study">Ablation Study</h2><p>æœ¬å®éªŒè®¾ç½®äº†<code>DevNet</code>çš„ä¸‰ä¸ªå˜ä½“ï¼ˆé»˜è®¤çš„<code>DevNet-Def</code>ä¸ºå•å±‚éšå±‚åŠ ä¸Šä¸€ä¸ªè¾“å‡ºå±‚ï¼‰æ¥è¿›è¡Œæ¶ˆèå®éªŒï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li><code>DevNet-Rep</code>ï¼Œå»æ‰äº†<em>anomaly scoring network</em>ç½‘ç»œçš„è¾“å‡ºå±‚ï¼Œå¯¹åº”<em>end-to-end learning of anomaly scores</em>å’Œ<em>deviation loss</em>ï¼›</li><li><code>DevNet-Linear</code>ï¼Œå»æ‰äº†ç½‘ç»œä¸­çš„éçº¿æ€§å±‚ï¼Œå¯¹åº”<em>learning of non-linear features</em>ï¼›</li><li><code>DevNet-3HL</code>ï¼Œéšå±‚æ•°é‡ä¸º3å±‚ã€‚</li></ul><p>å¯¹æ¯”ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/5LcyAwGMB8gb2UP.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>é€šè¿‡å®éªŒå¯ä»¥å‘ç°ï¼Œ<code>DevNet-Rep</code>è¯´æ˜äº†<em>end-to-end learning of anomaly scores</em>å’Œ<em>deviation loss</em>çš„æœ‰æ•ˆæ€§ï¼Œè€Œ<code>DevNet-Linear</code>è¯´æ˜äº†<em>learning of non-linear features</em>çš„é‡è¦æ€§ã€‚<code>DevNet-3HL</code>è¯´æ˜äº†åŠ æ·±ç½‘ç»œå¹¶ä¸æ€»èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ã€‚</p><h2 id="scalability-test">Scalability Test</h2><p>è¿™ä¸€ä¸ªå®éªŒä½¿ç”¨åˆæˆçš„æ•°æ®æ¥æµ‹è¯•ç®—æ³•å¯¹å¤§è§„æ¨¡æ•°æ®çš„å¤„ç†èƒ½åŠ›ï¼Œåˆ†åˆ«ä»<em>Data Size</em>å’Œ<em>Data Dimensionality</em>ä¸¤æ–¹é¢æ¥æµ‹è¯•ã€‚ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/5gbPdJkB47e3FsV.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>DevNet</code>å¯¹<em>Data Size</em>å¹¶ä¸æ•æ„Ÿï¼ŒåŒæ—¶ï¼Œé¢å¯¹é«˜ç»´æ•°æ®ï¼Œ<code>DevNet</code>ä¹Ÿæ²¡æœ‰è¡¨ç°å‡ºåŠ£åŠ¿ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Deep Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Geant4 å®‰è£…æ•™ç¨‹ä¸è°ƒè¯•ç¯å¢ƒé…ç½®</title>
    <link href="/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    <url>/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>Geant4å®‰è£…çš„æ•™ç¨‹å¾ˆå¤šï¼Œç‰ˆæœ¬éƒ½å¾ˆæ—§äº†ï¼Œè¿™é‡Œå†™ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼ˆ10.6ï¼‰åŸºäºUbuntuçš„å®‰è£…æ•™ç¨‹ï¼Œå¹¶ä¸”å¼€å¯CLion IDEè°ƒè¯•ã€‚</p><h1 id="step-1-download-packages">Step 1: Download Packages</h1><p>é¦–å…ˆè¿›å…¥å®˜ç½‘(<a href="http://geant4.web.cern.ch/support/download" target="_blank" rel="noopener">http://geant4.web.cern.ch/support/download</a>)ä¸‹è½½æºä»£ç ï¼ˆæ¨ètar.gzæ ¼å¼ï¼‰åŠæ•°æ®æ–‡ä»¶ï¼Œè§£å‹ã€‚æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸“é—¨ç”¨æ¥æ”¾<code>Geant4</code>ç›¸å…³æ–‡ä»¶ï¼Œæ–°å»ºdataï¼Œsourceï¼Œbuildæ–‡ä»¶å¤¹ï¼Œå°†Geant4çš„æ–‡ä»¶å¤åˆ¶è¿›æ¥å¹¶æŒ‰å¦‚ä¸‹ç»“æ„ç»„ç»‡ï¼š</p><pre><code class="hljs bash">.â”œâ”€â”€ buildâ”œâ”€â”€ dataâ”‚Â Â  â”œâ”€â”€ G4ABLA3.1â”‚Â Â  â”œâ”€â”€ G4EMLOW7.9â”‚Â Â  â”œâ”€â”€ G4ENSDFSTATE2.2â”‚Â Â  â”œâ”€â”€ G4INCL1.0â”‚Â Â  â”œâ”€â”€ G4NDL4.6â”‚Â Â  â”œâ”€â”€ G4PARTICLEXS2.1â”‚Â Â  â”œâ”€â”€ G4PII1.3â”‚Â Â  â”œâ”€â”€ G4SAIDDATA2.0â”‚Â Â  â”œâ”€â”€ G4TENDL1.3.2â”‚Â Â  â”œâ”€â”€ PhotonEvaporation5.5â”‚Â Â  â”œâ”€â”€ RadioactiveDecay5.4â”‚Â Â  â””â”€â”€ RealSurface2.1.1â””â”€â”€ <span class="hljs-built_in">source</span>    â””â”€â”€ geant4.10.06</code></pre><p><img src="https://i.loli.net/2020/06/25/OuZaAJ3WyEYwsG7.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/25/R5Tmk68AhPbaDHY.png" srcset="/img/loading.gif" /></p><h1 id="step-2-install-dependencies">Step 2: Install Dependencies</h1><p>å®‰è£…ç¼–è¯‘æ‰€éœ€ç¯å¢ƒï¼š</p><pre><code class="hljs bash">sudo apt-get install build-essential cmake</code></pre><p>å®‰è£…ç›¸å…³ä¾èµ–ï¼š</p><pre><code class="hljs bash">sudo apt-get install libgl1-mesa-dev libglu1-mesa-dev libxt-dev libxmu-dev libxi-dev zlib1g-dev libgl2ps-dev libexpat1-dev libxerces-c-dev</code></pre><p>å¦‚æœè¦ç”¨åˆ°QTéœ€è¦å•ç‹¬å®‰è£…QTã€‚</p><h1 id="step-3-compile">Step 3: Compile</h1><p>è¿›å…¥buildæ–‡ä»¶å¤¹ï¼Œç”¨cmakeå‘½ä»¤ï¼š</p><pre><code class="hljs bash">cmake ../<span class="hljs-built_in">source</span>/geant4.10.06/ -DCMAKE_BUILD_TYPE=DEBUG -DGEANT4_USE_GDML=ON -DGEANT4_USE_OPENGL_X11=ON -DGEANT4_USE_RAYTRACER_X11=ON -DGEANT4_BUILD_MULTITHREADED=ON</code></pre><p>å…¶ä¸­<code>../source/geant4.10.06/</code>æ›¿æ¢æˆæ¢æˆï¼ˆå¦‚æœç‰ˆæœ¬ä¸ä¸€æ ·ï¼‰ä½ è‡ªå·±çš„Geant4æºä»£ç æ‰€åœ¨ç›®å½•ï¼Œéœ€è¦QTåˆ™åŠ ä¸Š<code>-DGEANT4_USE_QT=ON</code>ã€‚å¦‚æœä¸éœ€è¦è°ƒè¯•åˆ™æŠŠ<code>-DCMAKE_BUILD_TYPE=DEBUG</code>æ”¹æˆ<code>-DCMAKE_BUILD_TYPE=RELEASE</code>ã€‚<code>-DGEANT4_BUILD_MULTITHREADED=ON</code>æ˜¯å¤šçº¿ç¨‹ï¼Œè§†æƒ…å†µå¼€å¯ã€‚</p><p>å®Œæˆä¹‹åå¼€å§‹ç¼–è¯‘ï¼š</p><pre><code class="hljs bash">make -jX</code></pre><p><code>-jX</code>ä¸ºå¤šçº¿ç¨‹ç¼–è¯‘ï¼Œå¦‚<code>-j8</code>ã€‚</p><p>ç¼–è¯‘å®Œæˆä¹‹åè¿›è¡Œå®‰è£…ï¼š</p><pre><code class="hljs bash">sudo make install</code></pre><h1 id="step-4-configure">Step 4: Configure</h1><p>å®‰è£…çš„é»˜è®¤è·¯å¾„åœ¨<code>/usr/local/share/Geant4-10.6.0</code>ï¼Œå°†ä¸‹è½½çš„æ•°æ®æ–‡ä»¶å¤åˆ¶åˆ°è¯¥æ–‡ä»¶å¤¹ï¼š</p><pre><code class="hljs bash">sudo cp -r ./data/ /usr/<span class="hljs-built_in">local</span>/share/Geant4-10.6.0/</code></pre><p>ä¹‹åï¼Œåœ¨<code>~/.bashrc</code>é‡Œæ·»åŠ <code>/usr/local/share/Geant4-10.6.0/geant4make/geant4make.sh</code>ï¼Œå¦‚æœä½ çš„ç‰ˆæœ¬å’Œæˆ‘çš„ä¸ä¸€æ ·ï¼Œç›¸åº”ä¿®æ”¹å³å¯ã€‚</p><h1 id="step-5-clion-configuration">Step 5: CLion Configuration</h1><p>æœ€åæˆ‘ä»¬æ¥é…ç½®CLionç¯å¢ƒï¼Œé…å¥½ä¹‹åå¯ä»¥åœ¨IDEä¸­ç¼–å†™<code>Geant4</code>ä»£ç ï¼Œè¿˜å¯ä»¥æ–­ç‚¹è°ƒè¯•ï¼Œéå¸¸æ–¹ä¾¿ã€‚å®‰è£…CLionçš„è¿‡ç¨‹è¿™é‡Œçœç•¥ï¼Œæ‰“å¼€ä¸€ä¸ª<code>Geant4</code>è‡ªå¸¦çš„ä¾‹å­æˆ–è€…è‡ªå·±æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæ‰“å¼€<code>Edit Configurations</code>ã€‚</p><p><img src="https://i.loli.net/2020/06/25/W1xXHUqIvofyKQk.png" srcset="/img/loading.gif" /></p><p>éšä¾¿æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¾“å…¥ä¸€ä¸‹å‘½ä»¤è·å–ç¯å¢ƒå˜é‡ï¼š</p><pre><code class="hljs bash">env | grep G4</code></pre><p>åœ¨<code>Environment variables</code>å¡«å…¥åˆšæ‰è·å–çš„ç¯å¢ƒå˜é‡ï¼ˆå¤åˆ¶ä¹‹åæŒ‰ä¸€ä¸‹ç²˜è´´å°±å¯ä»¥äº†ï¼‰ï¼Œç„¶åæŠŠ<code>Working directory</code>è®¾ç½®æˆå½“å‰æ–‡ä»¶å¤¹ã€‚</p><p><img src="https://i.loli.net/2020/06/25/HrslFTOau51y8tX.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/25/5UKaCgvnWjYmNTG.png" srcset="/img/loading.gif" /></p><p>ç°åœ¨å°±å¤§åŠŸå‘Šæˆäº†ï¼</p>]]></content>
    
    
    <categories>
      
      <category>Technical Notes</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Geant4</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Complementary Set Variational Autoencoder for Supervised Anomaly Detection</title>
    <link href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/"/>
    <url>/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>å¯¹äºå¼‚å¸¸æ£€æµ‹é—®é¢˜ï¼Œå¼‚å¸¸çš„æ¨¡å¼æ˜¯å¤šç§å¤šæ ·çš„ã€‚æœ‰ç›‘ç£æ¨¡å‹èƒ½å¤Ÿè¾ƒå¥½åœ°å¤„ç†è®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„æ¨¡å¼ï¼Œæ— ç›‘ç£æ¨¡å‹èƒ½å¤Ÿå¤„ç†è®­ç»ƒé›†ä¸­æœªå‡ºç°è¿‡çš„æ¨¡å¼ï¼Œä½†å¯¹äºè®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å‹å¹¶æ²¡æœ‰å­¦ä¹ ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§æ—¢èƒ½å­¦ä¹ è®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å¼ï¼ŒåŒæ—¶èƒ½å¤„ç†æœªå‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å¼çš„æ–¹æ³•ã€‚</p><h1 id="proposed-model">Proposed Model</h1><h2 id="conventional-vae">Conventional VAE</h2><p>é¦–å…ˆå›é¡¾ä¸€ä¸‹åŸå§‹çš„VAEã€‚</p><p>åŸå§‹VAEä¸­çš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})=\mathbb{E}_{q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})}[\log p(\boldsymbol{x}|\boldsymbol{z};\boldsymbol{\theta})]-\text{KL}[q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi}\parallel p(\boldsymbol{z}))]\]</span> åŸæ–‡ä¸­ä½œè€…è¯æ˜äº†<span class="math inline">\(\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\leq\log p(\boldsymbol{x};\boldsymbol{\theta})\)</span>ï¼Œæ‰€ä»¥<span class="math inline">\(\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\)</span>å¯ä»¥çœ‹ä½œæ˜¯æ•°æ®åˆ†å¸ƒ<span class="math inline">\(p(\boldsymbol{x})\)</span>å¯¹æ•°ä¼¼ç„¶çš„ä¸€ä¸ªä¸‹ç•Œã€‚<span class="math inline">\(\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\)</span>åˆè¢«ç§°ä¸ºè¯æ®ä¸‹ç•Œ (ELBO)ã€‚<span class="math inline">\(\mathbb{E}_{q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})}[\log p(\boldsymbol{x}|\boldsymbol{z};\boldsymbol{\theta})]\)</span>ä¸­çš„æœŸæœ›ä¸€èˆ¬ç”¨è’™ç‰¹å¡æ´›æ¥è¿›è¡Œä¼°è®¡ï¼š <span class="math display">\[\begin{align}\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\simeq&amp; \frac{1}{L}\sum\limits_l\log p(\boldsymbol{x}|\boldsymbol{z}^{(l)};\boldsymbol{\theta})-\text{KL}[q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})\parallel p(\boldsymbol{z})],\\\boldsymbol{z}^{(l)}&amp;\sim q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi}), \space l\in\{1,2,\cdots,L\}\end{align}\]</span> å¯¹äºéšå˜é‡<span class="math inline">\(\boldsymbol{z}\)</span>ï¼Œä¸€èˆ¬å‡è®¾å…ˆéªŒæœä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼ŒåéªŒæœä»å‡å€¼ä¸º<span class="math inline">\(\mu\)</span>ï¼Œæ–¹å·®ä¸º<span class="math inline">\(\sigma^2\)</span>çš„é«˜æ–¯åˆ†å¸ƒï¼Œæ•…KLæ•£åº¦èƒ½ç›´æ¥å†™å‡ºè§£æå¼ï¼š <span class="math display">\[\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\simeq \frac{1}{L}\sum\limits_l\log p(\boldsymbol{x}|\boldsymbol{z}^{(l)};\boldsymbol{\theta})-C(-\frac{1}{2}-\log\sigma+\frac{1}{2}\sigma^2+\frac{1}{2}\mu^2)\]</span> ä½¿ç”¨VAEæ¥åšå¼‚å¸¸æ£€æµ‹é€šå¸¸æ˜¯åœ¨æ­£å¸¸æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼Œåœ¨æ£€æµ‹é˜¶æ®µï¼Œå¦‚æœæ˜¯å¼‚å¸¸æ ·æœ¬ï¼Œé‚£ä¹ˆVAEä¸èƒ½å¾ˆå¥½åœ°é‡æ„å®ƒï¼Œè¿™æ ·ä¼šå¯¼è‡´è¾ƒå¤§çš„é‡æ„è¯¯å·®ã€‚</p><h2 id="prior-distribution-for-anomalies">Prior Distribution for Anomalies</h2><p><img src="https://i.loli.net/2020/06/25/vrxAzRVCtaE3oLc.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>åœ¨åŸå§‹VAEå¼‚å¸¸æ£€æµ‹ä¸­ï¼Œæ— è®ºè¾“å…¥æ ·æœ¬<span class="math inline">\(\boldsymbol{x}\)</span>æ˜¯å¦å¼‚å¸¸ï¼ŒVAEéƒ½ä¼šä½¿å¯¹åº”ç¼–ç çš„åéªŒ<span class="math inline">\(p(\boldsymbol{z}|\boldsymbol{x})\)</span>æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸”æ–½åŠ æ ‡å‡†é«˜æ–¯åˆ†å¸ƒçš„çº¦æŸã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œä½œè€…å¯¹å¼‚å¸¸å’Œæ­£å¸¸æ ·æœ¬å¯¹åº”çš„éšå˜é‡çš„å…ˆéªŒåˆ†å¸ƒåšäº†ä¸åŒå‡è®¾ã€‚é¦–å…ˆï¼Œæ­£å¸¸å…ˆéªŒä¾ç„¶æ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼Œè®°ä¸º<span class="math inline">\(p_n(\boldsymbol{z})\)</span>ã€‚è€Œå¯¹äºå¼‚å¸¸å…ˆéªŒï¼Œä½œè€…è®¤ä¸ºå¼‚å¸¸å³ä¸ºâ€œä¸æ­£å¸¸â€ï¼Œå’Œæ­£å¸¸æ˜¯è¡¥é›†çš„å…³ç³»ã€‚ä½œè€…åœ¨æ–‡ä¸­å®šä¹‰å¼‚å¸¸å…ˆéªŒåˆ†å¸ƒ<span class="math inline">\(p_a(\boldsymbol{z})\)</span>ä¸ºï¼š <span class="math display">\[p_a(\boldsymbol{z})=\frac{1}{Y^\prime}(\max\limits_{\boldsymbol{z}^\prime}p_n(\boldsymbol{z}^\prime)-p_n(\boldsymbol{z}))\]</span></p><p>å…¶ä¸­<span class="math inline">\(Y^\prime\)</span>ä¸ºä½¿<span class="math inline">\(p_a(\boldsymbol{z})\)</span>æˆä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„è°ƒèŠ‚å› å­ã€‚å®é™…ä¸Šï¼Œ<span class="math inline">\(Y^\prime\)</span>å¾€å¾€ä¼šæˆä¸ºæ— é™å¤§ï¼Œå› ä¸º<span class="math inline">\(p(\boldsymbol z)\)</span>åœ¨æ•´ä¸ªå®šä¹‰åŸŸä¸Šéƒ½æœ‰å®šä¹‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…åŠ å…¥äº†<span class="math inline">\(p_w(\boldsymbol z)\)</span>ï¼Œä¸€ä¸ªåœ¨æ¯ä¸ªç»´åº¦éƒ½è¶³å¤Ÿå®½çš„è¾…åŠ©åˆ†å¸ƒï¼š</p><p><span class="math display">\[p_a(\boldsymbol z)=\frac{1}{Y}p_w(\boldsymbol z)\left(\max\limits_{\boldsymbol z^\prime}p_n(\boldsymbol z^\prime)-p_n(\boldsymbol z)\right)\]</span></p><p>å…¶ä¸­<span class="math inline">\(Y\)</span>ä¸ºæœ‰é™çš„å¸¸æ•°ã€‚åœ¨æ–‡ä¸­<span class="math inline">\(p_n(\boldsymbol z)\)</span>å’Œ<span class="math inline">\(p_w(\boldsymbol z)\)</span>éƒ½ä¸ºé«˜æ–¯åˆ†å¸ƒï¼Œé‚£ä¹ˆ<span class="math inline">\(p_a(\boldsymbol z)\)</span>çš„å…·ä½“å½¢å¼ä¸ºï¼š</p><p><span class="math display">\[p_a(\boldsymbol z)=\frac{1}{Y}\mathcal{N}(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2)\{\max\limits_{\boldsymbol z^\prime}\mathcal N(\boldsymbol z^\prime;\boldsymbol 0,\boldsymbol 1)-\mathcal N(\boldsymbol z;\boldsymbol 0,\boldsymbol 1)\}\]</span></p><p>å…¶ä¸­ï¼š</p><p><span class="math display">\[\max\limits_{\boldsymbol z^\prime}\mathcal N(\boldsymbol z^\prime;\boldsymbol 0,\boldsymbol 1)=\frac{1}{\sqrt{2\pi}}\]</span></p><p><span class="math display">\[Y=\int_{-\infty}^{\infty}p_a(\boldsymbol z)\mathrm{d}\boldsymbol z=\frac{1}{\sqrt{2\pi}}\left\{1-\frac{1}{\boldsymbol s^2+1}\right\}\]</span></p><p><span class="math inline">\(\boldsymbol s^2\)</span>ä¸ºè¶…å‚æ•°ï¼Œæ§åˆ¶åˆ†å¸ƒçš„å®½åº¦ã€‚ç”¨æ–‡ä¸­çš„å…ˆéªŒæ›¿æ¢VAEåŸå§‹çš„KLæ•£åº¦ï¼Œå¯å†™ä¸ºï¼š</p><p><span class="math display">\[\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]=\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\frac{\mathcal N(\boldsymbol z;\boldsymbol\mu,\boldsymbol\sigma^2)}{\frac{1}{Y}\mathcal N(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2)\left\{\frac{1}{2\pi}-\mathcal N(\boldsymbol z;\boldsymbol0,\boldsymbol 1)\right\}}\mathrm{d}\boldsymbol z\]</span></p><p>å±•å¼€åï¼š</p><p><span class="math display">\[\begin{align}\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]&amp;=\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\mathcal{N}(\boldsymbol z;\boldsymbol\mu,\boldsymbol\sigma^2)\mathrm{d}\boldsymbol z\\&amp;+\log Y\\&amp;-\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\mathcal{N}(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2)\mathrm{d}\boldsymbol z\\&amp;-\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\left\{\frac{1}{\sqrt{2\pi}}-\mathcal{N}(\boldsymbol z;\boldsymbol 0, \boldsymbol 1)\right\}\mathrm{d}\boldsymbol z\end{align}\]</span></p><p>ä½¿ç”¨æ³°å‹’å±•å¼€ï¼Œ<span class="math inline">\(\log (x+\frac{1}{2\pi})\simeq-\log 2\pi+2\pi x\)</span>ï¼ŒKLæ•£åº¦å¯ä»¥ç”¨ä¸‹å¼ä¼°è®¡ï¼š</p><p><span class="math display">\[\begin{align}\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]&amp;\simeq\sqrt{\frac{2\pi}{\boldsymbol\sigma^2+1}}\exp\left(\frac{-\boldsymbol\mu^2}{2(\boldsymbol\sigma^2+1)}\right)\\&amp;+\frac{\boldsymbol\mu^2+\boldsymbol\sigma^2}{2\boldsymbol s^2}-\log\boldsymbol\sigma+\log\boldsymbol s+\log\left(\sqrt{\boldsymbol s^2+1}-1\right)\\&amp;-\frac{\log(\boldsymbol s^2+1)}{2}+\frac{\log(2\pi)-1}{2}\end{align}\]</span></p><p>ä¸‹å›¾ä¸ºä¸€ç»´æ—¶<span class="math inline">\(p_n(\boldsymbol z)\)</span>å’Œ<span class="math inline">\(p_a(\boldsymbol z)\)</span>çš„ç¤ºä¾‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/QHXo24cKj9uRwzW.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="implementation-of-proposed-method">Implementation of proposed method</h3><p>æ–‡ä¸­ä½¿ç”¨ç¼–ç å™¨è¾“å‡ºçš„åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(\boldsymbol z;\boldsymbol \mu, \boldsymbol \sigma^2)\)</span>ä¸æ ‡å‡†æ­£æ€åˆ†å¸ƒä¹‹é—´çš„KLæ•£åº¦æ¥ä½œä¸ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨æ¯ä¸€è½®çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒåŠ å…¥ä¸€è½®ä½¿ç”¨Anomaly Priorçš„è®­ç»ƒã€‚</p><p><img src="https://i.loli.net/2020/06/25/wrmzADXtsyuJ6EZ.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h1 id="experiments">Experiments</h1><h2 id="mnist">MNIST</h2><p>ä½œè€…è®¾è®¡äº†ä¸¤ä¸ªTaskï¼š</p><ol type="1"><li>Task 1. <span class="math inline">\(N\)</span> vs. <span class="math inline">\(\bar{N}\)</span>. å°†æ‰‹å†™æ•°å­—ä¸­çš„ä¸€ä¸ªä½œä¸ºå·²çŸ¥å¼‚å¸¸ï¼Œå…¶ä»–ä½œä¸ºæ­£å¸¸ï¼Œå¹¶åŠ å…¥å‡åŒ€åˆ†å¸ƒä½œä¸ºæœªçŸ¥çš„å¼‚å¸¸ã€‚</li><li>Task 2. æ‰‹å†™æ•°å­—è¢«åˆ†ä¸º3ç»„ï¼šå·²çŸ¥å¼‚å¸¸ï¼Œæ­£å¸¸ï¼ŒæœªçŸ¥å¼‚å¸¸ã€‚</li></ol><p>ç»†èŠ‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/ifcIxr9zOpEhksA.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>åœ¨å®ç°ä¸Šï¼Œä½¿ç”¨Adamä¼˜åŒ–å™¨ï¼Œ<code>batch_size</code>ä¸º100ï¼Œ<code>epochs</code>ä¸º200ã€‚<code>Encoder</code>å’Œ<code>Decoder</code>éƒ½ç”±ä¸‰å±‚æ„ŸçŸ¥æœºç»„æˆï¼Œè¶…å‚æ•°<span class="math inline">\(s^2\)</span>è®¾ç½®ä¸º400ã€‚è¯„æµ‹æ ‡å‡†ä½¿ç”¨AUC (area under the receiver characteristic curve)ã€‚</p><p>ä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/YTpO98y1ZPmAK3g.png" srcset="/img/loading.gif" style="zoom:67%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>VAE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE</title>
    <link href="/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/"/>
    <url>/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p><a href="https://ieeexplore.ieee.org/abstract/document/8737430/" target="_blank" rel="noopener">è®ºæ–‡ğŸ“ƒ</a></p><p><a href="https://github.com/yantijin/Buzz" target="_blank" rel="noopener">ä»£ç ğŸ“¥</a></p><p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§åˆ©ç”¨å¯¹æŠ—è®­ç»ƒæ¥è¿›è¡Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„æ–¹æ³•<em>Buzz</em>ã€‚ä½œè€…è®¤ä¸ºåœ¨ç°å®ä¸­å¤æ‚çš„KPIæ•°æ®å¤§é‡å­˜åœ¨ï¼Œè¿™ç§æ•°æ®é€šå¸¸å¸¦æœ‰éé«˜æ–¯åˆ†å¸ƒçš„å™ªå£°ï¼ŒåŒæ—¶æ•°æ®åˆ†å¸ƒå¤æ‚ï¼Œå¯¼è‡´ä¸€èˆ¬çš„ç”Ÿæˆå¼æ¨¡å‹æ— æ³•å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„å»ºæ¨¡ï¼Œæ‰€ä»¥ä½œè€…æå‡ºäº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„æ¨¡å‹ã€‚åœ¨æ–‡ä¸­ï¼Œä½œè€…çš„åˆ›æ–°ç‚¹ä¸»è¦æœ‰ä¸‰ä¸ªï¼š</p><ol type="1"><li>ä¸ºäº†å¤„ç†å¤æ‚æ•°æ®ï¼Œå°†æ•°æ®ç©ºé—´åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼Œåœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šè¿›è¡Œè·ç¦»çš„åº¦é‡ï¼›</li><li>é‡‡ç”¨<em>Wasserstein</em>è·ç¦»åº¦é‡æ¨¡å‹å»ºæ¨¡çš„åˆ†å¸ƒå’ŒçœŸå®åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼›</li><li>å»ºç«‹äº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„<em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒVAEä¹‹é—´çš„å…³ç³»ã€‚</li></ol><p><img src="https://i.loli.net/2020/06/25/FwHi7y56njz8R4m.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h1 id="background">Background</h1><h2 id="anomaly-detection">Anomaly Detection</h2><p>å¯¹äºä»»æ„æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼<span class="math inline">\(x_{t-T+1},\cdots,x_t\)</span>ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º<span class="math inline">\(y_t=1\)</span>)ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚<span class="math inline">\(p(y_t=1|x_{t-T+1},\cdots,x_t)\)</span>ã€‚</p><h2 id="vae">VAE</h2><table><thead><tr class="header"><th><strong>Model</strong></th><th><strong>Latent</strong></th><th><strong>Data</strong></th></tr></thead><tbody><tr class="odd"><td><strong><em>Auto-encoder (AE)</em></strong></td><td><code>None</code></td><td><code>L1Loss</code></td></tr><tr class="even"><td><strong><em>Variational Auto-encoder (VAE)</em></strong></td><td><code>KL Divergence</code></td><td><code>Log Likelihood</code></td></tr><tr class="odd"><td><strong><em>Adversarial Auto-encoder (AAE)</em></strong></td><td><code>Discriminator</code></td><td><code>L1Loss</code></td></tr><tr class="even"><td><strong><em>Wasserstein Auto-encoder (WAE)</em></strong></td><td><code>MaxMeanDiscrepancy</code> or <code>Discriminator</code></td><td><code>L1Loss</code></td></tr><tr class="odd"><td><strong><em>AlphaGAN</em></strong></td><td><code>Discriminator</code></td><td><code>Discriminator</code>+<code>L1Loss</code></td></tr></tbody></table><h2 id="gan-and-wgan-gp">GAN and WGAN-GP</h2><p>åŸå§‹GANç­‰ä»·äºä¼˜åŒ–ï¼š <span class="math display">\[\mathbb{E}_{x\sim P_r}\log{\frac{P_r(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}+\mathbb{E}_{x\sim P_g}\log{\frac{P_g(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}\]</span> æ ¹æ®KLæ•£åº¦å’ŒJSæ•£åº¦çš„å®šä¹‰ï¼š <span class="math display">\[\text{KL}(P_1\parallel P_2)=\mathbb{E}_{x\sim P_1}\log{\frac{P_1}{P_2}}\]</span></p><p><span class="math display">\[\text{JS}(P_1\parallel P_2)=\frac{1}{2}\text{KL}(P_1\parallel \frac{P_1+P_2}{2})+\frac{1}{2}\text{KL}(P_2\parallel \frac{P_1+P_2}{2})\]</span></p><p>å¯é‡å†™ä¸ºï¼š <span class="math display">\[2\text{JS}(P_r\parallel P_g)-2\log 2\]</span> å½“<span class="math inline">\(P_r\)</span>ä¸<span class="math inline">\(P_g\)</span>çš„æ”¯æ’‘é›†ï¼ˆsupportï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­çš„ä½ç»´æµå½¢ï¼ˆmanifoldï¼‰æ—¶ï¼Œ<span class="math inline">\(P_r\)</span>ä¸<span class="math inline">\(P_g\)</span>é‡å éƒ¨åˆ†æµ‹åº¦ï¼ˆmeasureï¼‰ä¸º0çš„æ¦‚ç‡ä¸º1ã€‚</p><ul><li>æ”¯æ’‘é›†ï¼ˆsupportï¼‰å…¶å®å°±æ˜¯å‡½æ•°çš„éé›¶éƒ¨åˆ†å­é›†ï¼Œæ¯”å¦‚<code>ReLU</code>å‡½æ•°çš„æ”¯æ’‘é›†å°±æ˜¯[å…¬å¼]ï¼Œä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„æ”¯æ’‘é›†å°±æ˜¯æ‰€æœ‰æ¦‚ç‡å¯†åº¦éé›¶éƒ¨åˆ†çš„é›†åˆã€‚</li><li>æµå½¢ï¼ˆmanifoldï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­æ›²çº¿ã€æ›²é¢æ¦‚å¿µçš„æ‹“å¹¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä½ç»´ä¸Šç›´è§‚ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œæ¯”å¦‚æˆ‘ä»¬è¯´ä¸‰ç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªæ›²é¢æ˜¯ä¸€ä¸ªäºŒç»´æµå½¢ï¼Œå› ä¸ºå®ƒçš„æœ¬è´¨ç»´åº¦ï¼ˆintrinsic dimensionï¼‰åªæœ‰2ï¼Œä¸€ä¸ªç‚¹åœ¨è¿™ä¸ªäºŒç»´æµå½¢ä¸Šç§»åŠ¨åªæœ‰ä¸¤ä¸ªæ–¹å‘çš„è‡ªç”±åº¦ã€‚åŒç†ï¼Œä¸‰ç»´ç©ºé—´æˆ–è€…äºŒç»´ç©ºé—´ä¸­çš„ä¸€æ¡æ›²çº¿éƒ½æ˜¯ä¸€ä¸ªä¸€ç»´æµå½¢ã€‚</li><li>æµ‹åº¦ï¼ˆmeasureï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­é•¿åº¦ã€é¢ç§¯ã€ä½“ç§¯æ¦‚å¿µçš„æ‹“å¹¿ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œè¶…ä½“ç§¯â€ã€‚</li></ul><p><em>Wasserstein</em>è·ç¦»å®šä¹‰å¦‚ä¸‹ï¼š <span class="math display">\[W(P_r,P_g)=\inf\limits_{\gamma\sim\prod(P_r,P_g)}\mathbb{E}_{(x,y)\sim \gamma}\left[\parallel x-y\parallel\right]\]</span> ä¸‹ç¡®ç•Œ<span class="math inline">\(\inf\)</span>æ²¡æ³•ç›´æ¥æ±‚è§£ï¼Œä¸è¿‡æ ¹æ®ç›¸å…³å®šç†å…¶ç­‰ä»·äºï¼š <span class="math display">\[W(P_r,P_g)=\frac{1}{K}\sup\limits_{\parallel f\parallel_L\leq K}\mathbb{E}_{x\sim P_r}[f(x)]-\mathbb{E}_{x\sim P_g}[f(x)]\]</span> <em>Lipschitz</em>è¿ç»­æ˜¯æŒ‡å­˜åœ¨ä¸€ä¸ªå¸¸æ•°<span class="math inline">\(K\geq 0\)</span>ä½¿å¾—å®šä¹‰åŸŸå†…ä»»æ„ä¸¤ä¸ªå…ƒç´ <span class="math inline">\(x_1\)</span>å’Œ<span class="math inline">\(x_2\)</span>éƒ½æ»¡è¶³ï¼š <span class="math display">\[|f(x_1)-f(x_2)|\leq K|x_1-x_2|\]</span> WANçš„æŸå¤±å‡½æ•°ï¼š <span class="math display">\[\mathcal{L}=\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_g}\left[D({\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_r}\left[D(\mathbf{x})\right]\]</span> WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[\mathcal{L}=\mathop{\mathbb{E}}\limits_{\tilde{\mathbf{x}}\sim\mathbb{P}_g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits_{\hat{\mathbf{x}}\sim\mathbb{P}_{\hat{\mathbf{x}}}}\left[(\parallel\nabla_{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]\]</span></p><h1 id="proposed-method">Proposed Method</h1><p>ä¸‹å›¾ä¸º<em>Buzz</em>çš„æ€»ä½“æµç¨‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/aGPdzq8TVS6fetJ.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>æ•°æ®ä¼šé¦–å…ˆè¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼Œä¹‹åè¿›è¡Œè®­ç»ƒã€‚åœ¨æ£€æµ‹é˜¶æ®µä¼šæ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥åˆ¤å®šå¼‚å¸¸ã€‚</p><h2 id="motivation">Motivation</h2><p>åœ¨æ–‡ä¸­ï¼Œæœ€å…³é”®çš„ä¸¤ä¸ªåˆ›æ–°ç‚¹åˆ†åˆ«æ˜¯<em>Wasserstein</em>è·ç¦»å’Œå¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œåˆ†åŒºçš„æ–¹æ³•ã€‚</p><ul><li><p>åœ¨ä½¿ç”¨è·ç¦»åº¦é‡æ–¹é¢ï¼Œ å› ä¸º<em>Wasserstein</em>åœ¨WGANä¸­å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœï¼Œæ˜¯ä¸€ç§é²æ£’çš„è·ç¦»åº¦é‡ï¼Œæ‰€ä»¥ä½œè€…åœ¨æ–‡ä¸­é‡‡ç”¨äº†<em>Wasserstein</em>è·ç¦»æ¥è¡¡é‡ç”Ÿæˆçš„åˆ†å¸ƒå’ŒçœŸå®çš„åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå¹¶ç”±æ­¤å¼•å…¥äº†å¯¹æŠ—è®­ç»ƒï¼›</p></li><li><p>åœ¨åˆ†åŒºæ–¹æ³•æ–¹é¢ï¼Œä½œè€…è®¤ä¸ºåŸå§‹æ•°æ®è¿‡äºå¤æ‚ï¼Œæ‰€ä»¥å°†æ•°æ®ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>è¿›è¡Œåˆ’åˆ†ï¼Œç„¶ååœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šä½¿ç”¨<em>Wasserstein</em>åº¦é‡è·ç¦»ï¼Œè€Œæ€»ä½“çš„è·ç¦»ç”±æ¯ä¸ªåˆ†åŒºçš„è·ç¦»çš„æœŸæœ›æ±‚å¾—ã€‚</p></li></ul><p>ä½œè€…è¿˜å‘ç°ï¼Œå½“åˆ’åˆ†åœ°è¶Šæ¥è¶Šç»†æ—¶ï¼Œæ€»ä½“è·ç¦»æ¥è¿‘äºç‰¹å®šå½¢å¼çš„VAEçš„é‡æ„è¯¯å·®é¡¹ã€‚</p><p><img src="https://i.loli.net/2020/06/25/knzq4yPaBrXWgeI.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="network-structure">Network Structure</h2><p>ä¸‹å›¾ä¸ºæ¨¡å‹çš„ç½‘ç»œç»“æ„ï¼š</p><p><img src="https://i.loli.net/2020/06/25/Qrgpuh4Iw7YTlny.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="training">Training</h2><h3 id="objective-function">Objective Function</h3><p>å…ˆå®šä¹‰ä¸€äº›ç¬¦å·ï¼š</p><ul><li><span class="math inline">\(b\)</span>å’Œ<span class="math inline">\(s\)</span>åˆ†åˆ«ä¸ºBatchçš„å¤§å°å’Œé‚»å±…çš„å¤§å°ï¼Œæ•°æ®é›†æŒ‰<span class="math inline">\(s\)</span>è¿›è¡Œåˆ‡åˆ†ï¼Œç„¶åéšæœºæ‰“ä¹±ï¼Œæ¯ä¸ªBatchåŒ…å«<span class="math inline">\(b\)</span>ä¸ª<span class="math inline">\(s\)</span>ï¼Œä¹‹å<span class="math inline">\(s/=2,b*=2\)</span>ï¼›</li><li><span class="math inline">\(\mathcal{W}=\{w_1,w_2,\cdots,w_b\}\)</span>ä¸ºä¸€ä¸ªBatchï¼Œä¸”æ»¡è¶³æ¯ä¸ª<span class="math inline">\(w_i\)</span>æ˜¯<span class="math inline">\(s\)</span>çš„å€æ•°ï¼›</li><li><span class="math inline">\(w\in\mathcal{W}\)</span>çš„é‚»åŸŸé›†(neighborhood set)ä¸ºä¸€ä¸ªæ—¶é—´ä¸Šçš„partitionï¼Œè®°ä¸º<span class="math inline">\(\{w,w+1,\cdots,w+s-1\}\)</span></li><li><span class="math inline">\(\mathbf{x}^{(w)},\mathbf{x}^{(w+1)},\cdots,\mathbf{x}^{(w+s-1)}\)</span>ä¸ºåœ¨ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>ä¸Šçš„ä¸€ä¸ªpartitionï¼Œè®°ä¸º<span class="math inline">\(S_w\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{x}^{(w)}\)</span>è¡¨ç¤ºä»¥<span class="math inline">\(w\)</span>ä¸ºç»“å°¾çš„æ—¶é—´çª—å£ã€‚</li></ul><p><em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒWGAN-GPç±»ä¼¼ï¼Œä½†åšäº†ä¸€äº›æ”¹è¿›ï¼Œç”±ä¸‹é¢å››éƒ¨åˆ†ç»„æˆï¼Œä¸‹é¢åˆ†åˆ«è§£é‡Šã€‚</p><p>ç¬¬ä¸€ä¸ªæ˜¯æ¯ä¸€ä¸ªpartitionçš„<span class="math inline">\(\mathbf{z}\)</span>åéªŒçš„KLæ•£åº¦ï¼š <span class="math display">\[\mathcal{K} = \frac{1}{bs}\sum\limits_{w\in\mathcal{W}}\sum\limits_{i=1}^{s-1}\text{KL}\left[q_\phi(\mathbf{z}|\mathbf{x})\parallel\mathcal{N}(\mathbf{0},\mathbf{1})\right]\]</span></p><p>ç¬¬äºŒä¸ªåœ¨è®­ç»ƒæ—¶æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼š <span class="math display">\[Z(\lambda) = \frac{\Gamma(W)}{\Gamma(\frac{W}{2})}2\pi^{\frac{W}{2}}\lambda^{-W}\]</span></p><p>å…¶ä¸­<span class="math inline">\(\Gamma\)</span>æ˜¯<em>Gamma</em>å‡½æ•°ã€‚</p><p>ç¬¬ä¸‰ä¸ªæ˜¯<em>Wasserstein</em>è·ç¦»ï¼š <span class="math display">\[\mathcal{T}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}_{q_\phi(\mathbf{z}|\mathbf{x}^{w+i})}\left[F(\mathbf{x}^{(w+i)})-F(G(\mathbf{z}))\right]\]</span></p><p>ç¬¬å››ä¸ªæ˜¯<em>Gradient Penalty</em>ï¼š</p><p><span class="math display">\[\mathcal{R}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}_{q_\phi(\mathbf{z}|\mathbf{x}^{(w+i)})}\left[\mathbb{E}_{\varepsilon\sim[0,1]}(\parallel\nabla_{\hat{\mathbf{x}}}(\hat{\mathbf{x}})\parallel-\mathbf{1})^2\right]\]</span></p><p>å…¶ä¸­<span class="math inline">\(\hat{\mathbf{x}}=\varepsilon \mathbf{x}^{w+i}+(1-\varepsilon)G(\mathbf{z})\)</span>ä¸ºç”Ÿæˆæ•°æ®ä¸çœŸå®æ•°æ®çš„æ’å€¼ã€‚</p><blockquote><p>åŸå§‹çš„WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[L=\mathop{\mathbb{E}}\limits_{\tilde{\mathbf{x}}\sim\mathbb{P}_g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits_{\hat{\mathbf{x}}\sim\mathbb{P}_{\hat{\mathbf{x}}}}\left[(\parallel\nabla_{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]\]</span> å…¶ä¸­<span class="math inline">\(\mathbb{P}_g\)</span>ä¸ºç”Ÿæˆå™¨çš„åˆ†å¸ƒï¼Œ<span class="math inline">\(\mathbb{P}_r\)</span>ä¸ºçœŸå®åˆ†å¸ƒï¼Œ<span class="math inline">\(\mathbb{P}_{\hat{\mathbf{x}}}\)</span>ä¸ºçœŸå®æ•°æ®å’Œç”Ÿæˆæ•°æ®æ’å€¼å¾—åˆ°çš„åˆ†å¸ƒã€‚</p></blockquote><p><span class="math display">\[\hat{\mathcal{L}}_{Buzz}=-\lambda\sup\limits_F\left[\sum\limits_{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)\]</span></p><h3 id="training-procedure">Training Procedure</h3><p><em>Buzz</em>çš„è®­ç»ƒè¿‡ç¨‹ä¸WGAN-GPç±»ä¼¼ï¼Œ</p><h2 id="detection">Detection</h2><p>æ–‡ä¸­å‡è®¾è§£ç å™¨çš„è¾“å‡ºæœä»å¦‚ä¸‹åˆ†å¸ƒï¼š</p><p><span class="math display">\[p_\theta(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp\{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel\}\]</span></p><p>ä½œè€…å®šä¹‰å¼‚å¸¸åˆ†æ•°ä¸ºï¼š <span class="math display">\[\mathcal{S}=\log p_\theta(\mathbf{x})-\log p_\theta(\bar{\mathbf{x}})\]</span> å…¶ä¸­<span class="math inline">\(\bar{\mathbf{x}}\)</span>ä¸ºç»è¿‡MCMCå¡«å……åçš„æ ·æœ¬ã€‚</p><p>å¼‚å¸¸åˆ†æ•°ä¹Ÿå¯ä»¥å±•å¼€ä¸ºï¼š <span class="math display">\[\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\mathbf{x}|\mathbf{z^{(l)}})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]-\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\bar{\mathbf{x}}|\mathbf{z}^{(l)})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]\]</span></p><p>æœ€ç»ˆç®—æ³•æµç¨‹å›¾ä¸ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/Y3NLjRiaWO5eHGT.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><h2 id="theoretical-analysis">Theoretical Analysis</h2><p>åœ¨ç†è®ºåˆ†æä¸­ï¼Œä½œè€…ä¸»è¦æ˜¯æƒ³å»ºç«‹<span class="math inline">\(\mathcal{L}_{Buzz}\)</span>å’ŒVAEçš„æŸå¤±å‡½æ•°<span class="math inline">\(\mathcal{L}_{vae}\)</span>ä¹‹é—´çš„è”ç³»ï¼ŒæŸå¤±å‡½æ•°<span class="math inline">\(\mathcal{\hat{L}}_{Buzz}\)</span>ä¸ºï¼š</p><p><span class="math display">\[\hat{\mathcal{L}}_{Buzz}=-\lambda\sup\limits_F\left[\sum\limits_{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)\]</span></p><p>ä¸ºäº†ä¾¿äºåˆ†æï¼Œå»æ‰<em>Gradient Penalty</em>çš„éƒ¨åˆ†ï¼Œå…¬å¼å¯ç®€åŒ–ä¸ºï¼š</p><p><span class="math display">\[\mathcal{L}_{Buzz}=-\lambda\mathbb{E}_{p(w)}W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]-\mathcal{K}-\log Z(\lambda)\]</span></p><p>å®é™…ä¸Š<span class="math inline">\(Z(\lambda)=\mathfrak{S}_W\Gamma(W)\lambda^{-W}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathfrak{S}_W\)</span>ä¸º<span class="math inline">\(W\)</span>ç»´å•ä½çƒçš„è¡¨é¢ç§¯ã€‚</p><blockquote><p><span class="math inline">\(n\)</span>ç»´ç©ºé—´å•ä½çƒè¡¨é¢ç§¯å…¬å¼ï¼š <span class="math display">\[\omega_n=\frac{2\pi^{\frac{n}{2}}}{\Gamma(\frac{n}{2})}\]</span></p></blockquote><p>è€Œ<span class="math inline">\(W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]\)</span>ä¸º<em>Wasserstein</em>è·ç¦»ï¼š <span class="math display">\[W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]=\sup\limits_{Lip(f)\leq 1}\left\{\int_\mathcal{X}f(\mathbf{x})p(\mathbf{x}|w)\mathrm{d}\mathbf{x}-\int_\mathcal{X}f(\mathbf{y})p(\mathbf{y}|w)\mathrm{d}\mathbf{y}\right\}\]</span></p><h3 id="lemma-1">Lemma 1</h3><p>é€šè¿‡è®¾å®šå…·ä½“å½¢å¼çš„åéªŒåˆ†å¸ƒï¼ŒVAEçš„æŸå¤±å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p><blockquote><p>è®¾<span class="math inline">\(\mathbf{x}\)</span>çš„åéªŒåˆ†å¸ƒ<span class="math inline">\(p(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp\{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel\}\)</span>ï¼Œé‚£ä¹ˆVAEçš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[\mathcal{L}_{vae}=\lambda\mathbb{E}_{p(w)}\left[\mathbb{E}_{p(\mathbf{x}|w)}\mathbb{E}_{p_G(\mathbf{y}|\mathbf{x})}-\parallel\mathbf{x}-\mathbf{y}\parallel\right]-\mathcal{K}-\log{Z(\lambda)}\]</span></p></blockquote><p>åéªŒåˆ†å¸ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªLaplaceåˆ†å¸ƒï¼š</p><blockquote><p><strong>Laplace Distribution</strong>: <span class="math display">\[f(x|\theta,\lambda)=\frac{1}{2\lambda}\exp{\left(-\frac{|x-\theta|}{\lambda}\right)}\]</span></p></blockquote><p>å¯ä»¥ç›´æ¥æŠŠåéªŒåˆ†å¸ƒå¸¦å…¥VAEçš„æŸå¤±å‡½æ•°å°±å¾—åˆ°äº†ã€‚</p><h3 id="lemma-2">Lemma 2</h3><p><span class="math inline">\(S_w\)</span>å®šä¹‰ä¸ºæ•°æ®ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>çš„ä¸€ä¸ªpartitionï¼Œè€Œ<span class="math inline">\(S=\{(\mathbf{x}_1,\mathbf{x}_2)| \exists w, \mathbf{x}_1\in S_w,\mathbf{x}_2\in S_w\}\)</span>ã€‚</p><blockquote><p>å½“<span class="math inline">\(G,\phi,\lambda\)</span>å›ºå®šæ—¶ï¼Œ<span class="math inline">\(S\downarrow\)</span>æœ‰<span class="math inline">\(\mathcal{L}_{Buzz}\downarrow\)</span></p></blockquote><h3 id="lemma-3">Lemma 3</h3><blockquote><p><span class="math inline">\(\max\mathcal{L}_{Buzz}\geq\max{\mathcal{L}_{vae}}\)</span>ï¼ŒåŒæ—¶ï¼Œå½“<span class="math inline">\(S\downarrow\text{diag}{\mathcal{X}}\)</span>æ—¶<span class="math inline">\(\max\mathcal{L}_{Buzz}\downarrow\max\mathcal{L}_{vae}\)</span></p></blockquote><p><img src="https://i.loli.net/2020/06/25/XM2xwBbOLzikhoc.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="lemma-4">Lemma 4</h3><blockquote><p>ä»¤<span class="math inline">\(p^\prime_G(\mathbf{y}|\mathbf{x})\)</span>è¡¨ç¤º<span class="math inline">\(\mathbb{E}_{q_{\phi^\prime}}\left[p_G(\mathbf{y}|\mathbf{z})\right]\)</span>ã€‚å¦‚æœ<span class="math inline">\((G,\phi,\lambda)\)</span>æ˜¯ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆå­˜åœ¨<span class="math inline">\((G,\phi^\prime,\lambda)\)</span>ä½¿å¾—ï¼š <span class="math display">\[\mathbb{E}_{p(\mathbf{x}|w)}\mathbb{E}_{p_G^\prime(\mathbf{y}|\mathbf{x})}\parallel\mathbf{x}-\mathbf{y}\parallel=W^1\left[P(\mathbf{x}|w)\parallel P_G(\mathbf{y}|w)\right]\]</span> æ­¤æ—¶<span class="math inline">\(\mathcal{L}_{Buzz}-\mathcal{L}_{vae}^\prime=\mathcal{K}^\prime-\mathcal{K}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathcal{L}^\prime,\mathcal{K}^\prime\)</span>åˆ†åˆ«ä¸º<span class="math inline">\((G,\phi^\prime,\lambda)\)</span>æ—¶çš„<span class="math inline">\(\mathcal{L}\)</span>å’Œ<span class="math inline">\(\mathcal{K}\)</span>ã€‚</p></blockquote><p><span class="math display">\[\mathcal{L}^\dagger_{Buzz}=\mathbb{E}_{p(\mathbf{x})}\left[\mathbb{E}_{q_{\phi^\prime}(\mathbf{z}|\mathbf{x})}\log_{p_\theta}(\mathbf{x}|\mathbf{z})\right]-\min\limits_{\bar{\phi}\sim\phi^\prime}\bar{\mathcal{K}}\]</span></p><h3 id="lemma-5">Lemma 5</h3><p>è¿™é‡Œä¸»è¦æ˜¯æƒ³è¯æ˜</p><blockquote><p>å¯¹äºå›ºå®šçš„<span class="math inline">\(w\)</span>ï¼Œä»¤ï¼š <span class="math display">\[\mathcal{F}=\{f|Lip(f)\leq 1\}, \space \mathcal{F}^*=\left\{f|_{S_w}\bigg|Lip(f|_{S_w})\leq 1\right\}\]</span> æœ‰<span class="math inline">\(\sup_{f\in\mathcal{F}}\mathcal{T}(f)=\sup_{f|_{S_w}\in\mathcal{F}^*}\mathcal{T}^*\left(f|_{S_w}\right)\)</span>ã€‚</p></blockquote><h3 id="theorem-6">Theorem 6</h3><blockquote><p><span class="math inline">\(\mathcal{L}_{Buzz}\)</span>çš„å¯¹å¶å½¢å¼ä¸ºï¼š <span class="math display">\[\mathcal{L}_{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}^*(F)-\mathcal{K}-\log Z(\lambda)\]</span></p></blockquote><p>è¿‘ä¼¼çš„<span class="math inline">\(\mathcal{L}_{Buzz}\)</span>çš„å¯¹å¶å½¢å¼ä¸ºï¼š <span class="math display">\[\bar{\mathcal{L}}_{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}(F)-\mathcal{K}-\log Z(\lambda)\]</span></p><h1 id="experiment">Experiment</h1><p><img src="https://i.loli.net/2020/06/25/GEi3zfeAgXVsvBN.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><img src="https://i.loli.net/2020/06/25/7EkhRGNvIsSmwn6.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><img src="https://i.loli.net/2020/06/25/yTIhoZb1kVOf4Mv.png" srcset="/img/loading.gif" style="zoom:67%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>VAE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Variational Approaches for Auto-Encoding Generative Adversarial Networks</title>
    <link href="/2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/"/>
    <url>/2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/</url>
    
    <content type="html"><![CDATA[<h1 id="abstract">Abstract</h1><p>æœ¬æ–‡æ­ç¤ºäº†å¯¹æŠ—ç”Ÿæˆç½‘ç»œï¼ˆGenerative Adversarial Networks, GANï¼‰å’Œå˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational Auto-encoders, VAEï¼‰ä¹‹é—´çš„è”ç³»ï¼Œå¹¶æ®æ­¤æå‡ºäº†ä¸€ç§å°†ä¸¤è€…ç»“åˆçš„æ–°æ¨¡å‹ã€‚æ–‡ä¸­ä¸»è¦æ˜¯å°†ä¸å¯è§£çš„ä¼¼ç„¶å‡½æ•°å’ŒæœªçŸ¥çš„åéªŒåˆ†å¸ƒç”¨ä¸€ä¸ªéç¡®å®šçš„åˆ†å¸ƒï¼ˆImmplicit Distributionï¼‰æ›¿ä»£ï¼Œå¹¶åŠ å…¥åˆ¤åˆ«å™¨æ¥ä½¿å¾—è¯¥åˆ†å¸ƒé€¼è¿‘çœŸå®çš„åˆ†å¸ƒã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œä½œè€…å°†VAEä¸­çš„æŸå¤±å‡½æ•°è¿›è¡Œäº†æ›¿æ¢ï¼Œå˜æˆäº†GANä¸­çš„â€œç”Ÿæˆ-åˆ¤åˆ«â€æ¨¡å¼ã€‚</p><p><a href="https://arxiv.org/abs/1706.04987" target="_blank" rel="noopener">åŸæ–‡</a></p><h1 id="contribution">Contribution</h1><p>æœ¬æ–‡æœ‰å¦‚ä¸‹è´¡çŒ®ï¼š</p><ul><li>æœ¬æ–‡æå‡ºå˜åˆ†æ¨æ–­ï¼ˆVariational Inferenceï¼‰ä¹Ÿèƒ½é€šè¿‡å¯¹éç¡®å®šåˆ†å¸ƒçš„ä¼°è®¡åº”ç”¨åœ¨GANä¸­ï¼›</li><li>åŸºäºä¼¼ç„¶çš„æ¨¡å‹ï¼ˆLikelihood-based Modelsï¼‰å’Œéä¼¼ç„¶æ¨¡å‹ï¼ˆLikelihood-free Modelsï¼‰èƒ½å¤Ÿé€šè¿‡å¯¹æŠ—å­¦ä¹ ç»“åˆèµ·æ¥ï¼›</li><li>ä½œè€…æ ¹æ®æ–‡ä¸­æå‡ºçš„æ–°è§‚ç‚¹ä¿®æ”¹äº†VAEçš„æŸå¤±å‡½æ•°ï¼Œå°†å…¶ç§°ä¹‹ä¸ºAuto-encoding GAN (<span class="math inline">\(\alpha\)</span>-GAN)ï¼Œå¹¶æå‡ºäº†å¯¹åº”çš„å®ç”¨çš„æ”¹è¿›ï¼›</li><li>æœ¬æ–‡ä¸ä¼—å¤šState-of-Artæ¨¡å‹è¿›è¡Œäº†å¯¹æ¯”</li></ul><h1 id="methodology">Methodology</h1><h2 id="overcoming-intractability-in-generative-models">Overcoming Intractability in Generative Models</h2><h3 id="latent-variable-models">Latent Variable Models</h3><p>éšå˜é‡æ¨¡å‹é€šè¿‡éšå˜é‡çš„å½¢å¼æè¿°äº†æ•°æ®çš„äº§ç”Ÿè¿‡ç¨‹ã€‚æœ€ç®€å•çš„å½¢å¼æ˜¯å‡è®¾éšå˜é‡<span class="math inline">\(\mathbf{z}\)</span>æœä»ä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒ<span class="math inline">\(\mathbf{z}\sim p(\mathbf{z})\)</span>ï¼Œè€Œæ•°æ®<span class="math inline">\(\mathbf{x}\)</span>ä»æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p(\mathbf{x}|\mathbf{z})\)</span>æŠ½æ ·äº§ç”Ÿã€‚é€šå¸¸æ¥è¯´æè¿°<span class="math inline">\(p(\mathbf{x}|\mathbf{z})\)</span>çš„æ¨¡å‹ç§°ä¸ºç”Ÿæˆå™¨<span class="math inline">\(\mathcal{G}_\theta(\mathbf{z})\)</span>ï¼Œå¸¦æœ‰å¯ä¼˜åŒ–çš„å‚æ•°<span class="math inline">\(\theta\)</span>ï¼Œè€Œ<span class="math inline">\(\mathbf{z}\)</span>é€šå¸¸å‡è®¾ä¸ºæ­£æ€åˆ†å¸ƒ<span class="math inline">\(\mathbf{z}\sim\mathcal{N}(\mathbf{0},\mathbf{I})\)</span>ã€‚</p><p>æ–‡ä¸­åŒºåˆ†äº†ä¸¤ç§éšå˜é‡æ¨¡å‹ï¼Œä¸€ç§æ˜¯<em>Implicit Latent Variable Models</em>ï¼Œä¸€ç§æ˜¯<em>Prescribed Latent Variable Models</em>ã€‚æ–‡ä¸­çš„æè¿°ä¸å¤ªæ¸…æ¥šï¼Œä¸ªäººè®¤ä¸ºä¸¤è€…çš„åŒºåˆ«æ˜¯å‰è€…å›¾æ¨¡å‹ä¸­çš„<span class="math inline">\(\mathbf{x}\)</span>ä¸æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œåœ¨ä¼˜åŒ–çš„æ—¶å€™éœ€è¦ç”¨ä¸€ä¸ªåˆ»ç”»ç”Ÿæˆçš„<span class="math inline">\(\mathbf{x}\)</span>å’ŒçœŸå®çš„<span class="math inline">\(\mathbf{x}\)</span>çš„å·®åˆ«çš„å‡½æ•°<span class="math inline">\(\delta(\mathbf{x}-\mathcal{G}_\theta(\mathbf{z}))\)</span>ï¼Œè€Œåè€…å›¾æ¨¡å‹ä¸­<span class="math inline">\(\mathbf{x}\)</span>æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œè¿™æ ·å¯ä»¥å†™å‡ºä¼¼ç„¶å‡½æ•°ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p><p>æ— è®ºæ˜¯GANè¿˜æ˜¯VAEéƒ½éœ€è¦é€šè¿‡è¾¹ç¼˜åˆ†å¸ƒ<span class="math inline">\(p_\theta(\mathbf{x})\)</span>æ¥åˆ»ç”»å»ºæ¨¡çš„å¥½åï¼Œæ¯”å¦‚è¯´æ ¹æ®<span class="math inline">\(p_\theta(\mathbf{x})\)</span>ä¸çœŸå®åˆ†å¸ƒ<span class="math inline">\(p^*_\theta(\mathbf{x})\)</span>ä¹‹é—´çš„KLæ•£åº¦<span class="math inline">\(\text{KL}\left[p_\theta(\mathbf{x})\parallel p_\theta^*(\mathbf{x})\right]\)</span>ã€‚ä½†é€šå¸¸æƒ…å†µä¸‹<span class="math inline">\(p_\theta(\mathbf{x})\)</span>éƒ½æ˜¯ä¸å¯è§£çš„ï¼Œè€ŒGANå’ŒVAEé€šè¿‡ä¸åŒçš„é€”å¾„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="generative-adversarial-networks">Generative Adversarial Networks</h3><p>GANæ²¡æœ‰ç›´æ¥è®¡ç®—<span class="math inline">\(p_\theta(\mathbf{x})\)</span>ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªåˆ¤åˆ«å™¨æ¥åˆ¤åˆ«æ ·æœ¬æ˜¯ä»<span class="math inline">\(p_\theta(\mathbf{x})\)</span>è¿˜æ˜¯<span class="math inline">\(p_\theta^*(\mathbf{x})\)</span>é‡‡æ ·å¾—åˆ°çš„ï¼Œå¦‚æœåˆ¤åˆ«å™¨æ— æ³•è¿›è¡ŒåŒºåˆ†ï¼Œé‚£æˆ‘ä»¬è®¤ä¸ºæ­¤æ—¶<span class="math inline">\(p_\theta(\mathbf{x})\approx p_\theta^*(\mathbf{x})\)</span>ã€‚</p><p>ä»¤éšæœºå˜é‡<span class="math inline">\(y\in\{0,1\}\)</span>ï¼Œ<span class="math inline">\(y=1\)</span>è¡¨ç¤ºæ ·æœ¬<span class="math inline">\(\mathbf{x}\)</span>æ¥è‡ªçœŸå®åˆ†å¸ƒï¼Œ<span class="math inline">\(y=0\)</span>è¡¨ç¤ºæ ·æœ¬<span class="math inline">\(\mathbf{x}\)</span>æ¥è‡ªç”Ÿæˆåˆ†å¸ƒï¼Œè€Œåˆ¤åˆ«å™¨çš„è¾“å‡ºä¸º<span class="math inline">\(\mathbf{x}\)</span>æ¥è‡ªçœŸå®åˆ†å¸ƒçš„æ¦‚ç‡<span class="math inline">\(\mathcal{D}_\phi(\mathbf{x})=p(y=1|\mathbf{x})\)</span>ã€‚GANé€šè¿‡å¯¹æ¥è‡ªçœŸå®åˆ†å¸ƒå’Œç”Ÿæˆåˆ†å¸ƒçš„æ ·æœ¬æ±‚äºŒå…ƒäº¤å‰ç†µæ¥ä½œä¸ºåˆ¤åˆ«å™¨æŸå¤±å‡½æ•°ï¼š <span class="math display">\[\textbf{Discriminator Loss: }\mathbb{E}_{p^*(\mathbf{x})}[-\log\mathcal{D}_\phi(\mathbf{x})]+\mathbb{E}_{p_\theta(\mathbf{x})}[-\log(1-\mathcal{D}_\phi(\mathbf{x}))]\]</span></p><p>ç”Ÿæˆå™¨å°†æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬åˆ¤å®šä¸ºçœŸçš„æ¦‚ç‡ä½œä¸ºæŸå¤±å‡½æ•°ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªç­‰ä»·çš„ä½†åœ¨å®è·µä¸­è¡¨ç°æ›´å¥½çš„æ›¿ä»£ç‰ˆæœ¬ï¼š</p><p><span class="math display">\[\textbf{Generator Loss: }\mathbb{E}_{p_\theta(\mathbf{x})}[\log(1-\mathcal{D}_\phi(\mathbf{x}))];\textbf{ Alternative Loss: }\mathbf{E}_{p_\theta(\mathbf{x})}[-\log\mathcal{D}_\phi(\mathbf{x})]\]</span></p><h3 id="the-density-ratio-trick">The Density Ratio Trick</h3><p>ä»¤<span class="math inline">\(p^*(\mathbf{x})=p(\mathbf{x}|y=1)\)</span>ï¼Œ<span class="math inline">\(p_\theta(\mathbf{x})=p(\mathbf{x}|y=0)\)</span>ã€‚å®šä¹‰<em>Density Ratio</em> <span class="math inline">\(r_\phi(\mathbf{x})\)</span>ä¸ºçœŸå®åˆ†å¸ƒå’Œç”Ÿæˆåˆ†å¸ƒä¹‹é—´çš„æ¯”ä¾‹ï¼š</p><p><span class="math display">\[r_\phi(\mathbf{x})=\frac{p^*(\mathbf{x})}{p_\theta(\mathbf{x})}=\frac{p(\mathbf{x}|y=1)}{p(\mathbf{x}|y=0)}=\frac{p(y=1|\mathbf{x})}{p(y=0|\mathbf{x})}=\frac{\mathcal{D}_\phi(\mathbf{x})}{1-\mathcal{D}_\phi(\mathbf{x})}\]</span></p><p>ä¸Šå¼è¡¨æ˜äº†<em>Density Ratio</em>çš„è®¡ç®—å¯ä»¥ä»…é€šè¿‡ä»ä¸¤ä¸ªåˆ†å¸ƒä¸Šé‡‡æ ·å¾—åˆ°çš„æ ·æœ¬åŠ ä¸Šä¸€ä¸ªäºŒåˆ†ç±»å™¨<span class="math inline">\(\mathcal{D}_\phi(\mathbf{x})\)</span>å®ç°ï¼ˆå‡è®¾<span class="math inline">\(p(y=0)=p(y=1)\)</span>ï¼‰ã€‚æ›´æ·±å…¥çš„è¯´ï¼Œå¯¹äºä¸å¯è§£çš„åˆ†å¸ƒ<span class="math inline">\(p_\theta^*(\mathbf{x})\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—<em>Density Ratio</em>æ¥äº†è§£æˆ‘ä»¬è¿‘ä¼¼çš„åˆ†å¸ƒ<span class="math inline">\(p_\theta(\mathbf{x})\)</span>å’ŒçœŸå®çš„<span class="math inline">\(p_\theta^*(\mathbf{x})\)</span>ä¹‹é—´çš„ç›¸å¯¹æ€§ã€‚è€Œä¸”æˆ‘ä»¬åªéœ€è¦èƒ½å¤Ÿåœ¨ä¸¤ä¸ªåˆ†å¸ƒä¸Šè¿›è¡Œé‡‡æ ·ï¼Œå¹¶ä¸”è®­ç»ƒä¸€ä¸ªåˆ¤åˆ«å™¨å³å¯ã€‚å› ä¸ºåˆ¤åˆ«å™¨æ˜¯ä¸€ä¸ªæ™®é€šçš„åˆ†ç±»å™¨ï¼Œæ‰€ä»¥å¤§é‡çš„ä¸»æµåˆ†ç±»å™¨éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p><h3 id="variational-inference">Variational Inference</h3><p>ç°åœ¨æ¥çœ‹VAEï¼Œå¦ä¸€ç§è§£å†³ä¸å¯è§£åˆ†å¸ƒçš„æ–¹æ³•æ˜¯è¿‘ä¼¼ã€‚<em>Variational Inference</em>é€šè¿‡å¼•å…¥ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ<span class="math inline">\(q_\eta(\mathbf{z}|\mathbf{x})\)</span>æ¨å‡ºäº†ä¸å¯è§£çš„<span class="math inline">\(\mathbf{x}\)</span>çš„å¯¹æ•°ä¼¼ç„¶çš„ä¸‹ç•Œï¼ˆå¸¸è¢«ç§°ä¸ºè¯æ®ä¸‹ç•ŒELBOï¼‰ï¼š</p><p><span class="math display">\[\log p_\theta(\mathbf{x})=\log\int p_\theta(\mathbb{x}|\mathbb{z})p(\mathbf{z})\text{d}\mathbf{z}\geq \mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log p_\theta(\mathbf{x}|\mathbf{z})\right]-\text{KL}\left[q_\eta(\mathbf{z}|\mathbf{x})\parallel p(\mathbf{z})\right]=\mathcal{F}(\boldsymbol{\theta}, \boldsymbol{\eta})\]</span></p><p>VAEæ˜¯<em>Variational Inference</em>çš„ä¸€ç§å®ç°ï¼Œå˜åˆ†åˆ†å¸ƒé€šè¿‡ä¸€ä¸ªç¥ç»ç½‘ç»œè¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ä¸”å»ºç«‹èµ·äº†å®Œæ•´çš„å¯ä¼˜åŒ–çš„æ¨¡å‹ã€‚</p><h3 id="synthetic-likelihood">Synthetic Likelihood</h3><p>å½“ä¼¼ç„¶å‡½æ•°æœªçŸ¥ï¼ˆGANä¸­æ²¡æœ‰æ˜¾å¼çš„ä¼¼ç„¶å‡½æ•°ï¼Œè€ŒVAEä¸­æœ‰ï¼‰çš„æ—¶å€™ï¼Œ<em>Variational Inference</em>ä¾¿æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚å¯¹äºæ²¡æœ‰æ˜¾å¼çš„ä¼¼ç„¶å‡½æ•°çš„æƒ…å†µï¼Œä»¥VAEçš„ELBOçš„ç¬¬ä¸€é¡¹ä¸ºä¾‹ï¼Œå‡è®¾<span class="math inline">\(p_\theta(\mathbf{x}|\mathbf{z})\)</span>åˆ†å¸ƒçš„å…·ä½“å½¢å¼æœªçŸ¥ï¼Œæˆ‘ä»¬åªæœ‰ä»<span class="math inline">\(p_\theta(\mathbf{x}|\mathbf{z})\)</span>é‡‡æ ·å¾—åˆ°çš„æ ·æœ¬ï¼Œå¦‚ä½•è®¡ç®—<span class="math inline">\(\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}[\log p_\theta(\mathbf{x}|\mathbf{z})]\)</span>å‘¢ï¼Ÿä¸€ä¸ªæ–¹æ³•æ˜¯ä¹˜ä»¥<span class="math inline">\(p_\theta^*(\mathbf{x})\)</span>å†é™¤ä»¥<span class="math inline">\(p_\theta^*(\mathbf{x})\)</span>ï¼š</p><p><span class="math display">\[\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}[\log p_\theta(\mathbf{x}|\mathbf{z})]=\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{p_\theta(\mathbf{x}|\mathbf{z})}{p^*(\mathbf{x})}\right]+\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}[\log p^*(\mathbf{x})]\]</span></p><p>å…¬å¼(5)ä¸­çš„ç¬¬ä¸€é¡¹åŒ…æ‹¬äº†åˆæˆä¼¼ç„¶<span class="math inline">\(R(\theta)=\frac{p_\theta(\mathbf{x}|\mathbf{z})}{p^*(\mathbf{x})}\)</span>ï¼Œä¼˜åŒ–<span class="math inline">\(R(\theta)\)</span>ç›¸å½“äºä¼˜åŒ–<span class="math inline">\(\log p_\theta(\mathbf{x}|\mathbf{z})\)</span>ã€‚ç¬¬äºŒé¡¹ä¸ç”Ÿæˆç½‘ç»œçš„å‚æ•°<span class="math inline">\(\theta\)</span>æ— å…³ï¼Œæ‰€ä»¥åœ¨ä¼˜åŒ–çš„æ—¶å€™å¯ä»¥å¿½ç•¥ã€‚</p><h2 id="a-fusion-of-variational-and-adversarial-learning">A Fusion of Variational and Adversarial Learning</h2><p>GANå’ŒVAEåˆ†åˆ«ä»ä¸åŒçš„è§’åº¦è§£å†³äº†ç”Ÿæˆæ¨¡å‹çš„æ¨æ–­é—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹é¢ä»VAEå‡ºå‘ï¼Œè€ƒè™‘å°†ä¸¤è€…ç»“åˆèµ·æ¥ã€‚</p><h3 id="implicit-variational-distributions">Implicit Variational Distributions</h3><p>å˜åˆ†æ¨æ–­<strong>Variational Inference</strong>çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯ç¡®å®š<span class="math inline">\(q_\eta(\mathbf{z}|\mathbf{x})\)</span>ï¼Œé€šå¸¸çš„åšæ³•å¦‚<strong>Mean-field Variational Inference</strong>ä¼šå‡è®¾ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚åœ¨æœ¬æ–‡ä¸­ä¸å¯¹<span class="math inline">\(q_\eta(\mathbf{z}|\mathbf{x})\)</span>çš„å½¢å¼ä½œå‡è®¾ï¼Œä»…å‡è®¾å…¶ä¸ºä¸€ä¸ªéšå«çš„åˆ†å¸ƒã€‚è¿ç”¨ä¸Šæ–‡æåˆ°çš„<em>Density Ratio Trick</em>ï¼Œæˆ‘ä»¬å¯ä»¥å°†VAEæŸå¤±å‡½æ•°ä¸­çš„ç¬¬äºŒé¡¹æ”¹å†™ä¸ºï¼š</p><p><span class="math display">\[-\text{KL}[q_\eta(\mathbf{z}|\mathbf{x})\parallel p(\mathbf{z})]=\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{p(\mathbf{z})}{q_\eta(\mathbf{z}|\mathbf{x})}\right]\approx\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}{1-\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}\right]\]</span></p><p>æ–‡ä¸­å¼•å…¥äº†ä¸€ä¸ªéšå˜é‡åˆ†ç±»å™¨ï¼ˆLatent Classifierï¼‰<span class="math inline">\(\mathcal{C}_{\boldsymbol{\omega}}(\mathbf{z})\)</span>ï¼Œç”¨æ¥åˆ¤åˆ«<span class="math inline">\(\mathbf{z}\)</span>æ˜¯ä»ç¼–ç ç½‘ç»œè¿˜æ˜¯ä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ï¼ˆçŒœæµ‹è¿™æ ·åšçš„å¥½å¤„æ˜¯ä¸ç”¨å†å¯¹<span class="math inline">\(\mathbf{z}\)</span>çš„åéªŒåšé«˜æ–¯åˆ†å¸ƒçš„å‡è®¾äº†ï¼Œä¹Ÿä¸éœ€è¦åœ¨å˜åˆ†ç½‘ç»œè¾“å‡ºå½¢æˆçš„é«˜æ–¯åˆ†å¸ƒä¸Šé‡‡æ ·å¾—åˆ°<span class="math inline">\(\mathbf{z}\)</span>äº†ï¼Œè¿™æ ·é‡å‚æ•°æŠ€å·§ä¹Ÿçœäº†ï¼‰ã€‚å…·ä½“å®ç°ä¸Šï¼ŒæœŸæœ›å¯ä»¥ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•ï¼ˆé‡‡æ ·å¤šæ¬¡å–å‡å€¼ï¼‰è¿›è¡Œè®¡ç®—ã€‚</p><h3 id="likelihood-choice">Likelihood Choice</h3><p>å¯¹äºVAEæŸå¤±å‡½æ•°ç¬¬ä¸€é¡¹ï¼Œå¯¹åº”ç”Ÿæˆç½‘ç»œï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¯¹<span class="math inline">\(p(\mathbf{x}|\mathbf{z})\)</span>åˆ†å¸ƒçš„å…·ä½“å½¢å¼åšå‡è®¾ï¼Œ è¿™æ ·å¯¹åº”<em>Likelihood-based</em>çš„æƒ…å†µã€‚æ–‡ä¸­é€‰æ‹©çš„æ˜¯<em>Zero-mean Laplace Distribution</em> <span class="math inline">\(p_\theta(\mathbf{x}|\mathbf{z})\propto\exp(-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1)\)</span>ï¼ˆä¸å°±æ˜¯<span class="math inline">\(L_1\)</span> Losså—ï¼Ÿï¼Ÿï¼Ÿï¼‰ã€‚</p><p>å¯¹äº<em>Likelihood-free</em>çš„æƒ…å†µï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ä¸Šé¢æåˆ°çš„<em>Density Ratio Trick</em>ï¼Œè¿™æ—¶éœ€è¦åŠ ä¸€ä¸ªä¸€ä¸ªåˆ¤åˆ«å™¨ã€‚</p><p><span class="math display">\[\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1\right]\space\space\text{  or  }\space\space\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}{1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}\right]\]</span></p><p>å¯¹äºä¸¤ç§é€‰æ‹©ï¼Œå‰è€…å¯¹åº”VAEï¼Œå¥½å¤„æ˜¯ä¸ä¼šå‡ºç°æ¨¡å¼å´©æºƒçš„æƒ…å†µï¼Œåè€…å¯¹åº”GANï¼Œå®¹æ˜“å‡ºç°æ¨¡å¼å´©æºƒçš„æƒ…å†µï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å¯¹æŠ—å­¦ä¹ çš„æ–¹å¼ï¼ˆè¿™æ˜¯ä¼˜ç‚¹ï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œæœ¬æ–‡é€‰æ‹©ä¸¤ç§éƒ½ç”¨ï¼ˆæˆ‘å…¨éƒ½è¦.jpgï¼‰ã€‚</p><h3 id="hybrid-loss-functions">Hybrid Loss Functions</h3><p>å°†å‰é¢çš„è®¨è®ºç»“åˆèµ·æ¥ï¼Œæœ€åçš„æŸå¤±å‡½æ•°å°±æ˜¯ï¼š</p><p><span class="math display">\[\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\eta})=\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1+\log\frac{\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}{1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}+\log\frac{\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}{1-\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}\right]\]</span></p><p>æœ€åæ¨¡å‹åŒ…å«å››ä¸ªç½‘ç»œï¼šç”Ÿæˆç½‘ç»œ<span class="math inline">\(p_\theta(\mathbf{x}|\mathbf{z})\)</span>ã€æ¨æ–­ç½‘ç»œ<span class="math inline">\(q_\eta(\mathbf{z}|\mathbf{x})\)</span>ä»¥åŠä¸¤ä¸ªåˆ¤åˆ«å™¨<span class="math inline">\(\mathcal{C}_{\boldsymbol{\omega}}\)</span>å’Œ<span class="math inline">\(\mathcal{D}_\phi\)</span>ï¼Œä½œè€…å°†å…¶å‘½åä¸º<span class="math inline">\(\alpha\)</span>-GANã€‚</p><p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/hkIY9xuDWl4GbLz.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="improved-techniques">Improved Techniques</h3><p>ä½œè€…ä¸ºäº†æ”¹è¿›æ¨¡å‹çš„ç¨³å®šæ€§å’Œæ•ˆç‡ï¼Œå°†ç”Ÿæˆå™¨çš„Lossä¸­çš„<span class="math inline">\(-\log(1-\mathcal{D}_\phi)\)</span>ä¿®æ”¹ä¸ºäº†<span class="math inline">\(\log\mathcal{D}_\phi-\log(1-\mathcal{D}_\phi)\)</span>ï¼Œå¹¶å£°ç§°è¿™æ ·èƒ½æä¾›éé¥±å’Œï¼ˆNon-saturatingï¼‰çš„æ¢¯åº¦ï¼š</p><p><span class="math display">\[\textbf{Generator Loss: } \mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1-\log\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))+\log(1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z})))\right]\]</span></p><p>ä½œè€…è®¤ä¸ºåœ¨ç”Ÿæˆå™¨æŸå¤±å‡½æ•°ä¸­åŠ å…¥<span class="math inline">\(\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1\)</span>èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦é˜²æ­¢æ¨¡å¼å´©æºƒã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…å‘ç°å°†çœŸå®æ ·æœ¬ï¼ˆåŸæ–‡æ˜¯The Samplesï¼‰ä½œä¸ºç”Ÿæˆçš„æ ·æœ¬è¾“å…¥åˆ°åˆ¤åˆ«å™¨ä¸­èƒ½å¤Ÿæå‡æ€§èƒ½ã€‚ä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯æ ¹æ®Jensenä¸ç­‰å¼ï¼š<span class="math inline">\(\log p_\theta(\mathbf{x})=\log\int p_\theta(\mathbf{x}|\mathbf{z})p(\mathbf{z})\text{d}\mathbf{z}\geq \mathbb{E}_{p(\mathbf{z})}[\log p_\theta(\mathbf{x}|\mathbf{z})]\)</span>ï¼Œ</p><p>[TODO]</p><h2 id="related-work">Related Work</h2><p>[TODO]</p><p><img src="https://i.loli.net/2020/06/25/TKt3yUwPDQm4MeV.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><p><img src="https://i.loli.net/2020/06/25/5jg9wNMoXuTzeVY.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><h1 id="experiments">Experiments</h1><p>[TODO]</p><h2 id="metrics">Metrics</h2><p>æœ¬æ–‡ä½¿ç”¨äº†å‡ ç§ä¸åŒçš„è¯„æµ‹ç”Ÿæˆæ¨¡å‹çš„æ–¹æ³•ï¼š</p><ul><li><strong>Inception Score: </strong></li><li><strong>Multi-scale Structural Similarity (MS-SSIM): </strong></li><li><strong>Independent Wasserstein Critic: </strong></li></ul><h2 id="results-on-colormnist">Results on ColorMNIST</h2><p><img src="https://i.loli.net/2020/06/25/QRBKHn51fxO2WUq.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><p><img src="https://i.loli.net/2020/06/25/kM4lrsBVSDKaJwW.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><h2 id="results-on-celeba">Results on CelebA</h2><p><img src="https://i.loli.net/2020/06/25/mzdjY67uH9pZ1ny.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><h2 id="results-on-cifar-10">Results on CIFAR-10</h2><p><img src="https://i.loli.net/2020/06/25/nDGgM6AHVyKwIam.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><p><img src="https://i.loli.net/2020/06/25/K1RQdMyj8zbqlCJ.png" srcset="/img/loading.gif" style="zoom:50%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>GAN</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Deep Learning</tag>
      
      <tag>Variational Inference</tag>
      
      <tag>VAE</tag>
      
      <tag>GAN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Anomaly Detection in Streams with Extreme Value Theory</title>
    <link href="/2019/10/29/Anomaly-Detection-in-Streams-with-Extreme-Value-Theory/"/>
    <url>/2019/10/29/Anomaly-Detection-in-Streams-with-Extreme-Value-Theory/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡åŸºäº<strong>Extreme Value Theory</strong>æå‡ºäº†ä¸€ç§ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®é˜ˆå€¼ä¹Ÿä¸éœ€è¦å¯¹æ•°æ®åˆ†å¸ƒä½œä»»ä½•å‡è®¾çš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæœ¬æ–¹æ³•å¯ä»¥ç”¨åœ¨é€šç”¨çš„è‡ªåŠ¨é˜ˆå€¼é€‰æ‹©çš„åœºåˆä¸­ã€‚</p><p><a href="https://www.kdd.org/kdd2017/papers/view/anomaly-detection-in-streams-with-extreme-value-theory" target="_blank" rel="noopener">åŸæ–‡</a></p><h1 id="background">Background</h1><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚é˜ˆå€¼çš„é€‰æ‹©å¯ä»¥é€šè¿‡å®éªŒçš„æ–¹æ³•æˆ–è€…å¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œå‡è®¾çš„æ–¹æ³•æ¥å¾—åˆ°ï¼Œä¸è¿‡è¿™æ ·åšé€šå¸¸ä¸å‡†ç¡®ã€‚å€ŸåŠ©<strong>Extreme Value Theory</strong>æˆ‘ä»¬å¯ä»¥åœ¨ä¸éœ€è¦å¯¹åŸå§‹æ•°æ®çš„åˆ†å¸ƒä½œå¾ˆå¼ºçš„å‡è®¾çš„æƒ…å†µä¸‹ï¼Œæ¨æ–­æˆ‘ä»¬æƒ³è¦çš„æç«¯äº‹ä»¶çš„åˆ†å¸ƒï¼ˆåœ¨å¼‚å¸¸æ£€æµ‹ä¸­å°±æ˜¯å¼‚å¸¸å€¼ï¼‰ã€‚</p><p>ä¸‹é¢ç»™å‡ºä¸€äº›æ•°å­¦ç¬¦å·ï¼Œ<span class="math inline">\(X\)</span>ä¸ºéšæœºå˜é‡ï¼Œ<span class="math inline">\(F\)</span>ä¸ºç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œå³<span class="math inline">\(F(x)=\mathbb{P}(X\leq x)\)</span>ã€‚è®°<span class="math inline">\(F\)</span>çš„â€œæœ«å°¾â€åˆ†å¸ƒ<span class="math inline">\(\bar{F}(x)=1-F(x)=\mathbb{P}(X&gt;x)\)</span>ã€‚å¯¹äºä¸€ä¸ªéšæœºå˜é‡<span class="math inline">\(X\)</span>å’Œç»™å®šçš„æ¦‚ç‡<span class="math inline">\(q\)</span>ï¼Œè®°<span class="math inline">\(z_q\)</span>ä¸ºåœ¨<span class="math inline">\(1-q\)</span>æ°´å¹³çš„åˆ†ä½æ•°ï¼Œå³<span class="math inline">\(z_q\)</span>ä¸ºæ»¡è¶³<span class="math inline">\(\mathbb{P}(X\leq z_q)\geq 1-q\)</span>æœ€å°çš„å€¼ã€‚</p><h2 id="extreme-value-distributions">Extreme Value Distributions</h2><p><strong>Extreme Value Theory</strong>ä¸»è¦æ˜¯ä¸ºäº†æ‰¾å‡ºæç«¯äº‹ä»¶å‘ç”Ÿçš„è§„å¾‹ï¼Œæœ‰å­¦è€…è¯æ˜ï¼Œåœ¨å¾ˆå¼±çš„æ¡ä»¶ä¸‹ï¼Œæ‰€æœ‰æç«¯äº‹ä»¶éƒ½æœä»ä¸€ä¸ªç‰¹å®šçš„åˆ†å¸ƒï¼Œè€Œä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ã€‚å…·ä½“å½¢å¼å¦‚ä¸‹ï¼š</p><p><span class="math display">\[G_\gamma:x\mapsto \exp(-(1+\gamma x)^{-\frac{1}{\gamma}}), \space\space\space\space\space\gamma\in\mathbb{R}, \space\space\space\space\space 1+\gamma x&gt;0\]</span></p><p>å…¶ä¸­<span class="math inline">\(\gamma\)</span>ç§°ä¸º<strong>Extreme Value Index</strong>ï¼Œç”±åŸå§‹åˆ†å¸ƒå†³å®šã€‚</p><p>æ›´ä¸¥è°¨çš„è¯´æ³•æ˜¯Fisher-Tippett-Gnedenkoå®šç†ï¼ˆæå€¼ç†è®ºç¬¬ä¸€å®šç†ï¼‰ï¼š</p><blockquote><p><strong>THEOREM: </strong>(Fisher-Tippett-Gnedenko). ä»¤<span class="math inline">\(X_1,X_2,\cdots,X_n,\cdots\)</span>ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡åºåˆ—ï¼Œ<span class="math inline">\(M_n=\max \{X_1,\cdots,X_n\}\)</span>ã€‚å¦‚æœå®æ•°å¯¹åºåˆ—<span class="math inline">\((a_n,b_n)\)</span>å­˜åœ¨ä¸”æ»¡è¶³<span class="math inline">\(a_n&gt;0\)</span>å’Œ<span class="math inline">\(\lim\limits_{n\rightarrow \infty}P\left(\frac{M_n-b_n}{a_n}\leq x\right)=F(x)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(F\)</span>ä¸ºéé€€åŒ–åˆ†å¸ƒå‡½æ•°ï¼Œé‚£ä¹ˆ<span class="math inline">\(F\)</span>å±äºGumbelã€FrÃ©chetæˆ–Weibullåˆ†å¸ƒæ—ï¼ˆæˆ–æ€»ç§°Generalized Extreme Value Distributionï¼‰ä¸­çš„ä¸€ç§ã€‚</p></blockquote><p>è¿™æ˜¯ä¸€ä¸ªåç›´è§‰çš„ç»“è®ºï¼Œä½†æ˜¯æƒ³åˆ°å½“äº‹ä»¶å‘ç”Ÿå˜å¾—æç«¯æ—¶ï¼Œå³<span class="math inline">\(\mathbb{P}(X&gt;x)\rightarrow 0\)</span>ï¼Œ<span class="math inline">\(\bar{F}(x)=\mathbb{P}(X&gt;x)\)</span>åˆ†å¸ƒçš„å½¢çŠ¶å…¶å®å¹¶æ²¡æœ‰å¾ˆå¤šç§é€‰æ‹©ã€‚Table 1å±•ç¤ºäº†å‡ ç§ä¸åŒåˆ†å¸ƒå¯¹åº”çš„<span class="math inline">\(\gamma\)</span>ï¼š</p><p><img src="https://i.loli.net/2020/06/24/jyhoWZGc2gFTrJv.png" srcset="/img/loading.gif" /></p><p>Figure 1å±•ç¤ºäº†å‡ ç§ä¸åŒ<span class="math inline">\(\gamma\)</span>æƒ…å†µä¸‹çš„â€œæœ«å°¾â€åˆ†å¸ƒï¼š</p><p><img src="https://i.loli.net/2020/06/24/4rmZL1AMcBJ2Vzq.png" srcset="/img/loading.gif" /></p><h2 id="power-of-evt">Power of EVT</h2><p>æ ¹æ®<strong>Extreme Value Theory</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸå§‹åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹è®¡ç®—æç«¯äº‹ä»¶çš„æ¦‚ç‡ã€‚ä½†æ˜¯<span class="math inline">\(\bar{G}_\gamma\)</span>åˆ†å¸ƒä¸­å‚æ•°<span class="math inline">\(\gamma\)</span>æ˜¯æœªçŸ¥çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§é«˜æ•ˆçš„æ–¹æ³•æ¥è¿›è¡Œä¼°è®¡ã€‚<strong>The Peaks-Over-Threshold</strong> (POT) æ–¹æ³•æ˜¯æœ¬æ–‡ä»‹ç»çš„ä¸€ç§æ–¹æ³•ã€‚</p><p><img src="https://i.loli.net/2020/06/24/hX2T1IkMAqfioZl.png" srcset="/img/loading.gif" /></p><h2 id="peaks-over-threshold-approach">Peaks-Over-Threshold Approach</h2><p>POTæ–¹æ³•ä¾èµ–äºPickands-Balkema-De Haanå®šç†ï¼ˆæå€¼ç†è®ºç¬¬äºŒå®šç†ï¼‰ï¼Œç»´åŸºç™¾ç§‘ç‰ˆï¼š</p><blockquote><p>è€ƒè™‘ä¸€ä¸ªæœªçŸ¥åˆ†å¸ƒ<span class="math inline">\(F\)</span>å’Œéšæœºå˜é‡<span class="math inline">\(X\)</span>ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡<span class="math inline">\(X\)</span>åœ¨è¶…è¿‡ç¡®å®šé˜ˆå€¼<span class="math inline">\(u\)</span>ä¸‹çš„æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(F_u\)</span>ï¼Œå®šä¹‰ä¸ºï¼š <span class="math display">\[F_u(y)=P(X-u\leq y|X&gt;u)=\frac{F(u+y)-F(u)}{1-F(u)}\]</span> å…¶ä¸­<span class="math inline">\(0\leq y\leq x_F-u\)</span>ï¼Œ<span class="math inline">\(x_F\)</span>ä¸º<span class="math inline">\(F\)</span>çš„å³ç«¯ç‚¹ã€‚<span class="math inline">\(F_u\)</span>æè¿°äº†è¶…è¿‡ç‰¹å¾é˜ˆå€¼<span class="math inline">\(u\)</span>çš„åˆ†å¸ƒï¼Œç§°ä¸º<strong>Conditional Excess Distribution Function</strong>ã€‚</p><p><strong>STATEMENT: </strong>(Pickands-Balkema-De Haan). è®¾<span class="math inline">\((X_1,X_2,\cdots)\)</span>ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒéšæœºå˜é‡åºåˆ—ï¼Œ<span class="math inline">\(F_u\)</span>ä¸ºç›¸åº”çš„Conditional Excess Distribution Functionã€‚å¯¹äºä¸€å¤§ç±»çš„<span class="math inline">\(F\)</span>å’Œå¾ˆå¤§çš„<span class="math inline">\(u\)</span>ï¼Œ<span class="math inline">\(F_u\)</span>èƒ½å¤Ÿå¾ˆå¥½çš„è¢«Generalized Pareto Distributionæ‰€æ‹Ÿåˆï¼š <span class="math display">\[F_u(y)\rightarrow G_{k,\sigma}(y),\space\space \text{as } u\rightarrow \infty\]</span> å…¶ä¸­ï¼š <span class="math display">\[G_{k,\sigma}(y)=\begin{cases}1-(1+ky/\sigma)^{-1/k}, &amp;\text{if }k\neq 0\\1-e^{-y/\sigma}, &amp;\text{if }k=0\end{cases}\]</span> å½“<span class="math inline">\(k\geq 0\)</span>æ—¶<span class="math inline">\(\sigma&gt;0, y\geq 0\)</span>ï¼Œ<span class="math inline">\(k&lt;0\)</span>æ—¶<span class="math inline">\(0\leq y\leq -\sigma/k\)</span>ã€‚</p></blockquote><p>è®ºæ–‡ä¸­ç»™å‡ºçš„å®šç†å¦‚ä¸‹ï¼š</p><blockquote><p><strong>THEOREM: </strong>(Pickands-Balkema-De Haan). ç´¯ç§¯æ¦‚ç‡å¯†åº¦å‡½æ•°<span class="math inline">\(F\in\mathcal{D}_\gamma\)</span>å½“ä¸”ä»…å½“å‡½æ•°<span class="math inline">\(\sigma\)</span>å­˜åœ¨æ—¶ï¼Œå¯¹æ‰€æœ‰<span class="math inline">\(x\in\mathbb{R}\)</span>åœ¨<span class="math inline">\(1+\gamma x&gt;0\)</span>çš„æ¡ä»¶ä¸‹æœ‰ï¼š <span class="math display">\[\frac{\bar{F}(t+\sigma(t)x)}{\bar{F}(t)}\mathop{\rightarrow}\limits_{t\rightarrow\tau}(1+\gamma x)^{-\frac{1}{\gamma}}\]</span></p></blockquote><p>ä¸Šå¼å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š <span class="math display">\[\bar{F}_t(x)=\mathbb{P}(X-t&gt;x|X&gt;t)\mathop{\sim}\limits_{t\rightarrow\tau}\left(1+\frac{\gamma x}{\sigma(t)}\right)^{-\frac{1}{\gamma}}\]</span> è¯¥å¼è¡¨æ˜<span class="math inline">\(X\)</span>è¶…è¿‡é˜ˆå€¼<span class="math inline">\(t\)</span>çš„æ¦‚ç‡ï¼ˆå†™ä¸º<span class="math inline">\(X-t\)</span>ï¼‰æœä»<strong>Generalized Pareto Distribution</strong> (GPD)ï¼Œå‚æ•°ä¸º<span class="math inline">\(\gamma\)</span>å’Œ<span class="math inline">\(\sigma\)</span>ã€‚POTä¸»è¦æ˜¯æ‹ŸåˆGPDè€Œä¸æ˜¯EVTåˆ†å¸ƒã€‚</p><p>å¦‚æœæˆ‘ä»¬è¦ä¼°è®¡å‚æ•°<span class="math inline">\(\hat{\gamma}\)</span>å’Œ<span class="math inline">\(\hat{\sigma}\)</span>ï¼Œåˆ†ä½æ•°å¯ä»¥é€šè¿‡ä¸‹å¼è®¡ç®—å¾—åˆ°ï¼š <span class="math display">\[z_q\simeq t+\frac{\hat{\sigma}}{\hat{\gamma}}\left(\left(\frac{qn}{N_t}\right)^{-\hat{\gamma}}-1\right)\]</span></p><p>å…¶ä¸­<span class="math inline">\(t\)</span>æ˜¯ä¸€ä¸ªâ€œå¾ˆé«˜â€çš„é˜ˆå€¼ï¼Œ<span class="math inline">\(q\)</span>æ˜¯ç»™å®šçš„æ¦‚ç‡å€¼ï¼Œ<span class="math inline">\(n\)</span>æ˜¯æ‰€æœ‰è§‚æµ‹æ ·æœ¬çš„æ•°é‡ï¼Œ<span class="math inline">\(N_t\)</span>æ˜¯peaksçš„æ•°é‡ï¼Œå³<span class="math inline">\(X_i&gt;t\)</span>çš„æ•°é‡ã€‚ä¸ºäº†è¿›è¡Œé«˜æ•ˆçš„å‚æ•°ä¼°è®¡ï¼Œæ–‡ä¸­ä½¿ç”¨äº†æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p><h2 id="maximum-likelihood-estimation">Maximum Likelihood Estimation</h2><p>è®¾<span class="math inline">\(X_1,\cdots,X_n\)</span>ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°è®°ä¸º<span class="math inline">\(f_\theta\)</span>ï¼Œ<span class="math inline">\(\theta\)</span>ä¸ºåˆ†å¸ƒä¸­çš„å‚æ•°ï¼Œé‚£ä¹ˆä¼¼ç„¶å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p><p><span class="math display">\[\mathcal{L}(X_1,\cdots,X_n;\theta)=\prod\limits_{i=1}^n f_\theta(X_i)\]</span></p><p>åœ¨æå¤§ä¼¼ç„¶ä¼°è®¡ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°åˆé€‚çš„å‚æ•°ä½¿å¾—ä¼¼ç„¶å‡½æ•°æœ€å¤§åŒ–ã€‚åœ¨æˆ‘ä»¬çš„é—®é¢˜ä¸­ï¼Œä¼¼ç„¶å‡½æ•°å¦‚ä¸‹ï¼š <span class="math display">\[\log\mathcal{L}(\gamma,\sigma)=-N_t\log\sigma-\left(1+\frac{1}{\gamma}\right)\sum\limits_{i=1}^{N_t}\log\left(1+\frac{\gamma}{\sigma}Y_i\right)\]</span> å…¶ä¸­<span class="math inline">\(Y_i&gt;0\)</span>è¡¨ç¤º<span class="math inline">\(X_i\)</span>è¶…è¿‡é˜ˆå€¼<span class="math inline">\(t\)</span>çš„éƒ¨åˆ†ã€‚</p><p>æ–‡ä¸­ä½¿ç”¨äº†<strong>Grimshaw's Trick</strong>æ¥å°†å«ä¸¤ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜è½¬æ¢ä¸ºåªå«ä¸€ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜ã€‚è®°<span class="math inline">\(\ell(\gamma,\sigma)=\log\mathcal{L}(\gamma,\sigma)\)</span>ï¼Œå¯¹äºæ‰€æœ‰æå€¼æ¥è¯´æœ‰<span class="math inline">\(\nabla \ell(\gamma, \sigma)=0\)</span>ã€‚Grimshaw's Trickè¡¨æ˜å¯¹äºæ»¡è¶³<span class="math inline">\(\nabla \ell(\gamma, \sigma)=0\)</span>çš„ä¸€å¯¹<span class="math inline">\((\gamma^*,\sigma^*)\)</span>ï¼Œ<span class="math inline">\(x^*=\frac{\gamma^*}{\sigma^*}\)</span>ä¸ºç­‰å¼<span class="math inline">\(u(X)v(X)=1\)</span>çš„è§£ï¼Œå…¶ä¸­ï¼š <span class="math display">\[\begin{align}u(x)&amp;=\frac{1}{N_t}\sum\limits_{i=1}^{N_t}\frac{1}{1+xY_i}\\v(x)&amp;=1+\frac{1}{N_t}\sum\limits_{i=1}^{N_t}\log(1+xY_i)\end{align}\]</span> åœ¨æ‰¾åˆ°æ»¡è¶³è¯¥ç­‰å¼çš„è§£<span class="math inline">\(x^*\)</span>åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<span class="math inline">\(\gamma^*=v(x^*)-1\)</span>å’Œ<span class="math inline">\(\sigma^*=\gamma^*/x^*\)</span>ï¼Œäºæ˜¯é—®é¢˜å°±å˜æˆäº†å¦‚ä½•å¯»æ‰¾æ–¹ç¨‹çš„æ‰€æœ‰æ ¹ã€‚</p><p>å› ä¸º<span class="math inline">\(\log\)</span>çš„å­˜åœ¨ï¼Œæ‰€ä»¥æœ‰<span class="math inline">\(1+xY_i&gt;0\)</span>ã€‚è€Œ<span class="math inline">\(Y_i\)</span>æ˜¯æ­£æ•°ï¼Œæ‰€ä»¥<span class="math inline">\(x^*\)</span>çš„èŒƒå›´ä¸€å®šåœ¨<span class="math inline">\(\left(-\frac{1}{Y^M},+\infty\right)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(Y^M=\max Y_i\)</span>ã€‚</p><p>Grimshawï¼ˆä½œè€…å‚è€ƒçš„ä¸€ç¯‡<a href="https://www.tandfonline.com/doi/abs/10.1080/00401706.1993.10485040" target="_blank" rel="noopener">è®ºæ–‡</a>ï¼‰è¿˜ç»™å‡ºäº†ä¸€ä¸ªä¸Šç•Œï¼š <span class="math display">\[x^*_{\text{max}}=2\frac{\bar{Y}-Y^m}{(Y^m)^2}\]</span> å…¶ä¸­<span class="math inline">\(Y^m=\min Y_i\)</span>ï¼Œ<span class="math inline">\(\bar{Y}\)</span>ä¸º<span class="math inline">\(Y_i\)</span>çš„å‡å€¼ã€‚è¯¦ç»†çš„ä¼˜åŒ–æ–¹æ³•ä¼šåœ¨ä¸‹æ–‡è®¨è®ºã€‚</p><p>èƒŒæ™¯éƒ¨åˆ†åˆ°æ­¤ç»“æŸï¼Œæ¥ä¸‹æ¥çš„éƒ¨åˆ†å°±æ˜¯ä½œè€…æå‡ºçš„æ–°æ–¹æ³•ã€‚</p><h1 id="methodology">Methodology</h1><p>Extreme Value Theoryç»™å‡ºäº†åœ¨å¯¹åŸå§‹åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡ä½¿å¾—<span class="math inline">\(\mathbb{P}(X&gt;z_q)&lt;q\)</span>çš„<span class="math inline">\(z_q\)</span>çš„æ–¹æ³•ã€‚</p><p>æœ¬æ–‡æ®æ­¤æå‡ºäº†æ—¶é—´åºåˆ—æµçš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚é¦–å…ˆæ ¹æ®å·²çŸ¥çš„è§‚æµ‹å€¼<span class="math inline">\(X_1,\cdots,X_n\)</span>å¾—åˆ°é˜ˆå€¼<span class="math inline">\(z_q\)</span>ï¼Œç„¶åæ ¹æ®æ•°æ®çš„ç‰¹æ€§è¿ç”¨ä¸¤ç§ä¸åŒæ–¹æ³•æ¥æ›´æ–°<span class="math inline">\(z_q\)</span>ã€‚å¯¹äºå¹³ç¨³æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨SPOTï¼›å¯¹äºéå¹³ç¨³æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨DSPOTã€‚</p><h2 id="initialization-step">Initialization Step</h2><p>åœ¨è¿›è¡Œå¼‚å¸¸æ£€æµ‹ä¹‹å‰ï¼Œéœ€è¦æ ¹æ®å·²æœ‰çš„è§‚æµ‹æ•°æ®è¿›è¡Œ<span class="math inline">\(z_q\)</span>çš„ä¼°è®¡ã€‚ç»™å®š<span class="math inline">\(n\)</span>ä¸ªè§‚æµ‹å€¼<span class="math inline">\(X_1,\cdots,X_n\)</span>å’Œä¸€ä¸ªå›ºå®šçš„æ¦‚ç‡å€¼<span class="math inline">\(q\)</span>ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡é˜ˆå€¼<span class="math inline">\(z_q\)</span>ä½¿å¾—<span class="math inline">\(\mathbb{P}(X&gt;z_q)&lt;q\)</span>ã€‚å…¶ä¸»è¦æµç¨‹æ˜¯é¦–å…ˆè®¾å®šä¸€ä¸ªè¾ƒå¤§çš„é˜ˆå€¼<span class="math inline">\(t\)</span>ï¼Œç„¶åé€šè¿‡æ‹ŸåˆGPDåˆ†å¸ƒæ¥è®¡ç®—<span class="math inline">\(z_q\)</span>ã€‚è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/24/fzeC8vuDtA6mEdl.png" srcset="/img/loading.gif" /></p><p>ç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/24/AEQpnZPiW3C4mr7.png" srcset="/img/loading.gif" /></p><p><span class="math inline">\(Y_t\)</span>ä»£è¡¨å¤§äº<span class="math inline">\(t\)</span>çš„è§‚æµ‹å€¼çš„é›†åˆï¼ŒGPDåˆ†å¸ƒçš„æ‹Ÿåˆä½¿ç”¨äº†å‰æ–‡æåˆ°çš„Grimshaw's Trickã€‚</p><h2 id="finding-anomalies-in-a-stream">Finding Anomalies in a Stream</h2><p>é€šè¿‡Initialization Stepä½¿ç”¨POTç®—æ³•å¾—åˆ°çš„<span class="math inline">\(z_q\)</span>ï¼Œæˆ‘ä»¬å®šä¹‰å…¶ä¸º"Normality Bound"ï¼Œç”¨äºåé¢çš„æ£€æµ‹ã€‚åœ¨åé¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®æ–°å¾—åˆ°çš„è§‚æµ‹å€¼æ¥æ›´æ–°<span class="math inline">\(z_q\)</span>ã€‚</p><h3 id="stationary-case">Stationary Case</h3><p>æˆ‘ä»¬é¦–å…ˆæ¥è®¨è®ºæ—¶é—´åºåˆ—æ²¡æœ‰æ—¶é—´ä¾èµ–æ€§çš„æƒ…å†µï¼ˆ<span class="math inline">\(X_1,\cdots,X_n\)</span>ä¹‹é—´ç‹¬ç«‹åŒåˆ†å¸ƒï¼‰ã€‚é€šè¿‡POTç®—æ³•å¯¹æ‰€æœ‰è§‚æµ‹å€¼å¾—åˆ°<span class="math inline">\(z_q\)</span>ä¹‹åï¼ŒStreaming POT (SPOT) ç®—æ³•ä¼šæ£€æŸ¥<span class="math inline">\(X_n\)</span>ä¹‹åçš„å€¼ï¼ˆæ•°æ®æµåœºæ™¯ï¼Œ<span class="math inline">\(X_1,\cdots,X_n\)</span>æ˜¯å†å²æ•°æ®ï¼Œè¿˜ä¼šæœ‰æ–°çš„æ•°æ®è¿›æ¥ï¼‰ï¼Œå¦‚æœå¤§äº<span class="math inline">\(z_q\)</span>ï¼Œåˆ™å°†<span class="math inline">\(X_i\)</span>åŠ å…¥å¼‚å¸¸ç‚¹é›†åˆä¸­ï¼›å¦‚æœå¤§äº<span class="math inline">\(t\)</span>ä½†å°äº<span class="math inline">\(z_q\)</span>ï¼Œåˆ™å°†<span class="math inline">\(X_i\)</span>åŠ å…¥è§‚æµ‹å€¼é›†åˆä¸­ï¼Œæ›´æ–°<span class="math inline">\(z_q\)</span>ï¼›å…¶ä»–æƒ…å†µæˆ‘ä»¬<span class="math inline">\(X_i\)</span>æ˜¯æ­£å¸¸æƒ…å†µã€‚ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/h5yKnlCAYxbHu2R.png" srcset="/img/loading.gif" /></p><h3 id="drifting-case">Drifting Case</h3><p>SPOTç®—æ³•åªé€‚ç”¨äºå¹³ç¨³åˆ†å¸ƒçš„æƒ…å†µï¼Œä½†åœ¨ç°å®ç”Ÿæ´»ä¸­è¿™æ ·çš„å‡è®¾è¿‡å¼ºäº†ã€‚äºæ˜¯ä½œè€…æå‡ºäº†èƒ½å¤„ç†æ—¶é—´ä¾èµ–æ€§çš„Streaming POT with Drift (DSPOT) ç®—æ³•ã€‚</p><p><img src="https://i.loli.net/2020/06/25/O49XwQvVGH7k1ri.png" srcset="/img/loading.gif" /></p><p>åœ¨DSPOTä¸­ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨<span class="math inline">\(X_i\)</span>çš„ç»å¯¹å€¼ï¼Œè€Œæ˜¯ç”¨ç›¸å¯¹å€¼<span class="math inline">\(X^\prime_i=X_i-M_i\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(M_i\)</span>æ˜¯<span class="math inline">\(i\)</span>æ—¶åˆ»çš„å±€éƒ¨ç‰¹å¾ï¼Œå¦‚Figure 4æ‰€ç¤ºã€‚æœ€ç®€å•çš„å®ç°æ˜¯ä½¿ç”¨å±€éƒ¨å‡å€¼ï¼Œå³<span class="math inline">\(M_i=(1/d)\cdot\sum\limits_{k=1}^d X_{i-k}^*\)</span>ï¼Œ<span class="math inline">\(X_{i-1}^*,\cdots,X_{i-d}^*\)</span>æ˜¯é•¿åº¦ä¸º<span class="math inline">\(d\)</span>çš„çª—å£ã€‚æˆ‘ä»¬å‡è®¾<span class="math inline">\(X^\prime_i\)</span>æœä»å¹³ç¨³åˆ†å¸ƒçš„å‡è®¾ã€‚</p><p>ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/P6hOsD9dnNIHvUV.png" srcset="/img/loading.gif" /></p><h2 id="numerical-optimization">Numerical Optimization</h2><p>ç°åœ¨å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯ä¼˜åŒ–äº†ï¼Œå‰æ–‡å·²ç»æåˆ°å¯¹GPDçš„æ‹Ÿåˆå·²ç»è¢«ä¼˜åŒ–æˆä¸€ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜ï¼Œä¸‹é¢å°†ä¼šè¯¦ç»†è®¨è®ºä¼˜åŒ–ç®—æ³•ã€‚</p><h3 id="reduction-of-the-optimal-parameters-search">Reduction of the Optimal Parameters Search</h3><p>å‰æ–‡å·²ç»å¾—åˆ°äº†ä¸€ä¸ªåˆæ­¥çš„<span class="math inline">\(x^*\)</span>çš„Boundï¼Œå³<span class="math inline">\(x^*&gt;-\frac{1}{Y^M}\)</span>å’Œ<span class="math inline">\(x^*\leq 2\frac{\bar{Y}-Y^m}{(Y^m)^2}\)</span>ï¼Œä¸‹é¢å°†ç»™å‡ºä¸€ä¸ªæ›´ä¸¥æ ¼çš„Boundã€‚</p><blockquote><p><strong>PROPOSITION: </strong>å¦‚æœ<span class="math inline">\(x^*\)</span>æ˜¯<span class="math inline">\(u(x)v(x)=1\)</span>çš„è§£ï¼Œé‚£ä¹ˆï¼š <span class="math display">\[x^*\leq 0 \text{ or } x^*\geq 2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m}\]</span></p></blockquote><p>è¯æ˜è§è®ºæ–‡åŸæ–‡ã€‚</p><p>è¿™æ ·<span class="math inline">\(x^*\)</span>çš„èŒƒå›´å°±è¿›ä¸€æ­¥ç¼©å°äº†ï¼Œäºæ˜¯æœ‰<span class="math inline">\(u(x)v(X)=1\)</span>çš„è§£<span class="math inline">\(x^*\)</span>åœ¨ä»¥ä¸‹èŒƒå›´ä¹‹å†…ï¼š <span class="math display">\[\left(-\frac{1}{Y^M},0\right]\text{ and }\left[2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m},2\frac{\bar{Y}-Y^m}{(Y^m)^2}\right]\]</span></p><h3 id="how-can-we-maximize-the-likelihood-function">How Can We Maximize the Likelihood Function?</h3><p>æ¥ä¸‹æ¥æ˜¯ä¼˜åŒ–çš„å…·ä½“å®ç°é—®é¢˜ã€‚æ–‡ä¸­é¦–å…ˆè®¾å®šäº†ä¸€ä¸ªå¾ˆå°çš„å€¼<span class="math inline">\(\epsilon&gt;0\space(\sim 10^{-8})\)</span>ï¼Œç„¶ååœ¨ä¸‹é¢çš„èŒƒå›´å†…å¯»æ‰¾å‡½æ•°<span class="math inline">\(w:x\mapsto u(x)v(x)-1\)</span>çš„æ ¹ï¼š <span class="math display">\[\left[-\frac{1}{Y^M}+\epsilon,-\epsilon\right]\text{ and }\left[2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m},2\frac{\bar{Y}-Y^m}{(Y^m)^2}\right]\]</span> ä½œè€…æ²¡æœ‰ä½¿ç”¨ç°æœ‰çš„å¯»æ‰¾å‡½æ•°æ ¹çš„ç®—æ³•ï¼Œè€Œæ˜¯è½¬æ¢ä¸ºå¦‚ä¸‹ä¼˜åŒ–é—®é¢˜ï¼š <span class="math display">\[\min\limits_{x_1,\cdots,x_k\in I}\sum\limits_{i=1}^k w(x_k)^2\]</span> å…¶ä¸­<span class="math inline">\(I\)</span>å°±æ˜¯<span class="math inline">\(x^*\)</span>çš„Boundã€‚è¯¥é—®é¢˜æ˜¯ä¸€ä¸ªå¾ˆå…¸å‹çš„ä¼˜åŒ–é—®é¢˜ï¼Œå¯ä»¥è¢«å¾ˆå¤šæˆç†Ÿçš„ç®—æ³•æ‰€è§£å†³ã€‚</p><h3 id="initial-threshold">Initial Threshold</h3><p>åœ¨ç®—æ³•çš„Initialization Stepï¼Œéœ€è¦äº‹å…ˆè®¾å®šä¸€ä¸ªé˜ˆå€¼<span class="math inline">\(t\)</span>ï¼Œå¦‚æœè®¾å®šçš„å¤ªå¤§ï¼Œé‚£ä¹ˆ<span class="math inline">\(Y_t\)</span>çš„æ•°é‡å°±ä¼šå¾ˆå°‘ã€‚ä½œè€…ç»™å‡ºçš„å»ºè®®æ˜¯ä¿è¯<span class="math inline">\(t&lt;z_q\)</span>ï¼Œå³<span class="math inline">\(t\)</span>å¯¹åº”çš„æ¦‚ç‡å€¼åº”è¯¥å°äº<span class="math inline">\(1-q\)</span>ã€‚</p><h1 id="experiments">Experiments</h1><p>åœ¨å®éªŒéƒ¨åˆ†ï¼Œä½œè€…åœ¨åˆæˆæ•°æ®å’ŒçœŸå®æ•°æ®ä¸Šè¯•éªŒäº†SPOTç®—æ³•å’ŒDSPOTç®—æ³•çš„æœ‰æ•ˆæ€§ã€‚</p><h2 id="dspot-reliability">(D)SPOT Reliability</h2><p>ä½œè€…é¦–å…ˆåœ¨åˆæˆæ•°æ®ä¸ŠéªŒè¯SPOTçš„æœ‰æ•ˆæ€§ã€‚å…·ä½“åšæ³•æ˜¯ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒç”Ÿæˆæ•°æ®ï¼ˆé«˜æ–¯åˆ†å¸ƒçš„åˆ†ä½æ•°èƒ½å¤Ÿç›´æ¥è®¡ç®—ï¼‰ï¼Œç„¶åå°†SPOTå¾—å‡ºçš„<span class="math inline">\(z_q\)</span>å’Œç†è®ºå€¼è¿›è¡Œå¯¹æ¯”ã€‚è¯¯å·®å®šä¹‰å¦‚ä¸‹ï¼š <span class="math display">\[\text{error rate}=\left|\frac{z^{\text{SPOT}}-z^{\text{th}}}{z^{\text{th}}}\right|\]</span> ä¸‹å›¾æ˜¯é‡‡ç”¨ä¸åŒæ•°é‡è§‚æµ‹å€¼çš„ç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/GXlu2MAJaoqxyd4.png" srcset="/img/loading.gif" /></p><h2 id="finding-anomalies-with-spot">Finding Anomalies with SPOT</h2><p>åœ¨è¿™ä¸€èŠ‚ä½œè€…åœ¨çœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒä»¥éªŒè¯SPOTç®—æ³•çš„æœ‰æ•ˆæ€§ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2020/06/25/wTkZxKarFVDOlp6.png" srcset="/img/loading.gif" /></p><p>åœ¨æ–‡ä¸­ä½œè€…è¯´ç®—æ³•çš„True Positiveè¾¾åˆ°äº†<span class="math inline">\(86\%\)</span>ï¼ŒFalse Positiveå°äº<span class="math inline">\(4\%\)</span>ã€‚</p><p><img src="https://i.loli.net/2020/06/25/RcUnwtHud7DjNXv.png" srcset="/img/loading.gif" /></p><h2 id="finding-anomalies-with-dspot">Finding Anomalies with DSPOT</h2><p>åœ¨è¿™ä¸€èŠ‚ä½œè€…ä½¿ç”¨DSPOTåœ¨çœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒã€‚çª—å£å¤§å°<span class="math inline">\(d=450\)</span>ï¼Œé¢„è®¾çš„é£é™©æ¦‚ç‡å€¼<span class="math inline">\(q=10^{-3}\)</span>ã€‚ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/lIxqpnGtL7feVKs.png" srcset="/img/loading.gif" /></p><p>åœ¨å›¾ä¸­å¯ä»¥çœ‹å‡ºåœ¨<span class="math inline">\(8000\)</span> Minutesä¹‹åä¸Šç•Œæ˜¾è‘—æé«˜ï¼Œä½œè€…åˆ†æäº†åŸå› ï¼Œè®¤ä¸ºæ˜¯å› ä¸ºè¶…è¿‡é˜ˆå€¼<span class="math inline">\(t\)</span>çš„ç‚¹<span class="math inline">\(Y_t\)</span>çš„å­˜å‚¨æ˜¯å…¨å±€çš„ï¼Œåœ¨å‰<span class="math inline">\(8000\)</span> Minutesç®—æ³•å­˜å‚¨äº†å¾ˆå¤šè¾ƒé«˜çš„<span class="math inline">\(Y_t\)</span>å€¼ï¼Œè€Œåœ¨<span class="math inline">\(8000\)</span> Minutesä¹‹åï¼ŒçœŸå®æ•°æ®çš„è¶‹åŠ¿å¼€å§‹ä¸‹é™ï¼Œä½†ç®—æ³•ä»æ˜¯æ ¹æ®å…¨å±€çš„<span class="math inline">\(Y_t\)</span>æ¥è¿›è¡Œ<span class="math inline">\(z_q\)</span>çš„è®¡ç®—ï¼ˆè¿™ä¸€æ®µæ²¡æœ‰ç‰¹åˆ«æ˜ç™½ï¼‰ã€‚ä½œè€…ç»™å‡ºçš„ä¿®æ­£æ–¹æ³•æ˜¯åªä¿å­˜å›ºå®šæ•°é‡çš„Peaksã€‚</p><p>ä¸‹å›¾æ˜¯ä½œè€…åœ¨è‚¡ç¥¨æ•°æ®ä¸Šå¾—åˆ°çš„å®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/VeEo8OPbzyUxXrR.png" srcset="/img/loading.gif" /></p><h2 id="performances">Performances</h2><p>ä½œè€…è¿˜éªŒè¯äº†ç®—æ³•çš„æ—¶é—´æ•ˆç‡ã€‚</p><p><img src="https://i.loli.net/2020/06/25/Egh7CxsU2TtL6az.png" srcset="/img/loading.gif" /></p><p>è¡¨ä¸­Tä»£è¡¨çš„æ˜¯æ¯ä¸ªIterationçš„æ—¶é—´ï¼ŒMä»£è¡¨çš„æ˜¯Peaksçš„æ¯”ä¾‹ï¼Œ"bi-"å‰ç¼€ä»£è¡¨çš„æ˜¯åŒæ—¶è®¡ç®—ä¸Šç•Œå’Œä¸‹ç•Œã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Statistics</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>An Introduction to Variational Autoencoders</title>
    <link href="/2019/10/22/An-Introduction-to-Variational-Autoencoders/"/>
    <url>/2019/10/22/An-Introduction-to-Variational-Autoencoders/</url>
    
    <content type="html"><![CDATA[<h1 id="deep-generative-models">Deep Generative Models</h1><p>ç”Ÿæˆæ¨¡å‹æ˜¯æŒ‡ä¸€ç³»åˆ—ç”¨äºéšæœºç”Ÿæˆå¯è§‚æµ‹æ•°æ®çš„æ¨¡å‹ã€‚å‡è®¾åœ¨ä¸€ä¸ªé«˜ç»´ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªéšæœºå‘é‡<span class="math inline">\(\mathbf{X}\)</span>æœä»ä¸€ä¸ªæœªçŸ¥çš„åˆ†å¸ƒ<span class="math inline">\(p_r(x),x\in \mathcal{X}\)</span>ã€‚ç”Ÿæˆæ¨¡å‹å°±æ˜¯æ ¹æ®ä¸€äº›å¯è§‚æµ‹çš„æ ·æœ¬<span class="math inline">\(x^{(1)},x^{(2)},\cdots,x^{(N)}\)</span>æ¥å­¦ä¹ ä¸€ä¸ªå‚æ•°åŒ–çš„æ¨¡å‹<span class="math inline">\(p_\theta(x)\)</span>æ¥è¿‘ä¼¼æœªçŸ¥åˆ†å¸ƒ<span class="math inline">\(p_r(x)\)</span>ã€‚</p><p>ç”Ÿæˆæ¨¡å‹ä¸»è¦ç”¨äºå¯†åº¦ä¼°è®¡å’Œæ ·æœ¬ç”Ÿæˆã€‚</p><hr /><p>å¯†åº¦ä¼°è®¡å³ç»™å®šä¸€ç»„æ•°æ®<span class="math inline">\(\mathcal{D}=\{x^{(i)}\},1\leq i\leq N\)</span>ï¼Œå‡è®¾ä»–ä»¬éƒ½æ˜¯ä»ç›¸åŒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°<span class="math inline">\(p_r(x)\)</span>ç‹¬ç«‹äº§ç”Ÿçš„ã€‚å¯†åº¦ä¼°è®¡å°±æ˜¯æ ¹æ®æ•°æ®é›†<span class="math inline">\(\mathcal{D}\)</span>æ¥ä¼°è®¡å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°<span class="math inline">\(p_r(x)\)</span>ã€‚</p><p>å¦‚æœå°†ç”Ÿæˆæ¨¡å‹ç”¨äºç›‘ç£å­¦ä¹ ï¼Œé‚£ä¹ˆå°±æ˜¯è¾“å‡ºæ ‡ç­¾çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(y|x)\)</span>ï¼Œæ ¹æ®è´å¶æ–¯å…¬å¼ï¼š</p><p><span class="math display">\[p(y|x)=\frac{p(x,y)}{\sum_y p(x,y)}\]</span></p><p>é—®é¢˜å°±å˜ä¸ºäº†è”åˆæ¦‚ç‡<span class="math inline">\(p(x,y)\)</span>çš„å¯†åº¦ä¼°è®¡é—®é¢˜ã€‚</p><hr /><p>æ ·æœ¬ç”Ÿæˆå³æ ¹æ®ç»™å®šçš„æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p_\theta(x)\)</span>ç”Ÿæˆä¸€äº›æœä»è¿™ä¸ªåˆ†å¸ƒçš„æ ·æœ¬ï¼Œå³é‡‡æ ·ã€‚åœ¨å«éšå˜é‡çš„ç”Ÿæˆæ¨¡å‹ä¸­ï¼Œç”Ÿæˆ<span class="math inline">\(x\)</span>çš„è¿‡ç¨‹ä¸€èˆ¬åŒ…å«ä¸¤æ­¥ï¼š</p><ol type="1"><li>æ ¹æ®éšå˜é‡çš„åˆ†å¸ƒ<span class="math inline">\(p_\theta(z)\)</span>é‡‡æ ·å¾—åˆ°<span class="math inline">\(z\)</span>ï¼›</li><li>æ ¹æ®æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p_\theta(x|z;\theta)\)</span>è¿›è¡Œé‡‡æ ·å¾—åˆ°<span class="math inline">\(x\)</span>ã€‚</li></ol><p>æ‰€ä»¥åœ¨ç”Ÿæˆæ¨¡å‹ä¸­çš„é‡ç‚¹æ˜¯ä¼°è®¡æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>ã€‚</p><h1 id="parameter-estimation-for-hidden-variable-with-em-algorithm">Parameter Estimation for Hidden Variable with EM Algorithm</h1><p>å¦‚æœå›¾æ¨¡å‹ä¸­å­˜åœ¨éšå˜é‡ï¼Œå°±éœ€è¦ä½¿ç”¨EMç®—æ³•è¿›è¡Œå‚æ•°ä¼°è®¡ã€‚</p><p>åœ¨ä¸€ä¸ªåŒ…å«éšå˜é‡çš„å›¾æ¨¡å‹ä¸­ï¼Œä»¤<span class="math inline">\(\mathbf{X}\)</span>ä¸ºå¯è§‚æµ‹å˜é‡é›†åˆï¼Œ<span class="math inline">\(\mathbf{Z}\)</span>ä¸ºéšå˜é‡é›†åˆï¼Œåˆ™ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>çš„è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p><p><span class="math display">\[p(x;\theta)=\sum_z p(x,z;\theta)\]</span></p><p>ç»™å®šåŒ…å«<span class="math inline">\(N\)</span>ä¸ªè®­ç»ƒæ ·æœ¬çš„è®­ç»ƒé›†<span class="math inline">\(\mathcal{D}=\{x^{(n)}\},1\leq i\leq N\)</span>ï¼Œåˆ™è®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¸ºï¼š</p><p><span class="math display">\[\begin{align}\mathcal{L}(\mathcal{D};\theta)&amp;=\frac{1}{N}\sum_{n=1}^N \log p(x^{(n)};\theta)\\&amp;=\frac{1}{N}\sum_{n=1}^N \log \sum_z p(x^{(n)},z;\theta)\end{align}\]</span></p><hr /><p>è¿™æ—¶ï¼Œåªè¦æœ€å¤§åŒ–æ•´ä¸ªè®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶<span class="math inline">\(\mathcal{L}(\mathcal{D};\theta)\)</span>ï¼Œå³å¯ä¼°è®¡å‡ºæœ€ä¼˜çš„å‚æ•°<span class="math inline">\(\theta^*\)</span>ã€‚ä¸è¿‡åœ¨è®¡ç®—æ¢¯åº¦çš„æ—¶å€™ï¼Œéœ€è¦åœ¨å¯¹æ•°å‡½æ•°å†…éƒ¨è¿›è¡Œæ±‚å’Œæˆ–ç§¯åˆ†è®¡ç®—ã€‚ä¸ºäº†æ›´å¥½çš„è®¡ç®—<span class="math inline">\(\log p(x;\theta)\)</span>ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªé¢å¤–çš„å˜åˆ†å‡½æ•°<span class="math inline">\(q(z)\)</span>ï¼Œ<span class="math inline">\(q(z)\)</span>ä¸ºå®šä¹‰åœ¨éšå˜é‡<span class="math inline">\(z\)</span>ä¸Šçš„åˆ†å¸ƒã€‚æ ·æœ¬<span class="math inline">\(x\)</span>çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p><p><span class="math display">\[\begin{align}\log p(x;\theta)&amp;=\log \sum_z q(z)\frac{p(x,z;\theta)}{q(z)}\\&amp;\geq\sum_z q(z)\log \frac{p(x,z;\theta)}{q(z)}\\&amp;\triangleq ELBO(q,x;\theta)\end{align}\]</span></p><p>å…¶ä¸­<span class="math inline">\(ELBO(q,x;\theta)\)</span>ä¸ºå¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°<span class="math inline">\(\log p(x;\theta)\)</span>çš„ä¸‹ç•Œï¼Œç§°ä¸ºè¯æ®ä¸‹ç•Œã€‚å…¬å¼ä¸­ä½¿ç”¨äº†Jensenä¸ç­‰å¼(å³å¯¹äºå‡¹å‡½æ•°<span class="math inline">\(g\)</span>ï¼Œæœ‰<span class="math inline">\(g(\mathbb{E}[x])\geq\mathbb{E}[g(X)]\)</span>)ã€‚åœ¨è¿™é‡Œï¼Œ<span class="math inline">\(\frac{p(x,z;\theta)}{q(z)}\)</span>å¯è§†ä¸º<span class="math inline">\(q(z)\)</span>çš„å‡½æ•°ï¼Œè®°ä¸º<span class="math inline">\(f(q(z))\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(f(q(z))\)</span>çš„æœŸæœ›å³<span class="math inline">\(\mathbb{E}[f(q(z))]=\sum_z q(z)f(q(z))=\sum_z q(z)\frac{p(x,z;\theta)}{q(z)}\)</span>ã€‚è€Œæ ¹æ®Jensenä¸ç­‰å¼ï¼Œæœ‰<span class="math inline">\(g(\mathbb{E}[f(q(z))])\geq\mathbb{E}[g(f(q(z)))]\Leftrightarrow g(\sum_z q(z)\frac{p(x,z;\theta)}{q(z)})\geq \sum_z q(z)g(\frac{p(x,z;\theta)}{q(z)})\)</span>ï¼Œåœ¨è¿™é‡Œ<span class="math inline">\(g\)</span>å°±æ˜¯å¯¹æ•°å‡½æ•°ã€‚</p><hr /><p>æ ¹æ®Jensenä¸ç­‰å¼å–ç­‰çš„æ¡ä»¶ï¼š<span class="math inline">\(\frac{p(x,z;\theta)}{q(z)}=c\)</span>ï¼Œ<span class="math inline">\(c\)</span>ä¸ºå¸¸æ•°ï¼Œæœ‰ï¼š</p><p><span class="math display">\[\begin{align}\sum_z p(x,z;\theta)&amp;=c\sum_z q(z)\\\Leftrightarrow\sum_z p(x,z;\theta)&amp;=c\cdot1\end{align}\]</span></p><p>å› æ­¤ï¼š</p><p><span class="math display">\[\begin{align}q(z)&amp;=\frac{p(x,z;\theta)}{\sum_z p(x,z;\theta)}\\&amp;=\frac{p(x,z;\theta)}{p(x;\theta)}\\&amp;=p(z|x;\theta)\end{align}\]</span></p><p>æ‰€ä»¥ï¼Œå½“ä¸”ä»…å½“<span class="math inline">\(q(z)=p(z|x;\theta)\)</span>æ—¶ï¼Œ<span class="math inline">\(\log p(x;\theta)=ELBO(q,x;\theta)\)</span>ã€‚</p><hr /><p>äºæ˜¯æœ€å¤§åŒ–å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°<span class="math inline">\(\log p(x;\theta)\)</span>çš„è¿‡ç¨‹å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p><ol type="1"><li>å…ˆæ‰¾åˆ°è¿‘ä¼¼åˆ†å¸ƒ<span class="math inline">\(q(z)\)</span>ä½¿å¾—<span class="math inline">\(\log p(x;\theta)=ELBO(q,x;\theta)\)</span>ï¼›</li><li>å†å¯»æ‰¾å‚æ•°<span class="math inline">\(\theta\)</span>æœ€å¤§åŒ–<span class="math inline">\(ELBO(q,x;\theta)\)</span>ã€‚</li></ol><p>è¿™å°±æ˜¯æœŸæœ›æœ€å¤§åŒ–(Expectation-Maximum,EM)ç®—æ³•ã€‚</p><hr /><p>EMç®—æ³•é€šè¿‡è¿­ä»£çš„æ–¹æ³•ï¼Œä¸æ–­é‡å¤ç›´åˆ°æ”¶æ•›åˆ°æŸä¸ªå±€éƒ¨æœ€ä¼˜è§£ã€‚åœ¨ç¬¬<span class="math inline">\(t\)</span>æ­¥æ›´æ–°æ—¶ï¼ŒEæ­¥å’ŒMæ­¥åˆ†åˆ«ä¸ºï¼š</p><ol type="1"><li><p>Eæ­¥ï¼šå›ºå®šå‚æ•°<span class="math inline">\(\theta_t\)</span>ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆ†å¸ƒä½¿<span class="math inline">\(ELBO(q,x;\theta_t)\)</span>æœ€å¤§ï¼Œå³ç­‰äº<span class="math inline">\(\log p(x;\theta_t)\)</span>ï¼š<span class="math inline">\(q_{t+1}(z)=\text{arg}_q \max ELBO(q,x;\theta_t)\)</span>ï¼›</p></li><li><p>Mæ­¥ï¼šå›ºå®š<span class="math inline">\(q_{t+1}(z)\)</span>ï¼Œæ‰¾åˆ°ä¸€ç»„å‚æ•°ä½¿å¾—è¯æ®ä¸‹ç•Œæœ€å¤§ï¼Œå³ï¼š<span class="math inline">\(\theta_{t+1}=\text{arg}_\theta\max ELBO(q_{t+1},x;\theta)\)</span>ã€‚</p></li></ol><hr /><p>å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ä¿¡æ¯è®ºçš„è§†è§’æ¥è¿›è¡Œåˆ†è§£ï¼š</p><p><span class="math display">\[\begin{align}\log p(x;\theta)&amp;=\sum_z q(z)\log p(x;\theta)\\&amp;=\sum_z q(z)(\log p(x,z;\theta)-\log p(z|x;\theta))\\&amp;=\sum_z q(z)\log\frac{p(x,z;\theta)}{q(z)}-\sum_z q(z)\log\frac{p(z|x;\theta)}{q(z)}\\&amp;=ELBO(q,x;\theta)+D_{KL}(q(z)\parallel p(z|x;\theta))\end{align}\]</span></p><p>å…¶ä¸­<span class="math inline">\(D_{KL}(q(z)\parallel p(z|x;\theta))\)</span></p><h1 id="generative-model-with-hidden-variable">Generative Model with Hidden Variable</h1><p>å‡è®¾ä¸€ä¸ªç”Ÿæˆæ¨¡å‹åŒ…å«ä¸å¯è§‚æµ‹çš„éšå˜é‡ï¼Œå…¶ä¸­å¯è§‚æµ‹å˜é‡<span class="math inline">\(x\)</span>ä¸ºä¸€ä¸ªé«˜ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ï¼Œè€Œä¸å¯è§‚æµ‹çš„éšå˜é‡<span class="math inline">\(z\)</span>ä¸ºä¸€ä¸ªç›¸å¯¹ä½ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ã€‚</p><p>è¿™ä¸ªç”Ÿæˆæ¨¡å‹çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å¯ä»¥è¡¨è¾¾ä¸ºï¼š</p><p><span class="math display">\[p(x,z;\theta)=p(x|z;\theta)p(z;\theta)\]</span></p><p>å…¶ä¸­<span class="math inline">\(p(z;\theta)\)</span>ä¸ºéšå˜é‡<span class="math inline">\(z\)</span>çš„å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒï¼›<span class="math inline">\(p(x|z;\theta)\)</span>ä¸ºå·²çŸ¥<span class="math inline">\(z\)</span>æ¡ä»¶ä¸‹<span class="math inline">\(x\)</span>çš„æ¦‚ç‡åˆ†å¸ƒã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾<span class="math inline">\(p(z;\theta)\)</span>å’Œ<span class="math inline">\(p(x|z;\theta)\)</span>æœä»æŸç§å¸¦å‚çš„åˆ†å¸ƒæ—ï¼Œå…¶å½¢å¼å·²çŸ¥ï¼Œè€Œå‚æ•°å¯ä»¥é€šè¿‡æœ€å¤§ä¼¼ç„¶æ¥è¿›è¡Œä¼°è®¡ã€‚</p><p>ç»™å®šä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œå…¶å¯¹æ•°è¾¹é™…ä¼¼ç„¶<span class="math inline">\(\log p(x;\theta)\)</span>å¯ä»¥åˆ†è§£ä¸ºï¼š</p><p><span class="math display">\[\log p(x;\theta)=ELBO(q,x;\theta,\phi)+D_{KL}(q(z;\phi)\parallel p(z|x;\theta))\]</span></p><p>å…¶ä¸­<span class="math inline">\(q(z;\phi)\)</span>ä¸ºé¢å¤–å¼•å…¥çš„å˜åˆ†å¯†åº¦å‡½æ•°ï¼Œ<span class="math inline">\(ELBO(q,x;\theta,\phi)\)</span>ä¸ºè¯æ®ä¸‹ç•Œï¼š</p><p><span class="math display">\[ELBO(q,x;\theta,\phi)=\mathbb{E}_{z\sim q(z;\phi)}[\log{\frac{p(x,z;\theta)}{q(z;\phi)}}]\]</span></p><p>æœ€å¤§åŒ–<span class="math inline">\(\log p(x;\theta)\)</span>å¯ä»¥ç”¨EMç®—æ³•æ¥æ±‚è§£ï¼š</p><ul><li><strong>E-step:</strong> å¯»æ‰¾ä¸€ä¸ªå¯†åº¦å‡½æ•°<span class="math inline">\(q(z;\phi)\)</span>ä½¿å…¶ç­‰äºæˆ–æ¥è¿‘äºåéªŒå¯†åº¦å‡½æ•°<span class="math inline">\(p(z|x;\theta)\)</span>;</li><li><strong>M-step:</strong> ä¿æŒ<span class="math inline">\(q(z;\phi)\)</span>å›ºå®šï¼Œå¯»æ‰¾<span class="math inline">\(\theta\)</span>æ¥æœ€å¤§åŒ–<span class="math inline">\(ELBO(q,x;\theta,\phi)\)</span>ã€‚</li></ul><p>åœ¨EMç®—æ³•çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œç†è®ºä¸Šæœ€ä¼˜çš„<span class="math inline">\(q(z;\phi)\)</span>ä¸ºéšå˜é‡çš„åéªŒæ¦‚ç‡å¯†åº¦å‡½æ•°<span class="math inline">\(p(z|x;\theta)\)</span>ï¼š</p><p><span class="math display">\[p(z|x;\theta)=\frac{p(x|z;\theta)p(z;\theta)}{\int_z p(x|z;\theta)p(z;\theta)\text{d}z}\]</span></p><p>åéªŒå¯†åº¦å‡½æ•°<span class="math inline">\(p(z|x;\theta)\)</span>çš„è®¡ç®—æ˜¯ä¸€ä¸ªç»Ÿè®¡æ¨æ–­çš„é—®é¢˜ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹<span class="math inline">\(p(x|z;\theta)\)</span>ä¹Ÿæ¯”è¾ƒéš¾ä»¥è®¡ç®—ã€‚</p><h1 id="variational-autoencoder">Variational Autoencoder</h1><p>å˜åˆ†è‡ªç¼–ç å™¨(Variational Autoencoder, VAE)çš„ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥åˆ†åˆ«å»ºæ¨¡ä¸¤ä¸ªå¤æ‚çš„æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š</p><ol type="1"><li>ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿå˜åˆ†åˆ†å¸ƒ<span class="math inline">\(q(z;\phi)\)</span>ï¼Œç§°ä¸ºæ¨æ–­ç½‘ç»œã€‚æ¨æ–­ç½‘ç»œçš„è¾“å…¥ä¸º<span class="math inline">\(x\)</span>ï¼Œè¾“å‡ºä¸ºå˜åˆ†åˆ†å¸ƒ<span class="math inline">\(q(z|x;\phi)\)</span>ï¼›</li><li>ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿæ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>ï¼Œç§°ä¸ºç”Ÿæˆç½‘ç»œã€‚ç”Ÿæˆç½‘ç»œçš„è¾“å…¥ä¸º<span class="math inline">\(z\)</span>ï¼Œè¾“å‡ºä¸ºæ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>ã€‚</li></ol><p><img src="https://i.loli.net/2020/06/24/B1d9UtTzNfjG6e2.png" srcset="/img/loading.gif" /></p><p>VAEçš„å›¾æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/24/GAhy281seQ3tbZT.png" srcset="/img/loading.gif" /></p><h2 id="variational-network">Variational Network</h2><p>å‡è®¾<span class="math inline">\(q(z|x;\phi)\)</span>æ˜¯æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼š</p><p><span class="math display">\[q(z|x;\phi)=\mathcal{N}(z;\mu_I,\sigma^2_I I)\]</span></p><p>å…¶ä¸­<span class="math inline">\(\mu_I\)</span>å’Œ<span class="math inline">\(\sigma_I^2\)</span>æ˜¯é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ï¼Œå¯ä»¥é€šè¿‡æ¨æ–­ç½‘ç»œ<span class="math inline">\(f_I(x;\phi)\)</span>æ¥é¢„æµ‹ï¼š</p><p><span class="math display">\[\left[\begin{matrix}\mu_I\\\sigma_I\end{matrix}\right]=f_I(x;\phi)\]</span> æ¨æ–­ç½‘ç»œ<span class="math inline">\(f_I(x;\phi)\)</span>å¯ä»¥æ˜¯ä¸€èˆ¬çš„å…¨è¿æ¥ç½‘ç»œæˆ–å·ç§¯ç½‘ç»œï¼Œæ¯”å¦‚ä¸€ä¸ªä¸¤å±‚çš„ç¥ç»ç½‘ç»œï¼š</p><p><span class="math display">\[\begin{align}h&amp;=\sigma(W^{(1)}x+b^{(1)})\\\mu_I&amp;=W^{(2)}h+b^{(2)}\\\sigma_I&amp;=\text{softplus}(W^{(3)}h+b^{(3)})\end{align}\]</span></p><p>å…¶ä¸­æ‰€æœ‰ç½‘ç»œå‚æ•°<span class="math inline">\(\{W^{(1)},W^{(2)},W^{(3)},b^{(1)},b^{(2)},b^{(3)}\}\)</span>å³å¯¹åº”äº†å˜åˆ†å‚æ•°<span class="math inline">\(\phi\)</span>ã€‚</p><hr /><p>æ¨æ–­ç½‘ç»œçš„ç›®æ ‡æ˜¯ä½¿å¾—<span class="math inline">\(q(z|x;\phi)\)</span>æ¥å°½å¯èƒ½æ¥è¿‘çœŸå®çš„åéªŒ<span class="math inline">\(p(z|x;\theta)\)</span>ï¼Œéœ€è¦æ‰¾åˆ°å˜åˆ†å‚æ•°<span class="math inline">\(\phi^*\)</span>æ¥æœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„KLæ•£åº¦ï¼š</p><p><span class="math display">\[\phi^*=\text{arg}_\phi\min{D_{KL}(q(z|x;\phi)\parallel p(z|x;\theta))}\]</span></p><p>ç”±äº<span class="math inline">\(p(z|x;\theta)\)</span>æœªçŸ¥ï¼Œæ•…KLæ•£åº¦æ— æ³•ç›´æ¥è®¡ç®—ï¼Œä¸è¿‡ç”±äº<span class="math inline">\(D_{KL}(q(z|x;\phi)\parallel p(z|x;\theta))=\log p(x;\theta)-ELBO(q,x;\theta,\phi)\)</span>ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œï¼Œæœ‰ï¼š</p><p><span class="math display">\[\phi^*=\text{arg}_\phi\max{ELBO(q,x;\theta,\phi)}\]</span></p><h2 id="generative-network">Generative Network</h2><p>ç”Ÿæˆæ¨¡å‹çš„è”åˆåˆ†å¸ƒå¯ä»¥åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†ï¼šéšå˜é‡<span class="math inline">\(z\)</span>çš„å…ˆéªŒåˆ†å¸ƒ<span class="math inline">\(p(z;\theta)\)</span>å’Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>ã€‚ä¸ºç®€å•èµ·è§ï¼Œä¸€èˆ¬å‡è®¾éšå˜é‡<span class="math inline">\(z\)</span>çš„å…ˆéªŒåˆ†å¸ƒä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(z|0,I)\)</span>ï¼Œéšå˜é‡æ¯ä¸€ç»´ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>å¯ä»¥é€šè¿‡ç”Ÿæˆç½‘ç»œæ¥å»ºæ¨¡ï¼Œæˆ‘ä»¬åŒæ ·ç”¨å‚æ•°åŒ–çš„åˆ†å¸ƒæ—æ¥è¡¨ç¤ºæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>ï¼Œè¿™äº›åˆ†å¸ƒæ—çš„å‡½æ•°å¯ä»¥ç”¨ç”Ÿæˆç½‘ç»œè®¡ç®—å¾—åˆ°ã€‚æ ¹æ®å˜é‡<span class="math inline">\(x\)</span>çš„ç±»å‹ä¸åŒï¼Œå¯ä»¥å‡è®¾<span class="math inline">\(p(x|z;\theta)\)</span>æœä»ä¸åŒçš„åˆ†å¸ƒæ—ã€‚å¦‚æœ<span class="math inline">\(x\in\{0,1\}^d\)</span>æ˜¯<span class="math inline">\(d\)</span>ç»´çš„äºŒå€¼å‘é‡ï¼Œå¯ä»¥å‡è®¾<span class="math inline">\(\log p(x|z;\theta)\)</span>æœä»å¤šå˜é‡çš„ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œå³ï¼š</p><p><span class="math display">\[\begin{align}p(x|z;\theta)&amp;=\prod\limits_{i=1}^d p(x_i|z;\theta)\\&amp;=\prod\limits_{i=1}^d \gamma_i^{x_i}(1-\gamma_i)^{(1-x_i)}\end{align}\]</span></p><p>å¦‚æœ<span class="math inline">\(x\in\mathbb{R}^d\)</span>æ˜¯<span class="math inline">\(d\)</span>ç»´çš„è¿ç»­å‘é‡ï¼Œå¯ä»¥å‡è®¾<span class="math inline">\(p(x|z;\theta)\)</span>æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼Œå³ï¼š</p><p><span class="math display">\[p(x|z;\theta)=\mathcal{N}(x;\mu_G,\sigma_G^2 I)\]</span></p><hr /><p>ç”Ÿæˆç½‘ç»œçš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ç»„<span class="math inline">\(\theta^*\)</span>æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œ<span class="math inline">\(ELBO(q,x;\theta,\phi)\)</span>ï¼š</p><p><span class="math display">\[\theta^*=\text{arg}_\theta\max ELBO(q,x;\theta,\phi)\]</span></p><h2 id="model-combination">Model Combination</h2><p>æ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œçš„ç›®æ ‡éƒ½æ˜¯æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œå› æ­¤æ€»çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p><p><span class="math display">\[\begin{align}\max_{\theta,\phi}ELBO(q,x;\theta,\phi)&amp;=\max_{\theta,\phi}\mathbb{E}_{z\sim q(z;\phi)}[\log\frac{p(x|z;\theta)p(z;\theta)}{q(z;\theta)}]\\&amp;=\max_{\theta,\phi}\mathbb{E}_{z\sim q(z|x;\phi)}[\log p(x|z;\theta)]-D_{KL}(q(z|x;\phi)\parallel p(z;\theta))\end{align}\]</span></p><p>å…¶ä¸­å…ˆéªŒåˆ†å¸ƒ<span class="math inline">\(p(z;\theta)=\mathcal{N}(z|0,I)\)</span>ã€‚</p><p>å…¬å¼ä¸­<span class="math inline">\(\mathbb{E}_{z\sim q(z|x;\phi)}[\log p(x|z;\theta)]\)</span>ä¸€èˆ¬é€šè¿‡é‡‡æ ·çš„æ–¹å¼è¿›è¡Œè®¡ç®—ï¼Œæœ€åå–å¹³å‡å€¼ã€‚</p><h2 id="model-training">Model Training</h2><p>ç»™å®šæ•°æ®é›†<span class="math inline">\(\mathcal{D}\)</span>ï¼ŒåŒ…å«<span class="math inline">\(N\)</span>ä¸ªä»æœªçŸ¥æ•°æ®åˆ†å¸ƒä¸­æŠ½å–çš„ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬<span class="math inline">\(x^{(1)},x^{(2)},\cdots,x^{(N)}\)</span>ã€‚å˜åˆ†è‡ªç¼–ç å™¨çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p><p><span class="math display">\[\mathcal{J}(\phi,\theta|\mathcal{D})=\sum\limits_{n=1}^N(\frac{1}{M}\sum\limits_{m=1}^M\log p(x^{(n)}|z^{(n,m)};\theta)-D_{KL}(q(z|x^{(n)};\phi)\parallel\mathcal{N}(z;0,I)))\]</span></p><p>å¦‚æœé‡‡ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œæ¯æ¬¡ä»æ•°æ®é›†ä¸­é‡‡ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œç„¶åæ ¹æ®<span class="math inline">\(q(z|x;\phi)\)</span>é‡‡ä¸€ä¸ªéšå˜é‡<span class="math inline">\(z\)</span>ï¼Œåˆ™ç›®æ ‡å‡½æ•°å˜ä¸ºï¼š</p><p><span class="math display">\[\mathcal{J}(\phi,\theta|x)=\log p(x|z;\theta)-D_{KL}(q(z|x;\phi)\parallel\mathcal{N}(z;0,I))\]</span></p><p>å‡è®¾<span class="math inline">\(q(z|x;\phi)\)</span>æ˜¯æ­£æ€åˆ†å¸ƒï¼ŒKLæ•£åº¦å¯ç›´æ¥ç®—å‡ºï¼š</p><p><span class="math display">\[D_{KL}(\mathcal{N}(\mu_1,\Sigma_1)\parallel\mathcal(\mu_2,\Sigma_2))\\=\frac{1}{2}(\text{tr}(\sigma_I^2 I)+\mu_I^T\mu_I-d-\log(|\sigma_I^2 I|))\]</span></p><hr /><p>å†å‚æ•°åŒ–æ˜¯å°†ä¸€ä¸ªå‚æ•°ä¸º<span class="math inline">\(u\)</span>çš„å‡½æ•°<span class="math inline">\(f(u)\)</span>ï¼Œé€šè¿‡ä¸€ä¸ªå‡½æ•°<span class="math inline">\(u=g(v)\)</span>ï¼Œè½¬æ¢ä¸ºå‚æ•°ä¸º<span class="math inline">\(v\)</span>çš„å‡½æ•°<span class="math inline">\(\hat{f}(v)=f(g(v))\)</span>ã€‚åœ¨å˜åˆ†è‡ªç¼–ç å™¨ä¸­ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ±‚éšæœºå˜é‡<span class="math inline">\(z\)</span>å…³äº<span class="math inline">\(\phi\)</span>çš„å¯¼æ•°ã€‚ä½†ç”±äºæ˜¯é‡‡æ ·çš„æ–¹å¼ï¼Œæ— æ³•ç›´æ¥åˆ»ç”»<span class="math inline">\(z\)</span>å’Œ<span class="math inline">\(\phi\)</span>ä¹‹é—´çš„å‡½æ•°å…³ç³»ï¼Œå› æ­¤ä¹Ÿæ— æ³•è®¡ç®—å¯¼æ•°ã€‚</p><p>å¦‚æœ<span class="math inline">\(z\sim q(z|x;\phi)\)</span>çš„éšæœºæ€§ç‹¬ç«‹äºå‚æ•°<span class="math inline">\(\phi\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å†å‚æ•°åŒ–çš„æ–¹æ³•æ¥è®¡ç®—å¯¼æ•°ã€‚å‡è®¾<span class="math inline">\(q(z|x;\phi)\)</span>ä¸ºæ­£æ€åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(\mu_I,\sigma^2_I I)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mu_I\)</span>å’Œ<span class="math inline">\(\sigma_I\)</span>æ˜¯æ¨æ–­ç½‘ç»œ<span class="math inline">\(f_I(x;\phi)\)</span>çš„è¾“å‡ºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼é‡‡æ ·<span class="math inline">\(z\)</span>ï¼š</p><p><span class="math display">\[z=\mu_I+\sigma_I\odot \varepsilon\]</span></p><p>å…¶ä¸­<span class="math inline">\(\varepsilon\sim\mathcal{N}(0,I)\)</span>ã€‚è¿™æ ·<span class="math inline">\(z\)</span>å’Œ<span class="math inline">\(\mu_I,\sigma_I\)</span>çš„å…³ç³»ä»é‡‡æ ·å…³ç³»å˜ä¸ºå‡½æ•°å…³ç³»ã€‚</p><hr /><p>å¦‚æœè¿›ä¸€æ­¥å‡è®¾<span class="math inline">\(p(x|z;\theta)\)</span>æœä»é«˜æ–¯åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(x|\mu_G,I)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mu_G=f_G(z;\theta)\)</span>æ˜¯ç”Ÿæˆç½‘ç»œçš„è¾“å‡ºï¼Œåˆ™ç›®æ ‡å‡½æ•°å¯ä»¥ç®€åŒ–ä¸ºï¼š</p><p><span class="math display">\[\mathcal{J}(\phi,\theta|x)=-\parallel x-\mu_G\parallel^2+D_{KL}(\mathcal{N}(\mu_I,\sigma_I)\parallel\mathcal{N}(0,I))\]</span></p><p>å…¶ä¸­ç¬¬ä¸€é¡¹å¯ä»¥è¿‘ä¼¼çœ‹ä½œæ˜¯è¾“å…¥<span class="math inline">\(x\)</span>çš„é‡æ„æ­£ç¡®æ€§ï¼Œç¬¬äºŒé¡¹å¯ä»¥çœ‹ä½œæ˜¯æ­£åˆ™åŒ–é¡¹ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Tutorial</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Deep Learning</tag>
      
      <tag>Variational Inference</tag>
      
      <tag>VAE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Recurrent Neural Networks for Multivariate Time Series with Missing Values</title>
    <link href="/2019/10/18/Recurrent-Neural-Networks-for-Multivariate-Time-Series-with-Missing-Values/"/>
    <url>/2019/10/18/Recurrent-Neural-Networks-for-Multivariate-Time-Series-with-Missing-Values/</url>
    
    <content type="html"><![CDATA[<h1 id="abstract">Abstract</h1><p>æ–‡ä¸­æå‡ºäº†ä¸€ç§å¯ä»¥å¤„ç†å¸¦ç¼ºå¤±å€¼å¤šä¸ºæ—¶é—´åºåˆ—çš„GRUæ¨¡å‹ï¼š<strong>GRU-D</strong>ã€‚æœ¬æ¨¡å‹ä¸ä»…å¯ä»¥æ•æ‰æ—¶é—´åºåˆ—ä¸­çš„é•¿æœŸä¾èµ–æ¨¡å¼ï¼Œå¹¶ä¸”è¿˜èƒ½åˆ©ç”¨æ—¶é—´åºåˆ—ä¸­çš„ç¼ºå¤±æ¨¡å¼æ¥è¾¾åˆ°æ›´å¥½çš„æ—¶é—´åºåˆ—é¢„æµ‹æ•ˆæœã€‚</p><p><a href="https://www.nature.com/articles/s41598-018-24271-9" target="_blank" rel="noopener">åŸæ–‡</a></p><h1 id="methodology">Methodology</h1><h2 id="notations">Notations</h2><p>è®°åŒ…å«<span class="math inline">\(D\)</span>ä¸ªå˜é‡çš„å¤šå˜é‡æ—¶é—´åºåˆ—ä¸º<span class="math inline">\(X=(x_1,x_2,\cdots,x_T)^T\in\mathbb{R}^{T\times D}\)</span>ï¼Œå…¶ä¸­å¯¹äºæ¯ä¸ª<span class="math inline">\(t\in\{1,2,\cdots,T\},x_t\in\mathbb{R}^D\)</span>è¡¨ç¤ºæ—¶é—´åºåˆ—åœ¨æ—¶é—´<span class="math inline">\(t\)</span>çš„è§‚æµ‹å€¼ï¼Œ<span class="math inline">\(x_t^d\)</span>è¡¨ç¤º<span class="math inline">\(x_t\)</span>çš„ç¬¬<span class="math inline">\(d\)</span>ä¸ªæˆåˆ†ã€‚è®°<span class="math inline">\(s_t\in\mathbb{R}\)</span>ä¸º<span class="math inline">\(t\)</span>æ—¶åˆ»çš„æ—¶é—´æˆ³ï¼Œå¹¶å‡è®¾ç¬¬ä¸€ä¸ªè§‚æµ‹å€¼çš„æ—¶é—´æˆ³ä¸º<span class="math inline">\(0\)</span>ã€‚å¯¹äºåŒ…å«ç¼ºå¤±å€¼çš„æ—¶é—´åºåˆ—ï¼Œæˆ‘ä»¬ç”¨<strong>Masking Vector</strong> <span class="math inline">\(m_t\in\{0,1\}\)</span>è¿›è¡Œæ ‡è®°ï¼ŒåŒæ—¶å¯¹æ¯ä¸ª<span class="math inline">\(x_t^d\)</span>ç»´æŠ¤è·ç¦»ä¸Šä¸€ä¸ªè§‚æµ‹å€¼çš„<strong>Time Interval</strong> <span class="math inline">\(\delta_t^d\in\mathbb{R}\)</span>ï¼Œå…¬å¼å¦‚ä¸‹ï¼š <span class="math display">\[m_t^d=\begin{cases}1, &amp;\text{if }x_t^d\text{ is observed}\\0, &amp;\text{otherwise}\end{cases}\]</span></p><p><span class="math display">\[\delta_t^d=\begin{cases}s_t-s_{t-1}+\delta_{t-1}^d, &amp;t&gt;1,m_{t-1}^d=0\\s_t-s_{t-1}, &amp;t&gt;1, m_{t-1}^d=1\\0, &amp;t=1\end{cases}\]</span></p><p>ä¸‹å›¾æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/C4FKQw2AZ9xkalo.png" srcset="/img/loading.gif" /></p><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨æ—¶é—´åºåˆ—çš„åˆ†ç±»é—®é¢˜ï¼Œå³ç»™å®šæ•°æ®é›†<span class="math inline">\(\mathcal{D}=\{(X_n,s_n,M_n)\}_{n=1}^N\)</span>ï¼Œæˆ‘ä»¬è¦å¯¹æ¯ä¸ªæ ·æœ¬çš„ç±»åˆ«è¿›è¡Œé¢„æµ‹<span class="math inline">\(l_n\in\{1,\cdots,L\}\)</span>ã€‚</p><h2 id="gru-rnn-for-time-series-classification">GRU-RNN for Time Series Classification</h2><p>GRUæ˜¯ä¸€ç§æ”¹è¿›ç‰ˆæœ¬çš„RNNï¼Œå…¶æœ€å¤§ä¸åŒæ˜¯åŠ å…¥äº†é—¨æ§æœºåˆ¶ã€‚GRUå•å…ƒçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/wpKQsxEklizVTtm.png" srcset="/img/loading.gif" style="zoom: 33%;" /></p><p>GRUåŒ…å«äº†é‡ç½®é—¨å’Œæ›´æ–°é—¨ï¼Œå…¶ä¸­é‡ç½®é—¨<span class="math inline">\(R_t\)</span>è´Ÿè´£æ§åˆ¶ä¸Šä¸€æ—¶é—´çš„éšçŠ¶æ€<span class="math inline">\(h_{t-1}\)</span>æœ‰å¤šå°‘éƒ¨åˆ†éœ€è¦ä¿ç•™ï¼Œè€Œæ›´æ–°é—¨åˆ™å†³å®šç”±<span class="math inline">\(R_t\)</span>è®¡ç®—å‡ºæ¥çš„å€™é€‰éšçŠ¶æ€<span class="math inline">\(\tilde{h}_t\)</span>æœ‰å¤šå°‘éƒ¨åˆ†éœ€è¦ä¿ç•™ã€‚æœ€åå½“å‰æ—¶é—´çš„éšçŠ¶æ€ç”±<span class="math inline">\(h_{t-1}\)</span>å’Œ<span class="math inline">\(\tilde{h}_t\)</span>å…±åŒç®—å‡ºã€‚GRUçš„çŠ¶æ€æ›´æ–°å…¬å¼å¦‚ä¸‹ï¼š <span class="math display">\[\begin{align}R_t&amp;=\sigma(W_rx_t+U_rh_{t-1}+b_r)\\Z_t&amp;=\sigma(W_zx_t+U_zh_{t-1}+b_z)\\\tilde{h}_t&amp;=\text{tanh}(Wx_t+U(R_t\odot h_{t-1})+b)\\h_t&amp;=(1-Z_t)\odot h_{t-1}+Z_t\odot \tilde{h}_t\end{align}\]</span> æ–‡ä¸­æå‡ºäº†ä¸€äº›å¤„ç†ç¼ºå¤±å€¼çš„ç®€å•æ–¹æ³•ï¼š</p><ol type="1"><li>ç›´æ¥ç”¨å‡å€¼æ›¿ä»£ï¼š<span class="math inline">\(x_t^d\leftarrow m_t^dx_t^d+(1-m_t^d)\tilde{x}^d\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\tilde{x}^d=\frac{\sum_{n=1}^N\sum_{t=1}^{T_n}m_{t,n}^d x_{t,n}^d}{\sum_{n=1}^N\sum_{t=1}^{T_n}m_{t,n}^d\tilde{x}^d}\)</span>ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Mean</strong>ï¼›</li><li>ç”¨ä¸Šä¸€ä¸ªè§‚æµ‹å€¼æ›¿ä»£ï¼š<span class="math inline">\(x_t^d\leftarrow m_t^d x_t^d+(1-m_t^d)x_{t^\prime}^d\)</span>ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Forward</strong>ï¼›</li><li>ä¸å¡«å……ï¼Œå°†æ˜¯å¦ç¼ºå¤±ï¼Œè·ç¦»ä¸Šä¸€ä¸ªè§‚æµ‹å€¼çš„æ—¶é—´ä½œä¸ºé¢å¤–ä¿¡æ¯è¾“å…¥ï¼š<span class="math inline">\(x_t^{(n)}\leftarrow[x_t^{(n)};m_t^{(n)};\delta_t^{(n)}]\)</span>ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Simple</strong>ã€‚</li></ol><h3 id="gru-d-model-with-trainable-decays">GRU-D: Model with Trainable Decays</h3><p>æ–‡ä¸­æå‡ºäº†æ—¶é—´åºåˆ—ç¼ºå¤±å€¼çš„ä¸¤ä¸ªæ€§è´¨ï¼šä¸€ä¸ªæ˜¯åœ¨ä¸Šä¸€ä¸ªè§‚æµ‹å€¼è·ç¦»å¾ˆè¿œçš„æƒ…å†µä¸‹ç¼ºå¤±å€¼å€¾å‘äºæ¥è¿‘ä¸€ä¸ªé»˜è®¤çš„å€¼ï¼Œç¬¬äºŒä¸ªæ˜¯ç¼ºå¤±å€¼çš„å½±å“ä¼šéšç€æ—¶é—´å‡å¼±ã€‚ä¸ºäº†ä½“ç°ä¸Šè¿°ä¸¤ç‚¹ï¼Œæ–‡ä¸­æå‡ºäº†GPU-Dæ¨¡å‹ï¼Œæ¨¡å‹æ¡†æ¶å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/aXbS4ADkLfeHPCR.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>åœ¨æ¨¡å‹ä¸­ï¼Œ<strong>Decay Rates</strong>è¢«è®¾å®šä¸ºä¸€ä¸ªå¸¦å‚æ•°çš„å‡½æ•°å’ŒGRUä¸€èµ·è®­ç»ƒï¼š <span class="math display">\[\gamma_t=\exp\{-\max(0,W_\gamma\delta_t+b_\gamma)\}\]</span></p><p><span class="math display">\[\hat{x}_t^d=m_t^dx_t^d+(1-m_t^d)(\gamma_{x_t}^dx_{t^\prime}^d+(1-\gamma_{x_t}^d)\tilde{x}^d)\]</span> å…¶ä¸­<span class="math inline">\(x_{t^\prime}^d\)</span>æ˜¯ç¬¬<span class="math inline">\(d\)</span>ä¸ªå˜é‡çš„ä¸Šä¸€ä¸ªè§‚æµ‹å€¼ï¼Œ<span class="math inline">\(\tilde{x}^d\)</span>æ˜¯ç¬¬<span class="math inline">\(d\)</span>ä¸ªå˜é‡çš„ç»éªŒå‡å€¼ã€‚è¿™æ ·<span class="math inline">\(\hat{x}_t^d\)</span>å°±ä»£è¡¨ç»è¿‡<strong>Input Decay</strong>çš„è¾“å…¥ã€‚</p><p>æ–‡ä¸­æåˆ°åªç”¨<strong>Input Decay</strong>æ˜¯ä¸å¤Ÿçš„ï¼Œé™¤æ­¤ä¹‹å¤–ä½œè€…è¿˜ä½¿ç”¨äº†<strong>Hidden State Decay</strong>ï¼Œå³å¯¹<span class="math inline">\(h_{t-1}\)</span>è¿›è¡ŒDecayï¼Œå…¬å¼å¦‚ä¸‹ï¼š <span class="math display">\[\hat{h}_{t-1}=\gamma_{h_t}\odot h_{t-1}\]</span> ç”¨Decayä¹‹åçš„<span class="math inline">\(\hat{x}_t\)</span>å’Œ<span class="math inline">\(\hat{h}_{t-1}\)</span>æ›¿æ¢åŸå§‹çš„GRUå…¬å¼å°±å¾—åˆ°äº†GRU-Dæ¨¡å‹ï¼š <span class="math display">\[\begin{align}R_t&amp;=\sigma(W_r\hat{x}_t-U_r\hat{h}_{t-1}+V_rm_t+b_r)\\Z_t&amp;=\sigma(W_z\hat{x}_t+U_z\hat{h}_{t-1}+V_zm_t+b_z)\\\tilde{h}_t&amp;=\text{tanh}(W\hat{x}_t+U(R_t\odot \hat{h}_{t-1})+Vm_t+b)\\h_t&amp;=(1-z_t)\odot \hat{h}_{t-1}+z_t\odot\tilde{h}_t\end{align}\]</span></p><h1 id="experiments">Experiments</h1><h2 id="baseline-imputation-methods">Baseline Imputation Methods</h2><p>ä¸‹å›¾ä¸ºæ–‡ä¸­æ¯”è¾ƒä¸­ç”¨åˆ°çš„Baselineï¼š</p><p><img src="https://i.loli.net/2020/06/25/BFQdwMOXLc15mnl.png" srcset="/img/loading.gif" /></p><h2 id="baseline-prediction-methods">Baseline Prediction Methods</h2><p>ä¸‹å›¾ä¸ºæ–‡ä¸­ç”¨åˆ°çš„ç”¨æ¥é¢„æµ‹çš„Baselineï¼š</p><p><img src="https://i.loli.net/2020/06/25/qFxDRBLvNpAIjMs.png" srcset="/img/loading.gif" /></p><h2 id="results">Results</h2><p>æ–‡ä¸­ç”¨åˆ°çš„æ•°æ®é›†å¦‚ä¸‹ï¼š</p><ul><li><em>Gesture phase segmentation dataset (Gesture)</em>.</li><li><em>PhysioNet Challenge 2012 dataset (PhysioNet)</em>.</li><li><em>MIMIC-â…¢ dataset (MIMIC-â…¢)</em>.</li></ul><p>ä¸‹å›¾å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨äººå·¥åˆæˆæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š</p><p><img src="https://i.loli.net/2020/06/25/6GVYuxoFP5yHAjf.png" srcset="/img/loading.gif" /></p><p>ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ¨¡å‹åœ¨é¢„æµ‹ä»»åŠ¡è¡¨ç°çš„å¯¹æ¯”ï¼š</p><p><img src="https://i.loli.net/2020/06/25/qTZsgtGewh19Y8V.png" srcset="/img/loading.gif" style="zoom: 67%;" /></p><p>ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨MIMIC-â…¢å’ŒPhysioNetæ•°æ®é›†ä¸Šçš„å¤šä»»åŠ¡è¡¨ç°ï¼š</p><p><img src="https://i.loli.net/2020/06/25/dQiqebwYTCVfm5W.png" srcset="/img/loading.gif" /></p><p>ä¸‹å›¾åˆ†åˆ«å±•ç¤ºäº†æ¨¡å‹å­¦åˆ°çš„<strong>Input Decay</strong>å’Œ<strong>Hidden State Decay</strong>ï¼š</p><p><img src="https://i.loli.net/2020/06/25/2F7MrgOXA9nuZqC.png" srcset="/img/loading.gif" style="zoom:67%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>RNN</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>RNN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network</title>
    <link href="/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/"/>
    <url>/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/</url>
    
    <content type="html"><![CDATA[<h1 id="abstract">Abstract</h1><p>æœ¬æ–‡æå‡ºäº†<em>OmniAnomaly</em>ï¼šä¸€ç§é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—çš„éšæœºå¾ªç¯ç¥ç»ç½‘ç»œå¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚è¯¥æ¨¡å‹è¿ç”¨äº†ä¸€ç³»åˆ—æŠ€æœ¯æ¥æ•æ‰å¤šå˜é‡æ—¶é—´åºåˆ—çš„æ­£å¸¸æ¨¡å¼ï¼Œå¹¶åœ¨æ£€æµ‹é˜¶æ®µåŸºäºé‡æ„è¯¯å·®æ¥æ£€æµ‹å¼‚å¸¸ï¼ŒåŒæ—¶æœ¬æ–‡è¿˜æä¾›äº†ä¸€å®šçš„ç†è®ºè§£é‡Šã€‚</p><p><a href="https://www.kdd.org/kdd2019/accepted-papers/view/robust-anomaly-detection-for-multivariate-time-series-through-stochastic-re" target="_blank" rel="noopener">åŸæ–‡</a></p><h1 id="contribution">Contribution</h1><ol type="1"><li>æå‡ºäº†<em>OmniAnomaly</em>ï¼Œä¸€ç§åŸºäºéšæœºå¾ªç¯ç¥ç»ç½‘ç»œçš„å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼›</li><li>æå‡ºäº†é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„è§£é‡Šæ–¹æ³•ï¼›</li><li>é€šè¿‡å®éªŒè¯æ˜äº†<em>OmniAnomaly</em>ä¸­æ‰€ç”¨çš„å…³é”®æŠ€æœ¯çš„æœ‰æ•ˆæ€§ï¼ŒåŒ…æ‹¬GRUï¼Œplanar NF, stochastic variable connectionå’Œadjusted Peaks-Over-Threshold methodï¼›</li><li>é€šè¿‡å¤§é‡çš„å®éªŒæˆ‘ä»¬è¯æ˜äº†<em>OmniAnomaly</em>çš„æœ‰æ•ˆæ€§ï¼›</li><li>å‘å¸ƒäº†ä»£ç å’Œæ•°æ®é›†ã€‚</li></ol><h1 id="background">Background</h1><h2 id="linear-gaussian-state-space-model">Linear Gaussian State Space Model</h2><p>çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆState Space Model, SSMï¼‰çš„æ¦‚å¿µæ¥è‡ªäºæ§åˆ¶ç†è®ºï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®¨è®ºå…¶åœ¨æ—¶é—´åºåˆ—ä¸­çš„åº”ç”¨ã€‚å…¶å¤§æ¦‚æ€æƒ³æ˜¯æˆ‘ä»¬è®¤ä¸ºæ—¶é—´åºåˆ—åœ¨æ—¶åˆ»<span class="math inline">\(t\)</span>çš„è§‚æµ‹å€¼<span class="math inline">\(z_t\)</span>æ˜¯ä¸€ä¸ªéšå«çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_t\)</span>çš„æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p(z_t|\boldsymbol{l}_t)\)</span>ï¼Œè€Œè¿™ä¸ªéšå«çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_t\)</span>åˆ»ç”»äº†æ—¶é—´åºåˆ—çš„å†…åœ¨è§„å¾‹ï¼ŒåŒæ—¶éšå«çŠ¶æ€ä¼šéšç€æ—¶é—´æ›´æ–°ï¼Œå³æœä»æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p(\boldsymbol{l}_t|\boldsymbol{l}_{t-1})\)</span>ã€‚</p><p>åœ¨çº¿æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆLinear State Space Modelï¼‰ä¸­æˆ‘ä»¬ä»¥å¦‚ä¸‹çš„æ–¹å¼åˆ»ç”»éšå«çŠ¶æ€çš„æ›´æ–°ï¼š <span class="math display">\[\boldsymbol{l}_t=\boldsymbol{F}_t\boldsymbol{l}_{t-1}+\boldsymbol{g}_t\varepsilon_t, \space\space\space\varepsilon_t\sim\mathcal{N}(0,1)\]</span> <span class="math inline">\(\boldsymbol{F}_t\)</span>ä¸ºç¡®å®šçš„çŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œè€Œ<span class="math inline">\(\boldsymbol{g}_t\varepsilon_t\)</span>åˆ™è¡¨ç¤ºäº†çŠ¶æ€è½¬ç§»çš„éšæœºæ€§ã€‚</p><p>è§‚æµ‹å€¼<span class="math inline">\(z_t\)</span>ä»éšå«çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_t\)</span>è®¡ç®—è€Œæ¥ï¼š <span class="math display">\[\begin{align}z_t&amp;=y_t+\sigma_t\epsilon_t,\\y_t&amp;=\boldsymbol{a}_t^\top\boldsymbol{l}_{t-1}+b_t,\\\epsilon_t&amp;\sim\mathcal{N}(0,1)\end{align}\]</span> å…¶ä¸­<span class="math inline">\(\boldsymbol{a}_t\in\mathbb{R}^L,\sigma_t\in \mathbb{R},b_t\in\mathbb{R}\)</span>éƒ½æ˜¯é¢å¤–çš„å‚æ•°ã€‚åˆå§‹çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_0\)</span>åˆ™ä»ä¸€ä¸ªç‹¬ç«‹çš„é«˜æ–¯åˆ†å¸ƒå¾—æ¥ï¼Œå³<span class="math inline">\(\boldsymbol{l}_0\sim N(\boldsymbol\mu_0,\text{diag}(\boldsymbol{\sigma}_0^2))\)</span>ã€‚</p><p>ä»¤å‚æ•°é›†åˆ<span class="math inline">\(\Theta_t=(\boldsymbol{\mu}_0,\boldsymbol{\Sigma}_0,\boldsymbol{F}_t,\boldsymbol{g}_t,\boldsymbol{a}_t,b_t,\sigma_t),\forall t&gt;0\)</span>ï¼Œä¸€èˆ¬æ¥è¯´å‚æ•°é›†åˆä¸ä¼šéšç€æ—¶é—´å˜åŒ–ï¼Œå³æ¯ä¸ªæ—¶åˆ»<span class="math inline">\(t\)</span>å…±äº«åŒæ ·çš„å‚æ•°<span class="math inline">\(\Theta_t=\Theta,\forall t&gt;0\)</span>ã€‚å¯¹å‚æ•°çš„ä¼°è®¡å¯ä»¥é‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ï¼š <span class="math display">\[\begin{align}\Theta^*_{1:T}&amp;=\arg\max_{\Theta_{1:T}}p(z_{1:T}|\Theta_{1:T}),\\\end{align}\]</span> å…¶ä¸­ï¼š <span class="math display">\[\begin{align}p(z_{1:T}|\Theta_{1:T})&amp;=p(z_1|\Theta_1)\prod\limits_{t=2}^T p(z_t|z_{1:t-1},\Theta_{1:t})\\&amp;=\int p(\boldsymbol{l}_0)\left[\prod\limits_{t=1}^T p(z_t|\boldsymbol{l}_t)p(\boldsymbol{l}_t|\boldsymbol{l}_{t-1})\right]\mathrm{d}\boldsymbol{l}_{0:T}\end{align}\]</span></p><h2 id="planar-normalizing-flow">Planar Normalizing Flow</h2><h3 id="normalizing-flows">Normalizing Flows</h3><p>VAEé‡‡ç”¨ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ<span class="math inline">\(q_\phi(z|x)\)</span>æ¥è¿‘ä¼¼çœŸå®çš„åéªŒåˆ†å¸ƒ<span class="math inline">\(p(z|x)\)</span>ï¼Œå¹¶æ¨å¯¼å‡º<span class="math inline">\(\log p_\theta(x)\)</span>çš„ä¸‹ç•Œï¼ˆç§°ä¸ºELBOï¼‰æ¥ä½œä¸ºä¼˜åŒ–ç›®æ ‡å‡½æ•°ï¼š <span class="math display">\[\begin{align}\log p_\theta(x)&amp;=\log \int p_\theta(x|z)p(z)\mathrm{d}z\\&amp;=\log\int\frac{q_\phi(z|x)}{q_\phi(z|x)}p_\theta(x|z)p(z)\mathrm{d}z\\&amp;\geq-D_{KL}[q_\phi(z|x)\parallel p(z)]+\mathbb{E}_q[\log p_\theta(x|z)]\end{align}\]</span> <span class="math inline">\(\log p_\theta(x)\)</span>ä¸ELBOå–ç­‰çš„æ¡ä»¶æ˜¯<span class="math inline">\(D_{KL}[q_\phi(z|x)\parallel p(z)]\)</span>ï¼Œè¡¨æ˜å˜åˆ†åˆ†å¸ƒå®Œå…¨åŒ¹é…äº†çœŸå®çš„åéªŒåˆ†å¸ƒã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒçœŸå®çš„åéªŒåˆ†å¸ƒå¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œè€Œæˆ‘ä»¬çš„å˜åˆ†åˆ†å¸ƒé€šå¸¸æ˜¯ä¸€ä¸ªç¡®å®šçš„è¾ƒä¸ºç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚è¿™æ ·å˜åˆ†åˆ†å¸ƒå¯èƒ½å¾ˆéš¾å¯¹çœŸå®åéªŒåˆ†å¸ƒå¾—åˆ°ä¸€ä¸ªå¾ˆå¥½çš„æ‹Ÿåˆã€‚</p><p>ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ ‡å‡†åŒ–æµï¼ˆNormalizing Flowsï¼‰ã€‚æ ‡å‡†åŒ–æµæ˜¯ä»ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒå‡ºå‘ï¼Œæ‰§è¡Œä¸€ç³»åˆ—å¯é€†çš„æ˜ å°„ï¼Œå°†åŸå§‹ç®€å•çš„åˆ†å¸ƒè½¬åŒ–ä¸ºä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒã€‚</p><p>é¦–å…ˆè€ƒè™‘ä¸€ä¸ªå…‰æ»‘çš„ã€å¯é€†çš„æ˜ å°„<span class="math inline">\(f:\mathbb{R}^d\mapsto \mathbb{R}^d\)</span>ï¼Œè®°<span class="math inline">\(g=f^{-1}\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(g\circ f(\mathbf{z})=\mathbf{z}\)</span>ã€‚ä»¤<span class="math inline">\(\mathbf{z}^\prime=f(\mathbf{z})\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(\mathbf{z}^\prime\)</span>çš„åˆ†å¸ƒä¸ºï¼š <span class="math display">\[q(\mathbf{z}^\prime)=q(\mathbf{z})\left|\text{det}\frac{\partial f^{-1}}{\partial \mathbf{z}^\prime}\right|=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}\]</span> å¼ä¸­<span class="math inline">\(q(\mathbf{z}^\prime)=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}\)</span>è¯´æ˜äº†<span class="math inline">\(\mathbf{z}^\prime\)</span>çš„åˆ†å¸ƒç­‰äº<span class="math inline">\(\mathbf{z}\)</span>çš„åˆ†å¸ƒä¹˜ä¸Š<span class="math inline">\(f\)</span>çš„JacobiançŸ©é˜µçš„è¡Œåˆ—å¼çš„å€’æ•°ã€‚é‚£ä¹ˆå¯¹äºæ˜ å°„å¤šæ¬¡çš„æƒ…å†µï¼š <span class="math display">\[\mathbf{z}_K=f_K\circ\cdots\circ f_2\circ f_1(\mathbf{z}_0)\]</span> <span class="math inline">\(\mathbf{z}_K\)</span>çš„åˆ†å¸ƒå¯ä»¥é€šè¿‡é“¾å¼è®¡ç®—å¾—åˆ°ï¼š <span class="math display">\[\ln q_K(\mathbf{z}_K)=\ln q_0(\mathbf{z}_0)-\sum\limits_{k=1}^K\ln\left|\text{det}\frac{\partial f_k}{\partial \mathbf{z}_{k-1}}\right|\]</span></p><h3 id="planar-flows">Planar Flows</h3><p>è€ƒè™‘ä¸€ä¸ªå˜æ¢æ—ï¼š <span class="math display">\[f(\mathbf{z})=\mathbf{z}+\mathbf{u}h(\mathbf{w}^\top\mathbf{z}+b)\]</span> å…¶ä¸­<span class="math inline">\(\lambda=\{\mathbf{w}\in \mathbb{R}^d,\mathbf{u}\in\mathbb{R}^d,b\in\mathbb{R}\}\)</span>ä¸ºå‚æ•°é›†åˆï¼Œ<span class="math inline">\(h(\cdot)\)</span>ä¸ºå…ƒç´ çº§çš„éçº¿æ€§å‡½æ•°ï¼ˆå¦‚å„ç§æ¿€æ´»å‡½æ•°ï¼‰ã€‚ä»¤<span class="math inline">\(\psi(\mathbf{z})=h^\prime(\mathbf{w}^\top\mathbf{z}+b)\mathbf{w}\)</span>ï¼Œåˆ™<span class="math inline">\(f\)</span>çš„JacobiançŸ©é˜µè¡Œåˆ—å¼ç»å¯¹å€¼ç­‰äºï¼š <span class="math display">\[\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|=\left|\text{det}(\mathbf{I}+\mathbf{u}\psi(\mathbf{z})^\top)\right|=\left|1+\mathbf{u}^\top\psi(\mathbf{z})\right|\]</span> ä½†æ˜¯<span class="math inline">\(f\)</span>å¹¶ä¸ä¿è¯æ€»æ˜¯å¯é€†çš„ï¼Œå¦‚<span class="math inline">\(h(x)=\tanh(x)\)</span>æ—¶ï¼Œ<span class="math inline">\(f\)</span>å¯é€†çš„æ¡ä»¶æ˜¯<span class="math inline">\(\mathbf{w}^\top \mathbf{u}\geq-1\)</span>ã€‚</p><p>ä¸‹é¢è®¨è®ºå¦‚ä½•ä¿è¯å¯é€†çš„æ¡ä»¶ã€‚è€ƒè™‘å°†<span class="math inline">\(\mathbf{z}\)</span>åˆ†è§£ä¸º<span class="math inline">\(\mathbf{z}=\mathbf{z}_\bot+\mathbf{z}_\parallel\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{z}_\bot\)</span>ä¸<span class="math inline">\(\mathbf{w}\)</span>æ­£äº¤ï¼Œ<span class="math inline">\(\mathbf{z}_\parallel\)</span>ä¸<span class="math inline">\(\mathbf{w}\)</span>å¹³è¡Œï¼Œé‚£ä¹ˆï¼š <span class="math display">\[f(z)=\mathbf{z}_\bot+\mathbf{z}_\parallel+\mathbf{u}h(\mathbf{w}^\top \mathbf{z}_\parallel +b)\]</span> å®é™…ä¸Šå¾—åˆ°<span class="math inline">\(\mathbf{z}_\parallel\)</span>ä¹‹åå¯ä»¥å¾ˆå®¹æ˜“çš„å¾—åˆ°<span class="math inline">\(\mathbf{z}_\bot\)</span>ï¼Œä»¤<span class="math inline">\(\mathbf{y}=f(\mathbf{z})\)</span>ï¼Œæœ‰ï¼š <span class="math display">\[\mathbf{z}_\bot=\mathbf{y}-\mathbf{z}_\parallel-\mathbf{u}h(\mathbf{w}^\top\mathbf{z}_\parallel+b)\]</span> è€Œ<span class="math inline">\(\mathbf{z}_\parallel\)</span>ä¸<span class="math inline">\(\mathbf{w}\)</span>å¹³è¡Œï¼Œæ˜“çŸ¥<span class="math inline">\(\mathbf{z}_\parallel=\alpha\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\alpha\in\mathbb{R}\)</span>ã€‚</p><p>å¯¹å¼(16)ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥<span class="math inline">\(\mathbf{w}^\top\)</span>å¯å¾—ï¼š <span class="math display">\[\mathbf{w}^\top f(\mathbf{z})=\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)\]</span> å½“<span class="math inline">\(\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)\)</span>å¯¹äº<span class="math inline">\(\alpha\)</span>æ˜¯éé€’å‡å‡½æ•°çš„æ—¶å€™ï¼Œ<span class="math inline">\(f\)</span>æ˜¯å¯é€†çš„ã€‚å› ä¸º<span class="math inline">\(\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)\)</span>æ˜¯éé€’å‡å‡½æ•°æ—¶æœ‰<span class="math inline">\(1+\mathbf{w}^\top\mathbf{u}h^\prime(\alpha+b)\geq 0\equiv \mathbf{w}^\top \mathbf{u}\geq -\frac{1}{h^\prime(\alpha + b)}\)</span>ï¼Œè€Œ<span class="math inline">\(0\leq h^\prime(\alpha + b) \leq 1\)</span>ï¼ˆ<span class="math inline">\(\tanh\)</span>å‡½æ•°çš„æ€§è´¨ï¼‰ï¼Œæ‰€ä»¥æ€»æ˜¯æœ‰<span class="math inline">\(\mathbf{w}^\top \mathbf{u}\geq-1\)</span>ã€‚</p><p>å¯¹äºä»»æ„ä¸€ä¸ª<span class="math inline">\(\mathbf{u}\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ–¹å¼æ„é€ ä¸€ä¸ª<span class="math inline">\(\hat{\mathbf{u}}\)</span>ä½¿å¾—<span class="math inline">\(\mathbf{w}^\top\hat{\mathbf{u}}&gt;-1\)</span>ï¼Œå³ä»¤<span class="math inline">\(\hat{\mathbf{u}}(\mathbf{w},\mathbf{u})=\mathbf{u}+[m(\mathbf{w}^\top\mathbf{u})-(\mathbf{w}^\top\mathbf{u})]\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(m(x)=-1+\log(1+e^x)\)</span>ã€‚</p><p><img src="https://i.loli.net/2020/06/25/uPyplhWBazROEw4.png" srcset="/img/loading.gif" /></p><h1 id="methodology">Methodology</h1><h2 id="problem-statement">Problem Statement</h2><p>æœ¬æ–‡é’ˆå¯¹çš„æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—<span class="math inline">\(x=\{x_1,x_2,\cdots,x_N\}\in R^{M\times N}\)</span>ï¼Œ<span class="math inline">\(N\)</span>ä¸ºæ—¶é—´é•¿åº¦ï¼Œå…¶ä¸­æŸä¸€æ—¶åˆ»çš„è§‚æµ‹å€¼<span class="math inline">\(x_t\in R^M\)</span>ä¸ºä¸€ä¸ª<span class="math inline">\(M\)</span>ç»´çš„å‘é‡ã€‚ä½œè€…ä½¿ç”¨<span class="math inline">\(x_{t-T:t}\in R^{M\times(T+1)}\)</span>æ¥è¡¨ç¤º<span class="math inline">\(t-T\)</span>åˆ°<span class="math inline">\(t\)</span>ä¹‹é—´çš„æ—¶é—´åºåˆ—ã€‚</p><p><img src="https://i.loli.net/2020/06/25/4eHhs82uOzI5tG3.png" srcset="/img/loading.gif" /></p><h2 id="overall-structure">Overall Structure</h2><p>ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/wd8maAoVb3Fk9vP.png" srcset="/img/loading.gif" /></p><p>é¢„å¤„ç†æ¨¡å—ä¸»è¦æ˜¯å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ä»¥åŠçª—å£åˆ‡åˆ†ã€‚è®­ç»ƒæ¨¡å—åˆ™æ ¹æ®è¾“å…¥çš„æ•°æ®å¯¹æ­£å¸¸æ¨¡å¼è¿›è¡Œæ•æ‰ï¼Œè¾“å‡ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨çº¿æ£€æµ‹æ¨¡å—åˆ™ä¼šå®šæœŸæ‰§è¡Œã€‚</p><h2 id="network-architecture">Network Architecture</h2><p>æ¨¡å‹çš„æ€»ä½“ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/Lp7D81EvxVsywXQ.png" srcset="/img/loading.gif" /></p><p>åœ¨qnetä¸­ï¼Œé¦–å…ˆGRUè¢«ç”¨æ¥å»ºæ¨¡æ ·æœ¬çš„æ—¶é—´ä¾èµ–å…³ç³»ï¼Œä¹‹åVAEå°†æ ·æœ¬<span class="math inline">\(\mathbf{x}\)</span>æ˜ å°„åˆ°éšç©ºé—´<span class="math inline">\(\mathbf{z}\)</span>ã€‚æ–‡ä¸­ä½¿ç”¨äº†Linear Gaussian State Space Modelæ¥å»ºæ¨¡éšå˜é‡ä¹‹é—´çš„æ—¶é—´ä¾èµ–å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜ä½¿ç”¨äº†Planar Normalizing Flowæ¥å°†éšå˜é‡æ˜ å°„åˆ°å¤æ‚çš„éé«˜æ–¯åˆ†å¸ƒã€‚åœ¨pnetä¸­ï¼Œéšå˜é‡<span class="math inline">\(\mathbf{z}_{t-T:t}\)</span>è¢«ç”¨æ¥é‡å»º<span class="math inline">\(\mathbf{x}_{t-T:t}\)</span>ï¼Œç›´è§‚ä¸Šæ¥è¯´ï¼Œå¯¹æ ·æœ¬çš„å¥½çš„éšå˜é‡è¡¨ç¤ºå¯ä»¥å¸¦æ¥æ›´å¥½çš„é‡æ„æ•ˆæœã€‚</p><p>ä»ç»†èŠ‚ä¸Šæ¥è¯´ï¼Œåœ¨æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œqnetçš„è¾“å…¥ä¸º<span class="math inline">\(\mathbf{x}_t\)</span>å’Œ<span class="math inline">\(\mathbf{e}_{t-1}\)</span>ï¼Œä¸¤è€…ç»è¿‡GRU Cellä¹‹åä¼šäº§ç”Ÿ<span class="math inline">\(t\)</span>æ—¶é—´çš„<span class="math inline">\(\mathbf{e_t}\)</span>ã€‚<span class="math inline">\(\mathbf{e}_t\)</span>æ˜¯GRUæ•æ‰æ—¶é—´ä¾èµ–æ€§çš„å…³é”®ï¼Œå¯ä»¥è®¤ä¸ºå®ƒåŒ…å«äº†<span class="math inline">\(\mathbf{x}_{1:t}\)</span>çš„ä¿¡æ¯ã€‚ä¹‹å<span class="math inline">\(\mathbf{e}_t\)</span>ä¼šå’Œ<span class="math inline">\(\mathbf{z}_{t-1}\)</span>è¿›è¡Œæ‹¼æ¥ï¼Œè¿›å…¥æ ‡å‡†çš„VAEå˜åˆ†ç½‘ç»œç»“æ„ï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„å‚æ•°<span class="math inline">\(\mu_{z_t},\sigma_{z_t}\)</span>é‡‡æ ·å¾—åˆ°éšå˜é‡<span class="math inline">\(\mathbf{z}_t^0\)</span>ï¼Œæ­¤æ—¶éšå˜é‡å¯ä»¥è¯´æ•æ‰äº†æ—¶é—´ä¾èµ–æ€§ã€‚</p><p>ç½‘ç»œä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><span class="math display">\[\begin{align}e_t&amp;=(1-c_t^e)\circ\text{tanh}(w^ex_t+u^e(r_t^e\circ e_{t-1})+b^e)+c_t^e\circ e_{t-1}\\\mu_{z_t}&amp;=w^{\mu_z}h^\phi([z_{t-1},e_t])+b^{\mu_z}\\\sigma_{z_t}&amp;=\text{softplus}(w^{\sigma_z}h^\phi([z_{t-1},e_t])+b^{\sigma_z})+\epsilon^{\sigma_z}\end{align}\]</span></p><p>å…¶ä¸­<span class="math inline">\(r_t^e=\text{sigmoid}(\mathbf{w}^{r^e}\mathbf{x}_t+\mathbf{u}^{r^e}\mathbf{e}_{t-1}+b^{r^e})\)</span>æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ<span class="math inline">\(c_t^e=\text{sigmoid}(\mathbf{w}^{c^e}\mathbf{x}_t+\mathbf{u}^{c^e}\mathbf{e}_{t-1}+b^{c^e})\)</span>æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p><p>æ­¤æ—¶<span class="math inline">\(\mathbf{z}_t^0\)</span>æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸ºäº†æ‹Ÿåˆå¤æ‚çš„åéªŒåˆ†å¸ƒï¼Œæˆ‘ä»¬ä½¿ç”¨Planar Normalizing Flowæ¥å¯¹<span class="math inline">\(\mathbf{z}_t^0\)</span>è¿›è¡Œå˜æ¢ï¼Œæœ€åå¾—åˆ°ç»<span class="math inline">\(K\)</span>æ¬¡å˜æ¢åçš„éšæœºå˜é‡<span class="math inline">\(\mathbf{z}_t^K\)</span>ã€‚</p><p>åœ¨æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œpnetè¯•å›¾é€šè¿‡<span class="math inline">\(\mathbf{z}_t^K\)</span>æ¥é‡æ„<span class="math inline">\(\mathbf{x}_t\)</span>ã€‚é¦–å…ˆ<span class="math inline">\(\mathbf{z}\)</span>ç©ºé—´ä¸­çš„å˜é‡ä¼šæ ¹æ®Linear Gaussian State Space Modelæ¥è¿›è¡Œâ€œè¿æ¥â€œï¼Œå…¬å¼ä¸º<span class="math inline">\(\mathbf{z}_t=\mathbf{O}_\theta(\mathbf{T}_\theta\mathbf{z}_{t-1}+\mathbf{v}_t)+\boldsymbol{\epsilon}_t\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{O}_\theta\)</span>å’Œ<span class="math inline">\(\mathbf{T}_\theta\)</span>ä¸ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œ<span class="math inline">\(\mathbf{v}_t\)</span>å’Œ<span class="math inline">\(\boldsymbol{\epsilon}_t\)</span>ä¸ºéšæœºå™ªå£°ã€‚ä¹‹å<span class="math inline">\(\mathbf{z}_t\)</span>å’Œ<span class="math inline">\(\mathbf{d}_{t-1}\)</span>ä¼šä½œä¸ºGRUçš„è¾“å…¥ï¼Œäº§ç”Ÿ<span class="math inline">\(\mathbf{d}_t\)</span>ã€‚ä¹‹å<span class="math inline">\(\mathbf{d}_t\)</span>ä¼šç»è¿‡æ ‡å‡†VAEä¸­çš„ç”Ÿæˆç½‘ç»œï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„é«˜æ–¯åˆ†å¸ƒå‚æ•°<span class="math inline">\(\mu_{x_t},\sigma_{x_t}\)</span>é‡‡æ ·å¾—åˆ°é‡æ„åçš„æ ·æœ¬<span class="math inline">\(\mathbf{x}^\prime_t\)</span>ã€‚pnetä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š <span class="math display">\[\begin{align}d_t&amp;=(1-c_t^d)\circ\text{tanh}(w^dz_t+u^d(r_t^d\circ d_{t-1})+b^d)+c_t^d\circ d_{t-1}\\\mu_{x_t}&amp;=w^{\mu_x}h^\theta(d_t)+b^{\mu_x}\\\sigma_{x_t}&amp;=\text{softplus}(w^{\sigma_x}h^\theta(d_t)+b^{\sigma_x})+\epsilon^{\sigma_x}\end{align}\]</span></p><p>å…¶ä¸­<span class="math inline">\(r_t^d=\text{sigmoid}(\mathbf{w}^{r^d}\mathbf{x}_t+\mathbf{u}^{r^d}\mathbf{d}_{t-1}+b^{r^d})\)</span>æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ<span class="math inline">\(c_t^d=\text{sigmoid}(\mathbf{w}^{c^d}\mathbf{x}_t+\mathbf{u}^{c^d}\mathbf{d}_{t-1}+b^{c^d})\)</span>æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p><h2 id="offline-model-training">Offline Model Training</h2><p>å’Œä¼ ç»ŸVAEç±»ä¼¼ï¼Œæ¨¡å‹çš„è®­ç»ƒå¯ä»¥é€šè¿‡ä¼˜åŒ–ELBOæ¥å®Œæˆã€‚è®°é•¿åº¦ä¸º<span class="math inline">\(T+1\)</span>çš„è¾“å…¥åºåˆ—ä¸º<span class="math inline">\(\mathbf{x}_{t-T:t}\)</span>ï¼Œéšç©ºé—´å˜é‡é‡‡æ ·æ¬¡æ•°ä¸º<span class="math inline">\(L\)</span>ï¼Œç¬¬<span class="math inline">\(l\)</span>ä¸ªéšç©ºé—´å˜é‡ä¸º<span class="math inline">\(\mathbf{l}^{(l)}_{t-T:t}\)</span>ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p><p><span class="math display">\[\tilde{\mathcal{L}}(\mathbf{x}_{t-T:t})\approx\frac{1}{L}\sum_{t=1}^L[\log(p_\theta(\mathbf{x}_{t-T:t}|\mathbf{z}_{t-T:t}^{(l)}))+\log(p_\theta(\mathbf{z}_{t-T:t}^{(l)}))-\log(q_\phi(\mathbf{z}_{t-T:t}^|\mathbf{x}_{t-T:t}))]\]</span></p><p>ç¬¬ä¸€é¡¹<span class="math inline">\(\log(p_\theta(\mathbf{x}_{t-T:t}|\mathbf{z}_{t-T:t}^{(l)}))\)</span>å¯ä»¥çœ‹ä½œæ˜¯é‡æ„è¯¯å·®ï¼›ç¬¬äºŒé¡¹<span class="math inline">\(\log(p_\theta(\mathbf{z}_{t-T:t}))=\sum_{i=t-T}^t \log(p_\theta(\mathbf{z}_i|\mathbf{z}_{i-1}))\)</span>é€šè¿‡Linear Gaussian State Space Modelè®¡ç®—ï¼›ç¬¬ä¸‰é¡¹<span class="math inline">\(-\log(q_\phi(\mathbf{z}_{t-T:t}|\mathbf{x}_{t-T:t}))=-\sum_{i=t-T}^t\log(q_\phi(\mathbf{z}_i|\mathbf{z}_{i-1},\mathbf{x}_{t-T:i}))\)</span>ä¸ºéšå˜é‡<span class="math inline">\(\mathbf{z}\)</span>åéªŒåˆ†å¸ƒçš„ä¼°è®¡ï¼ŒåŒæ—¶<span class="math inline">\(\mathbf{z}_i\)</span>æ˜¯ç»Planar Normalizing Flowè½¬æ¢è¿‡çš„ã€‚</p><h2 id="online-detection">Online Detection</h2><p>åœ¨è®­ç»ƒå¥½æ¨¡å‹ä¹‹åï¼Œå°±å¯ä»¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹äº†ã€‚åœ¨æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œæˆ‘ä»¬é€šè¿‡æ ¹æ®é•¿åº¦ä¸º<span class="math inline">\(T+1\)</span>çš„åºåˆ—<span class="math inline">\(\mathbf{x}_{t-T:t}\)</span>æ¥é‡æ„<span class="math inline">\(\mathbf{x}_t\)</span>ï¼Œå¹¶æ ¹æ®é‡æ„æ¦‚ç‡<span class="math inline">\(\log(p_\theta(\mathbf{x}_t|\mathbf{z}_{t-T:t}))\)</span>æ¥åˆ¤å®šå¼‚å¸¸ã€‚å®šä¹‰<span class="math inline">\(\mathbf{x}_t\)</span>å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°<span class="math inline">\(S_t=\log(p_\theta(\mathbf{x}_t|\mathbf{z}_{t-T:t}))\)</span>ï¼Œé«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ ·æœ¬<span class="math inline">\(\mathbf{x}_t\)</span>èƒ½å¤Ÿä»¥å¤§æ¦‚ç‡é‡æ„ï¼ˆå› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è®­ç»ƒï¼Œå¯ä»¥è®¤ä¸ºæ¨¡å‹å»ºæ¨¡çš„æ˜¯æ­£å¸¸æ ·æœ¬çš„åˆ†å¸ƒï¼Œé‡æ„æ¦‚ç‡é«˜å°±ä»£è¡¨ç¬¦åˆæ­£å¸¸åˆ†å¸ƒï¼‰ã€‚ç»™å®šé˜ˆå€¼ä¹‹åä¾¿å¯æ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤å®šã€‚</p><h2 id="automatic-threshold-selection">Automatic Threshold Selection</h2><p>åœ¨å¼‚å¸¸æ£€æµ‹é˜¶æ®µï¼Œéœ€è¦æ ¹æ®è®¾å®šçš„é˜ˆå€¼å’Œæ¯ä¸ªæ ·æœ¬çš„å¼‚å¸¸åˆ†æ•°æ¥åˆ¤æ–­è¯¥æ ·æœ¬æ˜¯å¦ä¸ºå¼‚å¸¸ï¼Œæ‰€ä»¥é˜ˆå€¼çš„é€‰æ‹©ååˆ†é‡è¦ã€‚æ–‡ä¸­ç”¨åˆ°äº†ä¸€ç§æ ¹æ®<strong>Extreme Value Theory</strong>è‡ªåŠ¨é€‰æ‹©é˜ˆå€¼çš„ç®—æ³•ã€‚å¯¹äºä¸€ä¸ªåˆ†å¸ƒï¼Œå…¶ä¸­çš„æç«¯äº‹ä»¶å¾€å¾€ä½äºåˆ†å¸ƒçš„æœ«å°¾ï¼Œè€ŒExtreme Value Theoryç¬¬ä¸€å®šç†ç»™å‡ºä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ï¼Œè¿™äº›æç«¯äº‹ä»¶çš„åˆ†å¸ƒæœä»ä¸€ä¸ªå¸¦å‚çš„åˆ†å¸ƒæ—ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨å¯¹æ•°æ®åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡æç«¯äº‹ä»¶çš„åˆ†å¸ƒã€‚</p><p>é™¤äº†Extreme Value Theoryç¬¬ä¸€å®šç†ä¹‹å¤–ï¼ŒExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼<span class="math inline">\(t\)</span>çš„åˆ†å¸ƒå¯ä»¥ç”¨Generalized Pareto Distributionæ¥æè¿°ã€‚ä½œè€…ä½¿ç”¨äº†åŸºäºExtreme Value Theoryç¬¬äºŒå®šç†çš„Peaks-Over-Thresholdç®—æ³•æ¥è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚å› ä¸ºExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼<span class="math inline">\(t\)</span>çš„åˆ†å¸ƒï¼Œè€Œåœ¨æœ¬æ–‡çš„åœºæ™¯ä¸­æˆ‘ä»¬éœ€è¦åˆ»ç”»çš„å¼‚å¸¸ç‚¹çš„åˆ†å¸ƒåº”è¯¥æ˜¯å°äºä¸€ä¸ªç»™å®šé˜ˆå€¼çš„åˆ†å¸ƒï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹å…¬å¼ã€‚</p><p>å¯¹äºç»™å®šçš„æ•°æ®ï¼Œæ¨¡å‹ä¼šç»™å‡ºå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°åºåˆ—<span class="math inline">\(\{S_1,S_2,\cdots,S_{N^\prime}\}\)</span>ï¼Œç»™å®šé¢„å…ˆè®¾å®šçš„é˜ˆå€¼<span class="math inline">\(th\)</span>ï¼Œ<span class="math inline">\(S_i\)</span>æç«¯éƒ¨åˆ†ï¼ˆå³å°äº<span class="math inline">\(th\)</span>çš„éƒ¨åˆ†ï¼‰çš„åˆ†å¸ƒç¬¦åˆGeneralized Pareto Distributionï¼Œå…¬å¼å¦‚ä¸‹ï¼š <span class="math display">\[\bar{F}(s)=P(th-S&gt;s|S&lt;th)\sim(1+\frac{\gamma s}{\beta})^{-\frac{1}{\gamma}}\]</span></p><p>å…¶ä¸­<span class="math inline">\(\gamma\)</span>å’Œ<span class="math inline">\(\beta\)</span>ä¸ºåˆ†å¸ƒçš„å½¢çŠ¶å‚æ•°ï¼Œæœ¬æ–‡ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ¥å¯¹å‚æ•°è¿›è¡Œä¼°è®¡ã€‚è®¾å‚æ•°çš„ä¼°è®¡å€¼åˆ†åˆ«ä¸º<span class="math inline">\(\hat{\gamma}\)</span>å’Œ<span class="math inline">\(\hat{\beta}\)</span>ï¼Œæœ€ç»ˆçš„é˜ˆå€¼<span class="math inline">\(th_F\)</span>ç”±æ‹Ÿåˆå¾—åˆ°çš„åˆ†å¸ƒçš„åˆ†ä½æ•°ç¡®å®šï¼š</p><p><span class="math display">\[th_F\simeq th-\frac{\hat{\beta}}{\hat{\gamma}}((\frac{qN^\prime}{N^\prime_{th}})^{-\hat{\gamma}}-1)\]</span></p><p>å…¶ä¸­<span class="math inline">\(q\)</span>ä¸ºæœŸæœ›<span class="math inline">\(S&lt;th\)</span>çš„æ¦‚ç‡ï¼Œ<span class="math inline">\(N^\prime\)</span>ä¸ºè§‚æµ‹å€¼çš„æ•°é‡ï¼Œ<span class="math inline">\(N^\prime_{th}\)</span>ä¸º<span class="math inline">\(S_i&lt;th\)</span>çš„ä¸ªæ•°ã€‚</p><h2 id="anomaly-interpretation">Anomaly Interpretation</h2><p><span class="math display">\[\log(p_\theta(\mathbf{x}_t|\mathbf{z}_{t-T:t}))=\sum_{i=1}^M\log(p_\theta(x_t^i|\mathbf{z}_{t-T:t}))\]</span></p><h1 id="experiments">Experiments</h1><h2 id="datasets-and-metrics">Datasets and Metrics</h2><h2 id="overall-performance">Overall Performance</h2><p><img src="https://i.loli.net/2020/06/25/yYLiWfXBDQklbPU.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/25/HlORKBEu7ij6Vor.png" srcset="/img/loading.gif" /></p><h2 id="effects-of-major-techniques">Effects of Major Techniques</h2><p><img src="https://i.loli.net/2020/06/25/eKXGJ9ZlSmq8r4Q.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/25/dlibhyOBXNmPrkw.png" srcset="/img/loading.gif" /></p><h2 id="visualization-on-z-space-representations">Visualization on Z-Space Representations</h2><p><img src="https://i.loli.net/2020/06/25/MQXv5pZAejgVJ9s.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/25/jCkovq2lWrP6KXy.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/25/JSZuUkzNyci41DA.png" srcset="/img/loading.gif" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>VAE</tag>
      
      <tag>RNN</tag>
      
      <tag>Flow-based Model</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GAIN: Missing Data Imputation using Generative Adversarial Nets</title>
    <link href="/2019/10/16/GAIN-Missing-Data-Imputation-using-Generative-Adversarial-Nets/"/>
    <url>/2019/10/16/GAIN-Missing-Data-Imputation-using-Generative-Adversarial-Nets/</url>
    
    <content type="html"><![CDATA[<h1 id="abstract">Abstract</h1><p>æœ¬æ–‡åŸºäºGANæå‡ºäº†ä¸€ç§æ—¶é—´åºåˆ—ç¼ºå¤±å€¼å¡«å……ï¼ˆTime Series Imputationï¼‰çš„æ–¹æ³•ã€‚å…¶ä¸»è¦çš„æ€è·¯ä¸ºç”Ÿæˆå™¨<span class="math inline">\(G\)</span>ä»éšç©ºé—´<span class="math inline">\(Z\)</span>ç”Ÿæˆå®Œæ•´çš„æ ·æœ¬ï¼Œè€Œåˆ¤åˆ«å™¨<span class="math inline">\(D\)</span>åˆ™è¾“å‡ºæ ·æœ¬ä¸­ä¸åŒéƒ¨åˆ†ä¸ºçœŸå®çš„æ¦‚ç‡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…æå‡ºäº†ä½¿ç”¨Hint Vectoræ¥æ­ç¤ºåŸå§‹æ•°æ®ä¸­ç¼ºå¤±éƒ¨åˆ†çš„ä¿¡æ¯ï¼Œæ¥ä¼˜åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚</p><p><a href="https://arxiv.org/abs/1806.02920" target="_blank" rel="noopener">åŸæ–‡</a></p><h1 id="methodology">Methodology</h1><h2 id="problem-formulation">Problem Formulation</h2><p>è€ƒè™‘ä¸€ä¸ª<span class="math inline">\(d\)</span>ç»´çš„ç©ºé—´<span class="math inline">\(\mathcal{X}=\mathcal{X}_1\times \cdots\times \mathcal{X}_d\)</span>ï¼Œè®¾<span class="math inline">\(\mathbf{X}=(X_1,\cdots,X_d)\)</span>ç»´ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>ä¸Šçš„éšæœºå‘é‡ï¼ˆå³ç†æƒ³çš„å®Œæ•´çš„æ—¶é—´åºåˆ—ï¼‰ï¼Œè®°å…¶åˆ†å¸ƒä¸º<span class="math inline">\(P(\mathbf{X})\)</span>ã€‚è®¾<span class="math inline">\(\mathbf{M}=(M_1,\cdots,M_d)\)</span>ä¸ºMaskå‘é‡è¡¨ç¤º<span class="math inline">\(\mathbf{X}\)</span>ä¸­è¢«è§‚å¯Ÿåˆ°çš„éƒ¨åˆ†ã€‚ï¼ˆå³æ ‡è¯†æ—¶é—´åºåˆ—å“ªäº›éƒ¨åˆ†æœ‰ç¼ºå¤±ï¼‰ï¼Œå–å€¼ä¸º<span class="math inline">\(\{0,1\}^d\)</span>ã€‚</p><p>å¯¹äºæ¯ä¸€ä¸ª<span class="math inline">\(i\in\{1,\cdots,d\}\)</span>ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°ç©ºé—´<span class="math inline">\(\tilde{\mathcal{X}}=\mathcal{X}\cup\{*\}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(*\)</span>è¡¨ç¤ºä¸å±äºä»»æ„<span class="math inline">\(\mathcal{X}_i\)</span>çš„ä¸€ä¸ªç‚¹ã€‚ä»¤<span class="math inline">\(\tilde{\mathcal{X}}=\tilde{\mathcal{X}_1}\times\cdots\times\tilde{\mathcal{X}_d}\)</span>ï¼ŒåŒæ—¶å®šä¹‰ä¸€ä¸ªæ–°çš„éšæœºå˜é‡ï¼ˆå³æˆ‘ä»¬è§‚æµ‹åˆ°çš„å«æœ‰ç¼ºå¤±å€¼çš„æ—¶é—´åºåˆ—ï¼‰<span class="math inline">\(\tilde{\mathbf{X}}=(\tilde{X}_1,\cdots,\tilde{X}_d)\in \tilde{\mathcal{X}}\)</span>ï¼š <span class="math display">\[\tilde{X}_i=\begin{cases}X_i,&amp;\text{if } M_i=1\\*,&amp;\text{otherwise}\end{cases}\]</span> å‡è®¾æ•°æ®é›†çš„å½¢å¼ä¸º<span class="math inline">\(\mathcal{D}=\{(\tilde{x}^i,m^i)\}^n_{i=1}\)</span>ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ä»<span class="math inline">\(P(\mathbf{X}|\tilde{\mathbf{X}}=\tilde{x}^i)\)</span>ä¸Šé‡‡æ ·æ¥å¯¹ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ã€‚</p><h2 id="model-architecture">Model Architecture</h2><p>æ¨¡å‹çš„æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/wCK3J8MoTASrj9Y.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="generator">Generator</h3><p>ç”Ÿæˆå™¨çš„è¾“å…¥æœ‰ä¸‰é¡¹ï¼š<span class="math inline">\(\tilde{\mathbf{X}}\)</span>ï¼Œ<span class="math inline">\(\mathbf{M}\)</span>å’Œéšæœºå™ªå£°<span class="math inline">\(\mathbf{Z}\)</span>ï¼Œè¾“å‡ºè®¾ä¸º<span class="math inline">\(\bar{\mathbf{X}}\)</span>ã€‚è®¾ç”Ÿæˆå™¨ä¸ºæ˜ å°„<span class="math inline">\(G: \tilde{\mathcal{X}}\times\{0,1\}^d\times[0,1]^d\rightarrow \mathcal{X}\)</span>ï¼Œè€Œ<span class="math inline">\(\mathbf{Z}\)</span>ä¸º<span class="math inline">\(d\)</span>ç»´çš„é«˜æ–¯å™ªå£°ã€‚ç”Ÿæˆå™¨çš„è¾“å‡ºå’Œå¡«å……åçš„æ—¶é—´åºåˆ—å®šä¹‰ä¸ºï¼š <span class="math display">\[\begin{align}\bar{\mathbf{X}}&amp;=G(\tilde{\mathbf{X}},\mathbf{M},(1-\mathbf{M})\odot\mathbf{Z})\\\hat{\mathbf{X}}&amp;=\mathbf{M}\odot\tilde{\mathbf{X}}+(1-\mathbf{M})\odot\bar{\mathbf{X}}\end{align}\]</span> <span class="math inline">\(\bar{\mathbf{X}}\)</span>å³ä¸ºç”Ÿæˆå™¨çš„ç›´æ¥è¾“å‡ºï¼Œå› ä¸ºå…¶å®æœ‰äº›éƒ¨åˆ†æ²¡æœ‰ç¼ºå¤±ï¼Œç”Ÿæˆå™¨è¿˜æ˜¯ä¼šä¸ºæ¯ä¸ªéƒ¨åˆ†è¾“å‡ºå€¼ã€‚</p><p><span class="math inline">\(\hat{\mathbf{X}}\)</span>ä¸ºå¡«å……åçš„æ—¶é—´åºåˆ—ï¼Œå¯¹äºç¼ºå¤±çš„éƒ¨åˆ†é‡‡ç”¨ç”Ÿæˆå™¨çš„è¾“å‡ºè¿›è¡Œå¡«å……ã€‚</p><h3 id="discriminator">Discriminator</h3><p>å’ŒåŸå§‹çš„GANä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ¤æ–­æ•´ä¸ªæ ·æœ¬æ˜¯çœŸå®çš„æˆ–è€…æ˜¯ç”Ÿæˆçš„ï¼Œè€Œæ˜¯éœ€è¦åˆ¤æ–­æ ·æœ¬çš„é‚£äº›éƒ¨åˆ†æ˜¯çœŸå®çš„æˆ–è€…æ˜¯ç”Ÿæˆçš„ï¼Œæ‰€ä»¥åˆ¤åˆ«å™¨ä¸ºæ˜ å°„<span class="math inline">\(D: \mathcal{X}\rightarrow[0,1]^d\)</span>ã€‚åˆ¤åˆ«å™¨çš„å…·ä½“ç›®æ ‡å‡½æ•°å°†åœ¨åé¢è®¨è®ºã€‚</p><h3 id="hint">Hint</h3><p>Hintæ˜¯ä¸€ç§æç¤ºæœºå€¼ï¼Œæ˜¯ä¸€ä¸ªå’Œ<span class="math inline">\(\mathbf{X}\)</span>ç›¸åŒç»´åº¦çš„éšæœºå˜é‡<span class="math inline">\(\mathbf{H}\)</span>ï¼Œå…¶åˆ†å¸ƒä¾èµ–äº<span class="math inline">\(\mathbf{M}\)</span>ã€‚<span class="math inline">\(\mathbf{H}\)</span>æ˜¯ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰çš„ï¼Œç›¸å½“äºä¸€ç§ä¸å®Œæ•´çš„<span class="math inline">\(\mathbf{M}\)</span>ï¼Œç”¨æ¥ä½œä¸ºåˆ¤åˆ«å™¨çš„é¢å¤–è¾“å…¥ã€‚</p><h3 id="objective">Objective</h3><p>æˆ‘ä»¬è®­ç»ƒåˆ¤åˆ«å™¨æœ€å¤§åŒ–æ­£ç¡®é¢„æµ‹<span class="math inline">\(\mathbf{M}\)</span>çš„æ¦‚ç‡ï¼Œè€Œç”Ÿæˆå™¨æœ€å°åŒ–åˆ¤åˆ«å™¨æ­£ç¡®é¢„æµ‹<span class="math inline">\(\mathbf{M}\)</span>çš„æ¦‚ç‡ï¼Œç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š <span class="math display">\[\begin{align}V(D,G)=&amp;\mathbb{E}_{\hat{X},M,H}[\mathbf{M}^T\log D(\hat{\mathbf{X}},\mathbf{H})\\&amp;+(1-\mathbf{M})^T\log(1-D(\hat{\mathbf{X}},\mathbf{H}))]\end{align}\]</span> æŒ‰ç…§æ ‡å‡†çš„GANå¯ä»¥å°†ä¼˜åŒ–å‡½æ•°å†™æˆä»¥ä¸‹çš„å½¢å¼ï¼š <span class="math display">\[\min_G\max_D V(D,G)\]</span> åœ¨è¿™é‡Œåˆ¤åˆ«å™¨çš„ä»»åŠ¡å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªäºŒåˆ†ç±»ï¼Œè€Œç›®æ ‡å‡½æ•°å°±æ˜¯äºŒå€¼äº¤å‰ç†µçš„å®šä¹‰ï¼Œå› æ­¤å¯ä»¥å†™ä¸ºï¼š <span class="math display">\[\mathcal{L}(a,b)=\sum\limits_{i=1}^d[a_i\log(b_i)+(1-a_i)\log(1-b_i)]\]</span> <span class="math inline">\(\mathbf{M}\)</span>å¯ä»¥çœ‹ä½œGround Truthï¼Œè®°<span class="math inline">\(\hat{\mathbf{M}}=D(\hat{\mathbf{X},\mathbf{H}})\)</span>ï¼Œå³åˆ¤åˆ«å™¨è¾“å‡ºçš„é¢„æµ‹ï¼Œå› æ­¤ä¼˜åŒ–å‡½æ•°å¯ä»¥ç®€è®°ä¸ºï¼š <span class="math display">\[\min_G\max_D\mathbb{E}[\mathcal{L}(\mathbf{M},\hat{\mathbf{M}})]\]</span></p><h2 id="gain-algorithm">GAIN Algorithm</h2><p>ä¸‹é¢è®¨è®ºGAINç®—æ³•çš„è®­ç»ƒæµç¨‹ã€‚</p><p>æœ¬æ–‡é€šè¿‡ç†è®ºè®¨è®ºï¼Œç»™å‡ºäº†ç”ŸæˆHint Vectorçš„ä¸€ä¸ªæ–¹æ³•ï¼Œé¦–å…ˆå®šä¹‰éšæœºå˜é‡<span class="math inline">\(\mathbf{B}=(B_1,\cdots,B_d)\in\{0,1\}^d\)</span>ï¼Œ<span class="math inline">\(\mathbf{B}\)</span>é€šè¿‡ä»<span class="math inline">\(\{1,\cdots,d\}\)</span>éšæœºå‡åŒ€é‡‡æ ·ä¸€ä¸ª<span class="math inline">\(k\)</span>ï¼Œç„¶åç”±ä¸‹åˆ—å…¬å¼å¾—åˆ°ï¼š <span class="math display">\[B_j=\begin{cases}1, &amp;\text{if }j\neq k\\0, &amp;\text{if }j=k\end{cases}\]</span> å®šä¹‰ç©ºé—´<span class="math inline">\(\mathcal{H}=\{0,0.5,1\}^d\)</span>ï¼ŒHint Vectorä¸º<span class="math inline">\(\mathbf{H}=\mathbf{B}\odot\mathbf{M}+0.5(1-\mathbf{B})\in\mathcal{H}\)</span>ã€‚</p><p>åˆ¤åˆ«å™¨çš„è®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼šå›ºå®šç”Ÿæˆå™¨<span class="math inline">\(G\)</span>ï¼Œå¯¹ä¸€ä¸ªå¤§å°ä¸º<span class="math inline">\(k_D\)</span>çš„mini-batchï¼Œç‹¬ç«‹åŒåˆ†å¸ƒé‡‡æ ·<span class="math inline">\(k_D\)</span>ä¸ª<span class="math inline">\(z\)</span>å’Œ<span class="math inline">\(b\)</span>ï¼Œç”¨æ¥è®¡ç®—<span class="math inline">\(\mathbf{Z}\)</span>å’Œ<span class="math inline">\(\mathbf{B}\)</span>ã€‚åˆ¤åˆ«å™¨çš„æŸå¤±å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š <span class="math display">\[\mathcal{L}_D(m,\hat{m},b)=\sum\limits_{i:b_i=0}[m_i\log(\hat{m}_i)+(1-m_i)\log(1-\hat{m}_i)]\]</span> åˆ¤åˆ«å™¨çš„ä¼˜åŒ–å‡½æ•°ä¸ºï¼š <span class="math display">\[\min_D-\sum\limits_{j=1}^{k_D}\mathcal{L}_D(m(j),\hat{m}(j),b(j))\]</span> å…¶ä¸­<span class="math inline">\(\hat{m}(j)=D(\hat{x}(j),m(j))\)</span>ã€‚</p><p>åœ¨ä¼˜åŒ–äº†åˆ¤åˆ«å™¨ä¹‹åï¼Œéœ€è¦ä¼˜åŒ–ç”Ÿæˆå™¨ï¼Œå¯¹ä¸€ä¸ªå¤§å°ä¸º<span class="math inline">\(k_G\)</span>çš„mini-batchï¼Œç”Ÿæˆå™¨çš„æŸå¤±å‡½æ•°åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯åœ¨ç¼ºå¤±éƒ¨åˆ†çš„æŸå¤±ï¼š</p><p><span class="math display">\[\mathcal{L}_G(m,\hat{m},b)=-\sum\limits_{i:b_i=0}(1-m_i)\log(\hat{m}_i)\]</span> ä¸€ä¸ªæ˜¯æœªç¼ºå¤±éƒ¨åˆ†çš„æŸå¤±ï¼š <span class="math display">\[\mathcal{L}_M(x,x^\prime)=\sum\limits_{i=1}^d m_iL_M(x_i,x_i^\prime)\]</span> å…¶ä¸­ï¼š <span class="math display">\[L_M(x_i,x_i^\prime)=\begin{cases}(x_i^\prime-x_i)^2, &amp;\text{if }x_i\text{ is continuours},\\-x_i\log(x_i^\prime), &amp;\text{if }x_i\text{ is binary}.\end{cases}\]</span> æœ€ç»ˆçš„ä¼˜åŒ–å‡½æ•°ä¸ºï¼š <span class="math display">\[\min_G\sum\limits_{j=1}^{k_G}\mathcal{L}_G(m(j),\hat{m}(j),b(j))+\alpha\mathcal{L}_M(\tilde{x}(j),\hat{x}(j))\]</span> ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/znABi6x9mJuvDOX.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h1 id="experiments">Experiments</h1><p>ä¸‹è¡¨ä¸ºåœ¨5ä¸ªä¸åŒæ•°æ®é›†ä¸Šå®éªŒï¼Œä¸å…¶ä»–5ç§æ–¹æ³•å¯¹æ¯”çš„ç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/EenX2YO8aDxQAk3.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä¸Šå›¾ä¸ºGAINã€MissForestå’ŒAutoencoderä¸‰ç§æ¨¡å‹åœ¨ä¸åŒç¼ºå¤±æ¯”ä¾‹ã€æ ·æœ¬æ•°é‡ã€ç‰¹å¾ç»´åº¦ä¸‹çš„å¯¹æ¯”æ›²çº¿å›¾ã€‚</p><p>ä¸‹è¡¨ä¸ºä½¿ç”¨ä¸åŒæ¨¡å‹å¯¹æ—¶é—´åºåˆ—è¿›è¡Œå¡«å……ä¹‹åï¼Œä½¿ç”¨é€»è¾‘å›å½’è¿›è¡Œå›å½’ä»»åŠ¡çš„æ€§èƒ½ï¼š</p><p><img src="https://i.loli.net/2020/06/25/PzeWKdGu4wADshV.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä¸‹å›¾ä¸ºGAINã€MissForestå’ŒAutoencoderä¸‰ç§æ¨¡å‹åœ¨ä¸åŒç¼ºå¤±æ¯”ä¾‹ä¸‹çš„AUROCæ›²çº¿å›¾ï¼š</p><p><img src="https://i.loli.net/2020/06/25/IKtoTj8xgG1yJDk.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä¸‹è¡¨å±•ç¤ºçš„æ˜¯ä½œè€…å¯¹æ—¶é—´åºåˆ—å¡«å……ç®—æ³•ä¿æŒç‰¹å¾-æ ‡ç­¾å…³ç³»çš„èƒ½åŠ›ã€‚ä½œè€…åˆ†åˆ«ç”¨å®Œæ•´çš„æ•°æ®å’Œå¡«å……åçš„æ•°æ®ç”¨é€»è¾‘å›å½’æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œå°†ä¸¤è€…çš„æƒé‡æ±‚ç»å¯¹å€¼å’Œå‡æ–¹æ ¹çš„ç»“æœã€‚</p><p><img src="https://i.loli.net/2020/06/25/uy2jPcnbtSrC6vI.png" srcset="/img/loading.gif" style="zoom:67%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Time Series Imputation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>GAN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Anomaly Detection with Generative Adversarial Networks for Multivariate Time Series</title>
    <link href="/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/"/>
    <url>/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>è¿™ç¯‡æ–‡ç« æå‡ºäº†ä¸€ä¸ªåŸºäºGANçš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¨¡å‹ã€‚</p><p><a href="https://arxiv.org/abs/1809.04758" target="_blank" rel="noopener">åŸæ–‡</a></p><h2 id="contribution">Contribution</h2><ol type="1"><li>æå‡ºäº†åŸºäºGANçš„æ—¶é—´åºåˆ—æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹æ¨¡å‹</li><li>æˆ‘ä»¬ä½¿ç”¨åŸºäºLSTMçš„GANæ¥å¯¹å¤šå˜é‡æ—¶é—´åºåˆ—è¿›è¡Œå»ºæ¨¡</li><li>ç»“åˆä½¿ç”¨äº†Residual Losså’ŒDiscrimination Lossæ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­</li></ol><h2 id="background">Background</h2><h3 id="generative-adversarial-networks">Generative Adversarial Networks</h3><h4 id="gans-in-a-nutshell-an-extremely-simple-explanation">GANs In a Nutshell, an extremely simple explanation</h4><ul><li>æˆ‘ä»¬æƒ³è¦ä»ä¸€ä¸ªå¤æ‚çš„ã€é«˜ç»´çš„æ•°æ®åˆ†å¸ƒ<span class="math inline">\(p_r(x)\)</span>ä¸Šé‡‡æ ·å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ç‚¹ï¼Œç„¶è€Œ<span class="math inline">\(p_r(x)\)</span>æ— æ³•ç›´æ¥æ±‚å¾—</li><li>ä»£æ›¿æ–¹æ³•ï¼šä»ä¸€ä¸ªç®€å•çš„ã€å·²çŸ¥çš„åˆ†å¸ƒ<span class="math inline">\(p_z(z)\)</span>ä¸Šé‡‡æ ·ï¼Œç„¶åå­¦ä¹ ä¸€ä¸ªTransformation <span class="math inline">\(G(z): z\rightarrow x\)</span>æ¥å°†<span class="math inline">\(z\)</span>æ˜ å°„åˆ°<span class="math inline">\(x\)</span></li></ul><p><img src="https://i.loli.net/2020/06/25/frIYtuao9mexQUT.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h4 id="training-two-player-game">Training: Two-player Game</h4><ul><li><strong>Generator Network: </strong> ä»éšæœºåˆ†å¸ƒ<span class="math inline">\(p_z(z)\)</span>é‡‡æ ·<span class="math inline">\(z\)</span>ï¼Œé€šè¿‡æ˜ å°„ç”Ÿæˆæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œè¿™ä¸ªç”Ÿæˆçš„æ ·æœ¬è¦å°½é‡â€œçœŸå®â€ã€‚æ€ä¹ˆâ€œçœŸå®â€ï¼Ÿä¼˜åŒ–ç”Ÿæˆå™¨å‚æ•°<span class="math inline">\(\theta_G\)</span>æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†å³å¯</li><li><strong>Discriminator Network: </strong>æ¥å—ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œåˆ¤æ–­å…¶æ˜¯ç”Ÿæˆçš„æ ·æœ¬è¿˜æ˜¯çœŸå®çš„æ ·æœ¬ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œæˆ‘ä»¬æ˜¯çŸ¥é“ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>åˆ°åº•æ˜¯ç”Ÿæˆçš„è¿˜æ˜¯çœŸå®çš„ï¼Œæ‰€ä»¥ä¼˜åŒ–åˆ¤åˆ«å™¨å‚æ•°<span class="math inline">\(\theta_D\)</span>æœ€å°åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†ï¼Œæœ€å¤§åŒ–å¯¹çœŸå®æ ·æœ¬çš„è¯„åˆ†ï¼ˆå³æœ€å¤§åŒ–åˆ†è¾¨çœŸå®æ ·æœ¬çš„èƒ½åŠ›ï¼‰</li></ul><p><img src="https://i.loli.net/2020/06/25/ECP2Dkpq6FrSoef.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>å½¢å¼åŒ–çš„æ¥è®²ï¼Œä¼˜åŒ–å‡½æ•°å¦‚ä¸‹ï¼š</p><p><span class="math display">\[\min\limits_{\theta_G}\max\limits_{\theta_D}V(G,D)=\mathbb{E}_{x\sim p_{data}(x)\log(\underbrace{D_{\theta{D}}(x)}_{åˆ¤åˆ«å™¨å¯¹çœŸå®æ ·æœ¬çš„è¯„åˆ†})}+\mathbb{E}_{z\sim p_z(z)}\log(1-\underbrace{D_{\theta_d}(G_{\theta_G}(z))}_{åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†})\]</span></p><p>è®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/57N4yUrfoS1cBWd.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="long-short-time-memory-networks">Long Short Time Memory Networks</h3><h4 id="vanilla-recurrent-neural-networks">Vanilla Recurrent Neural Networks</h4><p>æ™®é€šçš„ç¥ç»ç½‘ç»œï¼š</p><p><img src="https://i.loli.net/2020/06/25/U5rxdYR4jKoqQOX.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><p>æ¦‚æ‹¬çš„æ¥è®²ï¼Œå¯ä»¥æ¶µç›–ä¸ºä¸€ä¸ªå…¬å¼<span class="math inline">\(\hat{\mathbf{y}}=f(\mathbf{x})\)</span>ã€‚å¯¹äºä¸€ä¸ªæ ·æœ¬<span class="math inline">\(\mathbf{x}\)</span>ï¼Œé€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œæ˜ å°„ï¼Œè¾“å‡º<span class="math inline">\(\mathbf{y}\)</span>ã€‚</p><p>å¯¹äºRNNï¼Œæˆ‘ä»¬å¤„ç†çš„æ˜¯åºåˆ—æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰æ ·æœ¬ä¹‹é—´å¹¶ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚å¯¹äºä¸€ä¸ªåºåˆ—ä¸­çš„ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x_t\in\{x_1,x_2,\cdots,x_n\}\)</span>ï¼Œå°†å…¶è¾“å…¥åˆ°ç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œä¸ºäº†å»ºæ¨¡<span class="math inline">\(x_t\)</span>ä¹‹å‰çš„å­åºåˆ—å¯¹<span class="math inline">\(x_t\)</span>çš„å½±å“å…³ç³»ï¼Œéœ€è¦å°†è¿™ä¸ªå­åºåˆ—çš„ä¿¡æ¯ä¹Ÿè¾“å…¥åˆ°ç¥ç»ç½‘ç»œä¸­ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿä¸ºæ¯ä¸€ä¸ªæ ·æœ¬ç‚¹ä¿å­˜ä¸€ä¸ªStateã€‚å³å®šä¹‰<span class="math inline">\(h_t=g(\hat{y_t})=g(f(x_t))\)</span>ï¼Œå¯¹äºå½“å‰æ ·æœ¬ç‚¹ï¼Œ<span class="math inline">\(\hat{y_t}=f(x_t,h_{t-1})\)</span>ã€‚ä¹Ÿå°±æ˜¯è¯´ç¥ç»ç½‘ç»œçš„è¾“å…¥ä¸ä»…åŒ…å«äº†å½“å‰æ ·æœ¬ç‚¹çš„ç‰¹å¾ï¼Œä¹ŸåŒ…å«äº†ä¸Šä¸€ä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€(ä¸Šä¸€ä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€åˆéšå«äº†ä¸Šä¸Šä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€...)ï¼Œå°±åƒæ˜¯ä¸ºç½‘ç»œåŠ ä¸Šäº†çŸ­æœŸè®°å¿†ã€‚</p><p><img src="https://i.loli.net/2020/06/25/cxBk6SQTydsOVYt.png" srcset="/img/loading.gif" style="zoom: 67%;" /></p><p><img src="https://i.loli.net/2020/06/25/ODKWYBI83tJXurM.png" srcset="/img/loading.gif" style="zoom: 33%;" /></p><p><img src="https://i.loli.net/2020/06/25/jq1LAytRKCub3kX.png" srcset="/img/loading.gif" style="zoom:33%;" /></p><h4 id="gradient-flow-of-vanilla-rnn">Gradient Flow of Vanilla RNN</h4><p>ä¸‹é¢æ¥è¿›è¡Œä¸€äº›å½¢å¼åŒ–çš„å®šä¹‰ï¼Œå‡è®¾åœ¨æ—¶åˆ»<span class="math inline">\(t\)</span>ç½‘ç»œè¾“å…¥ç‰¹å¾ä¸º<span class="math inline">\(x_t\)</span>ï¼Œè¾“å‡ºéšå«çŠ¶æ€ä¸º<span class="math inline">\(h_{t}\)</span>ï¼Œå…¶ä¸ä»…å’Œå½“å‰è¾“å…¥<span class="math inline">\(x_t\)</span>æœ‰å…³ï¼Œè¿˜å’Œä¸Šä¸€ä¸ªéšå«çŠ¶æ€<span class="math inline">\(h_{t-1}\)</span>æœ‰å…³ï¼š</p><ul><li>å½“å‰æ—¶åˆ»æ€»çš„å‡€è¾“å…¥<span class="math inline">\(z_t=Uh_{t-1}+Wx_t+b\)</span></li><li>å½“å‰æ—¶åˆ»è¾“å‡ºéšå«çŠ¶æ€<span class="math inline">\(h_t=f(z_t)\)</span></li><li>å½“å‰æ—¶åˆ»è¾“å‡º<span class="math inline">\(\hat{y}_t=Vh_t\)</span></li></ul><p>RNNçš„æ¢¯åº¦æ›´æ–°å…¬å¼(æ¨å¯¼è¿‡ç¨‹æ¯”è¾ƒå¤æ‚)ï¼š</p><p><span class="math display">\[\frac{\partial{\mathcal{L}}}{\partial U}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t \delta_{t,k}\mathbf{h}_{k-1}^T\]</span></p><p><span class="math display">\[\frac{\partial{\mathcal{L}}}{\partial{W}}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t \delta_{t,k}x_k^T\]</span></p><p><span class="math display">\[\frac{\partial\mathcal{L}}{\partial{b}}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t\delta_{t,k}\]</span></p><p>å…¶ä¸­<span class="math inline">\(\delta_{t,k}=\frac{\partial{\mathcal{L}}}{\partial{z_k}}=\text{diag}(f^\prime(z_k))U^T\delta_{t,k+1}\)</span>å®šä¹‰ä¸ºç¬¬<span class="math inline">\(t\)</span>æ—¶åˆ»çš„æŸå¤±å¯¹ç¬¬<span class="math inline">\(k\)</span>æ—¶åˆ»éšè—ç¥ç»å±‚çš„å‡€è¾“å…¥<span class="math inline">\(z_k\)</span>çš„å¯¼æ•°ï¼Œä¸”<span class="math inline">\(z_k=Uh_{k-1}+Wx_k+b,1\leq k&lt;t\)</span>ã€‚</p><p>RNNçš„æ¢¯åº¦æµå‘å¦‚ä¸‹å›¾çº¢ç®­å¤´æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/F5xvo9kCiNl8ehZ.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><p>RNNä¼šé‡åˆ°æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚æ ¹æ®å‰é¢çš„å…¬å¼ï¼Œ<span class="math inline">\(\delta_{t,k}\)</span>å®é™…ä¸Šæ˜¯é€’å½’å®šä¹‰çš„ï¼Œå±•å¼€å¾—åˆ°ï¼š</p><p><span class="math display">\[\delta_{t,k}=\prod\limits_{\tau=k}^{t-1}(\text{diag}(f^\prime(z_\tau))U^T)\delta_{t,t}\]</span></p><p>å¦‚æœå®šä¹‰<span class="math inline">\(\gamma\cong\parallel\text{diag}(f^\prime(z_\tau))U^T\parallel\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(\delta_{t,k}\cong\gamma^{t-k}\delta_{t,t}\)</span>ã€‚åœ¨<span class="math inline">\(t-k\)</span>å¾ˆå¤§æ—¶ï¼Œ<span class="math inline">\(\gamma&lt;1\)</span>ä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼Œ<span class="math inline">\(\gamma&gt;1\)</span>æ—¶ä¼šå¯¼è‡´æ¢¯åº¦çˆ†ç‚¸ã€‚</p><p><img src="https://i.loli.net/2020/06/25/RGW4oVtQ7KEFUCA.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><p><img src="https://i.loli.net/2020/06/25/i4O9kJQpnZ5GYeq.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><h4 id="long-short-time-memory">Long Short Time Memory</h4><p>LSTMæ˜¯ä¸€ç§è§£å†³RNNæ¢¯åº¦æ¶ˆå¤±é—®é¢˜çš„æ”¹è¿›ç‰ˆæœ¬ï¼š</p><p><img src="https://i.loli.net/2020/06/25/B4NXzb6fSdgGowL.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><p>åœ¨LSTMä¸­ï¼Œç»´æŠ¤äº†ä¸¤ä¸ªStateï¼Œ<span class="math inline">\(c_t\)</span>å’Œ<span class="math inline">\(h_t\)</span>ã€‚å…¶ä¸­<span class="math inline">\(c_t\)</span>ç”±é—å¿˜é—¨<span class="math inline">\(f\)</span>ä¸ä¸Šä¸€ä¸ª<span class="math inline">\(c_{t-1}\)</span>ç›¸ä¹˜(ä»£è¡¨ç»§æ‰¿ä¸Šä¸€ä¸ªCellçš„ä¿¡æ¯å¹¶åŠ ä»¥ä¸€å®šç¨‹åº¦çš„é—å¿˜)ï¼ŒåŠ ä¸Šè¾“å‡ºé—¨<span class="math inline">\(i\)</span>ä¸Gate Gate <span class="math inline">\(g\)</span>ç›¸ä¹˜(Gate Gateä»£è¡¨å½“å‰çš„å€™é€‰çŠ¶æ€ï¼Œè¾“å‡ºé—¨<span class="math inline">\(i\)</span>æ§åˆ¶å½“å‰å€™é€‰çŠ¶æ€æœ‰å¤šå°‘ä¿¡æ¯éœ€è¦ä¿å­˜)ã€‚æœ€åï¼Œè¾“å‡ºé—¨<span class="math inline">\(o\)</span>æ§åˆ¶å½“å‰æ—¶åˆ»çš„Cell State <span class="math inline">\(c_t\)</span>æœ‰å¤šå°‘ä¿¡æ¯éœ€è¦è¾“å‡ºç»™å¤–éƒ¨çŠ¶æ€<span class="math inline">\(h_t\)</span>ã€‚</p><p>ä¸‰ä¸ªé—¨çš„è®¡ç®—æ–¹å¼ä¸ºï¼š</p><p><span class="math display">\[i_t=\sigma(W_ix_t+U_ih_{t-1}+b_i)\]</span></p><p><span class="math display">\[f_t=\sigma(W_fx_t+U_fh_{t-1}+b_f)\]</span></p><p><span class="math display">\[o_t=\sigma(W_ox_t+U_oh_{t-1}+b_o)\]</span></p><p><img src="https://i.loli.net/2020/06/25/PXQMb9vih1yEKrf.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><p><img src="https://i.loli.net/2020/06/25/1zZQqlI6r9Yjp47.png" srcset="/img/loading.gif" style="zoom:50%;" /></p><h2 id="methodology">Methodology</h2><p>æ€»ä½“æ¡†æ¶å›¾å¦‚Fig 1æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/scEA9Ou1Yi7nThG.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><h3 id="gan-with-lstm-rnn">GAN with LSTM-RNN</h3><p>ç½‘ç»œç»“æ„ä¸Šç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨éƒ½æ˜¯LSTMï¼Œä¼˜åŒ–å‡½æ•°å’Œæ™®é€šGANä¸€æ ·ï¼š</p><p><span class="math display">\[\min\limits_G\max\limits_D V(D,G)=\mathbb{E}_{x\sim p_{data}(x)}[\log D(x)]+\mathbb{E}_{z\sim p_z(z)}[\log (1-D(G(z)))]\]</span></p><h3 id="gan-based-anomaly-score">GAN-based Anomaly Score</h3><p>åœ¨æµ‹è¯•é˜¶æ®µï¼Œéœ€è¦ä½¿ç”¨æ¢¯åº¦ä¼˜åŒ–å¯»æ‰¾ä¸€ä¸ªä½¿å¾—<span class="math inline">\(G_{rnn}(z)\)</span>æœ€æ¥è¿‘<span class="math inline">\(X^{test}\)</span>çš„<span class="math inline">\(z^k\)</span>ï¼š</p><p><span class="math display">\[\min\limits_{Z^k}Error(X^{test},G_{rnn}(Z^k))=1-Similarity(X^{test},G_{rnn}(Z^k))\]</span></p><p>æœ¬æ–‡å®šä¹‰äº†ä¸¤ç§Anomaly Scoreï¼Œä¸€ç§æ˜¯Residual Lossï¼š</p><p><span class="math display">\[Res(X^{test}_t)=\sum\limits_{i=1}^n|x^{test,i}_t-G_{rnn}(Z^{k,i}_t)|\]</span></p><p>ä¸€ç§æ˜¯Discrimination Lossï¼Œå³åˆ¤åˆ«å™¨çš„è¾“å‡º<span class="math inline">\(D_{rnn}(x_t^{test})\)</span>ã€‚</p><p>æ€»çš„Anomaly Scoreï¼š</p><p><span class="math display">\[S^{test}_t=\lambda Res(X^{test}_t)+(1-\lambda)D_{rnn}(x^{test}_t)\]</span></p><h3 id="anomaly-detection-framework">Anomaly Detection Framework</h3><p>æ¨¡å‹çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/84ZCT1JOEru53Ue.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ç”±äºæœ¬æ–‡æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—é¢„æµ‹ï¼Œè€Œä¸”æ—¶é—´åºåˆ—çš„é•¿åº¦æœ‰å¯èƒ½æ¯”è¾ƒé•¿ï¼Œä½œè€…ä½¿ç”¨äº†æ»‘åŠ¨çª—å£å’ŒPCAæ¥è¿›è¡Œé¢„å¤„ç†ã€‚</p><h2 id="experiments">Experiments</h2><p><img src="https://i.loli.net/2020/06/25/LGsiMw6IjYUtx8T.png" srcset="/img/loading.gif" style="zoom:67%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection</title>
    <link href="/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/"/>
    <url>/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡é’ˆå¯¹é¢å‘åŒºé—´çš„KPIå¼‚å¸¸æ£€æµ‹æå‡ºäº†Label Screeningæ–¹æ³•å’ŒRelearning Algorithm.</p><p><a href="https://www.sciencedirect.com/science/article/pii/S0957417419304282" target="_blank" rel="noopener">åŸæ–‡</a></p><h2 id="contribution">Contribution</h2><ol type="1"><li>æå‡ºäº†ä¸€ç§Label Screeningæ–¹æ³•æ¥å¯¹åŒºé—´å†…ä¸åŒé‡è¦æ€§è¿›è¡Œè¿‡æ»¤</li><li>æå‡ºäº†ä¸€ç§Relearning Algorithmæ¥å¯¹FPå’ŒTPè¿›è¡ŒRelearningï¼Œåœ¨ä¸å‡å°‘Recallçš„æ¡ä»¶ä¸‹å¢å¤§Precision</li></ol><h2 id="methodology">Methodology</h2><h3 id="overall-structure">Overall Structure</h3><p>ç®—æ³•çš„æ•´ä½“æ¡†æ¶å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/yGMWzdgTf43qImp.png" srcset="/img/loading.gif" /></p><h3 id="label-screening-model">Label Screening Model</h3><p>é¢„è®­ç»ƒçš„ç»“æœè¢«åˆ†ä¸º<span class="math inline">\(TP_{po},FP_{po},TN_{po},FN_{po}\)</span>å››ç±»ï¼Œ<span class="math inline">\(TP_{po}\)</span>å’Œ<span class="math inline">\(FN_{po}\)</span>å¯ä»¥è¢«ç»†åˆ†å¦‚ä¸‹ï¼š <span class="math display">\[\begin{align}TP_{po}&amp;=TP_{po,withinT}+TP_{po,afterT}\\&amp;=TP_{po,withinT}+TP_{po,afterT,tpl}+TP_{po,after,fnl}\end{align}\]</span></p><p><span class="math display">\[\begin{align}FN_{po}&amp;=FN_{po,withinT}+FN_{po,afterT}\\&amp;=FN_{po,withinT,tpl}+FN_{po,,withinT,fnl}+FN_{po,afterT,tpl}+FN_{po,afterT,fnl}\end{align}\]</span></p><p>å…¶ä¸­ä¸‹æ ‡<span class="math inline">\({}_{withinT}\)</span>ä»£è¡¨åœ¨å¼‚å¸¸ç‰‡æ®µç¬¬ä¸€ä¸ªç‚¹<span class="math inline">\(T\)</span>è·ç¦»å†…çš„æ‰€æœ‰ç‚¹ï¼Œä¸‹æ ‡<span class="math inline">\({}_{afterT}\)</span>ä»£è¡¨<span class="math inline">\(T\)</span>è·ç¦»ä¹‹åã€‚ä¸‹æ ‡<span class="math inline">\({}_{tpl}\)</span>å’Œ<span class="math inline">\({}_{fnl}\)</span>åˆ†åˆ«ä»£è¡¨åœ¨å¼‚å¸¸ç‰‡æ®µä¸­ï¼ŒåŒ…å«å’Œä¸åŒ…å«<span class="math inline">\(TP_{po,withinT}\)</span>çš„ç‚¹ã€‚</p><p>ä»¥TPä¸ºä¾‹ï¼ŒPoint-basedçš„TPåŒ…å«äº†åœ¨TèŒƒå›´ä¹‹å†…çš„ï¼ˆå³åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯TPçš„ç‚¹ï¼‰å’ŒTèŒƒå›´ä¹‹å¤–çš„ç‚¹ï¼ˆå³åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¸è®¤ä¸ºæ˜¯TPçš„ç‚¹ï¼‰ã€‚è€Œåœ¨TèŒƒå›´ä¹‹å¤–çš„ç‚¹åˆå¯ä»¥ç»†åˆ†ä¸ºè¯¥å¼‚å¸¸ç‰‡æ®µæ˜¯å¦åŒ…å«<span class="math inline">\(TP_{po,withinT}\)</span>çš„ç‚¹ï¼ˆå³è¯¥ç‚¹åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¸ä¼šè¢«åˆ¤å®šä¸ºTPï¼Œä½†è¯¥å¼‚å¸¸ç‰‡æ®µæœ‰å…¶ç‚¹ä¼šè¢«åˆ¤å®šä¸ºTPï¼‰ã€‚</p><p>ç±»ä¼¼çš„ï¼Œ<span class="math inline">\(TP_{io}\)</span>å’Œ<span class="math inline">\(FN_{io}\)</span>å¯ä»¥è¢«åˆ†è§£ä¸ºï¼š <span class="math display">\[\begin{align}TP_{io}&amp;=TP_{po,withinT}+TP_{po,afterT,tpl}+FN_{po,withinT,tpl}+FN_{po,afterT,tpl}\\&amp;=TP_{po}+FN_{po,withinT,tpl}+FN_{po,afterT,tpl}-TP_{po,afterT,fnl}\end{align}\]</span></p><p><span class="math display">\[\begin{align}FN_{io}&amp;=FN_{po,withinT,fnl}+FN_{po,afterT,fnl}+TP_{po,afterT,fnl}\\&amp;=FN_{po}+TP_{po,afterT,fnl}-FN_{po,withinT,tpl}-FN_{po,afterT,tpl}\end{align}\]</span></p><p>æ–‡ä¸­å¯¹è¯¥éƒ¨åˆ†çš„åˆ†æå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol type="1"><li>åœ¨Interval-orientedçš„æ ‡å‡†ä¸­ï¼Œ<span class="math inline">\(FN_{po,tpl}\)</span>çš„ç‚¹ä»ä¼šè¢«è®¤ä¸ºæ˜¯<span class="math inline">\(TP_{io}\)</span>ï¼Œè€Œ<span class="math inline">\(TP_{po,afterT}\)</span>ï¼ˆä¸å¸¦<span class="math inline">\({}_{tpl}\)</span>ï¼‰ä¸ä¼šè¢«è®¤ä¸ºæ˜¯<span class="math inline">\(TP_{io}\)</span>ï¼Œæ‰€ä»¥æœ€ç»ˆ<span class="math inline">\(TP_{io}\)</span>ç”±æ‰€æœ‰<span class="math inline">\(TP_{po}\)</span>åŠ ä¸Šé‚£äº›ä¼šè¢«è®¤ä¸ºæ˜¯<span class="math inline">\(TP_{io}\)</span>çš„<span class="math inline">\(FN_{po,tpl}\)</span>å†å»æ‰ä¸å¸¦<span class="math inline">\({}_{tpl}\)</span>çš„<span class="math inline">\(TP_{po,afterT}\)</span>ç»„æˆï¼Œå³å…¬å¼(6)</li><li>åŒæ—¶ï¼Œæ ¹æ®å…¬å¼(6)ï¼Œå¦‚æœ<span class="math inline">\(TP_{po}\)</span>å˜ä¸º<span class="math inline">\(FN_{po,tpl}\)</span>ï¼Œä¹Ÿä¸ä¼šå¯¹æœ€ç»ˆç»“æœé€ æˆå½±å“ã€‚ä½†æ˜¯æ ¹æ®å…¬å¼(5)å’Œå…¬å¼(7)ï¼Œ<span class="math inline">\(TP_{po,withinT}\)</span>å˜æˆ<span class="math inline">\(FN_{po,withinT,fnl}\)</span>ä¼šå‡å°<span class="math inline">\(TP_{io}\)</span>åŒæ—¶å¢å¤§<span class="math inline">\(FN_{io}\)</span></li><li>æ–‡ç« æŒ‡å‡ºï¼Œè™½ç„¶<span class="math inline">\(FN_{po,withinT,tpl}\)</span>å’Œ<span class="math inline">\(FN_{po,afterT,tpl}\)</span>æœ€åéƒ½ä¼šè¢«è®¤ä¸ºæ˜¯<span class="math inline">\(TP_{io}\)</span>ï¼Œä½†ä½œè€…å‡è®¾<span class="math inline">\(FN_{po,withinT,tpl}\)</span>æ›´éš¾æ£€æµ‹ï¼Œæ‰€ä»¥åº”è¯¥ä¿ç•™ï¼Œè€Œ<span class="math inline">\(FN_{po,afterT,tpl}\)</span>åº”è¯¥å‰Šå‡</li><li>Label Screeningæ–¹æ³•å»é™¤äº†<span class="math inline">\(FN_{po,afterT}\)</span>çš„ç‚¹</li><li>Screenedä¹‹åçš„è®­ç»ƒé›†è¢«ç”¨æ¥è®­ç»ƒDNNä¸»æ¨¡å‹ï¼Œä½†Label Screeningçš„é¢„æµ‹ç»“æœä¹Ÿä¼šè¢«ä¿ç•™ï¼Œå’ŒDNNä¸»æ¨¡å‹çš„ç»“æœè¿›è¡Œç»„åˆ</li></ol><p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/ZDT5fQNojsXm84q.png" srcset="/img/loading.gif" /></p><h3 id="relearning-algorithm">Relearning Algorithm</h3><p>Relearning Modelçš„è¾“å…¥æ˜¯DNNä¸»æ¨¡å‹é¢„æµ‹å‡ºæ¥çš„å¼‚å¸¸ï¼Œå…¶ä¸­åŒ…æ‹¬TPå’ŒFPã€‚Relearning Modelé‡‡ç”¨çš„æ˜¯éšæœºæ£®æ—ï¼Œå…¶è¾“å…¥çš„æ ·æœ¬é€šè¿‡é‡‡æ ·å¾—åˆ°ï¼š <span class="math display">\[\begin{align}\text{relearning}\space&amp;\text{training set}=\\&amp; shuffle\{4C\ast\text{randomof}(TP_{po})\\&amp;+C\cdot\text{randomof}(FP_{po})+C\cdot\text{randomof}(TN_{po})\}\end{align}\]</span> å…¶ä¸­<span class="math inline">\(C\)</span>ä¸ºå¸¸æ•°ã€‚TNå’ŒFPéƒ½çœ‹ä½œæ˜¯è´Ÿä¾‹(æ­£å¸¸æ ·æœ¬)ï¼ŒTPçœ‹ä½œæ˜¯æ­£ä¾‹ã€‚</p><p><img src="https://i.loli.net/2020/06/24/qgvINaFu9JLfM4j.png" srcset="/img/loading.gif" /></p><h3 id="detection">Detection</h3><p>å¯¹äºä¸€ä¸ªæ»‘åŠ¨çª—å£<span class="math inline">\(x_t=\{x_{t-w+1},\cdots,x_t\}\)</span>ï¼Œå¼‚å¸¸æ£€æµ‹ç®—æ³•çš„ç›®æ ‡æ˜¯è¾“å‡ºæ£€æµ‹ç»“æœ<span class="math inline">\(y_t\in\{0,1\}\)</span>æ¥è¡¨ç¤ºæ—¶é—´<span class="math inline">\(t\)</span>æ˜¯å¦å‘ç”Ÿå¼‚å¸¸ã€‚å®é™…ä¸Šç®—æ³•è¾“å‡ºçš„æ˜¯<span class="math inline">\(p_{y_t}\in[0,1]\)</span>æ¦‚ç‡å€¼æ¥è¡¨ç¤ºåœ¨æ—¶é—´<span class="math inline">\(t\)</span>å‘ç”Ÿå¼‚å¸¸çš„æ¦‚ç‡ã€‚æ–‡ä¸­ä¸‰ä¸ªæ¨¡å‹ä¼šå¾—åˆ°ä¸‰ä¸ªè¾“å‡ºï¼š<span class="math inline">\(y_{t,ls},y_{t,main},y_{t,re}\)</span>ã€‚æœ€ç»ˆç»“æœä¸ºï¼š <span class="math display">\[y_t=y_{t,ls}\space\&amp;\space y_{t,main}\space\&amp; \space y_{t,re}\]</span> åœ¨ç»˜åˆ¶PRæ›²çº¿æ—¶ï¼Œé‡‡ç”¨çš„å…¬å¼ä¸ºï¼š <span class="math display">\[\begin{align}p_{y_t}(th)=&amp;(1-sig(p_{y_t,ls},th))\cdot(p_{y_t,ls})\\&amp;+sig(p_{y_t,ls},th)\cdot(1-sig(p_{y_t,main},th))\cdot p_{y_t,main}\\&amp;+sig(p_{y_t,ls},th)\cdot sig(p_{y_t,main},th)\cdot p_{y_t,re}\\\end{align}\]</span></p><p><span class="math display">\[y_t(th)=sig(p_{y_t}(th),th)\]</span></p><p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/LBT59eugKEPymO8.png" srcset="/img/loading.gif" /></p><h2 id="experiments">Experiments</h2><h3 id="datasets">Datasets</h3><p>æ¸…åAIOpsæ•°æ®é›†ï¼Œé€‰å–äº†25æ¡KPIã€‚</p><h3 id="preprocessing">Preprocessing</h3><ol type="1"><li><strong>Missing Data.</strong> å»é™¤ã€‚</li><li><strong>Standardization.</strong> Minmax Standardizationï¼ŒFeature Extractionä½¿ç”¨çš„æ˜¯Standardizationåçš„æ•°æ®ã€‚</li><li><strong>Feature Extraction.</strong> ä½¿ç”¨äº†12ç§ç‰¹å¾ã€‚</li></ol><table><thead><tr class="header"><th>Group</th><th>Feature Name</th></tr></thead><tbody><tr class="odd"><td>Values</td><td>The original values standardized</td></tr><tr class="even"><td>Statistical Features</td><td>Mean, Standard Deviation, Range, Difference...</td></tr><tr class="odd"><td>Fitting Features</td><td>EWMA, AR</td></tr><tr class="even"><td>Wavelet Features</td><td>Db2 wavelet decomposition</td></tr></tbody></table><h2 id="results">Results</h2><h3 id="aucpr">AUCPR</h3><p><img src="https://i.loli.net/2020/06/24/LAqNMW1zvs8eP7X.png" srcset="/img/loading.gif" /></p><p><img src="https://i.loli.net/2020/06/24/YgRwavDIn7izLPX.png" srcset="/img/loading.gif" /></p><h3 id="f1">F1</h3><p><img src="https://i.loli.net/2020/06/24/FM3BUhQXtpo7aiu.png" srcset="/img/loading.gif" /></p><h2 id="remark">Remark</h2><ol type="1"><li>è¿™ç¯‡æ–‡ç« çš„Label Screeningæ–¹æ³•å®é™…ä¸Šæ˜¯åœ¨å¤„ç†æ ·æœ¬åˆ†ç±»éš¾æ˜“åº¦çš„é—®é¢˜ï¼Œå°†å¼‚å¸¸åŒºé—´å†…å®¹æ˜“çš„æ ·æœ¬å»é™¤äº†</li><li>å¯¹äºæ—¶é—´åºåˆ—çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¸€èˆ¬æ˜¯Point-basedçš„å¼‚å¸¸æ ‡ç­¾ï¼Œä¸€ä¸ªæ—¶é—´ç‚¹çš„ç‰¹å¾æ˜¯æœ‰é™çš„ã€‚å¦‚æœç”¨çª—å£çš„æ–¹å¼ï¼Œä»¥<span class="math inline">\(\{x_{t-w+1},\cdots,x_t\}\)</span>ä½œä¸ºæ—¶é—´<span class="math inline">\(t\)</span>çš„è¾“å…¥ï¼ˆå½“ç„¶æ¯ä¸ª<span class="math inline">\(x_t\)</span>å¯ä»¥æœ‰å¤šä¸ªChannelï¼‰ï¼Œç„¶åæŠŠé¢„æµ‹ç»“æœä½œä¸ºæ—¶é—´<span class="math inline">\(t\)</span>çš„è¾“å‡º</li></ol>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Unsupervised Anomaly Detection via Variational Auto-Encoder for Seasonal KPIs in Web Applications</title>
    <link href="/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/"/>
    <url>/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/</url>
    
    <content type="html"><![CDATA[<h2 id="abstract">Abstract</h2><p>æœ¬æ–‡æå‡ºäº†Donutï¼Œä¸€ä¸ªåŸºäºVAEçš„æ— ç›‘ç£æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿã€‚</p><p><a href="https://dl.acm.org/citation.cfm?id=3185996" target="_blank" rel="noopener">åŸæ–‡</a></p><p><img src="https://i.loli.net/2020/06/25/aoNWpGDLmJzwXOj.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="contribution">Contribution</h2><ol type="1"><li>Donutä¸­ä½¿ç”¨åˆ°äº†ä¸‰ä¸ªæŠ€å·§ï¼ŒåŒ…æ‹¬æ”¹è¿›åçš„ELBOã€ç¼ºå¤±æ•°æ®æ³¨å…¥å’ŒMCMCæ’å€¼ï¼›</li><li>æå‡ºåŸºäºVAEçš„å¼‚å¸¸æ£€æµ‹è®­ç»ƒæ—¢éœ€è¦æ­£å¸¸æ ·æœ¬ä¹Ÿéœ€è¦å¼‚å¸¸æ ·æœ¬ï¼›</li><li>å¯¹Donutæå‡ºäº†åœ¨z-ç©ºé—´ä¸­åŸºäºKDEçš„ç†è®ºè§£é‡Šã€‚</li></ol><h2 id="background">Background</h2><h3 id="anomaly-detection">Anomaly Detection</h3><p>å¯¹äºä»»æ„æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼<span class="math inline">\(x_{t-T+1},\cdots,x_t\)</span>ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º<span class="math inline">\(y_t=1\)</span>)ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚<span class="math inline">\(p(y_t=1|x_{t-T+1},\cdots,x_t)\)</span>ã€‚</p><h2 id="methodology">Methodology</h2><h3 id="problem-statement">Problem Statement</h3><p>æœ¬æ–‡çš„ç›®çš„æ˜¯<strong>åŸºäºæ·±åº¦ç”Ÿæˆç½‘ç»œå¼€å‘å…·æœ‰ç†è®ºè§£é‡Šæ€§çš„æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œå¹¶ä¸”åœ¨æœ‰æ ‡ç­¾çš„æƒ…å†µä¸‹èƒ½åˆ©ç”¨æ ‡ç­¾ä¿¡æ¯æå‡æ€§èƒ½</strong>ã€‚æœ¬æ–‡åŸºäºVAEæ¥æ„å»ºæ¨¡å‹ã€‚</p><p><img src="https://i.loli.net/2020/06/25/PoKJmnIpEqNdtCe.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="network-structure">Network Structure</h3><p>ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/DFP1boZNzdVG9pH.png" srcset="/img/loading.gif" style="zoom: 80%;" /></p><p>ä¸€å…±åŒ…å«äº†é¢„å¤„ç†ã€è®­ç»ƒå’Œæ£€æµ‹ä¸‰ä¸ªéƒ¨åˆ†ã€‚</p><p>ä¸‹å›¾ä¸ºæ¨¡å‹çš„æ¦‚ç‡å›¾æ¨¡å‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/HlDXkSeFOruVbac.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>å›¾ä¸­åŒå®çº¿çš„æ¡†ä¸ºæœ¬æ–‡æ¨¡å‹æœ‰åˆ«äºä¼ ç»ŸVAEçš„åœ°æ–¹ï¼Œå…¶ä½™åœ°æ–¹å’ŒVAEä¸€æ ·ã€‚å…ˆéªŒæ¦‚ç‡<span class="math inline">\(p_\theta(z)\)</span>é€‰ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(0,I)\)</span>ï¼ŒåéªŒæ¦‚ç‡<span class="math inline">\(x\)</span>å’Œ<span class="math inline">\(z\)</span>éƒ½æ˜¯å¯¹è§’åŒ–é«˜æ–¯åˆ†å¸ƒï¼Œå³<span class="math inline">\(p_\theta(x|z)=\mathcal{N}(\mu_x,\sigma_x^2 I),q_\phi(z|x)=\mathcal{N}(\mu_z,\sigma_z^2 I)\)</span>ã€‚å¦‚Figure 4æ‰€ç¤ºï¼Œæ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œä¸­åˆ†åˆ«éƒ½æœ‰éšå«å±‚<span class="math inline">\(f_\phi(x)\)</span>å’Œ<span class="math inline">\(f_\theta(z)\)</span>å¯¹ç½‘ç»œçš„è¾“å…¥è¿›è¡Œç‰¹å¾æŠ½å–ã€‚é«˜æ–¯åˆ†å¸ƒçš„å‚æ•°å³ä»è¿™äº›æŠ½å–å‡ºæ¥çš„ç‰¹å¾ä¸Šå¾—åˆ°ã€‚å‡å€¼é€šè¿‡çº¿æ€§å±‚å¾—åˆ°ï¼š<span class="math inline">\(\mu_x=W^T_{\mu_x}f_\theta(z)+b_{\mu_x}, \mu_z=W^T_{\mu_z}f_\theta(x)+b_{\mu_z}\)</span>ã€‚æ ‡å‡†å·®é€šè¿‡Soft Pluså±‚åŠ ä¸€ä¸ªé«˜æ–¯å™ªå£°å¾—åˆ°ï¼š<span class="math inline">\(\sigma_x=\text{SoftPlus}[W^T_{\sigma_x}f_\theta(z)+b_{\sigma_x}]+\varepsilonï¼Œ\sigma_x=\text{SoftPlus}[W^T_{\sigma_z}f_\theta(x)+b_{\sigma_z}]+\varepsilon\)</span>ã€‚</p><p>æ–‡ä¸­æåˆ°å› ä¸ºKPIçš„å±€éƒ¨æ–¹å·®éå¸¸å°ï¼Œæ‰€ä»¥é‡‡ç”¨ç›´æ¥å»ºæ¨¡<span class="math inline">\(\sigma_x,\sigma_z\)</span>çš„æ–¹å¼è€Œä¸æ˜¯é‡‡ç”¨å¯¹æ•°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸ºäº†ç†è®ºä¸Šçš„è§£é‡Šæ€§ï¼Œæ–‡ä¸­çš„ç¥ç»ç½‘ç»œåªä½¿ç”¨äº†å…¨è¿æ¥å±‚ã€‚</p><h3 id="training">Training</h3><p>è®­ç»ƒå¯ä»¥ç›´æ¥é‡‡ç”¨ç»å…¸çš„SGVBæ¥ä¼˜åŒ–ELBOï¼š <span class="math display">\[\begin{align}\log p_\theta(x)&amp;\geq\log p_\theta(x)-\text{KL}[q_\phi(z|x)\parallel p_\theta(z|x)]\\&amp;=\mathcal{L}\\&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x)+\log p_\theta(z|x)-\log q_\phi(z|x)]\\&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x,z)-\log q_\phi(z|x)]\\&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)+\log p_\theta(z)-\log q_\phi(z|x)]\end{align}\]</span> ä½†æ˜¯åœ¨å®é™…çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè®­ç»ƒæ•°æ®éœ€è¦ä¿è¯éƒ½æ˜¯æ­£å¸¸æ ·æœ¬ï¼Œä½†å®é™…ä¸Šè®­ç»ƒæ ·æœ¬æœ‰å¯èƒ½ä¼šåŒ…å«å¼‚å¸¸æˆ–è€…æ˜¯ç¼ºå¤±å€¼ã€‚ä¸€ç§åšæ³•æ˜¯ç”¨ç¼ºå¤±å€¼å¡«å……çš„ç®—æ³•æ¥å¡«å……è¿™äº›å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼ï¼Œä½†ä½œè€…è®¤ä¸ºä½¿ç”¨ç¼ºå¤±å€¼å¡«å……ç®—æ³•å¹¶ä¸èƒ½å¾ˆå¥½çš„è¿˜åŸæ•°æ®çš„æ­£å¸¸æ¨¡å¼ï¼Œä»è€Œä¿è¯ç®—æ³•çš„æœ‰æ•ˆæ€§ã€‚åœ¨æ–‡ä¸­ä½œè€…é‡‡ç”¨äº†ä¿®æ”¹ELBOçš„æ–¹æ³•ï¼Œå¹¶å°†å…¶ç§°ä¹‹ä¸º<strong>Modified ELBO (M-ELBO)</strong>ï¼Œå…¬å¼å¦‚ä¸‹ï¼š <span class="math display">\[\tilde{\mathcal{L}}=\mathbb{E}_{q_\phi(z|x)}[\sum\limits_{w=1}^W{\alpha_w\log p_\theta(x_w|z)+\beta\log p_\theta(z)-\log q_\phi(z|x)}]\]</span> å…¶ä¸­<span class="math inline">\(\alpha_w\)</span>ä¸ºæŒ‡ç¤ºæ ‡è®°ï¼Œ<span class="math inline">\(\alpha_w=1\)</span>ä»£è¡¨ä¸æ˜¯å¼‚å¸¸ä¹Ÿä¸æ˜¯ç¼ºå¤±ã€‚<span class="math inline">\(\beta\)</span>å®šä¹‰ä¸º<span class="math inline">\(\beta=\frac{\sum_{w=1}^W\alpha_w}{W}\)</span>ã€‚</p><p>åœ¨<strong>M-ELBO</strong>ä¸­ï¼Œå¼‚å¸¸æˆ–ç¼ºå¤±å€¼å¯¹åº”çš„<span class="math inline">\(\log p_\theta(x_w|z)\)</span>çš„è´¡çŒ®ä¼šè¢«æ’é™¤ï¼ŒåŒæ—¶<span class="math inline">\(\log p_\theta(z)\)</span>åœ¨ä¹˜ä»¥<span class="math inline">\(\beta\)</span>åä¼šç›¸åº”ç¼©å°ã€‚ä½œè€…æ²¡æœ‰ä¿®æ”¹<span class="math inline">\(\log q_\phi(z|x)\)</span>è¿™ä¸€é¡¹çš„åŸå› æœ‰äºŒï¼šä¸€æ˜¯<span class="math inline">\(q_\phi(z|x)\)</span>ä»…ä»…æ˜¯ä»<span class="math inline">\(x\)</span>åˆ°<span class="math inline">\(z\)</span>çš„æ˜ å°„ï¼Œå¹¶ä¸éœ€è¦è€ƒè™‘â€œæ­£å¸¸æ¨¡å¼â€ï¼›äºŒæ˜¯<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[-\log q_\phi(z|x)]\)</span>å°±æ˜¯<span class="math inline">\(q_\phi(z|x)\)</span>çš„ç†µï¼Œè€Œè¿™ä¸ªåœ¨åé¢çš„ç†è®ºåˆ†æä¸­æœ‰ç‰¹åˆ«çš„å«ä¹‰ã€‚</p><p>é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ç§è§£å†³æ–¹æ³•å°±æ˜¯æŠŠæ‰€æœ‰åŒ…å«å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼çš„çª—å£å»é™¤ï¼Œè¿™ç§æ–¹æ³•çš„æ€§èƒ½åœ¨å®éªŒä¸­ä¼šè¿›è¡Œè®¨è®ºã€‚</p><p>åœ¨æ–‡ä¸­ä½œè€…è¿˜ä½¿ç”¨äº†ä¸€ç§<strong>Missing Data Injection</strong>æŠ€æœ¯ï¼Œå³åœ¨æ¯ä¸ªEpochéšæœºçš„æŒ‰ç…§ä¸€ä¸ªé¢„è®¾æ¯”ä¾‹<span class="math inline">\(\lambda\)</span>å°†æ­£å¸¸çš„æ•°æ®è®¾ä¸ºç¼ºå¤±ã€‚ä½œè€…è®¤ä¸ºè¿™æ ·æœ‰åŠ©äºæ€§èƒ½çš„æå‡ã€‚</p><h3 id="detection">Detection</h3><p>åœ¨æ£€æµ‹é˜¶æ®µï¼Œå¯¹äºä¸€ä¸ªè¾“å…¥æ ·æœ¬ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡å‹è¾“å‡ºå…¶å¼‚å¸¸çš„æ¦‚ç‡ã€‚å› ä¸ºæˆ‘ä»¬å»ºæ¨¡äº†<span class="math inline">\(p_\theta(x|z)\)</span>ï¼Œä¸€ç§æ–¹æ³•æ˜¯é‡‡æ ·è®¡ç®—<span class="math inline">\(p_\theta(x)=\mathbb{E}_{p_\theta(z)}[p_\theta(x|z)]\)</span>ï¼Œä½†è¿™ç§æ–¹æ³•è®¡ç®—ä»£ä»·ååˆ†æ˜‚è´µã€‚å…¶ä»–çš„ä¸€äº›æ–¹æ¡ˆæœ‰è®¡ç®—<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[p_\theta(x|z)]\)</span>æˆ–<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>ï¼Œå…¶ä¸­åè€…è¢«ç§°ä¸º"<strong>Reconstruction Probability</strong>"ï¼Œä½œè€…ä¾¿é‡‡ç”¨äº†è¿™ç§æ–¹æ¡ˆã€‚</p><p>åŒæ—¶ï¼Œä½œè€…è®¤ä¸ºè¾“å…¥çš„æ£€æµ‹æ ·æœ¬çš„ç¼ºå¤±å€¼ä¼šå¯¹ç»“æœé€ æˆè¾ƒå¤§åå·®ï¼Œäºæ˜¯ä½¿ç”¨äº†ä¸€ç§<strong>MCMC-based Missing Data Imputation</strong>çš„æ–¹æ³•æ¥å¯¹æ£€æµ‹æ ·æœ¬çš„ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ã€‚å…·ä½“åšæ³•æ˜¯å°†æµ‹è¯•æ ·æœ¬åˆ†ä¸ºå·²è§‚æµ‹å’Œç¼ºå¤±ä¸¤éƒ¨åˆ†<span class="math inline">\(x=(x_o,x_m)\)</span>ï¼Œç„¶åä½¿ç”¨è®­ç»ƒå¥½çš„VAEè¿›è¡Œé‡æ„å¾—åˆ°<span class="math inline">\((x^\prime_o,x^\prime_m)\)</span>ï¼Œç„¶åç”¨<span class="math inline">\(x^\prime_m\)</span>æ›¿æ¢<span class="math inline">\(x_m\)</span>ï¼Œè¿™æ ·ä¸æ–­å¾ªç¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/wEenLKz4URfm2FN.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä½œè€…ä½¿ç”¨äº†<span class="math inline">\(L\)</span>ä¸ªæ ·æœ¬æ¥è®¡ç®—<strong>Reconstruction Probability</strong>ï¼Œè™½ç„¶å¾—åˆ°çš„è¾“å‡ºæ˜¯é’ˆå¯¹æ•´ä¸ªçª—å£æ¯ä¸ªç‚¹çš„ï¼Œä½†ä½œè€…åªä½¿ç”¨æœ€åä¸€ä¸ªç‚¹ã€‚</p><h2 id="experiments">Experiments</h2><h3 id="datasets">Datasets</h3><p>ä½œè€…é€‰æ‹©äº†ä¸‰æ¡KPIä½œä¸ºæµ‹è¯•æ•°æ®ï¼Œåˆ†åˆ«è®°ä¸º<span class="math inline">\(\mathcal{A}\)</span>ï¼Œ<span class="math inline">\(\mathcal{B}\)</span>ï¼Œ<span class="math inline">\(\mathcal{C}\)</span>ï¼Œå…¶åŸºæœ¬æ•°æ®å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/A9qajrZtmhcvyHW.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="metrics">Metrics</h3><p>å› ä¸ºå¼‚å¸¸æ£€æµ‹ç±»åˆ«çš„æä¸å‡è¡¡æ€§ï¼Œä¼ ç»Ÿçš„æ€§èƒ½æŒ‡æ ‡å¹¶ä¸å¤ªåˆé€‚ï¼ˆå¼‚å¸¸æ ·æœ¬æå°‘ï¼Œä¸”å¼‚å¸¸ä¸€èˆ¬å‘ˆè¿ç»­çš„ç‰‡æ®µï¼‰ã€‚ä½œè€…è®¤ä¸ºåœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­è¿ç»´äººå‘˜éœ€è¦å°½é‡æ—©çš„è·çŸ¥å¼‚å¸¸çš„å‘ç”Ÿï¼Œäºæ˜¯æå‡ºäº†æ–°çš„è¯„æµ‹æœºåˆ¶ã€‚</p><p><img src="https://i.loli.net/2020/06/25/6LNwizqrWVe5sRv.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¬¬ä¸€è¡Œä¸ºçœŸå®çš„æ ‡ç­¾ï¼Œç¬¬äºŒè¡Œä¸ºé¢„æµ‹çš„å¼‚å¸¸æ¦‚ç‡ï¼Œç¬¬ä¸‰è¡Œä¸ºé¢„æµ‹çš„æ ‡ç­¾ã€‚ç¬¬ä¸€è¡Œä¸­å¼‚å¸¸ç‰‡æ®µè¢«åŠ ç²—è¡¨ç¤ºï¼Œå¯¹äºæ¯ä¸€ä¸ªå¼‚å¸¸ç‰‡æ®µçš„ç¬¬ä¸€ä¸ªä½ç½®<span class="math inline">\({y}_{t^\prime}\)</span>ï¼Œå¦‚æœé¢„æµ‹çš„æ ‡ç­¾ä¸­å­˜åœ¨<span class="math inline">\(\hat{y}_{t}\)</span>æ»¡è¶³<span class="math inline">\(t^\prime&lt;t\)</span>ä¸”<span class="math inline">\(|t-t^\prime|\)</span>å°äºç­‰äºé¢„è®¾çš„é˜ˆå€¼<span class="math inline">\(T\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(y_{t^\prime}\)</span>å¯¹åº”çš„æ•´æ®µå¼‚å¸¸éƒ½è¢«è®¤ä¸ºæ­£ç¡®æ£€æµ‹ï¼Œå¦åˆ™æ•´æ®µå¼‚å¸¸éƒ½è®¤ä¸ºæ²¡æœ‰è¢«æ­£ç¡®æ£€æµ‹ã€‚ç„¶ååœ¨æ­¤åŸºç¡€ä¸Šè®¡ç®—F1-scoreï¼ŒAUCç­‰æŒ‡æ ‡ä½œä¸ºè¯„æµ‹æ‰‹æ®µã€‚</p><h2 id="results">Results</h2><h3 id="overall-performance">Overall Performance</h3><p>ä¸‹å›¾å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š</p><p><img src="https://i.loli.net/2020/06/25/2j1Br45MUxTaYEX.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h3 id="effects-of-donut-techniques">Effects of Donut Techniques</h3><p>ä¸ºäº†æ¢ç©¶Donutä¸­æ‰€åšçš„å„ç§æ”¹è¿›çš„å®é™…ä½œç”¨ï¼Œä½œè€…åšäº†å¤§é‡å¯¹æ¯”å®éªŒï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/raHG6Phyxo1j82n.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><ul><li><strong>M-ELBO</strong> ä»å›¾ä¸­å¯ä»¥çœ‹å‡º<strong>M-ELBO</strong>å¯¹æ€§èƒ½æå‡æœ€å¤§ã€‚ä½œè€…åœ¨æ–‡ä¸­æåˆ°ä¸€å¼€å§‹å¹¶æ²¡æœŸæœ›<strong>M-ELBO</strong>èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ï¼Œåªæ˜¯å¸Œæœ›å®ƒèƒ½å¤ŸWorkã€‚è¿™è¡¨æ˜åœ¨VAEçš„è®­ç»ƒä¸­ï¼Œåªä½¿ç”¨æ­£å¸¸æ ·æœ¬æ˜¯ä¸å¤Ÿçš„ï¼Œä¹Ÿéœ€è¦åŠ å…¥éæ­£å¸¸çš„ä¿¡æ¯ï¼›</li><li><strong>Missing Data Injection</strong> è¯¥æŠ€å·§çš„ä¸»è¦ä½œç”¨æ˜¯å¢å¼º<strong>M-ELBO</strong>çš„æ•ˆæœã€‚ä»ç»“æœä¸Šæ¥çœ‹ä½œç”¨å¹¶ä¸æ˜¯ååˆ†çš„æ˜¾è‘—ï¼Œåªæ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹è·å¾—äº†å°‘é‡çš„æå‡ï¼›</li><li><strong>MCMC Imputation</strong> ä½œè€…è®¤ä¸ºè™½ç„¶è¯¥æŠ€å·§åªåœ¨ä¸€éƒ¨åˆ†æƒ…å†µä¸‹æ˜¾è‘—æå‡äº†æ€§èƒ½ï¼Œä½†æ€»ä½“æ¥è¯´å€¼å¾—ä½¿ç”¨ã€‚</li></ul><h3 id="impact-of-k">Impact of K</h3><p>è¯¥éƒ¨åˆ†ä½œè€…æ¢ç©¶äº†éšå˜é‡<span class="math inline">\(z\)</span>çš„ç»´åº¦<span class="math inline">\(K\)</span>å¯¹æ€§èƒ½çš„å½±å“ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2020/06/25/OXpIRoe4wr7YzuQ.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä»å›¾ä¸Šæ¥çœ‹ï¼Œå¯¹æ•°æ®é›†<span class="math inline">\(\mathcal{A}\)</span>ï¼Œ<span class="math inline">\(\mathcal{B}\)</span>ï¼Œ<span class="math inline">\(\mathcal{C}\)</span>æœ€ä½³çš„<span class="math inline">\(K\)</span>åˆ†åˆ«æ˜¯<span class="math inline">\(5\)</span>ï¼Œ<span class="math inline">\(4\)</span>å’Œ<span class="math inline">\(3\)</span>ï¼Œä½†æ˜¯è®¾å®šè¾ƒå¤§çš„<span class="math inline">\(K\)</span>å¹¶ä¸ä¼šå¯¹æ€§èƒ½æœ‰ä¸¥é‡çš„æŸå®³ã€‚ä½œè€…è¿˜å‘ç°å¯¹äºè¾ƒä¸ºå¹³æ»‘çš„KPIéœ€è¦è¾ƒå¤§çš„<span class="math inline">\(K\)</span>ã€‚</p><h2 id="analysis">Analysis</h2><h3 id="kde-interpretation">KDE Interpretation</h3><p>åœ¨è¿™ä¸€èŠ‚ä½œè€…å¯¹<strong>Reconstruction Probability</strong>çš„æ„ä¹‰è¿›è¡Œäº†æ·±å…¥çš„æ¢è®¨ã€‚é¦–å…ˆä½œè€…å¯¹<span class="math inline">\(q_\phi(z|x)\)</span>è¿›è¡Œäº†å¯è§†åŒ–ï¼Œåœ¨å›¾ä¸­ä½œè€…å°†æ—¶é—´ç»´åº¦ç”¨é¢œè‰²æ¥è¡¨ç¤ºã€‚å¦‚Figure 11(a) æ‰€ç¤ºï¼Œ<span class="math inline">\(z\)</span>å‡ ä¹æ˜¯æŒ‰ç…§<span class="math inline">\(x\)</span>å¯¹åº”çš„æ—¶é—´å‘ˆä¸€ä¸ªè¿ç»­çš„æµå½¢åˆ†å¸ƒï¼Œä½œè€…å°†è¿™ç§ç°è±¡ç§°ä¸º<strong>Time Gradient</strong>ã€‚å³ä½¿Donutæ²¡æœ‰æ˜¾å¼çš„ç”¨åˆ°æ—¶é—´ä¿¡æ¯ï¼Œä¸è¿‡å› ä¸ºå®éªŒç”¨åˆ°çš„æ•°æ®åŸºæœ¬æ˜¯å¹³æ»‘çš„ï¼Œæ‰€ä»¥è¯´ç›¸é‚»çš„<span class="math inline">\(x\)</span>ä¼šæ¯”è¾ƒç›¸ä¼¼ï¼Œå› æ­¤ç»è¿‡æ˜ å°„åçš„<span class="math inline">\(z\)</span>ä¹Ÿä¼šæ¯”è¾ƒç›¸ä¼¼ã€‚ä½œè€…æ®æ­¤æå‡ºDonutçš„ä¸€ä¸ªä¼˜åŠ¿ä¾¿æ˜¯å¯¹äºæ²¡æœ‰è§è¿‡çš„åéªŒåˆ†å¸ƒ<span class="math inline">\(q_\phi(z|x)\)</span>ï¼Œåªè¦å…¶ä½äºè®­ç»ƒè¿‡çš„ä¸¤ä¸ªåéªŒä¹‹é—´ï¼Œä¹Ÿä¼šäº§ç”Ÿåˆç†çš„åˆ†å¸ƒã€‚</p><p><img src="https://i.loli.net/2020/06/25/BHfP5DUZ48ALnma.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>å¯¹äºå¼‚å¸¸çš„æ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œå‡è®¾å…¶å¯¹åº”çš„æ­£å¸¸æ¨¡å¼ä¸º<span class="math inline">\(\tilde{x}\)</span>ï¼Œä½œè€…è®¤ä¸º<span class="math inline">\(q_\phi(z|x)\)</span>ä¼šåœ¨æŸç§ç¨‹åº¦ä¸Šå¯¹æ­£å¸¸çš„<span class="math inline">\(q_\phi(z|\tilde{x})\)</span>è¿›è¡Œè¿‘ä¼¼ã€‚å› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è¿›è¡Œè®­ç»ƒçš„ï¼Œéšå˜é‡<span class="math inline">\(z\)</span>çš„ç»´åº¦é€šå¸¸æ¥è¯´å°äºæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œè¿™å°±å¯¼è‡´<span class="math inline">\(z\)</span>åªä¼šä¿ç•™ä¸€éƒ¨åˆ†ä¸»è¦çš„ä¿¡æ¯ã€‚å¯¹äºå¼‚å¸¸æ ·æœ¬ï¼Œå…¶å¼‚å¸¸æ¨¡å¼åœ¨ç¼–ç æ—¶å°±è¢«ä¸¢æ‰äº†ã€‚ä½œè€…è¿˜æŒ‡å‡ºå¦‚æœ<span class="math inline">\(x\)</span>åŒ…å«çš„å¼‚å¸¸å¤ªå¤šï¼Œé‚£ä¹ˆæ¨¡å‹å°†éš¾ä»¥å¯¹<span class="math inline">\(x\)</span>è¿›è¡Œè¿˜åŸã€‚</p><p><img src="https://i.loli.net/2020/06/25/HcX78lUoG4meJq5.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><p>åŸºäºä¸Šè¿°è®¨è®ºï¼Œä½œè€…å¯¹ä½¿ç”¨<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>ä½œä¸º<strong>Reconstruction Probability</strong>çš„æ„ä¹‰è¿›è¡Œäº†é˜é‡Šã€‚è®¾è¾“å…¥æ ·æœ¬ä¸º<span class="math inline">\(x\)</span>ï¼Œå¦‚æœå…¶åŒ…å«å¼‚å¸¸ï¼Œå‡è®¾å…¶å¯¹åº”çš„æ­£å¸¸æ ·æœ¬ä¸º<span class="math inline">\(\tilde{x}\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(q_\phi(z|x)\)</span>éƒ¨åˆ†åœ°å’Œ<span class="math inline">\(q_\phi(z|\tilde{x})\)</span>ç›¸ä¼¼ã€‚å¦‚æœ<span class="math inline">\(x\)</span>å’Œ<span class="math inline">\(\tilde{x}\)</span>ç›¸ä¼¼ç¨‹åº¦é«˜ï¼Œé‚£ä¹ˆ<span class="math inline">\(\log p_\theta(x|z)\)</span>å°±ä¼šå¾ˆå¤§ï¼ˆå…¶ä¸­<span class="math inline">\(z\sim q_\phi(z|\tilde{x})\)</span>ï¼‰ã€‚<span class="math inline">\(\log p_\theta(x|z)\)</span>ç±»ä¼¼äºä¸€ä¸ªå¯†åº¦ä¼°è®¡å™¨ï¼Œä»£è¡¨<span class="math inline">\(x\)</span>åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸<span class="math inline">\(\tilde{x}\)</span>æ¥è¿‘ï¼Œ<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>ç›¸å½“äºå¯¹æ¯ä¸€ä¸ª<span class="math inline">\(z\)</span>å¯¹åº”çš„<span class="math inline">\(\log p_\theta(x|z)\)</span>ä¹˜ä»¥ä¸€ä¸ªæƒé‡<span class="math inline">\(q_\phi(z|x)\)</span>ç„¶åç›¸åŠ ã€‚äºæ˜¯ä½œè€…æå‡ºäº†<strong>Reconstruction Probability</strong>çš„<strong>KDE Interpretation</strong>:åœ¨Donutæ¨¡å‹ä¸­ï¼Œ<strong>Reconstruction Probability</strong> <span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>å¯ä»¥çœ‹ä½œæ˜¯ä»¥<span class="math inline">\(q_\phi(z|x)\)</span>ä¸ºæƒé‡ï¼Œ<span class="math inline">\(\log p_\theta(x|z)\)</span>ä¸ºæ ¸çš„æ ¸å¯†åº¦ä¼°è®¡ (Kernel Density Estimation)ã€‚</p><p>ä¸‰ç»´å¯è§†åŒ–å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/GeWufVlUDo4QtO6.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä½œè€…è¿˜å¯¹ç›´æ¥è®¡ç®—<span class="math inline">\(p_\theta(x)=\mathbb{E}_{p_\theta(z)}[p_\theta(x|z)]\)</span>è¿›è¡Œäº†è´¨ç–‘ï¼Œå› ä¸ºè¿™ç§æ–¹æ³•ç›´æ¥æ±‚<span class="math inline">\(x\)</span>çš„å…ˆéªŒï¼Œä»…ä»…è€ƒè™‘äº†<span class="math inline">\(x\)</span>çš„æ€»ä½“æ¨¡å¼ï¼Œè€Œå¿½ç•¥äº†<span class="math inline">\(x\)</span>çš„ä¸ªä½“æ¨¡å¼ã€‚</p><h3 id="find-good-posteriors-for-abnormal-x">Find Good Posteriors for Abnormal <span class="math inline">\(x\)</span></h3><p>é€šè¿‡ä¸Šé¢çš„è®¨è®ºæˆ‘ä»¬çŸ¥é“äº†Donuté€šè¿‡æ‰¾åˆ°<span class="math inline">\(x\)</span>çš„æ­£å¸¸åéªŒæ¥ä¼°è®¡<span class="math inline">\(x\)</span>åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸<span class="math inline">\(\tilde{x}\)</span>ç›¸ä¼¼ï¼Œåœ¨è¿™ä¸€èŠ‚ä½œè€…è®¨è®ºäº†æ–‡ä¸­ä½¿ç”¨çš„ä¸åŒæŠ€å·§å¯¹æ‰¾åˆ°<span class="math inline">\(x\)</span>çš„åéªŒçš„ä½œç”¨ã€‚å¯¹äº<strong>Missing Data Injection</strong>ä½œè€…è®¤ä¸ºè¯¥æŠ€å·§å¢å¼ºäº†<strong>M-ELBO</strong>çš„æ•ˆæœã€‚å¯¹äº<strong>MCMC Imputation</strong>ï¼Œä½œè€…è®¤ä¸ºè¯¥æŠ€å·§ä¸»è¦æ˜¯åœ¨æ£€æµ‹é˜¶æ®µé€šè¿‡ä¸æ–­è¿­ä»£æä¾›äº†æ›´å¥½çš„åéªŒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/8puDRylqZfQkcN6.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ä½œè€…è®¤ä¸ºï¼Œè™½ç„¶å¯¹äºåŒ…å«å¤§é‡å¼‚å¸¸çš„æ ·æœ¬ï¼ŒDonutä¸èƒ½å¾ˆå¥½çš„è¿˜åŸï¼Œä½†åœ¨è¿ç»´åœºæ™¯ä¸­ï¼Œåªè¦å¯¹å¤§æ®µå¼‚å¸¸çš„å¼€å§‹é˜¶æ®µè¿›è¡Œå‡†ç¡®é¢„æµ‹å³å¯ã€‚</p><h3 id="causes-of-time-gradient">Causes of Time Gradient</h3><p>åœ¨è¿™ä¸€èŠ‚ä½œè€…è®¨è®ºäº†<strong>Time Gradient</strong>å‡ºç°çš„åŸå› ã€‚é¦–å…ˆå‡è®¾<span class="math inline">\(x\)</span>éƒ½æ˜¯æ­£å¸¸ç‚¹ï¼Œè¿™æ—¶<span class="math inline">\(x\)</span>çš„ELBOä¸ºï¼š <span class="math display">\[\begin{align}\mathcal{L}(x)&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)+\log p_\theta(z)-\log q_\phi(z|x)]\\&amp;=\mathbb{E}[\log p_\theta(x|z)]+\mathbb{E}[\log p_\theta(z)]+\text{H}[z|x]\end{align}\]</span> ç¬¬ä¸€é¡¹è¡¨æ˜åœ¨<span class="math inline">\(z\sim q_\phi(z|x)\)</span>ä¸‹å°½å¯èƒ½é‡æ„<span class="math inline">\(x\)</span>ã€‚ç¬¬äºŒé¡¹è¡¨æ˜<span class="math inline">\(q_\phi(z|x)\)</span>å°½é‡ä¸<span class="math inline">\(z\)</span>çš„å…ˆéªŒ<span class="math inline">\(\mathcal{N}(0,I)\)</span>æ¥è¿‘ã€‚ç¬¬ä¸‰é¡¹ä¸º<span class="math inline">\(q_\phi(z|x)\)</span>çš„ç†µï¼Œè¡¨æ˜<span class="math inline">\(q_\phi(z|x)\)</span>åº”å°½é‡åˆ†æ•£ã€‚ç„¶è€Œç¬¬äºŒé¡¹åˆé™åˆ¶äº†è¿™ç§åˆ†æ•£çš„åŒºåŸŸï¼Œå¦‚ Figure 11(c) æ‰€ç¤ºã€‚åŒæ—¶è€ƒè™‘è¿™ä¸‰é¡¹çš„è¯ï¼Œç¬¬ä¸€é¡¹ä½¿å¾—<span class="math inline">\(z\)</span>ä¸èƒ½è‡ªç”±åœ°åˆ†æ•£ï¼Œå¯¹äºä¸ç›¸ä¼¼çš„<span class="math inline">\(x\)</span>å…¶å¯¹åº”çš„<span class="math inline">\(z\)</span>ä¹Ÿæ˜¯ä¸ç›¸ä¼¼çš„ï¼Œå› ä¸ºè¦æœ€å¤§åŒ–<span class="math inline">\(x\)</span>çš„é‡æ„æ¦‚ç‡ã€‚ç„¶è€Œå¯¹äºç›¸ä¼¼çš„<span class="math inline">\(x\)</span>æ¥è¯´ï¼Œå…¶å¯¹åº”çš„<span class="math inline">\(q_\phi(z|x)\)</span>ä¼šå‡ºç°å¾ˆå¤šé‡å¤çš„éƒ¨åˆ†ã€‚å½“è¾¾åˆ°å¹³è¡¡æ—¶ï¼Œ<strong>Time Gradient</strong>å°±å‡ºç°äº†ã€‚</p><p><img src="https://i.loli.net/2020/06/25/AaC9oNMShBRHFeY.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå½“<span class="math inline">\(x\)</span>è¶Šä¸ç›¸ä¼¼ï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>å°±ä¼šç›¸è·è¶Šè¿œï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ç„¶è€Œåœ¨ä¸€å¼€å§‹ï¼Œå‚æ•°ç»è¿‡éšæœºåˆå§‹åŒ–ï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>éƒ½æ˜¯éšæœºæ•£ä¹±çš„ï¼Œå¦‚ Figure 11(b) æ‰€ç¤ºã€‚éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>å°†ä¼šä¸æ–­ä¼˜åŒ–ã€‚ç”±äºKPIæ•°æ®å¾€å¾€æ˜¯å…‰æ»‘çš„ï¼Œé‚£ä¹ˆåœ¨æ—¶é—´ä¸Šç›¸è·è¶Šè¿œçš„æ ·æœ¬å°±ä¼šè¶Šä¸ç›¸ä¼¼ï¼Œå¯¹åº”çš„<span class="math inline">\(q_\phi(z|x)\)</span>ä¹Ÿä¼šç›¸è·æ›´è¿œã€‚è¿™ä¹Ÿè¯´æ˜äº†ï¼Œè®­ç»ƒç»“æŸåï¼Œæ—¶é—´ä¸Šç›¸è·è¶Šè¿œçš„ï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>ä¹Ÿä¼šç›¸è·è¶Šè¿œï¼Œåä¹‹äº¦ç„¶ã€‚åŒæ—¶è¿™ä¹Ÿè¡¨æ˜å­¦ä¹ ç‡çš„è®¾ç½®å¯¹æœ¬æ¨¡å‹çš„ç¨³å®šæ€§æœ‰è‡³å…³é‡è¦çš„ä½œç”¨ã€‚</p><h3 id="sub-optimal-equilibrium">Sub-Optimal Equilibrium</h3><p>ä¸Šé¢æˆ‘ä»¬è®¨è®ºäº†éšç€è®­ç»ƒè¿›è¡Œ<span class="math inline">\(q_\phi(z|x)\)</span>çš„æ¼”å˜ï¼Œä½œè€…æå‡ºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°æ¨¡å‹æ”¶æ•›åˆ°æ¬¡ä¼˜çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/udigOl3sJGwSaPz.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ç¬¬ä¸€è¡Œå±•ç¤ºçš„æ˜¯æ”¶æ•›åˆ°æœ€ä¼˜çš„æƒ…å†µï¼Œç¬¬äºŒè¡Œå±•ç¤ºçš„æ˜¯æ”¶æ•›åˆ°æ¬¡ä¼˜çš„æƒ…å†µã€‚ä»ç¬¬äºŒè¡Œçš„ç¬¬ä¸€ä¸ªå›¾ï¼ˆStep 100ï¼‰æ¥çœ‹ï¼Œç´«è‰²çš„ç‚¹å¼€å§‹ç©¿è¿‡ç»¿è‰²çš„ç‚¹ï¼Œéšç€è®­ç»ƒçš„è¿›è¡Œï¼Œç´«è‰²çš„ç‚¹å¼€å§‹å°†ç»¿è‰²çš„ç‚¹æ¨å¼€ã€‚åˆ°Step 5000çš„æ—¶å€™ï¼Œç»¿è‰²çš„ç‚¹å·²ç»è¢«åˆ†æˆäº†ä¸¤åŠã€‚ä¸‹å›¾å±•ç¤ºäº†å¯¹åº”çš„è®­ç»ƒè¯¯å·®å’ŒéªŒè¯è¯¯å·®ï¼š</p><p><img src="https://i.loli.net/2020/06/25/23zsxwurICV7aTj.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>è¿™æ ·çš„ç°è±¡ä¼šå¯¼è‡´åœ¨ä¸¤åŠç»¿è‰²åŒºåŸŸä¹‹é—´çš„æµ‹è¯•æ ·æœ¬ä¼šè¢«è¯†åˆ«ä¸ºç´«è‰²ï¼Œä»è€Œé™ä½æ€§èƒ½ã€‚ä½œè€…æå‡ºåœ¨<span class="math inline">\(K\)</span>è¾ƒå¤§çš„æ—¶å€™è¿™ç§ç°è±¡ä¸å®¹æ˜“å‘ç”Ÿï¼Œä½†è¿™æ—¶è®­ç»ƒçš„æ”¶æ•›åˆä¼šæˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>VAE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Time-Series Anomaly Detection Service at Microsoft</title>
    <link href="/2019/09/22/Time-Series-Anomaly-Detection-Service-at-Microsoft/"/>
    <url>/2019/09/22/Time-Series-Anomaly-Detection-Service-at-Microsoft/</url>
    
    <content type="html"><![CDATA[<h2 id="abstract">Abstract</h2><p>æœ¬æ–‡å€Ÿé‰´è®¡ç®—æœºè§†è§‰ä¸­çš„æ˜¾è‘—æ€§æ£€æµ‹ï¼Œæå‡ºäº†ä¸€ç§åŸºäºSpectral Residualçš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚</p><p><a href="https://www.kdd.org/kdd2019/accepted-papers/view/time-series-anomaly-detection-service-at-microsoft" target="_blank" rel="noopener">åŸæ–‡</a></p><p>è¿™ç¯‡æ–‡ç« è¿˜æå‡ºäº†å‡ ä¸ªæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹è½åœ°çš„éš¾ç‚¹ï¼š</p><ol type="1"><li><strong>Lack of Labels.</strong> åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¼šäº§ç”Ÿå¤§é‡çš„KPIï¼Œè€Œå¾ˆéš¾å¯¹æ¯ä¸ªKPIè¿›è¡Œäººå·¥æ ‡æ³¨ã€‚</li><li><strong>Generalization.</strong> ä¸åŒKPIæ‰€è¡¨ç°å‡ºæ¥çš„æ¨¡å¼ä¹Ÿä¸å°½ç›¸åŒï¼Œå¦‚Figure 1æ‰€ç¤ºã€‚ç°æœ‰æ–¹æ³•å¾ˆéš¾åœ¨æ‰€æœ‰æ¨¡å¼çš„KPIä¸Šéƒ½è¡¨ç°è‰¯å¥½ã€‚</li><li><strong>Efficiency.</strong> åœ¨å®é™…åœºæ™¯ä¸­ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„æ—¶é—´åºåˆ—æ•°æ®ï¼ŒåŒæ—¶å¯¹å¼‚å¸¸æ£€æµ‹ç®—æ³•çš„æ—¶é—´æ•ˆç‡æœ‰è¦æ±‚ã€‚</li></ol><p><img src="https://i.loli.net/2020/06/25/o21lnTUtcGuwCq6.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="contribution">Contribution</h2><ul><li>å°†Visual Saliency Detectionçš„æ–¹æ³•å¼•å…¥äº†æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ã€‚</li><li>ç»“åˆSpectral Residualå’ŒCNNæé«˜äº†å¼‚å¸¸æ£€æµ‹çš„æ•ˆæœã€‚</li><li>ç®—æ³•å…·æœ‰è‰¯å¥½çš„æ—¶é—´æ•ˆç‡å’Œé€šç”¨æ€§ã€‚</li></ul><h2 id="background">Background</h2><h3 id="spectral-residual">Spectral Residual</h3><p>SR(Spectral Residual)ç®—æ³•ä¸»è¦åŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼š</p><ol type="1"><li>é€šè¿‡å‚…é‡Œå¶å˜æ¢å¾—åˆ°log amplitude spectrumï¼›</li><li>è®¡ç®—spectral residualï¼›</li><li>é€šè¿‡å‚…é‡Œå¶é€†å˜æ¢å›åˆ°æ—¶é—´åŸŸã€‚</li></ol><p>æ›´å½¢å¼åŒ–çš„è¡¨è¿°ä¸ºå¦‚ä¸‹ï¼š</p><p>ç»™å®šä¸€ä¸ªåºåˆ—<span class="math inline">\(\mathbb{x}\)</span>ï¼Œåˆ™æœ‰ï¼š</p><p><span class="math display">\[A(f)=Amplitude(\mathscr{F}(\mathbb{x}))\]</span></p><p><span class="math display">\[P(f)=Phrase(\mathscr{F}(\mathbb{x}))\]</span></p><p><span class="math display">\[L(f)=\log(A(f))\]</span></p><p><span class="math display">\[AL(F)=h_1(f)\cdot L(f)\]</span></p><p><span class="math display">\[R(f)=L(f)-AL(f)\]</span></p><p><span class="math display">\[S(\mathbb{x})=\parallel\mathscr{F}^{-1}(\exp(R(f)+iP(f)))\parallel\]</span></p><p>å…¶ä¸­<span class="math inline">\(\mathscr{F}\)</span>å’Œ<span class="math inline">\(\mathscr{F}^{-1}\)</span>åˆ†åˆ«è¡¨ç¤ºå‚…é‡Œå¶å˜æ¢å’Œå‚…é‡Œå¶é€†å˜æ¢ï¼›<span class="math inline">\(\mathbb{x}\in \mathbb{R}^{n\times 1}\)</span>è¡¨ç¤ºè¾“å…¥åºåˆ—ï¼›<span class="math inline">\(A(f)\)</span>ä¸ºå¹…åº¦è°±ï¼Œ<span class="math inline">\(P(f)\)</span>ä¸ºç›¸ä½è°±ï¼Œ<span class="math inline">\(L(f)\)</span>ä¸ºå¯¹æ•°å¹…åº¦è°±ï¼Œ<span class="math inline">\(AL(F)\)</span>ä¸ºå‡å€¼æ»¤æ³¢åçš„å¯¹æ•°å¹…åº¦è°±ï¼›<span class="math inline">\(R(f)\)</span>ä¸ºspectral residualï¼›<span class="math inline">\(S(\mathbb{x})\)</span>ç§°ä¸ºsaliency mapã€‚Figure 4ä¸ºæ–‡ä¸­ç»™å‡ºçš„Saliency Mapç¤ºæ„å›¾ã€‚</p><p><img src="https://i.loli.net/2020/06/25/OrSlqhBWNdyfEG9.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h2 id="methodology">Methodology</h2><h3 id="problem-definition">Problem Definition</h3><blockquote><p>ç»™å®šä¸€ç³»åˆ—å®æ•°å€¼<span class="math inline">\(\mathbb{x}=x_1,x_2,\cdots,x_n\)</span>ï¼Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„ä»»åŠ¡æ˜¯äº§ç”Ÿä¸€ä¸ªè¾“å‡ºåºåˆ—<span class="math inline">\(\mathbb{y}=y_1,y_2,\cdots,y_n\)</span>å…¶ä¸­<span class="math inline">\(y_i\in\{0,1\}\)</span>è¡¨ç¤º<span class="math inline">\(x_i\)</span>æ˜¯å¦ä¸ºå¼‚å¸¸ç‚¹ã€‚</p></blockquote><h3 id="sr">SR</h3><p>å¯¹äºç»™å®šåºåˆ—<span class="math inline">\(\mathbb{x}\)</span>ï¼Œè®¡ç®—Saliency Map <span class="math inline">\(S(\mathbb{x})\)</span>ï¼Œè¾“å‡ºåºåˆ—<span class="math inline">\(O(\mathbb{x})\)</span>å®šä¹‰ä¸ºï¼š</p><p><span class="math display">\[O(x_i)=\begin{cases}1,\quad \text{if}\frac{S(x_i)-\overline{S(x_i)}}{\overline{S(x_i)}}&gt;\tau\\\\0,\quad \text{otherwise}\end{cases}\]</span></p><p>å…¶ä¸­<span class="math inline">\(S(x_i)\)</span>ä¸º<span class="math inline">\(x_i\)</span>å¯¹åº”çš„Saliency Mapçš„å€¼ï¼Œ<span class="math inline">\(\overline{S(x_i)}\)</span>ä¸º<span class="math inline">\(x_i\)</span>é™„è¿‘Saliency Mapå±€éƒ¨å‡å€¼ã€‚</p><hr /><p>åœ¨å®é™…æ“ä½œä¸­ï¼ŒFFTæ˜¯åœ¨ä¸€ä¸ªæ»‘åŠ¨çª—å£ä¸­è¿›è¡Œçš„ï¼Œæ–‡ä¸­æåˆ°SRæ–¹æ³•åœ¨ç‚¹ä½äºçª—å£ä¸­å¤®æ—¶æ•ˆæœæ›´å¥½ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œæµ‹è¯•çš„æ—¶å€™ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ–¹æ³•å¯¹å½“å‰ç‚¹<span class="math inline">\(x_n\)</span>(ä¹Ÿå°±æ˜¯å½“å‰åºåˆ—æœ€åä¸€ä¸ªç‚¹)ä¹‹åçš„ç‚¹è¿›è¡Œé¢„æµ‹ï¼š</p><p><span class="math display">\[\overline{g}=\frac{1}{m}\sum_{i=1}^m g(x_n,x_{n-i})\]</span></p><p><span class="math display">\[x_{n+1}=x_{n-m+1}+\overline{g}\cdot m\]</span></p><p>å…¶ä¸­<span class="math inline">\(g(x_i,x_j)\)</span>ä»£è¡¨<span class="math inline">\(x_i\)</span>å’Œ<span class="math inline">\(x_j\)</span>ä¸¤ç‚¹æ„æˆçš„ç›´çº¿çš„æ¢¯åº¦ï¼›<span class="math inline">\(\overline{g}\)</span>ä»£è¡¨æ‰€å¤„ç†çš„ç‚¹çš„å¹³å‡æ¢¯åº¦ï¼›<span class="math inline">\(m\)</span>ä¸ºæ‰€å¤„ç†çš„ç‚¹çš„æ•°é‡ã€‚åœ¨æœ¬æ–‡ä¸­è®¾ç½®<span class="math inline">\(m=5\)</span>ã€‚æ–‡ä¸­å‘ç°ç¬¬ä¸€ä¸ªé¢„æµ‹çš„å€¼å¾ˆé‡è¦ï¼Œæ‰€ä»¥ç›´æ¥æŠŠ<span class="math inline">\(x_{n+1}\)</span>èµ‹å€¼<span class="math inline">\(k\)</span>æ¬¡æ·»åŠ åˆ°åºåˆ—çš„æœ«å°¾ã€‚</p><h3 id="sr-cnn">SR-CNN</h3><p><img src="https://i.loli.net/2020/06/25/9pEWXRD5JM4umHn.png" srcset="/img/loading.gif" /></p><p>æœ¬æ–‡æåˆ°ï¼Œä»…ä»…ä½¿ç”¨ä¸€ä¸ªé˜ˆå€¼æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­å¤ªè¿‡ç®€å•ï¼Œäºæ˜¯æå‡ºä½¿ç”¨ä¸€ä¸ªåˆ¤åˆ«æ¨¡å‹æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­ã€‚ç”±äºè®­ç»ƒæ•°æ®æ²¡æœ‰æ ‡ç­¾ï¼Œæ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å…¬å¼äººå·¥åŠ å…¥å¼‚å¸¸ï¼š</p><p><span class="math display">\[x=(\overline{x}+mean)(1+var)\cdot r+x\]</span></p><p>å…¶ä¸­<span class="math inline">\(\overline{x}\)</span>æ‰€å¤„ç†çš„ç‚¹çš„å±€éƒ¨å‡å€¼ï¼›<span class="math inline">\(mean\)</span>å’Œ<span class="math inline">\(var\)</span>ä¸ºå½“å‰æ»‘åŠ¨çª—å£ç‚¹çš„å‡å€¼å’Œæ–¹å·®ï¼›<span class="math inline">\(r\sim \mathcal{N}(0,1)\)</span>ä¸ºæœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å™ªå£°ã€‚</p><hr /><p>å¯¹äºåˆ¤åˆ«æ¨¡å‹ä½¿ç”¨çš„æ˜¯CNNï¼Œä¸»è¦åŒ…å«ä¸¤ä¸ª1ç»´å·ç§¯å±‚(kernel sizeç­‰äºçª—å£å¤§å°<span class="math inline">\(w\)</span>)å’Œä¸¤ä¸ªå…¨è¿æ¥å±‚ã€‚ä¸¤ä¸ªå·ç§¯å±‚çš„channel sizeåˆ†åˆ«ä¸º<span class="math inline">\(w\)</span>å’Œ<span class="math inline">\(2w\)</span>ã€‚</p><h2 id="experiments">Experiments</h2><h3 id="datasets">Datasets</h3><p><img src="https://i.loli.net/2020/06/25/dquAjtRpNSY8rLo.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>æ‰€ç”¨æ•°æ®é›†åŒ…å«æ¸…åAIOpsç«èµ›æ•°æ®ã€Yahooå’ŒMicrosoftçš„KPIæ•°æ®ã€‚</p><h3 id="evaluation-metrics">Evaluation Metrics</h3><p>ç®—æ³•å‡†ç¡®ç‡æ–¹é¢ç”¨äº†precisionï¼Œrecallå’Œ<span class="math inline">\(F_1\)</span>-scoreã€‚</p><p><img src="https://i.loli.net/2020/06/25/EbcjA8X5fYa6Glz.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ç”±äºåœ¨å®é™…åœºæ™¯ä¸­KPIçš„å¼‚å¸¸å¾€å¾€æ˜¯ä»¥ä¸€æ®µä¸€æ®µçš„å½¢å¼å‡ºç°ï¼Œä¸”å¹¶ä¸è¦æ±‚æŸä¸€ä¸ªæ—¶é—´ç‚¹å‡ºç°å¼‚å¸¸ç®—æ³•å°±é©¬ä¸Šæ£€æµ‹å‡ºæ¥ï¼Œåªè¦æ£€æµ‹å‡ºæ¥çš„æ—¶é—´åœ¨ä¸€å®šçš„å®¹å¿èŒƒå›´å†…å³å¯ã€‚æœ¬æ–‡ä½¿ç”¨äº†ä¸€äº›è°ƒæ•´çš„æ‰‹æ®µï¼Œå¦‚Figure 6ã€‚å¯¹äºæŸä¸€æ®µå¼‚å¸¸ï¼Œè®¾æ®µé¦–çš„å¼‚å¸¸ä½äºæ—¶é—´ç‚¹<span class="math inline">\(t_{truth}\)</span>ï¼Œé¢„æµ‹ä¸ºå¼‚å¸¸çš„ç»“æœä¸­æ—¶é—´åœ¨<span class="math inline">\(t_{truth}\)</span>ä¹‹åä¸”è·<span class="math inline">\(t_{truth}\)</span>æœ€è¿‘çš„æ—¶é—´ç‚¹è®¾ä¸º<span class="math inline">\(t_{predict}\)</span>ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªé¢„å…ˆè®¾å®šçš„å®¹å¿èŒƒå›´<span class="math inline">\(k\)</span>ï¼Œåªè¦<span class="math inline">\(t_{predict}-t_{truth}\leq k+1\)</span>é‚£ä¹ˆåœ¨é¢„æµ‹ç»“æœä¸­æ•´æ®µå¼‚å¸¸å°±ä¼šé‡ç½®ä¸º<span class="math inline">\(1\)</span>ï¼Œå¦åˆ™å…¨éƒ¨é‡ç½®ä¸º<span class="math inline">\(0\)</span>ã€‚</p><h3 id="results">Results</h3><p>å®éªŒéƒ¨åˆ†ä½¿ç”¨äº†ä¸¤ç§è®­ç»ƒæ–¹å¼ï¼Œä¸€ç§æ˜¯cold-startï¼Œå³æŠŠæ‰€æœ‰æ•°æ®éƒ½ç”¨æ¥æµ‹è¯•ï¼Œå¦ä¸€ç§æ˜¯æŠŠæ•°æ®åˆ†ä¸ºè®­ç»ƒæµ‹è¯•ä¸¤éƒ¨åˆ†ï¼Œåœ¨è®­ç»ƒé›†ä¸Šè®­ç»ƒï¼Œæœ€ååœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œæµ‹è¯•ã€‚ä¸¤ç§æ–¹æ³•é€‚ç”¨çš„baselineä¸åŒï¼Œæœ€åç»“æœå¦‚Table 2å’ŒTable 3æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/3L9xe5jJGtnR6AQ.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><hr /><p>åœ¨SRçš„å‚æ•°è®¾ç½®ä¸Šï¼Œ<span class="math inline">\(h_q(f)\)</span>ä¸­çš„<span class="math inline">\(q\)</span>ä¸º3ï¼Œå±€éƒ¨å¹³å‡æ‰€ç”¨çš„ç‚¹æ•°ç›®<span class="math inline">\(z\)</span>ä¸º21ï¼Œé˜ˆå€¼<span class="math inline">\(\tau\)</span>ä¸º3ï¼Œä¼°è®¡ç‚¹çš„æ•°é‡<span class="math inline">\(k\)</span>ä¸º5ï¼Œæ»‘åŠ¨çª—å£çš„å¤§å°<span class="math inline">\(w\)</span>åœ¨KPIã€Yahooã€Microsoftä¸‰ä¸ªæ•°æ®é›†ä¸Šåˆ†åˆ«ä¸º1440ã€64å’Œ30ã€‚SR-CNNçš„<span class="math inline">\(q\)</span>ï¼Œ<span class="math inline">\(z\)</span>ï¼Œ<span class="math inline">\(k\)</span>ï¼Œ<span class="math inline">\(w\)</span>è®¾ç½®ä¸SRç›¸åŒã€‚</p><h3 id="additional-experiments-with-dnn">Additional Experiments with DNN</h3><p>æ–‡ä¸­è¿˜å¯¹æœ‰ç›‘ç£çš„æƒ…å†µè¿›è¡Œäº†æµ‹è¯•ï¼Œå…·ä½“åšæ³•æ˜¯ä»æ—¶é—´åºåˆ—æå–ç‰¹å¾ï¼Œç„¶åå°†Saliency Mapä¹Ÿä½œä¸ºç‰¹å¾å¼•å…¥ï¼Œæ„é€ ä¸€ä¸ªæœ‰ç›‘ç£çš„Neural Networkè¿›è¡Œæµ‹è¯•ã€‚</p><p>æå–çš„ç‰¹å¾å¦‚Table 5æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/4flipKbc1OtVGg9.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p><hr /><p>ç¥ç»ç½‘ç»œçš„ç»“æ„ä¸ºä¸¤å±‚å…¨è¿æ¥å±‚ï¼Œå¹¶æ·»åŠ äº†Dropout Ratioä¸º0.5çš„Dropout Layerã€‚ä¸¤ä¸ªLayerä½¿ç”¨äº†<span class="math inline">\(L_1=L_2=0.0001\)</span>çš„æ­£åˆ™åŒ–ã€‚åŒæ—¶ä¸ºäº†å¤„ç†æ ·æœ¬ä¸å¹³è¡¡çš„æƒ…å†µä½¿ç”¨äº†è¿‡é‡‡æ ·æ¥ä½¿æ­£è´Ÿæ ·æœ¬çš„æ¯”ä¾‹ä¸º<span class="math inline">\(1:2\)</span>ã€‚ç»“æ„å¦‚Figure 7æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/bxeluFBHv2i7Y5m.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><hr /><p>è®­ç»ƒæµ‹è¯•é›†çš„æƒ…å†µå¦‚Table 6æ‰€ç¤ºï¼Œæœ€ç»ˆç»“æœå¦‚Table 7æ‰€ç¤ºï¼ŒP-Ræ›²çº¿å¦‚Figure 8æ‰€ç¤ºã€‚å¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†SRç‰¹å¾çš„DNNæ•ˆæœç”±äºæ²¡æœ‰ä½¿ç”¨SRç‰¹å¾çš„DNNã€‚</p><p><img src="https://i.loli.net/2020/06/25/E6vapzhCiG9HTPu.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p><img src="https://i.loli.net/2020/06/25/tZAOg74flmE39oI.png" srcset="/img/loading.gif" style="zoom:67%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>Spectral</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
