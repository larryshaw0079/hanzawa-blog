<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Time Series Anomaly Discovery with Grammar-based Compression</title>
    <link href="/2020/07/06/Time-Series-Anomaly-Discovery-with-Grammar-based-Compression/"/>
    <url>/2020/07/06/Time-Series-Anomaly-Discovery-with-Grammar-based-Compression/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><h1 id="Preliminaries"><a href="#Preliminaries" class="headerlink" title="Preliminaries"></a>Preliminaries</h1><h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>PRML Notes 1.1: Probability Distributions - Binary and Multinomial Variables</title>
    <link href="/2020/06/22/PRML-Notes-1-1-Probability-Distributions-Binary-and-Multinomial-Variables/"/>
    <url>/2020/06/22/PRML-Notes-1-1-Probability-Distributions-Binary-and-Multinomial-Variables/</url>
    
    <content type="html"><![CDATA[<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><p>è¿™æ˜¯PRML (Pattern Recognition and Machine Learning) ç¬¬äºŒç« <code>Probability Distributions</code>ç¬”è®°çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œä¸»è¦åŒ…æ‹¬<code>2.1. Binary Variables</code>å’Œ<code>2.2. Multinomial Variables</code>è¿™ä¸¤èŠ‚ã€‚</p><h1 id="Probability-Distributions-for-Binary-Variables"><a href="#Probability-Distributions-for-Binary-Variables" class="headerlink" title="Probability Distributions for Binary Variables"></a>Probability Distributions for Binary Variables</h1><h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>è¿™ä¸€èŠ‚ä¸»è¦é’ˆå¯¹äºŒå€¼éšæœºå˜é‡çš„å»ºæ¨¡ï¼Œå³$x\in{0,1}$ã€‚è¿™é‡Œå¯ä»¥æƒ³è±¡ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªç¡¬å¸ï¼Œ$x=1$ä»£è¡¨æ­£é¢æœä¸Šï¼Œè€Œ$x=0$ä»£è¡¨åé¢æœä¸Šï¼Œå¹¶ä¸”æ­£é¢æœä¸Šçš„æ¦‚ç‡ä¸º$\mu$ï¼Œå³ï¼š<br>$$<br>p(x=1|\mu)=\mu<br>$$<br>å…¶ä¸­$0\leqslant \mu \leqslant 1$ã€‚$x$çš„æ¦‚ç‡åˆ†å¸ƒå¯ä»¥å†™ä¸ºï¼š<br>$$<br>\text{Bern}(x|\mu)=\mu^x(1-\mu)^{1-x}<br>$$<br>ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„<strong>ä¼¯åŠªåˆ©åˆ†å¸ƒ (Bernoulli Distribution)</strong>ã€‚å…¶å‡å€¼å’Œæ–¹å·®åˆ†åˆ«ä¸ºï¼š<br>$$<br>\begin{align}<br>\mathbb E[x]&amp;=\mu\<br>\text{var}[x] &amp;= \mu(1-\mu)<br>\end{align}<br>$$<br>ç°åœ¨æ¥è€ƒè™‘å‚æ•°ä¼°è®¡ä»»åŠ¡ã€‚å‡è®¾æˆ‘ä»¬æ­£åœ¨è¿›è¡Œä¸€ä¸ªæŠ•ç¡¬å¸çš„å®éªŒï¼Œæ¯ä¸€æ¬¡æŠ•å¸éƒ½æœä»ä¼¯åŠªåˆ©åˆ†å¸ƒä¸”ç›¸äº’ç‹¬ç«‹ï¼Œæˆ‘ä»¬å°†æ¯æ¬¡é‡‡é›†åˆ°çš„è§‚æµ‹å€¼ç»„æˆæ•°æ®é›†$\mathcal D={x_1,\cdots,x_N}$ï¼Œåˆ™ä¼¼ç„¶å‡½æ•°ä¸ºï¼š<br>$$<br>p(\mathcal D|\mu)=\prod_{n=1}^N p(x_n|\mu)=\prod_{n=1}^N \mu^{x_n}(1-\mu)^{1-x_n}<br>$$<br>å¦‚æœé‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°ï¼Œè¿™ç­‰ä»·äºæœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶ï¼š<br>$$<br>\ln p(\mathcal D|\mu)=\sum_{n=1}^{N}\ln p(x_n|\mu)=\sum_{n=1}^N{x_n\ln\mu+(1-x_n)\ln(1-\mu)}<br>$$<br>ä»¤å…¶å¯¼æ•°ä¸º0å¾—åˆ°æå€¼ç‚¹ï¼š<br>$$<br>\mu_{ML}=\frac{1}{N}\sum_{n=1}^N x_n<br>$$<br>è¿™ç›¸å½“äºæ ·æœ¬å‡å€¼ï¼Œä¸è¿‡è¿™æ ·åšä¼šæœ‰ä¸¥é‡çš„é—®é¢˜ã€‚å‡è®¾æˆ‘ä»¬çš„æ•°æ®é›†ä¸º$\mathcal D={1,1,1}$ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªæ”¶é›†åˆ°äº†ä¸‰ä¸ªæ ·æœ¬ï¼Œå¹¶ä¸”éƒ½æ˜¯æ­£ä¾‹ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°$\mu_{ML}=1$ï¼Œè€Œè¿™æ˜¾ç„¶æ˜¯ä¸¥é‡è¿‡æ‹Ÿåˆçš„ã€‚ç¨åæˆ‘ä»¬ä¼šè¯´è¯´å¦‚ä½•åº”å¯¹è¿™ç§æƒ…å†µï¼ˆåŠ å…¥å…ˆéªŒï¼‰ã€‚</p><h2 id="Binomial-Distribution"><a href="#Binomial-Distribution" class="headerlink" title="Binomial Distribution"></a>Binomial Distribution</h2><p>æˆ‘ä»¬åŒæ ·å¯ä»¥å¯¹å¤šæ¬¡ä¼¯åŠªåˆ©å®éªŒè¿›è¡Œæ¦‚ç‡å»ºæ¨¡ã€‚è®°$m$ä¸ºæˆåŠŸçš„æ¬¡æ•°ï¼Œ$N$ä¸ºæ•°æ®é›†å¤§å°ï¼Œå¯çŸ¥è¿™ä¸ªæ¦‚ç‡åº”è¯¥ä¸$\mu^m(1-\mu)^{N-m}$æˆæ­£æ¯”ã€‚ä¹˜ä»¥æ ‡å‡†åŒ–ç³»æ•°åå³æˆ‘ä»¬ç†ŸçŸ¥çš„<strong>äºŒé¡¹åˆ†å¸ƒ (Binomial Distribution)</strong>ï¼š<br>$$<br>\text{Bin}(m|N,\mu)=\binom{N}{m}\mu^m(1-\mu)^{N-m}<br>$$</p><p>å…¶ä¸­ï¼š<br>$$<br>\binom{N}{m}=\frac{N!}{(N-m)!m!}<br>$$<br>å…¶å‡å€¼å’Œæ–¹å·®åˆ†åˆ«ä¸ºï¼š<br>$$<br>\begin{align}<br>\mathbb E[m]&amp;=N\mu\<br>\text{var}[m]&amp;=N\mu(1-\mu)<br>\end{align}<br>$$</p><h2 id="Beta-Distribution"><a href="#Beta-Distribution" class="headerlink" title="Beta Distribution"></a>Beta Distribution</h2><p>ç°åœ¨æˆ‘ä»¬æ¥è®¨è®ºå¦‚ä½•è§£å†³åˆšæ‰æåˆ°çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡è¿‡æ‹Ÿåˆé—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨è´å¶æ–¯çš„æ€è·¯ï¼Œå¯¹$\mu$å¼•å…¥äº†å…ˆéªŒåˆ†å¸ƒ$p(\mu)$ã€‚è€Œè¿™ä¸ªåˆ†å¸ƒéœ€è¦å…·æœ‰è‰¯å¥½çš„è§£é‡Šæ€§å’Œæ•°å­¦æ€§è´¨ã€‚</p><p>æ ¹æ®è´å¶æ–¯å®šç†ï¼š<br>$$<br>p(\mu|\mathcal D)=\frac{p(\mathcal D|\mu)p(\mu)}{p(\mathcal D)}<br>$$<br>è€Œ$p(\mathcal D)=\int_0^1 p(\mathcal D|\mu)p(\mu)\mathrm d\mu$åªå—æ•°æ®é›†å½±å“ï¼Œè€Œæ•°æ®é›†æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ä¸ºå¸¸æ•°ï¼Œå› æ­¤$p(\mu|\mathcal D)\propto p(\mathcal D|\mu)p(\mu)$ã€‚è€Œä¼¼ç„¶å‡½æ•°ä¸º$\mu^x(1-\mu)^{1-x}$çš„ä¹˜ç§¯ï¼Œå¦‚æœå…ˆéªŒä¹Ÿé‡‡ç”¨$\mu$å’Œ$1-\mu$çš„å¹‚çš„ä¹˜ç§¯çš„å½¢å¼ï¼Œé‚£ä¹ˆåéªŒåˆ†å¸ƒä¹Ÿå°†å’Œå…ˆéªŒå½¢å¼ç›¸åŒï¼Œè¿™ç§æ€§è´¨åœ¨ç»Ÿè®¡å­¦ä¸­è¢«ç§°ä¸º<strong>å…ˆéªŒå…±è½­ (conjugacy)</strong>ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç»™å‡ºè¿™ä¸ªå…ˆéªŒåˆ†å¸ƒï¼Œå†æ¥åˆ†æå®ƒçš„æ€§è´¨ã€‚è¿™ä¸ªåˆ†å¸ƒå«åš<strong>Betaåˆ†å¸ƒ (Beta Distribution)</strong>$P(\mu|a,b)\sim \text{Beta}(a,b)$ï¼š<br>$$<br>\begin{align}<br>\text{Beta}(\mu|a,b) &amp;= \frac{\Gamma(a+b)}{\Gamma(a\Gamma(b)}\mu^{a-1}(1-\mu)^{b-1}\ &amp;= \frac{1}{B(a,b)}\mu^{a-1}(1-\mu)^{b-1}<br>\end{align}<br>$$<br>$B(\boldsymbol \alpha,\beta)$ç§°ä¸ºBå‡½æ•°ï¼Œä¸ºä¸€ä¸ªæ ‡å‡†åŒ–å‡½æ•°ï¼š<br>$$<br>\begin{align}<br>B(a,b) = \frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}<br>\end{align}<br>$$<br>å…¶ç›®çš„æ˜¯ä¸ºäº†ä½¿æ•´ä¸ªæ¦‚ç‡åˆ†å¸ƒç§¯åˆ†ç­‰äº1è€Œå­˜åœ¨çš„ã€‚Gammaå‡½æ•°çš„å®šä¹‰ä¸ºï¼š<br>$$<br>\Gamma(x)=\int_0^{\infty}s^{x-1}e^{-s}\mathrm d s<br>$$<br>Gammaå‡½æ•°æœ‰ä¸€ä¸ªæ€§è´¨ï¼š</p><p>$$<br>\Gamma(x+1)=x\Gamma(x)<br>$$<br>è¯æ˜ä¸ºï¼š<br>$$<br>\begin{align<em>}<br>\Gamma(x+1) &amp;= \int_{0}^{\infty} {s^{x} e^{-s} ds} \<br>&amp;= \big[s^{x} (-e^{-s})\big] \big|<em>{0}^{\infty} - \int</em>{0}^{\infty} {(x s^{x-1}) (-e^{-s}) ds} \<br>&amp;= (0 - 0) + x \int_{0}^{\infty} {s^{x-1} e^{-s} ds} \<br>&amp;= x \Gamma(x)<br>\end{align</em>}<br>$$</p><p>é™¤æ­¤ä¹‹å¤–ï¼š</p><p>$$<br>\Gamma(1)=1\<br>\Gamma(\frac{1}{2})=\sqrt{\pi}<br>$$</p><p>å¯ä»¥éªŒè¯ï¼š<br>$$<br>\int_0^1\text{Beta}(\mu|a,b)\mathrm d\mu=1<br>$$</p><p>Betaåˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ä¸ºï¼š</p><p>$$<br>\mathbb E[\mu]=\frac{a}{a+b}\<br>\text{var}[\mu]=\frac{ab}{(a+b)^2(a+b+1)}<br>$$</p><p>å› ä¸ºåéªŒåˆ†å¸ƒä¸å…ˆéªŒå’Œä¼¼ç„¶å‡½æ•°çš„ä¹˜ç§¯æˆæ¯”ä¾‹ï¼Œé‚£ä¹ˆï¼š<br>$$<br>p(\mu|m,l,a,b)\propto\mu^{m+a-1}(1-\mu)^{l+b-1}<br>$$</p><p>å…¶ä¸­$l=N-m$ã€‚ä¹˜ä¸Šæ ‡å‡†åŒ–å› å­ï¼Œå°±å¾—åˆ°ï¼š<br>$$<br>p(\mu|m,l,a,b)=\frac{\Gamma(m+a+l+b)}{\Gamma(m+a)\Gamma(l+b)}\mu^{m+a-1}(1-\mu)^{l+b-1}<br>$$<br>å¾—åˆ°çš„ä»ç„¶æ˜¯Betaåˆ†å¸ƒï¼Œç›¸å½“äºæŠŠ$a\rightarrow{m+a}$ï¼Œ$b\rightarrow{l+b}$ã€‚åŒæ—¶ä¸éš¾å‘ç°ï¼Œå‚æ•°$a$å’Œ$b$éƒ½æœ‰æ¯”è¾ƒç›´è§‚çš„æ„ä¹‰ã€‚$a$å¯ä»¥çœ‹ä½œæ˜¯å†å²è®°å½•ä¸­ï¼ŒæˆåŠŸçš„æ¬¡æ•°ï¼Œ$b$å¯ä»¥çœ‹ä½œæ˜¯å†å²è®°å½•ä¸­å¤±è´¥çš„æ¬¡æ•°ï¼Œæ¯”å¦‚$a=2$ï¼Œ$b=3$ï¼Œæ ¹æ®ç»éªŒæˆåŠŸçš„æ¦‚ç‡åº”è¯¥åœ¨$\frac{2}{2+3}=0.4$å·¦å³ï¼Œå³æˆ‘ä»¬çš„å…ˆéªŒä¸ºæˆåŠŸçš„æ¦‚ç‡ä¸º$0.4$ï¼ˆè§ä¸‹å›¾å·¦ä¸‹è§’çš„å­å›¾ï¼‰ã€‚å¦‚æœåœ¨å®éªŒä¸­ï¼Œåˆè¿›è¡Œäº†$7$æ¬¡å®éªŒï¼Œå…¶ä¸­$m=6$ï¼Œ$l=1$ï¼Œç”±äºæˆåŠŸçš„æ¬¡æ•°å˜å¤šäº†ï¼Œ$a=2+6=8$ï¼Œ$b=3+1=4$ï¼Œç›´è§‰ä¸Šæ¥è¯´æˆ‘ä»¬å¯¹æˆåŠŸæ¦‚ç‡çš„ä¼°è®¡åº”å½“ç›¸åº”æé«˜ï¼Œå¤§æ¦‚ä¸º$\frac{8}{8+4}\approx 0.67$å·¦å³ã€‚è¿™æ—¶çš„Betaåˆ†å¸ƒå¦‚å³ä¸‹è§’çš„å›¾çš„æ ·å­ï¼Œä¹Ÿå°è¯äº†æˆ‘ä»¬çš„ç›´è§‰ã€‚</p><img src="https://i.loli.net/2020/06/25/3hcj18ELXl4iWy6.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä»¥ä¸‹ä¸ºä¸åŒå‚æ•°å¯¹åº”çš„Betaåˆ†å¸ƒçš„äº’åŠ¨æ¼”ç¤ºï¼š</p><div><iframe width="650px" height="450px" frameborder="0" style="dispaly:blockï¼›" src="http://qfxiao.me/html/beta_distribution_vis.html"></iframe></div><p>æœ€åï¼ŒBetaè¿˜æœ‰ä¸€ä¸ªæœ‰è¶£çš„åº”ç”¨å°±æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸æ–­æ¥æ”¶åˆ°æ–°çš„è§‚æµ‹æ•°æ®ï¼Œé‚£ä¹ˆæ—§çš„åéªŒåˆ†å¸ƒåˆ™å¯ä»¥ä½œä¸ºæ–°çš„å…ˆéªŒåˆ†å¸ƒå°†å‚æ•°æ›´æ–°ä¸‹å» ã€‚è¿™ç›¸å½“äºè¯´ï¼ŒåŸºäºå·²æœ‰çš„è§‚æµ‹æ•°æ®ï¼Œæˆ‘ä»¬æå‡ºä¸€ä¸ªå…ˆéªŒBetaåˆ†å¸ƒï¼Œç„¶åæ ¹æ®æ–°å¾—åˆ°çš„ä¸€æ‰¹è§‚æµ‹æ•°æ®ï¼Œç”¨å…ˆéªŒBetaåˆ†å¸ƒè®¡ç®—ä¸€ä¸ªä¼¼ç„¶å‡½æ•°ï¼Œå°†ä¼¼ç„¶å‡½æ•°å’Œå…ˆéªŒBetaåˆ†å¸ƒä¹˜èµ·æ¥ï¼Œå½’ä¸€åŒ–åå¾—åˆ°äº†æ–°çš„åéªŒåˆ†å¸ƒï¼Œåªè¦ä¸æ–­æœ‰æ–°çš„è§‚æµ‹æ•°æ®æ¥æ”¶åˆ°ï¼Œå°±å¯ä»¥æŠŠåéªŒåˆ†å¸ƒä½œä¸ºæ–°çš„å…ˆéªŒï¼Œä¸æ–­æ›´æ–°ä¸‹å»ã€‚è¿™æ ·åšçš„ä¼˜åŠ¿æ˜¯å¯¹äºå¤§æ•°æ®é›†ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ•´ä¸ªæ•°æ®é›†ï¼Œè€Œæ˜¯åªéœ€è¦ä¸€æ‰¹ä¸€æ‰¹çš„æ›´æ–°å³å¯ã€‚</p><h1 id="Probability-Distributions-for-Multinomial-Variables"><a href="#Probability-Distributions-for-Multinomial-Variables" class="headerlink" title="Probability Distributions for Multinomial Variables"></a>Probability Distributions for Multinomial Variables</h1><h2 id="Intro-1"><a href="#Intro-1" class="headerlink" title="Intro"></a>Intro</h2><p>å‰é¢æˆ‘ä»¬è®¨è®ºäº†äºŒå€¼éšæœºå˜é‡ï¼Œç°åœ¨æˆ‘ä»¬å°†å…¶æ‰©å±•åˆ°å¤šå€¼å˜é‡ã€‚è®¾ä¸€ä¸ª$K$ç»´å‘é‡$\mathbf x$ï¼Œå½“$x_k$ä¸º$1$çš„æ—¶å€™å…¶ä»–å…ƒç´ éƒ½ä¸º$0$ï¼Œå¦‚$K=6,x_3=1$æ—¶$\mathbf x$è¡¨ç¤ºä¸º$\mathbf x=(0,0,1,0,0,0)^\top$ã€‚å¦‚æœ$p(x_k=1)=\mu_k$ï¼Œé‚£ä¹ˆ$\mathbf x$çš„æ¦‚ç‡åˆ†å¸ƒä¸ºï¼š<br>$$<br>p(\mathbf x|\boldsymbol \mu)=\prod_{k=1}^{K}\mu_k^{x_k}<br>$$<br>$\mu_k$æ»¡è¶³$\sum_k \mu_k=1$å’Œ$\mu_k\geqslant 0$ï¼Œè¯¥åˆ†å¸ƒè¢«ç§°ä½œæ˜¯<strong>Categorical Distribution</strong>ã€‚æ˜“çŸ¥å…¶å‡å€¼ä¸ºï¼š<br>$$<br>\begin{align}<br>\mathbb E[\mathbf x|\boldsymbol \mu]=\sum_{\mathbf x}p(\mathbf x|\boldsymbol \mu)\mathbf x=\boldsymbol \mu<br>\end{align}<br>$$<br>å‡è®¾æˆ‘ä»¬æœ‰å¤§å°ä¸º$N$çš„æ•°æ®é›†$\mathcal D$ï¼Œæ¯ä¸ªæ ·æœ¬æœä»è¯¥åˆ†å¸ƒä¸”ç›¸äº’ç‹¬ç«‹ï¼Œé‚£ä¹ˆä¼¼ç„¶å‡½æ•°ï¼š<br>$$<br>p(\mathcal D|\boldsymbol \mu)=\prod_{n=1}^N\prod_{k=1}^K \mu_k^{x_{nk}}=\prod_{k=1}^K \mu_k^{\sum_n x_{nk}}=\prod_{k=1}^K\mu_k^{m_k}<br>$$<br>å…¶ä¸­$m_k=\sum_n x_{nk}$ï¼Œå³$x_k=1$çš„æ•°é‡ã€‚ä¸ºäº†æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶åŒæ—¶ä¿è¯$\sum_k \mu_k=1$ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼š<br>$$<br>\sum_{k=1}^K m_k\ln \mu_k+\lambda\left(\sum_{k=1}^K\mu_k-1\right)<br>$$<br>æˆ‘ä»¬å¾—åˆ°$\mu_k=-m_k/\lambda$ã€‚é€šè¿‡$\sum_k \mu_k=1$å¾—å‡º$\lambda=-N$ï¼Œæ•…æœ€åæˆ‘ä»¬æœ‰ï¼š<br>$$<br>\mu_k^{ML}=\frac{m_k}{N}<br>$$</p><p>è¿™ç›¸å½“äºæ˜¯$x_k=1$çš„æ•°é‡é™¤ä»¥æ€»æ•°ã€‚</p><h2 id="Multinomial-Distribution"><a href="#Multinomial-Distribution" class="headerlink" title="Multinomial Distribution"></a>Multinomial Distribution</h2><p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å¤šæ¬¡å®éªŒè¿›è¡Œå»ºæ¨¡ï¼Œå‡è®¾è¿›è¡Œ$N$æ¬¡ç‹¬ç«‹å®éªŒï¼Œæ¦‚ç‡åˆ†å¸ƒå¯ä»¥å†™ä¸ºï¼š</p><p>$$<br>\text{Mult}(m_1,m_2,\cdots,m_K|\boldsymbol\mu,N)=\binom{N}{m_1m_2\cdots m_K}\prod_{k=1}^K\mu_k^{m_k}<br>$$</p><p>è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„<strong>å¤šé¡¹åˆ†å¸ƒ (Multinomial Distribution)</strong>ï¼Œå…¶ä¸­$\binom{N}{m_1m_2\cdots m_K}$ä¸ºæ­£åˆ™åŒ–å› å­ï¼š<br>$$<br>\binom{N}{m_1m_2\cdots m_K}=\frac{N!}{m_1!m_2!\cdots m_K!}<br>$$<br>æ³¨æ„$\sum\limits_{k=1}^K m_k=N$ã€‚</p><h2 id="Dirichlet-Distribution"><a href="#Dirichlet-Distribution" class="headerlink" title="Dirichlet Distribution"></a>Dirichlet Distribution</h2><p>æœ‰äº†å‰é¢Betaçš„å¯å‘ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥å¯¹å¤šé¡¹åˆ†å¸ƒçš„å‚æ•°$\mu_k$å»ºç«‹å…±è½­å…ˆéªŒã€‚é¦–å…ˆæ ¹æ®ä¼¼ç„¶å‡½æ•°ï¼Œæˆ‘ä»¬çŸ¥é“å…ˆéªŒåº”å½“ä¸$\mu_k$çš„å¹‚çš„ä¹˜ç§¯æˆæ¯”ä¾‹ï¼š</p><p>$$<br>p(\boldsymbol \mu|\boldsymbol \alpha) \propto \prod_{k=1}^{K}\mu_k^{a_{k-1}}<br>$$</p><p>å…¶ä¸­$0\leqslant \mu_k\leqslant 1$ä¸”$\sum_k\mu_k=1$ã€‚å’ŒBetaåˆ†å¸ƒä¸åŒï¼Œç”±äºè¦æ»¡è¶³$\sum\mu_k=1$ï¼Œæ‰€ä»¥${\mu_k}$çš„å–å€¼ä¼šä½äº$K-1$çš„å•çº¯å‹ä¸Šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/N8CSMvmlRz91Gqy.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>åŠ ä¸Šæ ‡å‡†åŒ–å› å­ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†æ‰€è°“çš„å…ˆéªŒåˆ†å¸ƒï¼Œç§°ä¹‹ä¸º<strong>è¿ªåˆ©å…‹é›·åˆ†å¸ƒ (Dirichlet Distribution)</strong>ï¼š<br>$$<br>\text{Dir}(\boldsymbol \mu|\boldsymbol\alpha)=\frac{\Gamma(\alpha_0)}{\Gamma(\alpha_1)\cdots\Gamma(\alpha_K)}\prod_{k=1}^K\mu_k^{a_{k-1}}<br>$$</p><p>å…¶ä¸­$\Gamma(\cdot)$ä¸ºGammaå‡½æ•°ï¼Œ$\alpha_0=\sum\limits_{k=1}^K\alpha_k$ã€‚ä¸‹å›¾ä¸ºä¸åŒæ¡ä»¶ä¸‹çš„è¿ªåˆ©å…‹é›·åˆ†å¸ƒçš„å¯è§†åŒ–ï¼š</p><p><img src="https://i.loli.net/2020/06/25/amGtuvPNoOM7kWZ.png" srcset="/img/loading.gif" alt=""></p><p>$\boldsymbol \mu$çš„åéªŒä¸å…ˆéªŒå’Œä¼¼ç„¶å‡½æ•°çš„ä¹˜ç§¯æˆæ­£æ¯”ï¼š</p><p>$$<br>p(\boldsymbol\mu|\mathcal D,\boldsymbol\alpha)\propto p(\mathcal D|\boldsymbol\mu)p(\boldsymbol\mu|\boldsymbol\alpha)\propto\prod_{k=1}^K \mu_k^{\alpha_k+m_k-1}<br>$$</p><p>ä¸éš¾éªŒè¯ï¼š</p><p>$$<br>\begin{align}<br>p(\boldsymbol\mu|\mathcal D,\boldsymbol\alpha) &amp;= \text{Dir}(\boldsymbol\mu|\boldsymbol\alpha+\mathbf m)\<br>&amp;=\frac{\Gamma(\alpha_0+N)}{\Gamma(\alpha_1+m_1)\cdots\Gamma(\alpha_K+m_K)}\prod_{k=1}^K\mu_k^{\alpha_k+m_k-1}<br>\end{align}<br>$$</p><p>å³åéªŒåŒæ ·ä¸ºè¿ªåˆ©å…‹é›·åˆ†å¸ƒã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Statistics</tag>
      
      <tag>Probability</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Time2Graph: Revisiting Time Series Modeling with Dynamic Shapelets</title>
    <link href="/2020/06/13/Time2Graph-Revisiting-Time-Series-Modeling-with-Dynamic-Shapelets/"/>
    <url>/2020/06/13/Time2Graph-Revisiting-Time-Series-Modeling-with-Dynamic-Shapelets/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>æœ¬æ–‡æ—¨åœ¨æä¾›ä¸€ç§å¯è§£é‡Šçš„é«˜æ•ˆçš„æ—¶é—´åºåˆ—å»ºæ¨¡ï¼ˆè¡¨ç¤ºå­¦ä¹ ï¼‰æ–¹æ³•æ¥æ›´å¥½åœ°æœåŠ¡åˆ†ç±»ä»»åŠ¡ã€‚Shapeletåœ¨æ—¶é—´åºåˆ—åˆ†ç±»ä»»åŠ¡ä¸Šä½“ç°äº†è‰¯å¥½çš„å¯è§£é‡Šæ€§ã€‚ä¸è¿‡ä¼ ç»Ÿçš„åŸºäºShapeletçš„æ–¹æ³•å¿½ç•¥äº†Shapeletåœ¨ä¸åŒæ—¶é—´ç‰‡æ®µä¸Šçš„åŠ¨æ€æ€§ï¼Œå³æ•´ä¸ªæ—¶é—´ç»´åº¦ä¸Šä¸åŒçš„æ—¶é—´ç‰‡æ®µå¯èƒ½é€‚åˆç”¨ä¸åŒçš„Shapeletã€‚ä½œè€…åŸºäºæ­¤è®¾è®¡äº†åŠ¨æ€çš„<em>time-aware shapelet</em>ï¼Œå¹¶ä¸”å®šä¹‰äº†<em>shapelet evolution graph</em>æ¥æ•è·Shapeletåœ¨æ—¶é—´ç»´åº¦ä¸Šçš„åŠ¨æ€å˜åŒ–ã€‚</p><p><a href="https://arxiv.org/abs/1911.04143" target="_blank" rel="noopener">ğŸ“°Get Paper</a></p><h1 id="preliminaries">Preliminaries</h1><p>æ—¶é—´åºåˆ—é›†åˆ<span class="math inline">\(T=\{t_1,\cdots,t_{|T|}\}\)</span>åŒ…å«è‹¥å¹²æ¡æ—¶åºæ•°æ®<span class="math inline">\(t=\{x_1,\cdots,x_n\}\)</span>ã€‚ä¸€ä¸ª<span class="math inline">\(t\)</span>çš„ç‰‡æ®µ<span class="math inline">\(s\)</span>æ˜¯<span class="math inline">\(t\)</span>çš„ä¸€ä¸ªè¿ç»­å­åºåˆ—ã€‚å¦‚æœ<span class="math inline">\(t\)</span>èƒ½è¢«åˆ‡åˆ†æˆ<span class="math inline">\(m\)</span>ä¸ªé•¿åº¦éƒ½ä¸º<span class="math inline">\(l\)</span>çš„ç‰‡æ®µï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰<span class="math inline">\(t=\{\{x_{l*k+1},\cdots,x_{l*k+l}\},0\leq k\leq m-1\}\)</span>ã€‚ä¸¤ä¸ªé•¿åº¦ç›¸ç­‰çš„ç‰‡æ®µä¹‹é—´è·ç¦»å¾ˆå¥½åº¦é‡ï¼Œç›´æ¥è®¡ç®—æ¬§å¼è·ç¦»å³å¯ï¼Œé‚£ä¹ˆä¸¤ä¸ªç‰‡æ®µé•¿åº¦ä¸ç›¸ç­‰çš„æƒ…å†µå‘¢ï¼Ÿè¿™å°±éœ€è¦å¯¹å…¶ï¼ˆAlignmentï¼‰çš„æ¦‚å¿µã€‚</p><blockquote><p><strong>Definition 1 </strong> <strong><em>Alignment</em></strong>. ç»™å®šä¸¤ä¸ªé•¿åº¦åˆ†åˆ«ä¸º<span class="math inline">\(l_i\)</span>å’Œ<span class="math inline">\(l_j\)</span>çš„åºåˆ—<span class="math inline">\(s_i\)</span>å’Œ<span class="math inline">\(s_j\)</span>ï¼Œä¸€ä¸ª<em>alignment</em> <span class="math inline">\(a=(a_1,a_2)\)</span>æ˜¯ä¸€ä¸ªæ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„é•¿åº¦ä¸º<span class="math inline">\(p\)</span>çš„ä¸‹æ ‡åºåˆ—ï¼š <span class="math display">\[1\leq a_k(1)\leq\cdots\leq a_k(p)=l_k,\\a_k(n+1)-a_k(n)\leq 1,\\\text{for }k=i,j,\text{ and }1\leq n\leq p-1\]</span></p></blockquote><p>ä¸Šè¿°å…¬å¼å¯èƒ½æ¯”è¾ƒæŠ½è±¡ï¼Œå…¶å®çœ‹äº†ä¸‹å›¾å°±ä¸éš¾ç†è§£ï¼š</p><p><img src="https://upload.wikimedia.org/wikipedia/commons/a/ab/Dynamic_time_warping.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>ç‰‡æ®µ<span class="math inline">\(s_i\)</span>ä¸­çš„æŸä¸ªç‚¹<span class="math inline">\(a\)</span>ï¼Œä¸ç‰‡æ®µ<span class="math inline">\(s_j\)</span>ä¸­çš„æŸä¸ªç‚¹<span class="math inline">\(b\)</span>å½¢æˆå¯¹åº”ï¼Œç„¶ååœ¨<span class="math inline">\(a\)</span>å’Œ<span class="math inline">\(b\)</span>ä¹‹é—´è¿ä¸€æ¡è™šæ‹Ÿçš„çº¿ï¼ˆä¸èƒ½ä¸å·²æœ‰çš„çº¿äº¤å‰ï¼‰ï¼Œä¸€ç›´è¿™ä¹ˆåšç›´åˆ°çŸ­çš„é‚£ä¸ªç‰‡æ®µä¸­çš„æ¯ä¸ªç‚¹éƒ½æ‰¾åˆ°å¯¹åº”ï¼Œå°±æ˜¯ä¸€ä¸ªåˆç†çš„<em>alignment</em>ã€‚å¯¹äºä¸¤ä¸ªé•¿åº¦ä¸ä¸€æ ·çš„ç‰‡æ®µ<span class="math inline">\(s_i\)</span>å’Œ<span class="math inline">\(s_j\)</span>ï¼Œä¼šæœ‰å¾ˆå¤šç§<em>alignment</em>ã€‚æˆ‘ä»¬æŠŠ<span class="math inline">\(s_i\)</span>å’Œ<span class="math inline">\(s_j\)</span>æ‰€æœ‰å¯èƒ½çš„<em>alignment</em>è®°ä¸º<span class="math inline">\(\mathcal{A}(s_i,s_j)\)</span>ã€‚åœ¨å®šä¹‰äº†<em>alignment</em>ä¹‹åå°±å¯ä»¥å®šä¹‰DTWäº†ã€‚DTW (<em>Dynamic Time Warping</em>) å®šä¹‰ä¸ºåœ¨ç»™å®šä¸€ä¸ªé¢„å®šä¹‰çš„è·ç¦»åº¦é‡<span class="math inline">\(\tau\)</span>å’Œæ‰€æœ‰å¯èƒ½çš„<em>alignment</em> <span class="math inline">\(\mathcal{A}(s_i,s_j)\)</span>çš„æƒ…å†µä¸‹ï¼Œæœ€å°çš„è·ç¦»<span class="math inline">\(\tau\)</span>ï¼š <span class="math display">\[d_\text{DTW}(s_i,s_j)=\min_{a\in\mathcal{A}(s_i,s_j)}\tau(s_i,s_j|a)\]</span></p><p>è¿›ä¸€æ­¥çš„ï¼Œå› ä¸ºæ—¶é—´åºåˆ—<span class="math inline">\(t\)</span>ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªç‰‡æ®µï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå­åºåˆ—<span class="math inline">\(s\)</span>å’Œæ—¶é—´åºåˆ—<span class="math inline">\(t\)</span>ä¹‹é—´çš„è·ç¦»åº¦é‡ï¼š <span class="math display">\[D(s,t)=\min_{1\leq k\leq m} d(s,s_k)\]</span></p><p>è¿™é‡Œ<span class="math inline">\(\boldsymbol s_k\)</span>ä¸ºæ—¶åº<span class="math inline">\(\boldsymbol t\)</span>åˆ†è§£æˆçš„ç‰‡æ®µã€‚ä¹‹åShapeletå¯ä»¥é€šè¿‡ç‰‡æ®µä¸æ—¶åºçš„è·ç¦»å®šä¹‰ä¸ºæœ€å…·æœ‰è¾¨è¯†åº¦çš„æœ‰ä»£è¡¨æ€§çš„ç‰‡æ®µï¼š</p><blockquote><p><strong>Definition 2 </strong> <strong>Shapelet. </strong>ä¸€ä¸ªShapelet <span class="math inline">\(\boldsymbol v\)</span>æ˜¯å¯¹äºç‰¹å®šç±»åˆ«æ—¶åºçš„æœ€å…·æœ‰ä»£è¡¨æ€§çš„ç‰‡æ®µã€‚è€ƒè™‘æ—¶åºåˆ†ç±»ä»»åŠ¡ï¼Œç»™å®šæ—¶åºé›†åˆ<span class="math inline">\(T\)</span>ï¼Œå¯ä»¥é€šè¿‡ä¸<span class="math inline">\(\boldsymbol v\)</span>ç›¸ä¼¼æˆ–ä¸ç›¸ä¼¼è€Œåˆ†æˆä¸¤ä¸ªå­é›†åˆï¼Œä¸<span class="math inline">\(\boldsymbol v\)</span>ç›¸ä¼¼çš„é›†åˆä¸<span class="math inline">\(\boldsymbol v\)</span>çš„è·ç¦»åº”å½“å°½é‡å°ï¼Œä¸<span class="math inline">\(\boldsymbol v\)</span>ä¸ç›¸ä¼¼çš„é›†åˆä¸<span class="math inline">\(\boldsymbol v\)</span>çš„è·ç¦»åº”å½“å°½é‡å¤§ï¼Œæ­¤æ—¶æŸå¤±å‡½æ•°å¯ä»¥å½¢å¼åŒ–ä¸ºï¼š <span class="math display">\[\mathcal L=-g(S_{pos}(\boldsymbol v,T),S_{neg}(\boldsymbol v,T))\]</span></p></blockquote><p><span class="math inline">\(\mathcal L\)</span>æè¿°äº†åœ¨shapelet <span class="math inline">\(\boldsymbol v\)</span>ä¸‹æ­£è´Ÿæ ·æœ¬é›†çš„ç›¸å¼‚æ€§ã€‚<span class="math inline">\(S_{*}(\boldsymbol v,T)\)</span>è¡¨ç¤ºç‰¹å®šæ—¶åºé›†åˆä¸<span class="math inline">\(\boldsymbol v\)</span>çš„è·ç¦»é›†åˆï¼Œ<span class="math inline">\(g(\cdot,\cdot)\)</span>ä¸ºæ¥å—ä¸¤ä¸ªæœ‰é™é›†åˆä¸ºè¾“å…¥çš„å¯å¾®å‡½æ•°ï¼Œå¹¶ä¸”èƒ½å¤Ÿåº¦é‡ä¸¤ä¸ªé›†åˆçš„è·ç¦»ã€‚</p><h1 id="framework">Framework</h1><p>æœ¬æ–‡ä¸»è¦æ˜¯æå‡ºäº†ä¸€ç§æ—¶é—´åºåˆ—è¡¨ç¤ºå­¦ä¹ æ–¹æ³•ã€‚åŸºäºShapeletåœ¨ä¸åŒçš„æ—¶é—´ç‰‡æ®µä¸Šçš„ä½œç”¨æ˜¯ä¸åŒçš„è§‚å¯Ÿï¼Œä½œè€…ä¸ºä¸åŒçš„æ—¶é—´ç‰‡æ®µèµ‹äºˆäº†ä¸åŒçš„Shapeletï¼Œè€Œä¸æ˜¯åƒä¼ ç»Ÿæ–¹æ³•ä¸€æ ·æ•´ä¸ªæ—¶åºå¯¹åº”ä¸€ä¸ªShapeletã€‚æ¥ç€åŸºäºè¿™äº›Shapeletä½œè€…æ„é€ äº†å›¾ï¼Œå¹¶é€šè¿‡å›¾åµŒå…¥å¾—åˆ°äº†åµŒå…¥å‘é‡ï¼Œä½œä¸ºæ—¶åºçš„è¡¨ç¤ºã€‚</p><p><img src="https://i.loli.net/2020/06/25/mKJH4c2EMAljavG.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><h2 id="time-aware-shapelet-extraction">Time-Aware Shapelet Extraction</h2><p>ç¬¬ä¸€æ­¥æ˜¯æ•è·Shapeletåœ¨æ—¶é—´ç»´åº¦ä¸Šçš„åŠ¨æ€å½±å“ã€‚æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå‚æ•°æ¥å®šé‡çš„æµ‹é‡shapeletåœ¨ä¸åŒæ—¶é—´ä¸Šçš„åŠ¨æ€æ€§ã€‚ç¬¬ä¸€ä¸ªæ˜¯å±€éƒ¨å› å­<span class="math inline">\(\boldsymbol w_n\)</span>ï¼Œç”¨æ¥æ§åˆ¶shapeletå†…éƒ¨<span class="math inline">\(n\)</span>ä¸ªå…ƒç´ çš„æƒé‡ï¼Œé‚£ä¹ˆshapelet <span class="math inline">\(\boldsymbol v\)</span>å’Œç‰‡æ®µ<span class="math inline">\(\boldsymbol s\)</span>çš„è·ç¦»ä¸ºï¼š <span class="math display">\[\begin{align}\hat{d}(\boldsymbol v,\boldsymbol s|\boldsymbol w) &amp;= \tau(\boldsymbol v,\boldsymbol s|\boldsymbol a^*,\boldsymbol w)\\&amp; = \left(\sum_{k=1}^{p}\boldsymbol w_{\boldsymbol a^*_1(k)}\cdot(\boldsymbol v_{\boldsymbol a^*_1(k)}-\boldsymbol s_{\boldsymbol a^*_2(k)})^2\right)^{\frac{1}{2}}\end{align}\]</span> å…¶ä¸­<span class="math inline">\(\boldsymbol a^*\)</span>ä¸ºDTWè·ç¦»ä¸‹çš„æœ€ä½³å¯¹é½ã€‚</p><p>ç¬¬äºŒä¸ªæ˜¯å…¨å±€å› ç´ <span class="math inline">\(\boldsymbol u_m\)</span>ï¼Œè¿™ä¸»è¦æ˜¯é€šè¿‡å¯¹ä¸åŒç‰‡æ®µ<span class="math inline">\(\boldsymbol s\)</span>æ–½åŠ ä¸åŒçš„æƒé‡å®ç°çš„ï¼Œäºæ˜¯shapelet <span class="math inline">\(\boldsymbol v\)</span>å’Œæ—¶é—´åºåˆ—<span class="math inline">\(\boldsymbol t\)</span>çš„è·ç¦»å¯ä»¥é‡å†™ä¸ºï¼š <span class="math display">\[\hat{D}(\boldsymbol v,\boldsymbol t|\boldsymbol w,\boldsymbol u)=\min_{1\leq k\leq m}\boldsymbol u_k\cdot\hat{d}(\boldsymbol v,\boldsymbol s_k|\boldsymbol w)\]</span> å…¶ä¸­<span class="math inline">\(\boldsymbol t\)</span>è¢«åˆ†å‰²ä¸º<span class="math inline">\(m\)</span>ä¸ªç‰‡æ®µï¼š<span class="math inline">\(\boldsymbol t=\{\boldsymbol s_1,\cdots,\boldsymbol s_m\}\)</span>ã€‚å¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œå…·ä½“çš„æ¥è¯´ï¼Œæˆ‘ä»¬å…ˆç”Ÿæˆä¸€å †Shapeletå€™é€‰é›†ï¼Œç„¶åé€šè¿‡æœ‰ç›‘ç£çš„æ–¹æ³•æ¥æŒ‘é€‰æœ€ä½³çš„Shapeletå’Œå¯¹åº”çš„å‚æ•°<span class="math inline">\(\boldsymbol w\)</span>å’Œ<span class="math inline">\(\boldsymbol u\)</span>ã€‚</p><p>è®¡ç®—shapeletå€™é€‰é›†çš„ç®—æ³•å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/srW4Shk79XBFL3U.png" srcset="/img/loading.gif" /></p><p>åœ¨è·å–äº†Shapeletå€™é€‰é›†åˆä¹‹åï¼Œæˆ‘ä»¬æœ‰å¸¦æœ‰æ ‡ç­¾çš„æ—¶åºé›†åˆ<span class="math inline">\(T\)</span>ï¼Œå¯¹äºæ¯ä¸€ä¸ªShapeletæˆ‘ä»¬å¯ä»¥ä¼˜åŒ–ï¼š</p><p><span class="math display">\[\hat{\mathcal L}=-g(S_{pos}(\boldsymbol v,T),S_{neg}(\boldsymbol v,T))+\lambda\parallel \boldsymbol w\parallel+\epsilon\parallel \boldsymbol u\parallel\]</span></p><p>æ¥è·å–æœ€ä¼˜çš„<span class="math inline">\(\hat{\boldsymbol w}\)</span>å’Œ<span class="math inline">\(\hat{\boldsymbol u}\)</span>ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æŒ‘é€‰å‡ºä½¿å¾—<span class="math inline">\(\hat{\mathcal L}\)</span>æœ€å°çš„å‰<span class="math inline">\(K\)</span>ä¸ªShapeletã€‚æ•´ä¸ªè¿‡ç¨‹çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/5b2TcjuBzlIFrPm.png" srcset="/img/loading.gif" /></p><h2 id="shapelet-evolution-graph">Shapelet Evolution Graph</h2><p>åœ¨è·å–äº†Shapeletä¹‹åï¼Œä¸ºäº†æ•è·Shapeletä¹‹é—´çš„ç›¸å…³æ€§ï¼Œæˆ‘ä»¬å®šä¹‰äº†<em>Shapelet Evolution Graph</em>ã€‚</p><blockquote><p><strong>Definition 3 Shapelet Evolution Graph. </strong> <em>Shapelet Evolution Graph</em>ä¸ºä¸€ä¸ªæœ‰å‘å¸¦æƒå›¾<span class="math inline">\(G=(V,E)\)</span>ï¼Œ<span class="math inline">\(V\)</span>ä¸º<span class="math inline">\(K\)</span>ä¸ªShapeletï¼Œæ¯æ¡å¸¦æœ‰æƒé‡<span class="math inline">\(w_{ij}\)</span>çš„è¾¹<span class="math inline">\(e_{ij}\in E\)</span>ä»£è¡¨ä¸¤ä¸ªShapelet <span class="math inline">\(\boldsymbol v_i \in V\)</span>å’Œ<span class="math inline">\(\boldsymbol v_j \in V\)</span>è¢«åˆ†é…ç»™ç›¸é‚»ç‰‡æ®µçš„æ¦‚ç‡ã€‚</p></blockquote><h3 id="graph-construction">Graph Construction</h3><p>è¿™é‡Œæ¥è¯´ä¸€ä¸‹ï¼Œå»ºå›¾çš„å…·ä½“è¿‡ç¨‹ã€‚é¦–å…ˆé¡¶ç‚¹ä¸ºShapeletï¼Œä¹‹åæ¥è¿›è¡Œè¾¹çš„æ„é€ ã€‚å¯¹äºæ¯ä¸€ä¸ªç‰‡æ®µ<span class="math inline">\(\boldsymbol s_i\)</span>ï¼Œæˆ‘ä»¬ä¼šè®¡ç®—Shapeletåˆ°è¯¥ç‰‡æ®µçš„è·ç¦»ï¼Œè·ç¦»è¶Šè¿‘ä»£è¡¨è¿™ä¸ªShapeletä¸ç‰‡æ®µè¶ŠåŒ¹é…ã€‚ä¹‹åä¼šè®¾å®šä¸€ä¸ªé˜ˆå€¼<span class="math inline">\(\delta\)</span>ï¼Œç„¶åå°†ä¸ç‰‡æ®µçš„è·ç¦»ä½äºè¿™ä¸ªé˜ˆå€¼çš„Shapeletåˆ†é…ç»™è¿™ä¸ªç‰‡æ®µï¼ˆä¸€ä¸ªShapeletå¯èƒ½ä¼šåˆ†é…ç»™å¤šä¸ªä¸åŒç‰‡æ®µï¼‰ã€‚å¯¹äº<span class="math inline">\(\boldsymbol s_i\)</span>çš„æ‰€æœ‰shapetletæˆ‘ä»¬è®°ä¸º<span class="math inline">\(\boldsymbol v_{i,*}\)</span>ï¼Œæˆ‘ä»¬ä¼šæŒ‰ç…§Shapeåˆ°ç‰‡æ®µçš„è·ç¦»è¿›è¡Œå½’ä¸€åŒ–ï¼š</p><p><span class="math display">\[\boldsymbol p_{i,j}=\frac{\max(\hat{d}_{i,*}(\boldsymbol v_{i,*},\boldsymbol s_i))-\hat{d}_{i,j}(\boldsymbol v_{i,j},\boldsymbol s_i)}{\max(\hat{d}_{i,*}(\boldsymbol v_{i,*},\boldsymbol s_i))-\min(\hat{d}_{i,*}(\boldsymbol v_{i,*},\boldsymbol s_i))}\]</span></p><p>å…¶ä¸­<span class="math inline">\(\hat{d}_{i,*}(\boldsymbol v_{i,*},\boldsymbol s_i)=\boldsymbol u_*[i]*\hat{d}(\boldsymbol v_{i,*},\boldsymbol s_i|\boldsymbol w_*)&lt;\delta\)</span>ã€‚è¿™æ ·å¯¹äºæ¯ä¸ªç‰‡æ®µ<span class="math inline">\(\boldsymbol s_i\)</span>æ‰€åˆ†é…çš„Shapeletå¯¹åº”çš„<span class="math inline">\(\boldsymbol p\)</span>ä¹‹å’Œä¼šç­‰äº<span class="math inline">\(1\)</span>ã€‚å¯¹æ¯ä¸€å¯¹ç›¸é‚»çš„ç‰‡æ®µ<span class="math inline">\((\boldsymbol s_i,\boldsymbol s_{i+1})\)</span>çš„Shapelet <span class="math inline">\(\boldsymbol v_{i,j}\)</span>å’Œ<span class="math inline">\(\boldsymbol v_{i+1,k}\)</span>ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€æ¡è¿æ¥<span class="math inline">\(\boldsymbol v_{*,j}\)</span>å’Œ<span class="math inline">\(\boldsymbol v_{*,k}\)</span>çš„è¾¹<span class="math inline">\(e_{j,k}\)</span>ï¼Œæƒé‡ä¸º<span class="math inline">\(\boldsymbol p_{i,j}\cdot\boldsymbol p_{i+1,k}\)</span>ã€‚æœ€åï¼Œæ‰€æœ‰é‡å¤çš„è¾¹ä¼šè¢«åˆå¹¶ã€‚</p><p><img src="qfxiao.me/img/image-20200706205238117.png" srcset="/img/loading.gif" style="zoom: 67%;" /></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå‡è®¾æœ‰ä¸¤ä¸ªç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µåˆ†é…äº†<span class="math inline">\(3\)</span>ä¸ªShapeletï¼ŒShapelet <span class="math inline">\(B\)</span>åœ¨ç‰‡æ®µ<span class="math inline">\(1\)</span>å¯¹åº”çš„æ¦‚ç‡æ˜¯<span class="math inline">\(p_{12}\)</span>ï¼ŒShapelet <span class="math inline">\(C\)</span>åœ¨ç‰‡æ®µ<span class="math inline">\(2\)</span>å¯¹åº”çš„æ¦‚ç‡æ˜¯<span class="math inline">\(p_{23}\)</span>ï¼Œé‚£ä¹ˆç”±äºç‰‡æ®µ<span class="math inline">\(1\)</span>å’Œ<span class="math inline">\(2\)</span>æ˜¯ç›¸é‚»ç‰‡æ®µï¼Œä¼šåœ¨<span class="math inline">\(B\)</span>å’Œ<span class="math inline">\(C\)</span>ä¹‹é—´è¿ä¸€æ¡è¾¹ï¼Œè¾¹çš„æƒé‡ä¸º<span class="math inline">\(p_{12}*p_{23}\)</span>ã€‚</p><p>å»ºå›¾çš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/aq9tGuApSbiC67c.png" srcset="/img/loading.gif" /></p><h2 id="representation-learning">Representation Learning</h2><p>ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨DeepWalkç®—æ³•æ¥è·å–è·å–æ¯ä¸ªç»“ç‚¹ï¼ˆShapeletï¼‰çš„åµŒå…¥è¡¨ç¤ºã€‚å¯¹äºæ—¶åº<span class="math inline">\(\boldsymbol t=\{\boldsymbol s_1,\cdots,\boldsymbol s_m\}\)</span>å³å¯¹åº”çš„Shapelet <span class="math inline">\(\{\boldsymbol v_{1,*},\cdots, v_{m,*}\}\)</span>å’Œå¯¹åº”çš„æ¦‚ç‡<span class="math inline">\(\{\boldsymbol p_{1,*},\cdots,\boldsymbol p_{m,*}\}\)</span>ï¼Œæ¯ä¸ªShaplet <span class="math inline">\(\boldsymbol v_{i,j}\)</span>çš„è¡¨ç¤ºè®°ä¸º<span class="math inline">\(\boldsymbol \mu(\boldsymbol v_{i,j})\)</span>ã€‚ç‰‡æ®µ<span class="math inline">\(\boldsymbol s_i\)</span>å¯¹åº”çš„åµŒå…¥å‘é‡ä¸ºå¯¹åº”çš„ShapeletåµŒå…¥å‘é‡ä¸å¯¹åº”çš„æ¦‚ç‡å€¼åŠ æƒæ±‚å’Œï¼š</p><p><span class="math display">\[\boldsymbol\Phi_i=\left(\sum_j p_{i,j}\cdot\boldsymbol \mu(\boldsymbol v_{i,j})\right),\space 1\leq i \leq m\]</span></p><p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/O5exTgsVLuRWQ42.png" srcset="/img/loading.gif" /></p><h1 id="experiments">Experiments</h1><h2 id="experimental-setup">Experimental Setup</h2><p>æ–‡ä¸­ç”¨äº†<em>Earthquakes</em> (EQS)ã€<em>WormsTwoClass</em> (WTC)ã€<em>Strawberry</em> (STB)ã€<em>Electricity Consumption Records</em> (ECR)å’Œ<em>Network Traffic Flow</em> (NTF) è¿™äº”ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­åä¸¤ä¸ªä¸ºä½œè€…è‡ªå·±æ”¶é›†çš„æ•°æ®é›†ã€‚äº”ä¸ªæ•°æ®é›†å¯¹åº”çš„ç»Ÿè®¡ä¿¡æ¯å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/zHjTKkUJB8fGwdi.png" srcset="/img/loading.gif" /></p><p>æ–‡ä¸­ä¸å¤šä¸ªBaselineè¿›è¡Œäº†æ¯”è¾ƒï¼ŒåŒ…æ‹¬:</p><ul><li><strong>Distance-based Models: </strong>æ–‡ä¸­ä½¿ç”¨äº†ä¸åŒçš„è·ç¦»åº¦é‡ä¸åŸºäº1-NNçš„æ¨¡å‹è¿›è¡Œç»„åˆï¼ŒåŒ…æ‹¬Euclidean Distance (ED)ã€Dynamic Time Warping (DTW)ã€Weighted DTW (WDTW)ã€Complexity-Invariant Distance (CID) å’Œ Derivative DTW (DDTW)ï¼›</li><li><strong>Feature-based Models: </strong>æ–‡ä¸­åˆ†åˆ«ä½¿ç”¨äº†æå–ç‰¹å¾ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ç­‰ï¼‰å’ŒåŸå§‹åºåˆ—æ¥è®­ç»ƒXGBoostã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜ä½¿ç”¨äº† Bag-of-Patterns (BoP)ã€Time Series Forest (TSF)ã€Elastic Ensembles (EE) å’Œ åŸºäºSAXçš„ Vector Space Model (SAXVSM)ï¼›</li><li><strong>Shapelet-based Models: </strong>è¿™éƒ¨åˆ†æ¨¡å‹åŒ…æ‹¬ Learn Time Series Shapelets (LS)ã€Fast Shapelets (FS)ã€å’Œ Learned Pattern Similarity (LPS)ï¼›</li><li><strong>Deep Learning Models: </strong>è¿™éƒ¨åˆ†æ¨¡å‹åŒ…æ‹¬MLPã€LSTMå’ŒVAEã€‚</li></ul><h2 id="comparison-results">Comparison Results</h2><p>å¯¹äºå‰ä¸‰ä¸ªå…¬å…±æ•°æ®é›†è¯„æµ‹æ ‡å‡†é‡‡ç”¨Accuracyï¼Œåä¸¤ä¸ªæ•°æ®é›†å› ä¸ºæ ·æœ¬ç±»æ¯”ä¸å‡è¡¡ï¼Œæ‰€ä»¥é‡‡ç”¨äº†Precisionã€Recallå’ŒF1ä½œä¸ºè¯„æµ‹æ ‡å‡†ã€‚ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/jxKFpDVXdmc5tbE.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>åœ¨EQSæ•°æ®é›†ä¸Šï¼ŒTime2Graphæ‰“è´¥äº†æ‰€æœ‰Baselineï¼Œè€Œåœ¨WTCå’ŒSTBè¿™ä¸¤ä¸ªæ•°æ®é›†ä¸Šä¹Ÿè¾¾åˆ°äº†è¾ƒå¥½çš„æ•ˆæœã€‚åœ¨ECRå’ŒNTFè¿™ä¸¤ä¸ªçœŸå®æ•°æ®é›†ä¸Šï¼ŒTime2Graphåœ¨F1ä¸Šæ‰“è´¥äº†æ‰€æœ‰Baselineã€‚</p><h2 id="parameter-analysis">Parameter Analysis</h2><p>æœ¬èŠ‚å¯¹Shapeletçš„æ•°é‡<span class="math inline">\(K\)</span>ã€åµŒå…¥ç»´åº¦<span class="math inline">\(B\)</span>å’Œç‰‡æ®µé•¿åº¦<span class="math inline">\(l\)</span>è¿›è¡Œäº†å‚æ•°åˆ†æã€‚ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/hPfqAvNnOlEBQuw.png" srcset="/img/loading.gif" /></p><h2 id="case-study-of-time-aware-shapelets">Case Study of Time-Aware Shapelets</h2><p>æœ¬èŠ‚ä½œè€…å¯¹æå‡ºçš„<em>Time-Aware Shapetlet</em>è¿›è¡Œäº†ç»†è‡´çš„æ¢ç©¶ã€‚ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ä¸åŒShapeletçš„åŒºåˆ†èƒ½åŠ›æ˜¯å¦ä¸åŒï¼Ÿä¸‹å›¾(a)é‡Œï¼Œä½œè€…åœ¨ä½¿ç”¨Shapeletè¿›è¡ŒäºŒåˆ†ç±»çš„ä»»åŠ¡ä¸­ï¼Œå°†ShapeletæŒ‰Lossï¼ˆå›¾ä¸­ç°è‰²çš„çº¿ï¼‰è¿›è¡Œæ’åºï¼Œå¹¶ä¸”ç»˜åˆ¶äº†å¯¹åº”çš„æ­£è´Ÿæ ·æœ¬è·ç¦»çš„KLæ•£åº¦ï¼ˆæ©˜çº¢è‰²çš„ç‚¹ï¼‰ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨Lossæ›²çº¿å’ŒKLæ•£åº¦å‘ˆåæ¯”å…³ç³»ã€‚KLæ•£åº¦è¶Šé«˜ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¯¥Shapeletçš„åŒºåˆ†åº¦è¶Šé«˜ï¼Œè¿™è¯´æ˜ä¸åŒShapeletçš„åŒºåˆ†åº¦çš„ç¡®ä¸åŒï¼Œå¹¶ä¸”è¿™ä¼šä¸æœ€ç»ˆæ•ˆæœç›´æ¥æŒ‚é’©ã€‚å›¾(b)å±•ç¤ºäº†ä¸åŒShapeletçš„å‡å€¼å’Œæ–¹å·®ï¼ˆåŸæ–‡æ²¡æœ‰è¯´æ¸…æ¥šæ˜¯ä»€ä¹ˆçš„å‡å€¼å’Œæ–¹å·®ï¼‰ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…å’Œæµè¡Œçš„Shapeletæå–ç®—æ³•<em>LS</em>è¿›è¡Œäº†æ¯”è¾ƒï¼Œå¦‚å›¾(c)å’Œå›¾(d)ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°å¯¹äºä¸åŒæ—¶é—´ï¼Œæœ¬æ–‡çš„ç®—æ³•æå–çš„Shapeletçš„ç¡®æ˜¯å…·æœ‰æ—¶é—´åŠ¨æ€æ€§çš„ã€‚</p><p><img src="https://i.loli.net/2020/06/25/ed5PwksC2l3OWE8.png" srcset="/img/loading.gif" /></p><h2 id="case-study-of-the-shapelet-evolution-graph">Case Study of the Shapelet Evolution Graph</h2><p>æœ¬èŠ‚ä½œè€…å¯¹<em>Shapelet Evolution Graph</em>è¿›è¡Œäº†ç»†è‡´çš„æ¢ç©¶ã€‚ä¸‹å›¾åˆ†åˆ«ä¸ºä¸€æœˆä»½å’Œä¸ƒæœˆä»½çš„<em>Shapelet Evolution Graph</em>ã€‚åœ¨ä¸€æœˆï¼Œ45å·Shapeletçš„åº¦è¾ƒå¤§ï¼Œè€Œä¸”å¯¹åº”çš„æ—¶é—´å› ç´ åœ¨ä¸€æœˆå’ŒäºŒæœˆä¹Ÿè¾ƒå¤§ï¼ˆå›¾ä¸­æ·±è‰²éƒ¨åˆ†ï¼‰ã€‚è¯´æ˜45å·Shapeletåœ¨ä¸€æœˆä»½å…·æœ‰ä»£è¡¨æ€§ã€‚è€Œåœ¨ä¸ƒæœˆï¼Œ45å·Shapeletçš„é‡è¦æ€§é™ä½ï¼Œè€Œ42å·Shapeletåœ¨ä¸ƒæœˆçš„é‡è¦æ€§å¾ˆé«˜ã€‚</p><p><img src="https://i.loli.net/2020/06/25/N2Vij8ODQaRuALJ.png" srcset="/img/loading.gif" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Time Series Modeling</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Shapelet</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>An Intuitive Guide to Manifolds</title>
    <link href="/2020/06/06/An-Intuitive-Guide-to-Manifolds/"/>
    <url>/2020/06/06/An-Intuitive-Guide-to-Manifolds/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ€è¿‘çœ‹çš„ä¸€äº›åŸºäºå¯†åº¦ä¼°è®¡çš„å¼‚å¸¸æ£€æµ‹æ–‡ç« ç”¨åˆ°äº†æµå½¢çš„çŸ¥è¯†ï¼Œä»¥å‰åªæ˜¯çŸ¥é“ä¸ªå¤§æ¦‚ï¼Œä½†æ²¡æœ‰ç³»ç»Ÿåœ°å­¦ä¹ ï¼Œæ‰€ä»¥è¿™é‡ŒæŠŠæµå½¢ç›¸å…³çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ä»‹ç»ä¸€ä¸‹ã€‚</p><h1 id="Manifold"><a href="#Manifold" class="headerlink" title="Manifold"></a>Manifold</h1><p>æµå½¢ä»ç›´è§‚ä¸Šè¿˜æ˜¯æ¯”è¾ƒå¥½ç†è§£çš„ï¼Œæ¯”å¦‚è¯´åœ°çƒçƒé¢å¯ä»¥çœ‹ä½œä¸€ä¸ªæµå½¢ï¼Œå¯¹ä¸€ä¸ªç«™åœ¨åœ°çƒä¸Šçš„äººæ¥è¯´ï¼Œä»–æ„Ÿå—åˆ°çš„â€œé‚»åŸŸâ€å¯èƒ½æ˜¯ä»–å‘¨å›´çš„ä¸€ç‰‡äºŒç»´å¹³é¢ç©ºé—´ï¼Œä½†åœ°çƒâ€œæµå½¢â€å´æ˜¯åµŒå…¥åœ¨ä¸‰ç»´ç©ºé—´ä¸­çš„ã€‚ä¸‹å›¾æ˜¯ä¸€äº›æµå½¢çš„ç¤ºä¾‹ï¼š</p><img src="https://i.loli.net/2020/06/24/nWIgzBa8pke1qh4.gif" srcset="/img/loading.gif" alt="Some examples of 2d manifolds" style="zoom:80%;" /><p>æµå½¢çš„ï¼ˆç¨å¾®ï¼‰å½¢å¼åŒ–å®šä¹‰ä¸ºï¼š</p><blockquote><p>ä¸€ä¸ª$n$ç»´æ‹“æ‰‘æµå½¢ï¼ˆ<strong>Topological Manifold</strong>ï¼‰$\mathcal{M}$æ˜¯ä¸€ä¸ªå¸¦æœ‰å’Œ$n$ç»´å®ç©ºé—´$\mathbb{R}^n$åŒèƒšï¼ˆHomeomorphicï¼‰çš„å¯æ•°åŸºï¼ˆCountable Baseï¼‰çš„æ‹“æ‰‘è±ªæ–¯é“å¤«ç©ºé—´ï¼ˆTopological Hausdorff Spaceï¼‰ã€‚å³å¯¹äº$\mathcal{M}$ä¸Šçš„ä»»æ„ä¸€ä¸ªç‚¹$p$éƒ½æœ‰ä¸€ä¸ªå¼€é‚»åŸŸï¼ˆOpen Neighborhoodï¼‰$U$å’Œä¸€ä¸ªåŒèƒšæ˜ å°„$\varphi:U\mapsto V$å°†$U$æ˜ å°„åˆ°å¼€é›†$V\in\mathbb{R}^n$ã€‚åŒæ—¶ï¼š</p><ul><li>æ˜ å°„$\varphi:U\mapsto V$è¢«ç§°ä¸º<strong>Chart</strong>æˆ–<strong>Coordinate System</strong>ï¼ˆä¸­æ–‡ï¼šåæ ‡å¡ï¼‰</li><li>é›†åˆ$U$ä¸ºè¯¥Chartçš„<strong>Domain</strong>æˆ–<strong>Local Coordinate Neighborhood</strong></li><li>ç‚¹$p\in U$çš„åƒï¼ˆImage)è®°ä¸º$\varphi(p)\in\mathbb{R}^n$ï¼Œè¢«ç§°ä¸º$p$åœ¨Chartä¸­çš„<strong>Coordinates</strong>æˆ–<strong>Local Coordinates</strong></li><li>Chartçš„é›†åˆ${\varphi_\alpha|\alpha\in\mathbb{N}}$ï¼Œå…¶ä¸­å®šä¹‰åŸŸ$U_\alpha$ï¼Œè¢«ç§°ä¸º$\mathcal{M}$çš„<strong>Atlas</strong>ï¼Œå¦‚æœ$\mathop{\cup}\limits_{\alpha\in\mathbb{N}}U_\alpha=\mathcal{M}$ï¼ˆä¸­æ–‡ï¼šå›¾å†Œï¼‰</li></ul></blockquote><p>è±ªæ–¯é“å¤«ç©ºé—´çš„å…·ä½“å®šä¹‰åœ¨è¿™é‡Œä¸é‡è¦ï¼Œåªè¦çŸ¥é“ä»–æ˜¯ä¸€ä¸ªæ‹“æ‰‘ç©ºé—´å³å¯ã€‚åæ ‡å¡æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µï¼Œå®ƒæä¾›äº†æµå½¢ä¸Šçš„ç‚¹$p$å¯¹åº”çš„å¼€é›†åˆ°æ¬§æ°ç©ºé—´$\mathbb R^n$çš„ä¸€ä¸ªæ˜ å°„ã€‚ä¸‹å›¾æ˜¯ä¸¤ä¸ªåæ ‡å¡çš„ç¤ºæ„å›¾ï¼š</p><img src="https://i.loli.net/2020/06/24/CHtb1xu65cyJjPZ.png" srcset="/img/loading.gif" style="zoom:80%;" /><p>å¯ä»¥çœ‹åˆ°åæ ‡å¡$\varphi_\alpha$å’Œ$\varphi_\beta$åˆ†åˆ«ä¸º$U_\alpha$å’Œ$U_\beta$åˆ°$\mathbb R^n$çš„æ˜ å°„ã€‚</p><h1 id="Tangent-Spaces"><a href="#Tangent-Spaces" class="headerlink" title="Tangent Spaces"></a>Tangent Spaces</h1><p>åˆ‡ç©ºé—´æ˜¯æµå½¢ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚æµå½¢$\mathcal{M}$åœ¨ç‚¹$x$çš„åˆ‡ç©ºé—´ï¼ˆ<strong>Tangent Space</strong>ï¼‰$\mathcal{T}_x\mathcal{M}$ï¼Œåˆ‡ç©ºé—´ç”±æ‰€æœ‰å¯èƒ½çš„åˆ‡å‘é‡ç»„æˆã€‚è€Œåˆ‡å‘é‡å¯ä»¥ç†è§£ä¸ºä½ åœ¨ä¸€ä¸ªæµå½¢ä¸Šæ²¿ç€ä¸€æ¡æ›²çº¿è¿åŠ¨ï¼Œç„¶ååœ¨æŸä¸€ä¸ªæ—¶åˆ»æ—¶çš„é€Ÿåº¦å¯¹åº”çš„å‘é‡ã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªåµŒå…¥åœ¨ä¸‰ç»´æ¬§æ°ç©ºé—´ä¸­çš„äºŒç»´æµå½¢åŠå…¶åœ¨ç‚¹$x$ä¸Šçš„åˆ‡ç©ºé—´ã€‚</p><img src="https://i.loli.net/2020/06/24/GCn7aiyfUc3t4EO.png" srcset="/img/loading.gif" alt="A tangent space example" style="zoom: 50%;" /><h2 id="Tangent-Spaces-as-the-Velocity-of-Curves"><a href="#Tangent-Spaces-as-the-Velocity-of-Curves" class="headerlink" title="Tangent Spaces as the Velocity of Curves"></a>Tangent Spaces as the Velocity of Curves</h2><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå…‰æ»‘æµå½¢$M$åŠç‚¹$p\in M$ï¼Œåæ ‡å¡$\varphi:U\rightarrow \mathbb R^n$ï¼Œå…¶ä¸­$U$ä¸º$M$çš„åŒ…å«$p$çš„å¼€é›†ã€‚è®¾$\gamma:t\rightarrow M$ï¼Œ$t\in[a,b]$ä¸ºç»è¿‡$p$çš„å…‰æ»‘æ›²çº¿ã€‚é€šè¿‡å åŠ $\gamma$å’Œ$\varphi$ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†$t$åˆ°$\mathbb R^n$çš„æ˜ å°„$\varphi\circ\gamma:t\rightarrow \mathbb R^n$ã€‚</p><p>è®°$\mathbf x=\varphi\circ\gamma(t)$ï¼Œè¿™å¯ä»¥è§£é‡Šä¸ºåœ¨æ—¶é—´$t$æ—¶æˆ‘ä»¬åœ¨æµå½¢$M$ä¸Šçš„ä½ç½®æˆ–è€…åæ ‡ï¼Œäºæ˜¯$t=t_0$æ—¶çš„é€Ÿåº¦$\mathbf v_p=\frac{\mathrm d\varphi\circ\gamma(t)}{\mathrm d t}|<em>{t=t_0}=\left[\frac{\mathrm d x^1(t)}{\mathrm d t},\cdots,\frac{\mathrm d x^n(t)}{\mathrm d t}\right]|</em>{t=t_0}$ï¼Œå…¶ä¸­$x^i(t)$ä¸ºåæ ‡$\mathbf x$çš„ç¬¬$i$ä¸ªåˆ†é‡ã€‚åœ¨ç‚¹$p$çš„åˆ‡å‘é‡ï¼ˆTangent Vectorï¼‰å³ä¸º$\mathbf v_p$ã€‚å¦‚æœæˆ‘ä»¬æŠŠæ‰€æœ‰å¯èƒ½çš„æ›²çº¿$\gamma$å¯¹åº”çš„åˆ‡å‘é‡ç»„åˆåˆ°ä¸€èµ·ï¼Œå°±å¾—åˆ°äº†åˆ‡ç©ºé—´ï¼ˆTangent Spaceï¼‰ï¼Œè®°ä¸º$T_pM$ã€‚</p><h2 id="Basis-of-the-Tangent-Space"><a href="#Basis-of-the-Tangent-Space" class="headerlink" title="Basis of the Tangent Space"></a>Basis of the Tangent Space</h2><p>å¯¹äºä¸Šé¢çš„åˆ‡ç©ºé—´çš„å®šä¹‰ï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šä¸çŸ¥é“çš„ä¸œè¥¿ã€‚å®é™…ä¸Šå…‰æœ‰ä¸Šé¢çš„å®šä¹‰æˆ‘ä»¬å‡ ä¹ä»€ä¹ˆéƒ½åšä¸äº†ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æ¥å®šä¹‰åˆ‡ç©ºé—´çš„åŸºã€‚</p><p>å‡è®¾ä¸€ä¸ªä»»æ„å‡½æ•°$f:M\rightarrow \mathbb R$å’Œå‚æ•°æ›²çº¿$\gamma:t\rightarrow M$ï¼Œåœ¨æ—¶é—´$t=t_0$ï¼Œ$f$çš„å˜åŒ–ç‡ä¸ºï¼š<br>$$<br>\begin{align}<br>\frac{\mathrm d f\circ\gamma(t)}{\mathrm d t}|<em>{t=t_0}&amp;=\frac{\mathrm d(f\circ\varphi^{-1}\circ\varphi\circ\gamma)(t)}{\mathrm d t}|</em>{t=t_0}\<br>&amp;=\frac{\mathrm d((f\circ \varphi^{-1})\circ(\varphi\circ\gamma))(t)}{\mathrm d t}|<em>{t=t_0}\<br>&amp;=\sum_i\frac{\partial(f\circ\varphi^{-1})(x)}{\partial x_i}|</em>{x=\varphi\circ\gamma(t_0)}\frac{\mathrm d(\varphi\circ\gamma)^i(t)}{\mathrm d t}|<em>{t=t_0}\<br>&amp;=\sum_i\frac{\partial(f\circ\varphi^{-1})(x)}{\partial x_i}|</em>{x=\varphi(p)}\frac{\mathrm d(\varphi\circ\gamma)^i(t)}{\mathrm d t}|_{t=t_0}\<br>&amp;=\sum_i (\text{basis for component }i)(\text{velocity of component }i\text{ w.r.t. to }\varphi)<br>\end{align}<br>$$</p><p>ç¬¬äºŒæ­¥åˆ°ç¬¬ä¸‰æ­¥ä¸ºé“¾å¼æ³•åˆ™çš„åº”ç”¨ï¼Œç¬¬ä¸‰æ­¥çš„ç¬¬äºŒé¡¹å°±æ˜¯æˆ‘ä»¬å‰é¢å®šä¹‰çš„åˆ‡å‘é‡çš„ç¬¬$i$é¡¹ï¼Œè€Œç¬¬ä¸€é¡¹$\frac{\partial(f\circ\varphi^{-1})(x)}{\partial x_i}$çš„è‡ªå˜é‡å·²ç»ä»æµå½¢ä¸Šçš„ç‚¹å˜æˆäº†$\mathbb R^n$ç©ºé—´ä¸Šçš„ç‚¹ã€‚å…ˆå°†$\frac{\partial(f\circ\varphi^{-1})(x)}{\partial x_i}$ç®€å†™ä¸ºï¼š</p><p>$$<br>\left(\frac{\partial}{\partial x^i}\right)_p(f)=\frac{\partial(f\circ\varphi^{-1})(\varphi(p))}{\partial x_i}<br>$$</p><p>å…¬å¼çš„å·¦ç«¯çœç•¥äº†åæ ‡å¡$\varphi$ï¼Œå› ä¸ºæˆ‘ä»¬å‡è®¾åœ¨ç‚¹$p$ï¼Œé»˜è®¤å­˜åœ¨ä¸€ä¸ªåæ ‡å¡ã€‚è¿™æ—¶$\left(\frac{\partial}{\partial x^i}\right)_p(f)$å¯ä»¥ç«‹å³ä¸ºä¸€ä¸ªOperatorï¼Œç»™å®šä»»æ„ä¸€ä¸ªå‡½æ•°$f$ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªè¾“å‡ºã€‚</p><p>å¯¹äºæ¯ä¸€ä¸ªåˆ‡å‘é‡$v\in T_pM$æˆ‘ä»¬æœ‰ï¼š<br>$$<br>\begin{align}<br>\mathbf v &amp;= \sum_{i=1}^n v(x^i)\cdot\left(\frac{\partial}{\partial x^i}\right)<em>p\<br>&amp; =\sum</em>{i=1}^n\frac{\mathrm d(\varphi\circ\gamma)^i(t)}{\mathrm d t}|_{t=t_0}\cdot\left(\frac{\partial}{\partial x^i}\right)_p<br>\end{align}<br>$$</p><p>è¿™è¯´æ˜åˆ‡ç©ºé—´çš„å°±æ˜¯ä¸€ç»„å¾®åˆ†ç¬¦å·</p><h2 id="Change-of-Basis-for-Tangent-Vector"><a href="#Change-of-Basis-for-Tangent-Vector" class="headerlink" title="Change of Basis for Tangent Vector"></a>Change of Basis for Tangent Vector</h2><p>$$<br>\varphi(p)=(x^1(p),\cdots,x^d(p))\<br>\vartheta(p)=(y^1(p),\cdots,y^d(p))<br>$$</p><p>å‡è®¾$p$ä¸ºä¸¤ä¸ªåæ ‡å¡å®šä¹‰åŸŸçš„é‡å éƒ¨åˆ†</p><p>$\partial_xf=\frac{\partial f}{\partial x}$<br>$$<br>\begin{align<em>}<br>{\bf v} f &amp;= v(x^i) \cdot \Big(\frac{\partial}{\partial x^i}\Big)<em>p f \<br>  &amp;= v(x^i) \cdot \partial</em>{x^i} (f \circ \varphi^{-1})(\varphi(p)) &amp;&amp; \text{by definition} \<br>  &amp;= v(x^i) \cdot \partial_{x^i} (f \circ \vartheta^{-1} \circ \vartheta \circ \varphi^{-1})(\varphi(p)) &amp;&amp; \text{introduce } \vartheta \text{ with identity trick}\<br>  &amp;= v(x^i) \cdot \partial_{x^i} ((f \circ \vartheta^{-1}) \circ (\vartheta \circ \varphi^{-1}))(\varphi(p)) \<br>  &amp;= v(x^i) \cdot<br>    \partial_{x^i} (\vartheta \circ \varphi^{-1})^j(\varphi(p))<br>    \cdot<br>    \partial_{y^j} (f \circ \vartheta^{-1})(\vartheta \circ \varphi^{-1}(\varphi(p)))<br>    &amp;&amp; \text{chain rule} \<br>  &amp;= v(x^i) \cdot<br>    \partial_{x^i} (\vartheta \circ \varphi^{-1})^j(\varphi(p))<br>    \cdot<br>    \partial_{y^j} (f \circ \vartheta^{-1})(\vartheta(p))<br>    &amp;&amp; \text{simplifying} \<br>  &amp;= v(x^i) \cdot<br>    \partial_{x^i} (\vartheta \circ \varphi^{-1})^j(\varphi(p))<br>    \cdot<br>    \Big(\frac{\partial}{\partial y^j}\Big)<em>p f<br>    &amp;&amp; \text{by definition} \<br>  &amp;= v(x^i) \cdot<br>    \frac{\partial y^j}{\partial x^i}\big|</em>{x=\varphi(p)}<br>    \cdot<br>    \Big(\frac{\partial}{\partial y^j}\Big)_p f<br>    &amp;&amp; \text{since }y^j(x) = y^j(\varphi^{-1}(\varphi(x))) \<br>  &amp;= v(y^j) \cdot \Big(\frac{\partial}{\partial y^j}\Big)_p f \<br>\tag{12}<br>\end{align</em>}<br>$$<br>çŸ©é˜µè¡¨ç¤º<br>$$<br>\begin{align<em>}<br>{\bf v(y)}<br>= \begin{bmatrix} v(y^1) \ \ldots \ v(y^d) \end{bmatrix}<br>= {\bf J_y} {\bf v(x)}<br>= \begin{bmatrix}<br>    \frac{\partial y^1}{\partial x^1}\big|<em>{x=\varphi(p)}<br>      &amp; \cdots<br>      &amp; \frac{\partial y^1}{\partial x^d}\big|</em>{x=\varphi(p)} \<br>    \vdots &amp; \ddots &amp; \vdots \<br>    \frac{\partial y^d}{\partial x^1}\big|<em>{x=\varphi(p)}<br>      &amp; \cdots<br>      &amp; \frac{\partial y^d}{\partial x^d}\big|</em>{x=\varphi(p)}<br>  \end{bmatrix}<br>  \begin{bmatrix} v(x^1) \ \ldots \ v(x^d) \end{bmatrix}\<br>\tag{13}<br>\end{align</em>}<br>$$</p><h2 id="An-Example-of-Tangent-Space"><a href="#An-Example-of-Tangent-Space" class="headerlink" title="An Example of Tangent Space"></a>An Example of Tangent Space</h2><img src="https://i.loli.net/2020/06/24/OmCZaENuQYeiw5k.png" srcset="/img/loading.gif" style="zoom: 33%;" /><h1 id="Riemannian-Manifolds"><a href="#Riemannian-Manifolds" class="headerlink" title="Riemannian Manifolds"></a>Riemannian Manifolds</h1><h3 id="Riemannian-Metric"><a href="#Riemannian-Metric" class="headerlink" title="Riemannian Metric"></a>Riemannian Metric</h3><p><strong>Riemannian metric</strong><br>$$<br>g_p:T_p M\times T_pM\rightarrow\mathbb R, \space p\in M<br>$$</p><h3 id="Induced-Metric-Tensors"><a href="#Induced-Metric-Tensors" class="headerlink" title="Induced Metric Tensors"></a>Induced Metric Tensors</h3><p>æµå½¢<br>$$<br>\begin{align<em>}<br>{\bf v} &amp;= v(y^i) \cdot \Big(\frac{\partial}{\partial y^i}\Big)<em>p \<br>        &amp;= v(y^i) \cdot<br>            \frac{\partial (â–¡ \circ \varphi^{-1})}{\partial y_i}\Big|</em>{y=\varphi(p)} \<br>        &amp;= v(y^i) \cdot<br>            \frac{\partial x^j}{\partial y^i}\Big|<em>{y=\varphi(p)}<br>            \frac{\partial â–¡}{\partial x^j}\Big|</em>{x=p} \<br>        &amp;= v(y^i) \cdot<br>            \frac{\partial x^j}{\partial y^i}\Big|_{y=\varphi(p)}<br>            \Big(\frac{\partial}{\partial x^j}\Big)_p \<br>        &amp;= \frac{d \gamma^j(t)}{dt} \cdot {\bf e^j} \<br>        \tag{23}<br>\end{align</em>}<br>$$<br>å‘é‡<br>$$<br>\begin{align<em>}<br>g_M({\bf v_M},{\bf w_M}) &amp;= {\bf v_M} \cdot {\bf w_M} &amp;&amp; \text{Euclidean inner product}\<br>&amp;= \begin{bmatrix}<br>      \sum_{i=1}^d v(y^i) \cdot \frac{\partial x^1}{\partial y^i}\Big|<em>{y=\varphi(p)}<br>    &amp; \ldots<br>    &amp; \sum</em>{i=1}^d v(y^i) \cdot \frac{\partial x^n}{\partial y^i}\Big|<em>{y=\varphi(p)}<br>\end{bmatrix}\cdot\<br>&amp;\space\space\space\space\begin{bmatrix}<br>      \sum</em>{i=1}^d w(y^i) \cdot \frac{\partial x^1}{\partial y^i}\Big|<em>{y=\varphi(p)} \<br>    \ldots \<br>    \sum</em>{i=1}^d w(y^i) \cdot \frac{\partial x^n}{\partial y^i}\Big|<em>{y=\varphi(p)}<br>\end{bmatrix} &amp;&amp; \text{Subbing in Equation 23} \<br>&amp;=  \begin{bmatrix} v(y^1) &amp; \ldots &amp; v(y^d) \end{bmatrix}<br>    \begin{bmatrix}<br>        \frac{\partial x^1}{\partial y^1}\Big|</em>{y=\varphi(p)}<br>        &amp; \ldots<br>        &amp; \frac{\partial x^n}{\partial y^1}\Big|<em>{y=\varphi(p)} \<br>        \cdots<br>        &amp; \ddots<br>        &amp; \cdots \<br>        \frac{\partial x^1}{\partial y^d}\Big|</em>{y=\varphi(p)}<br>        &amp; \ldots<br>        &amp; \frac{\partial x^n}{\partial y^d}\Big|<em>{y=\varphi(p)} \<br>    \end{bmatrix}\cdot\<br>    &amp;\space\space\space\space\begin{bmatrix}<br>        \frac{\partial x^1}{\partial y^1}\Big|</em>{y=\varphi(p)}<br>        &amp; \ldots<br>        &amp; \frac{\partial x^1}{\partial y^d}\Big|<em>{y=\varphi(p)} \<br>        \cdots<br>        &amp; \ddots<br>        &amp; \cdots \<br>        \frac{\partial x^n}{\partial y^1}\Big|</em>{y=\varphi(p)}<br>        &amp; \ldots<br>        &amp; \frac{\partial x^n}{\partial y^d}\Big|<em>{y=\varphi(p)} \<br>    \end{bmatrix}<br>   \begin{bmatrix} w(y^1) \ \ldots \ w(y^d) \end{bmatrix} \<br>\tag{24}<br>&amp;= {\bf v_U}^T{\bf J</em>{x}}^T{\bf J_{x}}{\bf w_U} \<br>&amp;= g({\bf v_U}, {\bf w_U})<br>\end{align</em>}<br>$$</p><p>$$<br>g_U = {\bf J_{x}}^T{\bf J_{x}}<br>$$</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li><p>Manifolds: A Gentle Introduction <a href="http://bjlkeng.github.io/posts/manifolds/" target="_blank" rel="noopener">Link</a></p></li><li><p>Wikipedia: Manifold <a href="https://en.wikipedia.org/wiki/Manifold" target="_blank" rel="noopener">Link</a></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Tutorial</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Manifold</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Generative Probabilistic Novelty Detection with Adversarial Autoencoders</title>
    <link href="/2020/06/06/Generative-Probabilistic-Novelty-Detection-with-Adversarial-Autoencoders/"/>
    <url>/2020/06/06/Generative-Probabilistic-Novelty-Detection-with-Adversarial-Autoencoders/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>è¿™ç¯‡æ–‡ç« ä»‹ç»äº†ä¸€ç§åŸºäºæ¦‚ç‡åˆ†å¸ƒçš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯å‡è®¾æ­£å¸¸æ ·æœ¬æœä»å®šä¹‰åœ¨æµå½¢$M$ä¸Šçš„åˆ†å¸ƒï¼Œè€Œå¯¹äºä»»æ„ä¸€ç‚¹$\bar x$ï¼Œé€šè¿‡æŠ•å½±åˆ°æµå½¢$M$ä¸Š$x^\parallel$ï¼Œå¯ä»¥åˆ†è§£ä¸ºå¹³è¡Œäºåˆ‡ç©ºé—´çš„éƒ¨åˆ†$x^\parallel$å’Œæ­£äº¤ä¸åˆ‡ç©ºé—´çš„éƒ¨åˆ†$x^\bot$ã€‚åŸå§‹çš„åæ ‡$\bar x$è¢«è½¬æ¢åˆ°$x^\parallel$å±€éƒ¨åæ ‡ç³»ä¸­ï¼Œç„¶åä¼¼ç„¶é€šè¿‡è½¬æ¢åçš„åæ ‡ç³»è¿›è¡Œè®¡ç®—ã€‚</p><h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Generative-Probabilistic-Novelty-Detection"><a href="#Generative-Probabilistic-Novelty-Detection" class="headerlink" title="Generative Probabilistic Novelty Detection"></a>Generative Probabilistic Novelty Detection</h2><p>æˆ‘ä»¬å‡è®¾è®­ç»ƒæ•°æ®$x_1,\cdots,x_N$ï¼Œå…¶ä¸­$x_i\in\mathbb{R}^m$ï¼Œä»ä¸€ä¸ªåˆ†å¸ƒé‡‡æ ·çš„æ¥ï¼Œå¹¶å¸¦æœ‰éšæœºå™ªå£°$\xi$ï¼š<br>$$<br>x_i=f(z_i)+\xi_i, \space\space\space i=1,\cdots,N<br>$$<br>å…¶ä¸­$z_i\in\mathbb{R}^n$ï¼Œ$f:\Omega\mapsto\mathbb{R}^m$å®šä¹‰äº†ä¸€ä¸ª$n$ç»´å¸¦å‚æµå½¢$\mathcal{M}\equiv f(\Omega)$ã€‚æ³¨æ„è¿™é‡Œå™ªå£°çš„åŠ å…¥ä½¿å¾—æ ·æœ¬çš„å€¼åŸŸæ‰©å±•åˆ°äº†æ•´ä¸ªå®æ•°ç©ºé—´ã€‚åŒæ—¶å‡è®¾å­˜åœ¨$g:\mathbb{R}^m\mapsto\mathbb{R}^n$ï¼Œå¯¹ä»»æ„$x\in\mathcal{M}$éƒ½æœ‰$f(g(x))=x$ã€‚$f$å’Œ$g$åé¢ä¼šé€šè¿‡ç¥ç»ç½‘ç»œå®ç°ã€‚</p><p>å¯¹äºä¸€ä¸ªæµ‹è¯•æ ·æœ¬$\bar{x}\in\mathbb{R}^m$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å…¶åœ¨$M$ä¸Šçš„æŠ•å½±ï¼Œè¿™æ˜¯é€šè¿‡é€†å˜æ¢$\bar z = g(\bar x)$å¾—åˆ°å¯¹åº”$z$çš„ç„¶åå†é€šè¿‡$\bar x^{\parallel}=f(\bar z)$å¾—åˆ°ã€‚$f$åœ¨$\bar z$çš„ä¸€é˜¶æ³°å‹’å±•å¼€ä¸ºï¼š<br>$$<br>f(z)=f(\bar z)+J_f(\bar z)(z-\bar z)+O(\parallel z-\bar z\parallel ^2)<br>$$<br><img src="https://i.loli.net/2020/06/25/oi9xKMO3ID7jANJ.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><p>å…¶ä¸­$J_f(\bar z)$ä¸º$f$åœ¨ç‚¹$\bar z$çš„é›…å„æ¯”çŸ©é˜µã€‚$\mathcal T=\text{span}(J_f(\bar z))$ä»£è¡¨ç‚¹$\bar z$å¤„ç”±$J_f(\bar z)$çš„$n$ä¸ªç‹¬ç«‹å‘é‡ç»„æˆçš„åˆ‡ç©ºé—´ã€‚é€šè¿‡å¯¹$J_f(\bar z)$è¿›è¡Œå¥‡å¼‚å€¼åˆ†è§£$J_f(\bar z)=U^\parallel SV^\top$ã€‚<br>$$<br>\bar w=U^\top\bar x=\left[\begin{matrix}U^{\parallel^\top}\bar x\ U^{\bot^\top}\bar x\end{matrix}\right]=\left[\begin{matrix}\bar w^\parallel\ \bar w^\bot\end{matrix}\right]<br>$$<br>åæ ‡$\bar w$å¯ä»¥åˆ†è§£ä¸ºå¹³è¡Œäº$\mathcal T$å’Œæ­£äº¤äº$\mathcal T$ä¸¤éƒ¨åˆ†ã€‚</p><p>å®šä¹‰åœ¨æ–½åŠ å˜æ¢å‰åçš„åæ ‡ç³»ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒ$p_X(x)$å’Œ$p_W(w)$æ˜¯ç­‰ä»·çš„ï¼Œä¸è¿‡å¯¹äº$p_W(w)$ï¼Œæˆ‘ä»¬å‡è®¾å¹³è¡Œéƒ¨åˆ†å’Œæ­£äº¤éƒ¨åˆ†æ˜¯ç‹¬ç«‹çš„ï¼Œå³ï¼š<br>$$<br>p_X(x)=p_W(w)=p_W(w^\parallel,w^\bot)=p_{W^\parallel}(w^\parallel)p_{W^\bot}(w^\bot)<br>$$<br>è¿™ä¸€å‡è®¾çš„ä¾æ®æ˜¯éšæœºå™ªå£°éƒ¨åˆ†å‡è®¾ä¸»è¦æ˜¯å¾€æµå½¢ä¹‹å¤–åç¦»çš„ï¼Œå³ä¸$\mathcal T$æ­£äº¤ï¼Œæ‰€ä»¥$W^\bot$ä¸»è¦æ˜¯åæ˜ å™ªå£°çš„éƒ¨åˆ†ã€‚è€Œå™ªå£°ä¸æ ·æœ¬åˆ†å¸ƒç›¸ç‹¬ç«‹çš„å‡è®¾æ˜¯åˆç†çš„ã€‚äºæ˜¯ï¼Œå¼‚å¸¸åˆ†æ•°å¯ä»¥å®šä¹‰ä¸ºï¼š<br>$$<br>p_X(\bar x)=p_{W^\parallel}(\bar w^\parallel)p_{W^\bot}(\bar w^\bot)=\begin{cases}\geq \gamma \Rightarrow \text{Inlier}\&lt;\gamma\Rightarrow\text{Outlier}\end{cases}<br>$$</p><h2 id="Computing-the-Distribution-of-Data-Samples"><a href="#Computing-the-Distribution-of-Data-Samples" class="headerlink" title="Computing the Distribution of Data Samples"></a>Computing the Distribution of Data Samples</h2><p>ä¸Šé¢çš„å¼‚å¸¸åˆ†æ•°éœ€è¦è®¡ç®—$p_{W^\parallel}(\bar w^\parallel)$å’Œ$p_{W^\bot}(\bar w^\bot)$ã€‚ç»™å®šæµ‹è¯•æ ·æœ¬$\bar x$ï¼ŒæŠ•å½±åˆ°æµå½¢$\bar x^\parallel=f(g(\bar x))$ã€‚$\bar w^\parallel$å¯ä»¥é‡å†™ä¸º$\bar w^\parallel=U^{\parallel^\top}\bar x=U^{\parallel^\top}(\bar x-\bar x^{\parallel})+U^{\parallel^\top}\bar x^\parallel=U^{\parallel^\top}\bar x^\parallel$ï¼Œå³æˆ‘ä»¬å‡è®¾$U^{\parallel^\top}(\bar x-\bar x^\parallel)\approx 0$ã€‚äºæ˜¯æœ‰$w^\parallel(z)=U^{\parallel^\top}f(\bar z)+SV^\top(z-\bar z)+O(\parallel z-\bar z\parallel^2)$ã€‚</p><p>å¦‚æœ$Z$ä¸ºå®šä¹‰åœ¨æµå½¢ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒï¼Œé‚£ä¹ˆï¼š<br>$$<br>p_{W^\parallel}(w^\parallel)=|\text{det}S^{-1}|p_Z(z)<br>$$<br>$p_{W^\bot}(w^\bot)$ç”±åŠå¾„ä¸º$\parallel w^\bot\parallel$çš„è¶…çƒä½“$\mathcal S^{m-n-1}$æ¥è¿›è¡Œä¼°è®¡ï¼š<br>$$<br>p_{W^\bot}(w^\bot)\approx\frac{\Gamma(\frac{m-n}{2})}{2\pi^{\frac{m-n}{2}}\parallel w^\bot\parallel^{m-n}}p_{\parallel W^\bot\parallel}(\parallel w^\bot\parallel)<br>$$</p><p>å…¶ä¸­$\Gamma(\cdot)$ä»£è¡¨Gammaå‡½æ•°ã€‚</p><h2 id="Manifold-Learning-with-Adversarial-Autoencoders"><a href="#Manifold-Learning-with-Adversarial-Autoencoders" class="headerlink" title="Manifold Learning with Adversarial Autoencoders"></a>Manifold Learning with Adversarial Autoencoders</h2><p>ä¸ºäº†å­¦ä¹ æ˜ å°„$f$å’Œ$g$ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†AAEæ¡†æ¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/sQhO3D4gKJqBPXv.png" srcset="/img/loading.gif" style="zoom: 67%;" /><p>é™¤äº†å¸¸è§„çš„AAEå¤–ï¼Œæˆ‘ä»¬è¿˜ä¸º$x$æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„åˆ¤åˆ«å™¨ã€‚</p><h3 id="Adversarial-Losses"><a href="#Adversarial-Losses" class="headerlink" title="Adversarial Losses"></a>Adversarial Losses</h3><p>å¯¹äºéšå˜é‡$z$ï¼Œå¯¹æŠ—æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>\mathcal L_{adv-d_z}(x,g,D_z)=E[\log(D_z(\mathcal N(0,1)))]+E[\log(1-D_z(g(x)))]<br>$$<br>å¯¹äºæ ·æœ¬$x$ï¼Œå¯¹æŠ—æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>\mathcal L_{adv-d_x}(x,D_x,f)=E[\log(D_x(x))]+E[\log(1-D_x(f(\mathcal N(0,1))))]<br>$$</p><h3 id="Autoencoder-Loss"><a href="#Autoencoder-Loss" class="headerlink" title="Autoencoder Loss"></a>Autoencoder Loss</h3><p>$$<br>\mathcal L_\text{error}(x,g,f)=-E_z[\log(p(f(g(x))|x))]<br>$$</p><h3 id="Full-Objective"><a href="#Full-Objective" class="headerlink" title="Full Objective"></a>Full Objective</h3><p>$$<br>\mathcal L(x,g,D_z,D_x,f)=\mathcal L_{adv-d_z}+\mathcal L_{adv-d_x}+\lambda \mathcal L_\text{error}<br>$$</p><p>ä¸‹å›¾ä¸ºæ¨¡å‹é‡æ„çš„ä¾‹å­ï¼š</p><img src="https://i.loli.net/2020/06/25/i7ytlgjoIbYV6uF.png" srcset="/img/loading.gif" style="zoom:67%;" /><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Datasets"><a href="#Datasets" class="headerlink" title="Datasets"></a>Datasets</h2><ul><li>*<em>MNIST. *</em> æ‰‹å†Œæ•°å­—è¯†åˆ«æ•°æ®é›†ã€‚</li><li>*<em>The Coil-100. *</em>åŒ…å«7200å¼ 100ä¸ªä¸åŒç‰©ä½“çš„ä¸åŒè§’åº¦çš„å›¾ç‰‡ã€‚</li><li>*<em>Fashion-MNIST. *</em> æ‰‹å†Œæ•°å­—è¯†åˆ«æ•°æ®é›†å½©è‰²ç‰ˆã€‚</li><li>*<em>Others. *</em> å‰ä¸‰ä¸ªæ•°æ®é›†éƒ½æ˜¯é‡‡ç”¨ä¸€ä¸ªç±»ä½œä¸ºinlierï¼Œè€Œå…¶ä»–ç±»ä½œä¸ºoutlierã€‚åœ¨è¿™ä¸€è®¾ç½®ä¸­inlieré‡‡æ ·è‡ªæ•°æ®é›†CIFAR-10(CIFAR-100)ï¼Œè€Œoutlieré‡‡æ ·è‡ªTinyImageNetã€LSUNå’ŒiSUNã€‚</li></ul><h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><h3 id="MNIST-Dataset"><a href="#MNIST-Dataset" class="headerlink" title="MNIST Dataset"></a>MNIST Dataset</h3><p><img src="https://i.loli.net/2020/06/25/5a71oidmK2ZGLyh.png" srcset="/img/loading.gif" alt=""></p><img src="https://i.loli.net/2020/06/25/4lcGeHDrhbdKN5W.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Coil-100-Dataset"><a href="#Coil-100-Dataset" class="headerlink" title="Coil-100 Dataset"></a>Coil-100 Dataset</h3><img src="https://i.loli.net/2020/06/25/ofVGBgR7a3WmyvU.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Fashion-MNIST"><a href="#Fashion-MNIST" class="headerlink" title="Fashion-MNIST"></a>Fashion-MNIST</h3><p><img src="https://i.loli.net/2020/06/25/avURoBw6ny8SIEq.png" srcset="/img/loading.gif" alt=""></p><h3 id="CIFAR-10-CIFAR-100"><a href="#CIFAR-10-CIFAR-100" class="headerlink" title="CIFAR-10 (CIFAR-100)"></a>CIFAR-10 (CIFAR-100)</h3><img src="https://i.loli.net/2020/06/25/piteKy1m9kvQ6EU.png" srcset="/img/loading.gif" style="zoom: 67%;" /><h3 id="Ablation"><a href="#Ablation" class="headerlink" title="Ablation"></a>Ablation</h3><p><img src="https://i.loli.net/2020/06/25/xgni9wBtYkheGZq.png" srcset="/img/loading.gif" alt=""></p><img src="https://i.loli.net/2020/06/25/idhqkCbAKvzMt68.png" srcset="/img/loading.gif" style="zoom:67%;" />]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>GAN</tag>
      
      <tag>Novelty Detection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Estimate the Implicit Likelihoods of GANs with Application to Anomaly Detection</title>
    <link href="/2020/06/06/Estimate-the-Implicit-Likelihoods-of-GANs-with-Application-to-Anomaly-Detection/"/>
    <url>/2020/06/06/Estimate-the-Implicit-Likelihoods-of-GANs-with-Application-to-Anomaly-Detection/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><h1 id="Preliminaries"><a href="#Preliminaries" class="headerlink" title="Preliminaries"></a>Preliminaries</h1><h2 id="Flow-based-Models-Recap"><a href="#Flow-based-Models-Recap" class="headerlink" title="Flow-based Models Recap"></a>Flow-based Models Recap</h2><h3 id="Jacobian-Matrix-and-Determinant"><a href="#Jacobian-Matrix-and-Determinant" class="headerlink" title="Jacobian Matrix and Determinant"></a>Jacobian Matrix and Determinant</h3><p>è®¾å‡½æ•°$f:\mathbb{R}^n\mapsto\mathbb{R}^m$ï¼Œç”±$f$çš„ä¸€é˜¶åå¯¼æ•°ç»„æˆçš„çŸ©é˜µå«åšJacobiançŸ©é˜µï¼š<br>$$<br>\mathbf J=\left[<br>\begin{matrix}<br>\frac{\partial f_1}{\partial x_1} &amp;\cdots &amp;\frac{\partial f_1}{\partial x_n}\<br>\vdots &amp;\ddots &amp;\vdots\<br>\frac{\partial f_m}{\partial x_1}&amp; \dots&amp; \frac{\partial f_m}{\partial x_n}<br>\end{matrix}<br>\right]<br>$$</p><h3 id="Change-of-Variable-Theorem"><a href="#Change-of-Variable-Theorem" class="headerlink" title="Change of Variable Theorem"></a>Change of Variable Theorem</h3><p>ç»™å®šå·²çŸ¥æ¦‚ç‡åˆ†å¸ƒçš„éšæœºå˜é‡$z\sim\pi(z)$ï¼Œæ–°éšæœºå˜é‡ç”±å¯é€†æ˜ å°„$f$ç»™å‡º$x=f(z)$ï¼Œ$z=f^{-1}(x)$ã€‚ç”±äºï¼š<br>$$<br>\int p(x)\mathrm{d}x=\int \pi(z)\mathrm d z=1<br>$$<br>æ‰€ä»¥$p(x)$å¯ä»¥ç”±ä¸‹å¼å¾—åˆ°ï¼š<br>$$<br>p(x)=\pi(z)\left|\frac{\mathrm d z}{\mathrm d x}\right|=\pi(f^{-1}(x))\left|\frac{\mathrm d f^{-1}}{\mathrm d x}\right|=\pi(f^{-1}(x))|(f^{-1})^\prime(x)|<br>$$<br>$\frac{\mathrm d f^{-1}}{\mathrm d x}$ç›¸å½“äºå¯¹é€†å‡½æ•°$f^{-1}$æ±‚å¯¼ï¼Œè€Œ$z=f^{-1}(x)$ã€‚</p><p>å¯¹äºå¤šå˜é‡çš„æƒ…å†µï¼š<br>$$<br>\mathbf z\sim \pi(\mathbf z), \mathbf x=f(\mathbf z),\mathbf z = f^{-1}(\mathbf x)\<br>p(\mathbf x) = \pi(\mathbf z)\left|\text{det}\frac{\mathrm d \mathbf z}{\mathrm d \mathbf x}\right|= \pi(f^{-1}(\mathbf x))\left|\text{det}\frac{\mathrm d f^{-1}}{\mathrm d \mathbf x}\right|<br>$$<br>$\left|\text{det}\frac{\mathrm d f^{-1}}{\mathrm d \mathbf x}\right|$ä¸ºé€†å‡½æ•°JacobiançŸ©é˜µè¡Œåˆ—å¼çš„ç»å¯¹å€¼ã€‚</p><h2 id="Deep-Generative-Models-as-Manifolds"><a href="#Deep-Generative-Models-as-Manifolds" class="headerlink" title="Deep Generative Models as Manifolds"></a>Deep Generative Models as Manifolds</h2><p>ä¸€ä¸ªæ·±åº¦ç”Ÿæˆæ¨¡å‹å¯ä»¥è¡¨ç¤ºä¸ºä»ä½ç»´éšç©ºé—´$\mathcal Z \subseteq R^d$æ˜ å°„åˆ°æµå½¢$\mathcal M\subseteq R^D$çš„åµŒå…¥å‡½æ•°$g:\mathcal Z\rightarrow \mathcal X$ï¼Œ$D \ll d$ã€‚é€šå¸¸å‡è®¾$g$ä¸ºå…‰æ»‘æ˜ å°„ï¼Œé‚£ä¹ˆ$\mathcal M$ä¸ºä¸€ä¸ªåµŒå…¥æµå½¢ã€‚$g$åœ¨$z\in\mathcal Z$çš„é›…å„æ¯”çŸ©é˜µ$\mathbf J_g(z)$æä¾›äº†åœ¨$x=g(z)\in\mathcal X$å¤„çš„åˆ‡ç©ºé—´ï¼Œå³$\mathbf J_g:T_z\mathcal Z\rightarrow T_x\mathcal X$ã€‚è¿™ä¸ªæ˜ å°„ä¸æ˜¯æ»¡å°„ï¼Œå¹¶ä¸”å€¼åŸŸé™åˆ¶åœ¨æµå½¢$\mathcal M$åœ¨$x=g(z)$çš„åˆ‡ç©ºé—´ï¼Œè®°ä¸º$T_x\mathcal M$ã€‚$\mathcal M$ä¸çœŸå®æ•°æ®æµå½¢æ¥è¿‘ï¼Œå³$\mathcal M_{data}$ã€‚</p><p>è€ƒè™‘ä¸€ä¸ªå®šä¹‰åœ¨éšç©ºé—´$\mathcal Z$æ¯ä¸€ç‚¹$z$ä¸Šçš„Riemannian metricï¼š<br>$$<br>\mathbf M(z)=\mathbf J_g(z)^\top\mathbf J_g(z)<br>$$<br>ç»™å®šä¸¤ä¸ªåˆ‡ç©ºé—´å‘é‡$u,v\in T_z\in\mathcal Z$ï¼Œä»–ä»¬çš„å†…ç§¯å®šä¹‰ä¸º$&lt;u,v&gt;=u^\top \mathbf M(z)v$ã€‚</p><p>è€ƒè™‘ä¸€ä¸ªå…‰æ»‘æ›²çº¿$\gamma:t\in[a,b]\rightarrow\mathcal Z$ï¼Œ<br>$$<br>L(\gamma)=\int^b_a\sqrt{\hat{\gamma}(t)^\top M_{\gamma(t)}\hat{\gamma}(t)}\mathrm d t<br>$$</p><h2 id="Change-of-Variable-on-Manifolds"><a href="#Change-of-Variable-on-Manifolds" class="headerlink" title="Change of Variable on Manifolds"></a>Change of Variable on Manifolds</h2><p>åœ¨æµå½¢ä¸Šçš„<strong>Change of Variable Theorem</strong>æ˜¯ç±»ä¼¼çš„ï¼š</p><p>$$<br>p_\mathcal{X}(x)=p_\mathcal{Z}(g^{-1}(x))\text{det}(\mathbf J_g(g^{-1}(x))^\top\mathbf J_g(g^{-1}(x)))^{-\frac{1}{2}}<br>$$</p><p>æˆ‘ä»¬å‡è®¾éšç©ºé—´åˆ†å¸ƒ$p_\mathcal{Z}$æœä»æ ‡å‡†æ­£æ€å…ˆéªŒåˆ†å¸ƒ$N(0,\mathbf I_d)$ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡º$x$çš„ä¼¼ç„¶ï¼š</p><p>$$<br>\log(p_\mathcal{X}(g(z)))=\log(p_\mathcal{Z}(z))-\frac{1}{2}\log(\text{det}(\mathbf J_g(z)^\top\mathbf J_g(z)))<br>$$</p><p>é€šå¸¸æˆ‘ä»¬æ²¡æ³•çŸ¥é“çœŸå®ä¸–ç•Œä¸­$\mathcal M_{data}$çš„åˆ‡ç©ºé—´ç»´åº¦æ˜¯å¤šå°‘ï¼Œè®¾å®š$d=\text{dim}\mathcal Z&gt;T_x\mathcal M_{data}$ä¼šå¯¼è‡´$\mathbf J_g$ä¸æ˜¯æ»¡ç§©çŸ©é˜µï¼Œè¿™æ—¶$\text{det}(\mathbf J_g(z)^\top\mathbf J_g(z))=0$ï¼Œå³æ— æ³•åº”ç”¨ä¸Šå¼è®¡ç®—ä¼¼ç„¶ã€‚</p><h2 id="Density-Estimation-with-Neural-Networks"><a href="#Density-Estimation-with-Neural-Networks" class="headerlink" title="Density Estimation with Neural Networks"></a>Density Estimation with Neural Networks</h2><h2 id="Anomaly-Detection-with-Generative-Models"><a href="#Anomaly-Detection-with-Generative-Models" class="headerlink" title="Anomaly Detection with Generative Models"></a>Anomaly Detection with Generative Models</h2><h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1><p>å¯¹äºGANæ¨¡å‹ï¼Œç»™å®šéšå˜é‡$z$å’Œç”Ÿæˆå™¨$g$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¬å¼(8)è®¡ç®—ç”Ÿæˆæ ·æœ¬$g(z)$çš„å¯¹æ•°ä¼¼ç„¶ï¼Œä¸ºäº†ä¿è¯JacobiançŸ©é˜µä¸ºæ»¡ç§©ï¼Œæˆ‘ä»¬å¯ä»¥é€‰å®šè¾ƒä½çš„éšå˜é‡ç»´åº¦$d$ï¼Œä¸è¿‡è¿™æ ·ä¼šä¼¤å®³GANæ¨¡å‹çš„æ€§èƒ½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ª<em>inference network</em>æ¥å°†$x$æ˜ å°„å›$z$ï¼Œ</p><h2 id="The-Variance-Network-of-the-Generator"><a href="#The-Variance-Network-of-the-Generator" class="headerlink" title="The Variance Network of the Generator"></a>The Variance Network of the Generator</h2><p>æ–‡ä¸­å¯¹ç”Ÿæˆå™¨$g$è¿›è¡Œäº†æ‰©å±•ï¼š</p><p>$$<br>f(z) = g(z) + \sigma(z)\odot\epsilon,\<br>g:\mathcal Z\rightarrow\mathcal X, \sigma:\mathcal Z\rightarrow\mathbb{R},\epsilon\sim N(0,\mathbf I_D)<br>$$</p><p>$g$ä»£è¡¨å‡å€¼ï¼Œ$\sigma$ä»£è¡¨æ–¹å·®ï¼Œå®é™…ä¸Š$\mathbb E_{\epsilon\sim N(0,\mathbf I_D)}f(z)=g(z)$ã€‚ä¸ºäº†ä¿è¯æ–¹å·®åœ¨å°‘æ ·æœ¬æˆ–æ— æ ·æœ¬çš„åŒºåŸŸæ›´å¤§ï¼Œæ–¹å·®ç½‘ç»œé‡‡ç”¨RBFç½‘ç»œå®ç°ã€‚</p><blockquote><p>RBFç½‘ç»œï¼š<br>$$<br>h(x)=\exp\left(-\frac{(x-c)^2}{r^2}\right)<br>$$<br><img src="https://i.loli.net/2020/06/25/ho5FJsOBjxi2G78.png" srcset="/img/loading.gif" style="zoom: 80%;" /></p><img src="https://i.loli.net/2020/06/25/rtRLwyK2VigOvTh.png" srcset="/img/loading.gif" style="zoom: 50%;" /></blockquote><p>é¦–å…ˆï¼Œä»éšç©ºé—´é‡‡æ ·å¤§é‡çš„æ ·æœ¬ï¼Œä¹‹åä½¿ç”¨<strong>K-means</strong>ç®—æ³•å°†å…¶åˆ†ä¸º$K$ä¸ªèšç°‡ï¼Œ$c_k$ä¸ºç¬¬$k$ä¸ªç°‡çš„ä¸­å¿ƒï¼Œ$C_k$ä¸ºç¬¬$k$ä¸ªç°‡çš„æ ·æœ¬æ•°é‡ã€‚å¯¹äºä»»ä½•æ ·æœ¬$x$ï¼Œä¸ºäº†è®¡ç®—å…¶å¯¹åº”çš„æ–¹å·®ï¼Œéœ€è¦ç”¨ä¸€ä¸ª<em>inference network</em> $h$æ¥å°†å…¶æ˜ å°„åˆ°éšç©ºé—´ï¼Œå³$z=h(x)$ã€‚RBFç½‘ç»œé€šè¿‡è¾“å…¥$z$åˆ°æ¯ä¸ªç°‡ä¸­å¿ƒçš„è·ç¦»æ¥è¿”å›$x$å¯¹åº”çš„æ–¹å·®ï¼ŒRBFå‡½æ•°ç”±ä¸‹å¼ç»™å‡ºï¼š<br>$$<br>\sigma(z)=(\mathbf W^2\mathbf v(z))^{-\frac{1}{2}},\<br>v_k(z) = \exp(-\lambda_k\parallel z-c_k\parallel^2_2), \space k=1,\cdots,K\<br>\lambda_k=\frac{1}{2}\left(\frac{a}{|C_k|}\sum_{z_j\in C_k}\parallel z_j-c_k\parallel_2\right)^{-2}<br>$$</p><p>å…¶ä¸­$\alpha$ä¸ºæ ¸çš„è¶…å‚æ•°ï¼Œ$\mathbf W$ä¸ºæ¨¡å‹å‚æ•°ã€‚ç»™å®šç”Ÿæˆå™¨$g$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æœ€å°åŒ–$f(z)$å’Œ$x$ä¹‹é—´çš„è·ç¦»æ¥ä¼˜åŒ–å‚æ•°$\mathbf W$ã€‚</p><p>$$<br>\begin{align}<br>\bar{\mathbf M}^z_f&amp;=\mathbb E_{\epsilon\sim N(0,\mathbf I_D)}\mathbf J_f^\top(z)\mathbf J_f(z)\<br>&amp;=\mathbf J_g^\top(z)\mathbf J_g(z)+\mathbf J_\sigma^\top(z)\mathbf J_\sigma(z)<br>\end{align}<br>$$</p><blockquote><p>*<em>LEMMA 1. *</em> å¯¹äº$K\geq \text{dim}(\mathcal Z)+1$å’Œæ»¡ç§©çŸ©é˜µ$\mathbf W^2$ï¼Œ$\bar{\mathbf M}<em>f^z$ä¸ºä¸€ä¸ªæ»¡ç§©çŸ©é˜µã€‚ç”Ÿæˆæ ·æœ¬çš„å¯¹æ•°ä¼¼ç„¶ç”±ä¸‹å¼ç»™å‡ºï¼š<br>$$<br>\mathbb E</em>{\epsilon\sim N(0,\mathbf I_D)}\log(p_\mathcal{X}(f(z)))=\log(p_\mathcal{Z}(z))-\frac{1}{2}\log(\text{det}(\bar{\mathbf M}_f^z))<br>$$</p></blockquote><h2 id="The-Inference-Network-Learning"><a href="#The-Inference-Network-Learning" class="headerlink" title="The Inference Network Learning"></a>The Inference Network Learning</h2><img src="https://i.loli.net/2020/06/25/AZfIrq2v8RVipj1.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>$$<br>\max_{h,\sigma}\mathbb E_{x\sim p_{data}(x)}\left[\log(p(x|z))|_{z=h(x)}\right]<br>$$</p><p>$p(x|z)$</p><p>$$<br>\max_{h,\sigma}\mathbb E_{x\sim p_{data}(x), z=h(x)}\left[\log(p(x|z))-\text{KL}\right]<br>$$</p><blockquote><p>*<em>LEMMA 2. *</em><br>$$<br>f(z)\sim GP(g(z), \Lambda_\sigma)<br>$$</p></blockquote><p>$$<br>L_{h,\sigma}=\mathbb E_{x\sim p_{data}}\left[\sum_{i=1}^D[-\frac{1}{2}(g_i(h(x))-x_i)^2/\sigma_i^2(h(x))-\log\sigma_i(h(x))]-\text{KL}(q(z|x)\parallel p(z))\right]<br>$$</p><h2 id="Stabilize-Training"><a href="#Stabilize-Training" class="headerlink" title="Stabilize Training"></a>Stabilize Training</h2><p>$$<br>\min_{g,h}\mathbb E_{z\sim p(z)}[\parallel z-h(g(z))\parallel^2]<br>$$</p><h2 id="Algorithm"><a href="#Algorithm" class="headerlink" title="Algorithm"></a>Algorithm</h2><img src="https://i.loli.net/2020/06/25/PjJF9wBM2XS38TQ.png" srcset="/img/loading.gif" style="zoom: 80%;" /><blockquote><p>*<em>LEMMA 3. *</em> </p></blockquote><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><img src="https://i.loli.net/2020/06/25/GlqvJFOtEnbNoUP.png" srcset="/img/loading.gif" style="zoom:67%;" /><img src="https://i.loli.net/2020/06/25/Z8yDQU9McsT5GXI.png" srcset="/img/loading.gif" style="zoom:67%;" /><img src="https://i.loli.net/2020/06/25/NmBten8igTUV76L.png" srcset="/img/loading.gif" style="zoom:67%;" /><p><img src="https://i.loli.net/2020/06/25/8phKZkiRxdLyBT6.png" srcset="/img/loading.gif" alt=""></p><img src="https://i.loli.net/2020/06/25/noBqN9gWfPuFy8w.png" srcset="/img/loading.gif" style="zoom:67%;" /><img src="https://i.loli.net/2020/06/25/sJnwi5RzLAU3D6x.png" srcset="/img/loading.gif" style="zoom:67%;" /><img src="https://i.loli.net/2020/06/25/OvtLenWDSEi37lX.png" srcset="/img/loading.gif" style="zoom:67%;" /><img src="https://i.loli.net/2020/06/25/TIJbpsvGkwz3rVF.png" srcset="/img/loading.gif" style="zoom:67%;" />]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>GAN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Classification-based Anomaly Detection for General Data</title>
    <link href="/2020/06/02/Classification-based-Anomaly-Detection-for-General-Data/"/>
    <url>/2020/06/02/Classification-based-Anomaly-Detection-for-General-Data/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡ä¸»è¦æ˜¯å¯¹<a href="http://qfxiao.me/2020/06/01/Deep-Anomaly-Detection-Using-Geometric-Transformations/">NIPS18è¿™ç¯‡å¼‚å¸¸æ£€æµ‹æ–‡ç« </a>çš„æ”¹è¿›ï¼Œé¦–å…ˆæ˜¯åˆ©ç”¨äº†æ ‡ç­¾ä¿¡æ¯æ¥æå‡ç®—æ³•çš„è¡¨ç°ï¼Œå…¶æ¬¡æ˜¯å°†ç®—æ³•æ‰©å±•åˆ°äº†éå›¾åƒæ•°æ®ã€‚ä½œè€…å¯¹ç°æœ‰çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•è¿›è¡Œäº†å›é¡¾ï¼š</p><ul><li>*<em>Reconstruction Methodsï¼š *</em>è¿™ä¸€éƒ¨åˆ†æ–¹æ³•å‡è®¾å¼‚å¸¸æ ·æœ¬å’Œæ­£å¸¸æ ·æœ¬èƒ½å¤Ÿé€šè¿‡é‡æ„ä»»åŠ¡æ¥è¿›è¡ŒåŒºåˆ†ã€‚é€šè¿‡åœ¨æ­£å¸¸æ ·æœ¬ä¸Šå­¦ä¹ é‡æ„ä»»åŠ¡ï¼Œä¹‹åå¯¹äºæ­£å¸¸æ ·æœ¬ï¼Œæ¨¡å‹èƒ½å¤Ÿå¾ˆå¥½åœ°è¿›è¡Œé‡æ„ï¼Œè€Œå¼‚å¸¸æ ·æœ¬åˆ™ä¼šæœ‰è¾ƒé«˜çš„é‡æ„è¯¯å·®ã€‚</li><li>*<em>Distributional Methodsï¼š *</em>è¿™ä¸€éƒ¨åˆ†æ–¹æ³•å°†å¼‚å¸¸æ£€æµ‹çœ‹ä½œæ˜¯å¯†åº¦ä¼°è®¡é—®é¢˜ã€‚é€šè¿‡å¯¹æ­£å¸¸æ ·æœ¬çš„åˆ†å¸ƒè¿›è¡Œä¼°è®¡ï¼Œå¼‚å¸¸æ ·æœ¬åœ¨è¯¥æ­£å¸¸åˆ†å¸ƒä¸‹çš„ä¼¼ç„¶å°†ä¼šå¾ˆä½ã€‚</li><li>*<em>Classification-based Methodsï¼š *</em>è¿™ä¸€éƒ¨åˆ†æ–¹æ³•ä¸»è¦æ˜¯æŒ‡çš„å•åˆ†ç±»æ–¹æ³•å’Œé€šè¿‡å‡ ä½•å˜æ¢æ„é€ åˆ†ç±»ä»»åŠ¡çš„æ–¹æ³•ã€‚æœ¬æ–‡ä½¿ç”¨çš„å°±æ˜¯è¿™ç±»æ–¹æ³•ã€‚</li></ul><h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1><h2 id="Classification-based-Anomaly-Detection"><a href="#Classification-based-Anomaly-Detection" class="headerlink" title="Classification-based Anomaly Detection"></a>Classification-based Anomaly Detection</h2><p>å‡è®¾æ‰€æœ‰æ•°æ®ä½äºç©ºé—´$R^L$å†…ï¼Œè€Œæ­£å¸¸æ•°æ®ä½äºå­ç©ºé—´$X\subset R^L$å†…ã€‚æˆ‘ä»¬å‡è®¾æ‰€æœ‰çš„å¼‚å¸¸æ ·æœ¬ä½äº$X$ä¹‹å¤–ã€‚ä¸ºäº†æ£€æµ‹å¼‚å¸¸ï¼Œæˆ‘ä»¬å¸Œæœ›å­¦ä¹ ä¸€ä¸ªåˆ†ç±»å™¨$C$ä½¿å¾—å¯¹äºæ‰€æœ‰çš„$x\in X$æœ‰$C(x)=1$ï¼Œè€Œå¯¹æ‰€æœ‰çš„$x\in R^L\backslash X$æœ‰$C(x)=0$ã€‚</p><p>å•åˆ†ç±»æ–¹æ³•çš„æ€æƒ³æ˜¯ç›´æ¥å­¦ä¹ $P(x\in X)$ï¼Œä»£è¡¨çš„æ–¹æ³•æœ‰One-Class SVMï¼ŒDSVDDç­‰ã€‚ä¼ ç»Ÿçš„OC-SVMç›´æ¥åœ¨åŸå§‹ç©ºé—´æˆ–è€…æ ¸ç©ºé—´å­¦ä¹ åˆ†ç±»å™¨ã€‚æ¯”è¾ƒæ–°çš„æ–¹æ³•ï¼Œå¦‚Deep-SVDDåˆ™æ˜¯å…ˆå°†æ ·æœ¬è½¬æ¢åˆ°ä¸€ä¸ªç‰¹å¾ç©ºé—´ï¼Œç„¶ååœ¨è¿™ä¸ªç‰¹å¾ç©ºé—´ä¸Šå­¦ä¹ ä½¿å¾—åŠå¾„$R$æœ€å°çš„è¶…çƒä½“ï¼ˆçƒå¿ƒ$c_0$ï¼‰ï¼Œæ¥è¦†ç›–ä½æ‰€æœ‰æ­£å¸¸æ ·æœ¬ã€‚å¼‚å¸¸çš„åˆ¤å®šåˆ™é€šè¿‡è®¡ç®—$\parallel f(x)-c_0\parallel^2-R^2$æ¥å®ç°ã€‚ä¸è¿‡å­¦ä¹ ä¸€ä¸ªå¥½çš„æ ·æœ¬åˆ°ç‰¹å¾ç©ºé—´çš„å˜æ¢å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¯´$f(x)=0, \forall x \in X$å°±æ˜¯ä¸€ä¸ªä½¿å¾—è¶…çƒä½“æœ€å°çš„è§£ã€‚æ‰€ä»¥éœ€è¦å¾ˆå¤štrickæ¥é¿å…è¯¸å¦‚æ­¤ç±»çš„æƒ…å†µã€‚</p><p><em>Geometric-transformation classification</em> (GEOM) åˆ™å°†æ•°æ®ç©ºé—´$X$é€šè¿‡$M$ä¸ªå‡ ä½•å˜æ¢è½¬æ¢åˆ°ä¸€ç³»åˆ—å­ç©ºé—´$X_1,\cdots,X_M$ã€‚ä¹‹åè®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨æ¥é¢„æµ‹æ ·æœ¬$T(x,m)$å¯¹åº”çš„å‡ ä½•å˜æ¢çš„ç§ç±»$m$ã€‚è½¬æ¢åçš„æ­£å¸¸å›¾ç‰‡ç©ºé—´è®°ä¸º$\cup_m X_m$ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•å°è¯•ä¼°è®¡ä»¥ä¸‹æ¡ä»¶æ¦‚ç‡ï¼š<br>$$<br>P(m^\prime|T(x,m))=\frac{P(T(x,m)\in X_{m^\prime})P(m^\prime)}{\sum_{\bar{m}}P(T(x,m)\in X_{\bar{m}})P(\tilde{m})}-\frac{P(T(x,m)\in X_{m^\prime})}{\sum_{\bar{m}}P(T(x,m)\in X_{\bar{m}})}<br>$$</p><p>å¯¹äºå¼‚å¸¸çš„æ ·æœ¬$x\in R^L\backslash X$ï¼Œåœ¨ç»è¿‡å‡ ä½•å˜æ¢ä¹‹åï¼Œéƒ½ä¸ä¼šä½äºæ­£ç¡®çš„å­ç©ºé—´ä¸­ï¼Œå³$T(x,m)\in R^L\backslash X_m$ã€‚ä¹‹åï¼Œä½¿ç”¨$P(m|T(x,m))$æ¥åˆ¤å®šå¼‚å¸¸ã€‚</p><p>ä½œè€…è®¤ä¸ºï¼Œè¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯åˆ†ç±»å™¨$P(m^\prime|T(x,m))$åªåœ¨æ­£å¸¸æ•°æ®ä¸Šè®­ç»ƒï¼Œè€Œå¯¹äºå¼‚å¸¸æ ·æœ¬çš„å¼‚å¸¸åˆ†æ•°ä¼šå‡ºç°æ–¹å·®å¾ˆå¤§çš„é—®é¢˜ã€‚</p><p>ä¸€ç§è§£å†³æ–¹å¼æ˜¯åŠ å…¥å¼‚å¸¸æ ·æœ¬è¿›è¡Œè®­ç»ƒï¼Œä½†æ˜¯ä½œè€…è®¤ä¸ºåœ¨æœ‰çš„ä»»åŠ¡ä¸­æ ‡ç­¾å¾ˆéš¾è·å–ï¼Œäºæ˜¯ä½œè€…ä½¿ç”¨äº†å¦å¤–ä¸€ç§æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="Distance-based-Multiple-Transformation-Classification"><a href="#Distance-based-Multiple-Transformation-Classification" class="headerlink" title="Distance-based Multiple Transformation Classification"></a>Distance-based Multiple Transformation Classification</h2><p>å’ŒGEOMä¸€æ ·ï¼Œå…ˆå¯¹æ¯ä¸ªæ ·æœ¬è¿›è¡Œ$M$ä¸ªå‡ ä½•å˜æ¢ï¼Œç„¶åå­¦ä¹ ä¸€ä¸ªç‰¹å¾æå–å™¨$f(x)$ï¼Œå°†$X_m$æ˜ å°„åˆ°ç‰¹å¾ç©ºé—´ã€‚ä¹‹åå’ŒOC-SVMç±»ä¼¼ï¼Œå‡è®¾ç‰¹å¾${f(x)|x\in X_m}$ä¸ºçƒå¿ƒä¸º$c_m=\frac{1}{N}\sum_{x\in X} f(T(x,m))$çš„è¶…çƒä½“ã€‚æ ·æœ¬å±äºæŸä¸€ç±»$m^\prime$çš„æ¦‚ç‡ç”±ä¸‹å¼ç»™å‡ºï¼š</p><p>$$<br>P(m^\prime|T(x,m))=\frac{e^{-\parallel f(T(x,m))-c_{m^\prime}\parallel^2}}{\sum_{\bar m}e^{-\parallel f(T(x,m))-c_{\bar m}\parallel^2}}<br>$$</p><p>ç›®æ ‡å‡½æ•°é‡‡ç”¨çš„æ˜¯Triplet Lossï¼š</p><p>$$<br>L=\sum_i\max(\parallel f(T(x_i,m))-c_m\parallel^2+s-\min_{m^\prime\neq m}\parallel f(T(x_i,m))-c_{m^\prime}\parallel^2,0)<br>$$</p><p>$\parallel f(T(x_i,m))-c_m\parallel^2$ç›¸å½“äºæœ€å°åŒ–äº†ç±»å†…è·ç¦»ï¼Œ$\min_{m^\prime\neq m}\parallel f(T(x_i,m))-c_{m^\prime}\parallel^2$æœ€å¤§åŒ–äº†æ¯ä¸ªç±»å¯¹åº”çš„é›†ç°‡é—´è·ç¦»ã€‚åœ¨æ£€æµ‹é˜¶æ®µï¼Œä¸ºäº†é¿å…ä¸€äº›æ•°å€¼é—®é¢˜ï¼Œä½œè€…åšäº†ä¸€äº›å¹³æ»‘æ“ä½œï¼š</p><p>$$<br>\tilde P(m^\prime|T(x,m))=\frac{e^{-\parallel f(T(x,m))-c_{m^\prime}\parallel^2+\epsilon}}{\sum_{\tilde m}e^{-\parallel f(T(x,m))-c_{\tilde m}\parallel^2+M\cdot\epsilon}}<br>$$</p><p>æœ€åçš„è¯„åˆ¤åˆ†æ•°ç”±ä¸‹å¼ç»™å‡ºï¼š</p><p>$$<br>Score(x)=-\log P(x\in X)=-\sum_m\log \tilde{P}(T(x,m)\in X_m)=-\sum_m\log\tilde{P}(m|T(x,m))<br>$$</p><p>ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/24/r48h1RJxcXF6YDM.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Parameterizing-the-Set-of-Transformations"><a href="#Parameterizing-the-Set-of-Transformations" class="headerlink" title="Parameterizing the Set of Transformations"></a>Parameterizing the Set of Transformations</h2><p>åœ¨GEOMä¸­ï¼Œç”±äºä½¿ç”¨çš„å‡ ä½•å˜æ¢éƒ½æ˜¯é’ˆå¯¹å›¾åƒçš„ï¼Œæ‰€ä»¥å¯¹äºå…¶ä»–ç±»å‹çš„æ•°æ®å¹¶ä¸é€‚ç”¨ã€‚æœ¬æ–‡ä¸­ä½œè€…å¯¹éå›¾åƒæ•°æ®è®¾è®¡äº†ä»¥ä¸‹å˜æ¢ï¼š</p><p>$$<br>T(x,m)=W_mx+b_m<br>$$</p><p>ä¸åŒçš„å‚æ•°$W_m$å’Œ$b_m$å³ä¸ºä¸åŒçš„å‡ ä½•å˜æ¢ï¼Œå¯ä»¥è€ƒè™‘é‡‡ç”¨éšæœºé‡‡æ ·çš„æ–¹å¼ã€‚</p><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Image-Experiments"><a href="#Image-Experiments" class="headerlink" title="Image Experiments"></a>Image Experiments</h2><p>å¯¹äºå›¾åƒæ•°æ®çš„å¼‚å¸¸æ£€æµ‹å®éªŒï¼Œä½œè€…é‡‡ç”¨äº†CIFAR10ã€FasionMNISTè¿™ä¸¤ä¸ªæ•°æ®é›†ï¼Œå®éªŒç»“æœå¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/24/j4Y29tB6k1Aipgo.png" srcset="/img/loading.gif" style="zoom:67%;" /><img src="https://i.loli.net/2020/06/24/D3opwrLnSGmcsyM.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Tabular-Data-Experiments"><a href="#Tabular-Data-Experiments" class="headerlink" title="Tabular Data Experiments"></a>Tabular Data Experiments</h2><p>å¯¹äºéå›¾åƒæ•°æ®ï¼Œä½œè€…é‡‡ç”¨äº†å‡ ä¸ªå°çš„æ•°æ®é›†ï¼šArrhythmiaã€Thyroidã€KDDå’ŒKDDRevã€‚é‡‡ç”¨çš„BaselineåŒ…æ‹¬OC-SVMã€E2E-AEã€LOFã€DAGMMå’ŒFB-AE (Feature Bagging Autoencoder)ã€‚å¯¹äºå‡ ä½•å˜æ¢çš„å‚æ•°ï¼Œé‡‡æ ·è‡ªæ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚ç»“æœå¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/24/e6PfIDOVwlzrSWi.png" srcset="/img/loading.gif" style="zoom:67%;" /><h1 id="Remark"><a href="#Remark" class="headerlink" title="Remark"></a>Remark</h1><p>ç»“åˆ<a href="https://openreview.net/forum?id=H1lK_lBtvS" target="_blank" rel="noopener">OpenReview</a>ä¸Šçš„ä¸€äº›è®¨è®ºï¼Œè¿™é‡Œæå‡ºä¸€äº›é—®é¢˜å’Œæ€»ç»“ï¼š</p><ul><li>KDDæ•°æ®é›†å¤ªç®€å•äº†ï¼Œæ­£å¸¸ã€å¼‚å¸¸æ ·æœ¬èƒ½å¤Ÿå¾ˆå®¹æ˜“è¢«åˆ†å¼€ï¼›</li><li>å¯¹äºå›¾åƒæ•°æ®ä½œè€…åªä½¿ç”¨äº†CIFAR10å’ŒFashionMNISTè¿™ä¸¤ä¸ªæ¯”è¾ƒå°çš„æ•°æ®é›†ï¼Œè€Œåœ¨GEOMä¸­è¿˜ä½¿ç”¨äº†CIFAR100å’ŒCatsVsDogsã€‚å¹¶ä¸”GEOMåŸæ–‡ä¸­æåˆ°æ•°æ®é›†ï¼ˆæŒ‡å›¾åƒå¤§å°ï¼‰è¶Šå¤§ï¼ŒGEOMçš„ä¼˜åŠ¿å°±è¶Šæ˜æ˜¾ï¼Œæ‰€ä»¥åœ¨æœ¬æ–‡çš„å®éªŒä¸­åªä½¿ç”¨è¿™ä¸¤ä¸ªæ•°æ®é›†è¯´æœåŠ›ç•¥æ˜¾ä¸å¤Ÿï¼›</li><li>å…³äºè¯„æµ‹æ ‡å‡†çš„é—®é¢˜ï¼Œä½œè€…åœ¨å›¾åƒæ•°æ®ä¸­ç”¨çš„æ˜¯AUROCï¼Œè€Œéå›¾åƒæ•°æ®ç”¨çš„æ˜¯F1 scoreã€‚åƒAUPRã€AUROCè¿™ç§è¯„æµ‹æ ‡å‡†å¾€å¾€æ›´åŠ å…¨é¢ï¼Œè€ŒF1 scoreä¾èµ–äºé˜ˆå€¼çš„é€‰å–ã€‚å¦‚æœæ˜¯éå†é˜ˆå€¼æ‰¾åˆ°æœ€å¥½çš„é‚£ä¸ªF1 scoreï¼Œåˆ™æ— æ³•å…¨é¢è€ƒå¯Ÿæ¨¡å‹çš„é²æ£’æ€§ï¼Œæ¨¡å‹æœ‰å¯èƒ½åªæ˜¯åœ¨ç‰¹å®šçš„é˜ˆå€¼ä¸‹è¡¨ç°å¾ˆå¥½ï¼Œè€Œé˜ˆå€¼ç¨å¾®åå·®ä¸€ä¸‹æ€§èƒ½å¯èƒ½å°±ä¼šå¤§å¹…ä¸‹é™ã€‚æˆ‘çœ‹åˆ°çš„å¤§å¤šæ•°å¼‚å¸¸æ£€æµ‹æ–‡ç« éƒ½æ˜¯ä½¿ç”¨AUROCæˆ–è€…F1åŠ ä¸ŠAUROCä½œä¸ºè¯„æµ‹æŒ‡æ ‡ï¼›</li><li>æ–‡ä¸­åœ¨ç¬¬äºŒèŠ‚â€œCLASSIFICATION-BASED ANOMALY DETECTIONâ€çš„æœ«å°¾ä¸¤æ®µå…³äºGEOMæ–¹æ³•çš„ç¼ºç‚¹è¯´çš„å¾ˆæ¨¡ç³Šã€‚å¼‚å¸¸åˆ†æ•°çš„æ–¹å·®å¤§åˆ°åº•æŒ‡çš„æ˜¯ä»€ä¹ˆï¼›</li><li>å…³äºä½œè€…æå‡ºçš„å˜æ¢$T(x,m)=W_mx+b_m$å¹¶æ²¡æœ‰ç”¨åˆ°å›¾åƒæ•°æ®çš„å®éªŒä¸Šï¼Œè€Œä¸”åœ¨å®éªŒä¸­$b_m$è¿™ä¸ªå‚æ•°å®é™…ä¸Šæ˜¯è¢«å¿½ç•¥æ‰äº†çš„ï¼Œ$b_m$çš„ä½œç”¨ç©¶ç«Ÿå¦‚ä½•ä¸å¾—è€ŒçŸ¥ã€‚è€Œä¸”GEOMä¸­çš„å‡ ä½•å˜æ¢çš„Motivationåœ¨åŸæ–‡ä¸­æ˜¯åšäº†å®éªŒå……åˆ†è®¨è®ºäº†çš„ï¼ŒGEOMçš„ä½œè€…è®¤ä¸ºè¿™äº›å‡ ä½•å˜æ¢ä¿ç•™äº†å›¾åƒçš„é«˜é˜¶è¯­ä¹‰ä¿¡æ¯ã€‚è€Œæœ¬æ–‡ä¸­çš„å˜æ¢ä¸­çš„å‚æ•°åªæ˜¯éšæœºé‡‡æ ·è€Œæ¥ï¼Œå¹¶ä¸å­˜åœ¨è¯´ä¿ç•™åŸå§‹æ•°æ®ä¸­çš„ç»“æ„ä¿¡æ¯ã€‚å¦‚æœå¿½ç•¥æ‰è¿™ä¸€å±‚å˜æ¢ï¼Œé‚£å°±ç±»ä¼¼äºåŠ äº†ç¥ç»ç½‘ç»œæå–ç‰¹å¾çš„OC-SVMã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢å‘OpenPAIçš„Dockeré•œåƒé…ç½®åŠOpenPAIåŸºæœ¬ä½¿ç”¨æ–¹æ³•</title>
    <link href="/2020/06/02/%E9%9D%A2%E5%90%91OpenPAI%E7%9A%84Docker%E9%95%9C%E5%83%8F%E9%85%8D%E7%BD%AE%E5%8F%8AOpenPAI%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <url>/2020/06/02/%E9%9D%A2%E5%90%91OpenPAI%E7%9A%84Docker%E9%95%9C%E5%83%8F%E9%85%8D%E7%BD%AE%E5%8F%8AOpenPAI%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>å®éªŒå®¤æœåŠ¡å™¨é›†ç¾¤é‡‡ç”¨OpenPAIæ¥è¿›è¡ŒGPUèµ„æºçš„ç®¡ç†ï¼Œè€ŒOpenPAIé‡‡ç”¨äº†Dockerä½œä¸ºåŸºç¡€ï¼Œå³ä»£ç éƒ½æ”¾åœ¨Dockerå®¹å™¨ä¸­è¿è¡Œã€‚ç”±äºDockerçš„ä½¿ç”¨ã€Dockeré•œåƒçš„é…ç½®éƒ½æœ‰ä¸€å®šçš„é—¨æ§›ï¼Œæ‰€ä»¥è¿™é‡Œå†™ä¸€ç¯‡Tutorialæ¥è¿›è¡Œä»‹ç»ã€‚æœ¬æ–‡ä¸æ˜¯ç½‘ä¸Šèµ„æ–™çš„æ‹¼å‡‘ï¼Œè€Œæ˜¯ç»è¿‡æœ¬äººèµ°å¼¯è·¯è¸©å‘å½¢æˆçš„â€Best practiceâ€ã€‚ä¸»è¦å†…å®¹åŒ…æ‹¬Dockerçš„ä»‹ç»ã€Dockerçš„åŸºæœ¬ä½¿ç”¨ã€å¦‚ä½•é…ç½®è‡ªå·±çš„Dockeré•œåƒä»¥åŠOpenPAIå¹³å°çš„åŸºæœ¬ä½¿ç”¨ï¼Œä½†ä¸åŒ…æ‹¬Dockerå’ŒOpenPAIçš„å®‰è£…ã€‚</p><h1 id="Docker-from-Scratch"><a href="#Docker-from-Scratch" class="headerlink" title="Docker from Scratch"></a>Docker from Scratch</h1><p>è¦ç†è§£Dockeræ˜¯ä»€ä¹ˆï¼Œä»è™šæ‹Ÿæœºå¼€å§‹è®²å¯èƒ½ä¼šæ¯”è¾ƒå¥½ç†è§£ã€‚è™šæ‹Ÿæœºå¤§å®¶å¯èƒ½éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œæ¯”å¦‚è¯´æˆ‘ç”¨çš„ç³»ç»Ÿæ˜¯Windowsï¼Œä½†æˆ‘éœ€è¦Linuxç³»ç»Ÿæ¥ä½œä¸ºä¸€ä¸ªFlaskç¼–å†™çš„ç½‘ç«™çš„æœåŠ¡å™¨ï¼Œä½†æ˜¯åˆä¸æƒ³å•ç‹¬å®‰è£…Linuxç³»ç»Ÿï¼Œäºæ˜¯å¯ä»¥ä½¿ç”¨è™šæ‹Ÿæœºæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®‰è£…VMWare Workstationï¼Œå»å®˜ç½‘ä¸‹è½½Ubuntuç³»ç»Ÿé•œåƒï¼Œç„¶ååœ¨VMWareä¸­å®‰è£…å¥½ç³»ç»Ÿï¼Œç„¶åä»å¤´é…ç½®Flaskç›¸å…³ç¯å¢ƒã€‚å®é™…ä¸Šæˆ‘éœ€è¦çš„ä»…ä»…æ˜¯ä¸€ä¸ªFlaskè¿è¡Œç¯å¢ƒè€Œå·²ï¼Œè€Œä½¿ç”¨è™šæ‹Ÿæœºå´éœ€è¦å¦‚æ­¤â€œå¤§è´¹å‘¨ç« â€ï¼Œè¿™æ—¶Dockerå‡ºç°äº†ï¼Œç½‘ä¸Šæœ‰å¤§é‡ç°æˆçš„Flask Dockeré•œåƒï¼Œé…ç½®å¥½äº†ä½ æ‰€éœ€çš„Flaskç¯å¢ƒï¼Œä½ åªéœ€è¦ä¸‹è½½è¿™äº›é•œåƒï¼Œç„¶åè¿è¡Œå®ƒï¼Œä½ å°±å¾—åˆ°äº†ä¸€ä¸ªFlaskè¿è¡Œç¯å¢ƒï¼Œè€Œä¸ä½ å½“å‰ä½¿ç”¨çš„ç³»ç»Ÿæ— å…³ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªTomcatçš„è¿è¡Œç¯å¢ƒï¼Œé‚£ä¹ˆå»æ‰¾ä¸€ä¸ªTomcatçš„Dockeré•œåƒå°±è¡Œã€‚Dockerå°†éœ€æ±‚æˆ–è€…è¯´æœåŠ¡ç»‘å®šåœ¨äº†Dockeré•œåƒä¸­ï¼ˆ<strong>è½»é‡åŒ–</strong>ï¼Œä¸€ä¸ªéœ€æ±‚å¯¹åº”ä¸€ä¸ªDockeré•œåƒï¼Œæ¯ä¸ªé•œåƒéƒ½å¾ˆå°ï¼‰ï¼Œä½ æœ‰ä»€ä¹ˆéœ€æ±‚ï¼Œå»æ‰¾ç›¸åº”çš„é•œåƒå³å¯ï¼ˆæˆ–è€…è‡ªå·±å†™ä¸€ä¸ªï¼‰ï¼Œé•œåƒçš„è¿è¡Œæ˜¯ä»¥è™šæ‹Ÿæœºçš„å½¢å¼å­˜åœ¨ï¼Œæ‰€ä»¥ä»–ä»¬ä¹‹é—´ä¹Ÿæ˜¯äº’ä¸å¹²æ‰°çš„ã€‚åŒæ—¶ï¼Œä½ åœ¨å†™å¥½ä¸€ä¸ªDockeré•œåƒä¹‹åï¼Œä½ è¿˜å¯ä»¥<strong>åˆ†äº«</strong>ç»™åˆ«äººï¼Œè¿™æ ·å…¶ä»–äººå°±ä¸ç”¨é‡æ–°é…ç½®ï¼Œç›´æ¥è¿è¡Œä½ ç»™ä»–çš„é•œåƒå³å¯ã€‚Dockeræœ‰ä¸¤ä¸ªæ¯”è¾ƒå…³é”®çš„æ¦‚å¿µï¼š</p><ul><li><strong>é•œåƒ Imagesï¼š</strong> è¿™é‡Œçš„é•œåƒä¸æ˜¯æŒ‡æˆ‘ä»¬å®‰è£…ç³»ç»Ÿæ—¶ä¸‹è½½çš„ISOé•œåƒï¼ŒDockeré•œåƒå°±æ˜¯æŠŠä½ éœ€è¦çš„ä¸œè¥¿ï¼ˆä¸€ä¸ªç³»ç»Ÿ+éœ€è¦çš„æœåŠ¡ï¼‰é›†ä¸­åˆ°ä¸€èµ·ï¼Œç›¸å½“äºåšèœçš„èœè°±ï¼›</li><li><strong>å®¹å™¨ Containersï¼š</strong> å¦‚æœä¸€ä¸ªDockeré•œåƒå¯åŠ¨äº†ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ä¸€ä¸ªDockerå®¹å™¨äº§ç”Ÿï¼Œç›¸å½“äºæŒ‰ç…§èœè°±åšå‡ºæ¥çš„èœã€‚</li></ul><img src="https://i.loli.net/2020/06/24/H2x9mnPwkVQyO6p.png" srcset="/img/loading.gif" alt="img" style="zoom: 33%;" /><img src="https://i.loli.net/2020/06/24/7k6S3yecX2lbvQY.png" srcset="/img/loading.gif" alt="img" style="zoom: 33%;" /><p>è¿™ä¸€èŠ‚æˆ‘ä»¬å…ˆä¸è®¨è®ºå¦‚ä½•è‡ªå·±å†™Dockeré•œåƒï¼Œåªæ˜¯å…ˆè®¨è®ºDockerçš„åŸºæœ¬æ“ä½œã€‚</p><h2 id="Basic-Operations"><a href="#Basic-Operations" class="headerlink" title="Basic Operations"></a>Basic Operations</h2><p>Dockeræ–°å®‰è£…å¥½å½“ç„¶æ˜¯æ²¡æœ‰ä»€ä¹ˆé•œåƒçš„ï¼Œé¦–å…ˆæˆ‘ä»¬ä½¿ç”¨<code>docker pull hello-world</code>æ¥ä¸‹è½½ä¸€ä¸ªæµ‹è¯•é•œåƒã€‚</p><blockquote><p>æ‹‰å–é•œåƒ <code>docker pull &lt;image_name&gt;</code></p></blockquote><p>åœ¨è¾“å…¥ä¹‹åï¼ŒDockerä¼šè‡ªåŠ¨åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸ŠæŸ¥æ‰¾å¯¹åº”çš„é•œåƒè¿›è¡Œä¸‹è½½ã€‚ç”±äºæˆ‘çš„ç”µè„‘ä¸Šå·²ç»æœ‰è¿™ä¸ªé•œåƒäº†ï¼Œæ‰€ä»¥æ˜¾ç¤ºæ˜¯ä¸‹é¢çš„æ ·å­ï¼š</p><p><img src="https://i.loli.net/2020/06/24/rvqcAwzOYJtF6T8.png" srcset="/img/loading.gif" alt=""></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¾“å…¥<code>docker run hello-world</code>è¿è¡Œè¿™ä¸ªé•œåƒã€‚</p><blockquote><p>è¿è¡Œé•œåƒ<code>docker run &lt;image_name&gt;</code></p></blockquote><p>å¯ä»¥çœ‹åˆ°ï¼ŒDockerè¾“å‡ºäº†ä¸€äº›ä¿¡æ¯å°±è‡ªå·±é€€å‡ºäº†ï¼Œè¿™å’Œæˆ‘ä»¬ç†è§£çš„è™šæ‹Ÿæœºä¸å¤ªä¸€æ ·ã€‚åœ¨Dockeré‡Œé¢ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿï¼Œç”¨æˆ·åœ¨è¿è¡Œä¹‹åå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨è¿™ä¸ªæ“ä½œç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„æœåŠ¡ï¼Œé»˜è®¤è¿è¡Œå®Œä¸€äº›æŒ‡ä»¤å°±é€€å‡ºäº†ã€‚è¿™é‡Œçš„<code>hello-world</code>é•œåƒè¿™æ˜¯è¾“å‡ºäº†ä¸€äº›ä¿¡æ¯åå°±è‡ªåŠ¨é€€å‡ºäº†ï¼Œå› ä¸ºè¿™å°±æ˜¯è¿™ä¸ªé•œåƒçš„å…¨éƒ¨å†…å®¹ã€‚</p><p><img src="https://i.loli.net/2020/06/24/Zb1VKjFyMh8gHf2.png" srcset="/img/loading.gif" alt=""></p><p>æˆ‘ä»¬å°è¯•æ¥è¿è¡Œä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿï¼Œå…ˆç”¨<code>docker pull ubuntu</code>æ‹‰å–Ubuntu Dockeré•œåƒï¼š</p><p><img src="https://i.loli.net/2020/06/24/zEerb2gPwYWX8O7.png" srcset="/img/loading.gif" alt=""></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ï¼š</p><p><img src="https://i.loli.net/2020/06/24/6cMz1WGH4fgpBsS.png" srcset="/img/loading.gif" alt=""></p><blockquote><p><code>-it</code>çš„æ„æ€æ˜¯ä»€ä¹ˆï¼Ÿæ ¹æ®<code>docker run --help</code>ï¼š</p><pre><code class="hljs routeros">-i, --interactive                    Keep STDIN open even <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> attached    --ip string                      IPv4<span class="hljs-built_in"> address </span>(e.g., 172.30.100.104)    --ip6 string                    <span class="hljs-built_in"> IPv6 address </span>(e.g., 2001:db8::33)    --ipc string                     IPC mode <span class="hljs-keyword">to</span> use    --isolation string               Container isolation technology    --kernel-memory bytes            Kernel memory limit-t, --tty                            Allocate a pseudo-TTY    --ulimit ulimit                  Ulimit options (default [])Copy</code></pre><p>å…¶å®<code>-it</code>æ˜¯<code>-i</code>å’Œ<code>-t</code>çš„åˆå¹¶å†™æ³•ï¼Œæ„æ€æ˜¯è¿è¡Œåè¿›å…¥è¿™ä¸ªå®¹å™¨å¹¶ä¸”å¯ç”¨shellï¼Œä¸ç„¶è¿è¡Œä¹‹åå°±ä¼šæ”¾åˆ°åå°è€Œä¸ä¼šè¿›å…¥å®¹å™¨ä¸­ã€‚è€Œ<code>--rm</code>åˆ™ä»£è¡¨å®¹å™¨é€€å‡ºä¹‹åä¼šè¢«åˆ é™¤ï¼ˆé•œåƒä¸ä¼šè¢«åˆ é™¤ï¼‰ï¼Œæ¯æ¬¡è¿è¡Œå®é™…ä¸Šä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œå¦‚æœä¸åŠ <code>--rm</code>æˆ–é€€å‡ºä¹‹åä¸æ‰‹åŠ¨åˆ é™¤çš„è¯ä¼šçœ‹åˆ°ä¸€å †åœæ­¢è¿è¡Œçš„å®¹å™¨ã€‚</p></blockquote><p>è¾“å…¥<code>cat /etc/issue</code>å¯ä»¥çœ‹åˆ°é»˜è®¤æ‹‰å–çš„æ˜¯æœ€æ–°çš„Ubuntu 20.04 LTSï¼š</p><p><img src="https://i.loli.net/2020/06/24/wldBMFtx3eIk98C.png" srcset="/img/loading.gif" alt=""></p><h1 id="Build-Customized-Docker-Images"><a href="#Build-Customized-Docker-Images" class="headerlink" title="Build Customized Docker Images"></a>Build Customized Docker Images</h1><p>å¦‚æœæ²¡æœ‰ç°æˆçš„Dockeré•œåƒèƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘è‡ªå·±å†™ä¸€ä¸ªã€‚è¦è‡ªå®šä¹‰ä¸€ä¸ªDockeré•œåƒéœ€è¦ä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯ç¼–å†™Dockerfileï¼Œç¬¬äºŒæ­¥æ˜¯ä½¿ç”¨<code>docker build</code>å‘½ä»¤æ„å»ºé•œåƒã€‚Dockerfileå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œæè¿°äº†æˆ‘ä»¬æ„å»ºé•œåƒæ‰€éœ€è¦çš„å…¨éƒ¨å‘½ä»¤ï¼Œæ¯”å¦‚è¦æ„å»ºä¸€ä¸ªç”¨äºPythonç§‘å­¦è®¡ç®—çš„Dockeré•œåƒï¼Œæˆ‘ä»¬éœ€è¦åœ¨Dockerfileä¸­ç¼–å†™å®‰è£…Pythonçš„å‘½ä»¤ï¼Œå®‰è£…Numpyã€Scipyç­‰å¸¸ç”¨åŒ…çš„å‘½ä»¤ç­‰ç­‰ã€‚æˆ‘ä»¬å…ˆæ¥ä¸Šæ‰‹ç¼–å†™Dockerfileï¼Œè¿™é‡Œæˆ‘å‡†å¤‡å†™ä¸€ä¸ªåŒ…å«<a href="https://hexo.io/" target="_blank" rel="noopener">hexoåšå®¢æ¡†æ¶</a>çš„é•œåƒï¼Œè¿™ä¸ªæ¡†æ¶éœ€è¦nodeä½œä¸ºåŸºç¡€ç¯å¢ƒï¼Œä¸è¿‡æˆ‘ä»¬ä¸éœ€è¦åœ¨Dockerfileé‡Œå†™å®‰è£…nodeçš„å‘½ä»¤ã€‚å› ä¸ºç±»ä¼¼äº<code>C++</code>æˆ–<code>Python</code>ä¸­çš„å¯¹è±¡çš„ç»§æ‰¿ï¼ŒDockerfileä¹Ÿå¯ä»¥â€œç»§æ‰¿â€ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸å¿…ä»å¤´å†™èµ·ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å®Œæ•´çš„Dockfileå’Œæ•ˆæœï¼Œå†æ¥ä¸€ä¸€è§£é‡Šã€‚</p><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> node--------------------------------------------------------------<span class="hljs-keyword">RUN</span><span class="bash"> npm install -g hexo-cli</span><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">4000</span><span class="hljs-keyword">CMD</span><span class="bash"> hexo init blog &amp;&amp; <span class="hljs-built_in">cd</span> blog &amp;&amp; hexo generate &amp;&amp; hexo serverCopy</span></code></pre><p>è¿è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°DockeræŒ‰ç…§æˆ‘ä»¬å†™çš„Dockerfileä¸€è¡Œä¸€è¡Œçš„è¿›è¡Œé•œåƒçš„æ„å»ºï¼š</p><p><img src="https://i.loli.net/2020/06/24/tZ3JW4SPNhxUwEn.png" srcset="/img/loading.gif" alt=""></p><p>ç°åœ¨æ¥è§£é‡ŠDocerfileé‡Œçš„å†…å®¹ã€‚<code>FROM &lt;docker image&gt;</code>è¡¨ç¤ºç»§æ‰¿å…¶ä»–çš„é•œåƒï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨nodeå®˜æ–¹çš„é•œåƒã€‚æ¥ä¸‹æ¥æ˜¯å®‰è£…hexoï¼Œ<code>RUN &lt;command&gt;</code>è¡¨ç¤ºæ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨<code>npm install -g hexo-cli</code>è¿›è¡Œå®‰è£…ã€‚ç”±äºè¦æµè§ˆåšå®¢ç½‘é¡µéœ€è¦å¼€æ”¾ç«¯å£ï¼Œè€ŒDockerå®¹å™¨è¿è¡Œçš„æ—¶å€™å’Œå¤–éƒ¨ä¸»æœºæ˜¯å®Œå…¨éš”æ–­çš„ï¼Œè¦ä½¿å¤–éƒ¨ä¸»æœºè®¿é—®Dockerå®¹å™¨ç«¯å£ï¼Œéœ€è¦æš´éœ²ç«¯å£ã€‚<code>EXPOSE &lt;port&gt;</code>ä»£è¡¨æš´éœ²ç«¯å£ï¼Œè¿™é‡Œç”¨çš„æ˜¯4000ç«¯å£ã€‚ä¹‹åæ˜¯åˆ›å»ºåšå®¢å’Œå¯åŠ¨æœ¬åœ°æœåŠ¡ï¼Œ<code>CMD &lt;command&gt;</code>å’Œ<code>RUN &lt;command&gt;</code>çš„åŒºåˆ«æ˜¯RUNä¼šåœ¨æ„å»ºçš„æ—¶å€™æ‰§è¡Œï¼Œè€ŒCMDæ˜¯åœ¨å®¹å™¨å¯åŠ¨ä¹‹åæ‰ä¼šæ‰§è¡Œã€‚<code>hexo init blog &amp;&amp; cd blog &amp;&amp; hexo generate &amp;&amp; hexo server</code>åˆ†åˆ«ä»£è¡¨åˆå§‹åŒ–åšå®¢ã€è¿›å…¥åšå®¢æ‰€åœ¨æ–‡ä»¶å¤¹ã€ç”Ÿæˆåšå®¢ç½‘ç«™ã€å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ã€‚æ›´å¤šæŒ‡ä»¤å¯ä»¥å‚è€ƒ<a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨<code>docker build -t test_hexo .</code>å‘½ä»¤æ„å»ºé•œåƒã€‚</p><blockquote><p>æ„å»ºé•œåƒ <code>docker build -t &lt;image_name&gt; &lt;direcotry&gt;</code></p></blockquote><p>è¿è¡Œé•œåƒï¼š</p><p><img src="https://i.loli.net/2020/06/24/m4FSe15kMIDCHXy.png" srcset="/img/loading.gif" alt=""></p><p>å¯ä»¥çœ‹åˆ°å®¹å™¨å¯åŠ¨åå¼€å§‹æ‰§è¡Œåšå®¢åˆå§‹åŒ–ã€‚</p><p><img src="https://i.loli.net/2020/06/24/BEdibvgPTMz4sn8.png" srcset="/img/loading.gif" alt=""></p><p>æœ€ååœ¨<code>locahost:4000</code>ä¸Šå¯åŠ¨äº†ä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥è¿™ä¸ªåœ°å€ï¼Œå¯ä»¥çœ‹åˆ°åˆšåˆšæ„å»ºå¥½çš„åšå®¢ï¼š</p><p><img src="https://i.loli.net/2020/06/24/vmSUb5QH6l4afzF.png" srcset="/img/loading.gif" alt=""></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨Dockerfileä¸­æˆ‘ä»¬æš´éœ²äº†4000ç«¯å£ï¼Œä½¿ç”¨<code>-p</code>æ ‡ç­¾å¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼š<code>docker run -p &lt;docker_port&gt;:&lt;local_port&gt; &lt;image_name&gt;</code>ã€‚æ¯”å¦‚<code>docker run -p 9999:8888 xxxx</code>ä»£è¡¨å°†Dockerå®¹å™¨ä¸­çš„9999ç«¯å£è½¬å‘åˆ°å¤–éƒ¨ä¸»æœºçš„8888ç«¯å£ã€‚å¦‚æœä½ æ˜¯åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šä½¿ç”¨çš„Dockerï¼Œé‚£ä¹ˆç«¯å£åªæ˜¯è¢«è½¬å‘åˆ°äº†è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œè¿˜å¾—æ‰‹åŠ¨å°†è¿œç¨‹æœåŠ¡å™¨å†è½¬å‘åˆ°ä½ æœ¬æœºä¸Šæ‰èƒ½ç›´æ¥åœ¨æœ¬æœºæµè§ˆå™¨ä¸Šçœ‹åˆ°é¡µé¢ã€‚</p><h2 id="Build-Docker-Images-with-Aliyun-Container-Registry"><a href="#Build-Docker-Images-with-Aliyun-Container-Registry" class="headerlink" title="Build Docker Images with Aliyun Container Registry"></a>Build Docker Images with Aliyun Container Registry</h2><p>å› ä¸ºæŸäº›åŸå› ï¼Œå¦‚æœåœ¨æ„å»ºé•œåƒçš„æ—¶å€™éœ€è¦é€šè¿‡<code>apt-get update</code>æ›´æ–°æºï¼Œä¼šå‘ç°æ— è®ºå¦‚ä½•éƒ½ä¼šå¡ä½ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨<a href="https://cr.console.aliyun.com/" target="_blank" rel="noopener">é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡</a>ï¼Œåœ¨é˜¿é‡Œçš„æœåŠ¡å™¨ä¸Šæ„å»ºå¥½é•œåƒï¼Œå†æ‹‰å–åˆ°è‡ªå·±çš„æœºå™¨ä¸Šã€‚æ³¨å†Œå¥½å¸å·ä¹‹åï¼Œç‚¹å‡»åˆ›å»ºé•œåƒä»“åº“ï¼š</p><p><img src="https://i.loli.net/2020/06/24/u4DGHv3En1iLI5z.png" srcset="/img/loading.gif" alt=""></p><p>è¿™é‡Œä»“åº“ç±»å‹å¦‚æœæ²¡æœ‰ç‰¹æ®Šéœ€æ±‚å»ºè®®ä½¿ç”¨å…¬å¼€ï¼Œç„¶åå¡«å†™ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼š</p><p><img src="https://i.loli.net/2020/06/24/Qipw5hAg136afnL.png" srcset="/img/loading.gif" alt=""></p><p>ä¹‹åè®¾ç½®ä»£ç æºï¼Œå…¶å®å°±æ˜¯å‘Šè¯‰é˜¿é‡Œäº‘ä»å“ªå„¿è·å–Dockerfileï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯Githubï¼Œæ‰€ä»¥éœ€è¦å…ˆåœ¨é˜¿é‡Œäº‘ä¸­å…³è”Githubè´¦å·ï¼Œç„¶ååœ¨Githubä¸­åˆ›å»ºä¸€ä¸ªç”¨æ¥æ”¾Dockerfileçš„ä»“åº“ã€‚æ„å»ºè®¾ç½®é‡Œæœ‰ä¸€ä¸ªâ€œæµ·å¤–æœºå™¨æ„å»ºâ€ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬ä½¿ç”¨é˜¿é‡Œäº‘å®¹å™¨æœåŠ¡çš„ä¸»è¦ç›®çš„ï¼Œå‹¾é€‰ã€‚</p><p><img src="https://i.loli.net/2020/06/24/ksvZJG9lKfdh6aR.png" srcset="/img/loading.gif" alt=""></p><p>é•œåƒä»“åº“åˆ›å»ºå¥½ä¹‹åï¼Œç‚¹è¿›å»ï¼Œåœ¨æ„å»ºé¡µé¢ç‚¹å‡»æ·»åŠ è§„åˆ™ï¼š</p><p><img src="https://i.loli.net/2020/06/24/irBm3QcqjVhGMsv.png" srcset="/img/loading.gif" alt=""></p><p>æŒ‰ä¸‹å›¾è¿›è¡Œè®¾ç½®å³å¯ï¼Œé•œåƒç‰ˆæœ¬å°±æ˜¯ä½ æƒ³è¦çš„é•œåƒåå­—ï¼š</p><p><img src="https://i.loli.net/2020/06/24/7pAFvM8CJQbq6mU.png" srcset="/img/loading.gif" alt=""></p><p>ç‚¹å‡»â€œç«‹å³æ„å»ºâ€ï¼š</p><p><img src="https://i.loli.net/2020/06/24/GlMwqDInL7zVOpf.png" srcset="/img/loading.gif" alt=""></p><p>ç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œå¦‚æœæ„å»ºæˆåŠŸï¼Œä¾¿å¯ä»¥è¿›è¡Œæ‹‰å–äº†ï¼Œåœ¨é•œåƒä»“åº“çš„åŸºæœ¬ä¿¡æ¯é¡µé¢å¯ä»¥çœ‹åˆ°åœ°å€ï¼š</p><p><img src="https://i.loli.net/2020/06/24/57jmEv8PYkr2nQG.png" srcset="/img/loading.gif" alt=""></p><p>å°†é˜¿é‡Œäº‘ä¸Šçš„é•œåƒæ‹‰å–åˆ°æœ¬æœºä¹‹åä¸€èˆ¬ä¼šæƒ³è¦å¯¹é•œåƒæ”¹åï¼Œå¯ä»¥ä½¿ç”¨<code>docker tag &lt;old_name&gt; &lt;new_name&gt;</code>ã€‚</p><h1 id="Build-Docker-Images-for-Deep-Learning"><a href="#Build-Docker-Images-for-Deep-Learning" class="headerlink" title="Build Docker Images for Deep Learning"></a>Build Docker Images for Deep Learning</h1><h2 id="Startup"><a href="#Startup" class="headerlink" title="Startup"></a>Startup</h2><p>åœ¨Dockerä¸­é…ç½®é€‚ç”¨äºOpenPAIçš„æ·±åº¦å­¦ä¹ é•œåƒä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ï¼Œä¼šæœ‰å¾ˆå¤šçš„å‘ï¼Œè¿™é‡Œä¸“é—¨è¯´ä¸€ä¸‹å¦‚ä½•é…ç½®ã€‚æ¨èåœ¨é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ä¸­è¿›è¡Œæ„å»ºï¼Œä¼šå°‘å¾ˆå¤šéº»çƒ¦ã€‚</p><p>ç¬¬ä¸€æ­¥æ˜¯åˆå§‹é•œåƒï¼Œç”±äºéœ€è¦ç”¨åˆ°CUDAï¼Œè¿™é‡Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼ˆæ¯”å¦‚ä¸åŒCUDAç‰ˆæœ¬æ”¯æŒçš„GPUé©±åŠ¨ç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œè¿˜æœ‰Tensorflowä¸åŒç‰ˆæœ¬å¯¹CUDAå’ŒcuDNNè¦æ±‚ä¹Ÿä¸ä¸€æ ·ï¼‰ä»Nvidiaçš„Dockerhub<a href="https://hub.docker.com/r/nvidia/cuda" target="_blank" rel="noopener">å®˜æ–¹é¡µé¢</a>é€‰æ‹©åˆé€‚çš„CUDAå’ŒcuDNNç‰ˆæœ¬ï¼š</p><p><img src="https://i.loli.net/2020/06/24/pftdhmHiWkTq8Fj.png" srcset="/img/loading.gif" alt=""></p><p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©CUDA10.1 + cuDNN7ï¼š</p><pre><code class="hljs angelscript">FROM nvidia/cuda:<span class="hljs-number">10.1</span>-cudnn7-devel-ubuntu18<span class="hljs-number">.04</span>Copy</code></pre><p>è¿™ä¸€æ¡ä¸»è¦æ˜¯è§£å†³ä¹±ç é—®é¢˜ä»¥åŠå®šä¹‰ç”¨åˆ°çš„è½¯ä»¶åŒ…çš„ç‰ˆæœ¬ï¼Œè¿™é‡ŒMinicondaç‰ˆæœ¬è®¾ç½®ä¸º4.5.4çš„åŸå› æ˜¯è¿™æ˜¯æœ€åä¸€ä¸ªè‡ªå¸¦Python3.6çš„ç‰ˆæœ¬ï¼Œæˆ‘åœ¨è¿™å„¿ä¸ºäº†ç¨³å®šæ‰€ä»¥ç”¨äº†Python3.6ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å®‰è£…æœ€æ–°ç‰ˆçš„Minicondaï¼š</p><pre><code class="hljs routeros">ENV <span class="hljs-attribute">LANG</span>=C.UTF-8 <span class="hljs-attribute">LC_ALL</span>=C.UTF-8ENV <span class="hljs-attribute">HADOOP_VERSION</span>=2.7.2LABEL <span class="hljs-attribute">HADOOP_VERSION</span>=2.7.2ENV <span class="hljs-attribute">MINICONDA_VERSION</span>=4.5.4Copy</code></pre><p>æ¥ä¸‹æ¥å®‰è£…å¿…é¡»çš„åŒ…ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®éœ€æ±‚è‡ªè¡Œè°ƒæ•´ï¼Œ<code>-y</code>æ ‡ç­¾ä»£è¡¨Yesï¼Œå³è‡ªåŠ¨åŒæ„å®‰è£…ï¼š</p><pre><code class="hljs livescript">RUN DEBIAN_FRONTEND=noninteractive &amp;&amp; <span class="hljs-string">\</span>    apt-get -y update &amp;&amp; <span class="hljs-string">\</span>    apt-get -y install build-essential <span class="hljs-string">\</span>        wget <span class="hljs-string">\</span>        git <span class="hljs-string">\</span>        curl <span class="hljs-string">\</span>        unzip <span class="hljs-string">\</span>        automake <span class="hljs-string">\</span>        openjdk-<span class="hljs-number">8</span>-jdk <span class="hljs-string">\</span>        openssh-server <span class="hljs-string">\</span>        openssh-client <span class="hljs-string">\</span>        lsof <span class="hljs-string">\</span>        libcupti-dev &amp;&amp; <span class="hljs-string">\</span>    apt-get clean &amp;&amp; <span class="hljs-string">\</span>    rm -rf <span class="hljs-regexp">/var/lib/apt/lists/</span>*Copy</code></pre><p>å®‰è£…Minicondaå¹¶è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œ<code>-b</code>æ ‡ç­¾å¯ä»¥è®©Minicondaæ— äº¤äº’è‡ªåŠ¨å®‰è£…ï¼š</p><pre><code class="hljs awk">RUN wget --quiet https:<span class="hljs-regexp">//</span>repo.anaconda.com<span class="hljs-regexp">/miniconda/</span>Miniconda3-<span class="hljs-variable">$&#123;MINICONDA_VERSION&#125;</span>-Linux-x86_64.sh &amp;&amp; <span class="hljs-regexp">/bin/</span>bash Miniconda3-<span class="hljs-variable">$&#123;MINICONDA_VERSION&#125;</span>-Linux-x86_64.sh -b -p <span class="hljs-regexp">/opt/mi</span>niconda \&amp;&amp; rm Miniconda3-<span class="hljs-variable">$&#123;MINICONDA_VERSION&#125;</span>-Linux-x86_64.shENV PATH <span class="hljs-regexp">/opt/mi</span>niconda<span class="hljs-regexp">/bin:$PATHCopy</span></code></pre><p>å®‰è£…Hadoopï¼ŒOpenPAIå¹³å°ä¼šç”¨åˆ°ï¼š</p><pre><code class="hljs awk">RUN wget -qO- http:<span class="hljs-regexp">//</span>archive.apache.org<span class="hljs-regexp">/dist/</span>hadoop<span class="hljs-regexp">/common/</span>hadoop-<span class="hljs-variable">$&#123;HADOOP_VERSION&#125;</span><span class="hljs-regexp">/hadoop-$&#123;HADOOP_VERSION&#125;.tar.gz | \</span><span class="hljs-regexp">    tar xz -C /u</span>sr<span class="hljs-regexp">/local &amp;&amp; \</span><span class="hljs-regexp">    mv /u</span>sr<span class="hljs-regexp">/local/</span>hadoop-<span class="hljs-variable">$&#123;HADOOP_VERSION&#125;</span> <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/hadoopCopy</span></code></pre><p><code>ENV</code>çš„ä½œç”¨æ˜¯é…ç½®ç¯å¢ƒå˜é‡ã€‚é…ç½®JAVAå’ŒHadoopç¯å¢ƒå˜é‡ï¼š</p><pre><code class="hljs routeros">ENV <span class="hljs-attribute">JAVA_HOME</span>=/usr/lib/jvm/java-8-openjdk-amd64 \    <span class="hljs-attribute">HADOOP_INSTALL</span>=/usr/local/hadoop \    <span class="hljs-attribute">NVIDIA_VISIBLE_DEVICES</span>=allENV <span class="hljs-attribute">HADOOP_PREFIX</span>=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span> \    <span class="hljs-attribute">HADOOP_BIN_DIR</span>=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span>/bin \    <span class="hljs-attribute">HADOOP_SBIN_DIR</span>=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span>/sbin \    <span class="hljs-attribute">HADOOP_HDFS_HOME</span>=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span> \    <span class="hljs-attribute">HADOOP_COMMON_LIB_NATIVE_DIR</span>=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span>/lib/native \    <span class="hljs-attribute">HADOOP_OPTS</span>=<span class="hljs-string">"-Djava.library.path=<span class="hljs-variable">$&#123;HADOOP_INSTALL&#125;</span>/lib/native"</span>Copy</code></pre><p>è®¾ç½®PATHç¯å¢ƒå˜é‡ï¼š</p><pre><code class="hljs elixir">ENV PATH=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/nvidia/bin</span><span class="hljs-symbol">:/usr/local/cuda/bin</span><span class="hljs-symbol">:/usr/local/sbin</span><span class="hljs-symbol">:/usr/local/bin</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/usr/bin</span><span class="hljs-symbol">:/sbin</span><span class="hljs-symbol">:/bin</span><span class="hljs-symbol">:</span><span class="hljs-variable">$&#123;</span>HADOOP_BIN_DIR&#125;<span class="hljs-symbol">:</span><span class="hljs-variable">$&#123;</span>HADOOP_SBIN_DIR&#125; \LD_LIBRARY_PATH=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/extras</span><span class="hljs-regexp">/CUPTI/lib</span><span class="hljs-symbol">:/usr/local/cuda/extras/CUPTI/lib64</span><span class="hljs-symbol">:/usr/local/nvidia/lib</span><span class="hljs-symbol">:/usr/local/nvidia/lib64</span><span class="hljs-symbol">:/usr/local/cuda/lib64</span><span class="hljs-symbol">:/usr/local/cuda/targets/x86_64-linux/lib/stubs</span><span class="hljs-symbol">:</span><span class="hljs-variable">$&#123;</span>JAVA_HOME&#125;/jre/lib/amd64/serverCopy</code></pre><p>å®Œæ•´çš„Dockerfileå¦‚ä¸‹ï¼š</p><pre><code class="hljs crystal">FROM nvidia/<span class="hljs-symbol">cuda:</span><span class="hljs-number">10.1</span>-cudnn7-devel-ubuntu18.<span class="hljs-number">0</span>4ENV LANG=C.UTF-<span class="hljs-number">8</span> LC_ALL=C.UTF-<span class="hljs-number">8</span>ENV HADOOP_VERSION=<span class="hljs-number">2.7</span>.<span class="hljs-number">2</span>LABEL HADOOP_VERSION=<span class="hljs-number">2.7</span>.<span class="hljs-number">2</span>ENV MINICONDA_VERSION=<span class="hljs-number">4.5</span>.<span class="hljs-number">4</span>RUN DEBIAN_FRONTEND=noninteractive &amp;&amp; \    apt-get -y update &amp;&amp; \    apt-get -y install build-essential \        wget \        git \        curl \        unzip \        automake \        openjdk-<span class="hljs-number">8</span>-jdk \        openssh-server \        openssh-client \        lsof \        libcupti-dev &amp;&amp; \    apt-get clean &amp;&amp; \    rm -rf /var/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">apt</span>/<span class="hljs-title">lists</span>/*</span>RUN wget --quiet <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/repo.anaconda.com/miniconda</span><span class="hljs-regexp">/Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh &amp;&amp; /bin</span><span class="hljs-regexp">/bash Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh -b -p /opt</span><span class="hljs-regexp">/miniconda \</span><span class="hljs-regexp">&amp;&amp; rm Miniconda3-$&#123;MINICONDA_VERSION&#125;-Linux-x86_64.sh</span><span class="hljs-regexp">ENV PATH /opt</span><span class="hljs-regexp">/miniconda/bin</span>:$PATH    RUN wget -qO- <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/archive.apache.org/dist</span><span class="hljs-regexp">/hadoop/common</span><span class="hljs-regexp">/hadoop-$&#123;HADOOP_VERSION&#125;/hadoop</span>-$&#123;HADOOP_VERSION&#125;.tar.gz | \    tar xz -C /usr/local &amp;&amp; \    mv /usr/local/hadoop-$&#123;HADOOP_VERSION&#125; /usr/local/hadoop    ENV JAVA_HOME=<span class="hljs-regexp">/usr/lib</span><span class="hljs-regexp">/jvm/java</span>-<span class="hljs-number">8</span>-openjdk-amd64 \    HADOOP_INSTALL=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/hadoop \</span><span class="hljs-regexp">    NVIDIA_VISIBLE_DEVICES=all</span><span class="hljs-regexp"></span><span class="hljs-regexp">ENV HADOOP_PREFIX=$&#123;HADOOP_INSTALL&#125; \</span><span class="hljs-regexp">    HADOOP_BIN_DIR=$&#123;HADOOP_INSTALL&#125;/bin</span> \    HADOOP_SBIN_DIR=$&#123;HADOOP_INSTALL&#125;/sbin \    HADOOP_HDFS_HOME=$&#123;HADOOP_INSTALL&#125; \    HADOOP_COMMON_LIB_NATIVE_DIR=$&#123;HADOOP_INSTALL&#125;/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">native</span> \</span>    HADOOP_OPTS=<span class="hljs-string">"-Djava.library.path=$&#123;HADOOP_INSTALL&#125;/lib/native"</span>ENV PATH=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/nvidia/bin</span>:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/bin</span>:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/sbin:/usr</span><span class="hljs-regexp">/local/bin</span>:<span class="hljs-regexp">/usr/sbin</span>:<span class="hljs-regexp">/usr/bin</span>:<span class="hljs-regexp">/sbin:/bin</span>:$&#123;HADOOP_BIN_DIR&#125;:$&#123;HADOOP_SBIN_DIR&#125;:$PATH \LD_LIBRARY_PATH=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/extras</span><span class="hljs-regexp">/CUPTI/lib</span>:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/extras</span><span class="hljs-regexp">/CUPTI/lib</span>64:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/nvidia/lib</span>:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/nvidia/lib</span>64:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/lib</span>64:<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/cuda/targets</span><span class="hljs-regexp">/x86_64-linux/lib</span><span class="hljs-regexp">/stubs:$&#123;JAVA_HOME&#125;/jre</span><span class="hljs-regexp">/lib/amd</span>64/serverCopy</code></pre><p>å»ºè®®å…ˆæŠŠè¿™ä¸€éƒ¨åˆ†è¿›è¡Œæ„å»ºï¼Œä½œä¸ºåŸºç¡€é•œåƒï¼Œåé¢è¦é…ç½®å…¶ä»–ç¯å¢ƒï¼ˆå¦‚å®‰è£…Pytorchæ¡†æ¶ç™»ï¼‰ï¼Œå°±ä¸ç”¨é‡å¤æ„å»ºè¿™éƒ¨åˆ†ï¼Œè¿˜å‡å°‘äº†å‡ºé”™çš„å¯èƒ½æ€§ã€‚è¿™é‡Œè¯´ä¸€ä¸‹ï¼Œå¯åŠ¨å¸¦CUDAçš„Dockeré•œåƒéœ€è¦åœ¨<code>docker run</code>åŠ ä¸Šé¢å¤–çš„å‚æ•°<code>--runtime nvidia</code>ã€‚</p><p>æ¥ä¸‹æ¥å®‰è£…æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚</p><h2 id="Configure-PyTorch"><a href="#Configure-PyTorch" class="headerlink" title="Configure PyTorch"></a>Configure PyTorch</h2><p>å‡è®¾ä¸Šé¢çš„é•œåƒæˆ‘ä»¬å‘½åä¸ºxiaoqinfeng/baseï¼Œé‚£ä¹ˆæ„å»ºPyTorchçš„Dockerfileå¯ä»¥åƒä¸‹é¢è¿™ä¹ˆå†™ï¼š</p><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> xiaoqinfeng/base<span class="hljs-keyword">RUN</span><span class="bash"> pip install -U pip</span><span class="hljs-keyword">RUN</span><span class="bash"> pip install numpy scipy pandas matplotlib tqdm</span><span class="hljs-keyword">RUN</span><span class="bash"> pip install torch==1.5.0+cu101 torchvision==0.6.0+cu101 -f https://download.pytorch.org/whl/torch_stable.htmlCopy</span></code></pre><p>å› ä¸ºè¿™é‡Œæˆ‘ç”¨çš„CUDA10.1ï¼Œå…¶ä»–ç‰ˆæœ¬çš„CUDAå®‰è£…æŒ‡ä»¤å¯èƒ½ä¸å¤ªä¸€æ ·ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener">å®˜ç½‘</a>ã€‚</p><h2 id="Configure-Tensorflow"><a href="#Configure-Tensorflow" class="headerlink" title="Configure Tensorflow"></a>Configure Tensorflow</h2><p>å¦‚æœæ˜¯å®‰è£…Tensorflowï¼Œé‚£ä¹ˆæ„å»ºTensorflowçš„Dockerfileå¯ä»¥åƒä¸‹é¢è¿™ä¹ˆå†™ï¼š</p><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> xiaoqinfeng/base<span class="hljs-keyword">RUN</span><span class="bash"> pip install -U pip</span><span class="hljs-keyword">RUN</span><span class="bash"> pip install numpy scipy pandas matplotlib tqdm tensorflow-gpuCopy</span></code></pre><p>è¿™é‡Œä¼šè‡ªåŠ¨å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Tensorflow2ã€‚Tensorflowä¸åŒç‰ˆæœ¬å¯¹CUDAå’ŒcuDNNç‰ˆæœ¬ç”šè‡³Pythonç‰ˆæœ¬çš„æ”¯æŒéƒ½ä¸å¤ªä¸€æ ·ï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.tensorflow.org/install/source#linux" target="_blank" rel="noopener">å®˜ç½‘</a>çš„è¯´æ˜ã€‚</p><h1 id="Deep-Learning-with-OpenPAI"><a href="#Deep-Learning-with-OpenPAI" class="headerlink" title="Deep Learning with OpenPAI"></a>Deep Learning with OpenPAI</h1><h2 id="What-is-OpenPAI"><a href="#What-is-OpenPAI" class="headerlink" title="What is OpenPAI"></a>What is OpenPAI</h2><p>OpenPAIæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ·±åº¦å­¦ä¹ è®¡ç®—èµ„æºç®¡ç†å¹³å°ï¼Œå¯¹äºæˆ‘ä»¬ç”¨æˆ·æ¥è¯´ï¼Œåªéœ€è¦å®šä¹‰å¥½Dockeré•œåƒï¼Œç„¶åç¼–å†™å¥½ä»»åŠ¡è®¾ç½®ï¼Œæäº¤åˆ°å¹³å°ä¹‹åï¼Œå¹³å°ä¾¿ä¼šè‡ªåŠ¨åˆ†é…è®¡ç®—èµ„æºæ¥è¿è¡Œä»»åŠ¡ã€‚</p><p>OpenPAIç•Œé¢ï¼š</p><img src="https://i.loli.net/2020/06/24/CDrZjgYR7lNcieh.png" srcset="/img/loading.gif" style="zoom: 50%;" /><img src="https://i.loli.net/2020/06/24/FGJpVCbls7YP4aM.png" srcset="/img/loading.gif" style="zoom: 50%;" /><p>ä¸‹é¢æˆ‘ä»¬æ¥è®²è®²æ€ä¹ˆå‘OpenPAIå¹³å°æäº¤ä»»åŠ¡ã€‚</p><h2 id="Submit-Jobs-to-OpenPAI"><a href="#Submit-Jobs-to-OpenPAI" class="headerlink" title="Submit Jobs to OpenPAI"></a>Submit Jobs to OpenPAI</h2><h3 id="Pack-Code-amp-Data-Files"><a href="#Pack-Code-amp-Data-Files" class="headerlink" title="Pack Code &amp; Data Files"></a>Pack Code &amp; Data Files</h3><p>å‡è®¾ä½ å·²ç»å®Œæˆäº†ä»£ç çš„ç¼–å†™å’Œæµ‹è¯•ï¼Œä½ çš„ç›®å½•ç»“æ„å¯èƒ½çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼š</p><pre><code class="hljs css">.â”œâ”€â”€ <span class="hljs-selector-tag">README</span><span class="hljs-selector-class">.md</span>â”œâ”€â”€ <span class="hljs-selector-tag">data</span>â”‚   â””â”€â”€ <span class="hljs-selector-tag">dataset</span><span class="hljs-selector-class">.csv</span>â”œâ”€â”€ <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.py</span>â””â”€â”€ <span class="hljs-selector-tag">src</span>    â”œâ”€â”€ <span class="hljs-selector-tag">data</span><span class="hljs-selector-class">.py</span>    â””â”€â”€ <span class="hljs-selector-tag">net</span><span class="hljs-selector-class">.pyCopy</span></code></pre><p>å› ä¸ºOpenPAIä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿå®¹å™¨æ¥è¿è¡Œä½ çš„ä»£ç ï¼Œæ‰€ä»¥ä½ çš„æ•°æ®å’Œä»£ç å¿…é¡»è¦ä»¥æŸç§æ–¹å¼ä¼ é€åˆ°OpenPAIä¸Šçš„è™šæ‹Ÿå®¹å™¨ä¸­ã€‚æˆ‘ä»¬å…ˆæ¥æ‰“åŒ…ï¼Œåœ¨ä»£ç ç›®å½•ä¸‹æ‰§è¡Œ<code>tar -cvf files.tar ./</code>ã€‚ä¹‹åï¼Œè¿è¡Œ<code>python -m http.server &lt;port&gt;</code>ã€‚æ‰“å¼€æµè§ˆå™¨è¾“å…¥<code>&lt;server_ip&gt;:&lt;port&gt;</code>åº”è¯¥å°±èƒ½çœ‹åˆ°ä½ çš„æ–‡ä»¶äº†ï¼š</p><p><img src="https://i.loli.net/2020/06/24/Cbgiw3XKnGYsNHp.png" srcset="/img/loading.gif" alt=""></p><p>ç”±äºè¿™ä¸ªhttpè¿›ç¨‹éœ€è¦ä¸€ç›´è¿è¡Œï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨<code>screen</code>æ”¾åˆ°åå°æ‰§è¡Œã€‚</p><h3 id="Configure-Tasks"><a href="#Configure-Tasks" class="headerlink" title="Configure Tasks"></a>Configure Tasks</h3><p>åƒOpenPAIæäº¤ä»»åŠ¡å¯ä»¥é‡‡ç”¨ç½‘é¡µæäº¤ä¹Ÿå¯ä»¥ä½¿ç”¨VSCodeæ’ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç½‘é¡µæäº¤ã€‚ç™»å…¥OpenPAIç•Œé¢ï¼Œç‚¹å‡»Submit Jobï¼š</p><p><img src="https://i.loli.net/2020/06/24/bhXAcJfOmo8RtT2.png" srcset="/img/loading.gif" alt=""></p><p>å¯ä»¥çœ‹åˆ°æäº¤ä»»åŠ¡çš„ç•Œé¢ï¼š</p><p><img src="https://i.loli.net/2020/06/24/KME8GuN49gyY1ph.png" srcset="/img/loading.gif" alt=""></p><p>Job nameå¤§å®¶å¯ä»¥è‡ªå·±è®¾ç½®ã€‚åœ¨Commandä¸€æ ï¼Œæ˜¯æ‰§è¡Œä»»åŠ¡æ‰€éœ€çš„å…¨éƒ¨å‘½ä»¤ï¼Œé¦–å…ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯å°†ä»£ç æ•°æ®å‹ç¼©åŒ…ä¸‹è½½åˆ°å®¹å™¨ä¸­å¹¶è§£å‹ï¼š</p><pre><code class="hljs elixir">wget &lt;server_ip&gt;<span class="hljs-symbol">:&lt;port&gt;/files</span>.tartar -xvf files.tarCopy</code></pre><p>ç„¶åæ˜¯è¿è¡Œä»£ç ï¼Œå‡è®¾æˆ‘è¿™é‡Œçš„ä»»åŠ¡æ¯”è¾ƒç®€å•ï¼Œåªæœ‰ä¸€è¡Œmain.pyçš„è°ƒç”¨ï¼š</p><pre><code class="hljs css"><span class="hljs-selector-tag">python</span> <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.pyCopy</span></code></pre><p>å¦‚æœä»»åŠ¡çš„æ‰§è¡Œæ¯”è¾ƒå¤æ‚ï¼Œä¹Ÿåªéœ€æŠŠå‘½ä»¤å¡«åˆ°Commandé‡Œå³å¯ï¼ŒOpenPAIä¼šè‡ªåŠ¨æ‰§è¡Œã€‚æ¥ä¸‹æ¥æ˜¯è®¾ç½®é…ç½®ï¼Œå¯ä»¥é€‰GPUçš„æ•°é‡ï¼Œå†…å­˜å¤§å°ç­‰ç­‰ï¼š</p><img src="https://i.loli.net/2020/06/24/T7ryOxjpJP4FWYR.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ç„¶åæ˜¯é•œåƒçš„é€‰æ‹©ï¼š</p><img src="https://i.loli.net/2020/06/24/3n7SpNlsLjBRvgE.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>è¦æ³¨æ„åœ¨æœ¬æœºä¸Šæ„å»ºå¥½é•œåƒä¹‹åï¼Œéœ€è¦æŠŠé•œåƒé‡å‘½åä¸º<code>&lt;repository_address&gt;/&lt;image_name&gt;</code>çš„æ ¼å¼ï¼ˆæˆ‘ä»¬çš„<code>&lt;repository&gt;</code>æ˜¯<code>lin-ai-27:5000</code>ï¼Œå‡è®¾æˆ‘çš„é•œåƒåæ˜¯<code>xiaoqinfeng/pytorch</code>ï¼Œé‚£å°±æ˜¯æ”¹æˆ<code>lin-ai-27:5000/xiaoqinfeng/pytorch</code>ï¼‰ï¼Œç„¶åæ‰§è¡Œ<code>docker push</code>æ¨é€åˆ°Dockeré•œåƒæœåŠ¡å™¨ä¸Šæ‰èƒ½åœ¨OpenPAIä¸Šä½¿ç”¨ã€‚</p><p>æäº¤ä¹‹åï¼Œå¯ä»¥åœ¨Jobsç•Œé¢çœ‹åˆ°ä»»åŠ¡çš„è¿è¡Œæƒ…å†µï¼š</p><img src="https://i.loli.net/2020/06/24/ZD4cUgOCIqnyHdB.png" srcset="/img/loading.gif" style="zoom: 50%;" />]]></content>
    
    
    <categories>
      
      <category>Technical Notes</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Pytorch</tag>
      
      <tag>Tensorflow</tag>
      
      <tag>Docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ubuntu20.04LTS æ·±åº¦å­¦ä¹ ç¯å¢ƒé…ç½® CUDA10.2 + cuDNN7.6.5 + Tensorflow + Pytorch</title>
    <link href="/2020/06/02/Ubuntu20-4LTS-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-CUDA10-2-cuDNN7-6-5-Tensorflow-Pytorch/"/>
    <url>/2020/06/02/Ubuntu20-4LTS-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-CUDA10-2-cuDNN7-6-5-Tensorflow-Pytorch/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Ubuntuçš„æœ€æ–°LTSç‰ˆæœ¬ä¹Ÿæ›´æ–°åˆ°äº†20.04ï¼Œåœ¨ç»™æ–°æœºå™¨é…ç½®æ·±åº¦å­¦ä¹ ç¯å¢ƒçš„æ—¶å€™å‘ç°æ¯”ä»¥å‰å®¹æ˜“äº†è®¸å¤šï¼Œç‰¹æ­¤å†™ä¸€ç¯‡Tutorialã€‚è¿™é‡Œçš„å®‰è£…æ–¹æ³•åªé’ˆå¯¹Ubuntu20.04LTSï¼Œå¯¹äºå…¶ä»–ç‰ˆæœ¬çš„ç³»ç»Ÿå¯èƒ½ä¸å¤ªé€‚ç”¨ã€‚</p><h1 id="Install-GPU-Drivers"><a href="#Install-GPU-Drivers" class="headerlink" title="Install GPU Drivers"></a>Install GPU Drivers</h1><p>è¿™é‡Œå‡è®¾å®‰è£…ç³»ç»Ÿä¹‹åå·²ç»åšå¥½äº†å¿…è¦çš„é…ç½®ï¼ˆå®‰è£…å¸¸ç”¨è½¯ä»¶ä¾èµ–ã€ä¿®æ”¹å›½å†…æºç­‰ï¼‰ã€‚Ubuntu20.04ä¸­GPUé©±åŠ¨å¯ä»¥ç›´æ¥é€šè¿‡GUIç•Œé¢å®‰è£…ï¼Œååˆ†æ–¹ä¾¿ï¼Œæ–¹æ³•æ˜¯æ‰¾åˆ°è½¯ä»¶ä¸æ›´æ–° (Software &amp; Updates)ï¼Œåœ¨é™„åŠ é©±åŠ¨ (additional drivers) é€‰é¡¹å¡ä¸­é€‰æ‹©é©±åŠ¨ç‰ˆæœ¬ï¼Œä¸€èˆ¬æ˜¯é€‰æ‹©â€œä¸“æœ‰ï¼Œtestedâ€ (proprietary, tested) é‚£ä¸ªï¼Œä¹‹åç‚¹Apply Changesï¼Œé‡å¯ã€‚</p><p><img src="https://i.loli.net/2020/06/24/xevtVosYOH7D68I.png" srcset="/img/loading.gif" alt=""></p><h1 id="Install-CUDA-amp-cuDNN"><a href="#Install-CUDA-amp-cuDNN" class="headerlink" title="Install CUDA &amp; cuDNN"></a>Install CUDA &amp; cuDNN</h1><p>è¿™é‡Œé€‰æ‹©apt-getçš„æ–¹å¼å®‰è£…CUDAï¼š</p><pre><code class="hljs bash">sudo apt-get install nvidia-cuda-toolkit</code></pre><p>è¾“å…¥<code>nvcc --version</code>å¯ä»¥æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸï¼Œè¾“å…¥<code>nvidia-smi</code>å¯ä»¥çœ‹åˆ°GPUä¿¡æ¯å’ŒCUDAç‰ˆæœ¬ã€‚</p><p>ä¹‹åå®‰è£…cuDNNï¼Œè¿›å…¥<a href="https://developer.nvidia.com/cudnn" target="_blank" rel="noopener">å®˜ç½‘</a>ï¼Œé€‰æ‹©Download cuDNNï¼š</p><p><img src="https://i.loli.net/2020/06/24/VYBRoINFDC9ObA1.png" srcset="/img/loading.gif" alt=""></p><p>ä¼šè¦æ±‚ç™»å½•ï¼Œå¦‚æœæ²¡æœ‰è´¦å·çš„æ³¨å†Œä¸€ä¸ªå³å¯ã€‚åœ¨è¿™é‡Œæ ¹æ®CUDAç‰ˆæœ¬é€‰æ‹©é€‚åˆçš„cuDNNï¼Œæˆ‘è¿™é‡Œæ˜¯CUDA10.2ã€‚æˆ‘ä»¬é€‰æ‹©debåŒ…çš„æ–¹å¼å®‰è£…ï¼Œä¸‹è½½ä¸‹å›¾ä¸­åœˆå‡ºæ¥çš„ä¸‰ä¸ªdebåŒ…ï¼Œä¾æ¬¡ç”¨<code>sudo dpkg -i xxx.deb</code>å‘½ä»¤å®‰è£…ã€‚</p><p><img src="https://i.loli.net/2020/06/24/qcDG5t3JY6vfoQM.png" srcset="/img/loading.gif" alt=""></p><h1 id="Configure-Python"><a href="#Configure-Python" class="headerlink" title="Configure Python"></a>Configure Python</h1><p>ä¸ºäº†æ›´å¥½åœ°ç®¡ç†PythonåŒ…å’Œè™šæ‹Ÿç¯å¢ƒï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…Anacondaã€‚ä½¿ç”¨Anacondaä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œè™šæ‹Ÿç¯å¢ƒä¹‹é—´äº’ä¸å¹²æ‰°ã€‚åšç§‘å­¦å®éªŒæˆ‘ä»¬ä¸€èˆ¬éœ€è¦å®‰è£…å¤§é‡çš„PythonåŒ…ï¼Œæœ‰çš„åŒ…ä¹‹é—´ç”šè‡³è¿˜æœ‰å†²çªï¼Œå¦‚æœæˆ‘ä»¬æŠŠä»–ä»¬éƒ½å®‰è£…åœ¨åŒä¸€ä¸ªç¯å¢ƒä¸‹å°±ä¼šéš¾ä»¥ç®¡ç†ï¼Œç”šè‡³å‡ºå†²çªã€‚è€Œæœ‰äº†è™šæ‹Ÿç¯å¢ƒä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸åŒéœ€æ±‚æ”¾åœ¨ä¸åŒè™šæ‹Ÿç¯å¢ƒä¸­ï¼Œæ¯”å¦‚æ·±åº¦å­¦ä¹ å¼€å‘æ”¾åœ¨ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒä¸­ï¼ˆå®‰è£…Tensorflowç­‰ï¼‰ï¼Œç½‘ç«™å¼€å‘æ”¾åœ¨ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒä¸­ï¼ˆå®‰è£…Flaskç­‰ï¼‰ã€‚Anacondaé»˜è®¤è‡ªå¸¦å¤§é‡çš„åŒ…ï¼Œä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬ä¼šåˆ›å»ºæ–°çš„è™šæ‹Ÿç¯å¢ƒå»å®‰è£…æ–°çš„åŒ…ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬é€‰ç”¨Minicondaã€‚Minicondaå’ŒAnacondaå”¯ä¸€çš„åŒºåˆ«æ˜¯ä¸ä¼šè‡ªå¸¦å¤§é‡PythonåŒ…ï¼Œè¿™é‡Œå¤§å®¶è‡ªè¡Œé€‰æ‹©ã€‚Anacondaå›½å†…é•œåƒä¸‹è½½åœ°å€ä¸ºï¼š<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/ï¼ŒMinicondaå›½å†…é•œåƒä¸‹è½½åœ°å€ä¸ºï¼šhttps://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/ã€‚" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/ï¼ŒMinicondaå›½å†…é•œåƒä¸‹è½½åœ°å€ä¸ºï¼šhttps://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/ã€‚</a></p><p>æ¯”å¦‚è¯´æˆ‘ä»¬ä¸‹è½½çš„æ˜¯<code>Miniconda3-py38_4.8.2-Linux-x86_64.sh</code>ï¼Œæ‰§è¡Œ<code>bash Miniconda3-py38_4.8.2-Linux-x86_64.sh</code>å³å¯å®‰è£…ã€‚æ˜¾ç¤ºä¸€å¤§å±ç”¨æˆ·åè®®å“ªå„¿æŒ‰<code>q</code>å¯ä»¥ç›´æ¥è·³è¿‡ï¼Œå…¶ä»–é€‰é¡¹çš„é»˜è®¤çš„è¾“å…¥<code>yes</code>å³å¯ã€‚åœ¨æç¤ºæ˜¯å¦éœ€è¦conda initçš„æ—¶å€™è®°å¾—è¾“å…¥<code>yes</code>ã€‚</p><p>å®‰è£…æˆåŠŸä¹‹åï¼Œé‡å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œå¯ä»¥çœ‹åˆ°ç°åœ¨å¤„äº<code>base</code>ç¯å¢ƒä¸­ï¼š</p><p><img src="https://i.loli.net/2020/06/24/giml1UKzWuyqTjr.png" srcset="/img/loading.gif" alt=""></p><p>æˆ‘ä»¬å…ˆé…ç½®ä¸€ä¸‹å›½å†…é•œåƒï¼Œæ‰§è¡Œ</p><pre><code class="hljs bash">vim ~/.condarc</code></pre><p>ç„¶åç²˜è´´ä¸‹åˆ—æ–‡æœ¬ä½¿ç”¨æ¸…åæºï¼š</p><pre><code class="hljs less"><span class="hljs-attribute">channels</span>:  - defaults<span class="hljs-attribute">show_channel_urls</span>: true<span class="hljs-attribute">channel_alias</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda</span><span class="hljs-attribute">default_channels</span>:  - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main</span>  - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free</span>  - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r</span>  - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/pro</span>  - <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2</span><span class="hljs-attribute">custom_channels</span>:  <span class="hljs-attribute">conda-forge</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span>  <span class="hljs-attribute">msys2</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span>  <span class="hljs-attribute">bioconda</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span>  <span class="hljs-attribute">menpo</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span>  <span class="hljs-attribute">pytorch</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span>  <span class="hljs-attribute">simpleitk</span>: <span class="hljs-attribute">https</span>:<span class="hljs-comment">//mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span></code></pre><p>ä¹‹åæˆ‘ä»¬è¾“å…¥<code>conda create -n &lt;your_name&gt;</code>åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒï¼Œå¦‚æœéœ€è¦æŒ‡å®šPythonç‰ˆæœ¬ï¼Œåˆ™<code>conda create --n &lt;your_name&gt; python=&lt;python_version&gt;</code>ã€‚ä¹‹åè¾“å…¥<code>conda activate &lt;your_name&gt;</code>è¿›å…¥è™šæ‹Ÿç¯å¢ƒï¼Œå¦‚æœéœ€è¦é€€å‡ºï¼Œåˆ™ä½¿ç”¨<code>conda deactivate</code>ã€‚</p><p>å®‰è£…å¸¸ç”¨åŒ…ï¼š</p><pre><code class="hljs bash">conda install --yes numpy scipy pandas matplotlib tqdm pip jupyter</code></pre><p><code>--yes</code>çš„ä½œç”¨æ˜¯æ‰‹åŠ¨è¾“å…¥<code>y</code>æ¥ç¡®è®¤æ˜¯å¦å®‰è£…ï¼Œè¿™é‡Œåˆ—å‡ºçš„æ˜¯ä¸€äº›æœ€å¸¸ç”¨çš„PythonåŒ…ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è‡ªè¡Œè°ƒæ•´ã€‚<code>conda install</code>ä¸ºAnacondaä¸­å®‰è£…PythonåŒ…çš„æ–¹å¼ã€‚</p><h1 id="Install-PyTorch"><a href="#Install-PyTorch" class="headerlink" title="Install PyTorch"></a>Install PyTorch</h1><p>è¿™é‡Œæ¥å®‰è£…PyTorchç¯å¢ƒï¼Œæ¨èä½¿ç”¨<code>conda create -n pytorch</code>åˆ›å»ºä¸€ä¸ªä¸“æœ‰è™šæ‹Ÿç¯å¢ƒï¼Œç„¶åä½¿ç”¨<code>conda install</code>å®‰è£…å¸¸ç”¨åŒ…ã€‚å¯¹äºå®‰è£…PyTorchï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>conda</code>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>pip</code>å®‰è£…ã€‚<code>pip</code>æ˜¯å¦å¤–ä¸€ä¸ªå®‰è£…PythonåŒ…çš„å·¥å…·ï¼Œç”±äºä¸æ£€æŸ¥ä¾èµ–æ‰€ä»¥æ¯”<code>conda</code>å®‰è£…é€Ÿåº¦å¿«ï¼Œè€Œä¸”åŒ…çš„æ•°é‡æ¯”<code>conda</code>å¤šï¼Œä½¿ç”¨ä¹Ÿæ›´å¹¿æ³›ã€‚åŒæ ·<code>pip</code>ä¹Ÿå¯ä»¥ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿä¸‹è½½ï¼Œè¯¦è§<a href="https://mirrors.tuna.tsinghua.edu.cn/help/pypi/ã€‚" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/help/pypi/ã€‚</a></p><p>å¯¹äºCUDA10.2ï¼Œå®˜æ–¹ç»™å‡ºçš„ç”¨<code>conda</code>å®‰è£…PyTorchçš„å‘½ä»¤æ˜¯ï¼š</p><pre><code class="hljs bash">conda install pytorch torchvision cudatoolkit=10.2 -c pytorch</code></pre><p>ç”¨<code>pip</code>å®‰è£…PyTorchçš„å‘½ä»¤æ˜¯ï¼š</p><pre><code class="hljs bash">pip install torch torchvision</code></pre><p>å¯¹äºå…¶ä»–ç‰ˆæœ¬çš„CUDAå®‰è£…å‘½ä»¤å¯èƒ½ä¸ä¸€æ ·ï¼Œå¯ä»¥å»<a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener">å®˜ç½‘</a>æŸ¥çœ‹ã€‚</p><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•GPUç‰ˆæœ¬çš„PyTorchæ˜¯å¦æ­£å¸¸å·¥ä½œï¼š</p><pre><code class="hljs bash">python -c <span class="hljs-string">"import torch; print(torch.cuda.is_available())"</span></code></pre><h1 id="Install-Tensorflow"><a href="#Install-Tensorflow" class="headerlink" title="Install Tensorflow"></a>Install Tensorflow</h1><p>å®‰è£…Tensorflowç¯å¢ƒåŒæ ·æ¨èåˆ›å»ºä¸€ä¸ªä¸“æœ‰è™šæ‹Ÿç¯å¢ƒã€‚å¯¹äºTensorflow2çš„å®‰è£…ï¼Œä½¿ç”¨<code>pip</code>ååˆ†æ–¹ä¾¿ï¼Œä½¿ç”¨</p><pre><code class="hljs bash">pip install tensorflow tensorflow-gpu</code></pre><p>å³å¯ã€‚è¦å®‰è£…å…¶ä»–ç‰ˆæœ¬çš„Tensorflowå¯ä»¥ä½¿ç”¨<code>pip install tensorflow==&lt;tf_version&gt; tensorflow-gpu==&lt;tf_version&gt;</code>æ¥æŒ‡å®šç‰ˆæœ¬ã€‚ä¸è¿‡ä¸åŒç‰ˆæœ¬çš„Tensorflowè¦æ±‚çš„CUDAç‰ˆæœ¬éƒ½æœ‰æ‰€ä¸åŒï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.tensorflow.org/install/source#linux" target="_blank" rel="noopener">å®˜ç½‘</a>çš„è¯´æ˜ã€‚</p><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•GPUç‰ˆæœ¬çš„Tensorflowæ˜¯å¦æ­£å¸¸å·¥ä½œï¼š</p><pre><code class="hljs bash">python -c <span class="hljs-string">"import tensorflow as tf; tf.config.list_physical_devices('GPU')"</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>Technical Notes</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Pytorch</tag>
      
      <tag>Tensorflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Deep Anomaly Detection Using Geometric Transformations</title>
    <link href="/2020/06/01/Deep-Anomaly-Detection-Using-Geometric-Transformations/"/>
    <url>/2020/06/01/Deep-Anomaly-Detection-Using-Geometric-Transformations/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡è€ƒè™‘å›¾åƒæ•°æ®çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜ã€‚ä¸åŸºäºé‡æ„çš„æ–¹æ³•ä¸åŒï¼Œæœ¬æ–‡æå‡ºçš„æ–¹æ³•é€šè¿‡å¯¹æ­£å¸¸å›¾ç‰‡æ–½åŠ ä¸åŒçš„å‡ ä½•å˜æ¢ä¹‹åï¼Œè®­ç»ƒä¸€ä¸ªå¤šåˆ†ç±»å™¨å°†æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹é—®é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªæœ‰ç›‘ç£é—®é¢˜ã€‚æœ¬æ–¹æ³•èƒŒåçš„ç›´è§‰æ˜¯åœ¨è®­ç»ƒèƒ½å¤Ÿåˆ†è¾¨ä¸åŒå˜æ¢åçš„å›¾ç‰‡ä¹‹åï¼Œåˆ†ç±»å™¨ä¸€å®šå­¦å¾—äº†ä¸€äº›æ˜¾è‘—çš„å‡ ä½•ç‰¹å¾ï¼Œè¿™äº›å‡ ä½•ç‰¹å¾æ˜¯æ­£å¸¸ç±»åˆ«ç‹¬æœ‰çš„ã€‚</p><h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1><h2 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h2><p>æœ¬æ–‡è€ƒè™‘é’ˆå¯¹å›¾åƒçš„å¼‚å¸¸æ£€æµ‹ã€‚è®°$\mathcal X$ä¸ºæ‰€æœ‰è‡ªç„¶å›¾åƒçš„ç©ºé—´ï¼Œ$X\subseteq\mathcal X$ä¸ºæ­£å¸¸å›¾åƒé›†åˆã€‚ç»™å®šæ•°æ®é›†$S\subseteq X$ï¼Œå¼‚å¸¸æ£€æµ‹çš„ç›®çš„æ˜¯å­¦ä¹ ä¸€ä¸ªåˆ†ç±»å™¨$h_S(x):\mathcal X\rightarrow{0,1}$ï¼Œå…¶ä¸­$h_S(x)=1\Leftrightarrow x\in X$ã€‚</p><p>ä¸ºäº†å…¼é¡¾æŸ¥å‡†ç‡å’ŒæŸ¥å…¨ç‡ï¼Œå¸¸ç”¨çš„è®¾ç½®æ˜¯å­¦ä¹ ä¸€ä¸ªæ‰“åˆ†å‡½æ•°$n_S(x):\mathcal X\rightarrow\mathbb R$ï¼Œåˆ†æ•°è¶Šé«˜ä»£è¡¨æ ·æœ¬å±äº$X$çš„æ¦‚ç‡è¶Šå¤§ã€‚ä¹‹åï¼Œé€šè¿‡è®¾å®šé˜ˆå€¼ï¼Œä¾¿å¯ä»¥æ„å»ºå¼‚å¸¸åˆ†ç±»å™¨ï¼š<br>$$<br>\begin{align}<br>h_S^\lambda(x)=<br>\begin{cases}<br>1 &amp; n_S(x)\leq\lambda\<br>0 &amp; n_S(x)&lt;\lambda<br>\end{cases}<br>\end{align}<br>$$</p><h2 id="Discriminative-Learning-of-an-Anomaly-Scoring-Function-Using-Geometric-Transformations"><a href="#Discriminative-Learning-of-an-Anomaly-Scoring-Function-Using-Geometric-Transformations" class="headerlink" title="Discriminative Learning of an Anomaly Scoring Function Using Geometric Transformations"></a>Discriminative Learning of an Anomaly Scoring Function Using Geometric Transformations</h2><p>æœ‰åˆå§‹æ•°æ®é›†$S$ï¼Œå‡ ä½•å˜æ¢é›†åˆ$\mathcal T$ï¼Œé€šè¿‡å¯¹$S$ä¸­æ¯ä¸ªæ ·æœ¬æ–½åŠ è¿™$|\mathcal T|$ä¸ªå‡ ä½•å˜æ¢å¾—åˆ°æ–°æ•°æ®é›†è®°ä¸º$S_\mathcal{T}$ï¼Œä¸”$S_\mathcal{T}$ä¸­æ¯ä¸ªæ ·æœ¬çš„æ ‡ç­¾ä¸ºå˜æ¢çš„åºå·ã€‚ä¹‹åï¼Œåœ¨$S_\mathcal{T}$ä¸Šè®­ç»ƒä¸€ä¸ª$|\mathcal T|$åˆ†ç±»å™¨ã€‚åœ¨æµ‹è¯•é˜¶æ®µï¼Œå¯¹æµ‹è¯•æ ·æœ¬åŒæ ·æ–½åŠ $|\mathcal T|$ä¸ªå‡ ä½•å˜æ¢ï¼Œåˆ†ç±»å™¨ä¼šç»™å‡ºç»è¿‡$\mathrm{softmax}$çš„è¾“å‡ºå‘é‡ï¼Œæœ€ç»ˆçš„å¼‚å¸¸åˆ†æ•°ç”±ç»è¿‡è¾“å‡ºçš„å‘é‡æ„é€ çš„åˆ†å¸ƒå¯¹æ•°ä¼¼ç„¶å¾—æ¥ã€‚</p><h3 id="Creating-and-Learning-the-Self-Labeled-Dataset"><a href="#Creating-and-Learning-the-Self-Labeled-Dataset" class="headerlink" title="Creating and Learning the Self-Labeled Dataset"></a>Creating and Learning the Self-Labeled Dataset</h3><p>è®¾$\mathcal T={T_0,T_1,\cdots,T_{k-1}}$ä¸ºå‡ ä½•å˜æ¢é›†åˆï¼Œ$1\leq i\leq k-1,\space T_i:\mathcal X\rightarrow \mathcal X$ï¼Œä¸”$T_0(x)=x$ã€‚$S_\mathcal{T}$å®šä¹‰ä¸ºï¼š</p><p>$$<br>S_\mathcal T={(T_j(x),j):x\in S,T_j\in\mathcal T}<br>$$<br>å¯¹äºæ¯ä¸ª$x\in S$ï¼Œ$j$ä¸º$T_j(x)$çš„æ ‡ç­¾ã€‚æˆ‘ä»¬ç›´æ¥å­¦ä¹ ä¸€ä¸ª$K$ç±»åˆ†ç±»å™¨$f_\theta$ï¼Œæ¥é¢„æµ‹è¾“å…¥æ ·æœ¬å¯¹åº”çš„å‡ ä½•å˜æ¢ç§ç±»ï¼Œè¿™ç›¸å½“äºæ˜¯ä¸€ä¸ªå›¾åƒåˆ†ç±»é—®é¢˜ã€‚</p><img src="https://i.loli.net/2020/06/24/XBFKcPio64u3U1C.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Dirichlet-Normality-Score"><a href="#Dirichlet-Normality-Score" class="headerlink" title="Dirichlet Normality Score"></a>Dirichlet Normality Score</h3><p>æ¥ä¸‹æ¥è¦åšçš„æ˜¯å¦‚ä½•å®šä¹‰å¼‚å¸¸åˆ†æ•°ï¼Œè®°ä¸º$n_S(x)$ï¼Œè¿™æ˜¯æ–‡ä¸­çš„ä¸€ä¸ªé‡è¦çš„éƒ¨åˆ†ã€‚è®¾å‡ ä½•å˜æ¢é›†åˆ$\mathcal T={T_0,T_1,\cdots,T_{k-1}}$ï¼Œä¸”$k$åˆ†ç±»å™¨$f_\theta$åœ¨$S_\mathcal{T}$ä¸Šå®Œæˆè®­ç»ƒã€‚å¯¹äºä»»æ„ä¸€ä¸ªæ ·æœ¬$x$ï¼Œä»¤$\mathbf y(x)=\text{softmax}(f_{\theta}(x))$ï¼Œå³åˆ†ç±»å™¨$f_\theta$è¾“å‡ºçš„$\text{softmax}$ä¹‹åçš„å‘é‡ã€‚å¼‚å¸¸åˆ†æ•°$n_S(x)$å®šä¹‰ä¸ºï¼š</p><p>$$<br>n_S(x)=\sum\limits_{i=0}^{k-1}\log p(\mathbf y(T_i(x))|T_i)<br>$$</p><p>è¯¥å¼‚å¸¸åˆ†æ•°å®šä¹‰ä¸ºæ¯ä¸ªç±»åˆ«ä¸Šï¼Œåœ¨å‡ ä½•å˜æ¢$T_i$çš„æ¡ä»¶ä¸‹ï¼Œè¾“å‡ºçš„$\mathbf y$çš„å¯¹æ•°ä¼¼ç„¶ä¹‹å’Œã€‚åœ¨æ–‡ä¸­ï¼Œä½œè€…å‡è®¾$\mathbf y(T_i(x)|T_i$æœä»è¿ªåˆ©å…‹é›·åˆ†å¸ƒï¼š$\mathbf y(T_i(x))|T_i\sim\text{Dir}(\boldsymbol \alpha_i)$ï¼Œå…¶ä¸­$\boldsymbol \alpha_i\in\mathbb R^k_+$ï¼Œ$x\sim p_X(x)$ï¼Œ$i\sim\text{Uni}(0,k-1)$ï¼Œè€Œ$p_X(x)$ä»£è¡¨æ­£å¸¸æ ·æœ¬çš„çœŸå®æ•°æ®åˆ†å¸ƒã€‚äºæ˜¯ï¼š</p><p>$$<br>n_S(x)=\sum_{i=0}^{k-1}\left[\log\Gamma(\sum_{j=0}^{k-1}[\tilde{\boldsymbol\alpha}<em>i]_j)-\sum</em>{j=0}^{k-1}\log\Gamma([\tilde{\boldsymbol\alpha}<em>i]_j)+\sum</em>{j=0}^{k-1}([\tilde{\boldsymbol\alpha}_i]_j-1)\log\mathbf y(T_i(x))_j\right]<br>$$</p><p>å› ä¸º$\tilde{\alpha}<em>i$ç›¸å¯¹äº$x$æ¥è¯´æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¿½ç•¥ï¼Œäºæ˜¯å¼å­ç®€åŒ–ä¸ºï¼š<br>$$<br>n_S(x)=\sum</em>{i=0}^{k-1}\sum_{j=0}^{k-1}([\tilde{\boldsymbol\alpha}<em>i]_j-1)\log\mathbf y(T_i(x))_j=\sum</em>{i=0}^{k-1}(\tilde{\boldsymbol \alpha}_i-1)\cdot\log\mathbf y(T_i(x))<br>$$</p><p>æ³¨æ„è¿™é‡Œçš„æ¯ä¸ª$\boldsymbol \alpha_i$éƒ½æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå³å¯¹äºæ¯ä¸ªå˜æ¢$i$ï¼Œéƒ½å¯¹åº”ä¸€ä¸ªè¿ªåˆ©å…‹é›·åˆ†å¸ƒï¼Œå…¶å‚æ•°ä¸º$\boldsymbol\alpha_i$ï¼›åœ¨å¯¹è®­ç»ƒé›†è¿›è¡Œç¬¬$i$ä¸ªå‡ ä½•å˜æ¢ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°äº†${T_i(x)}$ï¼Œç„¶ååˆ†ç±»å™¨$f_\theta(\cdot)$çš„è¾“å‡º$\mathbf y(T_i(x))$ç›¸å½“äºè¿ªåˆ©å…‹é›·åˆ†å¸ƒçš„è§‚æµ‹å€¼ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è§‚æµ‹å€¼æ¥ä¼°è®¡å‚æ•°$\boldsymbol \alpha_i$ï¼Œç„¶åæ ¹æ®è¿™ä¸ªå‚æ•°æ¥è®¡ç®—$n_S(x)$ã€‚å¯¹äº$\boldsymbol\alpha_i$ï¼Œå¯ä»¥çŸ¥é“å…¶ç¬¬$i$ä¸ªåˆ†é‡åº”è¯¥æ˜¯ç›¸å¯¹æ¯”è¾ƒå¤§çš„ï¼Œä¸‹é¢æ˜¯è¿è¡Œå®˜æ–¹ä»£ç å¾—åˆ°çš„$\boldsymbol\alpha_i$çš„ç»“æœï¼ˆ$i=69$ï¼Œ$i$ä»$0$å¼€å§‹ï¼Œæ€»å…±ä¸º$72$ç»´ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°ç¬¬$69$ä¸ªåˆ†é‡æ˜¯æœ€å¤§çš„ã€‚</p><pre><code class="hljs bash">[INFO] value of mle_alpha_t: [ 0.10228925  0.08997199  0.13083569  0.10862965  0.09811163  0.08527119  0.17637901  0.27628416  0.12873376  0.19197053  0.11587154  0.09873095  0.12700618  0.07688542  0.10488203  0.12499191  0.11637607  0.07739511  0.13049147  0.51031647  0.20546597  0.15558449  0.09288609  0.12134945  0.09324992  0.14650162  0.16281216  0.11827823  0.08214853  0.15618336  0.28129761  0.45293697  0.11485838  1.78598954  0.16556983  0.1141158  0.10909459  0.13916602  0.11563799  0.07309986  0.11049714  0.12974086  0.15930642  0.13714361  0.13938356  0.70619553  0.11174039  0.07201538  0.16626109  0.12153727  0.09548811  0.07940956  0.15832209  0.11035474  0.12487912  0.16937875  0.23212662  0.37041831  0.08557451  0.0839439  0.09924258  0.39766872  0.14917286  0.08704662  0.09554555  0.31047109  0.24504759  0.16812463  0.11508187 63.98878807  0.12971073  0.07972932]</code></pre><p>ä¸‹å›¾ä¹Ÿå±•ç¤ºäº†å¯¹äºæ¯ä¸ªå˜æ¢$i$ï¼Œ$\mathbf y(T_i(x)|T_i$åˆ†å¸ƒçš„æƒ…å†µï¼š</p><img src="https://i.loli.net/2020/06/23/fLkst4i7Hu6PhQl.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä½œè€…è¿˜ç»™å‡ºäº†ä¸€ç§ç®€åŒ–çš„å½¢å¼ï¼Œ$\hat{n}<em>S(x)=\frac{1}{k}\sum^{k-1}</em>{j=0}[\mathbf y(T_j(x))]_j$ã€‚ç›¸å½“äºè¯´ï¼Œå¯¹äºæ¯ä¸ªå˜æ¢$T_i$åˆ†ç±»å™¨éƒ½ä¼šç»™å‡ºä¸€ä¸ª$\text{softmax}$å‘é‡ï¼Œå–å…¶ç¬¬$i$ä¸ªåˆ†é‡$[\mathbf y(T_j(x))]_j$ï¼Œç„¶åæŠŠæ¯ä¸ªå˜æ¢å¯¹åº”çš„$[\mathbf y(T_j(x))]_j$åŠ èµ·æ¥ã€‚</p><p>æ•´ä¸ªç®—æ³•çš„æµç¨‹å¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/23/z8MpdeoD6ZGavlN.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>è¿™é‡Œç»“åˆä½œè€…çš„æºä»£ç ç®€å•è¯´ä¸€ä¸‹æ£€æµ‹é˜¶æ®µçš„æµç¨‹ã€‚</p><hr><pre><code class="hljs python"><span class="hljs-keyword">for</span> t_ind <span class="hljs-keyword">in</span> range(transformer.n_transforms):        observed_dirichlet = mdl.predict(transformer.transform_batch(observed_data, [t_ind] * len(observed_data)), batch_size=<span class="hljs-number">1024</span>)</code></pre><p>åœ¨è®­ç»ƒå¥½æ¨¡å‹ä¹‹åï¼Œå¯¹äºè®­ç»ƒé›†çš„æ‰€æœ‰æ ·æœ¬ï¼Œå¯¹å…¶è¿›è¡Œ$K$ä¸ªå‡ ä½•å˜æ¢ä¹‹åï¼Œå¾—åˆ°$K$ä¸ªæ ·æœ¬${T_i(x)}$ï¼Œå¯¹äºæ‰€æœ‰ç¬¬$i$ä¸ªå‡ ä½•å˜æ¢å¯¹åº”çš„æ ·æœ¬${T_i(x)}$ï¼Œé€šè¿‡åˆ†ç±»å™¨$f_\theta$ä¼šç»™å‡ºè¾“å‡º$\mathbf y(T_i(x))$ã€‚è¿™é‡Œå¯¹åº”ç®—æ³•ä¸­çš„ç¬¬$7-8$è¡Œï¼Œè¿™ä¸ª<code>observed_dirichlet</code>å°±æ˜¯$S_i$ã€‚</p><hr><pre><code class="hljs python">log_p_hat_train = np.log(observed_dirichlet).mean(axis=<span class="hljs-number">0</span>)alpha_sum_approx = calc_approx_alpha_sum(observed_dirichlet)alpha_0 = observed_dirichlet.mean(axis=<span class="hljs-number">0</span>) * alpha_sum_approx</code></pre><p>ä¹‹åè¿™éƒ¨åˆ†ä¸»è¦å¯¹åº”ç®—æ³•ä¸­çš„$9-11$è¡Œã€‚ä½œè€…æŠŠæ‰€æœ‰çš„ç¬¬$i$ä¸ªå˜æ¢ï¼Œåˆ†ç±»å™¨çš„è¾“å‡ºçš„é›†åˆï¼ˆä¹Ÿå°±æ˜¯å˜é‡<code>observed_dirichlet</code>ï¼‰è®°ä¸º$S_i$ï¼Œ$\bar s$ä¸º$S_i$çš„å¹³å‡ï¼Œ$\bar l$ä¸º$S_i$å¯¹æ•°çš„å¹³å‡ï¼ˆå˜é‡<code>log_p_hat_train</code>ï¼‰ï¼Œåˆå§‹å€¼$\tilde{\alpha}_i$ç”±$\bar s\frac{(k-1)(-\Psi(1))}{\bar s\cdot\log\bar s-\bar s\cdot\bar l}$ç»™å‡ºï¼ˆå˜é‡<code>alpha_0</code>ï¼‰ã€‚å‡½æ•°<code>calc_approx_alpha_sum</code>å®ç°çš„æ˜¯ç®—æ³•ä¸­ç¬¬$11$è¡Œçš„$\frac{(k-1)(-\Psi(1))}{\bar s\cdot\log\bar s-\bar s\cdot\bar l}$ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calc_approx_alpha_sum</span><span class="hljs-params">(observations)</span>:</span>    N = len(observations)    f = np.mean(observations, axis=<span class="hljs-number">0</span>)    <span class="hljs-keyword">return</span> (N * (len(f) - <span class="hljs-number">1</span>) * (-psi(<span class="hljs-number">1</span>))) / (        N * np.sum(f * np.log(f)) - np.sum(f * np.sum(np.log(observations), axis=<span class="hljs-number">0</span>)))</code></pre><hr><pre><code class="hljs python">mle_alpha_t = fixed_point_dirichlet_mle(alpha_0, log_p_hat_train)</code></pre><p>è¿™é‡Œå¯¹åº”ç®—æ³•ä¸­çš„$12-14$è¡Œï¼Œå³é‡å¤$\tilde\alpha_i\leftarrow\Psi^{-1}\left(\Psi(\sum_j[\alpha_i]_j)+\bar l\right)$æ¥ä¼°è®¡$\alpha$ï¼Œå‡½æ•°<code>fixed_point_dirichlet_mle</code>ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fixed_point_dirichlet_mle</span><span class="hljs-params">(alpha_init, log_p_hat, max_iter=<span class="hljs-number">1000</span>)</span>:</span>    alpha_new = alpha_old = alpha_init    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(max_iter):        alpha_new = inv_psi(psi(np.sum(alpha_old)) + log_p_hat)        <span class="hljs-keyword">if</span> np.sqrt(np.sum((alpha_old - alpha_new) ** <span class="hljs-number">2</span>)) &lt; <span class="hljs-number">1e-9</span>:            <span class="hljs-keyword">break</span>        alpha_old = alpha_new    <span class="hljs-keyword">return</span> alpha_new</code></pre><p>$\Psi^{-1}(\cdot)$æ˜¯é€šè¿‡æ•°å€¼æ–¹æ³•æ¥ä¼°è®¡çš„ï¼š</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inv_psi</span><span class="hljs-params">(y, iters=<span class="hljs-number">5</span>)</span>:</span>    <span class="hljs-comment"># initial estimate</span>    cond = y &gt;= <span class="hljs-number">-2.22</span>    x = cond * (np.exp(y) + <span class="hljs-number">0.5</span>) + (<span class="hljs-number">1</span> - cond) * <span class="hljs-number">-1</span> / (y - psi(<span class="hljs-number">1</span>))    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(iters):        x = x - (psi(x) - y) / polygamma(<span class="hljs-number">1</span>, x)    <span class="hljs-keyword">return</span> x</code></pre><hr><p>æœ€åï¼Œåœ¨å¾—åˆ°å¯¹$\alpha$çš„ä¼°è®¡ä¹‹åï¼Œå¯ä»¥æ¥è®¡ç®—æµ‹è¯•æ ·æœ¬çš„åˆ†æ•°äº†ã€‚è¿™é‡Œå¯¹åº”çš„æ˜¯ç®—æ³•ä¸­çš„ç¬¬$16$è¡Œã€‚</p><pre><code class="hljs python">x_test_p = mdl.predict(transformer.transform_batch(x_test, [t_ind] * len(x_test)), batch_size=<span class="hljs-number">1024</span>)scores += dirichlet_normality_score(mle_alpha_t, x_test_p)</code></pre><p>å‡½æ•°<code>dirichlet_normality_score</code>ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dirichlet_normality_score</span><span class="hljs-params">(alpha, p)</span>:</span>    <span class="hljs-keyword">return</span> np.sum((alpha - <span class="hljs-number">1</span>) * np.log(p), axis=<span class="hljs-number">-1</span>)</code></pre><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Baselines"><a href="#Baselines" class="headerlink" title="Baselines"></a>Baselines</h2><p>æ–‡ä¸­ç”¨åˆ°äº†å¦‚ä¸‹çš„Baselineï¼š</p><ul><li><strong>One-class SVM. **å•ç±»æ”¯æŒå‘é‡æœºï¼Œä½œè€…ä½¿ç”¨äº†ä¸‰ä¸ªå˜ä½“ï¼Œåˆ†åˆ«ä¸º</strong>RAW-OC-SVM<strong>â€”â€”ä½¿ç”¨åŸå§‹æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œ</strong>CAE-OC-SVM<strong>â€”â€”ä½¿ç”¨ä¸€ä¸ªå·ç§¯è‡ªç¼–ç å™¨æ¥è·å¾—ä½ç»´è¡¨ç¤ºä½œä¸ºè¾“å…¥å’Œ</strong>E2E-OC-SVM<strong>â€”â€”å…¨åä¸º</strong>One-Class Deep Support Vector Data Description**ï¼›</li><li>*<em>Deep structured energy-based models. *</em></li><li>*<em>Deep Autoencoding Gaussian Mixture Model. *</em></li><li>*<em>Generative Adversarial Networks. *</em></li></ul><h2 id="Datasets"><a href="#Datasets" class="headerlink" title="Datasets"></a>Datasets</h2><p>æ–‡ä¸­ç”¨åˆ°äº†ä¸€ä¸‹å‡ ä¸ªæ•°æ®é›†ï¼š</p><ul><li><strong>CIFAR-10</strong></li><li><strong>CIFAR-100</strong></li><li><strong>Fashion-MNIST</strong></li><li><strong>CatsVsDogs</strong></li></ul><p>åœ¨å®éªŒä¸­æ‰€æœ‰å›¾ç‰‡éƒ½è¢«å½’ä¸€åŒ–åˆ°$[-1,1]$çš„èŒƒå›´ã€‚</p><h2 id="Experimental-Protocol"><a href="#Experimental-Protocol" class="headerlink" title="Experimental Protocol"></a>Experimental Protocol</h2><p>è®¾æ•°æ®é›†æœ‰$C$ä¸ªç±»ï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œ$C$æ¬¡å®éªŒï¼Œåœ¨ç¬¬$c$æ¬¡å®éªŒ ($1\leq c \leq C$)ä¸­æˆ‘ä»¬ä¼šå°†ç¬¬$c$ä¸ªç±»ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œè€Œå…¶ä»–ç±»ä½œä¸ºå¼‚å¸¸æ ·æœ¬ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œè®­ç»ƒé›†åªåŒ…å«æ­£å¸¸æ ·æœ¬ï¼Œè€Œåœ¨æµ‹è¯•é˜¶æ®µåˆ™ä¼šæœ‰æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬ã€‚åœ¨è·å¾—å¼‚å¸¸åˆ†æ•°ä¹‹åï¼Œé˜ˆå€¼$\lambda$åˆ™æ ¹æ®ROCæ›²çº¿ä¸‹é¢ç§¯é€‰æ‹©ã€‚</p><p>å®éªŒä¸­ä½¿ç”¨çš„å‡ ä½•å˜æ¢åŸºäºä»¥ä¸‹ä¸‰ç§åŸºå˜æ¢ï¼š</p><ul><li>*<em>Horizontal flip: *</em> è®°ä¸º$T_b^{flip}(x)$ï¼Œ$b\in{T,F}$ä»£è¡¨æ˜¯å¦ç¿»è½¬ï¼›</li><li>*<em>Translation: *</em> è®°ä¸º$T_{s_h,s_w}^{trans}(x)$ï¼Œå…¶ä¸­$s_h,s_w\in{-1,0,1}$ã€‚åœ¨é•¿å®½ä¸¤ä¸ªç»´åº¦ä¸Šä½ç§»åˆ†åˆ«ä¸º$0.25$é«˜åº¦å’Œ$0.25$å®½åº¦ï¼Œè¿™ä¸¤ä¸ªç»´åº¦å‘ç”Ÿä½ç§»çš„æ–¹å‘ç”±$s_h$å’Œ$s_w$å†³å®šï¼Œå½“$s_h=s_w=0$æ—¶ä»£è¡¨ä¸ç§»åŠ¨ï¼›</li><li>*<em>Rotation by multiples 90 degrees: *</em> è®°ä¸º$T_k^{rot}(x)$ï¼Œ$k\in{0,1,2,3}$ã€‚æ—‹è½¬$k\times90$åº¦ã€‚</li></ul><p>å°†ä¸‰ç§åŸºå˜æ¢å åŠ æœ‰ï¼š<br>$$<br>\mathcal T=\left{<br> T_k^{rot}\circ T_{s_h,s_w}^{trans}\circ T_b^{flip} : \begin{matrix}<br> b &amp;\in {T,F}\<br> s_h,s_w&amp;\in{-1,0,1}\<br> k&amp;\in{0,1,2,3}<br> \end{matrix}<br>\right}<br>$$<br>æœ€ç»ˆå‡ ä½•å˜æ¢ç§æ•°ä¸º$2\times3\times3\times4=72$ç§ã€‚</p><p>åˆ†ç±»å™¨æ¨¡å‹ä½¿ç”¨çš„æ˜¯<strong>Wide Residual Network</strong>ï¼Œä¼˜åŒ–å™¨ä¸ºAdamï¼ŒBatch sizeä¸º128ï¼Œè®­ç»ƒè½®æ•°ä¸º200ã€‚</p><h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>ä¸‹é¢æ˜¯ä¸åŒæ–¹æ³•åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„å®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/24/gHZohrvz9MGYmxi.png" srcset="/img/loading.gif" alt=""></p><p>è¯„æµ‹æ ‡å‡†ä½¿ç”¨çš„æ˜¯AUROCã€‚ä½œè€…å…³äºç»“æœçš„åˆ†æä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li>åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ç®—æ³•éƒ½æ¯”Baselineè¦å¥½ï¼Œè€Œä¸”æ˜¯è¶Šå¤§çš„æ•°æ®é›†æ•ˆæœè¶Šå¥½ã€‚CatsVsDogsæ•°æ®é›†æ¯å¼ å›¾ç‰‡çš„å¤§å°æ¯”å…¶ä»–å‡ ä¸ªæ•°æ®é›†éƒ½è¦å¤§ï¼Œè€ŒBaselineåœ¨è¿™ä¸ªæ•°æ®é›†ä¸Šçš„ç»“æœéƒ½åœ¨$50%$æˆ–ä¸åˆ°$50%$ï¼Œè¿™åŸºæœ¬ç­‰åŒäºççŒœï¼›</li><li>åœ¨CIFAR-100æ•°æ®é›†é‡Œï¼Œç”±äºå°†è¿™100ç±»èšåˆä¸ºäº†20ç±»ï¼Œæ‰€ä»¥å­˜åœ¨ç±»å†…æ ·æœ¬å·®å¼‚å¤§çš„é—®é¢˜ã€‚æ¯”å¦‚åœ¨ç±»$5$ã€ç±»$7$å’Œç±»$13$ä¸Šï¼Œæ¨¡å‹è¡¨ç°å°±ä¸å¤Ÿå¥½ï¼›</li><li>åœ¨Fashion-MNISTæ•°æ®é›†ä¸Šå‡ ä¹æ‰€æœ‰æ–¹æ³•ï¼ˆé™¤äº†DAGMMï¼‰éƒ½è¡¨ç°å¾ˆå¥½ã€‚</li></ol><h2 id="On-the-Intuition-for-Using-Geometric-Transformations"><a href="#On-the-Intuition-for-Using-Geometric-Transformations" class="headerlink" title="On the Intuition for Using Geometric Transformations"></a>On the Intuition for Using Geometric Transformations</h2><p>è¿™é‡Œä½œè€…å¯¹æ‰€é€‰ç”¨çš„å‡ ä½•å˜æ¢åšäº†ä¸€äº›è§£é‡Šã€‚å®éªŒä¸­é€‰ç”¨çš„ä¸‰ç§åŸºæœ¬å‡ ä½•å˜æ¢éƒ½æ˜¯å¯é€†çš„çº¿æ€§å‡ ä½•å˜æ¢ï¼ˆä¸”ä¸ºåŒå°„ï¼‰ï¼Œä½œè€…ä¹Ÿè¯•è¿‡ä¸€äº›å¤æ‚çš„éçº¿æ€§å˜æ¢ï¼Œå¦‚é«˜æ–¯æ¨¡ç³Šã€é”åŒ–ã€ä¼½é©¬æ ¡æ­£ç­‰ç­‰ï¼Œä½†æ˜¯æ•ˆæœå¹¶ä¸å¥½ã€‚</p><p>ä½œè€…è®¤ä¸ºåˆ†ç±»å™¨èƒ½å¤Ÿåˆ†è¾¨ä¸åŒå˜æ¢çš„èƒ½åŠ›ä¸æœ€ç»ˆæ€§èƒ½æˆæ­£æ¯”ï¼Œä¸ºäº†éªŒè¯è¿™ä¸€ç‚¹ï¼Œè¿›è¡Œäº†$3$ä¸ªå®éªŒã€‚ä»MNISTæ•°æ®é›†é€‰æ‹©ä¸€ä¸ªæ•°å­—ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œå‡ ä½•å˜æ¢åªé‡‡ç”¨ä¸¤ä¸ªï¼Œç„¶åé€‰æ‹©å¦ä¸€ä¸ªæ•°å­—ä½œä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><ul><li>*<em>Normal digit: 8ï¼ŒAnomaly: 3ï¼ŒTransformations: Identity and horizontal flip. *</em>ç”±äºæ•°å­—$8$æ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥è¦è®©åˆ†ç±»å™¨åˆ†è¾¨åŸå§‹çš„$8$å’Œç¿»è½¬ä¹‹åçš„$8$æ˜¯å¾ˆéš¾çš„ï¼ŒAUROCåªæœ‰$0.646$ï¼›</li><li>*<em>Normal digit: 3ï¼ŒAnomaly: 8ï¼ŒTransformations: Identity and horizontal flip. *</em>è¿™é‡ŒæŠŠ$3$ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œç”±äº$3$ä¸æ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥ä¸¤ç§å˜æ¢æ˜¯å¯ä»¥åˆ†è¾¨çš„ï¼ŒAUROCè¾¾åˆ°äº†$0.957$ï¼›</li><li>*<em>Normal digit: 8ï¼ŒAnomaly: 3ï¼ŒTransformations: Identity and translation by 7 pixels. *</em>åŒæ ·æ˜¯æŠŠ$8$ä½œä¸ºæ­£å¸¸æ ·æœ¬ï¼Œä½†å˜æ¢ç”¨çš„æ˜¯å¹³ç§»ï¼ŒAUROCè¾¾åˆ°äº†$0.919$ã€‚</li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜è®¾è®¡äº†ä¸€ä¸ªå®éªŒï¼Œç›®çš„æ˜¯æµ‹è¯•ä»€ä¹ˆæ ·çš„å›¾åƒä¼šè·å¾—è¾ƒé«˜çš„åˆ†æ•°$n_S(x)$ã€‚åœ¨ç»™å®šè®­ç»ƒå¥½çš„åˆ†ç±»å™¨çš„æƒ…å†µä¸‹ï¼Œä¼˜åŒ–è¾“å…¥çš„å›¾åƒï¼Œç›®æ ‡å‡½æ•°æ˜¯æœ€å¤§åŒ–åˆ†æ•°$n_S(x)$ã€‚ä¸‹å›¾ä¸ºå®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/24/8Pi4EKCRuBXrYgp.png" srcset="/img/loading.gif" alt=""></p><p>åœ¨å·¦å›¾ä¸­ï¼Œå°†æ•°å­—$3$ä½œä¸ºæ­£å¸¸æ ·æœ¬è®­ç»ƒçš„åˆ†ç±»å™¨ã€åŸå§‹è¾“å…¥ä¸ºæ•°å­—$0$çš„å›¾ç‰‡æ—¶ï¼Œéšç€ä¼˜åŒ–çš„è¿›è¡Œï¼Œå›¾ç‰‡æ…¢æ…¢åœ°å˜å¾—åƒæ•°å­—$3$ã€‚åœ¨å³å›¾ä¸­ï¼ŒåŒæ ·æ˜¯å°†æ•°å­—$3$ä½œä¸ºæ­£å¸¸æ ·æœ¬è®­ç»ƒçš„åˆ†ç±»å™¨ï¼Œä¸è¿‡åŸå§‹è¾“å…¥ä¹Ÿæ˜¯æ•°å­—$3$ï¼Œè¿™æ—¶å›¾åƒå´æ²¡æœ‰æ€ä¹ˆå˜åŒ–ã€‚</p><h1 id="Remark"><a href="#Remark" class="headerlink" title="Remark"></a>Remark</h1><ul><li>æ–‡ä¸­æåˆ°çš„åœ¨CIFAR100æ•°æ®çš„å®éªŒä¸Šï¼Œç”±äºç±»é—´å·®å¼‚æ¯”è¾ƒå¤§å¯¼è‡´æ•ˆæœè¾ƒå·®ï¼Œé‚£ä¹ˆå¾ˆè‡ªç„¶åœ°ï¼Œä¸åŒçš„å˜æ¢æ ·æœ¬å¯¹åº”çš„é›†ç°‡å®é™…ä¸Šåº”å½“è¶³å¤Ÿåˆ†å¼€ï¼Œé›†ç°‡å†…çš„æ ·æœ¬è¦è¶³å¤Ÿè¿›ï¼Œè¿™æ ·å¯¹äºåˆ†ç±»å™¨æ¥è¯´æ‰èƒ½æ¯”è¾ƒå¥½çš„åˆ†ç±»ã€‚ä¸è¿‡é‡‡ç”¨çš„å‡ ä½•å˜æ¢å¹¶æ²¡æœ‰é’ˆå¯¹è¿™ä¸€ç‚¹è¿›è¡Œç‰¹åˆ«è®¾è®¡ï¼›</li><li>æ–‡ä¸­å¼ºè°ƒäº†æ‰€ä½¿ç”¨çš„å˜æ¢ä¸ºå‡ ä½•å˜æ¢ï¼Œå…¶å®é™¤æ­¤ä¹‹å¤–ï¼Œæ‰€ä½¿ç”¨çš„å˜æ¢è¿˜éƒ½æ˜¯å¯ä»¥ç”¨çŸ©é˜µè¡¨ç¤ºçš„å¯é€†çš„å˜æ¢ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cross-dataset Time Series Anomaly Detection for Cloud Systems</title>
    <link href="/2020/06/01/Cross-dataset-Time-Series-Anomaly-Detection-for-Cloud-Systems/"/>
    <url>/2020/06/01/Cross-dataset-Time-Series-Anomaly-Detection-for-Cloud-Systems/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§ç”¨äºäº‘è®¡ç®—å¹³å°çš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¡†æ¶ã€‚ä¸ºäº†è§£å†³æ ‡ç­¾ä¸è¶³çš„é—®é¢˜ï¼Œæ–‡ä¸­ä½¿ç”¨äº†è¿ç§»å­¦ä¹ çš„æ–¹æ³•ï¼Œå³åœ¨æœ‰æ ‡ç­¾çš„source domainä¸Šè®­ç»ƒæ¨¡å‹ï¼Œåœ¨æ²¡æœ‰æ ‡ç­¾çš„target domainä¸Šæ£€æµ‹ã€‚åŒæ—¶ï¼Œæ–‡ä¸­è¿˜ä½¿ç”¨äº†ä¸»åŠ¨å­¦ä¹ çš„æ–¹æ³•æ¥æŒ‘é€‰æœ€æœ‰ä»·å€¼çš„æ— æ ‡ç­¾æ ·æœ¬è¿›è¡Œæ ‡è®°ã€‚</p><p><a href="https://www.usenix.org/system/files/atc19-zhang-xu.pdf" target="_blank" rel="noopener">ğŸ“°Get Paper</a></p><h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>é’ˆå¯¹äº‘è®¡ç®—å¹³å°æ•°æ®çš„å¼‚å¸¸æ£€æµ‹é€šå¸¸æ˜¯åº”ç”¨åœ¨äº‘ç›‘æ§æ•°æ®ï¼Œå¦‚KPIã€CPUä½¿ç”¨ç‡ã€ç³»ç»Ÿè´Ÿè½½ç­‰æ—¶åºæ•°æ®ä¸Šã€‚å’Œä¼ ç»Ÿçš„å¼‚å¸¸æ£€æµ‹ä¸ä¸€æ ·çš„æ˜¯ï¼Œæ—¶åºå¼‚å¸¸æ£€æµ‹å¾€å¾€æ›´éš¾ï¼Œæ–‡ä¸­æ€»ç»“äº†ä»¥ä¸‹å‡ ä¸ªæŒ‘æˆ˜ï¼š</p><ul><li>å¼‚å¸¸ç‰¹å¾çš„å·®å¼‚æ€§ã€‚åœ¨ä¸åŒçš„äº‘æœåŠ¡ç³»ç»Ÿä¸­ï¼Œå¯¹å¼‚å¸¸çš„å®¹å¿åº¦æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥å¯¹æ¯ä¸ªåœºæ™¯æˆ–ç³»ç»Ÿç»„ä»¶è®¾ç½®å‡†ç¡®çš„é˜ˆå€¼æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹æ˜¯ååˆ†å›°éš¾çš„ï¼›</li><li>æ—¶é—´ä¾èµ–æ€§ã€‚è¯¥å¼‚å¸¸æ£€æµ‹é—®é¢˜å¤„ç†çš„æ˜¯æ—¶é—´åºåˆ—æ•°æ®ï¼Œè€Œä¼ ç»Ÿçš„å¼‚å¸¸æ£€æµ‹å¹¶ä¸ä¼šè€ƒè™‘æ—¶é—´ä¾èµ–æ€§ï¼›</li><li>æ— ç›‘ç£å­¦ä¹ çš„æ€§èƒ½é—®é¢˜ã€‚æ— ç›‘ç£çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„æ€§èƒ½æœ‰é™ï¼Œä¼šå¸¦æ¥å¤§é‡çš„è¯¯æŠ¥ï¼›</li><li>æœ‰ç›‘ç£å­¦ä¹ éœ€è¦å¤§é‡æ ‡ç­¾ã€‚</li></ul><h1 id="Proposed-Approach"><a href="#Proposed-Approach" class="headerlink" title="Proposed Approach"></a>Proposed Approach</h1><p>ä¸ºäº†è§£å†³ä¸Šè¿°æŒ‘æˆ˜ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ä¸ªæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¡†æ¶ATAD (Active Transfer Anomaly Detection)ã€‚è¯¥æ¡†æ¶ç»“åˆäº†è¿ç§»å­¦ä¹ æŠ€æœ¯å’Œä¸»åŠ¨å­¦ä¹ æŠ€æœ¯ï¼Œç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/jOB4rC2gnH9VcQW.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>æœªæ ‡è®°æ•°æ®$T_u$æ˜¯æˆ‘ä»¬è¦æ£€æµ‹çš„ç›®æ ‡æ•°æ® (target domain)ï¼Œæ ‡è®°æ•°æ®$T_l$æ˜¯æˆ‘ä»¬çš„æºæ•°æ® (source domain)ï¼Œå¯ä»¥æ˜¯å¼€æºæ•°æ®æˆ–è€…æ˜¯å…¶ä»–ç³»ç»Ÿçš„ç›‘æ§æ•°æ®ã€‚</p><h2 id="Transfer-Learning-Component"><a href="#Transfer-Learning-Component" class="headerlink" title="Transfer Learning Component"></a>Transfer Learning Component</h2><p>åœ¨åº”ç”¨è¿ç§»å­¦ä¹ æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªå› ç´ ï¼š</p><ul><li>æˆ‘ä»¬å¤„ç†çš„æ˜¯æ—¶é—´åºåˆ—æ•°æ®ï¼Œå³åœ¨ä¸åŒçš„æ—¶é—´ç‚¹ä¸Šæ ·æœ¬ä¹‹é—´ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå–äº†ä¸åŒçš„ç‰¹å¾ï¼Œæ¯ä¸€ä¸ªæ—¶é—´ç‚¹è¢«è½¬æ¢ä¸ºäº†é«˜ç»´çš„ç‰¹å¾å‘é‡ï¼Œä¸”æ¯ä¸ªæ—¶é—´ç‚¹é™„è¿‘çš„èƒŒæ™¯ä¿¡æ¯è¢«ä¿å­˜åœ¨äº†ç‰¹å¾å‘é‡ä¹‹ä¸­ï¼›</li><li>æ—¶é—´åºåˆ—çš„ç²’åº¦ã€‚ç²—ç²’åº¦çš„è¿ç§»å­¦ä¹ ä¸åˆ©äºå‘ç°å¼‚å¸¸ï¼Œæœ¬æ–‡é‡‡ç”¨ç»†ç²’åº¦ï¼Œå³æ•°æ®ç‚¹çº§åˆ«çš„è¿ç§»å­¦ä¹ ï¼›</li><li>è¿ç§»å­¦ä¹ éœ€è¦source domainå’Œtarget domainå…·æœ‰æ½œåœ¨çš„ç›¸ä¼¼æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹source domainä¸­çš„æ ·æœ¬è¿›è¡Œè¿‡æ»¤ã€‚</li></ul><img src="https://i.loli.net/2020/06/25/aM7Qvt6DwGXnThm.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Feature-Identification"><a href="#Feature-Identification" class="headerlink" title="Feature Identification"></a>Feature Identification</h3><p>è¿™ä¸€èŠ‚æè¿°ç‰¹å¾å·¥ç¨‹ä¸­ç”¨åˆ°çš„ç‰¹å¾ã€‚åœ¨æå–ç‰¹å¾ä¹‹å‰ï¼Œæ–‡ä¸­ä½¿ç”¨äº†ç¦»æ•£å‚…é‡Œå¶å˜æ¢æ¥è¯†åˆ«æ—¶é—´åºåˆ—çš„å‘¨æœŸ$p$ï¼Œå¹¶ä¸ºåé¢æ»‘åŠ¨çª—å£çš„å¤§å°åŸåˆ™ä½œå‚è€ƒã€‚</p><h4 id="Statistical-Features"><a href="#Statistical-Features" class="headerlink" title="Statistical Features"></a>Statistical Features</h4><p>ç»Ÿè®¡ç‰¹å¾åŒ…å«äº†ä¸€äº›åŸºæœ¬çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¦‚å‡å€¼ã€æ–¹å·®ç­‰ï¼Œç”¨åˆ°çš„ç‰¹å¾å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/jI9EbCy1XueDViw.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>è¡¨ä¸­çš„ç»Ÿè®¡ç‰¹å¾éƒ½æ˜¯åŸºäºå¤§å°ç­‰äºå‘¨æœŸ$p$çš„æ»‘åŠ¨çª—å£çš„ã€‚</p><h4 id="Forecasting-Error-Features"><a href="#Forecasting-Error-Features" class="headerlink" title="Forecasting Error Features"></a>Forecasting Error Features</h4><p>ä½¿ç”¨é¢„æµ‹ç‰¹å¾çš„ç†ç”±æ˜¯å¦‚æœä¸€ä¸ªæ•°æ®ç‚¹åç¦»é¢„æµ‹å€¼å¾ˆè¿œï¼Œé‚£ä¹ˆå®ƒå¾ˆæœ‰å¯èƒ½æ˜¯å¼‚å¸¸ã€‚æ–‡ä¸­ä½¿ç”¨äº†å¤šç§æ—¶é—´åºåˆ—é¢„æµ‹æ¨¡å‹ï¼Œå¦‚SARIMAã€Holtã€Holt-Wintersã€STLç­‰ã€‚æœ€ç»ˆçš„é¢„æµ‹ç»“æœä½¿ç”¨ä¸‹å¼æ¥åŠ æƒé›†æˆï¼š<br>$$<br>\hat{Y}<em>t=\sum\limits</em>{m=1}^{M}\frac{\hat{Y}<em>{m,t}}{M-1}\left(1-\frac{RMSE</em>{m,t}}{\sum\limits_{n=1}^M RMSE_{n,t}}\right)<br>$$<br>$M$ä»£è¡¨$M$ä¸ªä¸åŒæ¨¡å‹ï¼Œ$RMSE_{m,t}$ä»£è¡¨æ¨¡å‹$m$åœ¨æ—¶é—´$t$çš„$RMSE$ï¼Œ$\hat{Y}_t$æ˜¯åœ¨æ—¶é—´$t$çš„æœ€ç»ˆé¢„æµ‹ç»“æœã€‚ä¹‹åï¼Œä½¿ç”¨ä¸‹è¡¨ä¸­çš„Metricsæ¥è®¡ç®—ä¸åŒé¢„æµ‹ç‰¹å¾ï¼š</p><img src="https://i.loli.net/2020/06/25/wRmfHj5xFcsLIXp.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>åŒæ ·çš„ï¼Œä¸Šè¿°ç‰¹å¾éƒ½æ˜¯åŸºäºçª—å£çš„ã€‚</p><h4 id="Temporal-Features"><a href="#Temporal-Features" class="headerlink" title="Temporal Features"></a>Temporal Features</h4><p>è¿™ä¸€éƒ¨åˆ†æ˜¯ä¸€äº›æ—¶é—´åºåˆ—ç›¸å…³ç‰¹å¾ï¼š</p><img src="https://i.loli.net/2020/06/25/mnBrzjfgV716yiR.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>æœ€åï¼Œæ€»å…±æå–äº†37ä¸ªç‰¹å¾ï¼Œå¹¶ä¸”æ¯ä¸ªç‰¹å¾éƒ½è¿›è¡Œäº†æ­£åˆ™åŒ–ã€‚</p><h3 id="The-Transfer-between-Source-Domain-and-Target-Domain"><a href="#The-Transfer-between-Source-Domain-and-Target-Domain" class="headerlink" title="The Transfer between Source Domain and Target Domain"></a>The Transfer between Source Domain and Target Domain</h3><p>æœ¬æ–‡ç»“åˆäº†åŸºäºå®ä¾‹çš„è¿ç§»å­¦ä¹ (<strong>Instance-based Transfer Learning</strong>)å’ŒåŸºäºç‰¹å¾çš„è¿ç§»å­¦ä¹ (<strong>Feature-based Transfer Learning</strong>)ã€‚</p><p>é¦–å…ˆï¼Œsource domainä¸­çš„æ•°æ®å·®å¼‚æ€§æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸target domainç›¸ä¼¼çš„æ ·æœ¬ã€‚</p><p>åŸºäºå®ä¾‹çš„è¿ç§»å­¦ä¹ (<strong>Instance-based Transfer Learning</strong>)çš„æ€æƒ³æ˜¯é€‰æ‹©source domainä¸­ä¸target domainç›¸ä¼¼çš„æ ·æœ¬ã€‚å¯¹äºsource domainï¼Œåœ¨å°†æ—¶é—´åºåˆ—$T_l$è½¬æ¢ä¸ºç‰¹å¾$F_l$ä¹‹åï¼Œæœ¬æ–‡ä½¿ç”¨$K-means$ç®—æ³•å°†$F_l$åˆ†æˆè‹¥å¹²ä¸ªç°‡ã€‚æ¯ä¸ªç°‡$F_l^i, i\in[1,K]$æ˜¯$F_l$çš„ä¸é‡å å­é›†ã€‚ä¸ºäº†é€‰æ‹©åˆé€‚çš„æ ·æœ¬ï¼Œæˆ‘ä»¬è®¡ç®—äº†target domainä¸­çš„æ ·æœ¬å’Œæ¯ä¸ªç°‡ä¸­å¿ƒç‚¹çš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œç„¶åæ ·æœ¬ä¼šå’Œè·ç¦»æœ€è¿‘çš„ç°‡$F_l^i$è”ç³»èµ·æ¥ã€‚</p><p>ä¹‹åï¼Œä¸ºäº†ä½¿source domainå’Œtarget domainåœ¨ç‰¹å¾ç©ºé—´çš„å·®åˆ«æ›´å°ï¼Œä½œè€…åœ¨æ¯ä¸ªç°‡ä¸Šä½¿ç”¨äº†<strong>CORrelation ALignment</strong> (CORAL) ç®—æ³•ã€‚CORALæ˜¯ä¸€ç§é¢†åŸŸé€‚åº”ç®—æ³• (<strong>Domain Adaption</strong>)ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯å¯¹source domainå’Œtarget domainè¿›è¡Œçº¿æ€§å˜æ¢ä½¿å…¶äºŒé˜¶ç»Ÿè®¡ä¿¡æ¯ï¼ˆå³åæ–¹å·®çŸ©é˜µï¼‰çš„å·®åˆ«æœ€å°åŒ–ï¼š<br>$$<br>\min_A\parallel A^\top C^i_lA-C^i_u\parallel_F^2<br>$$</p><p>åœ¨æœ€åä¸€æ­¥ï¼Œä½œè€…åœ¨æ¯ä¸€ä¸ªsub source domain $\hat{F}_l^i$è®­ç»ƒäº†æœ‰ç›‘ç£æ¨¡å‹ï¼ˆéšæœºæ£®æ—æˆ–SVMï¼‰ï¼Œæ‰€ä»¥æœ€åæˆ‘ä»¬å¾—åˆ°äº†$K$ä¸ªåŸºæ¨¡å‹ã€‚</p><h2 id="Active-Learning-Component"><a href="#Active-Learning-Component" class="headerlink" title="Active Learning Component"></a>Active Learning Component</h2><p>ç”±äºæ•°æ®çš„å·®å¼‚æ€§å’Œå¤æ‚æ€§å¤ªå¤§ï¼Œä»…ä»…ä½¿ç”¨è¿ç§»å­¦ä¹ çš„æŠ€æœ¯ä¸è¶³ä»¥è¾¾åˆ°å¾ˆå¥½çš„æ•ˆæœã€‚åœ¨ATADä¸­ï¼Œä½œè€…ä½¿ç”¨äº†ä¸»åŠ¨å­¦ä¹ æŠ€æœ¯æ¥ç”¨è¾ƒå°‘çš„æˆæœ¬æ ‡æ³¨æœ€æœ‰ä»·å€¼çš„æ ·æœ¬æ¥æå‡æ€§èƒ½ã€‚æœ¬æ–‡ä¸­ä½¿ç”¨åŸºäº<strong>Uncertainty</strong>å’Œ<strong>Context Diversity</strong>çš„ä¸»åŠ¨å­¦ä¹ ã€‚</p><h3 id="Uncertainty"><a href="#Uncertainty" class="headerlink" title="Uncertainty"></a>Uncertainty</h3><p>å¤§å¤šæ•°ä¸»åŠ¨å­¦ä¹ ç®—æ³•ä½¿ç”¨ä¸ç¡®å®šæ€§ (Uncertainty) æ¥ä½œä¸ºé€‰æ‹©è¦æ ‡è®°çš„æ ·æœ¬çš„å‡†åˆ™ã€‚<br>$$<br>Uncertainty=-|Prob(Normal)-Prob(Anomaly)|<br>$$<br>å…¶ä¸­çš„$Prob$ç”±åŸºæ¨¡å‹ç»™å‡ºã€‚</p><h3 id="Context-Diversity"><a href="#Context-Diversity" class="headerlink" title="Context Diversity"></a>Context Diversity</h3><p>å¤šæ ·æ€§ (Diversity) ä¹Ÿæ˜¯ä¸€ä¸ªé€‰æ‹©è¦æ ‡è®°æ ·æœ¬çš„é‡è¦å‚è€ƒã€‚å¦‚æœæœ‰ä¸¤ä¸ªç›¸ä¼¼çš„æ ·æœ¬ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦å°†ä»–ä»¬éƒ½æ ‡è®°ã€‚</p><p>æ—¶é—´ä¸Šç›¸é‚»çš„æ ·æœ¬å¾€å¾€ä¹Ÿæ˜¯ç›¸ä¼¼çš„ã€‚</p><p>å…·ä½“çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¯¹æ‰€æœ‰æ ·æœ¬æŒ‰ç…§<strong>Uncertainty</strong>æ’åºï¼Œç„¶åè¿›è¡Œä¸€æ¬¡æ‰«æï¼Œå¦‚æœå½“å‰æ ·æœ¬åœ¨å€™é€‰é›†ä¸­æŸä¸ªæ ·æœ¬çš„<strong>Context</strong>ä¹‹ä¸­ï¼Œæˆ‘ä»¬åˆ™å¿½ç•¥å½“å‰æ ·æœ¬ï¼Œå› ä¸ºè¿™ä»£è¡¨å½“å‰æ ·æœ¬å’Œå€™é€‰é›†ä¸­çš„é‚£ä¸ªæ ·æœ¬æ˜¯ç›¸ä¼¼çš„ã€‚å¦‚æœä¸åœ¨<strong>Context</strong>ä¹‹ä¸­ï¼Œæˆ‘ä»¬åˆ™å°†è¯¥æ ·æœ¬åŠ å…¥å€™é€‰é›†ä¸­ã€‚</p><p>åˆ¤æ–­æ˜¯å¦åœ¨æŸä¸ªæ ·æœ¬çš„<strong>Context</strong>ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç›´æ¥åˆ¤æ–­æ˜¯å¦è½åœ¨åŒºé—´$[t-\alpha,t+\alpha]$ä¸­å°±æ˜¯äº†ã€‚</p><img src="https://i.loli.net/2020/06/25/nci9PvGDEdjky5R.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä¸»åŠ¨å­¦ä¹ æ¨¡å—çš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/RqonKfQS3IWw6Gb.png" srcset="/img/loading.gif" style="zoom: 80%;" /><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><p>åœ¨å®éªŒéƒ¨åˆ†ï¼Œä½œè€…è¯•å›¾å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</p><ol><li>ATADçš„æ•ˆæœå¦‚ä½•ï¼Ÿ</li><li>è¿ç§»å­¦ä¹ æ¨¡å—çš„æœ‰æ•ˆæ€§å¦‚ä½•ï¼Ÿ</li><li>ä¸»åŠ¨å­¦ä¹ æ¨¡å—çš„æœ‰æ•ˆæ€§å¦‚ä½•ï¼Ÿ</li><li>ATADåœ¨åŸºäºå…¬å¼€æ•°æ®æ—¶å¯¹å…¬å¸å†…éƒ¨æ•°æ®æ£€æµ‹æ•ˆæœå¦‚ä½•ï¼Ÿ</li></ol><h2 id="Dataset-and-Setup"><a href="#Dataset-and-Setup" class="headerlink" title="Dataset and Setup"></a>Dataset and Setup</h2><p>ä¸‹è¡¨æ˜¯ç”¨åˆ°çš„æ•°æ®é›†çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼š</p><img src="https://i.loli.net/2020/06/25/HDNGCrYOxezLwaB.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Evaluation-Metric"><a href="#Evaluation-Metric" class="headerlink" title="Evaluation Metric"></a>Evaluation Metric</h2><p>è¯„æµ‹æ ‡å‡†ä½¿ç”¨çš„æ˜¯F1-scoreï¼š<br>$$<br>F1=\frac{2\cdot P\cdot R}{P+R}, \space P=\frac{TP}{TP+FP}, \space R=\frac{TP}{TP+FN}<br>$$</p><h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><h3 id="RQ1-How-effective-is-ATAD"><a href="#RQ1-How-effective-is-ATAD" class="headerlink" title="RQ1: How effective is ATAD?"></a>RQ1: How effective is ATAD?</h3><p>BaselineåŒ…æ‹¬å­¤ç«‹æ£®æ—ã€K-Sigmaã€S-H-ESDå’Œéšæœºæ£®æ—ã€‚</p><p>æœ€ç»ˆç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/HMneBzlkR7Qg4TN.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä¸ºäº†è¯„æµ‹ATADåˆ©ç”¨æ ‡ç­¾çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†RFåœ¨è¾¾åˆ°å’ŒATADç›¸ä¼¼F1 scoreæƒ…å†µä¸‹æ‰€éœ€æ ‡ç­¾çš„æ•°é‡ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/fcoXhCL43yVwYes.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="RQ2-How-effective-is-the-Transfer-Learning-Component"><a href="#RQ2-How-effective-is-the-Transfer-Learning-Component" class="headerlink" title="RQ2:    How  effective  is  the  Transfer  Learning Component?"></a>RQ2:    How  effective  is  the  Transfer  Learning Component?</h3><p>æˆ‘ä»¬ä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢æ¥æ¢ç©¶æ¨¡å‹è¿ç§»çŸ¥è¯†çš„èƒ½åŠ›ï¼š</p><ul><li>ä½¿ç”¨æ–‡ä¸­æ‰€ç”¨åˆ°çš„ç‰¹å¾çš„é‡è¦æ€§</li><li>æœ¬æ¨¡å‹è¿ç§»çŸ¥è¯†çš„èƒ½åŠ›</li></ul><p>å¯¹äºç¬¬ä¸€ç‚¹ï¼Œä½œè€…æå‡ºä¼ ç»Ÿçš„æ–¹æ³•ä¸€èˆ¬åªæå–äº†ç»Ÿè®¡ç‰¹å¾ï¼Œè€Œæœ¬æ–‡è¿˜æå–äº†å¤šç§å…¶ä»–ç‰¹å¾ã€‚ä½œè€…å¯¹æå–ä¸åŒç‰¹å¾è¿›è¡Œäº†æ¯”è¾ƒè¯•éªŒï¼Œç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/QV2eWzoOxGS6qJd.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜å±•ç¤ºäº†ä¸åŒæ•°æ®é›†ä¸‹å‰10æœ‰æ•ˆçš„ç‰¹å¾ï¼š</p><img src="https://i.loli.net/2020/06/25/QXYcP9V3xmJeIq5.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>å¯¹äºç¬¬äºŒç‚¹ï¼Œä½œè€…æ¯”è¾ƒäº†æ˜¯å¦ä½¿ç”¨æ–‡ä¸­çš„é¢†åŸŸé€‚åº”ç®—æ³•CORALï¼Œåœ¨è¾¾åˆ°ç›¸ä¼¼F1 scoreä¸‹æ‰€éœ€çš„æ ‡ç­¾æ•°ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/JKFf4XngPBdGm3V.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="RQ3-How-effective-is-the-Active-Learning-component"><a href="#RQ3-How-effective-is-the-Active-Learning-component" class="headerlink" title="RQ3:  How effective is the Active Learning component?"></a>RQ3:  How effective is the Active Learning component?</h3><p>ä¸ºäº†éªŒè¯æœ¬æ–‡æ‰€ç”¨çš„ä¸»åŠ¨å­¦ä¹ çš„æœ‰æ•ˆæ€§ï¼Œä½œè€…è¿›è¡Œäº†å¯¹æ¯”è¯•éªŒã€‚ç¬¬ä¸€ä¸ªæ¨¡å‹ (Supervised model) ä½¿ç”¨å…¨éƒ¨æ ‡ç­¾ä½†ä¸ä½¿ç”¨è¿ç§»å­¦ä¹ è®­ç»ƒï¼Œç¬¬äºŒä¸ª (NaÃ¯ve) ä¸ºåªä½¿ç”¨ä¸»åŠ¨å­¦ä¹ è€Œä¸ä½¿ç”¨è¿ç§»å­¦ä¹ ï¼Œç¬¬ä¸‰ä¸ªä¸ºæœ¬æ–‡æå‡ºçš„æ¨¡å‹ã€‚ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸ºäº†è¾¾åˆ°ç›¸ä¼¼çš„æ€§èƒ½ï¼Œä¸åŒæ¨¡å‹éœ€è¦çš„æ ‡ç­¾æ•°ã€‚</p><img src="https://i.loli.net/2020/06/25/jcXphwBmR8J6SeU.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä¸‹è¡¨å±•ç¤ºäº†ä½¿ç”¨ä¸åŒä¸»åŠ¨å­¦ä¹ ç­–ç•¥ (U - conventional uncertainty method, UCD - æœ¬æ–‡ä½¿ç”¨çš„æ–¹æ³•, random - éšæœºé€‰æ‹©) è¿›è¡Œæ ‡è®°å¾—åˆ°çš„ç»“æœï¼š</p><img src="https://i.loli.net/2020/06/25/pe24P9gFJfQVrKM.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>åŒæ—¶ä½œè€…è¿˜å¯¹ä¸åŒ$\alpha$çš„é€‰æ‹©è¿›è¡Œäº†å®éªŒï¼š</p><img src="https://i.loli.net/2020/06/25/ifRhv85IqaVw7gx.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="RQ4-How-effective-is-ATAD-in-detecting-anomalies-in-a-companyâ€™s-local-dataset-based-on-public-datasets"><a href="#RQ4-How-effective-is-ATAD-in-detecting-anomalies-in-a-companyâ€™s-local-dataset-based-on-public-datasets" class="headerlink" title="RQ4: How effective is ATAD in detecting anomalies in a companyâ€™s local dataset based on public datasets?"></a>RQ4: How effective is ATAD in detecting anomalies in a companyâ€™s local dataset based on public datasets?</h3><p>è¿™é‡Œä½œè€…å¯¹æ¯”äº†ä¸åŒæ–¹æ³•åœ¨å¾®è½¯å†…éƒ¨æ•°æ®é›†ä¸Šçš„ç»“æœï¼š</p><img src="https://i.loli.net/2020/06/25/5oi3rcGugKXmTha.png" srcset="/img/loading.gif" style="zoom:67%;" />]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Transfer Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Learning Representations of Ultrahigh-dimensional Data for Random Distance-based Outlier Detection</title>
    <link href="/2020/05/06/Learning-Representations-of-Ultrahigh-dimensional-Data-for-Random-Distance-based-Outlier-Detection/"/>
    <url>/2020/05/06/Learning-Representations-of-Ultrahigh-dimensional-Data-for-Random-Distance-based-Outlier-Detection/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡æå‡ºäº†ä¸€ç§é’ˆå¯¹é«˜ç»´æ•°æ®å¼‚å¸¸æ£€æµ‹çš„è¡¨ç¤ºå­¦ä¹ æ–¹æ³•ã€‚æ–‡ä¸­æå‡ºäº†<strong>RAMODO</strong>æ¡†æ¶ï¼Œä¸€ç§åŸºäºæ’åºçš„ç»“åˆè¡¨ç¤ºå­¦ä¹ å’Œå¼‚å¸¸æ£€æµ‹çš„æ— ç›‘ç£æ¡†æ¶ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒåŸºäº<strong>RAMODO</strong>ï¼Œæ–‡ä¸­è¿˜æå‡ºäº†åŸºäºæ­¤æ¡†æ¶çš„æ¨¡å‹<strong>REPEN</strong>ã€‚</p><p><a href="https://arxiv.org/pdf/1806.04808" target="_blank" rel="noopener">PaperğŸ“°</a></p><h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1><h2 id="The-Proposed-Framework-RAMODO"><a href="#The-Proposed-Framework-RAMODO" class="headerlink" title="The Proposed Framework: RAMODO"></a>The Proposed Framework: <strong>RAMODO</strong></h2><h3 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h3><p>æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºé«˜ç»´æ•°æ®å­¦ä¹ ä½ç»´è¡¨ç¤ºï¼ŒåŒæ—¶åœ¨å­¦åˆ°çš„ä½ç»´è¡¨ç¤ºä¸­èƒ½å¤Ÿæ›´å¥½åœ°è¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€‚è®¾æœ‰æ•°æ®é›†$\mathcal{X}={\mathbf x_1,\mathbf x_2,\cdots, \mathbf x_N}$ ($\mathbf x_i\in \mathbb{R}^D$) å’Œä¸€ä¸ªåŸºäºéšæœºè·ç¦»çš„å¼‚å¸¸æ£€æµ‹å™¨$\phi:\mathcal{X}\mapsto \mathbb{R}$ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªè¡¨ç¤ºå‡½æ•°$f:\mathcal{X}\mapsto\mathbb{R}^M (M\ll D)$ä½¿å¾—å¯¹äºæ‰€æœ‰å¼‚å¸¸æ ·æœ¬$\mathbf x_i$å’Œæ­£å¸¸æ ·æœ¬$\mathbf x_j$éƒ½æœ‰$\phi(f(\mathbf x_i))&gt;\phi(f(\mathbf x_j))$ã€‚</p><h3 id="Ranking-Model-based-Representation-Learning-Framework"><a href="#Ranking-Model-based-Representation-Learning-Framework" class="headerlink" title="Ranking Model-based Representation Learning Framework"></a>Ranking Model-based Representation Learning Framework</h3><p><strong>RAMODO</strong>åŸºäº<em>pairwise ranking model<em>ã€‚ç¬¬ä¸€æ­¥æ˜¯é€šè¿‡ä¸€å®šçš„é¢„å¤„ç†ç®—æ³•ï¼ˆåŸæ–‡ä¸­ç§°ä¸º</em>outlier thresholding<em>ï¼‰å°†æ•°æ®åˆ’åˆ†ä¸ºinlierå€™é€‰é›†å’Œoutlierå€™é€‰é›†ï¼›ç¬¬äºŒæ­¥é€šè¿‡éšæœºä»inlierå€™é€‰é›†é‡‡æ ·$n$ä¸ªæ ·æœ¬ç”Ÿæˆquery set $(\mathbf x_i,\cdots,\mathbf x_{i+n-1})$ï¼Œä»inlierå€™é€‰é›†é‡‡æ ·ä¸€ä¸ªæ ·æœ¬ç”Ÿæˆ</em>positive example</em> $(\mathbf x^+)$ï¼Œä»outlierå€™é€‰é›†é‡‡æ ·ä¸€ä¸ªæ ·æœ¬ç”Ÿæˆ<em>negative example</em> $(\mathbf x^-)$ï¼Œå°†ä¸‰è€…ç»„åˆç”Ÿæˆ <em>metatriplet</em> $T=(&lt;\mathbf x_i,\cdots,\mathbf x_{i+n-1}&gt;,\mathbf x^+,\mathbf x^-)$ï¼›ç¬¬ä¸‰æ­¥é€šè¿‡ç¥ç»ç½‘ç»œ$f$å­¦ä¹ è¡¨ç¤ºï¼›ç¬¬å››æ­¥é€šè¿‡<em>outlier score-based ranking loss</em> $L(\phi(f(\mathbf x^+)|&lt;f(\mathbf x_i),\cdots,f(\mathbf x_{i+n-1})&gt;),\phi(f(\mathbf x^-)|&lt;f(\mathbf x_i),\cdots,f(\mathbf x_{i+n-1})&gt;))$æ¥è¿›è¡Œä¼˜åŒ–ï¼Œå…¶ä¸­$\phi(\cdot|\cdot)$ä¸ºåŸºäºè·ç¦»çš„å¼‚å¸¸æ£€æµ‹å™¨ã€‚</p><p><img src="https://i.loli.net/2020/06/25/4I7fx5ZjBhueUDz.png" srcset="/img/loading.gif" alt=""></p><h2 id="A-RAMODO-Instance-REPEN"><a href="#A-RAMODO-Instance-REPEN" class="headerlink" title="A RAMODO Instance: REPEN"></a>A <strong>RAMODO</strong> Instance: <strong>REPEN</strong></h2><p><strong>REPEN</strong>ä¸º<strong>RAMODO</strong>çš„å®ä¾‹æ¨¡å‹ï¼Œä½¿ç”¨Spä½œä¸ºå¼‚å¸¸æ£€æµ‹å™¨ã€‚</p><h3 id="Outlier-Thresholding-Using-State-of-the-art-Detectors-and-Cantelliâ€™s-Inequality"><a href="#Outlier-Thresholding-Using-State-of-the-art-Detectors-and-Cantelliâ€™s-Inequality" class="headerlink" title="Outlier Thresholding Using State-of-the-art Detectors and Cantelliâ€™s Inequality"></a>Outlier Thresholding Using State-of-the-art Detectors and Cantelliâ€™s Inequality</h3><p>ç¬¬ä¸€æ­¥ä½¿ç”¨Spä½œä¸ºåŸºç¡€è·å¾—åˆå§‹anomaly scoreï¼š</p><blockquote><p><strong>Definition 1</strong> (<em>Sp-based Outlier Scoring</em>). ç»™å®šæ ·æœ¬$x_i$ï¼ŒSp ä»¥ä»¥ä¸‹æ–¹å¼å®šä¹‰è¯¥æ ·æœ¬çš„å¼‚å¸¸ç¨‹åº¦ï¼š<br>$$<br>r_i=\frac{1}{m}\sum\limits_{j=1}^m nn_dist(\mathbf x_i|\mathcal{S}_j)<br>$$<br>å…¶ä¸­$\mathcal S_j\subset \mathcal X$ä¸ºæ•°æ®é›†éšæœºé‡‡æ ·çš„å­é›†ï¼Œ$m$ä¸ºé›†æˆå¤§å°ï¼Œ$nn_dist(\cdot|\cdot)$ä¸º$\mathcal S_j$ä¸­æœ€è¿‘é‚»å±…çš„è·ç¦»ã€‚</p></blockquote><p>æ¥ç€é€šè¿‡<em>Cantelliâ€™s Inequality</em>æ¥å®šä¹‰<em>Pseudo Outlier</em>ï¼š</p><blockquote><p><em><em>Definition 2 *</em>(*Cantelliâ€™s Inequality-based Outlier Thresholding</em>). ç»™å®šå¼‚å¸¸åˆ†æ•°å‘é‡$\mathbf r\in\mathbb R^N$ï¼Œæ›´é«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ›´é«˜çš„å¯èƒ½æ€§ä¸ºå¼‚å¸¸ï¼Œè®¾$\mu$å’Œ$\delta^2$åˆ†åˆ«ä¸ºå‡å€¼å’Œæ–¹å·®ï¼Œ<em>Outlier</em>å€™é€‰é›†ç”±ä»¥ä¸‹æ–¹å¼ç¡®å®šï¼š<br>$$<br>\mathcal{O}={\mathbf x_i|r_i \geq \mu + \alpha\delta}, \space\forall \mathbf x_i\in\mathcal X, \space r_i\in\mathbf r<br>$$<br>å…¶ä¸­$\alpha\geq 0$ä¸ºè‡ªå®šä¹‰çš„é˜ˆå€¼ã€‚</p></blockquote><p><em>Inlier</em>å€™é€‰é›†$\mathcal I=\mathcal X\backslash \mathcal O$ã€‚</p><h3 id="Triplet-Sampling-Based-on-Outlier-Scores"><a href="#Triplet-Sampling-Based-on-Outlier-Scores" class="headerlink" title="Triplet Sampling Based on Outlier Scores"></a>Triplet Sampling Based on Outlier Scores</h3><p>é¦–å…ˆï¼Œä»$\mathcal I$é‡‡æ ·ä¸€å®šæ•°é‡çš„æ ·æœ¬ç»„æˆ<em>query set</em>ï¼Œæ¯ä¸ªæ ·æœ¬è¢«é‡‡æ ·çš„æ¦‚ç‡ä¸å…¶å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°æœ‰å…³ï¼š</p><p>$$<br>p(\mathbf x_i)=\frac{\mathbb Z-r_i}{\sum_{t=1}^{|\mathcal I|}[\mathbb Z-r_t]}<br>$$</p><p>å…¶ä¸­$\mathbb Z=\sum_{t=1}^{|\mathcal I|}r_t$ã€‚</p><p>ä¹‹åä»<em>inlier set<em>ä¸­å‡åŒ€éšæœºé‡‡æ ·ä¸€ä¸ª</em>positive sample</em> $\mathbf x^+$ã€‚æœ€åä»<em>outlier set<em>ä¸­æ ¹æ®ä»¥ä¸‹æ¦‚ç‡é‡‡æ ·ä¸€ä¸ª</em>negative sample</em> $\mathbf x^-$ï¼š<br>$$<br>p(\mathbf x_j)=\frac{r_j}{\sum_{t=1}^{|\mathcal O|}r_t}<br>$$</p><h3 id="A-Shallow-Data-Representation"><a href="#A-Shallow-Data-Representation" class="headerlink" title="A Shallow Data Representation"></a>A Shallow Data Representation</h3><p>å•å±‚ç¥ç»ç½‘ç»œç”¨æ¥è·å¾—æµ…å±‚çš„è¡¨ç¤ºï¼š</p><blockquote><p><em><em>Definition 3 *</em>(*Single-layer Fully-connected Representations</em>) ç»™å®šè¾“å…¥$x$ï¼Œ<br>$$<br>f_\Theta(\mathbf x)={\psi(\mathbf w_1^\top\mathbf x),\psi(\mathbf w_2^\top\mathbf x),\cdots,\psi(\mathbf w_M^\top\mathbf x)}<br>$$<br>å…¶ä¸­$\psi(\cdot)$ä¸ºæ¿€æ´»å‡½æ•°ï¼Œ$\mathbf w$ä¸ºæƒé‡çŸ©é˜µã€‚</p></blockquote><h3 id="Ranking-Loss-Using-Random-Nearest-Neighbor-Distance-based-Outlier-Scores"><a href="#Ranking-Loss-Using-Random-Nearest-Neighbor-Distance-based-Outlier-Scores" class="headerlink" title="Ranking Loss Using Random Nearest Neighbor Distance-based Outlier Scores"></a>Ranking Loss Using Random Nearest Neighbor Distance-based Outlier Scores</h3><p>è®¾$\mathcal{Q}=&lt;f_\Theta(\mathbf x_i),\cdots,f_\Theta(\mathbf x_{i+n-1})&gt;$ä¸º<em>query set</em>ï¼Œç»™å®šæ ·æœ¬$\mathbf x$ï¼Œ<strong>REPEN</strong>æ ¹æ®æœ€è¿‘é‚»è·ç¦»å®šä¹‰äº†$f_\Theta(\mathbf x)$çš„å¼‚å¸¸ç¨‹åº¦ï¼š<br>$$<br>\phi(f_\Theta(\mathbf x)|\mathcal{Q})=nn_dist(f_\Theta(\mathbf x)|\mathcal Q)<br>$$<br>å› æ­¤ï¼Œç»™å®šä¸‰å…ƒç»„$T=(\mathcal Q,f_\Theta(\mathbf x^+),f_\Theta(\mathbf x^-))$ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦å¾—è¡¨ç¤º$f(\cdot)$ä½¿å¾—ï¼š<br>$$<br>nn_dist(f_\Theta(\mathbf x^+)|\mathcal Q)&lt;nn_dist(f_\Theta(\mathbf x^-)|\mathcal Q)<br>$$<br>æŸå¤±å‡½æ•°ï¼š<br>$$<br>J(\Theta;T)=L(\phi(f_\Theta(\mathbf x^+)|\mathcal Q),\phi(f_\Theta(\mathbf x^-)|\mathcal Q))=\\max{0, c+nn_dist(f_\Theta(\mathbf x^+)|\mathcal Q)-nn_dist(f_\Theta(\mathbf x^-)|\mathcal Q)}<br>$$<br>å…¶ä¸­$c$ä¸ºè¾¹ç•Œå‚æ•°ã€‚ç»™å®šä¸€ç³»åˆ—ä¸‰å…ƒç»„ï¼Œæœ€ç»ˆä¼˜åŒ–ç›®æ ‡å¦‚ä¸‹ï¼š<br>$$<br>\mathop{\text{arg min}}\limits_{\Theta}\frac{1}{|\mathcal{T}|}\sum\limits_{i=1}^{|\mathcal T|}J(\Theta;T_i)<br>$$</p><h3 id="The-Algorithm-and-Its-Time-Complexity"><a href="#The-Algorithm-and-Its-Time-Complexity" class="headerlink" title="The Algorithm and Its Time Complexity"></a>The Algorithm and Its Time Complexity</h3><p><img src="https://i.loli.net/2020/06/25/eYtKHBJ7szCgjNa.png" srcset="/img/loading.gif" alt=""></p><h3 id="Leveraging-A-Few-Labeled-Outliers-to-Improve-Triplet-Sampling"><a href="#Leveraging-A-Few-Labeled-Outliers-to-Improve-Triplet-Sampling" class="headerlink" title="Leveraging A Few Labeled Outliers to Improve Triplet Sampling"></a>Leveraging A Few Labeled Outliers to Improve Triplet Sampling</h3><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Datasets"><a href="#Datasets" class="headerlink" title="Datasets"></a>Datasets</h2><ul><li>ADï¼šç½‘ç»œå¹¿å‘Šæ£€æµ‹</li><li>LCï¼šè‚ºç™Œç–¾ç—…ç›‘æµ‹</li><li>p53ï¼šå¼‚å¸¸è›‹ç™½è´¨æ´»åŠ¨æ£€æµ‹</li><li>R8ï¼šæ–‡æœ¬åˆ†ç±»</li><li>News20ï¼šæ–‡æœ¬åˆ†ç±»</li><li>URLï¼šå¼‚å¸¸ç½‘å€æ£€æµ‹</li><li>Webspamï¼šPascal Large Scale LearningChallenge</li></ul><h2 id="Effectiveness-in-Real-world-Data-with-Thousands-to-Millions-of-Features"><a href="#Effectiveness-in-Real-world-Data-with-Thousands-to-Millions-of-Features" class="headerlink" title="Effectiveness in Real-world Data with Thousands to Millions of Features"></a>Effectiveness in Real-world Data with Thousands to Millions of Features</h2><p>ä½œè€…åˆ†åˆ«ä½¿ç”¨åŸå§‹ç‰¹å¾å’Œ<em>REPEN</em>å­¦åˆ°çš„ç‰¹å¾è¿›è¡Œå¼‚å¸¸æ£€æµ‹ï¼ŒIMPä»£è¡¨æ€§èƒ½æå‡æ¯”ä¾‹ï¼ŒSUä»£è¡¨åŠ é€Ÿæ¯”ä¾‹ã€‚</p><p><img src="https://i.loli.net/2020/06/25/mvUiE1NzyTwOgV8.png" srcset="/img/loading.gif" alt=""></p><h2 id="Comparing-to-State-of-the-art-Representation-Learning-Competitors"><a href="#Comparing-to-State-of-the-art-Representation-Learning-Competitors" class="headerlink" title="Comparing to State-of-the-art Representation Learning Competitors"></a>Comparing to State-of-the-art Representation Learning Competitors</h2><ul><li>*<em>AE: *</em>è‡ªç¼–ç å™¨</li><li><em><em>HLLE: *</em> *Hessian Locally Linear Embedding</em></li><li><em><em>SRP: *</em> *Sparse Random Projection</em></li><li><em><em>CoP: *</em> *Coherent Pursuit</em></li></ul><p><img src="https://i.loli.net/2020/06/25/yQumCRNrHAheJ34.png" srcset="/img/loading.gif" alt=""></p><h2 id="The-Capability-of-Leveraging-Labeled-Outliers-as-Prior-Knowledge"><a href="#The-Capability-of-Leveraging-Labeled-Outliers-as-Prior-Knowledge" class="headerlink" title="The Capability of Leveraging Labeled Outliers as Prior Knowledge"></a>The Capability of Leveraging Labeled Outliers as Prior Knowledge</h2><p><img src="https://i.loli.net/2020/06/25/NOLfKQd2u1JMPtp.png" srcset="/img/loading.gif" alt=""></p><h2 id="Sensitivity-Test-w-r-t-the-Representation-Dimension"><a href="#Sensitivity-Test-w-r-t-the-Representation-Dimension" class="headerlink" title="Sensitivity Test w.r.t. the Representation Dimension"></a>Sensitivity Test w.r.t. the Representation Dimension</h2><p><img src="https://i.loli.net/2020/06/25/BoGjY5SEu6vrK3X.png" srcset="/img/loading.gif" alt=""></p><p><img src="https://i.loli.net/2020/06/25/Rlx7Df9Hvsjp2Eg.png" srcset="/img/loading.gif" alt=""></p><p>æ–‡ä¸­æåˆ°äº†å¯¹äºR8ã€URLã€News20è¿™ä¸‰ä¸ªæ•°æ®é›†åœ¨ç»´åº¦$M=1$çš„æ—¶å€™è¡¨ç°å’Œå…¶ä»–ç»´åº¦ä¸€æ ·å¥½ï¼Œä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯åœ¨è¿™å‡ ä¸ªæ•°æ®é›†ä¸­å¼‚å¸¸éƒ¨åˆ†æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œæ‰€ä»¥1ç»´å°±è¶³å¤Ÿäº†ï¼Œå¦ä¸€ä¸ªè§£é‡Šæ˜¯ä¼˜åŒ–é—®é¢˜ã€‚</p><h2 id="Scalability-Test"><a href="#Scalability-Test" class="headerlink" title="Scalability Test"></a>Scalability Test</h2><p><img src="https://i.loli.net/2020/06/25/1JfUclWyFYgLdNp.png" srcset="/img/loading.gif" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Representation Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Deep Weakly-supervised Anomaly Detection</title>
    <link href="/2020/03/30/Deep-Weakly-supervised-Anomaly-Detection/"/>
    <url>/2020/03/30/Deep-Weakly-supervised-Anomaly-Detection/</url>
    
    <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1><p>åœ¨æ–‡çŒ®ä¸­ï¼Œå› ä¸ºæ ‡æ³¨æˆæœ¬çš„æ˜‚è´µï¼Œæ— ç›‘ç£æ–¹æ³•å æ®äº†å¼‚å¸¸æ£€æµ‹çš„ä¸»è¦ä½ç½®ã€‚ç„¶è€Œï¼Œåœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰å°‘é‡æ ‡ç­¾ï¼Œå¦‚ä½•åˆ©ç”¨è¿™éƒ¨åˆ†æ ‡ç­¾ä¿¡æ¯å°±æˆä¸ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œä½œè€…å°†å…¶ç§°ä¹‹ä¸º<em>anomaly-informed modeling</em>ã€‚ä½œè€…æå‡ºäº†ä¸¤ç‚¹æŒ‘æˆ˜ï¼š</p><ol type="1"><li>å°‘é‡æ ‡ç­¾å¯èƒ½æ— æ³•æä¾›æ‰€æœ‰ç±»å‹å¼‚å¸¸çš„ä¿¡æ¯ï¼›</li><li>å¤§éƒ¨åˆ†æ— æ ‡ç­¾æ•°æ®ä¸ºæ­£å¸¸æ ·æœ¬ï¼Œä½†å…¶ä¸­åŒ…å«å°‘éƒ¨åˆ†å¼‚å¸¸ï¼ˆæ±¡æŸ“ï¼‰ã€‚</li></ol><p>ä½œè€…æå‡ºäº†åŸºäºpairwise relation learningçš„æ–¹æ³•æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚æ–‡ç« çš„ä¸»è¦è´¡çŒ®å¦‚ä¸‹ï¼š</p><ol type="1"><li>æå‡ºäº†ä¸€ç§åŸºäºpairing-based data augmentationå’Œordinal regressionæ¥è¿›è¡Œå¼±ç›‘ç£å¼‚å¸¸æ£€æµ‹çš„æ¡†æ¶</li><li>åŸºäºè¯¥æ¡†æ¶æå‡ºäº†PReNetï¼Œä¸€ç§åŸºäºåŒæµordinal regressionçš„ç½‘ç»œ</li><li>ä»ç†è®ºå’Œå®è·µè§’åº¦åˆ†æäº†æ–¹æ³•çš„æœ‰æ•ˆæ€§</li><li>åœ¨40ä¸ªçœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®Œå–„çš„å®éªŒ</li></ol><h1 id="proposed-method">Proposed Method</h1><h2 id="learning-anomaly-scores-by-predicting-pairwise-relation">Learning Anomaly Scores by Predicting Pairwise Relation</h2><h3 id="problem-formulation">Problem Formulation</h3><p>ç»™å®šæ•°æ®é›†<span class="math inline">\(\mathcal{X}=\{\mathbf{x}_1,\mathbf {x}_2,\cdots,\mathbf{x}_N,\mathbf{x}_{N+1},\cdots,\mathbf{x}_{N+K}\}\)</span>ï¼ŒåŒ…å«ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯äº”æ ‡ç­¾æ•°æ®<span class="math inline">\(\mathcal{U}=\{\mathbf{x}_1,\mathbf {x}_2,\cdots,\mathbf{x}_N\}\)</span>ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æœ‰æ ‡ç­¾å¼‚å¸¸æ•°æ®<span class="math inline">\(\mathcal{A}=\{\mathbf{x}_{N+1},\cdots,\mathbf{x}_{N+K}\}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(K\ll N\)</span>ã€‚æˆ‘ä»¬çš„ä»»åŠ¡ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªæ‰“åˆ†å‡½æ•°<span class="math inline">\(\phi:\mathcal{X}\mapsto \mathbb{R}\)</span>ï¼Œä½¿å¾—å¯¹ä»»ä»»æ„å¼‚å¸¸æ ·æœ¬çš„æ‰“åˆ†é«˜äºä»»æ„æ­£å¸¸æ ·æœ¬ã€‚</p><p>åœ¨è¿™ä¸ªFormulationé‡Œï¼Œä½œè€…å°†å…³ç³»å­¦ä¹ å’Œå¼‚å¸¸æ‰“åˆ†ç»Ÿä¸€äº†èµ·æ¥ã€‚é¦–å…ˆï¼Œè¾“å…¥çš„æ•°æ®é›†ä¸å†æ˜¯åŸå§‹æ ·æœ¬ï¼Œè€Œæ˜¯æ ·æœ¬å¯¹ã€‚æ ·æœ¬å¯¹åŒ…å«ä¸‰ç§ï¼š<em>anomaly-anomaly</em>ï¼Œ<em>anomaly-unlabeled</em>ï¼Œ<em>unlabeled-unlabeled</em>ï¼Œè®°ä¸º<span class="math inline">\(C_{\{\mathbf{a},\mathbf{a}\}}\)</span>ï¼Œ<span class="math inline">\(C_{\{\mathbf{a},\mathbf{u}\}}\)</span>ï¼Œ<span class="math inline">\(C_{\{\mathbf{u},\mathbf{u}\}}\)</span>ã€‚æ¯ä¸€ä¸ªæ ·æœ¬å¯¹åŒ…å«ä¸€ä¸ªæ ‡ç­¾<span class="math inline">\(y\)</span>ï¼Œè¡¨ç¤ºè¯¥pairå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°ï¼Œæ•´ä¸ªè¾“å…¥æ•°æ®é›†<span class="math inline">\(\mathcal{P}=\{\{\mathbf{x}_i,\mathbf{x}_j,y_{ij}\}|\mathbf{x}_i,\mathbf{x}_j\in\mathcal{X} \space\text{and}\space y_{ij}\in\mathbb{N}\}\)</span>ã€‚å› ä¸ºæœ‰<span class="math inline">\(y_{\{\mathbf a,\mathbf a\}}&gt;y_{\{\mathbf a,\mathbf u\}}&gt;y_{\{\mathbf u,\mathbf u\}}\)</span>ï¼Œæ‰€ä»¥å¯¹å…³ç³»çš„å­¦ä¹ ä¹Ÿæ˜¯å¯¹å¼‚å¸¸æ‰“åˆ†çš„å­¦ä¹ ã€‚</p><h3 id="the-instantiated-model-prenet">The Instantiated Model: PReNET</h3><p>ä¸‹å›¾ä¸ºæ¨¡å‹ç¤ºæ„å›¾ï¼Œ<strong>Data Augmentation</strong>æ¨¡å—è´Ÿè´£äº§ç”Ÿpairæ•°æ®ï¼Œ<strong>End-to-End Anomaly Score Learner <span class="math inline">\(\phi\)</span></strong> æ¨¡å—è´Ÿè´£å…³ç³»å­¦ä¹ ï¼ˆå¼‚å¸¸æ‰“åˆ†ï¼‰ã€‚</p><p><img src="https://i.loli.net/2020/06/25/6ZF3w9v1Lux5t4Q.png" srcset="/img/loading.gif" style="zoom:67%;" /></p><h4 id="data-argumentation-by-pairing">Data Argumentation by Pairing</h4><p>æ•°æ®çš„äº§ç”Ÿåˆ†ä¸ºä¸¤æ­¥ï¼š</p><ol type="1"><li>ä»<span class="math inline">\(\mathcal{A}\)</span>å’Œ<span class="math inline">\(\mathcal{U}\)</span>ä¸Šéšæœºé‡‡æ ·ï¼Œç»„æˆpairï¼›</li><li>å¯¹æ¯ä¸ªpairæ‰“ä¸Šæ¬¡åº(ordinal class feature) æ ‡ç­¾<span class="math inline">\(\mathbf{y}\)</span>ã€‚</li></ol><p>éƒ¨åˆ†<span class="math inline">\(C_{\{\mathbf{a},\mathbf{u}\}}\)</span>å’Œ<span class="math inline">\(C_{\{\mathbf{u},\mathbf{u}\}}\)</span>å¯èƒ½åŒ…å«å¼‚å¸¸æ±¡æŸ“ï¼Œå› ä¸ºåœ¨<span class="math inline">\(\mathcal{U}\)</span>ä¸­å¯èƒ½ä¼šæœ‰æœªæ ‡è®°çš„å¼‚å¸¸æ ·æœ¬ã€‚</p><h4 id="end-to-end-anomaly-score-learner">End-to-End Anomaly Score Learner</h4><p>ä»¤<span class="math inline">\(\mathcal{Z}\in\mathbb{R}^M\)</span>ä¸ºä¸­é—´è¡¨ç¤ºç©ºé—´ï¼Œé‚£ä¹ˆ<strong>Score Learner</strong>å¯ä»¥æ‹†è§£ä¸ºç‰¹å¾å­¦ä¹ <span class="math inline">\(\psi(\cdot;\Theta_r):\mathcal{X}\mapsto \mathcal{Z}\)</span>å’Œæ‰“åˆ†å‡½æ•°<span class="math inline">\(\eta((\cdot,\cdot);\Theta_s):(\mathcal{Z},\mathcal{Z})\mapsto\mathbb{R}\)</span>ä¸¤éƒ¨åˆ†ï¼Œä¸¤éƒ¨åˆ†éƒ½ç”±ç¥ç»ç½‘ç»œç»„æˆã€‚</p><h4 id="ordinal-regression">Ordinal Regression</h4><p>æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š <span class="math display">\[L\left(\phi((\mathbf x_i,\mathbf x_j);\Theta),y_{ij}\right)=|y_{ij}-\phi((\mathbf x_i,\mathbf x_j);\Theta)|\]</span> é‡‡ç”¨ç»å¯¹å€¼è€Œä¸æ˜¯å‡æ–¹è¯¯å·®çš„åŸå› æ˜¯ä¸ºäº†å‡å°‘å¼‚å¸¸æ±¡æŸ“çš„å½±å“ã€‚é»˜è®¤<span class="math inline">\(y_{\{\mathbf a,\mathbf a\}}=8\)</span>ï¼Œ<span class="math inline">\(y_{\{\mathbf a,\mathbf u\}}=4\)</span>ï¼Œ<span class="math inline">\(y_{\{\mathbf u,\mathbf u\}}=0\)</span>ã€‚æœ€åçš„ä¼˜åŒ–å‡½æ•°å¯ä»¥å†™ä¸ºï¼š <span class="math display">\[\mathop{\text{argmin}}\limits_{\Theta}\frac{1}{|\mathcal{B}|}\sum\limits_{\{\mathbf x_i,\mathbf x_j, y_{ij}\}\in\mathcal{B}}|y_{ij}-\phi((\mathbf x_i,\mathbf x_j);\Theta)|+\lambda R(\Theta)\]</span> <span class="math inline">\(\mathcal{B}\)</span>ä¸ºä¸€ä¸ªbatchï¼Œ<span class="math inline">\(R(\Theta)\)</span>ä¸ºæ­£åˆ™é¡¹ã€‚</p><h3 id="anomaly-detection-using-prenet">Anomaly Detection Using PReNet</h3><h4 id="training-stage">Training Stage</h4><p>è®­ç»ƒæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/oR6uTL3c7HMpwD4.png" srcset="/img/loading.gif" style="zoom: 80%;" /></p><p>ä¸ºäº†ä¿è¯è®­ç»ƒæ ·æœ¬ç±»åˆ«çš„å¹³è¡¡ï¼Œ<span class="math inline">\(\frac{|\mathcal{B}|}{2}\)</span>çš„æ ·æœ¬é‡‡æ ·è‡ª<span class="math inline">\(C_{\{\mathbf u,\mathbf u\}}\)</span>ï¼Œé‡‡æ ·è‡ª<span class="math inline">\(C_{\{\mathbf a,\mathbf u\}}\)</span>å’Œ<span class="math display">\[C_{\{\mathbf a,\mathbf a\}}\]</span>çš„æ ·æœ¬éƒ½å <span class="math inline">\(\frac{|\mathcal{B}|}{4}\)</span>ã€‚</p><h4 id="anomaly-scoring-stage">Anomaly Scoring Stage</h4><p>åœ¨æµ‹è¯•é˜¶æ®µï¼Œç»™å®šæµ‹è¯•æ ·æœ¬<span class="math inline">\(\mathbf{x}_k\)</span>ï¼Œå…ˆåˆ†åˆ«ä»<span class="math inline">\(\mathcal{A}\)</span>å’Œ<span class="math inline">\(\mathcal{U}\)</span>é‡‡æ ·ï¼Œç„¶åå®šä¹‰ä»¥ä¸‹<em>anomaly score</em>ï¼š <span class="math display">\[s_{\mathbf{x}_k}=\frac{1}{2E}\left[\sum\limits_{i=1}^E\phi((\mathbf a_i,\mathbf x_k);\Theta^*)+\sum\limits_{j=1}^E\phi((\mathbf x_k,\mathbf u_j);\Theta^*)\right]\]</span> <span class="math inline">\(\mathbf a_i\)</span>å’Œ<span class="math inline">\(\mathbf u_j\)</span>ä¸ºéšæœºé‡‡æ ·å¾—åˆ°çš„å¼‚å¸¸æ ·æœ¬å’Œæ­£å¸¸æ ·æœ¬ï¼Œé‡‡æ ·å¤§å°<span class="math inline">\(E\)</span>é»˜è®¤ä¸º30ã€‚</p><h1 id="experiments">Experiments</h1><p>å®éªŒéƒ¨åˆ†ä¸»è¦æ˜¯å›ç­”ä»¥ä¸‹å››ä¸ªé—®é¢˜ï¼š</p><ol type="1"><li>åœ¨æœ‰é™çš„æ ‡ç­¾å¼‚å¸¸æƒ…å†µä¸‹ï¼ŒPReNetèƒ½å¦æœ‰æ•ˆåœ°æ£€æµ‹å·²çŸ¥å’ŒæœªçŸ¥çš„å¼‚å¸¸ï¼›</li><li>åœ¨ä¸åŒæ•°é‡æ ‡ç­¾å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼ŒPReNetçš„è¡¨ç°å¦‚ä½•ï¼›</li><li>PReNetå¯¹å¼‚å¸¸æ±¡æŸ“çš„é²æ£’æ€§å¦‚ä½•ï¼›</li><li>PReNetä¸åŒç»„ä»¶çš„é‡è¦æ€§å¦‚ä½•ã€‚</li></ol><h2 id="datasets">Datasets</h2><p>å®éªŒä¸€å…±ç”¨åˆ°äº†40ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­12ä¸ªç”¨æ¥è¯„æµ‹ç®—æ³•æ£€æµ‹å·²çŸ¥çš„å¼‚å¸¸çš„èƒ½åŠ›ï¼ˆå¦‚Table 2æ‰€ç¤ºï¼‰ï¼Œ28ä¸ªç”¨æ¥è¯„æµ‹ç®—æ³•æ£€æµ‹æœªçŸ¥çš„å¼‚å¸¸çš„èƒ½åŠ›ï¼ˆå¦‚Table 3æ‰€ç¤ºï¼‰ã€‚</p><h2 id="competing-methods-and-parameter-settings">Competing Methods and Parameter Settings</h2><p>ç”¨åˆ°çš„baselineæœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p><ul><li>DevNetï¼šåŒä¸€ä½œè€…åœ¨KDD2019æå‡ºçš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶</li><li>Deep support vector data description (DSVDD)ï¼šæ·±åº¦æ”¯æŒå‘é‡æ•°æ®æè¿°</li><li>Prototypical networkï¼š few-shot classificationä¸­çš„ä¸€ç§æ¨¡å‹</li><li>iForestï¼šå­¤ç«‹æ£®æ—</li></ul><h2 id="performance-evaluation-metrics">Performance Evaluation Metrics</h2><p>ç”¨åˆ°çš„Metricsä¸ºAUC-ROCå’ŒAUC-PRã€‚</p><h2 id="detection-of-known-anomalies">Detection of Known Anomalies</h2><p>åœ¨æœ¬å®éªŒä¸­ï¼Œå¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹ï¼ˆ2%ï¼‰å’Œæœ‰æ ‡è®°å¼‚å¸¸æ ·æœ¬çš„æ•°é‡ï¼ˆ60ï¼‰æ˜¯å›ºå®šçš„ï¼Œä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/BfhVE9z8DWipAM6.png" srcset="/img/loading.gif" style="zoom: 80%;" /></p><h2 id="detection-of-unknown-anomalies">Detection of Unknown Anomalies</h2><p>åœ¨æœ¬å®éªŒä¸­ï¼Œå¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹ï¼ˆ2%ï¼‰å’Œæœ‰æ ‡è®°å¼‚å¸¸æ ·æœ¬çš„æ•°é‡ï¼ˆ60ï¼‰åŒæ ·æ˜¯å›ºå®šçš„ï¼Œä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/9GM8XTYiSLUn2Ar.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><p><img src="https://i.loli.net/2020/06/25/4RxrGZWLqHNnXco.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><h2 id="availability-of-known-anomalies">Availability of Known Anomalies</h2><p>æœ¬å®éªŒä¸»è¦æ˜¯ç ”ç©¶ä¸åŒæ•°é‡æ ‡æ³¨å¼‚å¸¸æ ·æœ¬çš„æ¡ä»¶ä¸‹ï¼Œç®—æ³•çš„æ€§èƒ½å¦‚ä½•ã€‚å¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹å›ºå®šï¼ˆ2%ï¼‰ï¼Œæ ‡æ³¨å¼‚å¸¸çš„æ•°é‡ä»15åˆ°120å˜åŒ–ã€‚å®éªŒç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/x4Hf3lU5JO71bvo.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><h2 id="further-analysis-of-prenet">Further Analysis of PReNet</h2><h3 id="tolerance-to-anomaly-contamination-in-unlabeled-data">Tolerance to Anomaly Contamination in Unlabeled Data</h3><p>æœ¬å®éªŒä¸»è¦ç ”ç©¶ä¸åŒå¼‚å¸¸æ±¡æŸ“æ¯”ä¾‹ä¸‹ï¼Œç®—æ³•çš„æ€§èƒ½ï¼Œå³æ¢ç©¶ç®—æ³•å¯¹å¼‚å¸¸æ±¡æŸ“çš„é²æ£’æ€§ã€‚æ ‡æ³¨å¼‚å¸¸æ ·æœ¬çš„æ•°é‡æ’å®šï¼ˆ60ï¼‰ï¼Œå¼‚å¸¸æ±¡æŸ“æ¯”ä¾‹åœ¨<span class="math inline">\(\{0\%,2\%,5\%,10\%\}\)</span>ä¸­å˜åŒ–ã€‚å®éªŒç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/TGYCJUs8LlmreNV.png" srcset="/img/loading.gif" style="zoom:80%;" /></p><h3 id="ablation-study">Ablation Study</h3><p>è¿™ä¸€èŠ‚æ˜¯æ¶ˆèå®éªŒï¼Œåˆ†åˆ«è®¾ç½®äº†å››ä¸ªå˜ä½“ï¼š</p><ul><li><strong>BOR: </strong>æŸå¤±å‡½æ•°æ›¿æ¢æˆäº†äºŒå€¼å›å½’<em>Binary Ordinal Regression</em>ï¼›</li><li><strong>OSNet: </strong>å°†åŒæµç»“æ„ç®€åŒ–ä¸ºå•æµï¼›</li><li><strong>LDM: </strong>å°†ç½‘ç»œä¸­çš„éšè—å±‚å»é™¤ï¼›</li><li><strong>A2H: </strong>åŠ å…¥äº†é¢å¤–çš„éšè—å±‚ï¼Œå¹¶ä¸”åŠ å…¥äº†<span class="math inline">\(\ell_2\)</span>-normé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</li></ul><p><img src="https://i.loli.net/2020/06/25/oR7qlZWfepFT8jK.png" srcset="/img/loading.gif" style="zoom:80%;" /></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Discovering Physical Concepts with Neural Networks</title>
    <link href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/"/>
    <url>/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>å¦‚é¢˜ç›®æ‰€ç¤ºï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥å‘æ˜ç‰©ç†æ¦‚å¿µã€‚å…¶æ€è·¯æ˜¯ä»å®éªŒæ•°æ®å­¦åˆ°è¡¨ç¤ºï¼Œç„¶åç”¨å­¦åˆ°çš„è¡¨ç¤ºæ¥å›ç­”ç‰©ç†é—®é¢˜ï¼Œç”±æ­¤ç‰©ç†æ¦‚å¿µå¯ä»¥ä»å­¦åˆ°çš„è¡¨ç¤ºæ¥æå–å‡ºã€‚ä½œè€…è¿›è¡Œäº†4ä¸ªå®éªŒï¼š</p><ol><li>åœ¨é˜»å°¼æŒ¯åŠ¨å®éªŒä¸­ï¼Œæ¨¡å‹å­¦åˆ°äº†ç›¸å…³çš„ç‰©ç†å‚æ•°ï¼›</li><li>åœ¨è§’åŠ¨é‡å®ˆæ’å®éªŒä¸­ï¼Œæ¨¡å‹é¢„æµ‹äº†è´¨ç‚¹çš„è¿åŠ¨ï¼›</li><li>ç»™å®šé‡å­ç³»ç»Ÿçš„è§‚æµ‹æ•°æ®ï¼Œæ¨¡å‹æ­£ç¡®çš„è¯†åˆ«å‡ºäº†é‡å­çŠ¶æ€çš„è‡ªç”±åº¦ï¼›</li><li>ç»™å®šä»åœ°çƒè§‚æµ‹çš„å¤ªé˜³å’Œç«æ˜Ÿçš„ä½ç½®æ—¶é—´åºåˆ—æ•°æ®ï¼Œæ¨¡å‹å‘ç°äº†æ—¥å¿ƒè¯´æ¨¡å‹ã€‚</li></ol><h1 id="Preliminaries"><a href="#Preliminaries" class="headerlink" title="Preliminaries"></a>Preliminaries</h1><p>ä½œè€…åœ¨é™„å½•ä¸­å¯¹ç¥ç»ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†è¿›è¡Œäº†ä»‹ç»ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œåªæˆªå–äº†ä¸€äº›ç›¸å¯¹å‰æ²¿çš„å†…å®¹ã€‚</p><img src="https://i.loli.net/2020/06/25/yh5Wj9AQmd6nsFC.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Variational-Autoencoders"><a href="#Variational-Autoencoders" class="headerlink" title="Variational Autoencoders"></a>Variational Autoencoders</h2><p>æœ¬æ–‡ç”¨åˆ°çš„æ¨¡å‹åŸºç¡€æ˜¯VAEï¼š</p><img src="https://i.loli.net/2020/06/25/zCnYjVEZHdbqAD3.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Representation-Learning"><a href="#Representation-Learning" class="headerlink" title="Representation Learning"></a>Representation Learning</h3><p><em>Representation learning</em>çš„ä¸»è¦ç›®æ ‡æ˜¯å°†æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªéšå‘é‡ (encoder)ï¼Œä¸ºäº†ä¿è¯éšå‘é‡åŒ…å«äº†æ‰€æœ‰ç›¸å…³ä¿¡æ¯ï¼Œ é‚£ä¹ˆåº”è¯¥èƒ½å¤Ÿä»éšå‘é‡è¿˜åŸåŸæ•°æ® (decoder)ã€‚ä¼ ç»Ÿçš„Autoencoderæ˜¯è¿™ä¸ªæ€æƒ³çš„æœ€ç®€å•å®ç°ï¼Œè€ŒVAEåˆ™å°†AEå’Œ<em>Variational Inference</em>ç»“åˆäº†èµ·æ¥ï¼Œæ˜¯ä¸€ç§ç»å…¸çš„ç”Ÿæˆå¼æ¨¡å‹ã€‚ç°åœ¨å¾ˆå¤šç ”ç©¶å…³æ³¨<em>Disentangled Representation Learning</em>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿæ— ç›‘ç£åœ°å­¦ä¹ æ•°æ®ï¼Œä»ä¸­å­¦åˆ°æœ‰æ„ä¹‰çš„è¡¨ç¤ºã€‚</p><h3 id="boldsymbol-beta-VAE"><a href="#boldsymbol-beta-VAE" class="headerlink" title="$\boldsymbol \beta$-VAE"></a>$\boldsymbol \beta$-VAE</h3><p>$\beta$-VAEæ˜¯ä¸€ç§ç‰¹æ®Šçš„VAEï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç»å…¸çš„<em>Disentangled Representation Learning</em>æ¨¡å‹ï¼Œå®ƒå’ŒVAEä¸»è¦çš„åŒºåˆ«æ˜¯å¯¹KLæ•£åº¦ä¸€é¡¹åŠ ä¸Šäº†æƒé‡$\beta$è¿›è¡Œè°ƒèŠ‚ï¼š<br>$$<br>C_\beta(x)=-\left[\mathbb{E}_{z\sim p_\phi(z|x)}\log p_\theta(x|z)\right] + \beta D_\text{KL}\left[p_\phi(z|x)\parallel h(z)\right]<br>$$<br>å¦‚æœå‡è®¾$p_\phi(z|x)=\mathcal{N}(\mu,\sigma)$ï¼Œé‚£ä¹ˆæŸå¤±å‡½æ•°å¯ä»¥è¿›è¡Œç®€åŒ–ï¼š<br>$$<br>C_\beta(x)=\parallel \hat{x} - x \parallel^2_2-\frac{\beta}{2}\left(\sum\limits_i\log(\sigma_i^2)-\mu_i^2-\sigma_i^2\right)+C<br>$$</p><h1 id="Network-Structure"><a href="#Network-Structure" class="headerlink" title="Network Structure"></a>Network Structure</h1><h2 id="Network-Structure-SciNet"><a href="#Network-Structure-SciNet" class="headerlink" title="Network Structure: SciNet"></a>Network Structure: <em>SciNet</em></h2><p>æ¨¡ä»¿ç‰©ç†å­¦å®¶å»ºæ¨¡ç‰©ç†é—®é¢˜çš„è¿‡ç¨‹ï¼Œä½œè€…æå‡ºäº†<em>SciNet</em>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/uWd1lOUFxXgQJ7f.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ç‰©ç†å­¦å®¶åœ¨å»ºæ¨¡ç‰©ç†é—®é¢˜çš„æ—¶å€™ï¼Œå¾€å¾€æ˜¯ä»ä¸€äº›å®éªŒæ•°æ®å‡ºå‘ï¼Œæ ¹æ®ç‰©ç†å¸¸è¯†æå–æ›´åŠ ç²¾ç»ƒçš„è¡¨ç¤ºï¼Œç„¶åç”¨å­¦åˆ°çš„è¡¨ç¤ºæ¥å›ç­”ç‰©ç†é—®é¢˜ã€‚</p><p>å¯¹äºå•çº¯çš„è¾“å…¥è¾“å‡ºé—®é¢˜ï¼Œ<em>SciNet</em>å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ˜ å°„ï¼Œ$F:\mathcal{O}\times\mathcal{Q}\rightarrow\mathcal{A}$ã€‚$\mathcal{O}$æ˜¯å¯èƒ½çš„å®éªŒæ•°æ®é›†åˆï¼Œ$\mathcal{Q}$æ˜¯å¯èƒ½çš„é—®é¢˜é›†åˆï¼Œ$\mathcal{A}$æ˜¯å¯èƒ½çš„ç­”æ¡ˆé›†åˆã€‚å¯ä»¥å°†å…¶åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼šç¼–ç è¿‡ç¨‹$E:\mathcal{O}\rightarrow\mathcal{R}$ä»å®éªŒæ•°æ®å­¦åˆ°è¡¨ç¤ºï¼Œè§£ç è¿‡ç¨‹$D:\mathcal{R}\times \mathcal{Q}\rightarrow \mathcal{A}$æ ¹æ®ç»™å®šçš„é—®é¢˜ä»è¡¨ç¤ºæ¥å›ç­”é—®é¢˜ã€‚ç”±æ­¤ï¼Œ$F(o,q)=D(E(o),q)$ã€‚åœ¨å®ç°æ–¹é¢ï¼Œ<em>SciNet</em>é‡‡ç”¨çš„æ˜¯å…¨è¿æ¥ç½‘ç»œã€‚</p><h2 id="Training-and-Testing-SciNet"><a href="#Training-and-Testing-SciNet" class="headerlink" title="Training and Testing SciNet"></a>Training and Testing <em>SciNet</em></h2><p>ç”¨æ¥è®­ç»ƒçš„æ•°æ®å½¢å¼ä¸º$(o,q,a_{cor}(o,q))$ï¼Œè§‚æµ‹$o$å’Œé—®é¢˜$q$åˆ†åˆ«ä»è§‚æµ‹é›†$\mathcal{O}$å’Œé—®é¢˜é›†$\mathcal{Q}$é€‰å‡ºï¼Œ$a_{cor}(o,q)$ä¸ºå¯¹åº”çš„æ­£ç¡®ç­”æ¡ˆã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å‡†ç¡®åº¦å°½é‡é«˜ï¼Œå¹¶ä¸”å­¦åˆ°<em>minimal uncorrelated representations</em>ã€‚ä¸ºæ­¤ï¼Œä½œè€…é‡‡ç”¨<em>disentangling variational autoencoder</em>ä½œä¸ºæ¨¡å‹ã€‚</p><h1 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h1><p>åœ¨æ–‡ä¸­ï¼Œä½œè€…è¿›è¡Œäº†4ä¸ªå®éªŒæ¥éªŒè¯æ¨¡å‹çš„æœ‰æ•ˆæ€§ã€‚</p><h2 id="Damped-Pendulum"><a href="#Damped-Pendulum" class="headerlink" title="Damped Pendulum"></a>Damped Pendulum</h2><p>é˜»å°¼æŒ¯åŠ¨å®éªŒï¼š</p><ul><li><p>ä»»åŠ¡ï¼šé¢„æµ‹ä¸€ç»´é˜»å°¼æŒ¯åŠ¨åœ¨ä¸åŒæ—¶é—´çš„ä½ç½®ã€‚</p></li><li><p>ç‰©ç†æ¨¡å‹ï¼š$-kx-b\dot{x}=m\ddot{x}$ï¼Œ$k$ä¸ºå¼¹æ€§æ¨¡é‡ï¼Œ$b$ä¸ºé˜»å°¼ç³»æ•°ï¼Œé€šè§£ä¸º$x(t)=A_0e^{-\frac{b}{2m}t}\cos(\omega t+\delta_0), \space \omega=\sqrt{\frac{k}{m}}\sqrt{1-\frac{b^2}{4mk}}$</p></li><li><p>è§‚æµ‹æ•°æ®ï¼šä½ç½®æ—¶é—´åºåˆ—æ•°æ®$o=[x(t_i)]_{i\in{1,\cdots,50}}\in\mathbb{R}^{50}$ï¼Œæ—¶é—´é—´éš”ç›¸ç­‰ï¼Œè´¨é‡$m=1\text{kg}$ï¼ŒæŒ¯å¹…$A_0=1\text{m}$ï¼Œç›¸ä½$\delta_0=0$ï¼Œå¼¹æ€§æ¨¡é‡$k\in[5,10]\text{kg}/\text{s}^2$ï¼Œé˜»å°¼ç³»æ•°$b\in[0.5,1]\text{kg}/\text{s}$ã€‚</p></li><li><p>é—®é¢˜ï¼šé¢„æµ‹$q=t_\text{pred}\in\mathbb{R}$</p></li></ul><p><img src="https://i.loli.net/2020/06/25/yWGzxo4eFKmABul.png" srcset="/img/loading.gif" alt=""></p><p>éšå˜é‡å¤§å°è®¾ç½®ä¸º3ï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/Q4PKa3pm2htekqd.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>(b)ä¸­çš„ä¸‰å¹…å›¾åˆ†åˆ«æ˜¯å­¦åˆ°çš„ä¸‰ä¸ªéšå˜é‡å’Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„å‚æ•°$k$å’Œ$b$çš„å…³ç³»å›¾ã€‚ç¬¬ä¸€å¹…å›¾ä¸­å˜é‡$1$ä¸$b$å‡ ä¹å®Œå…¨çº¿æ€§ç›¸å…³ï¼Œä¸$k$åŸºäºçº¿æ€§æ— å…³ï¼Œå˜é‡$2$åªå’Œ$k$ç›¸å…³ã€‚å˜é‡$3$å‡ ä¹ä¸ºä¸€ä¸ªå¸¸æ•°ï¼Œæ•…ä¸æä¾›é¢å¤–çš„ä¿¡æ¯ã€‚ç”±æ­¤ä½œè€…è®¤ä¸º<em>SciNet</em>å­¦åˆ°äº†æˆ‘ä»¬å…³å¿ƒçš„ä¸¤ä¸ªå‚æ•°çš„çŸ¥è¯†ã€‚</p><h2 id="Conservation-of-Angular-Momentum"><a href="#Conservation-of-Angular-Momentum" class="headerlink" title="Conservation of Angular Momentum"></a>Conservation of Angular Momentum</h2><p>è§’åŠ¨é‡å®ˆæ’å®éªŒï¼š</p><ul><li>ä»»åŠ¡ï¼šé¢„æµ‹ä¸€ä¸ªç”±é•¿åº¦ä¸º$r$çš„ç»³å­æ†ç»‘ç€çš„æ—‹è½¬è´¨ç‚¹åœ¨ä½ç½®$(0,r)$ç»ä¸€ä¸ªè‡ªç”±è´¨ç‚¹æ’å‡»åçš„ä½ç½®</li><li>ç‰©ç†æ¨¡å‹ï¼šç»™å®šæ’å‡»ä¹‹å‰çš„è§’åŠ¨é‡ï¼Œè‡ªç”±è´¨ç‚¹æ’å‡»ä¹‹åçš„é€Ÿåº¦ï¼Œæ—‹è½¬è´¨ç‚¹åœ¨æ’å‡»ä¹‹ååœ¨æ—¶é—´$t_\text{pred}^\prime$çš„ä½ç½®å¯ä»¥ç”±è§’åŠ¨é‡å®ˆæ’å®šå¾‹ç»™å‡ºï¼š</li></ul><p>$$<br>J=m_\text{rot}r^2\omega-rm_\text{free}(\mathbf{v}_\text{free})_x=m_\text{rot}r^2\omega^\prime-rm_\text{free}(\mathbf{v}^\prime_\text{free})_x=J^\prime<br>$$</p><ul><li>è§‚æµ‹æ•°æ®ï¼šåœ¨æ’å‡»ä¹‹å‰ä¸¤ä¸ªè´¨ç‚¹çš„ä½ç½®æ•°æ®$o=[(t_i^\text{rot},q_\text{rot}(t_i^\text{rot})),(t_i^\text{free},q_\text{free}(t_i^\text{free}))]_{i\in{1,\cdots,5}}$ï¼Œè´¨é‡ä¸ºå›ºå®šå€¼ï¼ŒåŠå¾„$r$ä¹Ÿä¸ºå›ºå®šå€¼ã€‚æ•°æ®æ·»åŠ é«˜æ–¯å™ªå£°ã€‚</li><li>é—®é¢˜ï¼šé¢„æµ‹æ’å‡»ä¹‹åè‡ªç”±è´¨ç‚¹åœ¨æ—¶é—´$t_\text{pred}^\prime$çš„ä½ç½®</li></ul><p><img src="https://i.loli.net/2020/06/25/SKfJLxl1QmuzFt9.png" srcset="/img/loading.gif" alt=""></p><p>å®éªŒå®¤æ„å›¾å¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/qimk9ZYBe7UPs3z.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>å®éªŒç»“æœè¡¨æ˜<em>SciNet</em>èƒ½å¤Ÿæ­£ç¡®é¢„æµ‹è´¨ç‚¹æ’å‡»ä¹‹åçš„ä½ç½®ï¼ŒåŒæ—¶å¯¹å™ªéŸ³é²æ£’ã€‚æ ¹æ®(b)ï¼Œéšå˜é‡å’Œè§’åŠ¨é‡å­˜åœ¨çº¿æ€§ç›¸å…³å…³ç³»ï¼Œä½œè€…è®¤ä¸º<em>SciNet</em>å­¦åˆ°äº†å®ˆæ’çš„åŠ¨é‡è¿™ä¸€æ¦‚å¿µã€‚</p><h2 id="Representation-of-Qubits"><a href="#Representation-of-Qubits" class="headerlink" title="Representation of Qubits"></a>Representation of Qubits</h2><p>é‡å­æ¯”ç‰¹å®éªŒï¼š</p><ul><li>ä»»åŠ¡ï¼šé¢„æµ‹åœ¨$n=1,2$çš„çº¯$n$é‡å­ä½çŠ¶æ€$\psi\in\mathbb{C}^{2^n}$ä¸‹ä»»ä½•äºŒè¿›åˆ¶æŠ•å½±æµ‹é‡$\omega\in\mathbb{C}^{2^n}$çš„æµ‹é‡æ¦‚ç‡ã€‚</li><li>ç‰©ç†æ¨¡å‹ï¼šåœ¨æ‰§è¡Œæµ‹é‡$\omega\in\mathbb{C}^{2^n}$çš„çŠ¶æ€$\psi\in\mathbb{C}^{2^n}$ä¸‹æµ‹é‡0çš„æ¦‚ç‡$p(\omega,\psi)$ç”±$p(\omega,\psi)=|\left&lt;\omega,\psi\right&gt;|^2$ç»™å®š</li><li>è§‚æµ‹æ•°æ®ï¼šçŠ¶æ€$\psi: o=[p(\alpha_i,\psi)]<em>{i\in{i,\cdots,n_1}}$çš„æ“ä½œå‚æ•°åŒ–ï¼šè¡¨ç¤ºä¸€ç»„å›ºå®šçš„éšæœºäºŒå…ƒå°„å½±æµ‹é‡å€¼$\mathcal{M}_1={\alpha_1,\cdots,\alpha</em>{n_1}}$ï¼ˆä¸€ä¸ªé‡å­ä½$n_1 = 10$ï¼Œä¸¤ä¸ªé‡å­ä½$n_1 = 30$ï¼‰</li><li>é—®é¢˜ï¼šå¯¹äºå›ºå®šçš„ä¸€ç»„éšæœºäºŒå…ƒå°„å½±æµ‹é‡$\mathcal{M}<em>2={\beta_1,\cdots,\beta</em>{n_2}}$ï¼Œæµ‹é‡$\omega:q=[p(\beta_i,\omega)]_{i\in{1,\cdots,n_2}}$çš„Operationalå‚æ•°åŒ–ï¼ˆä¸€ä¸ªé‡å­ä½$n_2 = 10$ï¼Œä¸¤ä¸ªé‡å­ä½$n_2 = 30$ï¼‰</li></ul><p><img src="https://i.loli.net/2020/06/25/8lY1LBsQCZUwX2I.png" srcset="/img/loading.gif" alt=""></p><p>å®éªŒç»“æœå¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/ZTRKfzb63Jrvk5C.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>é€šè¿‡å®éªŒå‘ç°ï¼Œ<em>SciNet</em>å¯ä»¥åœ¨ä¸æä¾›å…ˆéªŒç‰©ç†çŸ¥è¯†çš„æ¡ä»¶ä¸‹ç¡®å®šè¡¨è¿°çŠ¶æ€$\psi$æœ€å°çš„å‚æ•°æ•°é‡ã€‚åŒæ—¶ï¼Œ<em>SciNet</em>è¿˜èƒ½åˆ†è¾¨<em>tomographically complete</em>å’Œ<em>tomographically incomplete</em>ã€‚</p><h2 id="Heliocentric-Model-of-the-Solar-System"><a href="#Heliocentric-Model-of-the-Solar-System" class="headerlink" title="Heliocentric Model of the Solar System"></a>Heliocentric Model of the Solar System</h2><p>æ—¥å¿ƒè¯´æ¨¡å‹ï¼š</p><ul><li>é—®é¢˜ï¼šåœ¨ç»™å®šåˆå§‹æ¡ä»¶ä¸‹é¢„æµ‹ç›¸å¯¹ä¸åœ°çƒçš„å¤ªé˜³å’Œç«æ˜Ÿçš„è§’åº¦$\theta_M(t)$å’Œ$\theta_S(t)$</li><li>ç‰©ç†æ¨¡å‹ï¼šåœ°çƒå’Œç«æ˜Ÿå›´ç»•å¤ªé˜³ä»¥ä¸€å®šè§’é€Ÿåº¦åšè¿‘ä¼¼åœ†å‘¨è¿åŠ¨</li><li>è§‚æµ‹æ•°æ®ï¼šç»™å®šåˆå§‹è§’åº¦ï¼Œéšæœºé€‰æ‹©å‘¨å‘¨æœŸçš„å“¥ç™½å°¼çš„è§‚æµ‹æ•°æ®</li></ul><p><img src="https://i.loli.net/2020/06/25/vXl3Ae4RpzibrmY.png" srcset="/img/loading.gif" alt=""></p><p>æ¨¡å‹çš„å®ç°ç¨æœ‰å˜åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/XnsYqcRS6izZGEm.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>è¿™æ ·ï¼Œå¯¹äºä¸åŒæ—¶é—´éƒ½å¯¹åº”ä¸€ä¸ªéšå˜é‡$r(t_i)$ï¼Œè€Œä¸”éšå˜é‡æ˜¯æ—¶é—´ä¾èµ–çš„ï¼Œå¯¹äºä¸€ä¸ªéšå˜é‡$r(t_i)$æœ‰ä¸€ä¸ªè§£ç å™¨æ¥è¾“å‡ºç­”æ¡ˆã€‚</p><img src="https://i.loli.net/2020/06/25/az3UmkchyFWevP7.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>å®éªŒç»“æœè¡¨ç¤ºï¼Œ<em>SciNet</em>ä¸ä»…æ­£ç¡®é¢„æµ‹äº†å¤ªé˜³å’Œç«æ˜Ÿç›¸å¯¹åœ°çƒçš„è§’åº¦ï¼ŒåŒæ—¶éšå˜é‡æ­ç¤ºäº†ç«æ˜Ÿå’Œåœ°çƒç›¸å¯¹å¤ªé˜³çš„è§’åº¦ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Deep Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Transfer Anomaly Detection by Inferring Latent Domain Representations</title>
    <link href="/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/"/>
    <url>/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>ä½œè€…æå‡ºäº†ä¸€ç§åˆ©ç”¨è¿ç§»å­¦ä¹ æå‡target domainå¼‚å¸¸æ£€æµ‹æ€§èƒ½çš„ç®—æ³•ã€‚æ–‡ä¸­æŒ‡å‡ºç°æœ‰çš„åŸºäºè¿ç§»å­¦ä¹ çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•éœ€è¦å¯¹æ¯ä¸ª target domain è¿›è¡Œå•ç‹¬è®­ç»ƒï¼Œè¿™æ ·åšä¼šå¸¦æ¥å¾ˆå¤§çš„è®¡ç®—å¼€é”€ã€‚æœ¬æ–‡é€šè¿‡<em>latent domain vectors</em>æ¥å®ç°æ— éœ€é‡æ–°è®­ç»ƒçš„å¼‚å¸¸æ£€æµ‹ã€‚<em>latent domain vectors</em>æ˜¯domainçš„ä¸€ç§éšå«è¡¨ç¤ºï¼Œé€šè¿‡è¯¥domainä¸­çš„æ­£å¸¸æ ·æœ¬å¾—åˆ°ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œ<em>anomaly score function</em>é€šè¿‡Auto-encoderå¾—åˆ°ã€‚</p><h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1><h2 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h2><p>ä»¤$\mathbf{X}<em>d^+:={\mathbf{x}^+</em>{dn}}^{N^+<em>d}</em>{n=1}$ä¸ºç¬¬$d$ä¸ªdomainçš„å¼‚å¸¸æ ·æœ¬é›†ï¼Œ$\mathbf{x}_{dn}^+\in\mathbb{R}^M$ä¸ºå…¶ä¸­ç¬¬$n$ä¸ªæ ·æœ¬çš„$M$ç»´ç‰¹å¾å‘é‡ï¼Œ$N^+_d$ä¸ºç¬¬$d$ä¸ªdomainå¼‚å¸¸æ ·æœ¬çš„æ•°é‡ã€‚</p><p>ç±»ä¼¼çš„ï¼Œä»¤$\mathbf{X}<em>d^-:={\mathbf{x}^-</em>{dn}}^{N^-<em>d}</em>{n=1}$ä¸ºç¬¬$d$ä¸ªdomainçš„æ­£å¸¸æ ·æœ¬é›†ã€‚æˆ‘ä»¬å‡è®¾å¯¹äºæ¯ä¸ªdomainéƒ½æœ‰$N^+_d\ll N^-_d$ï¼Œä¸”ç‰¹å¾å‘é‡ç»´åº¦éƒ½ä¸º$M$ã€‚</p><p>å‡è®¾åœ¨ source domain $D_S$éƒ½æœ‰æ­£å¸¸æ ·æœ¬å’Œå¼‚å¸¸æ ·æœ¬ï¼Œè®°ä¸º${\mathbf{X}^+<em>d\cup\mathbf{X}_d^-}^{D_S}</em>{d=1}$ï¼Œåœ¨ target domain $D_T$åªæœ‰æ­£å¸¸æ ·æœ¬${\mathbf{X}<em>d^-}^{D_S+D_T}</em>{d=D_S+1}$ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¾—åˆ°ä¸€ä¸ªå¯¹äº target domain åˆé€‚çš„ domain-specific çš„å¼‚å¸¸æ‰“åˆ†å‡½æ•°ã€‚</p><img src="https://i.loli.net/2020/06/25/KW2YgScfVZN7Fjz.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Domain-specific-Anomaly-Score-Function"><a href="#Domain-specific-Anomaly-Score-Function" class="headerlink" title="Domain-specific Anomaly Score Function"></a>Domain-specific Anomaly Score Function</h2><p>æˆ‘ä»¬åŸºäºAuto-encoderå®šä¹‰å¼‚å¸¸æ‰“åˆ†å‡½æ•°ã€‚å¯¹äºæ¯ä¸ªdomainï¼Œæˆ‘ä»¬å‡è®¾å­˜åœ¨ä¸€ä¸ª$K$ç»´çš„éšå˜é‡$\mathbf{z}<em>d\in\mathbb{R}^K$ã€‚å¯¹äºç¬¬$d$ä¸ª domainï¼Œå¼‚å¸¸æ‰“åˆ†å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š<br>$$<br>s_\theta(\mathbf{x}</em>{dn}|\mathbf{z}<em>d):=\parallel\mathbf{x}</em>{dn}-G_{\theta_G}(F_{\theta_F}(\mathbf{x}_{dn},\mathbf{z}_d))\parallel^2<br>$$<br>å…¶ä¸­å‚æ•°$\theta:=(\theta_G,\theta_F)$åœ¨æ‰€æœ‰ domain ä¹‹é—´å…±äº«ã€‚</p><h2 id="Models-for-Latent-Domain-Vectors"><a href="#Models-for-Latent-Domain-Vectors" class="headerlink" title="Models for Latent Domain Vectors"></a>Models for Latent Domain Vectors</h2><p>éšå˜é‡$\mathbf{z}_d$æ˜¯æ— æ³•è§‚æµ‹åˆ°çš„ï¼Œåªèƒ½é€šè¿‡æ•°æ®æ¥ä¼°è®¡ã€‚é¦–å…ˆ$\mathbf{z}_d$åœ¨$\mathbf{X}_d^-$æ¡ä»¶ä¸‹çš„æ¡ä»¶åˆ†å¸ƒå‡è®¾ä¸ºé«˜æ–¯åˆ†å¸ƒï¼š</p><p>$$<br>q_\theta(\mathbf{z}<em>d|\mathbf{X}_d^-):=\mathcal{N}(\mathbf{z}_d|\mu_\phi(\mathbf{X}_d^-),\text{diag}(\sigma_\phi^2(\mathbf{X}_d^-)))<br>$$<br>å…¶ä¸­å‡å€¼$\mu_\phi(\mathbf{X}_d^-)\in\mathbb{R}^K$å’Œæ–¹å·®$\sigma^2_\phi(\mathbf{X}_d^-)\in\mathbb{R}^K</em>+$ç”±ç¥ç»ç½‘ç»œå»ºæ¨¡ï¼Œä¸”åœ¨æ‰€æœ‰ domain ä¹‹é—´å…±äº«ã€‚åœ¨$\mathbf{X}_d^-$ç»™å®šçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¾¿èƒ½å¤Ÿæ¨æ–­å‡ºè¯¥ domain å¯¹åº”çš„éšå˜é‡ï¼Œ</p><p>$q_\phi$çš„è¾“å…¥ä¸ºæ­£å¸¸æ ·æœ¬çš„é›†åˆï¼Œæ•…ç¥ç»ç½‘ç»œéœ€è¦æ»¡è¶³<em>permutation invariant</em>ã€‚$\tau(\mathbf{X}<em>d^-)=\rho(\sum</em>{n=1}^{N_d^-}\eta(\mathbf{x}_{dn}^-))$ï¼Œå…¶ä¸­$\tau(\mathbf{X}_d^-)$è¡¨ç¤º$\mu_\phi(\mathbf{X_d^-})$æˆ–$\ln\sigma_\phi^2(\mathbf{X}_d^-)$ï¼Œ$\rho$å’Œ$\eta$ä¸ºç¥ç»ç½‘ç»œï¼Œ</p><h2 id="Objective-Function"><a href="#Objective-Function" class="headerlink" title="Objective Function"></a>Objective Function</h2><p>ç›®æ ‡å‡½æ•°ç”±anomaly scoreå‡½æ•°å’Œéšå˜é‡ç»„æˆã€‚ç¬¬$d$ä¸ªdomainåœ¨å¯¹åº”çš„éšå˜é‡$\mathbf{z}_d$æ¡ä»¶ä¸‹çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p><p>$$<br>L_d(\theta|\mathbf{z}<em>d):=\frac{1}{N_d^-}\sum\limits</em>{n=1}^{N_d^-}s_\theta(\mathbf{x}<em>{dn}^-|\mathbf{z}_d)-\frac{\lambda}{N_d^-N_d^+}\sum\limits</em>{n,m=1}^{N_d^-,N_d^+}f(s_\theta(\mathbf{x}<em>{dm}^+|\mathbf{z}_d)-s_\theta(\mathbf{x}</em>{dn}^-|\mathbf{z}_d))<br>$$</p><p>å…¶ä¸­$\lambda\geq 0$ä¸ºè¶…å‚æ•°ï¼Œ$f$ä¸ºsigmoidå‡½æ•°ã€‚å…¬å¼çš„ç¬¬ä¸€é¡¹è¡¨ç¤ºç¬¬$d$ä¸ªdomainæ­£å¸¸æ ·æœ¬å¯¹åº”çš„<em>anomaly score</em>ã€‚ç¬¬äºŒé¡¹ä¸ºå¯å¾®åˆ†çš„AUCã€‚å¼‚å¸¸æ ·æœ¬çš„<em>anomaly score</em>åº”å½“å¤§äºæ­£å¸¸æ ·æœ¬ï¼Œæ‰€ä»¥å¯¹ä»»ä½•$\mathbf x_{dm}^+\in\mathbf X_d^+, \mathbf x_{dn}^-\in\mathbf X_d^-$æœ‰$s_\theta(\mathbf x_{dm}^+|\mathbf z_d)&gt;s_\theta(\mathbf x_{dn}^-|\mathbf z_d)$ã€‚ç¬¬äºŒé¡¹$\frac{\lambda}{N_d^-N_d^+}\sum\limits_{n,m=1}^{N_d^-,N_d^+}f(s_\theta(\mathbf{x}<em>{dm}^+|\mathbf{z}_d)-s_\theta(\mathbf{x}</em>{dn}^-|\mathbf{z}<em>d))$çš„å–å€¼èŒƒå›´æ˜¯$[0,1]$ï¼Œå½“æ‰€æœ‰çš„$s_\theta(\mathbf{x}</em>{dm}^+|\mathbf{z}<em>d)\gg s_\theta(\mathbf{x}</em>{dm}^-|\mathbf{z}<em>d)$æ—¶è¯¥é¡¹ä¸º1ï¼Œå½“æ‰€æœ‰çš„$s_\theta(\mathbf{x}</em>{dm}^+|\mathbf{z}<em>d)\ll s_\theta(\mathbf{x}</em>{dm}^-|\mathbf{z}<em>d)$æ—¶è¯¥é¡¹ä¸º0ï¼Œæ‰€ä»¥æœ€å°åŒ–è¯¥é¡¹çš„ç›¸åæ•°ç›¸å½“äºé¼“åŠ±$s_\theta(\mathbf{x}</em>{dm}^+|\mathbf{z}<em>d)\gg s_\theta(\mathbf{x}</em>{dm}^-|\mathbf{z}_d)$ã€‚</p><p>å› ä¸ºéšå˜é‡$\mathbf z_d$åŒ…å«ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ç›®æ ‡å‡½æ•°é‡Œè€ƒè™‘è¿™ä¸€ç‚¹ï¼š<br>$$<br>\mathcal{L}<em>d(\theta,\phi):=\mathbb{E}</em>{q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)}\left[L_d(\theta|\mathbf{z}_d)\right]+\beta D_\text{KL}(q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)\parallel p(\mathbf{z_d}))<br>$$</p><p>ç¬¬ä¸€é¡¹æ˜¯$L_d(\theta|\mathbf z_d)$å…³äº$q_\phi(\mathbf z_d|\mathbf X_d^-)$çš„æœŸæœ›ï¼Œç¬¬äºŒé¡¹æ˜¯$q_\phi(\mathbf z_d|\mathbf X_d^-)$å’Œ$p(\mathbf z_d):=\mathcal{N}(\boldsymbol 0,\boldsymbol I)$çš„KLæ•£åº¦ã€‚ç¬¬ä¸€é¡¹å¯ä»¥ç”¨<em>monte carlo</em>ä¼°è®¡$\mathbb{E}<em>{q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)}\left[L_d(\theta|\mathbf{z}_d)\right]\approx\frac{1}{L}\sum</em>{\ell=1}^L L_d(\theta|\mathbf z_d^{(\ell)})$ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜éœ€è¦ç”¨åˆ°<em>reparametrization trick</em>ã€‚</p><p>å¯¹äºç¬¬$d$ä¸ªtarget domainï¼Œå› ä¸ºæ²¡æœ‰å¼‚å¸¸æ ·æœ¬ï¼ˆå‡è®¾ï¼‰ï¼Œæ‰€ä»¥$L_d(\theta|\mathbf{z}<em>d):=\frac{1}{N_d^-}\sum\limits</em>{n=1}^{N_d^-}s_\theta(\mathbf{x}<em>{dn}^-|\mathbf{z}_d)$ï¼Œæœ‰ï¼š<br>$$<br>\mathcal{L}_d(\theta,\phi):=\mathbb{E}</em>{q_\phi(\mathbf{z}<em>d|\mathbf{X}_d^-)}\left[\frac{1}{N_d^-}\sum\limits</em>{n=1}^{N_d^-}s_\theta(\mathbf{x}_{dn}^-|\mathbf{z}_d)\right]+\beta D_\text{KL}(q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)\parallel p(\mathbf{z}_d))<br>$$</p><p>æ‰€ä»¥æ€»çš„æŸå¤±å‡½æ•°ä¸ºå„domainå¯¹åº”çš„æŸå¤±å‡½æ•°ä¹‹å’Œ$\mathcal{L}(\theta,\phi):=\sum_{d=1}^{D_S+D_T}\alpha_d\mathcal{L}_d(\theta,\phi)$ã€‚</p><h2 id="Inference"><a href="#Inference" class="headerlink" title="Inference"></a>Inference</h2><p>è®­ç»ƒå¥½ä¹‹åï¼Œdomain-specificçš„<em>anomaly score</em>å¯ä»¥ç”±ä¸‹å¼è®¡ç®—å‡ºï¼š</p><p>$$<br>s(\mathbf{x}<em>{d^\prime}):=\int s</em>{\theta_<em>}(\mathbf{x_{d^\prime}}|\mathbf{z}<em>{d^\prime})q</em>{\phi_</em>}(\mathbf{z}<em>{d^\prime}|\mathbf{X}</em>{d^\prime}^-)\mathrm{d}\mathbf{z}<em>{d^\prime}\approx\frac{1}{L}\sum\limits</em>{\ell=1}^L s_{\theta_*}(\mathbf{x}<em>{d^\prime}|\mathbf{z}</em>{d^\prime}^{(\ell)})<br>$$</p><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h2><p>å®éªŒåŒ…å«äº”ä¸ªæ•°æ®é›†ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆæˆæ•°æ®é›†ã€‚å¦‚ä¸‹å›¾(a)æ‰€ç¤ºï¼Œå›´ç»•$(0,0)$æœ‰$8$ä¸ªåœˆï¼Œæ¯ä¸ªåœˆåŒ…å«äº†ä¸€ä¸ªå†…åœˆä½œä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œç¬¬$7$ä¸ªåœˆè¢«é€‰ä¸ºtarget domainï¼Œå…¶ä½™çš„ä¸ºsource domainã€‚ç¬¬äºŒä¸ªæ˜¯MNIST-rï¼Œæ˜¯åŠ å…¥æ—‹è½¬çš„MNISTï¼ŒåŒ…å«6ä¸ªdomainï¼Œå…¶ä¸­æ•°å­—â€œ4â€è¢«é€‰ä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œå…¶ä½™ä¸ºæ­£å¸¸ã€‚ç¬¬ä¸‰ä¸ªä¸ºAnuran Callsï¼ŒåŒ…å«5ä¸ªdomainã€‚ç¬¬å››ä¸ªæ˜¯Landmineï¼Œä¸»è¦ç”¨åœ¨å¤šä»»åŠ¡å­¦ä¹ ä¸­ã€‚ç¬¬äº”ä¸ªæ˜¯IoTï¼Œç½‘ç»œæµé‡æ•°æ®ï¼ŒåŒ…å«8ä¸ªdomainã€‚</p><img src="https://i.loli.net/2020/06/25/6WLAfMwJPuN5Ov9.png" srcset="/img/loading.gif" style="zoom:50%;" /><h2 id="Comparison-Methods"><a href="#Comparison-Methods" class="headerlink" title="Comparison Methods"></a>Comparison Methods</h2><p>å¯¹æ¯”çš„baselineåŒ…æ‹¬NNï¼ˆæ™®é€šå¤šå±‚ç¥ç»ç½‘ç»œï¼‰ï¼ŒNNAUCï¼ˆåŠ å…¥å¯å¾®åˆ†AUCä½œä¸ºæŸå¤±å‡½æ•°ï¼‰ï¼ŒAEï¼ˆæ™®é€šAutoencoerï¼‰ï¼ŒAEAUCï¼ˆåŠ å…¥å¯å¾®åˆ†AUCçš„AEï¼‰ï¼ŒOSVMï¼ˆå•ç±»æ”¯æŒå‘é‡æœºï¼‰ï¼ŒCCSAï¼ŒTOSVMå’ŒOTLã€‚</p><h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>4ä¸ªçœŸå®æ•°æ®é›†çš„ç»“æœå¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/nfkwTVexRNqyFMY.png" srcset="/img/loading.gif" style="zoom:50%;" /><img src="https://i.loli.net/2020/06/25/QaMskTZALyeiFI1.png" srcset="/img/loading.gif" style="zoom:50%;" /><img src="https://i.loli.net/2020/06/25/F7VTyeHMz8mK2uJ.png" srcset="/img/loading.gif" style="zoom:50%;" /><img src="https://i.loli.net/2020/06/25/B32UmgXcwGhZYk1.png" srcset="/img/loading.gif" style="zoom:50%;" /><p>è¡¨5ä¸ºè€ƒè™‘éšå˜é‡ä¸ç¡®å®šæ€§çš„ablation studyã€‚å°†åŸæ¥çš„å…¬å¼$\mathcal{L}<em>d(\theta,\phi):=\mathbb{E}</em>{q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)}\left[L_d(\theta|\mathbf{z}_d)\right]+\beta D_\text{KL}(q_\phi(\mathbf{z}_d|\mathbf{X}_d^-)\parallel p(\mathbf{z_d}))$ä¸­$q_\phi(\mathbf z_d|\mathbf X_d^-)$ç”¨è¿ªåˆ©å…‹é›·åˆ†å¸ƒ$q_\phi(\mathbf z_d|\mathbf X_d^-)=\delta(\mathbf z_d-\mu_\phi(\mathbf X_d^-))$ä»£æ›¿å¹¶ä¸”å»æ‰KLæ•£åº¦ã€‚</p><img src="https://i.loli.net/2020/06/25/yUHcTBzixsMlY7f.png" srcset="/img/loading.gif" style="zoom: 50%;" /><p>è¡¨6å±•ç¤ºäº†ä¸åŒå¼‚å¸¸æ¯”ä¾‹å¯¹æ•ˆæœçš„å½±å“ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Transfer Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Deep Anomaly Detection with Deviation Networks</title>
    <link href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/"/>
    <url>/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡å…³æ³¨<code>Deep Anomaly Detection</code>ï¼Œä¹Ÿå°±æ˜¯ç”¨æ·±åº¦å­¦ä¹ çš„æ–¹æ³•æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€‚æ–‡ä¸­æåˆ°ç°æœ‰çš„<code>Deep Anomaly Detection</code>å­˜åœ¨ä¸¤ä¸ªå¼Šç«¯ï¼šä¸€ä¸ªæ˜¯é‡‡ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•æ¥è¿›è¡Œç‰¹å¾å­¦ä¹ ï¼Œç„¶åé€šè¿‡ä¸‹æ¸¸ä»»åŠ¡å¾—åˆ°<code>Anomaly Score</code>ï¼Œç›¸æ¯”æ–‡ä¸­End-to-Endçš„<code>Anomaly Score</code>å­¦ä¹ ï¼Œå­˜åœ¨ä¼˜åŒ–ä¸å……åˆ†çš„é£é™©ï¼›å¦ä¸€ä¸ªæ˜¯ç°æœ‰çš„æ–¹æ³•ä¸»è¦æ˜¯æ— ç›‘ç£å­¦ä¹ ï¼Œæ— æ³•åˆ©ç”¨å·²çŸ¥çš„ä¿¡æ¯ï¼ˆå¦‚å°‘é‡æ ‡ç­¾ï¼‰ã€‚ä¸ºæ­¤ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œæ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p><p>æœ¬æ–‡çš„ä¸»è¦è´¡çŒ®å¦‚ä¸‹ï¼š</p><ul><li>æå‡ºäº†ä¸€ç§ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œç›´æ¥å­¦ä¹ <code>Anomaly Score</code>å¹¶ä¸”å¯ä»¥åˆ©ç”¨å·²çŸ¥ä¿¡æ¯ï¼›</li><li>åŸºäºæå‡ºçš„æ¡†æ¶ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ç§å®ä¾‹æ–¹æ³• (DevNet)ã€‚</li></ul><img src="https://i.loli.net/2020/06/25/XT7fqQRWEOuocgy.png" srcset="/img/loading.gif" style="zoom:67%;" /><h1 id="Proposed-Model"><a href="#Proposed-Model" class="headerlink" title="Proposed Model"></a>Proposed Model</h1><h2 id="End-To-End-Anomaly-Score-Learning"><a href="#End-To-End-Anomaly-Score-Learning" class="headerlink" title="End-To-End Anomaly Score Learning"></a>End-To-End Anomaly Score Learning</h2><h3 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h3><p>ä¸ºäº†åŒºåˆ«äºä¼ ç»Ÿçš„ä¸¤é˜¶æ®µå¼‚å¸¸æ£€æµ‹ï¼ˆå…ˆå­¦ä¹ ç‰¹å¾è¡¨ç¤ºï¼Œç„¶ååœ¨å­¦åˆ°çš„ç‰¹å¾ä¸Šå®šä¹‰ä¸€ä¸ª<code>anomaly measure</code>æ¥å¾—åˆ°<code>anomaly score</code>ï¼‰ï¼Œä½œè€…å¯¹ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜é‡æ–°è¿›è¡Œå½¢å¼åŒ–ã€‚</p><p>ç»™å®š$N+K$ä¸ªæ ·æœ¬$\mathcal{X}={\boldsymbol x_1,\boldsymbol x_2,\cdots,\boldsymbol x_N,\boldsymbol x_{N+1},\cdots,\boldsymbol x_{N+K}}$ï¼Œå…¶ä¸­$\boldsymbol x_i\in\mathbb{R}^D$ï¼Œæ— æ ‡ç­¾æ ·æœ¬é›†$\mathcal{U}={\boldsymbol x_1,\boldsymbol x_2,\cdots,\boldsymbol x_N}$ï¼Œæœ‰æ ‡ç­¾æ ·æœ¬é›†$\mathcal{K}={\boldsymbol x_{N+1},\cdots,\boldsymbol x_{N+K}}$ï¼Œä¸”$K\ll N$ã€‚å¼‚å¸¸æ£€æµ‹çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ª<code>anomaly scoring function</code>$\phi:\mathcal{X}\mapsto\mathbb{R}$ä½¿å¾—$\phi(\boldsymbol x_i)&gt;\phi(\boldsymbol x_j)$ï¼Œå…¶ä¸­$\boldsymbol x_i$ä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œ$\boldsymbol x_j$ä¸ºæ­£å¸¸æ ·æœ¬ã€‚</p><h3 id="The-Proposed-Framework"><a href="#The-Proposed-Framework" class="headerlink" title="The Proposed Framework"></a>The Proposed Framework</h3><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ç§é€šç”¨å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œæ¨¡å‹æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>æ¨¡å‹æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/ZuE1mb2Ytv6Jdl7.png" srcset="/img/loading.gif" style="zoom:50%;" /><p>ä¸»è¦åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ol><li><em>anomaly scoring network</em>. å›¾ä¸­å·¦è¾¹çš„éƒ¨åˆ†ï¼Œä¸€ä¸ªå‡½æ•°$\phi$ï¼Œè¾“å…¥æ ·æœ¬$\mathbf{x}$ï¼Œè¾“å‡º<code>anomaly score</code></li><li><em>reference score generator</em>. å›¾ä¸­å³è¾¹çš„éƒ¨åˆ†ã€‚åªæœ‰ä¸€ä¸ª<em>anomaly scoring network</em>å¹¶ä¸èƒ½è¿›è¡Œè®­ç»ƒï¼Œéœ€è¦è®­ç»ƒçš„ç›®æ ‡ã€‚ä¸ºæ­¤åŠ å…¥<em>reference score generator</em>ï¼Œè¾“å…¥ä¸ºéšæœºé€‰æ‹©çš„$l$ä¸ªæ­£å¸¸æ ·æœ¬ï¼Œè¾“å‡º<code>reference score</code>ï¼ˆè¿™$l$ä¸ªæ­£å¸¸æ ·æœ¬<code>anomaly score</code>çš„å‡å€¼ï¼Œè®°ä¸º$\mu_\mathcal{R}$ï¼‰</li><li><em>deviation loss</em>. $\phi(\mathbf{x})$ï¼Œ$\mu_\mathcal{R}$åŠå¯¹åº”çš„æ ‡å‡†å·®$\sigma_\mathcal{R}$ä½œä¸º<code>deviation loss</code>å‡½æ•°çš„è¾“å…¥ã€‚å› ä¸º$\mu_\mathcal{R}$å’Œ$\sigma_\mathcal{R}$å¯¹åº”æ­£å¸¸æ ·æœ¬é›†çš„å‡å€¼å’Œæ–¹å·®ï¼Œé‚£ä¹ˆå¼‚å¸¸æ ·æœ¬çš„<code>anomaly score</code>åº”è¯¥å’Œ$\mu_\mathcal{R}$å·®åˆ«æ¯”è¾ƒå¤§ï¼Œè€Œæ­£å¸¸æ ·æœ¬åˆ™åº”è¯¥æ¥è¿‘$\mu_\mathcal{R}$ã€‚</li></ol><h2 id="Deviation-Networks"><a href="#Deviation-Networks" class="headerlink" title="Deviation Networks"></a>Deviation Networks</h2><p>ä¸‹é¢æ˜¯ä¸Šè¿°ä¸‰ä¸ªéƒ¨ä»¶çš„å…·ä½“å®ç°ã€‚</p><h3 id="End-To-End-Anomaly-Scoring-Network"><a href="#End-To-End-Anomaly-Scoring-Network" class="headerlink" title="End-To-End Anomaly Scoring Network"></a>End-To-End Anomaly Scoring Network</h3><p>è®°$\mathcal{Q}\in\mathbb{R}^M$ä¸ºä¸­é—´è¡¨ç¤ºç©ºé—´ï¼Œ<code>anomaly scoring network</code>$\phi(\cdot;\Theta):\mathcal{X}\mapsto\mathbb{R}$å¯ä»¥å®šä¹‰ä¸ºæ•°æ®è¡¨ç¤ºå­¦ä¹ $\psi(\cdot;\Theta_t):\mathcal{X}\mapsto\mathcal{Q}$å’Œå¼‚å¸¸åˆ†æ•°å­¦ä¹ $\eta(\cdot;\Theta_s):\mathcal{Q}\mapsto\mathbb{R}$ä¸¤é˜¶æ®µçš„ç»„åˆï¼Œå…¶ä¸­$\Theta={\Theta_t,\Theta_s}$ã€‚</p><p>$\psi(\cdot;\Theta_t)$å¯ä»¥ç”¨ä¸€ä¸ª$H$å±‚ç¥ç»ç½‘ç»œæ¥å®ç°ï¼š<br>$$<br>\mathrm{q}=\psi(\mathbf{x};\Theta_t)<br>$$<br>å…¶ä¸­$\mathbf{x}\in\mathcal{X}$ï¼Œ$\mathrm{q}\in\mathcal{Q}$ã€‚</p><p>$\eta(\cdot;\Theta_s)$å¯ä»¥ç”¨ä¸€ä¸ªå•å±‚çš„ç¥ç»ç½‘ç»œæ¥å®ç°ï¼š<br>$$<br>\eta(\mathrm q;\Theta_s)=\sum\limits_{i=1}^M w_i^oq_i+w_{M+1}^o<br>$$<br>å…¶ä¸­$\mathrm q\in\mathcal Q$ï¼Œ$\Theta_s={\mathbf{w}^o}$ã€‚</p><p>æ‰€ä»¥æœ‰ï¼š<br>$$<br>\phi(\mathbf{x};\Theta)=\eta(\psi(\mathbf{x};\Theta_t);\Theta_s)<br>$$</p><h3 id="Gaussian-Prior-based-Reference-Scores"><a href="#Gaussian-Prior-based-Reference-Scores" class="headerlink" title="Gaussian Prior-based Reference Scores"></a>Gaussian Prior-based Reference Scores</h3><p>æœ‰ä¸¤ç§æ–¹æ³•æ¥è·å¾—$\mu_\mathcal{R}$ï¼Œä¸€ç§æ˜¯data-drivenï¼Œä¸€ç§æ˜¯prior-drivenã€‚å¦‚æœæ˜¯data-drivençš„è¯åˆ™é‡‡ç”¨å¦ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œæ–‡ä¸­è¡¨ç¤ºä¸ºäº†æ›´å¥½çš„è§£é‡Šæ€§å’Œè®¡ç®—æ•ˆç‡ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ˜¯prior-drivenã€‚<br>$$<br>\begin{align}<br>r_1,r_2,\cdots,r_l\sim \mathcal{N}(\mu,\sigma^2),\<br>\mu_\mathcal{R}=\frac{1}{l}\sum\limits_{i=1}^l r_i<br>\end{align}<br>$$<br>åœ¨æ–‡ä¸­ï¼Œé‡‡ç”¨çš„prioræ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒã€‚</p><h2 id="Z-Score-Based-Deviation-Loss"><a href="#Z-Score-Based-Deviation-Loss" class="headerlink" title="Z-Score Based Deviation Loss"></a>Z-Score Based Deviation Loss</h2><p><em>anomaly scoring network</em>çš„ä¼˜åŒ–ç›®æ ‡å¯ä»¥å®šä¹‰ä¸ºZ-Scoreçš„æ–¹å¼ï¼š<br>$$<br>dev(\boldsymbol x)=\frac{\phi(\boldsymbol x;\Theta)-\mu_{\mathcal{R}}}{\sigma_{\mathcal{R}}}<br>$$<br>$dev(\boldsymbol x)$å¯ä»¥çœ‹ä½œæ˜¯æ ·æœ¬åç¦»æ ‡å‡†çš„ç¨‹åº¦ï¼Œè€Œæˆ‘ä»¬è‚¯å®šå¸Œæœ›å¼‚å¸¸æ ·æœ¬åç¦»æ ‡å‡†è¶Šå¤§ï¼Œæ­£å¸¸æ ·æœ¬è¶Šæ¥è¿‘æ ‡å‡†ã€‚æ–‡ä¸­é‡‡ç”¨çš„æŸå¤±å‡½æ•°æ˜¯<code>Contrastive Loss</code>ï¼š<br>$$<br>L(\phi(\boldsymbol x;\Theta),\mu_\mathcal{R},\sigma_\mathcal{R})=(1-y)|dev(\boldsymbol x)| + y \max(0, a - dev(\boldsymbol x))<br>$$<br><code>Contrastive Loss</code>çš„ç›´è§‚è§£é‡Šå¯ä»¥çœ‹ä¸‹å›¾ï¼š</p><img src="https://i.loli.net/2020/06/25/aPbSipCsk2JwNcD.png" srcset="/img/loading.gif" style="zoom: 33%;" /><p>å¯¹äºè´Ÿä¾‹ï¼ˆæ­£å¸¸ï¼‰ï¼Œä¼˜åŒ–è¿‡ç¨‹å°†ä»–ä»¬å°½é‡å‘åŸç‚¹é è¿‘ï¼Œå¯¹äºæ­£ä¾‹ï¼ˆå¼‚å¸¸ï¼‰ï¼Œä¼˜åŒ–è¿‡ç¨‹å°†ä»–ä»¬æ‹‰å‘è¾¹ç•Œã€‚</p><h2 id="The-DevNet-Algorithm"><a href="#The-DevNet-Algorithm" class="headerlink" title="The DevNet Algorithm"></a>The DevNet Algorithm</h2><p><code>DevNet</code>çš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/km9H5DoNRbOQ784.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Interpretability-of-Anomaly-Scores"><a href="#Interpretability-of-Anomaly-Scores" class="headerlink" title="Interpretability of Anomaly Scores"></a>Interpretability of Anomaly Scores</h2><p>å› ä¸º<em>reference score generator</em>é€‰æ‹©çš„æ˜¯ç¡®å®šçš„é«˜æ–¯åˆ†å¸ƒï¼Œäºæ˜¯å¯ä»¥ç”¨æ¦‚ç‡è®ºç»™å‡ºä¸€äº›è§£é‡Šæ€§ã€‚ä½œè€…ç»™å‡ºäº†ä¸€ä¸ªç»“è®ºï¼Œ</p><blockquote><p><strong>PROPOSITION</strong>ï¼š è®¾$\boldsymbol x\in\mathcal{X}$ï¼Œ$z_p$ä¸º$\mathcal{N}(\mu,\sigma^2)$çš„åˆ†ä½æ•°ï¼Œé‚£ä¹ˆ$\phi(\boldsymbol x)$åœ¨åŒºé—´$\mu\pm z_p\sigma$çš„æ¦‚ç‡ä¸º$2(1-p)$ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼Œå‡è®¾$p=0.95$ï¼Œé‚£ä¹ˆ$z_{0.95}=1.96$ï¼Œè¡¨ç¤ºå¼‚å¸¸åˆ†æ•°é«˜äº1.96çš„æ ·æœ¬å°†ä»¥0.95çš„ç½®ä¿¡åº¦ä¸ºå¼‚å¸¸ã€‚</p><h1 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h1><p>å®éªŒç”¨åˆ°äº†9ä¸ªæ•°æ®é›†ï¼Œ4ä¸ªBaseline (REPENï¼ŒDSVDDï¼ŒFSNETï¼ŒiForest)ï¼Œä»¥åŠROCå’ŒPRæ›²çº¿ä¸¤ç§è¯„æµ‹æ ‡å‡†ã€‚</p><h2 id="Effectiveness-in-Real-world-Data-Sets"><a href="#Effectiveness-in-Real-world-Data-Sets" class="headerlink" title="Effectiveness in Real-world Data Sets"></a>Effectiveness in Real-world Data Sets</h2><h3 id="Experiment-Settings"><a href="#Experiment-Settings" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h3><p>è¿™ä¸€ä¸ªå®éªŒä¸»è¦æ˜¯ä¸ºäº†éªŒè¯ç®—æ³•åœ¨çœŸå®åœºæ™¯ä¸‹çš„æ•ˆæœï¼Œå³å¤§é‡æ— æ ‡ç­¾æ•°æ®å’Œæå°‘é‡æ ‡ç­¾æ•°æ®ã€‚è®­ç»ƒé›†åŒ…å«ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯æ— æ ‡ç­¾æ•°æ®$\mathcal{U}$,åŒ…å«$2%$çš„å¼‚å¸¸æ ·æœ¬ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æœ‰æ ‡ç­¾æ•°æ®$\mathcal{K}$ï¼Œç”±éšæœºé‡‡æ ·$0.005%-1%$çš„è®­ç»ƒæ•°æ®å’Œ$0.08%-6%$çš„å¼‚å¸¸æ ·æœ¬ç»„æˆã€‚</p><h3 id="Findings"><a href="#Findings" class="headerlink" title="Findings"></a>Findings</h3><p>å®éªŒç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/DKqxJROngML8IS2.png" srcset="/img/loading.gif" style="zoom: 50%;" /><p>ä»ç»“æœä¸Šçœ‹æ¥ï¼Œæœ¬æ–‡æå‡ºçš„æ–¹æ³•åœ¨æ‰€æœ‰æ•°æ®é›†ä¸Šéƒ½æ¯”Baselineå¥½ï¼Œè¯´æ˜<code>DevNet</code>ç«¯åˆ°ç«¯ç›´æ¥ä¼˜åŒ–<code>Anomaly Score</code>çš„æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚</p><h2 id="Data-Efficiency"><a href="#Data-Efficiency" class="headerlink" title="Data Efficiency"></a>Data Efficiency</h2><h3 id="Experiment-Settings-1"><a href="#Experiment-Settings-1" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h3><p>è¿™ä¸€ä¸ªå®éªŒä¸»è¦æ˜¯ä¸ºäº†æ¢ç©¶åŸºäºæ·±åº¦çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„<em>data efficiency</em>ã€‚å’Œä¸Šä¸€ä¸ªå®éªŒä¸€æ ·ï¼Œæ— æ ‡ç­¾æ•°æ®é›†åŒ…å«$2%$çš„å¼‚å¸¸ï¼Œè€Œæœ‰æ ‡ç­¾çš„å¼‚å¸¸æ•°é‡ä»$5$åˆ°$120$ä¸ç­‰ã€‚æœ¬å®éªŒè¯•å›¾å›ç­”ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li><code>DevNet</code>çš„<em>data efficiency</em>å¦‚ä½•ï¼Ÿ</li><li>åŸºäºæ·±åº¦çš„æ–¹æ³•åœ¨å¤šå¤§ç¨‹åº¦ä¸Šèƒ½å¤Ÿåˆ©ç”¨æ ‡ç­¾ä¿¡æ¯ï¼Ÿ</li></ul><h3 id="Findings-1"><a href="#Findings-1" class="headerlink" title="Findings"></a>Findings</h3><p>åœ¨å‡ ä¸ªåŸºäºæ·±åº¦çš„Baselineä¸­ï¼Œ<code>DevNet</code>çš„æ•ˆæœæ˜¯æœ€å¥½çš„ï¼ŒåŒæ—¶åœ¨æœ‰æ ‡ç­¾å¼‚å¸¸éå¸¸æœ‰é™çš„æƒ…å†µä¸‹ï¼Œ<code>DevNet</code>ä¹Ÿèƒ½å¾ˆå¥½çš„åˆ©ç”¨æ ‡ç­¾ä¿¡æ¯ï¼Œè¾¾åˆ°æ›´å¥½çš„æ•ˆæœã€‚</p><img src="https://i.loli.net/2020/06/25/iIWGBPosKCuxbRF.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Robustness-w-r-t-Anomaly-Contamination"><a href="#Robustness-w-r-t-Anomaly-Contamination" class="headerlink" title="Robustness w.r.t. Anomaly Contamination"></a>Robustness w.r.t. Anomaly Contamination</h2><h3 id="Experiment-Settings-2"><a href="#Experiment-Settings-2" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h3><p>åœ¨ç¬¬ä¸€ä¸ªå®éªŒä¸­ï¼Œæ— æ ‡ç­¾æ•°æ®é›†$\mathcal{U}$åŒ…å«çš„æ˜¯å›ºå®šçš„å¼‚å¸¸æ¯”ä¾‹$2%$ï¼Œè€Œåœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½œè€…æµ‹è¯•äº†ä»$0%$åˆ°$20%$ä¹‹é—´ä¸åŒå¼‚å¸¸æ¯”ä¾‹æ¥æµ‹è¯•ç®—æ³•çš„é²æ£’æ€§ï¼ˆå³ä½¿$\mathcal{U}$ä¸­åŒ…å«å¼‚å¸¸ï¼Œç”±äºæ²¡æœ‰æ ‡ç­¾ï¼Œåœ¨è®­ç»ƒçš„æ—¶å€™ä»ç„¶å‡è®¾éƒ½ä¸ºæ­£å¸¸æ¥è¿›è¡Œè®­ç»ƒï¼‰ã€‚æœ¬å®éªŒè¯•å›¾å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li>åŸºäºæ·±åº¦çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„é²æ£’æ€§å¦‚ä½•ï¼Ÿ</li><li>å½“è®­ç»ƒé›†ä¸­å¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹è¾ƒé«˜çš„æ—¶å€™åŸºäºæ·±åº¦çš„æ–¹æ³•èƒ½å¦æ‰“è´¥æ— ç›‘ç£çš„æ–¹æ³•ï¼Ÿ</li></ul><h3 id="Findings-2"><a href="#Findings-2" class="headerlink" title="Findings"></a>Findings</h3><p>ä¸‹å›¾ä¸ºå®éªŒç»“æœï¼š</p><img src="https://i.loli.net/2020/06/25/JCnIjLOc84RFP2V.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä»ç»“æœä¸Šæ¥çœ‹ï¼Œ<code>DevNet</code>æ¯”å…¶ä»–åŸºäºæ·±åº¦çš„æ–¹æ³•é²æ£’æ€§æ›´å¥½ï¼ŒåŒæ—¶åœ¨é«˜å¼‚å¸¸æ±¡æŸ“çš„æƒ…å†µä¸‹ä»ç„¶æ¯”çº¯æ— ç›‘ç£æ–¹æ³•æ•ˆæœè¦å¥½ã€‚</p><h2 id="Ablation-Study"><a href="#Ablation-Study" class="headerlink" title="Ablation Study"></a>Ablation Study</h2><p>æœ¬å®éªŒè®¾ç½®äº†<code>DevNet</code>çš„ä¸‰ä¸ªå˜ä½“ï¼ˆé»˜è®¤çš„<code>DevNet-Def</code>ä¸ºå•å±‚éšå±‚åŠ ä¸Šä¸€ä¸ªè¾“å‡ºå±‚ï¼‰æ¥è¿›è¡Œæ¶ˆèå®éªŒï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li><code>DevNet-Rep</code>ï¼Œå»æ‰äº†<em>anomaly scoring network</em>ç½‘ç»œçš„è¾“å‡ºå±‚ï¼Œå¯¹åº”<em>end-to-end learning of anomaly scores</em>å’Œ<em>deviation loss</em>ï¼›</li><li><code>DevNet-Linear</code>ï¼Œå»æ‰äº†ç½‘ç»œä¸­çš„éçº¿æ€§å±‚ï¼Œå¯¹åº”<em>learning of non-linear features</em>ï¼›</li><li><code>DevNet-3HL</code>ï¼Œéšå±‚æ•°é‡ä¸º3å±‚ã€‚</li></ul><p>å¯¹æ¯”ç»“æœå¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/5LcyAwGMB8gb2UP.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>é€šè¿‡å®éªŒå¯ä»¥å‘ç°ï¼Œ<code>DevNet-Rep</code>è¯´æ˜äº†<em>end-to-end learning of anomaly scores</em>å’Œ<em>deviation loss</em>çš„æœ‰æ•ˆæ€§ï¼Œè€Œ<code>DevNet-Linear</code>è¯´æ˜äº†<em>learning of non-linear features</em>çš„é‡è¦æ€§ã€‚<code>DevNet-3HL</code>è¯´æ˜äº†åŠ æ·±ç½‘ç»œå¹¶ä¸æ€»èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ã€‚</p><h2 id="Scalability-Test"><a href="#Scalability-Test" class="headerlink" title="Scalability Test"></a>Scalability Test</h2><p>è¿™ä¸€ä¸ªå®éªŒä½¿ç”¨åˆæˆçš„æ•°æ®æ¥æµ‹è¯•ç®—æ³•å¯¹å¤§è§„æ¨¡æ•°æ®çš„å¤„ç†èƒ½åŠ›ï¼Œåˆ†åˆ«ä»<em>Data Size</em>å’Œ<em>Data Dimensionality</em>ä¸¤æ–¹é¢æ¥æµ‹è¯•ã€‚ç»“æœå¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/5gbPdJkB47e3FsV.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>å¯ä»¥çœ‹å‡ºï¼Œ<code>DevNet</code>å¯¹<em>Data Size</em>å¹¶ä¸æ•æ„Ÿï¼ŒåŒæ—¶ï¼Œé¢å¯¹é«˜ç»´æ•°æ®ï¼Œ<code>DevNet</code>ä¹Ÿæ²¡æœ‰è¡¨ç°å‡ºåŠ£åŠ¿ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Deep Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Geant4 å®‰è£…æ•™ç¨‹ä¸è°ƒè¯•ç¯å¢ƒé…ç½®</title>
    <link href="/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"/>
    <url>/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Geant4å®‰è£…çš„æ•™ç¨‹å¾ˆå¤šï¼Œç‰ˆæœ¬éƒ½å¾ˆæ—§äº†ï¼Œè¿™é‡Œå†™ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼ˆ10.6ï¼‰åŸºäºUbuntuçš„å®‰è£…æ•™ç¨‹ï¼Œå¹¶ä¸”å¼€å¯CLion IDEè°ƒè¯•ã€‚</p><h1 id="Step-1-Download-Packages"><a href="#Step-1-Download-Packages" class="headerlink" title="Step 1: Download Packages"></a>Step 1: Download Packages</h1><p>é¦–å…ˆè¿›å…¥å®˜ç½‘(<a href="http://geant4.web.cern.ch/support/download" target="_blank" rel="noopener">http://geant4.web.cern.ch/support/download</a>)ä¸‹è½½æºä»£ç ï¼ˆæ¨ètar.gzæ ¼å¼ï¼‰åŠæ•°æ®æ–‡ä»¶ï¼Œè§£å‹ã€‚æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸“é—¨ç”¨æ¥æ”¾<code>Geant4</code>ç›¸å…³æ–‡ä»¶ï¼Œæ–°å»ºdataï¼Œsourceï¼Œbuildæ–‡ä»¶å¤¹ï¼Œå°†Geant4çš„æ–‡ä»¶å¤åˆ¶è¿›æ¥å¹¶æŒ‰å¦‚ä¸‹ç»“æ„ç»„ç»‡ï¼š</p><pre><code class="hljs bash">.â”œâ”€â”€ buildâ”œâ”€â”€ dataâ”‚Â Â  â”œâ”€â”€ G4ABLA3.1â”‚Â Â  â”œâ”€â”€ G4EMLOW7.9â”‚Â Â  â”œâ”€â”€ G4ENSDFSTATE2.2â”‚Â Â  â”œâ”€â”€ G4INCL1.0â”‚Â Â  â”œâ”€â”€ G4NDL4.6â”‚Â Â  â”œâ”€â”€ G4PARTICLEXS2.1â”‚Â Â  â”œâ”€â”€ G4PII1.3â”‚Â Â  â”œâ”€â”€ G4SAIDDATA2.0â”‚Â Â  â”œâ”€â”€ G4TENDL1.3.2â”‚Â Â  â”œâ”€â”€ PhotonEvaporation5.5â”‚Â Â  â”œâ”€â”€ RadioactiveDecay5.4â”‚Â Â  â””â”€â”€ RealSurface2.1.1â””â”€â”€ <span class="hljs-built_in">source</span>    â””â”€â”€ geant4.10.06</code></pre><p><img src="https://i.loli.net/2020/06/25/OuZaAJ3WyEYwsG7.png" srcset="/img/loading.gif" alt=""></p><p><img src="https://i.loli.net/2020/06/25/R5Tmk68AhPbaDHY.png" srcset="/img/loading.gif" alt=""></p><h1 id="Step-2-Install-Dependencies"><a href="#Step-2-Install-Dependencies" class="headerlink" title="Step 2: Install Dependencies"></a>Step 2: Install Dependencies</h1><p>å®‰è£…ç¼–è¯‘æ‰€éœ€ç¯å¢ƒï¼š</p><pre><code class="hljs bash">sudo apt-get install build-essential cmake</code></pre><p>å®‰è£…ç›¸å…³ä¾èµ–ï¼š</p><pre><code class="hljs bash">sudo apt-get install libgl1-mesa-dev libglu1-mesa-dev libxt-dev libxmu-dev libxi-dev zlib1g-dev libgl2ps-dev libexpat1-dev libxerces-c-dev</code></pre><p>å¦‚æœè¦ç”¨åˆ°QTéœ€è¦å•ç‹¬å®‰è£…QTã€‚</p><h1 id="Step-3-Compile"><a href="#Step-3-Compile" class="headerlink" title="Step 3: Compile"></a>Step 3: Compile</h1><p>è¿›å…¥buildæ–‡ä»¶å¤¹ï¼Œç”¨cmakeå‘½ä»¤ï¼š</p><pre><code class="hljs bash">cmake ../<span class="hljs-built_in">source</span>/geant4.10.06/ -DCMAKE_BUILD_TYPE=DEBUG -DGEANT4_USE_GDML=ON -DGEANT4_USE_OPENGL_X11=ON -DGEANT4_USE_RAYTRACER_X11=ON -DGEANT4_BUILD_MULTITHREADED=ON</code></pre><p>å…¶ä¸­<code>../source/geant4.10.06/</code>æ›¿æ¢æˆæ¢æˆï¼ˆå¦‚æœç‰ˆæœ¬ä¸ä¸€æ ·ï¼‰ä½ è‡ªå·±çš„Geant4æºä»£ç æ‰€åœ¨ç›®å½•ï¼Œéœ€è¦QTåˆ™åŠ ä¸Š<code>-DGEANT4_USE_QT=ON</code>ã€‚å¦‚æœä¸éœ€è¦è°ƒè¯•åˆ™æŠŠ<code>-DCMAKE_BUILD_TYPE=DEBUG</code>æ”¹æˆ<code>-DCMAKE_BUILD_TYPE=RELEASE</code>ã€‚<code>-DGEANT4_BUILD_MULTITHREADED=ON</code>æ˜¯å¤šçº¿ç¨‹ï¼Œè§†æƒ…å†µå¼€å¯ã€‚</p><p>å®Œæˆä¹‹åå¼€å§‹ç¼–è¯‘ï¼š</p><pre><code class="hljs bash">make -jX</code></pre><p><code>-jX</code>ä¸ºå¤šçº¿ç¨‹ç¼–è¯‘ï¼Œå¦‚<code>-j8</code>ã€‚</p><p>ç¼–è¯‘å®Œæˆä¹‹åè¿›è¡Œå®‰è£…ï¼š</p><pre><code class="hljs bash">sudo make install</code></pre><h1 id="Step-4-Configure"><a href="#Step-4-Configure" class="headerlink" title="Step 4: Configure"></a>Step 4: Configure</h1><p>å®‰è£…çš„é»˜è®¤è·¯å¾„åœ¨<code>/usr/local/share/Geant4-10.6.0</code>ï¼Œå°†ä¸‹è½½çš„æ•°æ®æ–‡ä»¶å¤åˆ¶åˆ°è¯¥æ–‡ä»¶å¤¹ï¼š</p><pre><code class="hljs bash">sudo cp -r ./data/ /usr/<span class="hljs-built_in">local</span>/share/Geant4-10.6.0/</code></pre><p>ä¹‹åï¼Œåœ¨<code>~/.bashrc</code>é‡Œæ·»åŠ <code>/usr/local/share/Geant4-10.6.0/geant4make/geant4make.sh</code>ï¼Œå¦‚æœä½ çš„ç‰ˆæœ¬å’Œæˆ‘çš„ä¸ä¸€æ ·ï¼Œç›¸åº”ä¿®æ”¹å³å¯ã€‚</p><h1 id="Step-5-CLion-Configuration"><a href="#Step-5-CLion-Configuration" class="headerlink" title="Step 5: CLion Configuration"></a>Step 5: CLion Configuration</h1><p>æœ€åæˆ‘ä»¬æ¥é…ç½®CLionç¯å¢ƒï¼Œé…å¥½ä¹‹åå¯ä»¥åœ¨IDEä¸­ç¼–å†™<code>Geant4</code>ä»£ç ï¼Œè¿˜å¯ä»¥æ–­ç‚¹è°ƒè¯•ï¼Œéå¸¸æ–¹ä¾¿ã€‚å®‰è£…CLionçš„è¿‡ç¨‹è¿™é‡Œçœç•¥ï¼Œæ‰“å¼€ä¸€ä¸ª<code>Geant4</code>è‡ªå¸¦çš„ä¾‹å­æˆ–è€…è‡ªå·±æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæ‰“å¼€<code>Edit Configurations</code>ã€‚</p><p><img src="https://i.loli.net/2020/06/25/W1xXHUqIvofyKQk.png" srcset="/img/loading.gif" alt=""></p><p>éšä¾¿æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¾“å…¥ä¸€ä¸‹å‘½ä»¤è·å–ç¯å¢ƒå˜é‡ï¼š</p><pre><code class="hljs bash">env | grep G4</code></pre><p>åœ¨<code>Environment variables</code>å¡«å…¥åˆšæ‰è·å–çš„ç¯å¢ƒå˜é‡ï¼ˆå¤åˆ¶ä¹‹åæŒ‰ä¸€ä¸‹ç²˜è´´å°±å¯ä»¥äº†ï¼‰ï¼Œç„¶åæŠŠ<code>Working directory</code>è®¾ç½®æˆå½“å‰æ–‡ä»¶å¤¹ã€‚</p><p><img src="https://i.loli.net/2020/06/25/HrslFTOau51y8tX.png" srcset="/img/loading.gif" alt=""></p><p><img src="https://i.loli.net/2020/06/25/5UKaCgvnWjYmNTG.png" srcset="/img/loading.gif" alt=""></p><p>ç°åœ¨å°±å¤§åŠŸå‘Šæˆäº†ï¼</p>]]></content>
    
    
    <categories>
      
      <category>Technical Notes</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Geant4</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Complementary Set Variational Autoencoder for Supervised Anomaly Detection</title>
    <link href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/"/>
    <url>/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>å¯¹äºå¼‚å¸¸æ£€æµ‹é—®é¢˜ï¼Œå¼‚å¸¸çš„æ¨¡å¼æ˜¯å¤šç§å¤šæ ·çš„ã€‚æœ‰ç›‘ç£æ¨¡å‹èƒ½å¤Ÿè¾ƒå¥½åœ°å¤„ç†è®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„æ¨¡å¼ï¼Œæ— ç›‘ç£æ¨¡å‹èƒ½å¤Ÿå¤„ç†è®­ç»ƒé›†ä¸­æœªå‡ºç°è¿‡çš„æ¨¡å¼ï¼Œä½†å¯¹äºè®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å‹å¹¶æ²¡æœ‰å­¦ä¹ ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§æ—¢èƒ½å­¦ä¹ è®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å¼ï¼ŒåŒæ—¶èƒ½å¤„ç†æœªå‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å¼çš„æ–¹æ³•ã€‚</p><h1 id="Proposed-Model"><a href="#Proposed-Model" class="headerlink" title="Proposed Model"></a>Proposed Model</h1><h2 id="Conventional-VAE"><a href="#Conventional-VAE" class="headerlink" title="Conventional VAE"></a>Conventional VAE</h2><p>é¦–å…ˆå›é¡¾ä¸€ä¸‹åŸå§‹çš„VAEã€‚</p><p>åŸå§‹VAEä¸­çš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})=\mathbb{E}<em>{q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})}[\log p(\boldsymbol{x}|\boldsymbol{z};\boldsymbol{\theta})]-\text{KL}[q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi}\parallel p(\boldsymbol{z}))]<br>$$<br>åŸæ–‡ä¸­ä½œè€…è¯æ˜äº†$\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\leq\log p(\boldsymbol{x};\boldsymbol{\theta})$ï¼Œæ‰€ä»¥$\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})$å¯ä»¥çœ‹ä½œæ˜¯æ•°æ®åˆ†å¸ƒ$p(\boldsymbol{x})$å¯¹æ•°ä¼¼ç„¶çš„ä¸€ä¸ªä¸‹ç•Œã€‚$\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})$åˆè¢«ç§°ä¸ºè¯æ®ä¸‹ç•Œ (ELBO)ã€‚$\mathbb{E}</em>{q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})}[\log p(\boldsymbol{x}|\boldsymbol{z};\boldsymbol{\theta})]$ä¸­çš„æœŸæœ›ä¸€èˆ¬ç”¨è’™ç‰¹å¡æ´›æ¥è¿›è¡Œä¼°è®¡ï¼š<br>$$<br>\begin{align}<br>\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\simeq&amp; \frac{1}{L}\sum\limits_l\log p(\boldsymbol{x}|\boldsymbol{z}^{(l)};\boldsymbol{\theta})-\text{KL}[q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})\parallel p(\boldsymbol{z})],\<br>\boldsymbol{z}^{(l)}&amp;\sim q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi}), \space l\in{1,2,\cdots,L}<br>\end{align}<br>$$<br>å¯¹äºéšå˜é‡$\boldsymbol{z}$ï¼Œä¸€èˆ¬å‡è®¾å…ˆéªŒæœä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼ŒåéªŒæœä»å‡å€¼ä¸º$\mu$ï¼Œæ–¹å·®ä¸º$\sigma^2$çš„é«˜æ–¯åˆ†å¸ƒï¼Œæ•…KLæ•£åº¦èƒ½ç›´æ¥å†™å‡ºè§£æå¼ï¼š<br>$$<br>\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\simeq \frac{1}{L}\sum\limits_l\log p(\boldsymbol{x}|\boldsymbol{z}^{(l)};\boldsymbol{\theta})-C(-\frac{1}{2}-\log\sigma+\frac{1}{2}\sigma^2+\frac{1}{2}\mu^2)<br>$$<br>ä½¿ç”¨VAEæ¥åšå¼‚å¸¸æ£€æµ‹é€šå¸¸æ˜¯åœ¨æ­£å¸¸æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼Œåœ¨æ£€æµ‹é˜¶æ®µï¼Œå¦‚æœæ˜¯å¼‚å¸¸æ ·æœ¬ï¼Œé‚£ä¹ˆVAEä¸èƒ½å¾ˆå¥½åœ°é‡æ„å®ƒï¼Œè¿™æ ·ä¼šå¯¼è‡´è¾ƒå¤§çš„é‡æ„è¯¯å·®ã€‚</p><h2 id="Prior-Distribution-for-Anomalies"><a href="#Prior-Distribution-for-Anomalies" class="headerlink" title="Prior Distribution for Anomalies"></a>Prior Distribution for Anomalies</h2><img src="https://i.loli.net/2020/06/25/vrxAzRVCtaE3oLc.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>åœ¨åŸå§‹VAEå¼‚å¸¸æ£€æµ‹ä¸­ï¼Œæ— è®ºè¾“å…¥æ ·æœ¬$\boldsymbol{x}$æ˜¯å¦å¼‚å¸¸ï¼ŒVAEéƒ½ä¼šä½¿å¯¹åº”ç¼–ç çš„åéªŒ$p(\boldsymbol{z}|\boldsymbol{x})$æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸”æ–½åŠ æ ‡å‡†é«˜æ–¯åˆ†å¸ƒçš„çº¦æŸã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œä½œè€…å¯¹å¼‚å¸¸å’Œæ­£å¸¸æ ·æœ¬å¯¹åº”çš„éšå˜é‡çš„å…ˆéªŒåˆ†å¸ƒåšäº†ä¸åŒå‡è®¾ã€‚é¦–å…ˆï¼Œæ­£å¸¸å…ˆéªŒä¾ç„¶æ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼Œè®°ä¸º$p_n(\boldsymbol{z})$ã€‚è€Œå¯¹äºå¼‚å¸¸å…ˆéªŒï¼Œä½œè€…è®¤ä¸ºå¼‚å¸¸å³ä¸ºâ€œä¸æ­£å¸¸â€ï¼Œå’Œæ­£å¸¸æ˜¯è¡¥é›†çš„å…³ç³»ã€‚ä½œè€…åœ¨æ–‡ä¸­å®šä¹‰å¼‚å¸¸å…ˆéªŒåˆ†å¸ƒ$p_a(\boldsymbol{z})$ä¸ºï¼š<br>$$<br>p_a(\boldsymbol{z})=\frac{1}{Y^\prime}(\max\limits_{\boldsymbol{z}^\prime}p_n(\boldsymbol{z}^\prime)-p_n(\boldsymbol{z}))<br>$$</p><p>å…¶ä¸­$Y^\prime$ä¸ºä½¿$p_a(\boldsymbol{z})$æˆä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„è°ƒèŠ‚å› å­ã€‚å®é™…ä¸Šï¼Œ$Y^\prime$å¾€å¾€ä¼šæˆä¸ºæ— é™å¤§ï¼Œå› ä¸º$p(\boldsymbol z)$åœ¨æ•´ä¸ªå®šä¹‰åŸŸä¸Šéƒ½æœ‰å®šä¹‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…åŠ å…¥äº†$p_w(\boldsymbol z)$ï¼Œä¸€ä¸ªåœ¨æ¯ä¸ªç»´åº¦éƒ½è¶³å¤Ÿå®½çš„è¾…åŠ©åˆ†å¸ƒï¼š</p><p>$$<br>p_a(\boldsymbol z)=\frac{1}{Y}p_w(\boldsymbol z)\left(\max\limits_{\boldsymbol z^\prime}p_n(\boldsymbol z^\prime)-p_n(\boldsymbol z)\right)<br>$$</p><p>å…¶ä¸­$Y$ä¸ºæœ‰é™çš„å¸¸æ•°ã€‚åœ¨æ–‡ä¸­$p_n(\boldsymbol z)$å’Œ$p_w(\boldsymbol z)$éƒ½ä¸ºé«˜æ–¯åˆ†å¸ƒï¼Œé‚£ä¹ˆ$p_a(\boldsymbol z)$çš„å…·ä½“å½¢å¼ä¸ºï¼š</p><p>$$<br>p_a(\boldsymbol z)=\frac{1}{Y}\mathcal{N}(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2){\max\limits_{\boldsymbol z^\prime}\mathcal N(\boldsymbol z^\prime;\boldsymbol 0,\boldsymbol 1)-\mathcal N(\boldsymbol z;\boldsymbol 0,\boldsymbol 1)}<br>$$</p><p>å…¶ä¸­ï¼š</p><p>$$<br>\max\limits_{\boldsymbol z^\prime}\mathcal N(\boldsymbol z^\prime;\boldsymbol 0,\boldsymbol 1)=\frac{1}{\sqrt{2\pi}}<br>$$</p><p>$$<br>Y=\int_{-\infty}^{\infty}p_a(\boldsymbol z)\mathrm{d}\boldsymbol z=\frac{1}{\sqrt{2\pi}}\left{1-\frac{1}{\boldsymbol s^2+1}\right}<br>$$</p><p>$\boldsymbol s^2$ä¸ºè¶…å‚æ•°ï¼Œæ§åˆ¶åˆ†å¸ƒçš„å®½åº¦ã€‚ç”¨æ–‡ä¸­çš„å…ˆéªŒæ›¿æ¢VAEåŸå§‹çš„KLæ•£åº¦ï¼Œå¯å†™ä¸ºï¼š</p><p>$$<br>\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]=\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\frac{\mathcal N(\boldsymbol z;\boldsymbol\mu,\boldsymbol\sigma^2)}{\frac{1}{Y}\mathcal N(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2)\left{\frac{1}{2\pi}-\mathcal N(\boldsymbol z;\boldsymbol0,\boldsymbol 1)\right}}\mathrm{d}\boldsymbol z<br>$$</p><p>å±•å¼€åï¼š</p><p>$$<br>\begin{align}<br>\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]&amp;=<br>\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\mathcal{N}(\boldsymbol z;\boldsymbol\mu,\boldsymbol\sigma^2)\mathrm{d}\boldsymbol z\<br>&amp;+\log Y\<br>&amp;-\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\mathcal{N}(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2)\mathrm{d}\boldsymbol z\<br>&amp;-\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\left{\frac{1}{\sqrt{2\pi}}-\mathcal{N}(\boldsymbol z;\boldsymbol 0, \boldsymbol 1)\right}\mathrm{d}\boldsymbol z<br>\end{align}<br>$$</p><p>ä½¿ç”¨æ³°å‹’å±•å¼€ï¼Œ$\log (x+\frac{1}{2\pi})\simeq-\log 2\pi+2\pi x$ï¼ŒKLæ•£åº¦å¯ä»¥ç”¨ä¸‹å¼ä¼°è®¡ï¼š</p><p>$$<br>\begin{align}<br>\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]&amp;\simeq\sqrt{\frac{2\pi}{\boldsymbol\sigma^2+1}}\exp\left(\frac{-\boldsymbol\mu^2}{2(\boldsymbol\sigma^2+1)}\right)\<br>&amp;+\frac{\boldsymbol\mu^2+\boldsymbol\sigma^2}{2\boldsymbol s^2}-\log\boldsymbol\sigma+\log\boldsymbol s+\log\left(\sqrt{\boldsymbol s^2+1}-1\right)\<br>&amp;-\frac{\log(\boldsymbol s^2+1)}{2}+\frac{\log(2\pi)-1}{2}<br>\end{align}<br>$$</p><p>ä¸‹å›¾ä¸ºä¸€ç»´æ—¶$p_n(\boldsymbol z)$å’Œ$p_a(\boldsymbol z)$çš„ç¤ºä¾‹ï¼š</p><img src="https://i.loli.net/2020/06/25/QHXo24cKj9uRwzW.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Implementation-of-proposed-method"><a href="#Implementation-of-proposed-method" class="headerlink" title="Implementation of proposed method"></a>Implementation of proposed method</h3><p>æ–‡ä¸­ä½¿ç”¨ç¼–ç å™¨è¾“å‡ºçš„åˆ†å¸ƒ$\mathcal{N}(\boldsymbol z;\boldsymbol \mu, \boldsymbol \sigma^2)$ä¸æ ‡å‡†æ­£æ€åˆ†å¸ƒä¹‹é—´çš„KLæ•£åº¦æ¥ä½œä¸ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨æ¯ä¸€è½®çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒåŠ å…¥ä¸€è½®ä½¿ç”¨Anomaly Priorçš„è®­ç»ƒã€‚</p><img src="https://i.loli.net/2020/06/25/wrmzADXtsyuJ6EZ.png" srcset="/img/loading.gif" style="zoom:67%;" /><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="MNIST"><a href="#MNIST" class="headerlink" title="MNIST"></a>MNIST</h2><p>ä½œè€…è®¾è®¡äº†ä¸¤ä¸ªTaskï¼š</p><ol><li>Task 1. $N$ vs. $\bar{N}$. å°†æ‰‹å†™æ•°å­—ä¸­çš„ä¸€ä¸ªä½œä¸ºå·²çŸ¥å¼‚å¸¸ï¼Œå…¶ä»–ä½œä¸ºæ­£å¸¸ï¼Œå¹¶åŠ å…¥å‡åŒ€åˆ†å¸ƒä½œä¸ºæœªçŸ¥çš„å¼‚å¸¸ã€‚</li><li>Task 2. æ‰‹å†™æ•°å­—è¢«åˆ†ä¸º3ç»„ï¼šå·²çŸ¥å¼‚å¸¸ï¼Œæ­£å¸¸ï¼ŒæœªçŸ¥å¼‚å¸¸ã€‚</li></ol><p>ç»†èŠ‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/ifcIxr9zOpEhksA.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>åœ¨å®ç°ä¸Šï¼Œä½¿ç”¨Adamä¼˜åŒ–å™¨ï¼Œ<code>batch_size</code>ä¸º100ï¼Œ<code>epochs</code>ä¸º200ã€‚<code>Encoder</code>å’Œ<code>Decoder</code>éƒ½ç”±ä¸‰å±‚æ„ŸçŸ¥æœºç»„æˆï¼Œè¶…å‚æ•°$s^2$è®¾ç½®ä¸º400ã€‚è¯„æµ‹æ ‡å‡†ä½¿ç”¨AUC (area under the receiver characteristic curve)ã€‚</p><p>ä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š</p><img src="https://i.loli.net/2020/06/25/YTpO98y1ZPmAK3g.png" srcset="/img/loading.gif" style="zoom:67%;" />]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Anomaly Detection</tag>
      
      <tag>VAE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Time Series Anomaly Detection Paper List</title>
    <link href="/2020/01/08/Time-Series-Anomaly-Detection-Paper-List/"/>
    <url>/2020/01/08/Time-Series-Anomaly-Detection-Paper-List/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹åœ¨å¾ˆå¤šé¢†åŸŸä¾‹å¦‚è¿ç»´ã€é‡‘èã€äº¤é€šéƒ½æ‰®æ¼”è€…é‡è¦çš„è§’è‰²ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p><blockquote><p>ç»™å®šæ—¶é—´åºåˆ—$X={\mathbf{x}_1,\mathbf{x}_2,\cdots,\mathbf{x}_n}\in\mathbb{R}^{m\times n}$ï¼Œå¼‚å¸¸æ£€æµ‹çš„ä»»åŠ¡æ˜¯è¾“å‡ºå¼‚å¸¸æ ‡ç­¾$y={y_1,y_2,\cdots,y_n}\in\mathbb{R}^n$ï¼Œå…¶ä¸­$y_t=1$ä»£è¡¨$\mathbf{x}_t$ä¸ºå¼‚å¸¸ï¼Œ$y_t=0$ä»£è¡¨$\mathbf{x}_t$æ­£å¸¸</p></blockquote><p>æœ¬æ–‡ç½—åˆ—äº†ä¸€äº›æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹é¢†åŸŸå€¼å¾—è¯»çš„ä¸€äº›æ–‡ç« ï¼ŒModelä¸€ç« ä¸»è¦æŒ‰æ—¶é—´åºåˆ—ã€é€šç”¨å’Œå›¾çš„å¼‚å¸¸æ£€æµ‹åˆ†ç±»ï¼ŒRelatedä¸»è¦æ˜¯ä¸€äº›éå¼‚å¸¸æ£€æµ‹ã€ä½†æ˜¯èƒ½å¤Ÿè§£å†³å¼‚å¸¸æ£€æµ‹ç ”ç©¶ä¸­çš„ä¸€äº›é—®é¢˜çš„æ–‡ç« ã€‚</p><img src="https://i.loli.net/2020/06/25/75i8nevSBNk1EoC.png" srcset="/img/loading.gif" style="zoom:67%;" /><h1 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h1><h2 id="Time-Series"><a href="#Time-Series" class="headerlink" title="Time Series"></a>Time Series</h2><h3 id="Statistical"><a href="#Statistical" class="headerlink" title="Statistical"></a>Statistical</h3><p>ä¸»è¦åŒ…æ‹¬åå‘ç»Ÿè®¡æ–¹æ³•çš„æ¨¡å‹ï¼š</p><table><thead><tr><th><strong>Title</strong></th><th><strong>Conf/Journal</strong></th><th><strong>Description</strong></th><th><strong>Links</strong></th></tr></thead><tbody><tr><td>Temporal Anomaly Detection: Calibrating the Surprise</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1705.10085" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Non-Parametric Outliers Detection in Multiple Time Series A Case Study: Power Grid Data Analysis</td><td></td><td></td><td><a href="https://aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/16315" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Anomaly Detection in Streams with Extreme Value Theory</td><td>KDD17</td><td>æå‡ºäº†ä»¥Extreme Value Theoryä¸ºåŸºç¡€çš„æ—¶åºå¼‚å¸¸æ£€æµ‹å’Œå‚æ•°é€‰æ‹©æ–¹æ³•</td><td><a href="https://www.kdd.org/kdd2017/papers/view/anomaly-detection-in-streams-with-extreme-value-theory" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Semi-Markov Switching Vector Autoregressive Model-Based Anomaly Detection in Aviation Systems</td><td></td><td></td><td><a href="https://www.kdd.org/kdd2016/subtopic/view/semi-markov-switching-vector-autoregressive-model-based-anomaly-detection-i" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Stochastic Online Anomaly Analysis for Streaming Time Series</td><td></td><td></td><td><a href="https://www.ijcai.org/proceedings/2017/445" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Unsupervised Real-time Anomaly Detection for Streaming Data</td><td></td><td></td><td><a href="https://www.sciencedirect.com/science/article/pii/S0925231217309864" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Automatic Anomaly Detection in the Cloud Via Statistical Learning</td><td></td><td></td><td><a href="https://arxiv.org/abs/1704.07706" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr></tbody></table><h3 id="Classic-Machine-Learning"><a href="#Classic-Machine-Learning" class="headerlink" title="Classic Machine Learning"></a>Classic Machine Learning</h3><table><thead><tr><th><strong>Title</strong></th><th><strong>Conf/Journal</strong></th><th><strong>Description</strong></th><th><strong>Links</strong></th></tr></thead><tbody><tr><td>Semi-supervised Anomaly Detection with an Application to Water Analytics</td><td></td><td></td><td><a href="https://people.cs.kuleuven.be/~vincent.vercruyssen/publications/2018/ICDM_conference_manuscript.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>DILOF: Effective and Memory Efficient Local Outlier Detection in Data Streams</td><td></td><td></td><td><a href="https://www.kdd.org/kdd2018/accepted-papers/view/dsilof-effective-and-memory-efficient-local-outlier-detection-in-data-strea" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Robust Random Cut Forest Based Anomaly Detection On Streams</td><td>ICML16</td><td>å­¤ç«‹æ£®æ—çš„æ”¹è¿›ç‰ˆæœ¬æ¥åšæ—¶åºå¼‚å¸¸æ£€æµ‹</td><td><a href="http://proceedings.mlr.press/v48/guha16.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="https://github.com/kLabUM/rrcf" target="_blank" rel="noopener">ğŸ“¥Code</a></td></tr><tr><td>Anomaly Detection for an E-commerce Pricing System</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1902.09566" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>An Adaptive Approach for Anomaly Detector Selection and Fine-Tuning in Time Series</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1907.07843" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Opprentice: Towards Practical and Automatic Anomaly Detection Through Machine Learning</td><td>IMC15</td><td>ä»¥éšæœºæ£®æ—ä¸ºåŸºç¡€çš„æ—¶åºå¼‚å¸¸æ£€æµ‹</td><td><a href="http://netman.cs.tsinghua.edu.cn/wp-content/uploads/2015/11/liu_imc15_Opprentice.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Variational Inference for On-line Anomaly Detection in High-Dimensional Time Series</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1602.07109" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>A Self-Learning and Online Algorithm for Time SeriesAnomaly Detection, with Application in CPU Manufacturing</td><td></td><td></td><td><a href="https://dl.acm.org/citation.cfm?id=2983344" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr></tbody></table><h3 id="VAE"><a href="#VAE" class="headerlink" title="VAE"></a>VAE</h3><table><thead><tr><th><strong>Title</strong></th><th><strong>Conf/Journal</strong></th><th><strong>Description</strong></th><th><strong>Links</strong></th></tr></thead><tbody><tr><td>Unsupervised Anomaly Detection via Variational Auto-Encoder for Seasonal KPIs in Web Applications</td><td>WWW18</td><td>æ™®é€šVAE</td><td><a href="https://arxiv.org/pdf/1802.03903" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="https://github.com/haowen-xu/donut" target="_blank" rel="noopener">ğŸ“¥Code</a> <a href="http://qfxiao.me/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/">âœBlog</a></td></tr><tr><td>Robust and Unsupervised KPI Anomaly Detection Based on Conditional Variational Autoencoder</td><td>IPCCC18</td><td>æ¡ä»¶VAE</td><td><a href="https://ieeexplore.ieee.org/document/8710885" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="https://github.com/yantijin/Buzz" target="_blank" rel="noopener">ğŸ“¥Code</a></td></tr><tr><td>Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE</td><td>INFOCOM19</td><td>VAEåŠ å¯¹æŠ—è®­ç»ƒ</td><td><a href="https://ieeexplore.ieee.org/abstract/document/8737430/" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Multidimensional Time Series Anomaly Detection: A GRU-based Gaussian Mixture Variational Autoencoder Approach</td><td></td><td></td><td><a href="http://proceedings.mlr.press/v95/guo18a/guo18a.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network</td><td>KDD19</td><td>å¤šå˜é‡åŸºäºVAEå’ŒRNNçš„æ—¶åºå¼‚å¸¸æ£€æµ‹</td><td><a href="https://www.kdd.org/kdd2019/accepted-papers/view/robust-anomaly-detection-for-multivariate-time-series-through-stochastic-re" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="https://github.com/smallcowbaby/OmniAnomaly" target="_blank" rel="noopener">ğŸ“¥Code</a></td></tr><tr><td>A Multimodal Anomaly Detector for Robot-Assisted Feeding Using an LSTM-based Variational Autoencoder</td><td></td><td></td><td><a href="http://ieeexplore.ieee.org/document/8279425/" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr></tbody></table><h3 id="RNN"><a href="#RNN" class="headerlink" title="RNN"></a>RNN</h3><table><thead><tr><th><strong>Title</strong></th><th><strong>Conf/Journal</strong></th><th><strong>Description</strong></th><th><strong>Links</strong></th></tr></thead><tbody><tr><td>Detecting Spacecraft Anomalies Using LSTMs and Nonparametric Dynamic Thresholding</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1802.04431" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>BINet: Multivariate Business Process Anomaly Detection Using Deep Learning</td><td></td><td></td><td><a href="https://link.springer.com/chapter/10.1007/978-3-319-98648-7_16" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Outlier Detection for Time Series with Recurrent Autoencoder Ensembles</td><td></td><td></td><td><a href="https://www.ijcai.org/proceedings/2019/0378.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>LSTM-based Encoder-Decoder for Multi-sensor Anomaly Detection</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1607.00148" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Detecting Anomalies in Space using Multivariate Convolutional LSTM with Mixtures of Probabilistic PCA</td><td>KDD19</td><td></td><td><a href="https://dl.acm.org/doi/10.1145/3292500.3330776" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr></tbody></table><h3 id="GAN"><a href="#GAN" class="headerlink" title="GAN"></a>GAN</h3><table><thead><tr><th><strong>Title</strong></th><th><strong>Conf/Journal</strong></th><th><strong>Description</strong></th><th><strong>Links</strong></th></tr></thead><tbody><tr><td>Anomaly Detection with Generative Adversarial Networks for Multivariate Time Series</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1809.04758" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="http://larryshaw0079.coding.me/blog/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/" target="_blank" rel="noopener">ğŸ“¥Blog</a></td></tr><tr><td>MAD-GAN: Multivariate Anomaly Detection for Time Series Data with Generative Adversarial Networks</td><td>ICANN19</td><td>æ™®é€šGANåšæ—¶åºå¼‚å¸¸æ£€æµ‹ï¼Œæ²¡æœ‰ç¼–ç ç»“æ„</td><td><a href="https://arxiv.org/pdf/1901.04997" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="https://github.com/LiDan456/MAD-GANs" target="_blank" rel="noopener">ğŸ“¥Code</a></td></tr><tr><td>BeatGAN: Anomalous Rhythm Detection using Adversarially Generated Time Series</td><td>IJCAI19</td><td>ECGå¼‚å¸¸æ£€æµ‹ï¼Œæ²¡æœ‰éšå˜é‡çº¦æŸ</td><td><a href="https://www.ijcai.org/proceedings/2019/616" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr></tbody></table><h3 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h3><table><thead><tr><th><strong>Title</strong></th><th><strong>Conf/Journal</strong></th><th><strong>Description</strong></th><th><strong>Links</strong></th></tr></thead><tbody><tr><td>A Deep Neural Network for Unsupervised Anomaly Detection and Diagnosis in Multivariate Time Series Data</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1811.08055" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection</td><td>Expert Systems With Applications</td><td>æœ‰ç›‘ç£KPIå¼‚å¸¸æ£€æµ‹ï¼Œä½¿ç”¨ä¸¤é˜¶æ®µè®­ç»ƒæ¥æå‡æ€§èƒ½</td><td><a href="https://www.sciencedirect.com/science/article/pii/S0957417419304282" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="http://larryshaw0079.coding.me/blog/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/" target="_blank" rel="noopener">âœBlog</a></td></tr><tr><td>Time-Series Anomaly Detection Service at Microsoft</td><td>KDD19</td><td>å°†è§†è§‰å¼‚å¸¸æ£€æµ‹ä¸­çš„è°±æ®‹å·®åº”ç”¨åˆ°äº†æ—¶åºå¼‚å¸¸æ£€æµ‹</td><td><a href="https://arxiv.org/pdf/1906.03821" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="https://github.com/microsoft/anomalydetector" target="_blank" rel="noopener">ğŸ“¥Code</a> <a href="http://larryshaw0079.coding.me/blog/2019/09/22/Time-Series-Anomaly-Detection-Service-at-Microsoft/" target="_blank" rel="noopener">âœBlog</a></td></tr><tr><td>Outlier Detection for Multidimensional Time Series using Deep Neural Networks</td><td></td><td></td><td><a href="https://ieeexplore.ieee.org/document/8411269" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr></tbody></table><h2 id="General"><a href="#General" class="headerlink" title="General"></a>General</h2><h3 id="Survey"><a href="#Survey" class="headerlink" title="Survey"></a>Survey</h3><ul><li><em>Deep Learning for Anomaly Detection: A Survey</em> <a href="https://arxiv.org/abs/1901.03407" target="_blank" rel="noopener">[Paper]</a></li></ul><h3 id="Classic-Machine-Learning-1"><a href="#Classic-Machine-Learning-1" class="headerlink" title="Classic Machine Learning"></a>Classic Machine Learning</h3><table><thead><tr><th><strong>Title</strong></th><th><strong>Conf/Journal</strong></th><th><strong>Description</strong></th><th><strong>Links</strong></th></tr></thead><tbody><tr><td>LOF: Identifying Density-Based Local Outliers</td><td></td><td></td><td><a href="https://dl.acm.org/citation.cfm?id=335388" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Isolation Forest</td><td></td><td></td><td><a href="https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Extended Isolation Forest</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1811.02141" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Hidden Markov Anomaly Detection</td><td></td><td></td><td><a href="http://proceedings.mlr.press/v37/goernitz15.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Linear-Time Outlier Detection via Sensitivity</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1605.00519" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Reverse Nearest Neighbors in Unsupervised Distance-Based Outlier Detection</td><td></td><td></td><td><a href="http://ieeexplore.ieee.org/document/6948273" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Theoretical Foundations and Algorithms for Outlier Ensembles</td><td></td><td></td><td><a href="https://www.kdd.org/exploration_files/Article4.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>R1SVM: A Randomised Nonlinear Approach to Large-Scale Anomaly Detection</td><td></td><td></td><td><a href="https://www.aaai.org/ocs/index.php/AAAI/AAAI15/paper/view/9343" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Random Gradient Descent Tree: A Combinatorial Approach for SVM with Outliers</td><td></td><td></td><td><a href="https://www.aaai.org/ocs/index.php/AAAI/AAAI15/paper/view/9477" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Sparse Gaussian Markov Random Field Mixtures for Anomaly Detection</td><td></td><td></td><td><a href="https://ieeexplore.ieee.org/document/7837932/" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Sequential Ensemble Learning for Outlier Detection: A Bias-Variance Perspective</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1609.05528" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Sparse Modeling-Based Sequential Ensemble Learning for Effective Outlier Detection in High-Dimensional Numeric Data</td><td></td><td></td><td><a href="https://aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/16648" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Contextual Spatial Outlier Detection with Metric Learning</td><td></td><td></td><td><a href="https://www.kdd.org/kdd2017/papers/view/contextual-spatial-outlier-detection-with-metric-learning" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Human-Assisted Online Anomaly Detection with Normal Outlier Retraining</td><td></td><td></td><td><a href="https://www.andrew.cmu.edu/user/lakoglu/odd/accepted_papers/ODD_v50_paper_11.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Efficient Anomaly Detection via Matrix Sketching</td><td></td><td></td><td><a href="https://papers.nips.cc/paper/8030-efficient-anomaly-detection-via-matrix-sketching.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Dual-Regularized Multi-View Outlier Detection</td><td></td><td></td><td><a href="https://www.ijcai.org/Proceedings/15/Papers/572.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Deep Anomaly Detection Using Geometric Transformations</td><td></td><td></td><td><a href="https://papers.nips.cc/paper/8183-deep-anomaly-detection-using-geometric-transformations.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Multi-view Anomaly Detection via Robust Probabilistic Latent Variable Models</td><td></td><td></td><td><a href="https://papers.nips.cc/paper/6456-multi-view-anomaly-detection-via-robust-probabilistic-latent-variable-models.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Partial Multi-View Outlier Detection Based on Collective Learning</td><td></td><td></td><td><a href="https://aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/17166" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Multi-View Anomaly Detection: Neighborhood in Locality Matters</td><td></td><td></td><td><a href="https://www.aaai.org/ojs/index.php/AAAI/article/view/4418" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Latent Discriminant Subspace Representations for Multi-View Outlier Detection</td><td></td><td></td><td><a href="https://aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/17401" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Anomaly Detection with Partially Observed Anomalies</td><td></td><td></td><td><a href="https://dl.acm.org/citation.cfm?id=3184558.3186580" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>One-Class Active Learning for Outlier Detection with Multiple Subspaces</td><td></td><td></td><td><a href="https://dl.acm.org/citation.cfm?id=3357873" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Statistical Analysis of Nearest Neighbor Methods for Anomaly Detection</td><td>NIPS19</td><td></td><td><a href="http://papers.nips.cc/paper/9274-statistical-analysis-of-nearest-neighbor-methods-for-anomaly-detection" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>SNIPER: Few-shot Learning for Anomaly Detection to Minimize False-negative Rate with Ensured True-positive Rate</td><td>ICASSP19</td><td></td><td><a href="https://ieeexplore.ieee.org/document/8683667" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr></tbody></table><h3 id="AE-VAE"><a href="#AE-VAE" class="headerlink" title="AE/VAE"></a>AE/VAE</h3><table><thead><tr><th><strong>Title</strong></th><th><strong>Conf/Journal</strong></th><th><strong>Description</strong></th><th><strong>Links</strong></th></tr></thead><tbody><tr><td>Estimation of Dimensions Contributing to Detected Anomalies with Variational Autoencoders</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1811.04576" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Anomaly Detection with Robust Deep Autoencoders</td><td></td><td></td><td><a href="https://www.kdd.org/kdd2017/papers/view/anomaly-detection-with-robust-deep-auto-encoders" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Complementary Set Variational Autoencoder for Supervised Anomaly Detection</td><td></td><td></td><td><a href="https://ieeexplore.ieee.org/document/8462181" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>A Two-class Hyper-spherical Autoencoder for Supervised Anomaly Detection</td><td></td><td></td><td><a href="https://ieeexplore.ieee.org/document/8683790" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr></tbody></table><h3 id="GAN-1"><a href="#GAN-1" class="headerlink" title="GAN"></a>GAN</h3><table><thead><tr><th><strong>Title</strong></th><th><strong>Conf/Journal</strong></th><th><strong>Description</strong></th><th><strong>Links</strong></th></tr></thead><tbody><tr><td>Adversarially Learned Anomaly Detection</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1812.02288" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>AMAD: Adversarial Multiscale Anomaly Detection on High-Dimensional and Time-Evolving Categorical Data</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1907.06582" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Adversarially Learned One-Class Classifier for Novelty Detection</td><td></td><td></td><td><a href="http://openaccess.thecvf.com/content_cvpr_2018/papers/Sabokrou_Adversarially_Learned_One-Class_CVPR_2018_paper.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="https://github.com/khalooei/ALOCC-CVPR2018" target="_blank" rel="noopener">ğŸ“¥Code</a></td></tr><tr><td>Generative Probabilistic Novelty Detection with Adversarial Autoencoders</td><td></td><td></td><td><a href="https://papers.nips.cc/paper/7915-generative-probabilistic-novelty-detection-with-adversarial-autoencoders.pdf" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="https://github.com/podgorskiy/GPND" target="_blank" rel="noopener">ğŸ“¥Code</a></td></tr><tr><td>OCGAN: One-class Novelty Detection Using GANs with Constrained Latent Representations</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1903.08550" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Fence GAN: Towards Better Anomaly Detection</td><td>Arxiv</td><td></td><td><a href="https://arxiv.org/abs/1904.01209" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Anomaly Detection via Minimum Likelihood Generative Adversarial Networks</td><td>Arxiv</td><td></td><td><a href="https://arxiv.org/abs/1808.00200" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>DOPING: Generative Data Augmentation for Unsupervised Anomaly Detection with GAN</td><td>ICDM18</td><td></td><td><a href="https://ieeexplore.ieee.org/document/8594955" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Learning Competitive and Discriminative Reconstructions for Anomaly Detection</td><td>AAAI19</td><td></td><td><a href="https://www.aaai.org/ojs/index.php/AAAI/article/view/4451" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr></tbody></table><h3 id="Miscellaneous-1"><a href="#Miscellaneous-1" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h3><table><thead><tr><th><strong>Title</strong></th><th><strong>Conf/Journal</strong></th><th><strong>Description</strong></th><th><strong>Links</strong></th></tr></thead><tbody><tr><td>Deep Structured Energy Based Models for Anomaly Detection</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1605.07717" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Anomaly Detection using One-Class Neural Networks</td><td></td><td></td><td><a href="https://arxiv.org/pdf/1802.06360" target="_blank" rel="noopener">ğŸ“ƒPaper</a> <a href="https://github.com/raghavchalapathy/oc-nn" target="_blank" rel="noopener">ğŸ“¥Code</a></td></tr><tr><td>High-dimensional and large-scale anomaly detection using a linear one-class SVM with deep learning</td><td></td><td></td><td><a href="https://www.sciencedirect.com/science/article/pii/S0031320316300267" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Deep Autoencoding Gaussian Mixture Model for Unsupervised Anomaly Detection</td><td></td><td></td><td><a href="https://openreview.net/pdf?id=BJJLHbb0-" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Deep Anomaly Detection with Outlier Exposure</td><td></td><td></td><td><a href="https://openreview.net/forum?id=HyxCxhRcY7" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Are Generative Deep Models for Novelty Detection Truly Better?</td><td>KDD18 Workshop</td><td></td><td><a href="https://arxiv.org/abs/1807.05027" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Probabilistic-Mismatch Anomaly Detection: Do oneâ€™s Medications Match with the Diagnoses?</td><td>ICDM16</td><td></td><td><a href="https://ieeexplore.ieee.org/document/7837890" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Deep Anomaly Detection with Deviation Networks</td><td>KDD19</td><td></td><td><a href="https://dl.acm.org/doi/10.1145/3292500.3330871" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Weakly-supervised Deep Anomaly Detection with Pairwise Relation Learning</td><td>AAAI20</td><td></td><td><a href="https://arxiv.org/abs/1910.13601" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Transfer Anomaly Detection by Inferring Latent Domain Representations</td><td>NIPS19</td><td></td><td><a href="http://papers.nips.cc/paper/8517-transfer-anomaly-detection-by-inferring-latent-domain-representations" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Multi-view Anomaly Detection via Robust Probabilistic Latent Variable Models</td><td>NIPS16</td><td></td><td><a href="http://papers.nips.cc/paper/6456-multi-view-anomaly-detection-via-robust-probabilistic-latent-variable-models" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>Continual Learning for Anomaly Detection with Variational Autoencoder</td><td>ICASSP19</td><td></td><td><a href="https://ieeexplore.ieee.org/document/8682702" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr><tr><td>AdaFlow: Domain-adaptive Density Estimator with Application to Anomaly Detection and Unpaired Cross-domain Translation</td><td>ICASSP19</td><td></td><td><a href="https://ieeexplore.ieee.org/document/8683072" target="_blank" rel="noopener">ğŸ“ƒPaper</a></td></tr></tbody></table><h2 id="Graph"><a href="#Graph" class="headerlink" title="Graph"></a>Graph</h2><ul><li><em>AddGraph: Anomaly Detection in Dynamic Graph Using Attention-based Temporal GCN</em> <a href="https://www.ijcai.org/proceedings/2019/614" target="_blank" rel="noopener">[Paper]</a></li><li><em>Outlier Detection in Graph Streams</em> <a href="https://ieeexplore.ieee.org/document/5767885" target="_blank" rel="noopener">[Paper]</a></li><li><em>NetWalk: A Flexible Deep Embedding Approach for Anomaly Detection in Dynamic Networks</em> <a href="https://www.kdd.org/kdd2018/accepted-papers/view/netwalk-a-flexible-deep-embedding-approach-for-anomaly-detection-in-dynamic" target="_blank" rel="noopener">[Paper]</a></li><li><em>Anomaly Detection in Dynamic Networks using Multi-view Time-Series Hypersphere Learning</em> <a href="https://dl.acm.org/citation.cfm?id=3132964" target="_blank" rel="noopener">[Paper]</a></li></ul><h1 id="Related"><a href="#Related" class="headerlink" title="Related"></a>Related</h1><p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯ä¸€äº›éå¼‚å¸¸æ£€æµ‹æ–‡ç« ï¼Œä½†æ˜¯å¯ä»¥ç”¨æ¥è§£å†³å¼‚å¸¸æ£€æµ‹ä¸­çš„é—®é¢˜çš„ç›¸å…³æ–‡ç« ã€‚</p><h2 id="Infrastructure"><a href="#Infrastructure" class="headerlink" title="Infrastructure"></a>Infrastructure</h2><h3 id="GAN-2"><a href="#GAN-2" class="headerlink" title="GAN"></a>GAN</h3><ul><li><em>Generative Adversarial Networks</em> <a href="https://arxiv.org/abs/1406.2661" target="_blank" rel="noopener">[Paper]</a></li></ul><h4 id="VAE-amp-GAN-Combination"><a href="#VAE-amp-GAN-Combination" class="headerlink" title="VAE &amp; GAN Combination"></a>VAE &amp; GAN Combination</h4><ul><li><em>Variational Approaches for Auto-Encoding Generative Adversarial Networks</em> <a href="https://arxiv.org/abs/1706.04987" target="_blank" rel="noopener">[Paper]</a></li><li><em>Adversarial Variational Bayes: Unifying Variational Autoencoders and Generative Adversarial Networks</em> <a href="https://arxiv.org/abs/1701.04722" target="_blank" rel="noopener">[Paper]</a></li><li><em>On Unifying Deep Generative Models</em> <a href="https://arxiv.org/abs/1706.00550" target="_blank" rel="noopener">[Paper]</a></li></ul><h4 id="Bidirectional-GANs"><a href="#Bidirectional-GANs" class="headerlink" title="Bidirectional GANs"></a>Bidirectional GANs</h4><ul><li><em>Adversarial Feature Learning</em> [[Paper]](Adversarial Feature Learning)</li><li><em>Adversarially Learned Inference</em> <a href="https://arxiv.org/abs/1606.00704" target="_blank" rel="noopener">[Paper]</a></li><li><em>It Takes (Only) Two: Adversarial Generator-Encoder Networks</em> <a href="https://arxiv.org/abs/1704.02304" target="_blank" rel="noopener">[Paper]</a></li></ul><h3 id="VAE-1"><a href="#VAE-1" class="headerlink" title="VAE"></a>VAE</h3><ul><li><em>Auto-Encoding Variational Bayes</em> <a href="https://arxiv.org/abs/1312.6114" target="_blank" rel="noopener">[Paper]</a></li></ul><h2 id="Class-Imbalance"><a href="#Class-Imbalance" class="headerlink" title="Class Imbalance"></a>Class Imbalance</h2><ul><li><em>Focal Loss for Dense Object Detection</em> <a href="https://arxiv.org/abs/1708.02002" target="_blank" rel="noopener">[Paper]</a></li><li><em>Gradient Harmonized Single-stage Detector</em> <a href="https://arxiv.org/abs/1811.05181" target="_blank" rel="noopener">[Paper]</a></li></ul><h2 id="Stochastic-Temporal-Modeling"><a href="#Stochastic-Temporal-Modeling" class="headerlink" title="Stochastic Temporal Modeling"></a>Stochastic Temporal Modeling</h2><ul><li><em>Sequential Neural Models with Stochastic Layers</em> <a href="https://arxiv.org/abs/1605.07571" target="_blank" rel="noopener">[Paper]</a></li><li><em>A Recurrent Latent Variable Model for Sequential Data</em> <a href="https://papers.nips.cc/paper/5653-a-recurrent-latent-variable-model-for-sequential-data" target="_blank" rel="noopener">[Paper]</a></li><li><em>Deep State Space Models for Time Series Forecasting</em> <a href="https://papers.nips.cc/paper/8004-deep-state-space-models-for-time-series-forecasting" target="_blank" rel="noopener">[Paper]</a></li><li><em>Bayesian Recurrent Neural Networks</em> <a href="https://arxiv.org/abs/1704.02798" target="_blank" rel="noopener">[Paper]</a></li></ul><h2 id="Detection-without-Closed-form-Likelihood"><a href="#Detection-without-Closed-form-Likelihood" class="headerlink" title="Detection without Closed-form Likelihood"></a>Detection without Closed-form Likelihood</h2><h3 id="Reconstruction"><a href="#Reconstruction" class="headerlink" title="Reconstruction"></a>Reconstruction</h3><ul><li><em>Adversarially Learned One-Class Classifier for Novelty Detection</em> <a href="https://arxiv.org/abs/1802.09088" target="_blank" rel="noopener">[Paper]</a></li><li><em>Generative Adversarial Network Based Novelty Detection Using Minimized Reconstruction Error</em> <a href="https://link.springer.com/article/10.1631/FITEE.1700786" target="_blank" rel="noopener">[Paper]</a></li><li><em>Learning Discriminative Reconstructions for Unsupervised Outlier Removal</em> <a href="https://ieeexplore.ieee.org/document/7410534" target="_blank" rel="noopener">[Paper]</a></li></ul><h3 id="Discriminator"><a href="#Discriminator" class="headerlink" title="Discriminator"></a>Discriminator</h3><ul><li><em>A Lipschitz-constrained Anomaly Discriminator Framework</em> <a href="https://arxiv.org/abs/1905.10710" target="_blank" rel="noopener">[Paper]</a></li></ul><h3 id="Out-of-distribution"><a href="#Out-of-distribution" class="headerlink" title="Out-of-distribution"></a>Out-of-distribution</h3><ul><li><em>Enhancing The Reliability of Out-of-distribution Image Detection in Neural Networks</em> <a href="https://arxiv.org/abs/1706.02690" target="_blank" rel="noopener">[Paper]</a></li><li><em>Learning Confidence for Out-of-Distribution Detection in Neural Networks</em> <a href="https://arxiv.org/abs/1802.04865" target="_blank" rel="noopener">[Paper]</a></li><li><em>A Baseline for Detecting Misclassified and Out-of-Distribution Examples in Neural Networks</em> <a href="https://arxiv.org/abs/1610.02136" target="_blank" rel="noopener">[Paper]</a></li><li><em>A Simple Unified Framework for Detecting Out-of-Distribution Samples and Adversarial Attacks</em> <a href="https://arxiv.org/abs/1807.03888" target="_blank" rel="noopener">[Paper]</a></li></ul><h2 id="GANs-for-Incomplete-Data"><a href="#GANs-for-Incomplete-Data" class="headerlink" title="GANs for Incomplete Data"></a>GANs for Incomplete Data</h2><ul><li><em>AmbientGAN: Generative Models From Lossy Measurements</em> <a href="https://openreview.net/forum?id=Hy7fDog0b" target="_blank" rel="noopener">[Paper]</a></li><li><em>MisGAN: Learning from Incomplete Data with Generative Adversarial Networks</em> <a href="https://openreview.net/forum?id=S1lDV3RcKm" target="_blank" rel="noopener">[Paper]</a></li></ul><h1 id="Dataset"><a href="#Dataset" class="headerlink" title="Dataset"></a>Dataset</h1><p>è¯¦è§<a href="http://qfxiao.me/2020/02/03/Datasets-for-Time-Series-Anomaly-Detection/ã€‚">http://qfxiao.me/2020/02/03/Datasets-for-Time-Series-Anomaly-Detection/ã€‚</a></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Deep Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE</title>
    <link href="/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/"/>
    <url>/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p><a href="https://ieeexplore.ieee.org/abstract/document/8737430/" target="_blank" rel="noopener">è®ºæ–‡ğŸ“ƒ</a></p><p><a href="https://github.com/yantijin/Buzz" target="_blank" rel="noopener">ä»£ç ğŸ“¥</a></p><p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§åˆ©ç”¨å¯¹æŠ—è®­ç»ƒæ¥è¿›è¡Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„æ–¹æ³•<em>Buzz</em>ã€‚ä½œè€…è®¤ä¸ºåœ¨ç°å®ä¸­å¤æ‚çš„KPIæ•°æ®å¤§é‡å­˜åœ¨ï¼Œè¿™ç§æ•°æ®é€šå¸¸å¸¦æœ‰éé«˜æ–¯åˆ†å¸ƒçš„å™ªå£°ï¼ŒåŒæ—¶æ•°æ®åˆ†å¸ƒå¤æ‚ï¼Œå¯¼è‡´ä¸€èˆ¬çš„ç”Ÿæˆå¼æ¨¡å‹æ— æ³•å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„å»ºæ¨¡ï¼Œæ‰€ä»¥ä½œè€…æå‡ºäº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„æ¨¡å‹ã€‚åœ¨æ–‡ä¸­ï¼Œä½œè€…çš„åˆ›æ–°ç‚¹ä¸»è¦æœ‰ä¸‰ä¸ªï¼š</p><ol><li>ä¸ºäº†å¤„ç†å¤æ‚æ•°æ®ï¼Œå°†æ•°æ®ç©ºé—´åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼Œåœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šè¿›è¡Œè·ç¦»çš„åº¦é‡ï¼›</li><li>é‡‡ç”¨<em>Wasserstein</em>è·ç¦»åº¦é‡æ¨¡å‹å»ºæ¨¡çš„åˆ†å¸ƒå’ŒçœŸå®åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼›</li><li>å»ºç«‹äº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„<em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒVAEä¹‹é—´çš„å…³ç³»ã€‚</li></ol><img src="https://i.loli.net/2020/06/25/FwHi7y56njz8R4m.png" srcset="/img/loading.gif" style="zoom:67%;" /><h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><h2 id="Anomaly-Detection"><a href="#Anomaly-Detection" class="headerlink" title="Anomaly Detection"></a>Anomaly Detection</h2><p>å¯¹äºä»»æ„æ—¶é—´$t$ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼$x_{t-T+1},\cdots,x_t$ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º$y_t=1$)ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚$p(y_t=1|x_{t-T+1},\cdots,x_t)$ã€‚</p><h2 id="VAE"><a href="#VAE" class="headerlink" title="VAE"></a>VAE</h2><table><thead><tr><th><strong>Model</strong></th><th><strong>Latent</strong></th><th><strong>Data</strong></th></tr></thead><tbody><tr><td><strong><em>Auto-encoder (AE)</em></strong></td><td><code>None</code></td><td><code>L1Loss</code></td></tr><tr><td><strong><em>Variational Auto-encoder (VAE)</em></strong></td><td><code>KL Divergence</code></td><td><code>Log Likelihood</code></td></tr><tr><td><strong><em>Adversarial Auto-encoder (AAE)</em></strong></td><td><code>Discriminator</code></td><td><code>L1Loss</code></td></tr><tr><td><strong><em>Wasserstein Auto-encoder (WAE)</em></strong></td><td><code>MaxMeanDiscrepancy</code> or <code>Discriminator</code></td><td><code>L1Loss</code></td></tr><tr><td><strong><em>AlphaGAN</em></strong></td><td><code>Discriminator</code></td><td><code>Discriminator</code>+<code>L1Loss</code></td></tr></tbody></table><h2 id="GAN-and-WGAN-GP"><a href="#GAN-and-WGAN-GP" class="headerlink" title="GAN and WGAN-GP"></a>GAN and WGAN-GP</h2><p>åŸå§‹GANç­‰ä»·äºä¼˜åŒ–ï¼š<br>$$<br>\mathbb{E}<em>{x\sim P_r}\log{\frac{P_r(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}+\mathbb{E}</em>{x\sim P_g}\log{\frac{P_g(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}<br>$$<br>æ ¹æ®KLæ•£åº¦å’ŒJSæ•£åº¦çš„å®šä¹‰ï¼š<br>$$<br>\text{KL}(P_1\parallel P_2)=\mathbb{E}_{x\sim P_1}\log{\frac{P_1}{P_2}}<br>$$</p><p>$$<br>\text{JS}(P_1\parallel P_2)=\frac{1}{2}\text{KL}(P_1\parallel \frac{P_1+P_2}{2})+\frac{1}{2}\text{KL}(P_2\parallel \frac{P_1+P_2}{2})<br>$$</p><p>å¯é‡å†™ä¸ºï¼š<br>$$<br>2\text{JS}(P_r\parallel P_g)-2\log 2<br>$$<br>å½“$P_r$ä¸$P_g$çš„æ”¯æ’‘é›†ï¼ˆsupportï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­çš„ä½ç»´æµå½¢ï¼ˆmanifoldï¼‰æ—¶ï¼Œ$P_r$ä¸$P_g$é‡å éƒ¨åˆ†æµ‹åº¦ï¼ˆmeasureï¼‰ä¸º0çš„æ¦‚ç‡ä¸º1ã€‚</p><ul><li>æ”¯æ’‘é›†ï¼ˆsupportï¼‰å…¶å®å°±æ˜¯å‡½æ•°çš„éé›¶éƒ¨åˆ†å­é›†ï¼Œæ¯”å¦‚<code>ReLU</code>å‡½æ•°çš„æ”¯æ’‘é›†å°±æ˜¯[å…¬å¼]ï¼Œä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„æ”¯æ’‘é›†å°±æ˜¯æ‰€æœ‰æ¦‚ç‡å¯†åº¦éé›¶éƒ¨åˆ†çš„é›†åˆã€‚</li><li>æµå½¢ï¼ˆmanifoldï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­æ›²çº¿ã€æ›²é¢æ¦‚å¿µçš„æ‹“å¹¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä½ç»´ä¸Šç›´è§‚ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œæ¯”å¦‚æˆ‘ä»¬è¯´ä¸‰ç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªæ›²é¢æ˜¯ä¸€ä¸ªäºŒç»´æµå½¢ï¼Œå› ä¸ºå®ƒçš„æœ¬è´¨ç»´åº¦ï¼ˆintrinsic dimensionï¼‰åªæœ‰2ï¼Œä¸€ä¸ªç‚¹åœ¨è¿™ä¸ªäºŒç»´æµå½¢ä¸Šç§»åŠ¨åªæœ‰ä¸¤ä¸ªæ–¹å‘çš„è‡ªç”±åº¦ã€‚åŒç†ï¼Œä¸‰ç»´ç©ºé—´æˆ–è€…äºŒç»´ç©ºé—´ä¸­çš„ä¸€æ¡æ›²çº¿éƒ½æ˜¯ä¸€ä¸ªä¸€ç»´æµå½¢ã€‚</li><li>æµ‹åº¦ï¼ˆmeasureï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­é•¿åº¦ã€é¢ç§¯ã€ä½“ç§¯æ¦‚å¿µçš„æ‹“å¹¿ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œè¶…ä½“ç§¯â€ã€‚</li></ul><p><em>Wasserstein</em>è·ç¦»å®šä¹‰å¦‚ä¸‹ï¼š<br>$$<br>W(P_r,P_g)=\inf\limits_{\gamma\sim\prod(P_r,P_g)}\mathbb{E}<em>{(x,y)\sim \gamma}\left[\parallel x-y\parallel\right]<br>$$<br>ä¸‹ç¡®ç•Œ$\inf$æ²¡æ³•ç›´æ¥æ±‚è§£ï¼Œä¸è¿‡æ ¹æ®ç›¸å…³å®šç†å…¶ç­‰ä»·äºï¼š<br>$$<br>W(P_r,P_g)=\frac{1}{K}\sup\limits</em>{\parallel f\parallel_L\leq K}\mathbb{E}<em>{x\sim P_r}[f(x)]-\mathbb{E}</em>{x\sim P_g}[f(x)]<br>$$<br><em>Lipschitz</em>è¿ç»­æ˜¯æŒ‡å­˜åœ¨ä¸€ä¸ªå¸¸æ•°$K\geq 0$ä½¿å¾—å®šä¹‰åŸŸå†…ä»»æ„ä¸¤ä¸ªå…ƒç´ $x_1$å’Œ$x_2$éƒ½æ»¡è¶³ï¼š<br>$$<br>|f(x_1)-f(x_2)|\leq K|x_1-x_2|<br>$$<br>WANçš„æŸå¤±å‡½æ•°ï¼š<br>$$<br>\mathcal{L}=\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}<em>g}\left[D({\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits</em>{\mathbf{x}\sim\mathbb{P}<em>r}\left[D(\mathbf{x})\right]<br>$$<br>WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>\mathcal{L}=\mathop{\mathbb{E}}\limits</em>{\tilde{\mathbf{x}}\sim\mathbb{P}<em>g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits</em>{\mathbf{x}\sim\mathbb{P}<em>r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits</em>{\hat{\mathbf{x}}\sim\mathbb{P}<em>{\hat{\mathbf{x}}}}\left[(\parallel\nabla</em>{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]<br>$$</p><h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1><p>ä¸‹å›¾ä¸º<em>Buzz</em>çš„æ€»ä½“æµç¨‹ï¼š</p><img src="https://i.loli.net/2020/06/25/aGPdzq8TVS6fetJ.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>æ•°æ®ä¼šé¦–å…ˆè¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼Œä¹‹åè¿›è¡Œè®­ç»ƒã€‚åœ¨æ£€æµ‹é˜¶æ®µä¼šæ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥åˆ¤å®šå¼‚å¸¸ã€‚</p><h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2><p>åœ¨æ–‡ä¸­ï¼Œæœ€å…³é”®çš„ä¸¤ä¸ªåˆ›æ–°ç‚¹åˆ†åˆ«æ˜¯<em>Wasserstein</em>è·ç¦»å’Œå¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œåˆ†åŒºçš„æ–¹æ³•ã€‚</p><ul><li><p>åœ¨ä½¿ç”¨è·ç¦»åº¦é‡æ–¹é¢ï¼Œ å› ä¸º<em>Wasserstein</em>åœ¨WGANä¸­å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœï¼Œæ˜¯ä¸€ç§é²æ£’çš„è·ç¦»åº¦é‡ï¼Œæ‰€ä»¥ä½œè€…åœ¨æ–‡ä¸­é‡‡ç”¨äº†<em>Wasserstein</em>è·ç¦»æ¥è¡¡é‡ç”Ÿæˆçš„åˆ†å¸ƒå’ŒçœŸå®çš„åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå¹¶ç”±æ­¤å¼•å…¥äº†å¯¹æŠ—è®­ç»ƒï¼›</p></li><li><p>åœ¨åˆ†åŒºæ–¹æ³•æ–¹é¢ï¼Œä½œè€…è®¤ä¸ºåŸå§‹æ•°æ®è¿‡äºå¤æ‚ï¼Œæ‰€ä»¥å°†æ•°æ®ç©ºé—´$\mathcal{X}$è¿›è¡Œåˆ’åˆ†ï¼Œç„¶ååœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šä½¿ç”¨<em>Wasserstein</em>åº¦é‡è·ç¦»ï¼Œè€Œæ€»ä½“çš„è·ç¦»ç”±æ¯ä¸ªåˆ†åŒºçš„è·ç¦»çš„æœŸæœ›æ±‚å¾—ã€‚</p></li></ul><p>ä½œè€…è¿˜å‘ç°ï¼Œå½“åˆ’åˆ†åœ°è¶Šæ¥è¶Šç»†æ—¶ï¼Œæ€»ä½“è·ç¦»æ¥è¿‘äºç‰¹å®šå½¢å¼çš„VAEçš„é‡æ„è¯¯å·®é¡¹ã€‚</p><img src="https://i.loli.net/2020/06/25/knzq4yPaBrXWgeI.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Network-Structure"><a href="#Network-Structure" class="headerlink" title="Network Structure"></a>Network Structure</h2><p>ä¸‹å›¾ä¸ºæ¨¡å‹çš„ç½‘ç»œç»“æ„ï¼š</p><img src="https://i.loli.net/2020/06/25/Qrgpuh4Iw7YTlny.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h2><h3 id="Objective-Function"><a href="#Objective-Function" class="headerlink" title="Objective Function"></a>Objective Function</h3><p>å…ˆå®šä¹‰ä¸€äº›ç¬¦å·ï¼š</p><ul><li>$b$å’Œ$s$åˆ†åˆ«ä¸ºBatchçš„å¤§å°å’Œé‚»å±…çš„å¤§å°ï¼Œæ•°æ®é›†æŒ‰$s$è¿›è¡Œåˆ‡åˆ†ï¼Œç„¶åéšæœºæ‰“ä¹±ï¼Œæ¯ä¸ªBatchåŒ…å«$b$ä¸ª$s$ï¼Œä¹‹å$s/=2,b*=2$ï¼›</li><li>$\mathcal{W}={w_1,w_2,\cdots,w_b}$ä¸ºä¸€ä¸ªBatchï¼Œä¸”æ»¡è¶³æ¯ä¸ª$w_i$æ˜¯$s$çš„å€æ•°ï¼›</li><li>$w\in\mathcal{W}$çš„é‚»åŸŸé›†(neighborhood set)ä¸ºä¸€ä¸ªæ—¶é—´ä¸Šçš„partitionï¼Œè®°ä¸º${w,w+1,\cdots,w+s-1}$</li><li>$\mathbf{x}^{(w)},\mathbf{x}^{(w+1)},\cdots,\mathbf{x}^{(w+s-1)}$ä¸ºåœ¨ç©ºé—´$\mathcal{X}$ä¸Šçš„ä¸€ä¸ªpartitionï¼Œè®°ä¸º$S_w$ï¼Œå…¶ä¸­$\mathbf{x}^{(w)}$è¡¨ç¤ºä»¥$w$ä¸ºç»“å°¾çš„æ—¶é—´çª—å£ã€‚</li></ul><p><em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒWGAN-GPç±»ä¼¼ï¼Œä½†åšäº†ä¸€äº›æ”¹è¿›ï¼Œç”±ä¸‹é¢å››éƒ¨åˆ†ç»„æˆï¼Œä¸‹é¢åˆ†åˆ«è§£é‡Šã€‚</p><p>ç¬¬ä¸€ä¸ªæ˜¯æ¯ä¸€ä¸ªpartitionçš„$\mathbf{z}$åéªŒçš„KLæ•£åº¦ï¼š<br>$$<br>\mathcal{K} = \frac{1}{bs}\sum\limits_{w\in\mathcal{W}}\sum\limits_{i=1}^{s-1}\text{KL}\left[q_\phi(\mathbf{z}|\mathbf{x})\parallel\mathcal{N}(\mathbf{0},\mathbf{1})\right]<br>$$</p><p>ç¬¬äºŒä¸ªåœ¨è®­ç»ƒæ—¶æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼š<br>$$<br>Z(\lambda) = \frac{\Gamma(W)}{\Gamma(\frac{W}{2})}2\pi^{\frac{W}{2}}\lambda^{-W}<br>$$</p><p>å…¶ä¸­$\Gamma$æ˜¯<em>Gamma</em>å‡½æ•°ã€‚</p><p>ç¬¬ä¸‰ä¸ªæ˜¯<em>Wasserstein</em>è·ç¦»ï¼š<br>$$<br>\mathcal{T}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}_{q_\phi(\mathbf{z}|\mathbf{x}^{w+i})}\left[F(\mathbf{x}^{(w+i)})-F(G(\mathbf{z}))\right]<br>$$</p><p>ç¬¬å››ä¸ªæ˜¯<em>Gradient Penalty</em>ï¼š</p><p>$$<br>\mathcal{R}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}<em>{q_\phi(\mathbf{z}|\mathbf{x}^{(w+i)})}\left[\mathbb{E}</em>{\varepsilon\sim[0,1]}(\parallel\nabla_{\hat{\mathbf{x}}}(\hat{\mathbf{x}})\parallel-\mathbf{1})^2\right]<br>$$</p><p>å…¶ä¸­$\hat{\mathbf{x}}=\varepsilon \mathbf{x}^{w+i}+(1-\varepsilon)G(\mathbf{z})$ä¸ºç”Ÿæˆæ•°æ®ä¸çœŸå®æ•°æ®çš„æ’å€¼ã€‚</p><blockquote><p>åŸå§‹çš„WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>L=\mathop{\mathbb{E}}\limits_{\tilde{\mathbf{x}}\sim\mathbb{P}<em>g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits</em>{\mathbf{x}\sim\mathbb{P}<em>r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits</em>{\hat{\mathbf{x}}\sim\mathbb{P}<em>{\hat{\mathbf{x}}}}\left[(\parallel\nabla</em>{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]<br>$$<br>å…¶ä¸­$\mathbb{P}<em>g$ä¸ºç”Ÿæˆå™¨çš„åˆ†å¸ƒï¼Œ$\mathbb{P}_r$ä¸ºçœŸå®åˆ†å¸ƒï¼Œ$\mathbb{P}</em>{\hat{\mathbf{x}}}$ä¸ºçœŸå®æ•°æ®å’Œç”Ÿæˆæ•°æ®æ’å€¼å¾—åˆ°çš„åˆ†å¸ƒã€‚</p></blockquote><p>$$<br>\hat{\mathcal{L}}<em>{Buzz}=-\lambda\sup\limits_F\left[\sum\limits</em>{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)<br>$$</p><h3 id="Training-Procedure"><a href="#Training-Procedure" class="headerlink" title="Training Procedure"></a>Training Procedure</h3><p><em>Buzz</em>çš„è®­ç»ƒè¿‡ç¨‹ä¸WGAN-GPç±»ä¼¼ï¼Œ</p><h2 id="Detection"><a href="#Detection" class="headerlink" title="Detection"></a>Detection</h2><p>æ–‡ä¸­å‡è®¾è§£ç å™¨çš„è¾“å‡ºæœä»å¦‚ä¸‹åˆ†å¸ƒï¼š</p><p>$$<br>p_\theta(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel}<br>$$</p><p>ä½œè€…å®šä¹‰å¼‚å¸¸åˆ†æ•°ä¸ºï¼š<br>$$<br>\mathcal{S}=\log p_\theta(\mathbf{x})-\log p_\theta(\bar{\mathbf{x}})<br>$$<br>å…¶ä¸­$\bar{\mathbf{x}}$ä¸ºç»è¿‡MCMCå¡«å……åçš„æ ·æœ¬ã€‚</p><p>å¼‚å¸¸åˆ†æ•°ä¹Ÿå¯ä»¥å±•å¼€ä¸ºï¼š<br>$$<br>\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\mathbf{x}|\mathbf{z^{(l)}})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]-\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\bar{\mathbf{x}}|\mathbf{z}^{(l)})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]<br>$$</p><p>æœ€ç»ˆç®—æ³•æµç¨‹å›¾ä¸ºï¼š</p><img src="https://i.loli.net/2020/06/25/Y3NLjRiaWO5eHGT.png" srcset="/img/loading.gif" style="zoom:80%;" /><h2 id="Theoretical-Analysis"><a href="#Theoretical-Analysis" class="headerlink" title="Theoretical Analysis"></a>Theoretical Analysis</h2><p>åœ¨ç†è®ºåˆ†æä¸­ï¼Œä½œè€…ä¸»è¦æ˜¯æƒ³å»ºç«‹$\mathcal{L}<em>{Buzz}$å’ŒVAEçš„æŸå¤±å‡½æ•°$\mathcal{L}</em>{vae}$ä¹‹é—´çš„è”ç³»ï¼ŒæŸå¤±å‡½æ•°$\mathcal{\hat{L}}_{Buzz}$ä¸ºï¼š</p><p>$$<br>\hat{\mathcal{L}}<em>{Buzz}=-\lambda\sup\limits_F\left[\sum\limits</em>{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)<br>$$</p><p>ä¸ºäº†ä¾¿äºåˆ†æï¼Œå»æ‰<em>Gradient Penalty</em>çš„éƒ¨åˆ†ï¼Œå…¬å¼å¯ç®€åŒ–ä¸ºï¼š</p><p>$$<br>\mathcal{L}<em>{Buzz}=-\lambda\mathbb{E}</em>{p(w)}W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]-\mathcal{K}-\log Z(\lambda)<br>$$</p><p>å®é™…ä¸Š$Z(\lambda)=\mathfrak{S}_W\Gamma(W)\lambda^{-W}$ï¼Œå…¶ä¸­$\mathfrak{S}_W$ä¸º$W$ç»´å•ä½çƒçš„è¡¨é¢ç§¯ã€‚</p><blockquote><p>$n$ç»´ç©ºé—´å•ä½çƒè¡¨é¢ç§¯å…¬å¼ï¼š<br>$$<br>\omega_n=\frac{2\pi^{\frac{n}{2}}}{\Gamma(\frac{n}{2})}<br>$$</p></blockquote><p>è€Œ$W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]$ä¸º<em>Wasserstein</em>è·ç¦»ï¼š<br>$$<br>W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]=\sup\limits_{Lip(f)\leq 1}\left{\int_\mathcal{X}f(\mathbf{x})p(\mathbf{x}|w)\mathrm{d}\mathbf{x}-\int_\mathcal{X}f(\mathbf{y})p(\mathbf{y}|w)\mathrm{d}\mathbf{y}\right}<br>$$</p><h3 id="Lemma-1"><a href="#Lemma-1" class="headerlink" title="Lemma 1"></a>Lemma 1</h3><p>é€šè¿‡è®¾å®šå…·ä½“å½¢å¼çš„åéªŒåˆ†å¸ƒï¼ŒVAEçš„æŸå¤±å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p><blockquote><p>è®¾$\mathbf{x}$çš„åéªŒåˆ†å¸ƒ$p(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel}$ï¼Œé‚£ä¹ˆVAEçš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>\mathcal{L}<em>{vae}=\lambda\mathbb{E}</em>{p(w)}\left[\mathbb{E}<em>{p(\mathbf{x}|w)}\mathbb{E}</em>{p_G(\mathbf{y}|\mathbf{x})}-\parallel\mathbf{x}-\mathbf{y}\parallel\right]-\mathcal{K}-\log{Z(\lambda)}<br>$$</p></blockquote><p>åéªŒåˆ†å¸ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªLaplaceåˆ†å¸ƒï¼š</p><blockquote><p><strong>Laplace Distribution</strong>:<br>$$<br>f(x|\theta,\lambda)=\frac{1}{2\lambda}\exp{\left(-\frac{|x-\theta|}{\lambda}\right)}<br>$$</p></blockquote><p>å¯ä»¥ç›´æ¥æŠŠåéªŒåˆ†å¸ƒå¸¦å…¥VAEçš„æŸå¤±å‡½æ•°å°±å¾—åˆ°äº†ã€‚</p><h3 id="Lemma-2"><a href="#Lemma-2" class="headerlink" title="Lemma 2"></a>Lemma 2</h3><p>$S_w$å®šä¹‰ä¸ºæ•°æ®ç©ºé—´$\mathcal{X}$çš„ä¸€ä¸ªpartitionï¼Œè€Œ$S={(\mathbf{x}_1,\mathbf{x}_2)| \exists w, \mathbf{x}_1\in S_w,\mathbf{x}_2\in S_w}$ã€‚</p><blockquote><p>å½“$G,\phi,\lambda$å›ºå®šæ—¶ï¼Œ$S\downarrow$æœ‰$\mathcal{L}_{Buzz}\downarrow$</p></blockquote><h3 id="Lemma-3"><a href="#Lemma-3" class="headerlink" title="Lemma 3"></a>Lemma 3</h3><blockquote><p>$\max\mathcal{L}<em>{Buzz}\geq\max{\mathcal{L}</em>{vae}}$ï¼ŒåŒæ—¶ï¼Œå½“$S\downarrow\text{diag}{\mathcal{X}}$æ—¶$\max\mathcal{L}<em>{Buzz}\downarrow\max\mathcal{L}</em>{vae}$</p></blockquote><img src="https://i.loli.net/2020/06/25/XM2xwBbOLzikhoc.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Lemma-4"><a href="#Lemma-4" class="headerlink" title="Lemma 4"></a>Lemma 4</h3><blockquote><p>ä»¤$p^\prime_G(\mathbf{y}|\mathbf{x})$è¡¨ç¤º$\mathbb{E}<em>{q</em>{\phi^\prime}}\left[p_G(\mathbf{y}|\mathbf{z})\right]$ã€‚å¦‚æœ$(G,\phi,\lambda)$æ˜¯ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆå­˜åœ¨$(G,\phi^\prime,\lambda)$ä½¿å¾—ï¼š<br>$$<br>\mathbb{E}<em>{p(\mathbf{x}|w)}\mathbb{E}</em>{p_G^\prime(\mathbf{y}|\mathbf{x})}\parallel\mathbf{x}-\mathbf{y}\parallel=W^1\left[P(\mathbf{x}|w)\parallel P_G(\mathbf{y}|w)\right]<br>$$<br>æ­¤æ—¶$\mathcal{L}<em>{Buzz}-\mathcal{L}</em>{vae}^\prime=\mathcal{K}^\prime-\mathcal{K}$ï¼Œå…¶ä¸­$\mathcal{L}^\prime,\mathcal{K}^\prime$åˆ†åˆ«ä¸º$(G,\phi^\prime,\lambda)$æ—¶çš„$\mathcal{L}$å’Œ$\mathcal{K}$ã€‚</p></blockquote><p>$$<br>\mathcal{L}^\dagger_{Buzz}=\mathbb{E}<em>{p(\mathbf{x})}\left[\mathbb{E}</em>{q_{\phi^\prime}(\mathbf{z}|\mathbf{x})}\log_{p_\theta}(\mathbf{x}|\mathbf{z})\right]-\min\limits_{\bar{\phi}\sim\phi^\prime}\bar{\mathcal{K}}<br>$$</p><h3 id="Lemma-5"><a href="#Lemma-5" class="headerlink" title="Lemma 5"></a>Lemma 5</h3><p>è¿™é‡Œä¸»è¦æ˜¯æƒ³è¯æ˜</p><blockquote><p>å¯¹äºå›ºå®šçš„$w$ï¼Œä»¤ï¼š<br>$$<br>\mathcal{F}={f|Lip(f)\leq 1}, \space \mathcal{F}^<em>=\left{f|<em>{S_w}\bigg|Lip(f|</em>{S_w})\leq 1\right}<br>$$<br>æœ‰$\sup_{f\in\mathcal{F}}\mathcal{T}(f)=\sup_{f|_{S_w}\in\mathcal{F}^</em>}\mathcal{T}^*\left(f|_{S_w}\right)$ã€‚</p></blockquote><h3 id="Theorem-6"><a href="#Theorem-6" class="headerlink" title="Theorem 6"></a>Theorem 6</h3><blockquote><p>$\mathcal{L}<em>{Buzz}$çš„å¯¹å¶å½¢å¼ä¸ºï¼š<br>$$<br>\mathcal{L}</em>{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}^*(F)-\mathcal{K}-\log Z(\lambda)<br>$$</p></blockquote><p>è¿‘ä¼¼çš„$\mathcal{L}<em>{Buzz}$çš„å¯¹å¶å½¢å¼ä¸ºï¼š<br>$$<br>\bar{\mathcal{L}}</em>{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}(F)-\mathcal{K}-\log Z(\lambda)<br>$$</p><h1 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h1><img src="https://i.loli.net/2020/06/25/GEi3zfeAgXVsvBN.png" srcset="/img/loading.gif" style="zoom:67%;" /><img src="https://i.loli.net/2020/06/25/7EkhRGNvIsSmwn6.png" srcset="/img/loading.gif" style="zoom:67%;" /><img src="https://i.loli.net/2020/06/25/yTIhoZb1kVOf4Mv.png" srcset="/img/loading.gif" style="zoom:67%;" />]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>VAE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Variational Approaches for Auto-Encoding Generative Adversarial Networks</title>
    <link href="/2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/"/>
    <url>/2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/</url>
    
    <content type="html"><![CDATA[<h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>æœ¬æ–‡æ­ç¤ºäº†å¯¹æŠ—ç”Ÿæˆç½‘ç»œï¼ˆGenerative Adversarial Networks, GANï¼‰å’Œå˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational Auto-encoders, VAEï¼‰ä¹‹é—´çš„è”ç³»ï¼Œå¹¶æ®æ­¤æå‡ºäº†ä¸€ç§å°†ä¸¤è€…ç»“åˆçš„æ–°æ¨¡å‹ã€‚æ–‡ä¸­ä¸»è¦æ˜¯å°†ä¸å¯è§£çš„ä¼¼ç„¶å‡½æ•°å’ŒæœªçŸ¥çš„åéªŒåˆ†å¸ƒç”¨ä¸€ä¸ªéç¡®å®šçš„åˆ†å¸ƒï¼ˆImmplicit Distributionï¼‰æ›¿ä»£ï¼Œå¹¶åŠ å…¥åˆ¤åˆ«å™¨æ¥ä½¿å¾—è¯¥åˆ†å¸ƒé€¼è¿‘çœŸå®çš„åˆ†å¸ƒã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œä½œè€…å°†VAEä¸­çš„æŸå¤±å‡½æ•°è¿›è¡Œäº†æ›¿æ¢ï¼Œå˜æˆäº†GANä¸­çš„â€œç”Ÿæˆ-åˆ¤åˆ«â€æ¨¡å¼ã€‚</p><p><a href="https://arxiv.org/abs/1706.04987" target="_blank" rel="noopener">åŸæ–‡</a></p><h1 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h1><p>æœ¬æ–‡æœ‰å¦‚ä¸‹è´¡çŒ®ï¼š</p><ul><li>æœ¬æ–‡æå‡ºå˜åˆ†æ¨æ–­ï¼ˆVariational Inferenceï¼‰ä¹Ÿèƒ½é€šè¿‡å¯¹éç¡®å®šåˆ†å¸ƒçš„ä¼°è®¡åº”ç”¨åœ¨GANä¸­ï¼›</li><li>åŸºäºä¼¼ç„¶çš„æ¨¡å‹ï¼ˆLikelihood-based Modelsï¼‰å’Œéä¼¼ç„¶æ¨¡å‹ï¼ˆLikelihood-free Modelsï¼‰èƒ½å¤Ÿé€šè¿‡å¯¹æŠ—å­¦ä¹ ç»“åˆèµ·æ¥ï¼›</li><li>ä½œè€…æ ¹æ®æ–‡ä¸­æå‡ºçš„æ–°è§‚ç‚¹ä¿®æ”¹äº†VAEçš„æŸå¤±å‡½æ•°ï¼Œå°†å…¶ç§°ä¹‹ä¸ºAuto-encoding GAN ($\alpha$-GAN)ï¼Œå¹¶æå‡ºäº†å¯¹åº”çš„å®ç”¨çš„æ”¹è¿›ï¼›</li><li>æœ¬æ–‡ä¸ä¼—å¤šState-of-Artæ¨¡å‹è¿›è¡Œäº†å¯¹æ¯”</li></ul><h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Overcoming-Intractability-in-Generative-Models"><a href="#Overcoming-Intractability-in-Generative-Models" class="headerlink" title="Overcoming Intractability in Generative Models"></a>Overcoming Intractability in Generative Models</h2><h3 id="Latent-Variable-Models"><a href="#Latent-Variable-Models" class="headerlink" title="Latent Variable Models"></a>Latent Variable Models</h3><p>éšå˜é‡æ¨¡å‹é€šè¿‡éšå˜é‡çš„å½¢å¼æè¿°äº†æ•°æ®çš„äº§ç”Ÿè¿‡ç¨‹ã€‚æœ€ç®€å•çš„å½¢å¼æ˜¯å‡è®¾éšå˜é‡$\mathbf{z}$æœä»ä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒ$\mathbf{z}\sim p(\mathbf{z})$ï¼Œè€Œæ•°æ®$\mathbf{x}$ä»æ¡ä»¶åˆ†å¸ƒ$p(\mathbf{x}|\mathbf{z})$æŠ½æ ·äº§ç”Ÿã€‚é€šå¸¸æ¥è¯´æè¿°$p(\mathbf{x}|\mathbf{z})$çš„æ¨¡å‹ç§°ä¸ºç”Ÿæˆå™¨$\mathcal{G}_\theta(\mathbf{z})$ï¼Œå¸¦æœ‰å¯ä¼˜åŒ–çš„å‚æ•°$\theta$ï¼Œè€Œ$\mathbf{z}$é€šå¸¸å‡è®¾ä¸ºæ­£æ€åˆ†å¸ƒ$\mathbf{z}\sim\mathcal{N}(\mathbf{0},\mathbf{I})$ã€‚</p><p>æ–‡ä¸­åŒºåˆ†äº†ä¸¤ç§éšå˜é‡æ¨¡å‹ï¼Œä¸€ç§æ˜¯<em>Implicit Latent Variable Models</em>ï¼Œä¸€ç§æ˜¯<em>Prescribed Latent Variable Models</em>ã€‚æ–‡ä¸­çš„æè¿°ä¸å¤ªæ¸…æ¥šï¼Œä¸ªäººè®¤ä¸ºä¸¤è€…çš„åŒºåˆ«æ˜¯å‰è€…å›¾æ¨¡å‹ä¸­çš„$\mathbf{x}$ä¸æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œåœ¨ä¼˜åŒ–çš„æ—¶å€™éœ€è¦ç”¨ä¸€ä¸ªåˆ»ç”»ç”Ÿæˆçš„$\mathbf{x}$å’ŒçœŸå®çš„$\mathbf{x}$çš„å·®åˆ«çš„å‡½æ•°$\delta(\mathbf{x}-\mathcal{G}_\theta(\mathbf{z}))$ï¼Œè€Œåè€…å›¾æ¨¡å‹ä¸­$\mathbf{x}$æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œè¿™æ ·å¯ä»¥å†™å‡ºä¼¼ç„¶å‡½æ•°ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p><p>æ— è®ºæ˜¯GANè¿˜æ˜¯VAEéƒ½éœ€è¦é€šè¿‡è¾¹ç¼˜åˆ†å¸ƒ$p_\theta(\mathbf{x})$æ¥åˆ»ç”»å»ºæ¨¡çš„å¥½åï¼Œæ¯”å¦‚è¯´æ ¹æ®$p_\theta(\mathbf{x})$ä¸çœŸå®åˆ†å¸ƒ$p^<em>_\theta(\mathbf{x})$ä¹‹é—´çš„KLæ•£åº¦$\text{KL}\left[p_\theta(\mathbf{x})\parallel p_\theta^</em>(\mathbf{x})\right]$ã€‚ä½†é€šå¸¸æƒ…å†µä¸‹$p_\theta(\mathbf{x})$éƒ½æ˜¯ä¸å¯è§£çš„ï¼Œè€ŒGANå’ŒVAEé€šè¿‡ä¸åŒçš„é€”å¾„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="Generative-Adversarial-Networks"><a href="#Generative-Adversarial-Networks" class="headerlink" title="Generative Adversarial Networks"></a>Generative Adversarial Networks</h3><p>GANæ²¡æœ‰ç›´æ¥è®¡ç®—$p_\theta(\mathbf{x})$ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªåˆ¤åˆ«å™¨æ¥åˆ¤åˆ«æ ·æœ¬æ˜¯ä»$p_\theta(\mathbf{x})$è¿˜æ˜¯$p_\theta^<em>(\mathbf{x})$é‡‡æ ·å¾—åˆ°çš„ï¼Œå¦‚æœåˆ¤åˆ«å™¨æ— æ³•è¿›è¡ŒåŒºåˆ†ï¼Œé‚£æˆ‘ä»¬è®¤ä¸ºæ­¤æ—¶$p_\theta(\mathbf{x})\approx p_\theta^</em>(\mathbf{x})$ã€‚</p><p>ä»¤éšæœºå˜é‡$y\in{0,1}$ï¼Œ$y=1$è¡¨ç¤ºæ ·æœ¬$\mathbf{x}$æ¥è‡ªçœŸå®åˆ†å¸ƒï¼Œ$y=0$è¡¨ç¤ºæ ·æœ¬$\mathbf{x}$æ¥è‡ªç”Ÿæˆåˆ†å¸ƒï¼Œè€Œåˆ¤åˆ«å™¨çš„è¾“å‡ºä¸º$\mathbf{x}$æ¥è‡ªçœŸå®åˆ†å¸ƒçš„æ¦‚ç‡$\mathcal{D}<em>\phi(\mathbf{x})=p(y=1|\mathbf{x})$ã€‚GANé€šè¿‡å¯¹æ¥è‡ªçœŸå®åˆ†å¸ƒå’Œç”Ÿæˆåˆ†å¸ƒçš„æ ·æœ¬æ±‚äºŒå…ƒäº¤å‰ç†µæ¥ä½œä¸ºåˆ¤åˆ«å™¨æŸå¤±å‡½æ•°ï¼š<br>$$<br>\textbf{Discriminator Loss: }\mathbb{E}</em>{p^*(\mathbf{x})}[-\log\mathcal{D}<em>\phi(\mathbf{x})]+\mathbb{E}</em>{p_\theta(\mathbf{x})}[-\log(1-\mathcal{D}_\phi(\mathbf{x}))]<br>$$</p><p>ç”Ÿæˆå™¨å°†æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬åˆ¤å®šä¸ºçœŸçš„æ¦‚ç‡ä½œä¸ºæŸå¤±å‡½æ•°ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªç­‰ä»·çš„ä½†åœ¨å®è·µä¸­è¡¨ç°æ›´å¥½çš„æ›¿ä»£ç‰ˆæœ¬ï¼š</p><p>$$<br>\textbf{Generator Loss: }\mathbb{E}<em>{p_\theta(\mathbf{x})}[\log(1-\mathcal{D}_\phi(\mathbf{x}))];\textbf{ Alternative Loss: }\mathbf{E}</em>{p_\theta(\mathbf{x})}[-\log\mathcal{D}_\phi(\mathbf{x})]<br>$$</p><h3 id="The-Density-Ratio-Trick"><a href="#The-Density-Ratio-Trick" class="headerlink" title="The Density Ratio Trick"></a>The Density Ratio Trick</h3><p>ä»¤$p^<em>(\mathbf{x})=p(\mathbf{x}|y=1)$ï¼Œ$p_\theta(\mathbf{x})=p(\mathbf{x}|y=0)$ã€‚å®šä¹‰*Density Ratio</em> $r_\phi(\mathbf{x})$ä¸ºçœŸå®åˆ†å¸ƒå’Œç”Ÿæˆåˆ†å¸ƒä¹‹é—´çš„æ¯”ä¾‹ï¼š</p><p>$$<br>r_\phi(\mathbf{x})=\frac{p^*(\mathbf{x})}{p_\theta(\mathbf{x})}=\frac{p(\mathbf{x}|y=1)}{p(\mathbf{x}|y=0)}=\frac{p(y=1|\mathbf{x})}{p(y=0|\mathbf{x})}=\frac{\mathcal{D}_\phi(\mathbf{x})}{1-\mathcal{D}_\phi(\mathbf{x})}<br>$$</p><p>ä¸Šå¼è¡¨æ˜äº†<em>Density Ratio*çš„è®¡ç®—å¯ä»¥ä»…é€šè¿‡ä»ä¸¤ä¸ªåˆ†å¸ƒä¸Šé‡‡æ ·å¾—åˆ°çš„æ ·æœ¬åŠ ä¸Šä¸€ä¸ªäºŒåˆ†ç±»å™¨$\mathcal{D}_\phi(\mathbf{x})$å®ç°ï¼ˆå‡è®¾$p(y=0)=p(y=1)$ï¼‰ã€‚æ›´æ·±å…¥çš„è¯´ï¼Œå¯¹äºä¸å¯è§£çš„åˆ†å¸ƒ$p_\theta^</em>(\mathbf{x})$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—<em>Density Ratio*æ¥äº†è§£æˆ‘ä»¬è¿‘ä¼¼çš„åˆ†å¸ƒ$p_\theta(\mathbf{x})$å’ŒçœŸå®çš„$p_\theta^</em>(\mathbf{x})$ä¹‹é—´çš„ç›¸å¯¹æ€§ã€‚è€Œä¸”æˆ‘ä»¬åªéœ€è¦èƒ½å¤Ÿåœ¨ä¸¤ä¸ªåˆ†å¸ƒä¸Šè¿›è¡Œé‡‡æ ·ï¼Œå¹¶ä¸”è®­ç»ƒä¸€ä¸ªåˆ¤åˆ«å™¨å³å¯ã€‚å› ä¸ºåˆ¤åˆ«å™¨æ˜¯ä¸€ä¸ªæ™®é€šçš„åˆ†ç±»å™¨ï¼Œæ‰€ä»¥å¤§é‡çš„ä¸»æµåˆ†ç±»å™¨éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p><h3 id="Variational-Inference"><a href="#Variational-Inference" class="headerlink" title="Variational Inference"></a>Variational Inference</h3><p>ç°åœ¨æ¥çœ‹VAEï¼Œå¦ä¸€ç§è§£å†³ä¸å¯è§£åˆ†å¸ƒçš„æ–¹æ³•æ˜¯è¿‘ä¼¼ã€‚<em>Variational Inference</em>é€šè¿‡å¼•å…¥ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ$q_\eta(\mathbf{z}|\mathbf{x})$æ¨å‡ºäº†ä¸å¯è§£çš„$\mathbf{x}$çš„å¯¹æ•°ä¼¼ç„¶çš„ä¸‹ç•Œï¼ˆå¸¸è¢«ç§°ä¸ºè¯æ®ä¸‹ç•ŒELBOï¼‰ï¼š</p><p>$$<br>\log p_\theta(\mathbf{x})=\log\int p_\theta(\mathbb{x}|\mathbb{z})p(\mathbf{z})\text{d}\mathbf{z}\geq \mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log p_\theta(\mathbf{x}|\mathbf{z})\right]-\text{KL}\left[q_\eta(\mathbf{z}|\mathbf{x})\parallel p(\mathbf{z})\right]=\mathcal{F}(\boldsymbol{\theta}, \boldsymbol{\eta})<br>$$</p><p>VAEæ˜¯<em>Variational Inference</em>çš„ä¸€ç§å®ç°ï¼Œå˜åˆ†åˆ†å¸ƒé€šè¿‡ä¸€ä¸ªç¥ç»ç½‘ç»œè¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ä¸”å»ºç«‹èµ·äº†å®Œæ•´çš„å¯ä¼˜åŒ–çš„æ¨¡å‹ã€‚</p><h3 id="Synthetic-Likelihood"><a href="#Synthetic-Likelihood" class="headerlink" title="Synthetic Likelihood"></a>Synthetic Likelihood</h3><p>å½“ä¼¼ç„¶å‡½æ•°æœªçŸ¥ï¼ˆGANä¸­æ²¡æœ‰æ˜¾å¼çš„ä¼¼ç„¶å‡½æ•°ï¼Œè€ŒVAEä¸­æœ‰ï¼‰çš„æ—¶å€™ï¼Œ<em>Variational Inference*ä¾¿æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚å¯¹äºæ²¡æœ‰æ˜¾å¼çš„ä¼¼ç„¶å‡½æ•°çš„æƒ…å†µï¼Œä»¥VAEçš„ELBOçš„ç¬¬ä¸€é¡¹ä¸ºä¾‹ï¼Œå‡è®¾$p_\theta(\mathbf{x}|\mathbf{z})$åˆ†å¸ƒçš„å…·ä½“å½¢å¼æœªçŸ¥ï¼Œæˆ‘ä»¬åªæœ‰ä»$p_\theta(\mathbf{x}|\mathbf{z})$é‡‡æ ·å¾—åˆ°çš„æ ·æœ¬ï¼Œå¦‚ä½•è®¡ç®—$\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}[\log p_\theta(\mathbf{x}|\mathbf{z})]$å‘¢ï¼Ÿä¸€ä¸ªæ–¹æ³•æ˜¯ä¹˜ä»¥$p_\theta^</em>(\mathbf{x})$å†é™¤ä»¥$p_\theta^*(\mathbf{x})$ï¼š</p><p>$$<br>\mathbb{E}<em>{q_\eta(\mathbf{z}|\mathbf{x})}[\log p_\theta(\mathbf{x}|\mathbf{z})]=\mathbb{E}</em>{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{p_\theta(\mathbf{x}|\mathbf{z})}{p^<em>(\mathbf{x})}\right]+\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}[\log p^</em>(\mathbf{x})]<br>$$</p><p>å…¬å¼(5)ä¸­çš„ç¬¬ä¸€é¡¹åŒ…æ‹¬äº†åˆæˆä¼¼ç„¶$R(\theta)=\frac{p_\theta(\mathbf{x}|\mathbf{z})}{p^*(\mathbf{x})}$ï¼Œä¼˜åŒ–$R(\theta)$ç›¸å½“äºä¼˜åŒ–$\log p_\theta(\mathbf{x}|\mathbf{z})$ã€‚ç¬¬äºŒé¡¹ä¸ç”Ÿæˆç½‘ç»œçš„å‚æ•°$\theta$æ— å…³ï¼Œæ‰€ä»¥åœ¨ä¼˜åŒ–çš„æ—¶å€™å¯ä»¥å¿½ç•¥ã€‚</p><h2 id="A-Fusion-of-Variational-and-Adversarial-Learning"><a href="#A-Fusion-of-Variational-and-Adversarial-Learning" class="headerlink" title="A Fusion of Variational and Adversarial Learning"></a>A Fusion of Variational and Adversarial Learning</h2><p>GANå’ŒVAEåˆ†åˆ«ä»ä¸åŒçš„è§’åº¦è§£å†³äº†ç”Ÿæˆæ¨¡å‹çš„æ¨æ–­é—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹é¢ä»VAEå‡ºå‘ï¼Œè€ƒè™‘å°†ä¸¤è€…ç»“åˆèµ·æ¥ã€‚</p><h3 id="Implicit-Variational-Distributions"><a href="#Implicit-Variational-Distributions" class="headerlink" title="Implicit Variational Distributions"></a>Implicit Variational Distributions</h3><p>å˜åˆ†æ¨æ–­<strong>Variational Inference</strong>çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯ç¡®å®š$q_\eta(\mathbf{z}|\mathbf{x})$ï¼Œé€šå¸¸çš„åšæ³•å¦‚<strong>Mean-field Variational Inference</strong>ä¼šå‡è®¾ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚åœ¨æœ¬æ–‡ä¸­ä¸å¯¹$q_\eta(\mathbf{z}|\mathbf{x})$çš„å½¢å¼ä½œå‡è®¾ï¼Œä»…å‡è®¾å…¶ä¸ºä¸€ä¸ªéšå«çš„åˆ†å¸ƒã€‚è¿ç”¨ä¸Šæ–‡æåˆ°çš„<em>Density Ratio Trick</em>ï¼Œæˆ‘ä»¬å¯ä»¥å°†VAEæŸå¤±å‡½æ•°ä¸­çš„ç¬¬äºŒé¡¹æ”¹å†™ä¸ºï¼š</p><p>$$<br>-\text{KL}[q_\eta(\mathbf{z}|\mathbf{x})\parallel p(\mathbf{z})]=\mathbb{E}<em>{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{p(\mathbf{z})}{q_\eta(\mathbf{z}|\mathbf{x})}\right]\approx\mathbb{E}</em>{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}{1-\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}\right]<br>$$</p><p>æ–‡ä¸­å¼•å…¥äº†ä¸€ä¸ªéšå˜é‡åˆ†ç±»å™¨ï¼ˆLatent Classifierï¼‰$\mathcal{C}_{\boldsymbol{\omega}}(\mathbf{z})$ï¼Œç”¨æ¥åˆ¤åˆ«$\mathbf{z}$æ˜¯ä»ç¼–ç ç½‘ç»œè¿˜æ˜¯ä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ï¼ˆçŒœæµ‹è¿™æ ·åšçš„å¥½å¤„æ˜¯ä¸ç”¨å†å¯¹$\mathbf{z}$çš„åéªŒåšé«˜æ–¯åˆ†å¸ƒçš„å‡è®¾äº†ï¼Œä¹Ÿä¸éœ€è¦åœ¨å˜åˆ†ç½‘ç»œè¾“å‡ºå½¢æˆçš„é«˜æ–¯åˆ†å¸ƒä¸Šé‡‡æ ·å¾—åˆ°$\mathbf{z}$äº†ï¼Œè¿™æ ·é‡å‚æ•°æŠ€å·§ä¹Ÿçœäº†ï¼‰ã€‚å…·ä½“å®ç°ä¸Šï¼ŒæœŸæœ›å¯ä»¥ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•ï¼ˆé‡‡æ ·å¤šæ¬¡å–å‡å€¼ï¼‰è¿›è¡Œè®¡ç®—ã€‚</p><h3 id="Likelihood-Choice"><a href="#Likelihood-Choice" class="headerlink" title="Likelihood Choice"></a>Likelihood Choice</h3><p>å¯¹äºVAEæŸå¤±å‡½æ•°ç¬¬ä¸€é¡¹ï¼Œå¯¹åº”ç”Ÿæˆç½‘ç»œï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¯¹$p(\mathbf{x}|\mathbf{z})$åˆ†å¸ƒçš„å…·ä½“å½¢å¼åšå‡è®¾ï¼Œ è¿™æ ·å¯¹åº”<em>Likelihood-based<em>çš„æƒ…å†µã€‚æ–‡ä¸­é€‰æ‹©çš„æ˜¯</em>Zero-mean Laplace Distribution</em> $p_\theta(\mathbf{x}|\mathbf{z})\propto\exp(-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1)$ï¼ˆä¸å°±æ˜¯$L_1$ Losså—ï¼Ÿï¼Ÿï¼Ÿï¼‰ã€‚</p><p>å¯¹äº<em>Likelihood-free</em>çš„æƒ…å†µï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ä¸Šé¢æåˆ°çš„<em>Density Ratio Trick</em>ï¼Œè¿™æ—¶éœ€è¦åŠ ä¸€ä¸ªä¸€ä¸ªåˆ¤åˆ«å™¨ã€‚</p><p>$$<br>\mathbb{E}<em>{q_\eta(\mathbf{z}|\mathbf{x})}\left[-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1\right]\space\space\text{  or  }\space\space\mathbb{E}</em>{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}{1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}\right]<br>$$</p><p>å¯¹äºä¸¤ç§é€‰æ‹©ï¼Œå‰è€…å¯¹åº”VAEï¼Œå¥½å¤„æ˜¯ä¸ä¼šå‡ºç°æ¨¡å¼å´©æºƒçš„æƒ…å†µï¼Œåè€…å¯¹åº”GANï¼Œå®¹æ˜“å‡ºç°æ¨¡å¼å´©æºƒçš„æƒ…å†µï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å¯¹æŠ—å­¦ä¹ çš„æ–¹å¼ï¼ˆè¿™æ˜¯ä¼˜ç‚¹ï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œæœ¬æ–‡é€‰æ‹©ä¸¤ç§éƒ½ç”¨ï¼ˆæˆ‘å…¨éƒ½è¦.jpgï¼‰ã€‚</p><h3 id="Hybrid-Loss-Functions"><a href="#Hybrid-Loss-Functions" class="headerlink" title="Hybrid Loss Functions"></a>Hybrid Loss Functions</h3><p>å°†å‰é¢çš„è®¨è®ºç»“åˆèµ·æ¥ï¼Œæœ€åçš„æŸå¤±å‡½æ•°å°±æ˜¯ï¼š</p><p>$$<br>\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\eta})=\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1+\log\frac{\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}{1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}+\log\frac{\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}{1-\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}\right]<br>$$</p><p>æœ€åæ¨¡å‹åŒ…å«å››ä¸ªç½‘ç»œï¼šç”Ÿæˆç½‘ç»œ$p_\theta(\mathbf{x}|\mathbf{z})$ã€æ¨æ–­ç½‘ç»œ$q_\eta(\mathbf{z}|\mathbf{x})$ä»¥åŠä¸¤ä¸ªåˆ¤åˆ«å™¨$\mathcal{C}_{\boldsymbol{\omega}}$å’Œ$\mathcal{D}_\phi$ï¼Œä½œè€…å°†å…¶å‘½åä¸º$\alpha$-GANã€‚</p><p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/hkIY9xuDWl4GbLz.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Improved-Techniques"><a href="#Improved-Techniques" class="headerlink" title="Improved Techniques"></a>Improved Techniques</h3><p>ä½œè€…ä¸ºäº†æ”¹è¿›æ¨¡å‹çš„ç¨³å®šæ€§å’Œæ•ˆç‡ï¼Œå°†ç”Ÿæˆå™¨çš„Lossä¸­çš„$-\log(1-\mathcal{D}_\phi)$ä¿®æ”¹ä¸ºäº†$\log\mathcal{D}_\phi-\log(1-\mathcal{D}_\phi)$ï¼Œå¹¶å£°ç§°è¿™æ ·èƒ½æä¾›éé¥±å’Œï¼ˆNon-saturatingï¼‰çš„æ¢¯åº¦ï¼š</p><p>$$<br>\textbf{Generator Loss: } \mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1-\log\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))+\log(1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z})))\right]<br>$$</p><p>ä½œè€…è®¤ä¸ºåœ¨ç”Ÿæˆå™¨æŸå¤±å‡½æ•°ä¸­åŠ å…¥$\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1$èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦é˜²æ­¢æ¨¡å¼å´©æºƒã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…å‘ç°å°†çœŸå®æ ·æœ¬ï¼ˆåŸæ–‡æ˜¯The Samplesï¼‰ä½œä¸ºç”Ÿæˆçš„æ ·æœ¬è¾“å…¥åˆ°åˆ¤åˆ«å™¨ä¸­èƒ½å¤Ÿæå‡æ€§èƒ½ã€‚ä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯æ ¹æ®Jensenä¸ç­‰å¼ï¼š$\log p_\theta(\mathbf{x})=\log\int p_\theta(\mathbf{x}|\mathbf{z})p(\mathbf{z})\text{d}\mathbf{z}\geq \mathbb{E}_{p(\mathbf{z})}[\log p_\theta(\mathbf{x}|\mathbf{z})]$ï¼Œ</p><p>[TODO]</p><h2 id="Related-Work"><a href="#Related-Work" class="headerlink" title="Related Work"></a>Related Work</h2><p>[TODO]</p><img src="https://i.loli.net/2020/06/25/TKt3yUwPDQm4MeV.png" srcset="/img/loading.gif" style="zoom: 50%;" /><img src="https://i.loli.net/2020/06/25/5jg9wNMoXuTzeVY.png" srcset="/img/loading.gif" style="zoom: 50%;" /><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><p>[TODO]</p><h2 id="Metrics"><a href="#Metrics" class="headerlink" title="Metrics"></a>Metrics</h2><p>æœ¬æ–‡ä½¿ç”¨äº†å‡ ç§ä¸åŒçš„è¯„æµ‹ç”Ÿæˆæ¨¡å‹çš„æ–¹æ³•ï¼š</p><ul><li>*<em>Inception Score: *</em></li><li>*<em>Multi-scale Structural Similarity (MS-SSIM): *</em></li><li>*<em>Independent Wasserstein Critic: *</em></li></ul><h2 id="Results-on-ColorMNIST"><a href="#Results-on-ColorMNIST" class="headerlink" title="Results on ColorMNIST"></a>Results on ColorMNIST</h2><img src="https://i.loli.net/2020/06/25/QRBKHn51fxO2WUq.png" srcset="/img/loading.gif" style="zoom:50%;" /><img src="https://i.loli.net/2020/06/25/kM4lrsBVSDKaJwW.png" srcset="/img/loading.gif" style="zoom: 50%;" /><h2 id="Results-on-CelebA"><a href="#Results-on-CelebA" class="headerlink" title="Results on CelebA"></a>Results on CelebA</h2><img src="https://i.loli.net/2020/06/25/mzdjY67uH9pZ1ny.png" srcset="/img/loading.gif" style="zoom:50%;" /><h2 id="Results-on-CIFAR-10"><a href="#Results-on-CIFAR-10" class="headerlink" title="Results on CIFAR-10"></a>Results on CIFAR-10</h2><img src="https://i.loli.net/2020/06/25/nDGgM6AHVyKwIam.png" srcset="/img/loading.gif" style="zoom: 50%;" /><img src="https://i.loli.net/2020/06/25/K1RQdMyj8zbqlCJ.png" srcset="/img/loading.gif" style="zoom:50%;" />]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>GAN</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Deep Learning</tag>
      
      <tag>Variational Inference</tag>
      
      <tag>VAE</tag>
      
      <tag>GAN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Anomaly Detection in Streams with Extreme Value Theory</title>
    <link href="/2019/10/29/Anomaly-Detection-in-Streams-with-Extreme-Value-Theory/"/>
    <url>/2019/10/29/Anomaly-Detection-in-Streams-with-Extreme-Value-Theory/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡åŸºäº<strong>Extreme Value Theory</strong>æå‡ºäº†ä¸€ç§ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®é˜ˆå€¼ä¹Ÿä¸éœ€è¦å¯¹æ•°æ®åˆ†å¸ƒä½œä»»ä½•å‡è®¾çš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæœ¬æ–¹æ³•å¯ä»¥ç”¨åœ¨é€šç”¨çš„è‡ªåŠ¨é˜ˆå€¼é€‰æ‹©çš„åœºåˆä¸­ã€‚</p><p><a href="https://www.kdd.org/kdd2017/papers/view/anomaly-detection-in-streams-with-extreme-value-theory" target="_blank" rel="noopener">åŸæ–‡</a></p><h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚é˜ˆå€¼çš„é€‰æ‹©å¯ä»¥é€šè¿‡å®éªŒçš„æ–¹æ³•æˆ–è€…å¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œå‡è®¾çš„æ–¹æ³•æ¥å¾—åˆ°ï¼Œä¸è¿‡è¿™æ ·åšé€šå¸¸ä¸å‡†ç¡®ã€‚å€ŸåŠ©<strong>Extreme Value Theory</strong>æˆ‘ä»¬å¯ä»¥åœ¨ä¸éœ€è¦å¯¹åŸå§‹æ•°æ®çš„åˆ†å¸ƒä½œå¾ˆå¼ºçš„å‡è®¾çš„æƒ…å†µä¸‹ï¼Œæ¨æ–­æˆ‘ä»¬æƒ³è¦çš„æç«¯äº‹ä»¶çš„åˆ†å¸ƒï¼ˆåœ¨å¼‚å¸¸æ£€æµ‹ä¸­å°±æ˜¯å¼‚å¸¸å€¼ï¼‰ã€‚</p><p>ä¸‹é¢ç»™å‡ºä¸€äº›æ•°å­¦ç¬¦å·ï¼Œ$X$ä¸ºéšæœºå˜é‡ï¼Œ$F$ä¸ºç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œå³$F(x)=\mathbb{P}(X\leq x)$ã€‚è®°$F$çš„â€œæœ«å°¾â€åˆ†å¸ƒ$\bar{F}(x)=1-F(x)=\mathbb{P}(X&gt;x)$ã€‚å¯¹äºä¸€ä¸ªéšæœºå˜é‡$X$å’Œç»™å®šçš„æ¦‚ç‡$q$ï¼Œè®°$z_q$ä¸ºåœ¨$1-q$æ°´å¹³çš„åˆ†ä½æ•°ï¼Œå³$z_q$ä¸ºæ»¡è¶³$\mathbb{P}(X\leq z_q)\geq 1-q$æœ€å°çš„å€¼ã€‚</p><h2 id="Extreme-Value-Distributions"><a href="#Extreme-Value-Distributions" class="headerlink" title="Extreme Value Distributions"></a>Extreme Value Distributions</h2><p><strong>Extreme Value Theory</strong>ä¸»è¦æ˜¯ä¸ºäº†æ‰¾å‡ºæç«¯äº‹ä»¶å‘ç”Ÿçš„è§„å¾‹ï¼Œæœ‰å­¦è€…è¯æ˜ï¼Œåœ¨å¾ˆå¼±çš„æ¡ä»¶ä¸‹ï¼Œæ‰€æœ‰æç«¯äº‹ä»¶éƒ½æœä»ä¸€ä¸ªç‰¹å®šçš„åˆ†å¸ƒï¼Œè€Œä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ã€‚å…·ä½“å½¢å¼å¦‚ä¸‹ï¼š</p><p>$$<br>G_\gamma:x\mapsto \exp(-(1+\gamma x)^{-\frac{1}{\gamma}}), \space\space\space\space\space\gamma\in\mathbb{R}, \space\space\space\space\space 1+\gamma x&gt;0<br>$$</p><p>å…¶ä¸­$\gamma$ç§°ä¸º<strong>Extreme Value Index</strong>ï¼Œç”±åŸå§‹åˆ†å¸ƒå†³å®šã€‚</p><p>æ›´ä¸¥è°¨çš„è¯´æ³•æ˜¯Fisher-Tippett-Gnedenkoå®šç†ï¼ˆæå€¼ç†è®ºç¬¬ä¸€å®šç†ï¼‰ï¼š</p><blockquote><p>*<em>THEOREM: *</em>(Fisher-Tippett-Gnedenko). ä»¤$X_1,X_2,\cdots,X_n,\cdots$ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡åºåˆ—ï¼Œ$M_n=\max {X_1,\cdots,X_n}$ã€‚å¦‚æœå®æ•°å¯¹åºåˆ—$(a_n,b_n)$å­˜åœ¨ä¸”æ»¡è¶³$a_n&gt;0$å’Œ$\lim\limits_{n\rightarrow \infty}P\left(\frac{M_n-b_n}{a_n}\leq x\right)=F(x)$ï¼Œå…¶ä¸­$F$ä¸ºéé€€åŒ–åˆ†å¸ƒå‡½æ•°ï¼Œé‚£ä¹ˆ$F$å±äºGumbelã€FrÃ©chetæˆ–Weibullåˆ†å¸ƒæ—ï¼ˆæˆ–æ€»ç§°Generalized Extreme Value Distributionï¼‰ä¸­çš„ä¸€ç§ã€‚</p></blockquote><p>è¿™æ˜¯ä¸€ä¸ªåç›´è§‰çš„ç»“è®ºï¼Œä½†æ˜¯æƒ³åˆ°å½“äº‹ä»¶å‘ç”Ÿå˜å¾—æç«¯æ—¶ï¼Œå³$\mathbb{P}(X&gt;x)\rightarrow 0$ï¼Œ$\bar{F}(x)=\mathbb{P}(X&gt;x)$åˆ†å¸ƒçš„å½¢çŠ¶å…¶å®å¹¶æ²¡æœ‰å¾ˆå¤šç§é€‰æ‹©ã€‚Table 1å±•ç¤ºäº†å‡ ç§ä¸åŒåˆ†å¸ƒå¯¹åº”çš„$\gamma$ï¼š</p><p><img src="https://i.loli.net/2020/06/24/jyhoWZGc2gFTrJv.png" srcset="/img/loading.gif" alt=""></p><p>Figure 1å±•ç¤ºäº†å‡ ç§ä¸åŒ$\gamma$æƒ…å†µä¸‹çš„â€œæœ«å°¾â€åˆ†å¸ƒï¼š</p><p><img src="https://i.loli.net/2020/06/24/4rmZL1AMcBJ2Vzq.png" srcset="/img/loading.gif" alt=""></p><h2 id="Power-of-EVT"><a href="#Power-of-EVT" class="headerlink" title="Power of EVT"></a>Power of EVT</h2><p>æ ¹æ®<strong>Extreme Value Theory</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸå§‹åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹è®¡ç®—æç«¯äº‹ä»¶çš„æ¦‚ç‡ã€‚ä½†æ˜¯$\bar{G}_\gamma$åˆ†å¸ƒä¸­å‚æ•°$\gamma$æ˜¯æœªçŸ¥çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§é«˜æ•ˆçš„æ–¹æ³•æ¥è¿›è¡Œä¼°è®¡ã€‚<strong>The Peaks-Over-Threshold</strong> (POT) æ–¹æ³•æ˜¯æœ¬æ–‡ä»‹ç»çš„ä¸€ç§æ–¹æ³•ã€‚</p><p><img src="https://i.loli.net/2020/06/24/hX2T1IkMAqfioZl.png" srcset="/img/loading.gif" alt=""></p><h2 id="Peaks-Over-Threshold-Approach"><a href="#Peaks-Over-Threshold-Approach" class="headerlink" title="Peaks-Over-Threshold Approach"></a>Peaks-Over-Threshold Approach</h2><p>POTæ–¹æ³•ä¾èµ–äºPickands-Balkema-De Haanå®šç†ï¼ˆæå€¼ç†è®ºç¬¬äºŒå®šç†ï¼‰ï¼Œç»´åŸºç™¾ç§‘ç‰ˆï¼š</p><blockquote><p>è€ƒè™‘ä¸€ä¸ªæœªçŸ¥åˆ†å¸ƒ$F$å’Œéšæœºå˜é‡$X$ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡$X$åœ¨è¶…è¿‡ç¡®å®šé˜ˆå€¼$u$ä¸‹çš„æ¡ä»¶åˆ†å¸ƒ$F_u$ï¼Œå®šä¹‰ä¸ºï¼š<br>$$<br>F_u(y)=P(X-u\leq y|X&gt;u)=\frac{F(u+y)-F(u)}{1-F(u)}<br>$$<br>å…¶ä¸­$0\leq y\leq x_F-u$ï¼Œ$x_F$ä¸º$F$çš„å³ç«¯ç‚¹ã€‚$F_u$æè¿°äº†è¶…è¿‡ç‰¹å¾é˜ˆå€¼$u$çš„åˆ†å¸ƒï¼Œç§°ä¸º<strong>Conditional Excess Distribution Function</strong>ã€‚</p><p>*<em>STATEMENT: *</em>(Pickands-Balkema-De Haan). è®¾$(X_1,X_2,\cdots)$ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒéšæœºå˜é‡åºåˆ—ï¼Œ$F_u$ä¸ºç›¸åº”çš„Conditional Excess Distribution Functionã€‚å¯¹äºä¸€å¤§ç±»çš„$F$å’Œå¾ˆå¤§çš„$u$ï¼Œ$F_u$èƒ½å¤Ÿå¾ˆå¥½çš„è¢«Generalized Pareto Distributionæ‰€æ‹Ÿåˆï¼š<br>$$<br>F_u(y)\rightarrow G_{k,\sigma}(y),\space\space \text{as } u\rightarrow \infty<br>$$<br>å…¶ä¸­ï¼š<br>$$<br>G_{k,\sigma}(y)=<br>\begin{cases}<br>1-(1+ky/\sigma)^{-1/k}, &amp;\text{if }k\neq 0\<br>1-e^{-y/\sigma}, &amp;\text{if }k=0<br>\end{cases}<br>$$<br>å½“$k\geq 0$æ—¶$\sigma&gt;0, y\geq 0$ï¼Œ$k&lt;0$æ—¶$0\leq y\leq -\sigma/k$ã€‚</p></blockquote><p>è®ºæ–‡ä¸­ç»™å‡ºçš„å®šç†å¦‚ä¸‹ï¼š</p><blockquote><p>*<em>THEOREM: *</em>(Pickands-Balkema-De Haan). ç´¯ç§¯æ¦‚ç‡å¯†åº¦å‡½æ•°$F\in\mathcal{D}<em>\gamma$å½“ä¸”ä»…å½“å‡½æ•°$\sigma$å­˜åœ¨æ—¶ï¼Œå¯¹æ‰€æœ‰$x\in\mathbb{R}$åœ¨$1+\gamma x&gt;0$çš„æ¡ä»¶ä¸‹æœ‰ï¼š<br>$$<br>\frac{\bar{F}(t+\sigma(t)x)}{\bar{F}(t)}\mathop{\rightarrow}\limits</em>{t\rightarrow\tau}(1+\gamma x)^{-\frac{1}{\gamma}}<br>$$</p></blockquote><p>ä¸Šå¼å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š<br>$$<br>\bar{F}<em>t(x)=\mathbb{P}(X-t&gt;x|X&gt;t)\mathop{\sim}\limits</em>{t\rightarrow\tau}\left(1+\frac{\gamma x}{\sigma(t)}\right)^{-\frac{1}{\gamma}}<br>$$<br>è¯¥å¼è¡¨æ˜$X$è¶…è¿‡é˜ˆå€¼$t$çš„æ¦‚ç‡ï¼ˆå†™ä¸º$X-t$ï¼‰æœä»<strong>Generalized Pareto Distribution</strong> (GPD)ï¼Œå‚æ•°ä¸º$\gamma$å’Œ$\sigma$ã€‚POTä¸»è¦æ˜¯æ‹ŸåˆGPDè€Œä¸æ˜¯EVTåˆ†å¸ƒã€‚</p><p>å¦‚æœæˆ‘ä»¬è¦ä¼°è®¡å‚æ•°$\hat{\gamma}$å’Œ$\hat{\sigma}$ï¼Œåˆ†ä½æ•°å¯ä»¥é€šè¿‡ä¸‹å¼è®¡ç®—å¾—åˆ°ï¼š<br>$$<br>z_q\simeq t+\frac{\hat{\sigma}}{\hat{\gamma}}\left(\left(\frac{qn}{N_t}\right)^{-\hat{\gamma}}-1\right)<br>$$</p><p>å…¶ä¸­$t$æ˜¯ä¸€ä¸ªâ€œå¾ˆé«˜â€çš„é˜ˆå€¼ï¼Œ$q$æ˜¯ç»™å®šçš„æ¦‚ç‡å€¼ï¼Œ$n$æ˜¯æ‰€æœ‰è§‚æµ‹æ ·æœ¬çš„æ•°é‡ï¼Œ$N_t$æ˜¯peaksçš„æ•°é‡ï¼Œå³$X_i&gt;t$çš„æ•°é‡ã€‚ä¸ºäº†è¿›è¡Œé«˜æ•ˆçš„å‚æ•°ä¼°è®¡ï¼Œæ–‡ä¸­ä½¿ç”¨äº†æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p><h2 id="Maximum-Likelihood-Estimation"><a href="#Maximum-Likelihood-Estimation" class="headerlink" title="Maximum Likelihood Estimation"></a>Maximum Likelihood Estimation</h2><p>è®¾$X_1,\cdots,X_n$ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°è®°ä¸º$f_\theta$ï¼Œ$\theta$ä¸ºåˆ†å¸ƒä¸­çš„å‚æ•°ï¼Œé‚£ä¹ˆä¼¼ç„¶å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p><p>$$<br>\mathcal{L}(X_1,\cdots,X_n;\theta)=\prod\limits_{i=1}^n f_\theta(X_i)<br>$$</p><p>åœ¨æå¤§ä¼¼ç„¶ä¼°è®¡ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°åˆé€‚çš„å‚æ•°ä½¿å¾—ä¼¼ç„¶å‡½æ•°æœ€å¤§åŒ–ã€‚åœ¨æˆ‘ä»¬çš„é—®é¢˜ä¸­ï¼Œä¼¼ç„¶å‡½æ•°å¦‚ä¸‹ï¼š<br>$$<br>\log\mathcal{L}(\gamma,\sigma)=-N_t\log\sigma-\left(1+\frac{1}{\gamma}\right)\sum\limits_{i=1}^{N_t}\log\left(1+\frac{\gamma}{\sigma}Y_i\right)<br>$$<br>å…¶ä¸­$Y_i&gt;0$è¡¨ç¤º$X_i$è¶…è¿‡é˜ˆå€¼$t$çš„éƒ¨åˆ†ã€‚</p><p>æ–‡ä¸­ä½¿ç”¨äº†<strong>Grimshawâ€™s Trick</strong>æ¥å°†å«ä¸¤ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜è½¬æ¢ä¸ºåªå«ä¸€ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜ã€‚è®°$\ell(\gamma,\sigma)=\log\mathcal{L}(\gamma,\sigma)$ï¼Œå¯¹äºæ‰€æœ‰æå€¼æ¥è¯´æœ‰$\nabla \ell(\gamma, \sigma)=0$ã€‚Grimshawâ€™s Trickè¡¨æ˜å¯¹äºæ»¡è¶³$\nabla \ell(\gamma, \sigma)=0$çš„ä¸€å¯¹$(\gamma^<em>,\sigma^</em>)$ï¼Œ$x^<em>=\frac{\gamma^</em>}{\sigma^<em>}$ä¸ºç­‰å¼$u(X)v(X)=1$çš„è§£ï¼Œå…¶ä¸­ï¼š<br>$$<br>\begin{align}<br>u(x)&amp;=\frac{1}{N_t}\sum\limits_{i=1}^{N_t}\frac{1}{1+xY_i}\<br>v(x)&amp;=1+\frac{1}{N_t}\sum\limits_{i=1}^{N_t}\log(1+xY_i)<br>\end{align}<br>$$<br>åœ¨æ‰¾åˆ°æ»¡è¶³è¯¥ç­‰å¼çš„è§£$x^</em>$åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$\gamma^<em>=v(x^</em>)-1$å’Œ$\sigma^<em>=\gamma^</em>/x^*$ï¼Œäºæ˜¯é—®é¢˜å°±å˜æˆäº†å¦‚ä½•å¯»æ‰¾æ–¹ç¨‹çš„æ‰€æœ‰æ ¹ã€‚</p><p>å› ä¸º$\log$çš„å­˜åœ¨ï¼Œæ‰€ä»¥æœ‰$1+xY_i&gt;0$ã€‚è€Œ$Y_i$æ˜¯æ­£æ•°ï¼Œæ‰€ä»¥$x^*$çš„èŒƒå›´ä¸€å®šåœ¨$\left(-\frac{1}{Y^M},+\infty\right)$ï¼Œå…¶ä¸­$Y^M=\max Y_i$ã€‚</p><p>Grimshawï¼ˆä½œè€…å‚è€ƒçš„ä¸€ç¯‡<a href="https://www.tandfonline.com/doi/abs/10.1080/00401706.1993.10485040" target="_blank" rel="noopener">è®ºæ–‡</a>ï¼‰è¿˜ç»™å‡ºäº†ä¸€ä¸ªä¸Šç•Œï¼š<br>$$<br>x^*_{\text{max}}=2\frac{\bar{Y}-Y^m}{(Y^m)^2}<br>$$<br>å…¶ä¸­$Y^m=\min Y_i$ï¼Œ$\bar{Y}$ä¸º$Y_i$çš„å‡å€¼ã€‚è¯¦ç»†çš„ä¼˜åŒ–æ–¹æ³•ä¼šåœ¨ä¸‹æ–‡è®¨è®ºã€‚</p><p>èƒŒæ™¯éƒ¨åˆ†åˆ°æ­¤ç»“æŸï¼Œæ¥ä¸‹æ¥çš„éƒ¨åˆ†å°±æ˜¯ä½œè€…æå‡ºçš„æ–°æ–¹æ³•ã€‚</p><h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><p>Extreme Value Theoryç»™å‡ºäº†åœ¨å¯¹åŸå§‹åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡ä½¿å¾—$\mathbb{P}(X&gt;z_q)&lt;q$çš„$z_q$çš„æ–¹æ³•ã€‚</p><p>æœ¬æ–‡æ®æ­¤æå‡ºäº†æ—¶é—´åºåˆ—æµçš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚é¦–å…ˆæ ¹æ®å·²çŸ¥çš„è§‚æµ‹å€¼$X_1,\cdots,X_n$å¾—åˆ°é˜ˆå€¼$z_q$ï¼Œç„¶åæ ¹æ®æ•°æ®çš„ç‰¹æ€§è¿ç”¨ä¸¤ç§ä¸åŒæ–¹æ³•æ¥æ›´æ–°$z_q$ã€‚å¯¹äºå¹³ç¨³æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨SPOTï¼›å¯¹äºéå¹³ç¨³æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨DSPOTã€‚</p><h2 id="Initialization-Step"><a href="#Initialization-Step" class="headerlink" title="Initialization Step"></a>Initialization Step</h2><p>åœ¨è¿›è¡Œå¼‚å¸¸æ£€æµ‹ä¹‹å‰ï¼Œéœ€è¦æ ¹æ®å·²æœ‰çš„è§‚æµ‹æ•°æ®è¿›è¡Œ$z_q$çš„ä¼°è®¡ã€‚ç»™å®š$n$ä¸ªè§‚æµ‹å€¼$X_1,\cdots,X_n$å’Œä¸€ä¸ªå›ºå®šçš„æ¦‚ç‡å€¼$q$ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡é˜ˆå€¼$z_q$ä½¿å¾—$\mathbb{P}(X&gt;z_q)&lt;q$ã€‚å…¶ä¸»è¦æµç¨‹æ˜¯é¦–å…ˆè®¾å®šä¸€ä¸ªè¾ƒå¤§çš„é˜ˆå€¼$t$ï¼Œç„¶åé€šè¿‡æ‹ŸåˆGPDåˆ†å¸ƒæ¥è®¡ç®—$z_q$ã€‚è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/24/fzeC8vuDtA6mEdl.png" srcset="/img/loading.gif" alt=""></p><p>ç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/24/AEQpnZPiW3C4mr7.png" srcset="/img/loading.gif" alt=""></p><p>$Y_t$ä»£è¡¨å¤§äº$t$çš„è§‚æµ‹å€¼çš„é›†åˆï¼ŒGPDåˆ†å¸ƒçš„æ‹Ÿåˆä½¿ç”¨äº†å‰æ–‡æåˆ°çš„Grimshawâ€™s Trickã€‚</p><h2 id="Finding-Anomalies-in-a-Stream"><a href="#Finding-Anomalies-in-a-Stream" class="headerlink" title="Finding Anomalies in a Stream"></a>Finding Anomalies in a Stream</h2><p>é€šè¿‡Initialization Stepä½¿ç”¨POTç®—æ³•å¾—åˆ°çš„$z_q$ï¼Œæˆ‘ä»¬å®šä¹‰å…¶ä¸ºâ€Normality Boundâ€ï¼Œç”¨äºåé¢çš„æ£€æµ‹ã€‚åœ¨åé¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®æ–°å¾—åˆ°çš„è§‚æµ‹å€¼æ¥æ›´æ–°$z_q$ã€‚</p><h3 id="Stationary-Case"><a href="#Stationary-Case" class="headerlink" title="Stationary Case"></a>Stationary Case</h3><p>æˆ‘ä»¬é¦–å…ˆæ¥è®¨è®ºæ—¶é—´åºåˆ—æ²¡æœ‰æ—¶é—´ä¾èµ–æ€§çš„æƒ…å†µï¼ˆ$X_1,\cdots,X_n$ä¹‹é—´ç‹¬ç«‹åŒåˆ†å¸ƒï¼‰ã€‚é€šè¿‡POTç®—æ³•å¯¹æ‰€æœ‰è§‚æµ‹å€¼å¾—åˆ°$z_q$ä¹‹åï¼ŒStreaming POT (SPOT) ç®—æ³•ä¼šæ£€æŸ¥$X_n$ä¹‹åçš„å€¼ï¼ˆæ•°æ®æµåœºæ™¯ï¼Œ$X_1,\cdots,X_n$æ˜¯å†å²æ•°æ®ï¼Œè¿˜ä¼šæœ‰æ–°çš„æ•°æ®è¿›æ¥ï¼‰ï¼Œå¦‚æœå¤§äº$z_q$ï¼Œåˆ™å°†$X_i$åŠ å…¥å¼‚å¸¸ç‚¹é›†åˆä¸­ï¼›å¦‚æœå¤§äº$t$ä½†å°äº$z_q$ï¼Œåˆ™å°†$X_i$åŠ å…¥è§‚æµ‹å€¼é›†åˆä¸­ï¼Œæ›´æ–°$z_q$ï¼›å…¶ä»–æƒ…å†µæˆ‘ä»¬$X_i$æ˜¯æ­£å¸¸æƒ…å†µã€‚ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/h5yKnlCAYxbHu2R.png" srcset="/img/loading.gif" alt=""></p><h3 id="Drifting-Case"><a href="#Drifting-Case" class="headerlink" title="Drifting Case"></a>Drifting Case</h3><p>SPOTç®—æ³•åªé€‚ç”¨äºå¹³ç¨³åˆ†å¸ƒçš„æƒ…å†µï¼Œä½†åœ¨ç°å®ç”Ÿæ´»ä¸­è¿™æ ·çš„å‡è®¾è¿‡å¼ºäº†ã€‚äºæ˜¯ä½œè€…æå‡ºäº†èƒ½å¤„ç†æ—¶é—´ä¾èµ–æ€§çš„Streaming POT with Drift (DSPOT) ç®—æ³•ã€‚</p><p><img src="https://i.loli.net/2020/06/25/O49XwQvVGH7k1ri.png" srcset="/img/loading.gif" alt=""></p><p>åœ¨DSPOTä¸­ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨$X_i$çš„ç»å¯¹å€¼ï¼Œè€Œæ˜¯ç”¨ç›¸å¯¹å€¼$X^\prime_i=X_i-M_i$ï¼Œå…¶ä¸­$M_i$æ˜¯$i$æ—¶åˆ»çš„å±€éƒ¨ç‰¹å¾ï¼Œå¦‚Figure 4æ‰€ç¤ºã€‚æœ€ç®€å•çš„å®ç°æ˜¯ä½¿ç”¨å±€éƒ¨å‡å€¼ï¼Œå³$M_i=(1/d)\cdot\sum\limits_{k=1}^d X_{i-k}^<em>$ï¼Œ$X_{i-1}^</em>,\cdots,X_{i-d}^*$æ˜¯é•¿åº¦ä¸º$d$çš„çª—å£ã€‚æˆ‘ä»¬å‡è®¾$X^\prime_i$æœä»å¹³ç¨³åˆ†å¸ƒçš„å‡è®¾ã€‚</p><p>ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/P6hOsD9dnNIHvUV.png" srcset="/img/loading.gif" alt=""></p><h2 id="Numerical-Optimization"><a href="#Numerical-Optimization" class="headerlink" title="Numerical Optimization"></a>Numerical Optimization</h2><p>ç°åœ¨å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯ä¼˜åŒ–äº†ï¼Œå‰æ–‡å·²ç»æåˆ°å¯¹GPDçš„æ‹Ÿåˆå·²ç»è¢«ä¼˜åŒ–æˆä¸€ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜ï¼Œä¸‹é¢å°†ä¼šè¯¦ç»†è®¨è®ºä¼˜åŒ–ç®—æ³•ã€‚</p><h3 id="Reduction-of-the-Optimal-Parameters-Search"><a href="#Reduction-of-the-Optimal-Parameters-Search" class="headerlink" title="Reduction of the Optimal Parameters Search"></a>Reduction of the Optimal Parameters Search</h3><p>å‰æ–‡å·²ç»å¾—åˆ°äº†ä¸€ä¸ªåˆæ­¥çš„$x^<em>$çš„Boundï¼Œå³$x^</em>&gt;-\frac{1}{Y^M}$å’Œ$x^*\leq 2\frac{\bar{Y}-Y^m}{(Y^m)^2}$ï¼Œä¸‹é¢å°†ç»™å‡ºä¸€ä¸ªæ›´ä¸¥æ ¼çš„Boundã€‚</p><blockquote><p><em><em>PROPOSITION: *</em>å¦‚æœ$x^</em>$æ˜¯$u(x)v(x)=1$çš„è§£ï¼Œé‚£ä¹ˆï¼š<br>$$<br>x^<em>\leq 0 \text{ or } x^</em>\geq 2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m}<br>$$</p></blockquote><p>è¯æ˜è§è®ºæ–‡åŸæ–‡ã€‚</p><p>è¿™æ ·$x^<em>$çš„èŒƒå›´å°±è¿›ä¸€æ­¥ç¼©å°äº†ï¼Œäºæ˜¯æœ‰$u(x)v(X)=1$çš„è§£$x^</em>$åœ¨ä»¥ä¸‹èŒƒå›´ä¹‹å†…ï¼š<br>$$<br>\left(-\frac{1}{Y^M},0\right]\text{ and }\left[2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m},2\frac{\bar{Y}-Y^m}{(Y^m)^2}\right]<br>$$</p><h3 id="How-Can-We-Maximize-the-Likelihood-Function"><a href="#How-Can-We-Maximize-the-Likelihood-Function" class="headerlink" title="How Can We Maximize the Likelihood Function?"></a>How Can We Maximize the Likelihood Function?</h3><p>æ¥ä¸‹æ¥æ˜¯ä¼˜åŒ–çš„å…·ä½“å®ç°é—®é¢˜ã€‚æ–‡ä¸­é¦–å…ˆè®¾å®šäº†ä¸€ä¸ªå¾ˆå°çš„å€¼$\epsilon&gt;0\space(\sim 10^{-8})$ï¼Œç„¶ååœ¨ä¸‹é¢çš„èŒƒå›´å†…å¯»æ‰¾å‡½æ•°$w:x\mapsto u(x)v(x)-1$çš„æ ¹ï¼š<br>$$<br>\left[-\frac{1}{Y^M}+\epsilon,-\epsilon\right]\text{ and }\left[2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m},2\frac{\bar{Y}-Y^m}{(Y^m)^2}\right]<br>$$<br>ä½œè€…æ²¡æœ‰ä½¿ç”¨ç°æœ‰çš„å¯»æ‰¾å‡½æ•°æ ¹çš„ç®—æ³•ï¼Œè€Œæ˜¯è½¬æ¢ä¸ºå¦‚ä¸‹ä¼˜åŒ–é—®é¢˜ï¼š<br>$$<br>\min\limits_{x_1,\cdots,x_k\in I}\sum\limits_{i=1}^k w(x_k)^2<br>$$<br>å…¶ä¸­$I$å°±æ˜¯$x^*$çš„Boundã€‚è¯¥é—®é¢˜æ˜¯ä¸€ä¸ªå¾ˆå…¸å‹çš„ä¼˜åŒ–é—®é¢˜ï¼Œå¯ä»¥è¢«å¾ˆå¤šæˆç†Ÿçš„ç®—æ³•æ‰€è§£å†³ã€‚</p><h3 id="Initial-Threshold"><a href="#Initial-Threshold" class="headerlink" title="Initial Threshold"></a>Initial Threshold</h3><p>åœ¨ç®—æ³•çš„Initialization Stepï¼Œéœ€è¦äº‹å…ˆè®¾å®šä¸€ä¸ªé˜ˆå€¼$t$ï¼Œå¦‚æœè®¾å®šçš„å¤ªå¤§ï¼Œé‚£ä¹ˆ$Y_t$çš„æ•°é‡å°±ä¼šå¾ˆå°‘ã€‚ä½œè€…ç»™å‡ºçš„å»ºè®®æ˜¯ä¿è¯$t&lt;z_q$ï¼Œå³$t$å¯¹åº”çš„æ¦‚ç‡å€¼åº”è¯¥å°äº$1-q$ã€‚</p><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><p>åœ¨å®éªŒéƒ¨åˆ†ï¼Œä½œè€…åœ¨åˆæˆæ•°æ®å’ŒçœŸå®æ•°æ®ä¸Šè¯•éªŒäº†SPOTç®—æ³•å’ŒDSPOTç®—æ³•çš„æœ‰æ•ˆæ€§ã€‚</p><h2 id="D-SPOT-Reliability"><a href="#D-SPOT-Reliability" class="headerlink" title="(D)SPOT Reliability"></a>(D)SPOT Reliability</h2><p>ä½œè€…é¦–å…ˆåœ¨åˆæˆæ•°æ®ä¸ŠéªŒè¯SPOTçš„æœ‰æ•ˆæ€§ã€‚å…·ä½“åšæ³•æ˜¯ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒç”Ÿæˆæ•°æ®ï¼ˆé«˜æ–¯åˆ†å¸ƒçš„åˆ†ä½æ•°èƒ½å¤Ÿç›´æ¥è®¡ç®—ï¼‰ï¼Œç„¶åå°†SPOTå¾—å‡ºçš„$z_q$å’Œç†è®ºå€¼è¿›è¡Œå¯¹æ¯”ã€‚è¯¯å·®å®šä¹‰å¦‚ä¸‹ï¼š<br>$$<br>\text{error rate}=\left|\frac{z^{\text{SPOT}}-z^{\text{th}}}{z^{\text{th}}}\right|<br>$$<br>ä¸‹å›¾æ˜¯é‡‡ç”¨ä¸åŒæ•°é‡è§‚æµ‹å€¼çš„ç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/GXlu2MAJaoqxyd4.png" srcset="/img/loading.gif" alt=""></p><h2 id="Finding-Anomalies-with-SPOT"><a href="#Finding-Anomalies-with-SPOT" class="headerlink" title="Finding Anomalies with SPOT"></a>Finding Anomalies with SPOT</h2><p>åœ¨è¿™ä¸€èŠ‚ä½œè€…åœ¨çœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒä»¥éªŒè¯SPOTç®—æ³•çš„æœ‰æ•ˆæ€§ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2020/06/25/wTkZxKarFVDOlp6.png" srcset="/img/loading.gif" alt=""></p><p>åœ¨æ–‡ä¸­ä½œè€…è¯´ç®—æ³•çš„True Positiveè¾¾åˆ°äº†$86%$ï¼ŒFalse Positiveå°äº$4%$ã€‚</p><p><img src="https://i.loli.net/2020/06/25/RcUnwtHud7DjNXv.png" srcset="/img/loading.gif" alt=""></p><h2 id="Finding-Anomalies-with-DSPOT"><a href="#Finding-Anomalies-with-DSPOT" class="headerlink" title="Finding Anomalies with DSPOT"></a>Finding Anomalies with DSPOT</h2><p>åœ¨è¿™ä¸€èŠ‚ä½œè€…ä½¿ç”¨DSPOTåœ¨çœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒã€‚çª—å£å¤§å°$d=450$ï¼Œé¢„è®¾çš„é£é™©æ¦‚ç‡å€¼$q=10^{-3}$ã€‚ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/lIxqpnGtL7feVKs.png" srcset="/img/loading.gif" alt=""></p><p>åœ¨å›¾ä¸­å¯ä»¥çœ‹å‡ºåœ¨$8000$ Minutesä¹‹åä¸Šç•Œæ˜¾è‘—æé«˜ï¼Œä½œè€…åˆ†æäº†åŸå› ï¼Œè®¤ä¸ºæ˜¯å› ä¸ºè¶…è¿‡é˜ˆå€¼$t$çš„ç‚¹$Y_t$çš„å­˜å‚¨æ˜¯å…¨å±€çš„ï¼Œåœ¨å‰$8000$ Minutesç®—æ³•å­˜å‚¨äº†å¾ˆå¤šè¾ƒé«˜çš„$Y_t$å€¼ï¼Œè€Œåœ¨$8000$ Minutesä¹‹åï¼ŒçœŸå®æ•°æ®çš„è¶‹åŠ¿å¼€å§‹ä¸‹é™ï¼Œä½†ç®—æ³•ä»æ˜¯æ ¹æ®å…¨å±€çš„$Y_t$æ¥è¿›è¡Œ$z_q$çš„è®¡ç®—ï¼ˆè¿™ä¸€æ®µæ²¡æœ‰ç‰¹åˆ«æ˜ç™½ï¼‰ã€‚ä½œè€…ç»™å‡ºçš„ä¿®æ­£æ–¹æ³•æ˜¯åªä¿å­˜å›ºå®šæ•°é‡çš„Peaksã€‚</p><p>ä¸‹å›¾æ˜¯ä½œè€…åœ¨è‚¡ç¥¨æ•°æ®ä¸Šå¾—åˆ°çš„å®éªŒç»“æœï¼š</p><p><img src="https://i.loli.net/2020/06/25/VeEo8OPbzyUxXrR.png" srcset="/img/loading.gif" alt=""></p><h2 id="Performances"><a href="#Performances" class="headerlink" title="Performances"></a>Performances</h2><p>ä½œè€…è¿˜éªŒè¯äº†ç®—æ³•çš„æ—¶é—´æ•ˆç‡ã€‚</p><p><img src="https://i.loli.net/2020/06/25/Egh7CxsU2TtL6az.png" srcset="/img/loading.gif" alt=""></p><p>è¡¨ä¸­Tä»£è¡¨çš„æ˜¯æ¯ä¸ªIterationçš„æ—¶é—´ï¼ŒMä»£è¡¨çš„æ˜¯Peaksçš„æ¯”ä¾‹ï¼Œâ€bi-â€œå‰ç¼€ä»£è¡¨çš„æ˜¯åŒæ—¶è®¡ç®—ä¸Šç•Œå’Œä¸‹ç•Œã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Statistics</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>An Introduction to Variational Autoencoders</title>
    <link href="/2019/10/22/An-Introduction-to-Variational-Autoencoders/"/>
    <url>/2019/10/22/An-Introduction-to-Variational-Autoencoders/</url>
    
    <content type="html"><![CDATA[<h1 id="Deep-Generative-Models"><a href="#Deep-Generative-Models" class="headerlink" title="Deep Generative Models"></a>Deep Generative Models</h1><p>ç”Ÿæˆæ¨¡å‹æ˜¯æŒ‡ä¸€ç³»åˆ—ç”¨äºéšæœºç”Ÿæˆå¯è§‚æµ‹æ•°æ®çš„æ¨¡å‹ã€‚å‡è®¾åœ¨ä¸€ä¸ªé«˜ç»´ç©ºé—´$\mathcal{X}$ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªéšæœºå‘é‡$\mathbf{X}$æœä»ä¸€ä¸ªæœªçŸ¥çš„åˆ†å¸ƒ$p_r(x),x\in \mathcal{X}$ã€‚ç”Ÿæˆæ¨¡å‹å°±æ˜¯æ ¹æ®ä¸€äº›å¯è§‚æµ‹çš„æ ·æœ¬$x^{(1)},x^{(2)},\cdots,x^{(N)}$æ¥å­¦ä¹ ä¸€ä¸ªå‚æ•°åŒ–çš„æ¨¡å‹$p_\theta(x)$æ¥è¿‘ä¼¼æœªçŸ¥åˆ†å¸ƒ$p_r(x)$ã€‚</p><p>ç”Ÿæˆæ¨¡å‹ä¸»è¦ç”¨äºå¯†åº¦ä¼°è®¡å’Œæ ·æœ¬ç”Ÿæˆã€‚</p><hr><p>å¯†åº¦ä¼°è®¡å³ç»™å®šä¸€ç»„æ•°æ®$\mathcal{D}={x^{(i)}},1\leq i\leq N$ï¼Œå‡è®¾ä»–ä»¬éƒ½æ˜¯ä»ç›¸åŒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°$p_r(x)$ç‹¬ç«‹äº§ç”Ÿçš„ã€‚å¯†åº¦ä¼°è®¡å°±æ˜¯æ ¹æ®æ•°æ®é›†$\mathcal{D}$æ¥ä¼°è®¡å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°$p_r(x)$ã€‚</p><p>å¦‚æœå°†ç”Ÿæˆæ¨¡å‹ç”¨äºç›‘ç£å­¦ä¹ ï¼Œé‚£ä¹ˆå°±æ˜¯è¾“å‡ºæ ‡ç­¾çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(y|x)$ï¼Œæ ¹æ®è´å¶æ–¯å…¬å¼ï¼š</p><p>$$p(y|x)=\frac{p(x,y)}{\sum_y p(x,y)}$$</p><p>é—®é¢˜å°±å˜ä¸ºäº†è”åˆæ¦‚ç‡$p(x,y)$çš„å¯†åº¦ä¼°è®¡é—®é¢˜ã€‚</p><hr><p>æ ·æœ¬ç”Ÿæˆå³æ ¹æ®ç»™å®šçš„æ¦‚ç‡åˆ†å¸ƒ$p_\theta(x)$ç”Ÿæˆä¸€äº›æœä»è¿™ä¸ªåˆ†å¸ƒçš„æ ·æœ¬ï¼Œå³é‡‡æ ·ã€‚åœ¨å«éšå˜é‡çš„ç”Ÿæˆæ¨¡å‹ä¸­ï¼Œç”Ÿæˆ$x$çš„è¿‡ç¨‹ä¸€èˆ¬åŒ…å«ä¸¤æ­¥ï¼š</p><ol><li>æ ¹æ®éšå˜é‡çš„åˆ†å¸ƒ$p_\theta(z)$é‡‡æ ·å¾—åˆ°$z$ï¼›</li><li>æ ¹æ®æ¡ä»¶åˆ†å¸ƒ$p_\theta(x|z;\theta)$è¿›è¡Œé‡‡æ ·å¾—åˆ°$x$ã€‚</li></ol><p>æ‰€ä»¥åœ¨ç”Ÿæˆæ¨¡å‹ä¸­çš„é‡ç‚¹æ˜¯ä¼°è®¡æ¡ä»¶åˆ†å¸ƒ$p(x|z;\theta)$ã€‚</p><h1 id="Parameter-Estimation-for-Hidden-Variable-with-EM-Algorithm"><a href="#Parameter-Estimation-for-Hidden-Variable-with-EM-Algorithm" class="headerlink" title="Parameter Estimation for Hidden Variable with EM Algorithm"></a>Parameter Estimation for Hidden Variable with EM Algorithm</h1><p>å¦‚æœå›¾æ¨¡å‹ä¸­å­˜åœ¨éšå˜é‡ï¼Œå°±éœ€è¦ä½¿ç”¨EMç®—æ³•è¿›è¡Œå‚æ•°ä¼°è®¡ã€‚</p><p>åœ¨ä¸€ä¸ªåŒ…å«éšå˜é‡çš„å›¾æ¨¡å‹ä¸­ï¼Œä»¤$\mathbf{X}$ä¸ºå¯è§‚æµ‹å˜é‡é›†åˆï¼Œ$\mathbf{Z}$ä¸ºéšå˜é‡é›†åˆï¼Œåˆ™ä¸€ä¸ªæ ·æœ¬$x$çš„è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p><p>$$p(x;\theta)=\sum_z p(x,z;\theta)$$</p><p>ç»™å®šåŒ…å«$N$ä¸ªè®­ç»ƒæ ·æœ¬çš„è®­ç»ƒé›†$\mathcal{D}={x^{(n)}},1\leq i\leq N$ï¼Œåˆ™è®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¸ºï¼š</p><p>$$\begin{align}\mathcal{L}(\mathcal{D};\theta)&amp;=\frac{1}{N}\sum_{n=1}^N \log p(x^{(n)};\theta)\&amp;=\frac{1}{N}\sum_{n=1}^N \log \sum_z p(x^{(n)},z;\theta)\end{align}$$</p><hr><p>è¿™æ—¶ï¼Œåªè¦æœ€å¤§åŒ–æ•´ä¸ªè®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶$\mathcal{L}(\mathcal{D};\theta)$ï¼Œå³å¯ä¼°è®¡å‡ºæœ€ä¼˜çš„å‚æ•°$\theta^*$ã€‚ä¸è¿‡åœ¨è®¡ç®—æ¢¯åº¦çš„æ—¶å€™ï¼Œéœ€è¦åœ¨å¯¹æ•°å‡½æ•°å†…éƒ¨è¿›è¡Œæ±‚å’Œæˆ–ç§¯åˆ†è®¡ç®—ã€‚ä¸ºäº†æ›´å¥½çš„è®¡ç®—$\log p(x;\theta)$ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªé¢å¤–çš„å˜åˆ†å‡½æ•°$q(z)$ï¼Œ$q(z)$ä¸ºå®šä¹‰åœ¨éšå˜é‡$z$ä¸Šçš„åˆ†å¸ƒã€‚æ ·æœ¬$x$çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p><p>$$\begin{align}\log p(x;\theta)&amp;=\log \sum_z q(z)\frac{p(x,z;\theta)}{q(z)}\&amp;\geq\sum_z q(z)\log \frac{p(x,z;\theta)}{q(z)}\&amp;\triangleq ELBO(q,x;\theta)\end{align}$$</p><p>å…¶ä¸­$ELBO(q,x;\theta)$ä¸ºå¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°$\log p(x;\theta)$çš„ä¸‹ç•Œï¼Œç§°ä¸ºè¯æ®ä¸‹ç•Œã€‚å…¬å¼ä¸­ä½¿ç”¨äº†Jensenä¸ç­‰å¼(å³å¯¹äºå‡¹å‡½æ•°$g$ï¼Œæœ‰$g(\mathbb{E}[x])\geq\mathbb{E}[g(X)]$)ã€‚åœ¨è¿™é‡Œï¼Œ$\frac{p(x,z;\theta)}{q(z)}$å¯è§†ä¸º$q(z)$çš„å‡½æ•°ï¼Œè®°ä¸º$f(q(z))$ï¼Œé‚£ä¹ˆ$f(q(z))$çš„æœŸæœ›å³$\mathbb{E}[f(q(z))]=\sum_z q(z)f(q(z))=\sum_z q(z)\frac{p(x,z;\theta)}{q(z)}$ã€‚è€Œæ ¹æ®Jensenä¸ç­‰å¼ï¼Œæœ‰$g(\mathbb{E}[f(q(z))])\geq\mathbb{E}[g(f(q(z)))]\Leftrightarrow g(\sum_z q(z)\frac{p(x,z;\theta)}{q(z)})\geq \sum_z q(z)g(\frac{p(x,z;\theta)}{q(z)})$ï¼Œåœ¨è¿™é‡Œ$g$å°±æ˜¯å¯¹æ•°å‡½æ•°ã€‚</p><hr><p>æ ¹æ®Jensenä¸ç­‰å¼å–ç­‰çš„æ¡ä»¶ï¼š$\frac{p(x,z;\theta)}{q(z)}=c$ï¼Œ$c$ä¸ºå¸¸æ•°ï¼Œæœ‰ï¼š</p><p>$$\begin{align}\sum_z p(x,z;\theta)&amp;=c\sum_z q(z)\\Leftrightarrow\sum_z p(x,z;\theta)&amp;=c\cdot1\end{align}$$</p><p>å› æ­¤ï¼š</p><p>$$\begin{align}q(z)&amp;=\frac{p(x,z;\theta)}{\sum_z p(x,z;\theta)}\&amp;=\frac{p(x,z;\theta)}{p(x;\theta)}\&amp;=p(z|x;\theta)\end{align}$$</p><p>æ‰€ä»¥ï¼Œå½“ä¸”ä»…å½“$q(z)=p(z|x;\theta)$æ—¶ï¼Œ$\log p(x;\theta)=ELBO(q,x;\theta)$ã€‚</p><hr><p>äºæ˜¯æœ€å¤§åŒ–å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°$\log p(x;\theta)$çš„è¿‡ç¨‹å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p><ol><li>å…ˆæ‰¾åˆ°è¿‘ä¼¼åˆ†å¸ƒ$q(z)$ä½¿å¾—$\log p(x;\theta)=ELBO(q,x;\theta)$ï¼›</li><li>å†å¯»æ‰¾å‚æ•°$\theta$æœ€å¤§åŒ–$ELBO(q,x;\theta)$ã€‚</li></ol><p>è¿™å°±æ˜¯æœŸæœ›æœ€å¤§åŒ–(Expectation-Maximum,EM)ç®—æ³•ã€‚</p><hr><p>EMç®—æ³•é€šè¿‡è¿­ä»£çš„æ–¹æ³•ï¼Œä¸æ–­é‡å¤ç›´åˆ°æ”¶æ•›åˆ°æŸä¸ªå±€éƒ¨æœ€ä¼˜è§£ã€‚åœ¨ç¬¬$t$æ­¥æ›´æ–°æ—¶ï¼ŒEæ­¥å’ŒMæ­¥åˆ†åˆ«ä¸ºï¼š</p><ol><li><p>Eæ­¥ï¼šå›ºå®šå‚æ•°$\theta_t$ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆ†å¸ƒä½¿$ELBO(q,x;\theta_t)$æœ€å¤§ï¼Œå³ç­‰äº$\log p(x;\theta_t)$ï¼š$q_{t+1}(z)=\text{arg}_q \max ELBO(q,x;\theta_t)$ï¼›</p></li><li><p>Mæ­¥ï¼šå›ºå®š$q_{t+1}(z)$ï¼Œæ‰¾åˆ°ä¸€ç»„å‚æ•°ä½¿å¾—è¯æ®ä¸‹ç•Œæœ€å¤§ï¼Œå³ï¼š$\theta_{t+1}=\text{arg}<em>\theta\max ELBO(q</em>{t+1},x;\theta)$ã€‚</p></li></ol><hr><p>å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ä¿¡æ¯è®ºçš„è§†è§’æ¥è¿›è¡Œåˆ†è§£ï¼š</p><p>$$\begin{align}\log p(x;\theta)&amp;=\sum_z q(z)\log p(x;\theta)\&amp;=\sum_z q(z)(\log p(x,z;\theta)-\log p(z|x;\theta))\&amp;=\sum_z q(z)\log\frac{p(x,z;\theta)}{q(z)}-\sum_z q(z)\log\frac{p(z|x;\theta)}{q(z)}\&amp;=ELBO(q,x;\theta)+D_{KL}(q(z)\parallel p(z|x;\theta))\end{align}$$</p><p>å…¶ä¸­$D_{KL}(q(z)\parallel p(z|x;\theta))$</p><h1 id="Generative-Model-with-Hidden-Variable"><a href="#Generative-Model-with-Hidden-Variable" class="headerlink" title="Generative Model with Hidden Variable"></a>Generative Model with Hidden Variable</h1><p>å‡è®¾ä¸€ä¸ªç”Ÿæˆæ¨¡å‹åŒ…å«ä¸å¯è§‚æµ‹çš„éšå˜é‡ï¼Œå…¶ä¸­å¯è§‚æµ‹å˜é‡$x$ä¸ºä¸€ä¸ªé«˜ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ï¼Œè€Œä¸å¯è§‚æµ‹çš„éšå˜é‡$z$ä¸ºä¸€ä¸ªç›¸å¯¹ä½ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ã€‚</p><p>è¿™ä¸ªç”Ÿæˆæ¨¡å‹çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å¯ä»¥è¡¨è¾¾ä¸ºï¼š</p><p>$$p(x,z;\theta)=p(x|z;\theta)p(z;\theta)$$</p><p>å…¶ä¸­$p(z;\theta)$ä¸ºéšå˜é‡$z$çš„å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒï¼›$p(x|z;\theta)$ä¸ºå·²çŸ¥$z$æ¡ä»¶ä¸‹$x$çš„æ¦‚ç‡åˆ†å¸ƒã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾$p(z;\theta)$å’Œ$p(x|z;\theta)$æœä»æŸç§å¸¦å‚çš„åˆ†å¸ƒæ—ï¼Œå…¶å½¢å¼å·²çŸ¥ï¼Œè€Œå‚æ•°å¯ä»¥é€šè¿‡æœ€å¤§ä¼¼ç„¶æ¥è¿›è¡Œä¼°è®¡ã€‚</p><p>ç»™å®šä¸€ä¸ªæ ·æœ¬$x$ï¼Œå…¶å¯¹æ•°è¾¹é™…ä¼¼ç„¶$\log p(x;\theta)$å¯ä»¥åˆ†è§£ä¸ºï¼š</p><p>$$\log p(x;\theta)=ELBO(q,x;\theta,\phi)+D_{KL}(q(z;\phi)\parallel p(z|x;\theta))$$</p><p>å…¶ä¸­$q(z;\phi)$ä¸ºé¢å¤–å¼•å…¥çš„å˜åˆ†å¯†åº¦å‡½æ•°ï¼Œ$ELBO(q,x;\theta,\phi)$ä¸ºè¯æ®ä¸‹ç•Œï¼š</p><p>$$ELBO(q,x;\theta,\phi)=\mathbb{E}_{z\sim q(z;\phi)}[\log{\frac{p(x,z;\theta)}{q(z;\phi)}}]$$</p><p>æœ€å¤§åŒ–$\log p(x;\theta)$å¯ä»¥ç”¨EMç®—æ³•æ¥æ±‚è§£ï¼š</p><ul><li><strong>E-step:</strong> å¯»æ‰¾ä¸€ä¸ªå¯†åº¦å‡½æ•°$q(z;\phi)$ä½¿å…¶ç­‰äºæˆ–æ¥è¿‘äºåéªŒå¯†åº¦å‡½æ•°$p(z|x;\theta)$;</li><li><strong>M-step:</strong> ä¿æŒ$q(z;\phi)$å›ºå®šï¼Œå¯»æ‰¾$\theta$æ¥æœ€å¤§åŒ–$ELBO(q,x;\theta,\phi)$ã€‚</li></ul><p>åœ¨EMç®—æ³•çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œç†è®ºä¸Šæœ€ä¼˜çš„$q(z;\phi)$ä¸ºéšå˜é‡çš„åéªŒæ¦‚ç‡å¯†åº¦å‡½æ•°$p(z|x;\theta)$ï¼š</p><p>$$p(z|x;\theta)=\frac{p(x|z;\theta)p(z;\theta)}{\int_z p(x|z;\theta)p(z;\theta)\text{d}z}$$</p><p>åéªŒå¯†åº¦å‡½æ•°$p(z|x;\theta)$çš„è®¡ç®—æ˜¯ä¸€ä¸ªç»Ÿè®¡æ¨æ–­çš„é—®é¢˜ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹$p(x|z;\theta)$ä¹Ÿæ¯”è¾ƒéš¾ä»¥è®¡ç®—ã€‚</p><h1 id="Variational-Autoencoder"><a href="#Variational-Autoencoder" class="headerlink" title="Variational Autoencoder"></a>Variational Autoencoder</h1><p>å˜åˆ†è‡ªç¼–ç å™¨(Variational Autoencoder, VAE)çš„ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥åˆ†åˆ«å»ºæ¨¡ä¸¤ä¸ªå¤æ‚çš„æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š</p><ol><li><p>ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿå˜åˆ†åˆ†å¸ƒ$q(z;\phi)$ï¼Œç§°ä¸ºæ¨æ–­ç½‘ç»œã€‚æ¨æ–­ç½‘ç»œçš„è¾“å…¥ä¸º$x$ï¼Œè¾“å‡ºä¸ºå˜åˆ†åˆ†å¸ƒ$q(z|x;\phi)$ï¼›</p></li><li><p>ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿæ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ï¼Œç§°ä¸ºç”Ÿæˆç½‘ç»œã€‚ç”Ÿæˆç½‘ç»œçš„è¾“å…¥ä¸º$z$ï¼Œè¾“å‡ºä¸ºæ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ã€‚</p><p><img src="https://i.loli.net/2020/06/24/B1d9UtTzNfjG6e2.png" srcset="/img/loading.gif" alt=""></p></li></ol><p>VAEçš„å›¾æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/24/GAhy281seQ3tbZT.png" srcset="/img/loading.gif" alt=""></p><h2 id="Variational-Network"><a href="#Variational-Network" class="headerlink" title="Variational Network"></a>Variational Network</h2><p>å‡è®¾$q(z|x;\phi)$æ˜¯æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼š</p><p>$$q(z|x;\phi)=\mathcal{N}(z;\mu_I,\sigma^2_I I)$$</p><p>å…¶ä¸­$\mu_I$å’Œ$\sigma_I^2$æ˜¯é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ï¼Œå¯ä»¥é€šè¿‡æ¨æ–­ç½‘ç»œ$f_I(x;\phi)$æ¥é¢„æµ‹ï¼š</p><p>$$<br>\left[\begin{matrix}\mu_I\\sigma_I\end{matrix}\right]=f_I(x;\phi)<br>$$<br>æ¨æ–­ç½‘ç»œ$f_I(x;\phi)$å¯ä»¥æ˜¯ä¸€èˆ¬çš„å…¨è¿æ¥ç½‘ç»œæˆ–å·ç§¯ç½‘ç»œï¼Œæ¯”å¦‚ä¸€ä¸ªä¸¤å±‚çš„ç¥ç»ç½‘ç»œï¼š</p><p>$$\begin{align}h&amp;=\sigma(W^{(1)}x+b^{(1)})\\mu_I&amp;=W^{(2)}h+b^{(2)}\\sigma_I&amp;=\text{softplus}(W^{(3)}h+b^{(3)})\end{align}$$</p><p>å…¶ä¸­æ‰€æœ‰ç½‘ç»œå‚æ•°${W^{(1)},W^{(2)},W^{(3)},b^{(1)},b^{(2)},b^{(3)}}$å³å¯¹åº”äº†å˜åˆ†å‚æ•°$\phi$ã€‚</p><hr><p>æ¨æ–­ç½‘ç»œçš„ç›®æ ‡æ˜¯ä½¿å¾—$q(z|x;\phi)$æ¥å°½å¯èƒ½æ¥è¿‘çœŸå®çš„åéªŒ$p(z|x;\theta)$ï¼Œéœ€è¦æ‰¾åˆ°å˜åˆ†å‚æ•°$\phi^*$æ¥æœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„KLæ•£åº¦ï¼š</p><p>$$\phi^*=\text{arg}<em>\phi\min{D</em>{KL}(q(z|x;\phi)\parallel p(z|x;\theta))}$$</p><p>ç”±äº$p(z|x;\theta)$æœªçŸ¥ï¼Œæ•…KLæ•£åº¦æ— æ³•ç›´æ¥è®¡ç®—ï¼Œä¸è¿‡ç”±äº$D_{KL}(q(z|x;\phi)\parallel p(z|x;\theta))=\log p(x;\theta)-ELBO(q,x;\theta,\phi)$ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œï¼Œæœ‰ï¼š</p><p>$$\phi^*=\text{arg}_\phi\max{ELBO(q,x;\theta,\phi)}$$</p><h2 id="Generative-Network"><a href="#Generative-Network" class="headerlink" title="Generative Network"></a>Generative Network</h2><p>ç”Ÿæˆæ¨¡å‹çš„è”åˆåˆ†å¸ƒå¯ä»¥åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†ï¼šéšå˜é‡$z$çš„å…ˆéªŒåˆ†å¸ƒ$p(z;\theta)$å’Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ã€‚ä¸ºç®€å•èµ·è§ï¼Œä¸€èˆ¬å‡è®¾éšå˜é‡$z$çš„å…ˆéªŒåˆ†å¸ƒä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ$\mathcal{N}(z|0,I)$ï¼Œéšå˜é‡æ¯ä¸€ç»´ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$å¯ä»¥é€šè¿‡ç”Ÿæˆç½‘ç»œæ¥å»ºæ¨¡ï¼Œæˆ‘ä»¬åŒæ ·ç”¨å‚æ•°åŒ–çš„åˆ†å¸ƒæ—æ¥è¡¨ç¤ºæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ï¼Œè¿™äº›åˆ†å¸ƒæ—çš„å‡½æ•°å¯ä»¥ç”¨ç”Ÿæˆç½‘ç»œè®¡ç®—å¾—åˆ°ã€‚æ ¹æ®å˜é‡$x$çš„ç±»å‹ä¸åŒï¼Œå¯ä»¥å‡è®¾$p(x|z;\theta)$æœä»ä¸åŒçš„åˆ†å¸ƒæ—ã€‚å¦‚æœ$x\in{0,1}^d$æ˜¯$d$ç»´çš„äºŒå€¼å‘é‡ï¼Œå¯ä»¥å‡è®¾$\log p(x|z;\theta)$æœä»å¤šå˜é‡çš„ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œå³ï¼š</p><p>$$\begin{align}p(x|z;\theta)&amp;=\prod\limits_{i=1}^d p(x_i|z;\theta)\&amp;=\prod\limits_{i=1}^d \gamma_i^{x_i}(1-\gamma_i)^{(1-x_i)}\end{align}$$</p><p>å¦‚æœ$x\in\mathbb{R}^d$æ˜¯$d$ç»´çš„è¿ç»­å‘é‡ï¼Œå¯ä»¥å‡è®¾$p(x|z;\theta)$æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼Œå³ï¼š</p><p>$$p(x|z;\theta)=\mathcal{N}(x;\mu_G,\sigma_G^2 I)$$</p><hr><p>ç”Ÿæˆç½‘ç»œçš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ç»„$\theta^*$æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œ$ELBO(q,x;\theta,\phi)$ï¼š</p><p>$$\theta^*=\text{arg}_\theta\max ELBO(q,x;\theta,\phi)$$</p><h2 id="Model-Combination"><a href="#Model-Combination" class="headerlink" title="Model Combination"></a>Model Combination</h2><p>æ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œçš„ç›®æ ‡éƒ½æ˜¯æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œå› æ­¤æ€»çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p><p>$$\begin{align}\max_{\theta,\phi}ELBO(q,x;\theta,\phi)&amp;=\max_{\theta,\phi}\mathbb{E}<em>{z\sim q(z;\phi)}[\log\frac{p(x|z;\theta)p(z;\theta)}{q(z;\theta)}]\&amp;=\max</em>{\theta,\phi}\mathbb{E}<em>{z\sim q(z|x;\phi)}[\log p(x|z;\theta)]-D</em>{KL}(q(z|x;\phi)\parallel p(z;\theta))\end{align}$$</p><p>å…¶ä¸­å…ˆéªŒåˆ†å¸ƒ$p(z;\theta)=\mathcal{N}(z|0,I)$ã€‚</p><p>å…¬å¼ä¸­$\mathbb{E}_{z\sim q(z|x;\phi)}[\log p(x|z;\theta)]$ä¸€èˆ¬é€šè¿‡é‡‡æ ·çš„æ–¹å¼è¿›è¡Œè®¡ç®—ï¼Œæœ€åå–å¹³å‡å€¼ã€‚</p><h2 id="Model-Training"><a href="#Model-Training" class="headerlink" title="Model Training"></a>Model Training</h2><p>ç»™å®šæ•°æ®é›†$\mathcal{D}$ï¼ŒåŒ…å«$N$ä¸ªä»æœªçŸ¥æ•°æ®åˆ†å¸ƒä¸­æŠ½å–çš„ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬$x^{(1)},x^{(2)},\cdots,x^{(N)}$ã€‚å˜åˆ†è‡ªç¼–ç å™¨çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p><p>$$\mathcal{J}(\phi,\theta|\mathcal{D})=\sum\limits_{n=1}^N(\frac{1}{M}\sum\limits_{m=1}^M\log p(x^{(n)}|z^{(n,m)};\theta)-D_{KL}(q(z|x^{(n)};\phi)\parallel\mathcal{N}(z;0,I)))$$</p><p>å¦‚æœé‡‡ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œæ¯æ¬¡ä»æ•°æ®é›†ä¸­é‡‡ä¸€ä¸ªæ ·æœ¬$x$ï¼Œç„¶åæ ¹æ®$q(z|x;\phi)$é‡‡ä¸€ä¸ªéšå˜é‡$z$ï¼Œåˆ™ç›®æ ‡å‡½æ•°å˜ä¸ºï¼š</p><p>$$\mathcal{J}(\phi,\theta|x)=\log p(x|z;\theta)-D_{KL}(q(z|x;\phi)\parallel\mathcal{N}(z;0,I))$$</p><p>å‡è®¾$q(z|x;\phi)$æ˜¯æ­£æ€åˆ†å¸ƒï¼ŒKLæ•£åº¦å¯ç›´æ¥ç®—å‡ºï¼š</p><p>$$D_{KL}(\mathcal{N}(\mu_1,\Sigma_1)\parallel\mathcal(\mu_2,\Sigma_2))\=\frac{1}{2}(\text{tr}(\sigma_I^2 I)+\mu_I^T\mu_I-d-\log(|\sigma_I^2 I|))$$</p><hr><p>å†å‚æ•°åŒ–æ˜¯å°†ä¸€ä¸ªå‚æ•°ä¸º$u$çš„å‡½æ•°$f(u)$ï¼Œé€šè¿‡ä¸€ä¸ªå‡½æ•°$u=g(v)$ï¼Œè½¬æ¢ä¸ºå‚æ•°ä¸º$v$çš„å‡½æ•°$\hat{f}(v)=f(g(v))$ã€‚åœ¨å˜åˆ†è‡ªç¼–ç å™¨ä¸­ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ±‚éšæœºå˜é‡$z$å…³äº$\phi$çš„å¯¼æ•°ã€‚ä½†ç”±äºæ˜¯é‡‡æ ·çš„æ–¹å¼ï¼Œæ— æ³•ç›´æ¥åˆ»ç”»$z$å’Œ$\phi$ä¹‹é—´çš„å‡½æ•°å…³ç³»ï¼Œå› æ­¤ä¹Ÿæ— æ³•è®¡ç®—å¯¼æ•°ã€‚</p><p>å¦‚æœ$z\sim q(z|x;\phi)$çš„éšæœºæ€§ç‹¬ç«‹äºå‚æ•°$\phi$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å†å‚æ•°åŒ–çš„æ–¹æ³•æ¥è®¡ç®—å¯¼æ•°ã€‚å‡è®¾$q(z|x;\phi)$ä¸ºæ­£æ€åˆ†å¸ƒ$\mathcal{N}(\mu_I,\sigma^2_I I)$ï¼Œå…¶ä¸­$\mu_I$å’Œ$\sigma_I$æ˜¯æ¨æ–­ç½‘ç»œ$f_I(x;\phi)$çš„è¾“å‡ºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼é‡‡æ ·$z$ï¼š</p><p>$$z=\mu_I+\sigma_I\odot \varepsilon$$</p><p>å…¶ä¸­$\varepsilon\sim\mathcal{N}(0,I)$ã€‚è¿™æ ·$z$å’Œ$\mu_I,\sigma_I$çš„å…³ç³»ä»é‡‡æ ·å…³ç³»å˜ä¸ºå‡½æ•°å…³ç³»ã€‚</p><hr><p>å¦‚æœè¿›ä¸€æ­¥å‡è®¾$p(x|z;\theta)$æœä»é«˜æ–¯åˆ†å¸ƒ$\mathcal{N}(x|\mu_G,I)$ï¼Œå…¶ä¸­$\mu_G=f_G(z;\theta)$æ˜¯ç”Ÿæˆç½‘ç»œçš„è¾“å‡ºï¼Œåˆ™ç›®æ ‡å‡½æ•°å¯ä»¥ç®€åŒ–ä¸ºï¼š</p><p>$$\mathcal{J}(\phi,\theta|x)=-\parallel x-\mu_G\parallel^2+D_{KL}(\mathcal{N}(\mu_I,\sigma_I)\parallel\mathcal{N}(0,I))$$</p><p>å…¶ä¸­ç¬¬ä¸€é¡¹å¯ä»¥è¿‘ä¼¼çœ‹ä½œæ˜¯è¾“å…¥$x$çš„é‡æ„æ­£ç¡®æ€§ï¼Œç¬¬äºŒé¡¹å¯ä»¥çœ‹ä½œæ˜¯æ­£åˆ™åŒ–é¡¹ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Tutorial</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Deep Learning</tag>
      
      <tag>Variational Inference</tag>
      
      <tag>VAE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Recurrent Neural Networks for Multivariate Time Series with Missing Values</title>
    <link href="/2019/10/18/Recurrent-Neural-Networks-for-Multivariate-Time-Series-with-Missing-Values/"/>
    <url>/2019/10/18/Recurrent-Neural-Networks-for-Multivariate-Time-Series-with-Missing-Values/</url>
    
    <content type="html"><![CDATA[<h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>æ–‡ä¸­æå‡ºäº†ä¸€ç§å¯ä»¥å¤„ç†å¸¦ç¼ºå¤±å€¼å¤šä¸ºæ—¶é—´åºåˆ—çš„GRUæ¨¡å‹ï¼š<strong>GRU-D</strong>ã€‚æœ¬æ¨¡å‹ä¸ä»…å¯ä»¥æ•æ‰æ—¶é—´åºåˆ—ä¸­çš„é•¿æœŸä¾èµ–æ¨¡å¼ï¼Œå¹¶ä¸”è¿˜èƒ½åˆ©ç”¨æ—¶é—´åºåˆ—ä¸­çš„ç¼ºå¤±æ¨¡å¼æ¥è¾¾åˆ°æ›´å¥½çš„æ—¶é—´åºåˆ—é¢„æµ‹æ•ˆæœã€‚</p><p><a href="https://www.nature.com/articles/s41598-018-24271-9" target="_blank" rel="noopener">åŸæ–‡</a></p><h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Notations"><a href="#Notations" class="headerlink" title="Notations"></a>Notations</h2><p>è®°åŒ…å«$D$ä¸ªå˜é‡çš„å¤šå˜é‡æ—¶é—´åºåˆ—ä¸º$X=(x_1,x_2,\cdots,x_T)^T\in\mathbb{R}^{T\times D}$ï¼Œå…¶ä¸­å¯¹äºæ¯ä¸ª$t\in{1,2,\cdots,T},x_t\in\mathbb{R}^D$è¡¨ç¤ºæ—¶é—´åºåˆ—åœ¨æ—¶é—´$t$çš„è§‚æµ‹å€¼ï¼Œ$x_t^d$è¡¨ç¤º$x_t$çš„ç¬¬$d$ä¸ªæˆåˆ†ã€‚è®°$s_t\in\mathbb{R}$ä¸º$t$æ—¶åˆ»çš„æ—¶é—´æˆ³ï¼Œå¹¶å‡è®¾ç¬¬ä¸€ä¸ªè§‚æµ‹å€¼çš„æ—¶é—´æˆ³ä¸º$0$ã€‚å¯¹äºåŒ…å«ç¼ºå¤±å€¼çš„æ—¶é—´åºåˆ—ï¼Œæˆ‘ä»¬ç”¨<strong>Masking Vector</strong> $m_t\in{0,1}$è¿›è¡Œæ ‡è®°ï¼ŒåŒæ—¶å¯¹æ¯ä¸ª$x_t^d$ç»´æŠ¤è·ç¦»ä¸Šä¸€ä¸ªè§‚æµ‹å€¼çš„<strong>Time Interval</strong> $\delta_t^d\in\mathbb{R}$ï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>m_t^d=\begin{cases}1, &amp;\text{if }x_t^d\text{ is observed}\0, &amp;\text{otherwise}\end{cases}<br>$$</p><p>$$<br>\delta_t^d=\begin{cases}s_t-s_{t-1}+\delta_{t-1}^d, &amp;t&gt;1,m_{t-1}^d=0\s_t-s_{t-1}, &amp;t&gt;1, m_{t-1}^d=1\0, &amp;t=1\end{cases}<br>$$</p><p>ä¸‹å›¾æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š</p><p><img src="https://i.loli.net/2020/06/25/C4FKQw2AZ9xkalo.png" srcset="/img/loading.gif" alt=""></p><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨æ—¶é—´åºåˆ—çš„åˆ†ç±»é—®é¢˜ï¼Œå³ç»™å®šæ•°æ®é›†$\mathcal{D}={(X_n,s_n,M_n)}_{n=1}^N$ï¼Œæˆ‘ä»¬è¦å¯¹æ¯ä¸ªæ ·æœ¬çš„ç±»åˆ«è¿›è¡Œé¢„æµ‹$l_n\in{1,\cdots,L}$ã€‚</p><h2 id="GRU-RNN-for-Time-Series-Classification"><a href="#GRU-RNN-for-Time-Series-Classification" class="headerlink" title="GRU-RNN for Time Series Classification"></a>GRU-RNN for Time Series Classification</h2><p>GRUæ˜¯ä¸€ç§æ”¹è¿›ç‰ˆæœ¬çš„RNNï¼Œå…¶æœ€å¤§ä¸åŒæ˜¯åŠ å…¥äº†é—¨æ§æœºåˆ¶ã€‚GRUå•å…ƒçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/wpKQsxEklizVTtm.png" srcset="/img/loading.gif" style="zoom: 33%;" /><p>GRUåŒ…å«äº†é‡ç½®é—¨å’Œæ›´æ–°é—¨ï¼Œå…¶ä¸­é‡ç½®é—¨$R_t$è´Ÿè´£æ§åˆ¶ä¸Šä¸€æ—¶é—´çš„éšçŠ¶æ€$h_{t-1}$æœ‰å¤šå°‘éƒ¨åˆ†éœ€è¦ä¿ç•™ï¼Œè€Œæ›´æ–°é—¨åˆ™å†³å®šç”±$R_t$è®¡ç®—å‡ºæ¥çš„å€™é€‰éšçŠ¶æ€$\tilde{h}<em>t$æœ‰å¤šå°‘éƒ¨åˆ†éœ€è¦ä¿ç•™ã€‚æœ€åå½“å‰æ—¶é—´çš„éšçŠ¶æ€ç”±$h</em>{t-1}$å’Œ$\tilde{h}<em>t$å…±åŒç®—å‡ºã€‚GRUçš„çŠ¶æ€æ›´æ–°å…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\begin{align}<br>R_t&amp;=\sigma(W_rx_t+U_rh</em>{t-1}+b_r)\<br>Z_t&amp;=\sigma(W_zx_t+U_zh_{t-1}+b_z)\<br>\tilde{h}<em>t&amp;=\text{tanh}(Wx_t+U(R_t\odot h</em>{t-1})+b)\<br>h_t&amp;=(1-Z_t)\odot h_{t-1}+Z_t\odot \tilde{h}_t<br>\end{align}<br>$$<br>æ–‡ä¸­æå‡ºäº†ä¸€äº›å¤„ç†ç¼ºå¤±å€¼çš„ç®€å•æ–¹æ³•ï¼š</p><ol><li>ç›´æ¥ç”¨å‡å€¼æ›¿ä»£ï¼š$x_t^d\leftarrow m_t^dx_t^d+(1-m_t^d)\tilde{x}^d$ï¼Œå…¶ä¸­$\tilde{x}^d=\frac{\sum_{n=1}^N\sum_{t=1}^{T_n}m_{t,n}^d x_{t,n}^d}{\sum_{n=1}^N\sum_{t=1}^{T_n}m_{t,n}^d\tilde{x}^d}$ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Mean</strong>ï¼›</li><li>ç”¨ä¸Šä¸€ä¸ªè§‚æµ‹å€¼æ›¿ä»£ï¼š$x_t^d\leftarrow m_t^d x_t^d+(1-m_t^d)x_{t^\prime}^d$ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Forward</strong>ï¼›</li><li>ä¸å¡«å……ï¼Œå°†æ˜¯å¦ç¼ºå¤±ï¼Œè·ç¦»ä¸Šä¸€ä¸ªè§‚æµ‹å€¼çš„æ—¶é—´ä½œä¸ºé¢å¤–ä¿¡æ¯è¾“å…¥ï¼š$x_t^{(n)}\leftarrow[x_t^{(n)};m_t^{(n)};\delta_t^{(n)}]$ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Simple</strong>ã€‚</li></ol><h3 id="GRU-D-Model-with-Trainable-Decays"><a href="#GRU-D-Model-with-Trainable-Decays" class="headerlink" title="GRU-D: Model with Trainable Decays"></a>GRU-D: Model with Trainable Decays</h3><p>æ–‡ä¸­æå‡ºäº†æ—¶é—´åºåˆ—ç¼ºå¤±å€¼çš„ä¸¤ä¸ªæ€§è´¨ï¼šä¸€ä¸ªæ˜¯åœ¨ä¸Šä¸€ä¸ªè§‚æµ‹å€¼è·ç¦»å¾ˆè¿œçš„æƒ…å†µä¸‹ç¼ºå¤±å€¼å€¾å‘äºæ¥è¿‘ä¸€ä¸ªé»˜è®¤çš„å€¼ï¼Œç¬¬äºŒä¸ªæ˜¯ç¼ºå¤±å€¼çš„å½±å“ä¼šéšç€æ—¶é—´å‡å¼±ã€‚ä¸ºäº†ä½“ç°ä¸Šè¿°ä¸¤ç‚¹ï¼Œæ–‡ä¸­æå‡ºäº†GPU-Dæ¨¡å‹ï¼Œæ¨¡å‹æ¡†æ¶å¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/aXbS4ADkLfeHPCR.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>åœ¨æ¨¡å‹ä¸­ï¼Œ<strong>Decay Rates</strong>è¢«è®¾å®šä¸ºä¸€ä¸ªå¸¦å‚æ•°çš„å‡½æ•°å’ŒGRUä¸€èµ·è®­ç»ƒï¼š<br>$$<br>\gamma_t=\exp{-\max(0,W_\gamma\delta_t+b_\gamma)}<br>$$</p><p>$$<br>\hat{x}<em>t^d=m_t^dx_t^d+(1-m_t^d)(\gamma</em>{x_t}^dx_{t^\prime}^d+(1-\gamma_{x_t}^d)\tilde{x}^d)<br>$$<br>å…¶ä¸­$x_{t^\prime}^d$æ˜¯ç¬¬$d$ä¸ªå˜é‡çš„ä¸Šä¸€ä¸ªè§‚æµ‹å€¼ï¼Œ$\tilde{x}^d$æ˜¯ç¬¬$d$ä¸ªå˜é‡çš„ç»éªŒå‡å€¼ã€‚è¿™æ ·$\hat{x}_t^d$å°±ä»£è¡¨ç»è¿‡<strong>Input Decay</strong>çš„è¾“å…¥ã€‚</p><p>æ–‡ä¸­æåˆ°åªç”¨<strong>Input Decay</strong>æ˜¯ä¸å¤Ÿçš„ï¼Œé™¤æ­¤ä¹‹å¤–ä½œè€…è¿˜ä½¿ç”¨äº†<strong>Hidden State Decay</strong>ï¼Œå³å¯¹$h_{t-1}$è¿›è¡ŒDecayï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\hat{h}<em>{t-1}=\gamma</em>{h_t}\odot h_{t-1}<br>$$<br>ç”¨Decayä¹‹åçš„$\hat{x}<em>t$å’Œ$\hat{h}</em>{t-1}$æ›¿æ¢åŸå§‹çš„GRUå…¬å¼å°±å¾—åˆ°äº†GRU-Dæ¨¡å‹ï¼š<br>$$<br>\begin{align}<br>R_t&amp;=\sigma(W_r\hat{x}<em>t-U_r\hat{h}</em>{t-1}+V_rm_t+b_r)\<br>Z_t&amp;=\sigma(W_z\hat{x}<em>t+U_z\hat{h}</em>{t-1}+V_zm_t+b_z)\<br>\tilde{h}<em>t&amp;=\text{tanh}(W\hat{x}_t+U(R_t\odot \hat{h}</em>{t-1})+Vm_t+b)\<br>h_t&amp;=(1-z_t)\odot \hat{h}_{t-1}+z_t\odot\tilde{h}_t<br>\end{align}<br>$$</p><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Baseline-Imputation-Methods"><a href="#Baseline-Imputation-Methods" class="headerlink" title="Baseline Imputation Methods"></a>Baseline Imputation Methods</h2><p>ä¸‹å›¾ä¸ºæ–‡ä¸­æ¯”è¾ƒä¸­ç”¨åˆ°çš„Baselineï¼š</p><p><img src="https://i.loli.net/2020/06/25/BFQdwMOXLc15mnl.png" srcset="/img/loading.gif" alt=""></p><h2 id="Baseline-Prediction-Methods"><a href="#Baseline-Prediction-Methods" class="headerlink" title="Baseline Prediction Methods"></a>Baseline Prediction Methods</h2><p>ä¸‹å›¾ä¸ºæ–‡ä¸­ç”¨åˆ°çš„ç”¨æ¥é¢„æµ‹çš„Baselineï¼š</p><p><img src="https://i.loli.net/2020/06/25/qFxDRBLvNpAIjMs.png" srcset="/img/loading.gif" alt=""></p><h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>æ–‡ä¸­ç”¨åˆ°çš„æ•°æ®é›†å¦‚ä¸‹ï¼š</p><ul><li><em>Gesture phase segmentation dataset (Gesture)</em>. </li><li><em>PhysioNet Challenge 2012 dataset (PhysioNet)</em>.</li><li><em>MIMIC-â…¢ dataset (MIMIC-â…¢)</em>. </li></ul><p>ä¸‹å›¾å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨äººå·¥åˆæˆæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š</p><p><img src="https://i.loli.net/2020/06/25/6GVYuxoFP5yHAjf.png" srcset="/img/loading.gif" alt=""></p><p>ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ¨¡å‹åœ¨é¢„æµ‹ä»»åŠ¡è¡¨ç°çš„å¯¹æ¯”ï¼š</p><img src="https://i.loli.net/2020/06/25/qTZsgtGewh19Y8V.png" srcset="/img/loading.gif" style="zoom: 67%;" /><p>ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨MIMIC-â…¢å’ŒPhysioNetæ•°æ®é›†ä¸Šçš„å¤šä»»åŠ¡è¡¨ç°ï¼š</p><p><img src="https://i.loli.net/2020/06/25/dQiqebwYTCVfm5W.png" srcset="/img/loading.gif" alt=""></p><p>ä¸‹å›¾åˆ†åˆ«å±•ç¤ºäº†æ¨¡å‹å­¦åˆ°çš„<strong>Input Decay</strong>å’Œ<strong>Hidden State Decay</strong>ï¼š</p><img src="https://i.loli.net/2020/06/25/2F7MrgOXA9nuZqC.png" srcset="/img/loading.gif" style="zoom:67%;" />]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>RNN</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>RNN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network</title>
    <link href="/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/"/>
    <url>/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/</url>
    
    <content type="html"><![CDATA[<h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>æœ¬æ–‡æå‡ºäº†<em>OmniAnomaly</em>ï¼šä¸€ç§é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—çš„éšæœºå¾ªç¯ç¥ç»ç½‘ç»œå¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚è¯¥æ¨¡å‹è¿ç”¨äº†ä¸€ç³»åˆ—æŠ€æœ¯æ¥æ•æ‰å¤šå˜é‡æ—¶é—´åºåˆ—çš„æ­£å¸¸æ¨¡å¼ï¼Œå¹¶åœ¨æ£€æµ‹é˜¶æ®µåŸºäºé‡æ„è¯¯å·®æ¥æ£€æµ‹å¼‚å¸¸ï¼ŒåŒæ—¶æœ¬æ–‡è¿˜æä¾›äº†ä¸€å®šçš„ç†è®ºè§£é‡Šã€‚</p><p><a href="https://www.kdd.org/kdd2019/accepted-papers/view/robust-anomaly-detection-for-multivariate-time-series-through-stochastic-re" target="_blank" rel="noopener">åŸæ–‡</a></p><h1 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h1><ol><li>æå‡ºäº†<em>OmniAnomaly</em>ï¼Œä¸€ç§åŸºäºéšæœºå¾ªç¯ç¥ç»ç½‘ç»œçš„å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼›</li><li>æå‡ºäº†é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„è§£é‡Šæ–¹æ³•ï¼›</li><li>é€šè¿‡å®éªŒè¯æ˜äº†<em>OmniAnomaly</em>ä¸­æ‰€ç”¨çš„å…³é”®æŠ€æœ¯çš„æœ‰æ•ˆæ€§ï¼ŒåŒ…æ‹¬GRUï¼Œplanar NF, stochastic variable connectionå’Œadjusted Peaks-Over-Threshold methodï¼›</li><li>é€šè¿‡å¤§é‡çš„å®éªŒæˆ‘ä»¬è¯æ˜äº†<em>OmniAnomaly</em>çš„æœ‰æ•ˆæ€§ï¼›</li><li>å‘å¸ƒäº†ä»£ç å’Œæ•°æ®é›†ã€‚</li></ol><h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><h2 id="Linear-Gaussian-State-Space-Model"><a href="#Linear-Gaussian-State-Space-Model" class="headerlink" title="Linear Gaussian State Space Model"></a>Linear Gaussian State Space Model</h2><p>çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆState Space Model, SSMï¼‰çš„æ¦‚å¿µæ¥è‡ªäºæ§åˆ¶ç†è®ºï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®¨è®ºå…¶åœ¨æ—¶é—´åºåˆ—ä¸­çš„åº”ç”¨ã€‚å…¶å¤§æ¦‚æ€æƒ³æ˜¯æˆ‘ä»¬è®¤ä¸ºæ—¶é—´åºåˆ—åœ¨æ—¶åˆ»$t$çš„è§‚æµ‹å€¼$z_t$æ˜¯ä¸€ä¸ªéšå«çŠ¶æ€$\boldsymbol{l}<em>t$çš„æ¡ä»¶åˆ†å¸ƒ$p(z_t|\boldsymbol{l}_t)$ï¼Œè€Œè¿™ä¸ªéšå«çŠ¶æ€$\boldsymbol{l}_t$åˆ»ç”»äº†æ—¶é—´åºåˆ—çš„å†…åœ¨è§„å¾‹ï¼ŒåŒæ—¶éšå«çŠ¶æ€ä¼šéšç€æ—¶é—´æ›´æ–°ï¼Œå³æœä»æ¡ä»¶åˆ†å¸ƒ$p(\boldsymbol{l}_t|\boldsymbol{l}</em>{t-1})$ã€‚</p><p>åœ¨çº¿æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆLinear State Space Modelï¼‰ä¸­æˆ‘ä»¬ä»¥å¦‚ä¸‹çš„æ–¹å¼åˆ»ç”»éšå«çŠ¶æ€çš„æ›´æ–°ï¼š<br>$$<br>\boldsymbol{l}<em>t=\boldsymbol{F}_t\boldsymbol{l}</em>{t-1}+\boldsymbol{g}_t\varepsilon_t, \space\space\space\varepsilon_t\sim\mathcal{N}(0,1)<br>$$<br>$\boldsymbol{F}_t$ä¸ºç¡®å®šçš„çŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œè€Œ$\boldsymbol{g}_t\varepsilon_t$åˆ™è¡¨ç¤ºäº†çŠ¶æ€è½¬ç§»çš„éšæœºæ€§ã€‚</p><p>è§‚æµ‹å€¼$z_t$ä»éšå«çŠ¶æ€$\boldsymbol{l}<em>t$è®¡ç®—è€Œæ¥ï¼š<br>$$<br>\begin{align}<br>z_t&amp;=y_t+\sigma_t\epsilon_t,\<br>y_t&amp;=\boldsymbol{a}_t^\top\boldsymbol{l}</em>{t-1}+b_t,\<br>\epsilon_t&amp;\sim\mathcal{N}(0,1)<br>\end{align}<br>$$<br>å…¶ä¸­$\boldsymbol{a}_t\in\mathbb{R}^L,\sigma_t\in \mathbb{R},b_t\in\mathbb{R}$éƒ½æ˜¯é¢å¤–çš„å‚æ•°ã€‚åˆå§‹çŠ¶æ€$\boldsymbol{l}_0$åˆ™ä»ä¸€ä¸ªç‹¬ç«‹çš„é«˜æ–¯åˆ†å¸ƒå¾—æ¥ï¼Œå³$\boldsymbol{l}_0\sim N(\boldsymbol\mu_0,\text{diag}(\boldsymbol{\sigma}_0^2))$ã€‚</p><p>ä»¤å‚æ•°é›†åˆ$\Theta_t=(\boldsymbol{\mu}<em>0,\boldsymbol{\Sigma}_0,\boldsymbol{F}_t,\boldsymbol{g}_t,\boldsymbol{a}_t,b_t,\sigma_t),\forall t&gt;0$ï¼Œä¸€èˆ¬æ¥è¯´å‚æ•°é›†åˆä¸ä¼šéšç€æ—¶é—´å˜åŒ–ï¼Œå³æ¯ä¸ªæ—¶åˆ»$t$å…±äº«åŒæ ·çš„å‚æ•°$\Theta_t=\Theta,\forall t&gt;0$ã€‚å¯¹å‚æ•°çš„ä¼°è®¡å¯ä»¥é‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ï¼š<br>$$<br>\begin{align}<br>\Theta^*</em>{1:T}&amp;=\arg\max_{\Theta_{1:T}}p(z_{1:T}|\Theta_{1:T}),\<br>\end{align}<br>$$<br>å…¶ä¸­ï¼š<br>$$<br>\begin{align}<br>p(z_{1:T}|\Theta_{1:T})&amp;=p(z_1|\Theta_1)\prod\limits_{t=2}^T p(z_t|z_{1:t-1},\Theta_{1:t})\<br>&amp;=\int p(\boldsymbol{l}<em>0)\left[\prod\limits</em>{t=1}^T p(z_t|\boldsymbol{l}<em>t)p(\boldsymbol{l}_t|\boldsymbol{l}</em>{t-1})\right]\mathrm{d}\boldsymbol{l}_{0:T}<br>\end{align}<br>$$</p><h2 id="Planar-Normalizing-Flow"><a href="#Planar-Normalizing-Flow" class="headerlink" title="Planar Normalizing Flow"></a>Planar Normalizing Flow</h2><h3 id="Normalizing-Flows"><a href="#Normalizing-Flows" class="headerlink" title="Normalizing Flows"></a>Normalizing Flows</h3><p>VAEé‡‡ç”¨ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ$q_\phi(z|x)$æ¥è¿‘ä¼¼çœŸå®çš„åéªŒåˆ†å¸ƒ$p(z|x)$ï¼Œå¹¶æ¨å¯¼å‡º$\log p_\theta(x)$çš„ä¸‹ç•Œï¼ˆç§°ä¸ºELBOï¼‰æ¥ä½œä¸ºä¼˜åŒ–ç›®æ ‡å‡½æ•°ï¼š<br>$$<br>\begin{align}<br>\log p_\theta(x)&amp;=\log \int p_\theta(x|z)p(z)\mathrm{d}z\<br>&amp;=\log\int\frac{q_\phi(z|x)}{q_\phi(z|x)}p_\theta(x|z)p(z)\mathrm{d}z\<br>&amp;\geq-D_{KL}[q_\phi(z|x)\parallel p(z)]+\mathbb{E}<em>q[\log p_\theta(x|z)]<br>\end{align}<br>$$<br>$\log p_\theta(x)$ä¸ELBOå–ç­‰çš„æ¡ä»¶æ˜¯$D</em>{KL}[q_\phi(z|x)\parallel p(z)]$ï¼Œè¡¨æ˜å˜åˆ†åˆ†å¸ƒå®Œå…¨åŒ¹é…äº†çœŸå®çš„åéªŒåˆ†å¸ƒã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒçœŸå®çš„åéªŒåˆ†å¸ƒå¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œè€Œæˆ‘ä»¬çš„å˜åˆ†åˆ†å¸ƒé€šå¸¸æ˜¯ä¸€ä¸ªç¡®å®šçš„è¾ƒä¸ºç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚è¿™æ ·å˜åˆ†åˆ†å¸ƒå¯èƒ½å¾ˆéš¾å¯¹çœŸå®åéªŒåˆ†å¸ƒå¾—åˆ°ä¸€ä¸ªå¾ˆå¥½çš„æ‹Ÿåˆã€‚</p><p>ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ ‡å‡†åŒ–æµï¼ˆNormalizing Flowsï¼‰ã€‚æ ‡å‡†åŒ–æµæ˜¯ä»ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒå‡ºå‘ï¼Œæ‰§è¡Œä¸€ç³»åˆ—å¯é€†çš„æ˜ å°„ï¼Œå°†åŸå§‹ç®€å•çš„åˆ†å¸ƒè½¬åŒ–ä¸ºä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒã€‚</p><p>é¦–å…ˆè€ƒè™‘ä¸€ä¸ªå…‰æ»‘çš„ã€å¯é€†çš„æ˜ å°„$f:\mathbb{R}^d\mapsto \mathbb{R}^d$ï¼Œè®°$g=f^{-1}$ï¼Œé‚£ä¹ˆ$g\circ f(\mathbf{z})=\mathbf{z}$ã€‚ä»¤$\mathbf{z}^\prime=f(\mathbf{z})$ï¼Œé‚£ä¹ˆ$\mathbf{z}^\prime$çš„åˆ†å¸ƒä¸ºï¼š<br>$$<br>q(\mathbf{z}^\prime)=q(\mathbf{z})\left|\text{det}\frac{\partial f^{-1}}{\partial \mathbf{z}^\prime}\right|=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}<br>$$<br>å¼ä¸­$q(\mathbf{z}^\prime)=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}$è¯´æ˜äº†$\mathbf{z}^\prime$çš„åˆ†å¸ƒç­‰äº$\mathbf{z}$çš„åˆ†å¸ƒä¹˜ä¸Š$f$çš„JacobiançŸ©é˜µçš„è¡Œåˆ—å¼çš„å€’æ•°ã€‚é‚£ä¹ˆå¯¹äºæ˜ å°„å¤šæ¬¡çš„æƒ…å†µï¼š<br>$$<br>\mathbf{z}<em>K=f_K\circ\cdots\circ f_2\circ f_1(\mathbf{z}_0)<br>$$<br>$\mathbf{z}_K$çš„åˆ†å¸ƒå¯ä»¥é€šè¿‡é“¾å¼è®¡ç®—å¾—åˆ°ï¼š<br>$$<br>\ln q_K(\mathbf{z}_K)=\ln q_0(\mathbf{z}_0)-\sum\limits</em>{k=1}^K\ln\left|\text{det}\frac{\partial f_k}{\partial \mathbf{z}_{k-1}}\right|<br>$$</p><h3 id="Planar-Flows"><a href="#Planar-Flows" class="headerlink" title="Planar Flows"></a>Planar Flows</h3><p>è€ƒè™‘ä¸€ä¸ªå˜æ¢æ—ï¼š<br>$$<br>f(\mathbf{z})=\mathbf{z}+\mathbf{u}h(\mathbf{w}^\top\mathbf{z}+b)<br>$$<br>å…¶ä¸­$\lambda={\mathbf{w}\in \mathbb{R}^d,\mathbf{u}\in\mathbb{R}^d,b\in\mathbb{R}}$ä¸ºå‚æ•°é›†åˆï¼Œ$h(\cdot)$ä¸ºå…ƒç´ çº§çš„éçº¿æ€§å‡½æ•°ï¼ˆå¦‚å„ç§æ¿€æ´»å‡½æ•°ï¼‰ã€‚ä»¤$\psi(\mathbf{z})=h^\prime(\mathbf{w}^\top\mathbf{z}+b)\mathbf{w}$ï¼Œåˆ™$f$çš„JacobiançŸ©é˜µè¡Œåˆ—å¼ç»å¯¹å€¼ç­‰äºï¼š<br>$$<br>\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|=\left|\text{det}(\mathbf{I}+\mathbf{u}\psi(\mathbf{z})^\top)\right|=\left|1+\mathbf{u}^\top\psi(\mathbf{z})\right|<br>$$<br>ä½†æ˜¯$f$å¹¶ä¸ä¿è¯æ€»æ˜¯å¯é€†çš„ï¼Œå¦‚$h(x)=\tanh(x)$æ—¶ï¼Œ$f$å¯é€†çš„æ¡ä»¶æ˜¯$\mathbf{w}^\top \mathbf{u}\geq-1$ã€‚</p><p>ä¸‹é¢è®¨è®ºå¦‚ä½•ä¿è¯å¯é€†çš„æ¡ä»¶ã€‚è€ƒè™‘å°†$\mathbf{z}$åˆ†è§£ä¸º$\mathbf{z}=\mathbf{z}_\bot+\mathbf{z}_\parallel$ï¼Œå…¶ä¸­$\mathbf{z}_\bot$ä¸$\mathbf{w}$æ­£äº¤ï¼Œ$\mathbf{z}_\parallel$ä¸$\mathbf{w}$å¹³è¡Œï¼Œé‚£ä¹ˆï¼š<br>$$<br>f(z)=\mathbf{z}_\bot+\mathbf{z}_\parallel+\mathbf{u}h(\mathbf{w}^\top \mathbf{z}_\parallel +b)<br>$$<br>å®é™…ä¸Šå¾—åˆ°$\mathbf{z}_\parallel$ä¹‹åå¯ä»¥å¾ˆå®¹æ˜“çš„å¾—åˆ°$\mathbf{z}_\bot$ï¼Œä»¤$\mathbf{y}=f(\mathbf{z})$ï¼Œæœ‰ï¼š<br>$$<br>\mathbf{z}_\bot=\mathbf{y}-\mathbf{z}_\parallel-\mathbf{u}h(\mathbf{w}^\top\mathbf{z}_\parallel+b)<br>$$<br>è€Œ$\mathbf{z}_\parallel$ä¸$\mathbf{w}$å¹³è¡Œï¼Œæ˜“çŸ¥$\mathbf{z}_\parallel=\alpha\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}$ï¼Œå…¶ä¸­$\alpha\in\mathbb{R}$ã€‚</p><p>å¯¹å¼(16)ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥$\mathbf{w}^\top$å¯å¾—ï¼š<br>$$<br>\mathbf{w}^\top f(\mathbf{z})=\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)<br>$$<br>å½“$\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)$å¯¹äº$\alpha$æ˜¯éé€’å‡å‡½æ•°çš„æ—¶å€™ï¼Œ$f$æ˜¯å¯é€†çš„ã€‚å› ä¸º$\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)$æ˜¯éé€’å‡å‡½æ•°æ—¶æœ‰$1+\mathbf{w}^\top\mathbf{u}h^\prime(\alpha+b)\geq 0\equiv \mathbf{w}^\top \mathbf{u}\geq -\frac{1}{h^\prime(\alpha + b)}$ï¼Œè€Œ$0\leq h^\prime(\alpha + b) \leq 1$ï¼ˆ$\tanh$å‡½æ•°çš„æ€§è´¨ï¼‰ï¼Œæ‰€ä»¥æ€»æ˜¯æœ‰$\mathbf{w}^\top \mathbf{u}\geq-1$ã€‚</p><p>å¯¹äºä»»æ„ä¸€ä¸ª$\mathbf{u}$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ–¹å¼æ„é€ ä¸€ä¸ª$\hat{\mathbf{u}}$ä½¿å¾—$\mathbf{w}^\top\hat{\mathbf{u}}&gt;-1$ï¼Œå³ä»¤$\hat{\mathbf{u}}(\mathbf{w},\mathbf{u})=\mathbf{u}+[m(\mathbf{w}^\top\mathbf{u})-(\mathbf{w}^\top\mathbf{u})]\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}$ï¼Œå…¶ä¸­$m(x)=-1+\log(1+e^x)$ã€‚</p><p><img src="https://i.loli.net/2020/06/25/uPyplhWBazROEw4.png" srcset="/img/loading.gif" alt=""></p><h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h2><p>æœ¬æ–‡é’ˆå¯¹çš„æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—$x={x_1,x_2,\cdots,x_N}\in R^{M\times N}$ï¼Œ$N$ä¸ºæ—¶é—´é•¿åº¦ï¼Œå…¶ä¸­æŸä¸€æ—¶åˆ»çš„è§‚æµ‹å€¼$x_t\in R^M$ä¸ºä¸€ä¸ª$M$ç»´çš„å‘é‡ã€‚ä½œè€…ä½¿ç”¨$x_{t-T:t}\in R^{M\times(T+1)}$æ¥è¡¨ç¤º$t-T$åˆ°$t$ä¹‹é—´çš„æ—¶é—´åºåˆ—ã€‚</p><p><img src="https://i.loli.net/2020/06/25/4eHhs82uOzI5tG3.png" srcset="/img/loading.gif" alt=""></p><h2 id="Overall-Structure"><a href="#Overall-Structure" class="headerlink" title="Overall Structure"></a>Overall Structure</h2><p>ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/wd8maAoVb3Fk9vP.png" srcset="/img/loading.gif" alt=""></p><p>é¢„å¤„ç†æ¨¡å—ä¸»è¦æ˜¯å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ä»¥åŠçª—å£åˆ‡åˆ†ã€‚è®­ç»ƒæ¨¡å—åˆ™æ ¹æ®è¾“å…¥çš„æ•°æ®å¯¹æ­£å¸¸æ¨¡å¼è¿›è¡Œæ•æ‰ï¼Œè¾“å‡ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨çº¿æ£€æµ‹æ¨¡å—åˆ™ä¼šå®šæœŸæ‰§è¡Œã€‚</p><h2 id="Network-Architecture"><a href="#Network-Architecture" class="headerlink" title="Network Architecture"></a>Network Architecture</h2><p>æ¨¡å‹çš„æ€»ä½“ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/06/25/Lp7D81EvxVsywXQ.png" srcset="/img/loading.gif" alt=""></p><p>åœ¨qnetä¸­ï¼Œé¦–å…ˆGRUè¢«ç”¨æ¥å»ºæ¨¡æ ·æœ¬çš„æ—¶é—´ä¾èµ–å…³ç³»ï¼Œä¹‹åVAEå°†æ ·æœ¬$\mathbf{x}$æ˜ å°„åˆ°éšç©ºé—´$\mathbf{z}$ã€‚æ–‡ä¸­ä½¿ç”¨äº†Linear Gaussian State Space Modelæ¥å»ºæ¨¡éšå˜é‡ä¹‹é—´çš„æ—¶é—´ä¾èµ–å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜ä½¿ç”¨äº†Planar Normalizing Flowæ¥å°†éšå˜é‡æ˜ å°„åˆ°å¤æ‚çš„éé«˜æ–¯åˆ†å¸ƒã€‚åœ¨pnetä¸­ï¼Œéšå˜é‡$\mathbf{z}<em>{t-T:t}$è¢«ç”¨æ¥é‡å»º$\mathbf{x}</em>{t-T:t}$ï¼Œç›´è§‚ä¸Šæ¥è¯´ï¼Œå¯¹æ ·æœ¬çš„å¥½çš„éšå˜é‡è¡¨ç¤ºå¯ä»¥å¸¦æ¥æ›´å¥½çš„é‡æ„æ•ˆæœã€‚</p><p>ä»ç»†èŠ‚ä¸Šæ¥è¯´ï¼Œåœ¨æ—¶é—´$t$ï¼Œqnetçš„è¾“å…¥ä¸º$\mathbf{x}<em>t$å’Œ$\mathbf{e}</em>{t-1}$ï¼Œä¸¤è€…ç»è¿‡GRU Cellä¹‹åä¼šäº§ç”Ÿ$t$æ—¶é—´çš„$\mathbf{e_t}$ã€‚$\mathbf{e}<em>t$æ˜¯GRUæ•æ‰æ—¶é—´ä¾èµ–æ€§çš„å…³é”®ï¼Œå¯ä»¥è®¤ä¸ºå®ƒåŒ…å«äº†$\mathbf{x}</em>{1:t}$çš„ä¿¡æ¯ã€‚ä¹‹å$\mathbf{e}<em>t$ä¼šå’Œ$\mathbf{z}</em>{t-1}$è¿›è¡Œæ‹¼æ¥ï¼Œè¿›å…¥æ ‡å‡†çš„VAEå˜åˆ†ç½‘ç»œç»“æ„ï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„å‚æ•°$\mu_{z_t},\sigma_{z_t}$é‡‡æ ·å¾—åˆ°éšå˜é‡$\mathbf{z}_t^0$ï¼Œæ­¤æ—¶éšå˜é‡å¯ä»¥è¯´æ•æ‰äº†æ—¶é—´ä¾èµ–æ€§ã€‚</p><p>ç½‘ç»œä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>$$<br>\begin{align}<br>e_t&amp;=(1-c_t^e)\circ\text{tanh}(w^ex_t+u^e(r_t^e\circ e_{t-1})+b^e)+c_t^e\circ e_{t-1}\<br>\mu_{z_t}&amp;=w^{\mu_z}h^\phi([z_{t-1},e_t])+b^{\mu_z}\<br>\sigma_{z_t}&amp;=\text{softplus}(w^{\sigma_z}h^\phi([z_{t-1},e_t])+b^{\sigma_z})+\epsilon^{\sigma_z}<br>\end{align}<br>$$</p><p>å…¶ä¸­$r_t^e=\text{sigmoid}(\mathbf{w}^{r^e}\mathbf{x}<em>t+\mathbf{u}^{r^e}\mathbf{e}</em>{t-1}+b^{r^e})$æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ$c_t^e=\text{sigmoid}(\mathbf{w}^{c^e}\mathbf{x}<em>t+\mathbf{u}^{c^e}\mathbf{e}</em>{t-1}+b^{c^e})$æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p><p>æ­¤æ—¶$\mathbf{z}_t^0$æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸ºäº†æ‹Ÿåˆå¤æ‚çš„åéªŒåˆ†å¸ƒï¼Œæˆ‘ä»¬ä½¿ç”¨Planar Normalizing Flowæ¥å¯¹$\mathbf{z}_t^0$è¿›è¡Œå˜æ¢ï¼Œæœ€åå¾—åˆ°ç»$K$æ¬¡å˜æ¢åçš„éšæœºå˜é‡$\mathbf{z}_t^K$ã€‚</p><p>åœ¨æ—¶é—´$t$ï¼Œpnetè¯•å›¾é€šè¿‡$\mathbf{z}<em>t^K$æ¥é‡æ„$\mathbf{x}_t$ã€‚é¦–å…ˆ$\mathbf{z}$ç©ºé—´ä¸­çš„å˜é‡ä¼šæ ¹æ®Linear Gaussian State Space Modelæ¥è¿›è¡Œâ€œè¿æ¥â€œï¼Œå…¬å¼ä¸º$\mathbf{z}_t=\mathbf{O}_\theta(\mathbf{T}_\theta\mathbf{z}</em>{t-1}+\mathbf{v}<em>t)+\boldsymbol{\epsilon}_t$ï¼Œå…¶ä¸­$\mathbf{O}_\theta$å’Œ$\mathbf{T}_\theta$ä¸ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œ$\mathbf{v}_t$å’Œ$\boldsymbol{\epsilon}_t$ä¸ºéšæœºå™ªå£°ã€‚ä¹‹å$\mathbf{z}_t$å’Œ$\mathbf{d}</em>{t-1}$ä¼šä½œä¸ºGRUçš„è¾“å…¥ï¼Œäº§ç”Ÿ$\mathbf{d}<em>t$ã€‚ä¹‹å$\mathbf{d}_t$ä¼šç»è¿‡æ ‡å‡†VAEä¸­çš„ç”Ÿæˆç½‘ç»œï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„é«˜æ–¯åˆ†å¸ƒå‚æ•°$\mu</em>{x_t},\sigma_{x_t}$é‡‡æ ·å¾—åˆ°é‡æ„åçš„æ ·æœ¬$\mathbf{x}^\prime_t$ã€‚pnetä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š<br>$$<br>\begin{align}<br>d_t&amp;=(1-c_t^d)\circ\text{tanh}(w^dz_t+u^d(r_t^d\circ d_{t-1})+b^d)+c_t^d\circ d_{t-1}\<br>\mu_{x_t}&amp;=w^{\mu_x}h^\theta(d_t)+b^{\mu_x}\<br>\sigma_{x_t}&amp;=\text{softplus}(w^{\sigma_x}h^\theta(d_t)+b^{\sigma_x})+\epsilon^{\sigma_x}<br>\end{align}<br>$$</p><p>å…¶ä¸­$r_t^d=\text{sigmoid}(\mathbf{w}^{r^d}\mathbf{x}<em>t+\mathbf{u}^{r^d}\mathbf{d}</em>{t-1}+b^{r^d})$æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ$c_t^d=\text{sigmoid}(\mathbf{w}^{c^d}\mathbf{x}<em>t+\mathbf{u}^{c^d}\mathbf{d}</em>{t-1}+b^{c^d})$æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p><h2 id="Offline-Model-Training"><a href="#Offline-Model-Training" class="headerlink" title="Offline Model Training"></a>Offline Model Training</h2><p>å’Œä¼ ç»ŸVAEç±»ä¼¼ï¼Œæ¨¡å‹çš„è®­ç»ƒå¯ä»¥é€šè¿‡ä¼˜åŒ–ELBOæ¥å®Œæˆã€‚è®°é•¿åº¦ä¸º$T+1$çš„è¾“å…¥åºåˆ—ä¸º$\mathbf{x}<em>{t-T:t}$ï¼Œéšç©ºé—´å˜é‡é‡‡æ ·æ¬¡æ•°ä¸º$L$ï¼Œç¬¬$l$ä¸ªéšç©ºé—´å˜é‡ä¸º$\mathbf{l}^{(l)}</em>{t-T:t}$ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p><p>$$<br>\tilde{\mathcal{L}}(\mathbf{x}<em>{t-T:t})\approx\frac{1}{L}\sum</em>{t=1}^L[\log(p_\theta(\mathbf{x}<em>{t-T:t}|\mathbf{z}</em>{t-T:t}^{(l)}))+\log(p_\theta(\mathbf{z}<em>{t-T:t}^{(l)}))-\log(q_\phi(\mathbf{z}</em>{t-T:t}^|\mathbf{x}_{t-T:t}))]<br>$$</p><p>ç¬¬ä¸€é¡¹$\log(p_\theta(\mathbf{x}<em>{t-T:t}|\mathbf{z}</em>{t-T:t}^{(l)}))$å¯ä»¥çœ‹ä½œæ˜¯é‡æ„è¯¯å·®ï¼›ç¬¬äºŒé¡¹$\log(p_\theta(\mathbf{z}<em>{t-T:t}))=\sum</em>{i=t-T}^t \log(p_\theta(\mathbf{z}<em>i|\mathbf{z}</em>{i-1}))$é€šè¿‡Linear Gaussian State Space Modelè®¡ç®—ï¼›ç¬¬ä¸‰é¡¹$-\log(q_\phi(\mathbf{z}<em>{t-T:t}|\mathbf{x}</em>{t-T:t}))=-\sum_{i=t-T}^t\log(q_\phi(\mathbf{z}<em>i|\mathbf{z}</em>{i-1},\mathbf{x}_{t-T:i}))$ä¸ºéšå˜é‡$\mathbf{z}$åéªŒåˆ†å¸ƒçš„ä¼°è®¡ï¼ŒåŒæ—¶$\mathbf{z}_i$æ˜¯ç»Planar Normalizing Flowè½¬æ¢è¿‡çš„ã€‚</p><h2 id="Online-Detection"><a href="#Online-Detection" class="headerlink" title="Online Detection"></a>Online Detection</h2><p>åœ¨è®­ç»ƒå¥½æ¨¡å‹ä¹‹åï¼Œå°±å¯ä»¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹äº†ã€‚åœ¨æ—¶é—´$t$ï¼Œæˆ‘ä»¬é€šè¿‡æ ¹æ®é•¿åº¦ä¸º$T+1$çš„åºåˆ—$\mathbf{x}<em>{t-T:t}$æ¥é‡æ„$\mathbf{x}_t$ï¼Œå¹¶æ ¹æ®é‡æ„æ¦‚ç‡$\log(p_\theta(\mathbf{x}_t|\mathbf{z}</em>{t-T:t}))$æ¥åˆ¤å®šå¼‚å¸¸ã€‚å®šä¹‰$\mathbf{x}<em>t$å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°$S_t=\log(p_\theta(\mathbf{x}_t|\mathbf{z}</em>{t-T:t}))$ï¼Œé«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ ·æœ¬$\mathbf{x}_t$èƒ½å¤Ÿä»¥å¤§æ¦‚ç‡é‡æ„ï¼ˆå› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è®­ç»ƒï¼Œå¯ä»¥è®¤ä¸ºæ¨¡å‹å»ºæ¨¡çš„æ˜¯æ­£å¸¸æ ·æœ¬çš„åˆ†å¸ƒï¼Œé‡æ„æ¦‚ç‡é«˜å°±ä»£è¡¨ç¬¦åˆæ­£å¸¸åˆ†å¸ƒï¼‰ã€‚ç»™å®šé˜ˆå€¼ä¹‹åä¾¿å¯æ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤å®šã€‚</p><h2 id="Automatic-Threshold-Selection"><a href="#Automatic-Threshold-Selection" class="headerlink" title="Automatic Threshold Selection"></a>Automatic Threshold Selection</h2><p>åœ¨å¼‚å¸¸æ£€æµ‹é˜¶æ®µï¼Œéœ€è¦æ ¹æ®è®¾å®šçš„é˜ˆå€¼å’Œæ¯ä¸ªæ ·æœ¬çš„å¼‚å¸¸åˆ†æ•°æ¥åˆ¤æ–­è¯¥æ ·æœ¬æ˜¯å¦ä¸ºå¼‚å¸¸ï¼Œæ‰€ä»¥é˜ˆå€¼çš„é€‰æ‹©ååˆ†é‡è¦ã€‚æ–‡ä¸­ç”¨åˆ°äº†ä¸€ç§æ ¹æ®<strong>Extreme Value Theory</strong>è‡ªåŠ¨é€‰æ‹©é˜ˆå€¼çš„ç®—æ³•ã€‚å¯¹äºä¸€ä¸ªåˆ†å¸ƒï¼Œå…¶ä¸­çš„æç«¯äº‹ä»¶å¾€å¾€ä½äºåˆ†å¸ƒçš„æœ«å°¾ï¼Œè€ŒExtreme Value Theoryç¬¬ä¸€å®šç†ç»™å‡ºä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ï¼Œè¿™äº›æç«¯äº‹ä»¶çš„åˆ†å¸ƒæœä»ä¸€ä¸ªå¸¦å‚çš„åˆ†å¸ƒæ—ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨å¯¹æ•°æ®åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡æç«¯äº‹ä»¶çš„åˆ†å¸ƒã€‚</p><p>é™¤äº†Extreme Value Theoryç¬¬ä¸€å®šç†ä¹‹å¤–ï¼ŒExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼$t$çš„åˆ†å¸ƒå¯ä»¥ç”¨Generalized Pareto Distributionæ¥æè¿°ã€‚ä½œè€…ä½¿ç”¨äº†åŸºäºExtreme Value Theoryç¬¬äºŒå®šç†çš„Peaks-Over-Thresholdç®—æ³•æ¥è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚å› ä¸ºExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼$t$çš„åˆ†å¸ƒï¼Œè€Œåœ¨æœ¬æ–‡çš„åœºæ™¯ä¸­æˆ‘ä»¬éœ€è¦åˆ»ç”»çš„å¼‚å¸¸ç‚¹çš„åˆ†å¸ƒåº”è¯¥æ˜¯å°äºä¸€ä¸ªç»™å®šé˜ˆå€¼çš„åˆ†å¸ƒï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹å…¬å¼ã€‚</p><p>å¯¹äºç»™å®šçš„æ•°æ®ï¼Œæ¨¡å‹ä¼šç»™å‡ºå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°åºåˆ—${S_1,S_2,\cdots,S_{N^\prime}}$ï¼Œç»™å®šé¢„å…ˆè®¾å®šçš„é˜ˆå€¼$th$ï¼Œ$S_i$æç«¯éƒ¨åˆ†ï¼ˆå³å°äº$th$çš„éƒ¨åˆ†ï¼‰çš„åˆ†å¸ƒç¬¦åˆGeneralized Pareto Distributionï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\bar{F}(s)=P(th-S&gt;s|S&lt;th)\sim(1+\frac{\gamma s}{\beta})^{-\frac{1}{\gamma}}<br>$$</p><p>å…¶ä¸­$\gamma$å’Œ$\beta$ä¸ºåˆ†å¸ƒçš„å½¢çŠ¶å‚æ•°ï¼Œæœ¬æ–‡ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ¥å¯¹å‚æ•°è¿›è¡Œä¼°è®¡ã€‚è®¾å‚æ•°çš„ä¼°è®¡å€¼åˆ†åˆ«ä¸º$\hat{\gamma}$å’Œ$\hat{\beta}$ï¼Œæœ€ç»ˆçš„é˜ˆå€¼$th_F$ç”±æ‹Ÿåˆå¾—åˆ°çš„åˆ†å¸ƒçš„åˆ†ä½æ•°ç¡®å®šï¼š</p><p>$$<br>th_F\simeq th-\frac{\hat{\beta}}{\hat{\gamma}}((\frac{qN^\prime}{N^\prime_{th}})^{-\hat{\gamma}}-1)<br>$$</p><p>å…¶ä¸­$q$ä¸ºæœŸæœ›$S&lt;th$çš„æ¦‚ç‡ï¼Œ$N^\prime$ä¸ºè§‚æµ‹å€¼çš„æ•°é‡ï¼Œ$N^\prime_{th}$ä¸º$S_i&lt;th$çš„ä¸ªæ•°ã€‚</p><h2 id="Anomaly-Interpretation"><a href="#Anomaly-Interpretation" class="headerlink" title="Anomaly Interpretation"></a>Anomaly Interpretation</h2><p>$$<br>\log(p_\theta(\mathbf{x}<em>t|\mathbf{z}</em>{t-T:t}))=\sum_{i=1}^M\log(p_\theta(x_t^i|\mathbf{z}_{t-T:t}))<br>$$</p><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Datasets-and-Metrics"><a href="#Datasets-and-Metrics" class="headerlink" title="Datasets and Metrics"></a>Datasets and Metrics</h2><h2 id="Overall-Performance"><a href="#Overall-Performance" class="headerlink" title="Overall Performance"></a>Overall Performance</h2><p><img src="https://i.loli.net/2020/06/25/yYLiWfXBDQklbPU.png" srcset="/img/loading.gif" alt=""></p><p><img src="https://i.loli.net/2020/06/25/HlORKBEu7ij6Vor.png" srcset="/img/loading.gif" alt=""></p><h2 id="Effects-of-Major-Techniques"><a href="#Effects-of-Major-Techniques" class="headerlink" title="Effects of Major Techniques"></a>Effects of Major Techniques</h2><p><img src="https://i.loli.net/2020/06/25/eKXGJ9ZlSmq8r4Q.png" srcset="/img/loading.gif" alt=""></p><p><img src="https://i.loli.net/2020/06/25/dlibhyOBXNmPrkw.png" srcset="/img/loading.gif" alt=""></p><h2 id="Visualization-on-Z-Space-Representations"><a href="#Visualization-on-Z-Space-Representations" class="headerlink" title="Visualization on Z-Space Representations"></a>Visualization on Z-Space Representations</h2><p><img src="https://i.loli.net/2020/06/25/MQXv5pZAejgVJ9s.png" srcset="/img/loading.gif" alt=""></p><p><img src="https://i.loli.net/2020/06/25/jCkovq2lWrP6KXy.png" srcset="/img/loading.gif" alt=""></p><p><img src="https://i.loli.net/2020/06/25/JSZuUkzNyci41DA.png" srcset="/img/loading.gif" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>VAE</tag>
      
      <tag>RNN</tag>
      
      <tag>Flow-based Model</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GAIN: Missing Data Imputation using Generative Adversarial Nets</title>
    <link href="/2019/10/16/GAIN-Missing-Data-Imputation-using-Generative-Adversarial-Nets/"/>
    <url>/2019/10/16/GAIN-Missing-Data-Imputation-using-Generative-Adversarial-Nets/</url>
    
    <content type="html"><![CDATA[<h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>æœ¬æ–‡åŸºäºGANæå‡ºäº†ä¸€ç§æ—¶é—´åºåˆ—ç¼ºå¤±å€¼å¡«å……ï¼ˆTime Series Imputationï¼‰çš„æ–¹æ³•ã€‚å…¶ä¸»è¦çš„æ€è·¯ä¸ºç”Ÿæˆå™¨$G$ä»éšç©ºé—´$Z$ç”Ÿæˆå®Œæ•´çš„æ ·æœ¬ï¼Œè€Œåˆ¤åˆ«å™¨$D$åˆ™è¾“å‡ºæ ·æœ¬ä¸­ä¸åŒéƒ¨åˆ†ä¸ºçœŸå®çš„æ¦‚ç‡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…æå‡ºäº†ä½¿ç”¨Hint Vectoræ¥æ­ç¤ºåŸå§‹æ•°æ®ä¸­ç¼ºå¤±éƒ¨åˆ†çš„ä¿¡æ¯ï¼Œæ¥ä¼˜åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚</p><p><a href="https://arxiv.org/abs/1806.02920" target="_blank" rel="noopener">åŸæ–‡</a></p><h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Problem-Formulation"><a href="#Problem-Formulation" class="headerlink" title="Problem Formulation"></a>Problem Formulation</h2><p>è€ƒè™‘ä¸€ä¸ª$d$ç»´çš„ç©ºé—´$\mathcal{X}=\mathcal{X}_1\times \cdots\times \mathcal{X}_d$ï¼Œè®¾$\mathbf{X}=(X_1,\cdots,X_d)$ç»´ç©ºé—´$\mathcal{X}$ä¸Šçš„éšæœºå‘é‡ï¼ˆå³ç†æƒ³çš„å®Œæ•´çš„æ—¶é—´åºåˆ—ï¼‰ï¼Œè®°å…¶åˆ†å¸ƒä¸º$P(\mathbf{X})$ã€‚è®¾$\mathbf{M}=(M_1,\cdots,M_d)$ä¸ºMaskå‘é‡è¡¨ç¤º$\mathbf{X}$ä¸­è¢«è§‚å¯Ÿåˆ°çš„éƒ¨åˆ†ã€‚ï¼ˆå³æ ‡è¯†æ—¶é—´åºåˆ—å“ªäº›éƒ¨åˆ†æœ‰ç¼ºå¤±ï¼‰ï¼Œå–å€¼ä¸º${0,1}^d$ã€‚</p><p>å¯¹äºæ¯ä¸€ä¸ª$i\in{1,\cdots,d}$ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°ç©ºé—´$\tilde{\mathcal{X}}=\mathcal{X}\cup{<em>}$ï¼Œå…¶ä¸­$</em>$è¡¨ç¤ºä¸å±äºä»»æ„$\mathcal{X}<em>i$çš„ä¸€ä¸ªç‚¹ã€‚ä»¤$\tilde{\mathcal{X}}=\tilde{\mathcal{X}_1}\times\cdots\times\tilde{\mathcal{X}_d}$ï¼ŒåŒæ—¶å®šä¹‰ä¸€ä¸ªæ–°çš„éšæœºå˜é‡ï¼ˆå³æˆ‘ä»¬è§‚æµ‹åˆ°çš„å«æœ‰ç¼ºå¤±å€¼çš„æ—¶é—´åºåˆ—ï¼‰$\tilde{\mathbf{X}}=(\tilde{X}_1,\cdots,\tilde{X}_d)\in \tilde{\mathcal{X}}$ï¼š<br>$$<br>\tilde{X}_i=\begin{cases}X_i,&amp;\text{if } M_i=1\*,&amp;\text{otherwise}\end{cases}<br>$$<br>å‡è®¾æ•°æ®é›†çš„å½¢å¼ä¸º$\mathcal{D}={(\tilde{x}^i,m^i)}^n</em>{i=1}$ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ä»$P(\mathbf{X}|\tilde{\mathbf{X}}=\tilde{x}^i)$ä¸Šé‡‡æ ·æ¥å¯¹ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ã€‚</p><h2 id="Model-Architecture"><a href="#Model-Architecture" class="headerlink" title="Model Architecture"></a>Model Architecture</h2><p>æ¨¡å‹çš„æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/wCK3J8MoTASrj9Y.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h3><p>ç”Ÿæˆå™¨çš„è¾“å…¥æœ‰ä¸‰é¡¹ï¼š$\tilde{\mathbf{X}}$ï¼Œ$\mathbf{M}$å’Œéšæœºå™ªå£°$\mathbf{Z}$ï¼Œè¾“å‡ºè®¾ä¸º$\bar{\mathbf{X}}$ã€‚è®¾ç”Ÿæˆå™¨ä¸ºæ˜ å°„$G: \tilde{\mathcal{X}}\times{0,1}^d\times[0,1]^d\rightarrow \mathcal{X}$ï¼Œè€Œ$\mathbf{Z}$ä¸º$d$ç»´çš„é«˜æ–¯å™ªå£°ã€‚ç”Ÿæˆå™¨çš„è¾“å‡ºå’Œå¡«å……åçš„æ—¶é—´åºåˆ—å®šä¹‰ä¸ºï¼š<br>$$<br>\begin{align}<br>\bar{\mathbf{X}}&amp;=G(\tilde{\mathbf{X}},\mathbf{M},(1-\mathbf{M})\odot\mathbf{Z})\<br>\hat{\mathbf{X}}&amp;=\mathbf{M}\odot\tilde{\mathbf{X}}+(1-\mathbf{M})\odot\bar{\mathbf{X}}<br>\end{align}<br>$$<br>$\bar{\mathbf{X}}$å³ä¸ºç”Ÿæˆå™¨çš„ç›´æ¥è¾“å‡ºï¼Œå› ä¸ºå…¶å®æœ‰äº›éƒ¨åˆ†æ²¡æœ‰ç¼ºå¤±ï¼Œç”Ÿæˆå™¨è¿˜æ˜¯ä¼šä¸ºæ¯ä¸ªéƒ¨åˆ†è¾“å‡ºå€¼ã€‚</p><p>$\hat{\mathbf{X}}$ä¸ºå¡«å……åçš„æ—¶é—´åºåˆ—ï¼Œå¯¹äºç¼ºå¤±çš„éƒ¨åˆ†é‡‡ç”¨ç”Ÿæˆå™¨çš„è¾“å‡ºè¿›è¡Œå¡«å……ã€‚</p><h3 id="Discriminator"><a href="#Discriminator" class="headerlink" title="Discriminator"></a>Discriminator</h3><p>å’ŒåŸå§‹çš„GANä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ¤æ–­æ•´ä¸ªæ ·æœ¬æ˜¯çœŸå®çš„æˆ–è€…æ˜¯ç”Ÿæˆçš„ï¼Œè€Œæ˜¯éœ€è¦åˆ¤æ–­æ ·æœ¬çš„é‚£äº›éƒ¨åˆ†æ˜¯çœŸå®çš„æˆ–è€…æ˜¯ç”Ÿæˆçš„ï¼Œæ‰€ä»¥åˆ¤åˆ«å™¨ä¸ºæ˜ å°„$D: \mathcal{X}\rightarrow[0,1]^d$ã€‚åˆ¤åˆ«å™¨çš„å…·ä½“ç›®æ ‡å‡½æ•°å°†åœ¨åé¢è®¨è®ºã€‚</p><h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a>Hint</h3><p>Hintæ˜¯ä¸€ç§æç¤ºæœºå€¼ï¼Œæ˜¯ä¸€ä¸ªå’Œ$\mathbf{X}$ç›¸åŒç»´åº¦çš„éšæœºå˜é‡$\mathbf{H}$ï¼Œå…¶åˆ†å¸ƒä¾èµ–äº$\mathbf{M}$ã€‚$\mathbf{H}$æ˜¯ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰çš„ï¼Œç›¸å½“äºä¸€ç§ä¸å®Œæ•´çš„$\mathbf{M}$ï¼Œç”¨æ¥ä½œä¸ºåˆ¤åˆ«å™¨çš„é¢å¤–è¾“å…¥ã€‚</p><h3 id="Objective"><a href="#Objective" class="headerlink" title="Objective"></a>Objective</h3><p>æˆ‘ä»¬è®­ç»ƒåˆ¤åˆ«å™¨æœ€å¤§åŒ–æ­£ç¡®é¢„æµ‹$\mathbf{M}$çš„æ¦‚ç‡ï¼Œè€Œç”Ÿæˆå™¨æœ€å°åŒ–åˆ¤åˆ«å™¨æ­£ç¡®é¢„æµ‹$\mathbf{M}$çš„æ¦‚ç‡ï¼Œç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š<br>$$<br>\begin{align}<br>V(D,G)=&amp;\mathbb{E}<em>{\hat{X},M,H}[\mathbf{M}^T\log D(\hat{\mathbf{X}},\mathbf{H})\&amp;+(1-\mathbf{M})^T\log(1-D(\hat{\mathbf{X}},\mathbf{H}))]<br>\end{align}<br>$$<br>æŒ‰ç…§æ ‡å‡†çš„GANå¯ä»¥å°†ä¼˜åŒ–å‡½æ•°å†™æˆä»¥ä¸‹çš„å½¢å¼ï¼š<br>$$<br>\min_G\max_D V(D,G)<br>$$<br>åœ¨è¿™é‡Œåˆ¤åˆ«å™¨çš„ä»»åŠ¡å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªäºŒåˆ†ç±»ï¼Œè€Œç›®æ ‡å‡½æ•°å°±æ˜¯äºŒå€¼äº¤å‰ç†µçš„å®šä¹‰ï¼Œå› æ­¤å¯ä»¥å†™ä¸ºï¼š<br>$$<br>\mathcal{L}(a,b)=\sum\limits</em>{i=1}^d[a_i\log(b_i)+(1-a_i)\log(1-b_i)]<br>$$<br>$\mathbf{M}$å¯ä»¥çœ‹ä½œGround Truthï¼Œè®°$\hat{\mathbf{M}}=D(\hat{\mathbf{X},\mathbf{H}})$ï¼Œå³åˆ¤åˆ«å™¨è¾“å‡ºçš„é¢„æµ‹ï¼Œå› æ­¤ä¼˜åŒ–å‡½æ•°å¯ä»¥ç®€è®°ä¸ºï¼š<br>$$<br>\min_G\max_D\mathbb{E}[\mathcal{L}(\mathbf{M},\hat{\mathbf{M}})]<br>$$</p><h2 id="GAIN-Algorithm"><a href="#GAIN-Algorithm" class="headerlink" title="GAIN Algorithm"></a>GAIN Algorithm</h2><p>ä¸‹é¢è®¨è®ºGAINç®—æ³•çš„è®­ç»ƒæµç¨‹ã€‚</p><p>æœ¬æ–‡é€šè¿‡ç†è®ºè®¨è®ºï¼Œç»™å‡ºäº†ç”ŸæˆHint Vectorçš„ä¸€ä¸ªæ–¹æ³•ï¼Œé¦–å…ˆå®šä¹‰éšæœºå˜é‡$\mathbf{B}=(B_1,\cdots,B_d)\in{0,1}^d$ï¼Œ$\mathbf{B}$é€šè¿‡ä»${1,\cdots,d}$éšæœºå‡åŒ€é‡‡æ ·ä¸€ä¸ª$k$ï¼Œç„¶åç”±ä¸‹åˆ—å…¬å¼å¾—åˆ°ï¼š<br>$$<br>B_j=\begin{cases}1, &amp;\text{if }j\neq k\0, &amp;\text{if }j=k\end{cases}<br>$$<br>å®šä¹‰ç©ºé—´$\mathcal{H}={0,0.5,1}^d$ï¼ŒHint Vectorä¸º$\mathbf{H}=\mathbf{B}\odot\mathbf{M}+0.5(1-\mathbf{B})\in\mathcal{H}$ã€‚</p><p>åˆ¤åˆ«å™¨çš„è®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼šå›ºå®šç”Ÿæˆå™¨$G$ï¼Œå¯¹ä¸€ä¸ªå¤§å°ä¸º$k_D$çš„mini-batchï¼Œç‹¬ç«‹åŒåˆ†å¸ƒé‡‡æ ·$k_D$ä¸ª$z$å’Œ$b$ï¼Œç”¨æ¥è®¡ç®—$\mathbf{Z}$å’Œ$\mathbf{B}$ã€‚åˆ¤åˆ«å™¨çš„æŸå¤±å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š<br>$$<br>\mathcal{L}<em>D(m,\hat{m},b)=\sum\limits</em>{i:b_i=0}[m_i\log(\hat{m}<em>i)+(1-m_i)\log(1-\hat{m}_i)]<br>$$<br>åˆ¤åˆ«å™¨çš„ä¼˜åŒ–å‡½æ•°ä¸ºï¼š<br>$$<br>\min_D-\sum\limits</em>{j=1}^{k_D}\mathcal{L}_D(m(j),\hat{m}(j),b(j))<br>$$<br>å…¶ä¸­$\hat{m}(j)=D(\hat{x}(j),m(j))$ã€‚</p><p>åœ¨ä¼˜åŒ–äº†åˆ¤åˆ«å™¨ä¹‹åï¼Œéœ€è¦ä¼˜åŒ–ç”Ÿæˆå™¨ï¼Œå¯¹ä¸€ä¸ªå¤§å°ä¸º$k_G$çš„mini-batchï¼Œç”Ÿæˆå™¨çš„æŸå¤±å‡½æ•°åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯åœ¨ç¼ºå¤±éƒ¨åˆ†çš„æŸå¤±ï¼š</p><p>$$<br>\mathcal{L}<em>G(m,\hat{m},b)=-\sum\limits</em>{i:b_i=0}(1-m_i)\log(\hat{m}<em>i)<br>$$<br>ä¸€ä¸ªæ˜¯æœªç¼ºå¤±éƒ¨åˆ†çš„æŸå¤±ï¼š<br>$$<br>\mathcal{L}_M(x,x^\prime)=\sum\limits</em>{i=1}^d m_iL_M(x_i,x_i^\prime)<br>$$<br>å…¶ä¸­ï¼š<br>$$<br>L_M(x_i,x_i^\prime)=\begin{cases}(x_i^\prime-x_i)^2, &amp;\text{if }x_i\text{ is continuours},\-x_i\log(x_i^\prime), &amp;\text{if }x_i\text{ is binary}.\end{cases}<br>$$<br>æœ€ç»ˆçš„ä¼˜åŒ–å‡½æ•°ä¸ºï¼š<br>$$<br>\min_G\sum\limits_{j=1}^{k_G}\mathcal{L}_G(m(j),\hat{m}(j),b(j))+\alpha\mathcal{L}_M(\tilde{x}(j),\hat{x}(j))<br>$$<br>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/znABi6x9mJuvDOX.png" srcset="/img/loading.gif" style="zoom:67%;" /><h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><p>ä¸‹è¡¨ä¸ºåœ¨5ä¸ªä¸åŒæ•°æ®é›†ä¸Šå®éªŒï¼Œä¸å…¶ä»–5ç§æ–¹æ³•å¯¹æ¯”çš„ç»“æœï¼š</p><img src="https://i.loli.net/2020/06/25/EenX2YO8aDxQAk3.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä¸Šå›¾ä¸ºGAINã€MissForestå’ŒAutoencoderä¸‰ç§æ¨¡å‹åœ¨ä¸åŒç¼ºå¤±æ¯”ä¾‹ã€æ ·æœ¬æ•°é‡ã€ç‰¹å¾ç»´åº¦ä¸‹çš„å¯¹æ¯”æ›²çº¿å›¾ã€‚</p><p>ä¸‹è¡¨ä¸ºä½¿ç”¨ä¸åŒæ¨¡å‹å¯¹æ—¶é—´åºåˆ—è¿›è¡Œå¡«å……ä¹‹åï¼Œä½¿ç”¨é€»è¾‘å›å½’è¿›è¡Œå›å½’ä»»åŠ¡çš„æ€§èƒ½ï¼š</p><img src="https://i.loli.net/2020/06/25/PzeWKdGu4wADshV.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä¸‹å›¾ä¸ºGAINã€MissForestå’ŒAutoencoderä¸‰ç§æ¨¡å‹åœ¨ä¸åŒç¼ºå¤±æ¯”ä¾‹ä¸‹çš„AUROCæ›²çº¿å›¾ï¼š</p><img src="https://i.loli.net/2020/06/25/IKtoTj8xgG1yJDk.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä¸‹è¡¨å±•ç¤ºçš„æ˜¯ä½œè€…å¯¹æ—¶é—´åºåˆ—å¡«å……ç®—æ³•ä¿æŒç‰¹å¾-æ ‡ç­¾å…³ç³»çš„èƒ½åŠ›ã€‚ä½œè€…åˆ†åˆ«ç”¨å®Œæ•´çš„æ•°æ®å’Œå¡«å……åçš„æ•°æ®ç”¨é€»è¾‘å›å½’æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œå°†ä¸¤è€…çš„æƒé‡æ±‚ç»å¯¹å€¼å’Œå‡æ–¹æ ¹çš„ç»“æœã€‚</p><img src="https://i.loli.net/2020/06/25/uy2jPcnbtSrC6vI.png" srcset="/img/loading.gif" style="zoom:67%;" />]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Time Series Imputation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>GAN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Anomaly Detection with Generative Adversarial Networks for Multivariate Time Series</title>
    <link href="/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/"/>
    <url>/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>è¿™ç¯‡æ–‡ç« æå‡ºäº†ä¸€ä¸ªåŸºäºGANçš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¨¡å‹ã€‚</p><p><a href="https://arxiv.org/abs/1809.04758" target="_blank" rel="noopener">åŸæ–‡</a></p><h2 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h2><ol><li>æå‡ºäº†åŸºäºGANçš„æ—¶é—´åºåˆ—æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹æ¨¡å‹</li><li>æˆ‘ä»¬ä½¿ç”¨åŸºäºLSTMçš„GANæ¥å¯¹å¤šå˜é‡æ—¶é—´åºåˆ—è¿›è¡Œå»ºæ¨¡</li><li>ç»“åˆä½¿ç”¨äº†Residual Losså’ŒDiscrimination Lossæ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­</li></ol><h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><h3 id="Generative-Adversarial-Networks"><a href="#Generative-Adversarial-Networks" class="headerlink" title="Generative Adversarial Networks"></a>Generative Adversarial Networks</h3><h4 id="GANs-In-a-Nutshell-an-extremely-simple-explanation"><a href="#GANs-In-a-Nutshell-an-extremely-simple-explanation" class="headerlink" title="GANs In a Nutshell, an extremely simple explanation"></a>GANs In a Nutshell, an extremely simple explanation</h4><ul><li>æˆ‘ä»¬æƒ³è¦ä»ä¸€ä¸ªå¤æ‚çš„ã€é«˜ç»´çš„æ•°æ®åˆ†å¸ƒ$p_r(x)$ä¸Šé‡‡æ ·å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ç‚¹ï¼Œç„¶è€Œ$p_r(x)$æ— æ³•ç›´æ¥æ±‚å¾—</li><li>ä»£æ›¿æ–¹æ³•ï¼šä»ä¸€ä¸ªç®€å•çš„ã€å·²çŸ¥çš„åˆ†å¸ƒ$p_z(z)$ä¸Šé‡‡æ ·ï¼Œç„¶åå­¦ä¹ ä¸€ä¸ªTransformation $G(z): z\rightarrow x$æ¥å°†$z$æ˜ å°„åˆ°$x$</li></ul><img src="https://i.loli.net/2020/06/25/frIYtuao9mexQUT.png" srcset="/img/loading.gif" style="zoom:67%;" /><h4 id="Training-Two-player-Game"><a href="#Training-Two-player-Game" class="headerlink" title="Training: Two-player Game"></a>Training: Two-player Game</h4><ul><li>*<em>Generator Network: *</em> ä»éšæœºåˆ†å¸ƒ$p_z(z)$é‡‡æ ·$z$ï¼Œé€šè¿‡æ˜ å°„ç”Ÿæˆæ ·æœ¬$x$ï¼Œè¿™ä¸ªç”Ÿæˆçš„æ ·æœ¬è¦å°½é‡â€œçœŸå®â€ã€‚æ€ä¹ˆâ€œçœŸå®â€ï¼Ÿä¼˜åŒ–ç”Ÿæˆå™¨å‚æ•°$\theta_G$æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†å³å¯</li><li>*<em>Discriminator Network: *</em>æ¥å—ä¸€ä¸ªæ ·æœ¬$x$ï¼Œåˆ¤æ–­å…¶æ˜¯ç”Ÿæˆçš„æ ·æœ¬è¿˜æ˜¯çœŸå®çš„æ ·æœ¬ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œæˆ‘ä»¬æ˜¯çŸ¥é“ä¸€ä¸ªæ ·æœ¬$x$åˆ°åº•æ˜¯ç”Ÿæˆçš„è¿˜æ˜¯çœŸå®çš„ï¼Œæ‰€ä»¥ä¼˜åŒ–åˆ¤åˆ«å™¨å‚æ•°$\theta_D$æœ€å°åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†ï¼Œæœ€å¤§åŒ–å¯¹çœŸå®æ ·æœ¬çš„è¯„åˆ†ï¼ˆå³æœ€å¤§åŒ–åˆ†è¾¨çœŸå®æ ·æœ¬çš„èƒ½åŠ›ï¼‰</li></ul><img src="https://i.loli.net/2020/06/25/ECP2Dkpq6FrSoef.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>å½¢å¼åŒ–çš„æ¥è®²ï¼Œä¼˜åŒ–å‡½æ•°å¦‚ä¸‹ï¼š</p><p>$$\min\limits_{\theta_G}\max\limits_{\theta_D}V(G,D)=\mathbb{E}<em>{x\sim p</em>{data}(x)\log(\underbrace{D_{\theta{D}}(x)}<em>{åˆ¤åˆ«å™¨å¯¹çœŸå®æ ·æœ¬çš„è¯„åˆ†})}+\mathbb{E}</em>{z\sim p_z(z)}\log(1-\underbrace{D_{\theta_d}(G_{\theta_G}(z))}_{åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†})$$</p><p>è®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/57N4yUrfoS1cBWd.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Long-Short-Time-Memory-Networks"><a href="#Long-Short-Time-Memory-Networks" class="headerlink" title="Long Short Time Memory Networks"></a>Long Short Time Memory Networks</h3><h4 id="Vanilla-Recurrent-Neural-Networks"><a href="#Vanilla-Recurrent-Neural-Networks" class="headerlink" title="Vanilla Recurrent Neural Networks"></a>Vanilla Recurrent Neural Networks</h4><p>æ™®é€šçš„ç¥ç»ç½‘ç»œï¼š</p><img src="https://i.loli.net/2020/06/25/U5rxdYR4jKoqQOX.png" srcset="/img/loading.gif" style="zoom:50%;" /><p>æ¦‚æ‹¬çš„æ¥è®²ï¼Œå¯ä»¥æ¶µç›–ä¸ºä¸€ä¸ªå…¬å¼$\hat{\mathbf{y}}=f(\mathbf{x})$ã€‚å¯¹äºä¸€ä¸ªæ ·æœ¬$\mathbf{x}$ï¼Œé€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œæ˜ å°„ï¼Œè¾“å‡º$\mathbf{y}$ã€‚</p><p>å¯¹äºRNNï¼Œæˆ‘ä»¬å¤„ç†çš„æ˜¯åºåˆ—æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰æ ·æœ¬ä¹‹é—´å¹¶ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚å¯¹äºä¸€ä¸ªåºåˆ—ä¸­çš„ä¸€ä¸ªæ ·æœ¬$x_t\in{x_1,x_2,\cdots,x_n}$ï¼Œå°†å…¶è¾“å…¥åˆ°ç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œä¸ºäº†å»ºæ¨¡$x_t$ä¹‹å‰çš„å­åºåˆ—å¯¹$x_t$çš„å½±å“å…³ç³»ï¼Œéœ€è¦å°†è¿™ä¸ªå­åºåˆ—çš„ä¿¡æ¯ä¹Ÿè¾“å…¥åˆ°ç¥ç»ç½‘ç»œä¸­ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿä¸ºæ¯ä¸€ä¸ªæ ·æœ¬ç‚¹ä¿å­˜ä¸€ä¸ªStateã€‚å³å®šä¹‰$h_t=g(\hat{y_t})=g(f(x_t))$ï¼Œå¯¹äºå½“å‰æ ·æœ¬ç‚¹ï¼Œ$\hat{y_t}=f(x_t,h_{t-1})$ã€‚ä¹Ÿå°±æ˜¯è¯´ç¥ç»ç½‘ç»œçš„è¾“å…¥ä¸ä»…åŒ…å«äº†å½“å‰æ ·æœ¬ç‚¹çš„ç‰¹å¾ï¼Œä¹ŸåŒ…å«äº†ä¸Šä¸€ä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€(ä¸Šä¸€ä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€åˆéšå«äº†ä¸Šä¸Šä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€â€¦)ï¼Œå°±åƒæ˜¯ä¸ºç½‘ç»œåŠ ä¸Šäº†çŸ­æœŸè®°å¿†ã€‚</p><img src="https://i.loli.net/2020/06/25/cxBk6SQTydsOVYt.png" srcset="/img/loading.gif" style="zoom: 67%;" /><img src="https://i.loli.net/2020/06/25/ODKWYBI83tJXurM.png" srcset="/img/loading.gif" style="zoom: 33%;" /><img src="https://i.loli.net/2020/06/25/jq1LAytRKCub3kX.png" srcset="/img/loading.gif" style="zoom:33%;" /><h4 id="Gradient-Flow-of-Vanilla-RNN"><a href="#Gradient-Flow-of-Vanilla-RNN" class="headerlink" title="Gradient Flow of Vanilla RNN"></a>Gradient Flow of Vanilla RNN</h4><p>ä¸‹é¢æ¥è¿›è¡Œä¸€äº›å½¢å¼åŒ–çš„å®šä¹‰ï¼Œå‡è®¾åœ¨æ—¶åˆ»$t$ç½‘ç»œè¾“å…¥ç‰¹å¾ä¸º$x_t$ï¼Œè¾“å‡ºéšå«çŠ¶æ€ä¸º$h_{t}$ï¼Œå…¶ä¸ä»…å’Œå½“å‰è¾“å…¥$x_t$æœ‰å…³ï¼Œè¿˜å’Œä¸Šä¸€ä¸ªéšå«çŠ¶æ€$h_{t-1}$æœ‰å…³ï¼š</p><ul><li>å½“å‰æ—¶åˆ»æ€»çš„å‡€è¾“å…¥$z_t=Uh_{t-1}+Wx_t+b$</li><li>å½“å‰æ—¶åˆ»è¾“å‡ºéšå«çŠ¶æ€$h_t=f(z_t)$</li><li>å½“å‰æ—¶åˆ»è¾“å‡º$\hat{y}_t=Vh_t$</li></ul><p>RNNçš„æ¢¯åº¦æ›´æ–°å…¬å¼(æ¨å¯¼è¿‡ç¨‹æ¯”è¾ƒå¤æ‚)ï¼š</p><p>$$\frac{\partial{\mathcal{L}}}{\partial U}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t \delta_{t,k}\mathbf{h}_{k-1}^T$$</p><p>$$\frac{\partial{\mathcal{L}}}{\partial{W}}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t \delta_{t,k}x_k^T$$</p><p>$$\frac{\partial\mathcal{L}}{\partial{b}}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t\delta_{t,k}$$</p><p>å…¶ä¸­$\delta_{t,k}=\frac{\partial{\mathcal{L}}}{\partial{z_k}}=\text{diag}(f^\prime(z_k))U^T\delta_{t,k+1}$å®šä¹‰ä¸ºç¬¬$t$æ—¶åˆ»çš„æŸå¤±å¯¹ç¬¬$k$æ—¶åˆ»éšè—ç¥ç»å±‚çš„å‡€è¾“å…¥$z_k$çš„å¯¼æ•°ï¼Œä¸”$z_k=Uh_{k-1}+Wx_k+b,1\leq k&lt;t$ã€‚</p><p>RNNçš„æ¢¯åº¦æµå‘å¦‚ä¸‹å›¾çº¢ç®­å¤´æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/F5xvo9kCiNl8ehZ.png" srcset="/img/loading.gif" style="zoom: 50%;" /><p>RNNä¼šé‡åˆ°æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚æ ¹æ®å‰é¢çš„å…¬å¼ï¼Œ$\delta_{t,k}$å®é™…ä¸Šæ˜¯é€’å½’å®šä¹‰çš„ï¼Œå±•å¼€å¾—åˆ°ï¼š</p><p>$$\delta_{t,k}=\prod\limits_{\tau=k}^{t-1}(\text{diag}(f^\prime(z_\tau))U^T)\delta_{t,t}$$</p><p>å¦‚æœå®šä¹‰$\gamma\cong\parallel\text{diag}(f^\prime(z_\tau))U^T\parallel$ï¼Œé‚£ä¹ˆ$\delta_{t,k}\cong\gamma^{t-k}\delta_{t,t}$ã€‚åœ¨$t-k$å¾ˆå¤§æ—¶ï¼Œ$\gamma&lt;1$ä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼Œ$\gamma&gt;1$æ—¶ä¼šå¯¼è‡´æ¢¯åº¦çˆ†ç‚¸ã€‚</p><img src="https://i.loli.net/2020/06/25/RGW4oVtQ7KEFUCA.png" srcset="/img/loading.gif" style="zoom:50%;" /><img src="https://i.loli.net/2020/06/25/i4O9kJQpnZ5GYeq.png" srcset="/img/loading.gif" style="zoom:50%;" /><h4 id="Long-Short-Time-Memory"><a href="#Long-Short-Time-Memory" class="headerlink" title="Long Short Time Memory"></a>Long Short Time Memory</h4><p>LSTMæ˜¯ä¸€ç§è§£å†³RNNæ¢¯åº¦æ¶ˆå¤±é—®é¢˜çš„æ”¹è¿›ç‰ˆæœ¬ï¼š</p><img src="https://i.loli.net/2020/06/25/B4NXzb6fSdgGowL.png" srcset="/img/loading.gif" style="zoom:50%;" /><p>åœ¨LSTMä¸­ï¼Œç»´æŠ¤äº†ä¸¤ä¸ªStateï¼Œ$c_t$å’Œ$h_t$ã€‚å…¶ä¸­$c_t$ç”±é—å¿˜é—¨$f$ä¸ä¸Šä¸€ä¸ª$c_{t-1}$ç›¸ä¹˜(ä»£è¡¨ç»§æ‰¿ä¸Šä¸€ä¸ªCellçš„ä¿¡æ¯å¹¶åŠ ä»¥ä¸€å®šç¨‹åº¦çš„é—å¿˜)ï¼ŒåŠ ä¸Šè¾“å‡ºé—¨$i$ä¸Gate Gate $g$ç›¸ä¹˜(Gate Gateä»£è¡¨å½“å‰çš„å€™é€‰çŠ¶æ€ï¼Œè¾“å‡ºé—¨$i$æ§åˆ¶å½“å‰å€™é€‰çŠ¶æ€æœ‰å¤šå°‘ä¿¡æ¯éœ€è¦ä¿å­˜)ã€‚æœ€åï¼Œè¾“å‡ºé—¨$o$æ§åˆ¶å½“å‰æ—¶åˆ»çš„Cell State $c_t$æœ‰å¤šå°‘ä¿¡æ¯éœ€è¦è¾“å‡ºç»™å¤–éƒ¨çŠ¶æ€$h_t$ã€‚</p><p>ä¸‰ä¸ªé—¨çš„è®¡ç®—æ–¹å¼ä¸ºï¼š </p><p>$$i_t=\sigma(W_ix_t+U_ih_{t-1}+b_i)$$</p><p>$$f_t=\sigma(W_fx_t+U_fh_{t-1}+b_f)$$</p><p>$$o_t=\sigma(W_ox_t+U_oh_{t-1}+b_o)$$</p><img src="https://i.loli.net/2020/06/25/PXQMb9vih1yEKrf.png" srcset="/img/loading.gif" style="zoom:50%;" /><img src="https://i.loli.net/2020/06/25/1zZQqlI6r9Yjp47.png" srcset="/img/loading.gif" style="zoom:50%;" /><h2 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h2><p>æ€»ä½“æ¡†æ¶å›¾å¦‚Fig 1æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/scEA9Ou1Yi7nThG.png" srcset="/img/loading.gif" style="zoom: 50%;" /><h3 id="GAN-with-LSTM-RNN"><a href="#GAN-with-LSTM-RNN" class="headerlink" title="GAN with LSTM-RNN"></a>GAN with LSTM-RNN</h3><p>ç½‘ç»œç»“æ„ä¸Šç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨éƒ½æ˜¯LSTMï¼Œä¼˜åŒ–å‡½æ•°å’Œæ™®é€šGANä¸€æ ·ï¼š</p><p>$$\min\limits_G\max\limits_D V(D,G)=\mathbb{E}<em>{x\sim p</em>{data}(x)}[\log D(x)]+\mathbb{E}_{z\sim p_z(z)}[\log (1-D(G(z)))]$$</p><h3 id="GAN-based-Anomaly-Score"><a href="#GAN-based-Anomaly-Score" class="headerlink" title="GAN-based Anomaly Score"></a>GAN-based Anomaly Score</h3><p>åœ¨æµ‹è¯•é˜¶æ®µï¼Œéœ€è¦ä½¿ç”¨æ¢¯åº¦ä¼˜åŒ–å¯»æ‰¾ä¸€ä¸ªä½¿å¾—$G_{rnn}(z)$æœ€æ¥è¿‘$X^{test}$çš„$z^k$ï¼š</p><p>$$\min\limits_{Z^k}Error(X^{test},G_{rnn}(Z^k))=1-Similarity(X^{test},G_{rnn}(Z^k))$$</p><p>æœ¬æ–‡å®šä¹‰äº†ä¸¤ç§Anomaly Scoreï¼Œä¸€ç§æ˜¯Residual Lossï¼š</p><p>$$Res(X^{test}<em>t)=\sum\limits</em>{i=1}^n|x^{test,i}<em>t-G</em>{rnn}(Z^{k,i}_t)|$$</p><p>ä¸€ç§æ˜¯Discrimination Lossï¼Œå³åˆ¤åˆ«å™¨çš„è¾“å‡º$D_{rnn}(x_t^{test})$ã€‚</p><p>æ€»çš„Anomaly Scoreï¼š</p><p>$$S^{test}<em>t=\lambda Res(X^{test}_t)+(1-\lambda)D</em>{rnn}(x^{test}_t)$$</p><h3 id="Anomaly-Detection-Framework"><a href="#Anomaly-Detection-Framework" class="headerlink" title="Anomaly Detection Framework"></a>Anomaly Detection Framework</h3><p>æ¨¡å‹çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/06/25/84ZCT1JOEru53Ue.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ç”±äºæœ¬æ–‡æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—é¢„æµ‹ï¼Œè€Œä¸”æ—¶é—´åºåˆ—çš„é•¿åº¦æœ‰å¯èƒ½æ¯”è¾ƒé•¿ï¼Œä½œè€…ä½¿ç”¨äº†æ»‘åŠ¨çª—å£å’ŒPCAæ¥è¿›è¡Œé¢„å¤„ç†ã€‚</p><h2 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h2><img src="https://i.loli.net/2020/06/25/LGsiMw6IjYUtx8T.png" srcset="/img/loading.gif" style="zoom:67%;" />]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection</title>
    <link href="/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/"/>
    <url>/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/</url>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡é’ˆå¯¹é¢å‘åŒºé—´çš„KPIå¼‚å¸¸æ£€æµ‹æå‡ºäº†Label Screeningæ–¹æ³•å’ŒRelearning Algorithm.</p><p><a href="https://www.sciencedirect.com/science/article/pii/S0957417419304282" target="_blank" rel="noopener">åŸæ–‡</a></p><h2 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h2><ol><li>æå‡ºäº†ä¸€ç§Label Screeningæ–¹æ³•æ¥å¯¹åŒºé—´å†…ä¸åŒé‡è¦æ€§è¿›è¡Œè¿‡æ»¤</li><li>æå‡ºäº†ä¸€ç§Relearning Algorithmæ¥å¯¹FPå’ŒTPè¿›è¡ŒRelearningï¼Œåœ¨ä¸å‡å°‘Recallçš„æ¡ä»¶ä¸‹å¢å¤§Precision</li></ol><h2 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h2><h3 id="Overall-Structure"><a href="#Overall-Structure" class="headerlink" title="Overall Structure"></a>Overall Structure</h3><p>ç®—æ³•çš„æ•´ä½“æ¡†æ¶å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/yGMWzdgTf43qImp.png" srcset="/img/loading.gif" alt=""></p><h3 id="Label-Screening-Model"><a href="#Label-Screening-Model" class="headerlink" title="Label Screening Model"></a>Label Screening Model</h3><p>é¢„è®­ç»ƒçš„ç»“æœè¢«åˆ†ä¸º$TP_{po},FP_{po},TN_{po},FN_{po}$å››ç±»ï¼Œ$TP_{po}$å’Œ$FN_{po}$å¯ä»¥è¢«ç»†åˆ†å¦‚ä¸‹ï¼š<br>$$<br>\begin{align}TP_{po}&amp;=TP_{po,withinT}+TP_{po,afterT}\&amp;=TP_{po,withinT}+TP_{po,afterT,tpl}+TP_{po,after,fnl}\end{align}<br>$$</p><p>$$<br>\begin{align}FN_{po}&amp;=FN_{po,withinT}+FN_{po,afterT}\&amp;=FN_{po,withinT,tpl}+FN_{po,,withinT,fnl}+FN_{po,afterT,tpl}+FN_{po,afterT,fnl}\end{align}<br>$$</p><p>å…¶ä¸­ä¸‹æ ‡${}<em>{withinT}$ä»£è¡¨åœ¨å¼‚å¸¸ç‰‡æ®µç¬¬ä¸€ä¸ªç‚¹$T$è·ç¦»å†…çš„æ‰€æœ‰ç‚¹ï¼Œä¸‹æ ‡${}</em>{afterT}$ä»£è¡¨$T$è·ç¦»ä¹‹åã€‚ä¸‹æ ‡${}<em>{tpl}$å’Œ${}</em>{fnl}$åˆ†åˆ«ä»£è¡¨åœ¨å¼‚å¸¸ç‰‡æ®µä¸­ï¼ŒåŒ…å«å’Œä¸åŒ…å«$TP_{po,withinT}$çš„ç‚¹ã€‚</p><p>ä»¥TPä¸ºä¾‹ï¼ŒPoint-basedçš„TPåŒ…å«äº†åœ¨TèŒƒå›´ä¹‹å†…çš„ï¼ˆå³åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯TPçš„ç‚¹ï¼‰å’ŒTèŒƒå›´ä¹‹å¤–çš„ç‚¹ï¼ˆå³åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¸è®¤ä¸ºæ˜¯TPçš„ç‚¹ï¼‰ã€‚è€Œåœ¨TèŒƒå›´ä¹‹å¤–çš„ç‚¹åˆå¯ä»¥ç»†åˆ†ä¸ºè¯¥å¼‚å¸¸ç‰‡æ®µæ˜¯å¦åŒ…å«$TP_{po,withinT}$çš„ç‚¹ï¼ˆå³è¯¥ç‚¹åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¸ä¼šè¢«åˆ¤å®šä¸ºTPï¼Œä½†è¯¥å¼‚å¸¸ç‰‡æ®µæœ‰å…¶ç‚¹ä¼šè¢«åˆ¤å®šä¸ºTPï¼‰ã€‚</p><p>ç±»ä¼¼çš„ï¼Œ$TP_{io}$å’Œ$FN_{io}$å¯ä»¥è¢«åˆ†è§£ä¸ºï¼š<br>$$<br>\begin{align}TP_{io}&amp;=TP_{po,withinT}+TP_{po,afterT,tpl}+FN_{po,withinT,tpl}+FN_{po,afterT,tpl}\&amp;=TP_{po}+FN_{po,withinT,tpl}+FN_{po,afterT,tpl}-TP_{po,afterT,fnl}\end{align}<br>$$</p><p>$$<br>\begin{align}FN_{io}&amp;=FN_{po,withinT,fnl}+FN_{po,afterT,fnl}+TP_{po,afterT,fnl}\&amp;=FN_{po}+TP_{po,afterT,fnl}-FN_{po,withinT,tpl}-FN_{po,afterT,tpl}\end{align}<br>$$</p><p>æ–‡ä¸­å¯¹è¯¥éƒ¨åˆ†çš„åˆ†æå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li>åœ¨Interval-orientedçš„æ ‡å‡†ä¸­ï¼Œ$FN_{po,tpl}$çš„ç‚¹ä»ä¼šè¢«è®¤ä¸ºæ˜¯$TP_{io}$ï¼Œè€Œ$TP_{po,afterT}$ï¼ˆä¸å¸¦${}<em>{tpl}$ï¼‰ä¸ä¼šè¢«è®¤ä¸ºæ˜¯$TP</em>{io}$ï¼Œæ‰€ä»¥æœ€ç»ˆ$TP_{io}$ç”±æ‰€æœ‰$TP_{po}$åŠ ä¸Šé‚£äº›ä¼šè¢«è®¤ä¸ºæ˜¯$TP_{io}$çš„$FN_{po,tpl}$å†å»æ‰ä¸å¸¦${}<em>{tpl}$çš„$TP</em>{po,afterT}$ç»„æˆï¼Œå³å…¬å¼(6)</li><li>åŒæ—¶ï¼Œæ ¹æ®å…¬å¼(6)ï¼Œå¦‚æœ$TP_{po}$å˜ä¸º$FN_{po,tpl}$ï¼Œä¹Ÿä¸ä¼šå¯¹æœ€ç»ˆç»“æœé€ æˆå½±å“ã€‚ä½†æ˜¯æ ¹æ®å…¬å¼(5)å’Œå…¬å¼(7)ï¼Œ$TP_{po,withinT}$å˜æˆ$FN_{po,withinT,fnl}$ä¼šå‡å°$TP_{io}$åŒæ—¶å¢å¤§$FN_{io}$</li><li>æ–‡ç« æŒ‡å‡ºï¼Œè™½ç„¶$FN_{po,withinT,tpl}$å’Œ$FN_{po,afterT,tpl}$æœ€åéƒ½ä¼šè¢«è®¤ä¸ºæ˜¯$TP_{io}$ï¼Œä½†ä½œè€…å‡è®¾$FN_{po,withinT,tpl}$æ›´éš¾æ£€æµ‹ï¼Œæ‰€ä»¥åº”è¯¥ä¿ç•™ï¼Œè€Œ$FN_{po,afterT,tpl}$åº”è¯¥å‰Šå‡</li><li>Label Screeningæ–¹æ³•å»é™¤äº†$FN_{po,afterT}$çš„ç‚¹</li><li>Screenedä¹‹åçš„è®­ç»ƒé›†è¢«ç”¨æ¥è®­ç»ƒDNNä¸»æ¨¡å‹ï¼Œä½†Label Screeningçš„é¢„æµ‹ç»“æœä¹Ÿä¼šè¢«ä¿ç•™ï¼Œå’ŒDNNä¸»æ¨¡å‹çš„ç»“æœè¿›è¡Œç»„åˆ</li></ol><p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/ZDT5fQNojsXm84q.png" srcset="/img/loading.gif" alt=""></p><h3 id="Relearning-Algorithm"><a href="#Relearning-Algorithm" class="headerlink" title="Relearning Algorithm"></a>Relearning Algorithm</h3><p>Relearning Modelçš„è¾“å…¥æ˜¯DNNä¸»æ¨¡å‹é¢„æµ‹å‡ºæ¥çš„å¼‚å¸¸ï¼Œå…¶ä¸­åŒ…æ‹¬TPå’ŒFPã€‚Relearning Modelé‡‡ç”¨çš„æ˜¯éšæœºæ£®æ—ï¼Œå…¶è¾“å…¥çš„æ ·æœ¬é€šè¿‡é‡‡æ ·å¾—åˆ°ï¼š<br>$$<br>\begin{align}<br>\text{relearning}\space&amp;\text{training set}=\&amp; shuffle{4C\ast\text{randomof}(TP_{po})\&amp;+C\cdot\text{randomof}(FP_{po})+C\cdot\text{randomof}(TN_{po})}<br>\end{align}<br>$$<br>å…¶ä¸­$C$ä¸ºå¸¸æ•°ã€‚TNå’ŒFPéƒ½çœ‹ä½œæ˜¯è´Ÿä¾‹(æ­£å¸¸æ ·æœ¬)ï¼ŒTPçœ‹ä½œæ˜¯æ­£ä¾‹ã€‚</p><p><img src="https://i.loli.net/2020/06/24/qgvINaFu9JLfM4j.png" srcset="/img/loading.gif" alt=""></p><h3 id="Detection"><a href="#Detection" class="headerlink" title="Detection"></a>Detection</h3><p>å¯¹äºä¸€ä¸ªæ»‘åŠ¨çª—å£$x_t={x_{t-w+1},\cdots,x_t}$ï¼Œå¼‚å¸¸æ£€æµ‹ç®—æ³•çš„ç›®æ ‡æ˜¯è¾“å‡ºæ£€æµ‹ç»“æœ$y_t\in{0,1}$æ¥è¡¨ç¤ºæ—¶é—´$t$æ˜¯å¦å‘ç”Ÿå¼‚å¸¸ã€‚å®é™…ä¸Šç®—æ³•è¾“å‡ºçš„æ˜¯$p_{y_t}\in[0,1]$æ¦‚ç‡å€¼æ¥è¡¨ç¤ºåœ¨æ—¶é—´$t$å‘ç”Ÿå¼‚å¸¸çš„æ¦‚ç‡ã€‚æ–‡ä¸­ä¸‰ä¸ªæ¨¡å‹ä¼šå¾—åˆ°ä¸‰ä¸ªè¾“å‡ºï¼š$y_{t,ls},y_{t,main},y_{t,re}$ã€‚æœ€ç»ˆç»“æœä¸ºï¼š<br>$$<br>y_t=y_{t,ls}\space&amp;\space y_{t,main}\space&amp; \space y_{t,re}<br>$$<br>åœ¨ç»˜åˆ¶PRæ›²çº¿æ—¶ï¼Œé‡‡ç”¨çš„å…¬å¼ä¸ºï¼š<br>$$<br>\begin{align}<br>p_{y_t}(th)=&amp;(1-sig(p_{y_t,ls},th))\cdot(p_{y_t,ls})\<br>&amp;+sig(p_{y_t,ls},th)\cdot(1-sig(p_{y_t,main},th))\cdot p_{y_t,main}\<br>&amp;+sig(p_{y_t,ls},th)\cdot sig(p_{y_t,main},th)\cdot p_{y_t,re}\<br>\end{align}<br>$$</p><p>$$<br>y_t(th)=sig(p_{y_t}(th),th)<br>$$</p><p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/06/24/LBT59eugKEPymO8.png" srcset="/img/loading.gif" alt=""></p><h2 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h2><h3 id="Datasets"><a href="#Datasets" class="headerlink" title="Datasets"></a>Datasets</h3><p>æ¸…åAIOpsæ•°æ®é›†ï¼Œé€‰å–äº†25æ¡KPIã€‚</p><h3 id="Preprocessing"><a href="#Preprocessing" class="headerlink" title="Preprocessing"></a>Preprocessing</h3><ol><li><strong>Missing Data.</strong> å»é™¤ã€‚</li><li><strong>Standardization.</strong> Minmax Standardizationï¼ŒFeature Extractionä½¿ç”¨çš„æ˜¯Standardizationåçš„æ•°æ®ã€‚</li><li><strong>Feature Extraction.</strong> ä½¿ç”¨äº†12ç§ç‰¹å¾ã€‚</li></ol><table><thead><tr><th>Group</th><th>Feature Name</th></tr></thead><tbody><tr><td>Values</td><td>The original values standardized</td></tr><tr><td>Statistical Features</td><td>Mean,  Standard Deviation, Range, Differenceâ€¦</td></tr><tr><td>Fitting Features</td><td>EWMA, AR</td></tr><tr><td>Wavelet Features</td><td>Db2 wavelet decomposition</td></tr></tbody></table><h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><h3 id="AUCPR"><a href="#AUCPR" class="headerlink" title="AUCPR"></a>AUCPR</h3><p><img src="https://i.loli.net/2020/06/24/LAqNMW1zvs8eP7X.png" srcset="/img/loading.gif" alt=""></p><p><img src="https://i.loli.net/2020/06/24/YgRwavDIn7izLPX.png" srcset="/img/loading.gif" alt=""></p><h3 id="F1"><a href="#F1" class="headerlink" title="F1"></a>F1</h3><p><img src="https://i.loli.net/2020/06/24/FM3BUhQXtpo7aiu.png" srcset="/img/loading.gif" alt=""></p><h2 id="Remark"><a href="#Remark" class="headerlink" title="Remark"></a>Remark</h2><ol><li>è¿™ç¯‡æ–‡ç« çš„Label Screeningæ–¹æ³•å®é™…ä¸Šæ˜¯åœ¨å¤„ç†æ ·æœ¬åˆ†ç±»éš¾æ˜“åº¦çš„é—®é¢˜ï¼Œå°†å¼‚å¸¸åŒºé—´å†…å®¹æ˜“çš„æ ·æœ¬å»é™¤äº†</li><li>å¯¹äºæ—¶é—´åºåˆ—çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¸€èˆ¬æ˜¯Point-basedçš„å¼‚å¸¸æ ‡ç­¾ï¼Œä¸€ä¸ªæ—¶é—´ç‚¹çš„ç‰¹å¾æ˜¯æœ‰é™çš„ã€‚å¦‚æœç”¨çª—å£çš„æ–¹å¼ï¼Œä»¥${x_{t-w+1},\cdots,x_t}$ä½œä¸ºæ—¶é—´$t$çš„è¾“å…¥ï¼ˆå½“ç„¶æ¯ä¸ª$x_t$å¯ä»¥æœ‰å¤šä¸ªChannelï¼‰ï¼Œç„¶åæŠŠé¢„æµ‹ç»“æœä½œä¸ºæ—¶é—´$t$çš„è¾“å‡º</li></ol>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Unsupervised Anomaly Detection via Variational Auto-Encoder for Seasonal KPIs in Web Applications</title>
    <link href="/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/"/>
    <url>/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/</url>
    
    <content type="html"><![CDATA[<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>æœ¬æ–‡æå‡ºäº†Donutï¼Œä¸€ä¸ªåŸºäºVAEçš„æ— ç›‘ç£æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿã€‚</p><p><a href="https://dl.acm.org/citation.cfm?id=3185996" target="_blank" rel="noopener">åŸæ–‡</a></p><img src="https://i.loli.net/2020/06/25/aoNWpGDLmJzwXOj.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h2><ol><li>Donutä¸­ä½¿ç”¨åˆ°äº†ä¸‰ä¸ªæŠ€å·§ï¼ŒåŒ…æ‹¬æ”¹è¿›åçš„ELBOã€ç¼ºå¤±æ•°æ®æ³¨å…¥å’ŒMCMCæ’å€¼ï¼›</li><li>æå‡ºåŸºäºVAEçš„å¼‚å¸¸æ£€æµ‹è®­ç»ƒæ—¢éœ€è¦æ­£å¸¸æ ·æœ¬ä¹Ÿéœ€è¦å¼‚å¸¸æ ·æœ¬ï¼›</li><li>å¯¹Donutæå‡ºäº†åœ¨z-ç©ºé—´ä¸­åŸºäºKDEçš„ç†è®ºè§£é‡Šã€‚</li></ol><h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><h3 id="Anomaly-Detection"><a href="#Anomaly-Detection" class="headerlink" title="Anomaly Detection"></a>Anomaly Detection</h3><p>å¯¹äºä»»æ„æ—¶é—´$t$ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼$x_{t-T+1},\cdots,x_t$ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º$y_t=1$)ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚$p(y_t=1|x_{t-T+1},\cdots,x_t)$ã€‚</p><h2 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h2><h3 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h3><p>æœ¬æ–‡çš„ç›®çš„æ˜¯<strong>åŸºäºæ·±åº¦ç”Ÿæˆç½‘ç»œå¼€å‘å…·æœ‰ç†è®ºè§£é‡Šæ€§çš„æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œå¹¶ä¸”åœ¨æœ‰æ ‡ç­¾çš„æƒ…å†µä¸‹èƒ½åˆ©ç”¨æ ‡ç­¾ä¿¡æ¯æå‡æ€§èƒ½</strong>ã€‚æœ¬æ–‡åŸºäºVAEæ¥æ„å»ºæ¨¡å‹ã€‚</p><img src="https://i.loli.net/2020/06/25/PoKJmnIpEqNdtCe.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Network-Structure"><a href="#Network-Structure" class="headerlink" title="Network Structure"></a>Network Structure</h3><p>ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/DFP1boZNzdVG9pH.png" srcset="/img/loading.gif" style="zoom: 80%;" /><p>ä¸€å…±åŒ…å«äº†é¢„å¤„ç†ã€è®­ç»ƒå’Œæ£€æµ‹ä¸‰ä¸ªéƒ¨åˆ†ã€‚</p><p>ä¸‹å›¾ä¸ºæ¨¡å‹çš„æ¦‚ç‡å›¾æ¨¡å‹ï¼š</p><img src="https://i.loli.net/2020/06/25/HlDXkSeFOruVbac.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>å›¾ä¸­åŒå®çº¿çš„æ¡†ä¸ºæœ¬æ–‡æ¨¡å‹æœ‰åˆ«äºä¼ ç»ŸVAEçš„åœ°æ–¹ï¼Œå…¶ä½™åœ°æ–¹å’ŒVAEä¸€æ ·ã€‚å…ˆéªŒæ¦‚ç‡$p_\theta(z)$é€‰ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ$\mathcal{N}(0,I)$ï¼ŒåéªŒæ¦‚ç‡$x$å’Œ$z$éƒ½æ˜¯å¯¹è§’åŒ–é«˜æ–¯åˆ†å¸ƒï¼Œå³$p_\theta(x|z)=\mathcal{N}(\mu_x,\sigma_x^2 I),q_\phi(z|x)=\mathcal{N}(\mu_z,\sigma_z^2 I)$ã€‚å¦‚Figure 4æ‰€ç¤ºï¼Œæ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œä¸­åˆ†åˆ«éƒ½æœ‰éšå«å±‚$f_\phi(x)$å’Œ$f_\theta(z)$å¯¹ç½‘ç»œçš„è¾“å…¥è¿›è¡Œç‰¹å¾æŠ½å–ã€‚é«˜æ–¯åˆ†å¸ƒçš„å‚æ•°å³ä»è¿™äº›æŠ½å–å‡ºæ¥çš„ç‰¹å¾ä¸Šå¾—åˆ°ã€‚å‡å€¼é€šè¿‡çº¿æ€§å±‚å¾—åˆ°ï¼š$\mu_x=W^T_{\mu_x}f_\theta(z)+b_{\mu_x}, \mu_z=W^T_{\mu_z}f_\theta(x)+b_{\mu_z}$ã€‚æ ‡å‡†å·®é€šè¿‡Soft Pluså±‚åŠ ä¸€ä¸ªé«˜æ–¯å™ªå£°å¾—åˆ°ï¼š$\sigma_x=\text{SoftPlus}[W^T_{\sigma_x}f_\theta(z)+b_{\sigma_x}]+\varepsilonï¼Œ\sigma_x=\text{SoftPlus}[W^T_{\sigma_z}f_\theta(x)+b_{\sigma_z}]+\varepsilon$ã€‚</p><p>æ–‡ä¸­æåˆ°å› ä¸ºKPIçš„å±€éƒ¨æ–¹å·®éå¸¸å°ï¼Œæ‰€ä»¥é‡‡ç”¨ç›´æ¥å»ºæ¨¡$\sigma_x,\sigma_z$çš„æ–¹å¼è€Œä¸æ˜¯é‡‡ç”¨å¯¹æ•°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸ºäº†ç†è®ºä¸Šçš„è§£é‡Šæ€§ï¼Œæ–‡ä¸­çš„ç¥ç»ç½‘ç»œåªä½¿ç”¨äº†å…¨è¿æ¥å±‚ã€‚</p><h3 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h3><p>è®­ç»ƒå¯ä»¥ç›´æ¥é‡‡ç”¨ç»å…¸çš„SGVBæ¥ä¼˜åŒ–ELBOï¼š<br>$$<br>\begin{align}<br>\log p_\theta(x)&amp;\geq\log p_\theta(x)-\text{KL}[q_\phi(z|x)\parallel p_\theta(z|x)]\<br>&amp;=\mathcal{L}\<br>&amp;=\mathbb{E}<em>{q_\phi(z|x)}[\log p_\theta(x)+\log p_\theta(z|x)-\log q_\phi(z|x)]\<br>&amp;=\mathbb{E}</em>{q_\phi(z|x)}[\log p_\theta(x,z)-\log q_\phi(z|x)]\<br>&amp;=\mathbb{E}<em>{q_\phi(z|x)}[\log p_\theta(x|z)+\log p_\theta(z)-\log q_\phi(z|x)]<br>\end{align}<br>$$<br>ä½†æ˜¯åœ¨å®é™…çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè®­ç»ƒæ•°æ®éœ€è¦ä¿è¯éƒ½æ˜¯æ­£å¸¸æ ·æœ¬ï¼Œä½†å®é™…ä¸Šè®­ç»ƒæ ·æœ¬æœ‰å¯èƒ½ä¼šåŒ…å«å¼‚å¸¸æˆ–è€…æ˜¯ç¼ºå¤±å€¼ã€‚ä¸€ç§åšæ³•æ˜¯ç”¨ç¼ºå¤±å€¼å¡«å……çš„ç®—æ³•æ¥å¡«å……è¿™äº›å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼ï¼Œä½†ä½œè€…è®¤ä¸ºä½¿ç”¨ç¼ºå¤±å€¼å¡«å……ç®—æ³•å¹¶ä¸èƒ½å¾ˆå¥½çš„è¿˜åŸæ•°æ®çš„æ­£å¸¸æ¨¡å¼ï¼Œä»è€Œä¿è¯ç®—æ³•çš„æœ‰æ•ˆæ€§ã€‚åœ¨æ–‡ä¸­ä½œè€…é‡‡ç”¨äº†ä¿®æ”¹ELBOçš„æ–¹æ³•ï¼Œå¹¶å°†å…¶ç§°ä¹‹ä¸º<strong>Modified ELBO (M-ELBO)</strong>ï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\tilde{\mathcal{L}}=\mathbb{E}</em>{q_\phi(z|x)}[\sum\limits_{w=1}^W{\alpha_w\log p_\theta(x_w|z)+\beta\log p_\theta(z)-\log q_\phi(z|x)}]<br>$$<br>å…¶ä¸­$\alpha_w$ä¸ºæŒ‡ç¤ºæ ‡è®°ï¼Œ$\alpha_w=1$ä»£è¡¨ä¸æ˜¯å¼‚å¸¸ä¹Ÿä¸æ˜¯ç¼ºå¤±ã€‚$\beta$å®šä¹‰ä¸º$\beta=\frac{\sum_{w=1}^W\alpha_w}{W}$ã€‚</p><p>åœ¨<strong>M-ELBO</strong>ä¸­ï¼Œå¼‚å¸¸æˆ–ç¼ºå¤±å€¼å¯¹åº”çš„$\log p_\theta(x_w|z)$çš„è´¡çŒ®ä¼šè¢«æ’é™¤ï¼ŒåŒæ—¶$\log p_\theta(z)$åœ¨ä¹˜ä»¥$\beta$åä¼šç›¸åº”ç¼©å°ã€‚ä½œè€…æ²¡æœ‰ä¿®æ”¹$\log q_\phi(z|x)$è¿™ä¸€é¡¹çš„åŸå› æœ‰äºŒï¼šä¸€æ˜¯$q_\phi(z|x)$ä»…ä»…æ˜¯ä»$x$åˆ°$z$çš„æ˜ å°„ï¼Œå¹¶ä¸éœ€è¦è€ƒè™‘â€œæ­£å¸¸æ¨¡å¼â€ï¼›äºŒæ˜¯$\mathbb{E}_{q_\phi(z|x)}[-\log q_\phi(z|x)]$å°±æ˜¯$q_\phi(z|x)$çš„ç†µï¼Œè€Œè¿™ä¸ªåœ¨åé¢çš„ç†è®ºåˆ†æä¸­æœ‰ç‰¹åˆ«çš„å«ä¹‰ã€‚</p><p>é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ç§è§£å†³æ–¹æ³•å°±æ˜¯æŠŠæ‰€æœ‰åŒ…å«å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼çš„çª—å£å»é™¤ï¼Œè¿™ç§æ–¹æ³•çš„æ€§èƒ½åœ¨å®éªŒä¸­ä¼šè¿›è¡Œè®¨è®ºã€‚</p><p>åœ¨æ–‡ä¸­ä½œè€…è¿˜ä½¿ç”¨äº†ä¸€ç§<strong>Missing Data Injection</strong>æŠ€æœ¯ï¼Œå³åœ¨æ¯ä¸ªEpochéšæœºçš„æŒ‰ç…§ä¸€ä¸ªé¢„è®¾æ¯”ä¾‹$\lambda$å°†æ­£å¸¸çš„æ•°æ®è®¾ä¸ºç¼ºå¤±ã€‚ä½œè€…è®¤ä¸ºè¿™æ ·æœ‰åŠ©äºæ€§èƒ½çš„æå‡ã€‚</p><h3 id="Detection"><a href="#Detection" class="headerlink" title="Detection"></a>Detection</h3><p>åœ¨æ£€æµ‹é˜¶æ®µï¼Œå¯¹äºä¸€ä¸ªè¾“å…¥æ ·æœ¬ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡å‹è¾“å‡ºå…¶å¼‚å¸¸çš„æ¦‚ç‡ã€‚å› ä¸ºæˆ‘ä»¬å»ºæ¨¡äº†$p_\theta(x|z)$ï¼Œä¸€ç§æ–¹æ³•æ˜¯é‡‡æ ·è®¡ç®—$p_\theta(x)=\mathbb{E}<em>{p_\theta(z)}[p_\theta(x|z)]$ï¼Œä½†è¿™ç§æ–¹æ³•è®¡ç®—ä»£ä»·ååˆ†æ˜‚è´µã€‚å…¶ä»–çš„ä¸€äº›æ–¹æ¡ˆæœ‰è®¡ç®—$\mathbb{E}</em>{q_\phi(z|x)}[p_\theta(x|z)]$æˆ–$\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]$ï¼Œå…¶ä¸­åè€…è¢«ç§°ä¸ºâ€<strong>Reconstruction Probability</strong>â€œï¼Œä½œè€…ä¾¿é‡‡ç”¨äº†è¿™ç§æ–¹æ¡ˆã€‚</p><p>åŒæ—¶ï¼Œä½œè€…è®¤ä¸ºè¾“å…¥çš„æ£€æµ‹æ ·æœ¬çš„ç¼ºå¤±å€¼ä¼šå¯¹ç»“æœé€ æˆè¾ƒå¤§åå·®ï¼Œäºæ˜¯ä½¿ç”¨äº†ä¸€ç§<strong>MCMC-based Missing Data Imputation</strong>çš„æ–¹æ³•æ¥å¯¹æ£€æµ‹æ ·æœ¬çš„ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ã€‚å…·ä½“åšæ³•æ˜¯å°†æµ‹è¯•æ ·æœ¬åˆ†ä¸ºå·²è§‚æµ‹å’Œç¼ºå¤±ä¸¤éƒ¨åˆ†$x=(x_o,x_m)$ï¼Œç„¶åä½¿ç”¨è®­ç»ƒå¥½çš„VAEè¿›è¡Œé‡æ„å¾—åˆ°$(x^\prime_o,x^\prime_m)$ï¼Œç„¶åç”¨$x^\prime_m$æ›¿æ¢$x_m$ï¼Œè¿™æ ·ä¸æ–­å¾ªç¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/wEenLKz4URfm2FN.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä½œè€…ä½¿ç”¨äº†$L$ä¸ªæ ·æœ¬æ¥è®¡ç®—<strong>Reconstruction Probability</strong>ï¼Œè™½ç„¶å¾—åˆ°çš„è¾“å‡ºæ˜¯é’ˆå¯¹æ•´ä¸ªçª—å£æ¯ä¸ªç‚¹çš„ï¼Œä½†ä½œè€…åªä½¿ç”¨æœ€åä¸€ä¸ªç‚¹ã€‚</p><h2 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h2><h3 id="Datasets"><a href="#Datasets" class="headerlink" title="Datasets"></a>Datasets</h3><p>ä½œè€…é€‰æ‹©äº†ä¸‰æ¡KPIä½œä¸ºæµ‹è¯•æ•°æ®ï¼Œåˆ†åˆ«è®°ä¸º$\mathcal{A}$ï¼Œ$\mathcal{B}$ï¼Œ$\mathcal{C}$ï¼Œå…¶åŸºæœ¬æ•°æ®å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/A9qajrZtmhcvyHW.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Metrics"><a href="#Metrics" class="headerlink" title="Metrics"></a>Metrics</h3><p>å› ä¸ºå¼‚å¸¸æ£€æµ‹ç±»åˆ«çš„æä¸å‡è¡¡æ€§ï¼Œä¼ ç»Ÿçš„æ€§èƒ½æŒ‡æ ‡å¹¶ä¸å¤ªåˆé€‚ï¼ˆå¼‚å¸¸æ ·æœ¬æå°‘ï¼Œä¸”å¼‚å¸¸ä¸€èˆ¬å‘ˆè¿ç»­çš„ç‰‡æ®µï¼‰ã€‚ä½œè€…è®¤ä¸ºåœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­è¿ç»´äººå‘˜éœ€è¦å°½é‡æ—©çš„è·çŸ¥å¼‚å¸¸çš„å‘ç”Ÿï¼Œäºæ˜¯æå‡ºäº†æ–°çš„è¯„æµ‹æœºåˆ¶ã€‚</p><img src="https://i.loli.net/2020/06/25/6LNwizqrWVe5sRv.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¬¬ä¸€è¡Œä¸ºçœŸå®çš„æ ‡ç­¾ï¼Œç¬¬äºŒè¡Œä¸ºé¢„æµ‹çš„å¼‚å¸¸æ¦‚ç‡ï¼Œç¬¬ä¸‰è¡Œä¸ºé¢„æµ‹çš„æ ‡ç­¾ã€‚ç¬¬ä¸€è¡Œä¸­å¼‚å¸¸ç‰‡æ®µè¢«åŠ ç²—è¡¨ç¤ºï¼Œå¯¹äºæ¯ä¸€ä¸ªå¼‚å¸¸ç‰‡æ®µçš„ç¬¬ä¸€ä¸ªä½ç½®${y}<em>{t^\prime}$ï¼Œå¦‚æœé¢„æµ‹çš„æ ‡ç­¾ä¸­å­˜åœ¨$\hat{y}</em>{t}$æ»¡è¶³$t^\prime&lt;t$ä¸”$|t-t^\prime|$å°äºç­‰äºé¢„è®¾çš„é˜ˆå€¼$T$ï¼Œé‚£ä¹ˆ$y_{t^\prime}$å¯¹åº”çš„æ•´æ®µå¼‚å¸¸éƒ½è¢«è®¤ä¸ºæ­£ç¡®æ£€æµ‹ï¼Œå¦åˆ™æ•´æ®µå¼‚å¸¸éƒ½è®¤ä¸ºæ²¡æœ‰è¢«æ­£ç¡®æ£€æµ‹ã€‚ç„¶ååœ¨æ­¤åŸºç¡€ä¸Šè®¡ç®—F1-scoreï¼ŒAUCç­‰æŒ‡æ ‡ä½œä¸ºè¯„æµ‹æ‰‹æ®µã€‚</p><h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><h3 id="Overall-Performance"><a href="#Overall-Performance" class="headerlink" title="Overall Performance"></a>Overall Performance</h3><p>ä¸‹å›¾å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š</p><img src="https://i.loli.net/2020/06/25/2j1Br45MUxTaYEX.png" srcset="/img/loading.gif" style="zoom:67%;" /><h3 id="Effects-of-Donut-Techniques"><a href="#Effects-of-Donut-Techniques" class="headerlink" title="Effects of Donut Techniques"></a>Effects of Donut Techniques</h3><p>ä¸ºäº†æ¢ç©¶Donutä¸­æ‰€åšçš„å„ç§æ”¹è¿›çš„å®é™…ä½œç”¨ï¼Œä½œè€…åšäº†å¤§é‡å¯¹æ¯”å®éªŒï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/raHG6Phyxo1j82n.png" srcset="/img/loading.gif" style="zoom:67%;" /><ul><li><strong>M-ELBO</strong> ä»å›¾ä¸­å¯ä»¥çœ‹å‡º<strong>M-ELBO</strong>å¯¹æ€§èƒ½æå‡æœ€å¤§ã€‚ä½œè€…åœ¨æ–‡ä¸­æåˆ°ä¸€å¼€å§‹å¹¶æ²¡æœŸæœ›<strong>M-ELBO</strong>èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ï¼Œåªæ˜¯å¸Œæœ›å®ƒèƒ½å¤ŸWorkã€‚è¿™è¡¨æ˜åœ¨VAEçš„è®­ç»ƒä¸­ï¼Œåªä½¿ç”¨æ­£å¸¸æ ·æœ¬æ˜¯ä¸å¤Ÿçš„ï¼Œä¹Ÿéœ€è¦åŠ å…¥éæ­£å¸¸çš„ä¿¡æ¯ï¼›</li><li><strong>Missing Data Injection</strong> è¯¥æŠ€å·§çš„ä¸»è¦ä½œç”¨æ˜¯å¢å¼º<strong>M-ELBO</strong>çš„æ•ˆæœã€‚ä»ç»“æœä¸Šæ¥çœ‹ä½œç”¨å¹¶ä¸æ˜¯ååˆ†çš„æ˜¾è‘—ï¼Œåªæ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹è·å¾—äº†å°‘é‡çš„æå‡ï¼›</li><li><strong>MCMC Imputation</strong> ä½œè€…è®¤ä¸ºè™½ç„¶è¯¥æŠ€å·§åªåœ¨ä¸€éƒ¨åˆ†æƒ…å†µä¸‹æ˜¾è‘—æå‡äº†æ€§èƒ½ï¼Œä½†æ€»ä½“æ¥è¯´å€¼å¾—ä½¿ç”¨ã€‚</li></ul><h3 id="Impact-of-K"><a href="#Impact-of-K" class="headerlink" title="Impact of K"></a>Impact of K</h3><p>è¯¥éƒ¨åˆ†ä½œè€…æ¢ç©¶äº†éšå˜é‡$z$çš„ç»´åº¦$K$å¯¹æ€§èƒ½çš„å½±å“ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p><img src="https://i.loli.net/2020/06/25/OXpIRoe4wr7YzuQ.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä»å›¾ä¸Šæ¥çœ‹ï¼Œå¯¹æ•°æ®é›†$\mathcal{A}$ï¼Œ$\mathcal{B}$ï¼Œ$\mathcal{C}$æœ€ä½³çš„$K$åˆ†åˆ«æ˜¯$5$ï¼Œ$4$å’Œ$3$ï¼Œä½†æ˜¯è®¾å®šè¾ƒå¤§çš„$K$å¹¶ä¸ä¼šå¯¹æ€§èƒ½æœ‰ä¸¥é‡çš„æŸå®³ã€‚ä½œè€…è¿˜å‘ç°å¯¹äºè¾ƒä¸ºå¹³æ»‘çš„KPIéœ€è¦è¾ƒå¤§çš„$K$ã€‚</p><h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><h3 id="KDE-Interpretation"><a href="#KDE-Interpretation" class="headerlink" title="KDE Interpretation"></a>KDE Interpretation</h3><p>åœ¨è¿™ä¸€èŠ‚ä½œè€…å¯¹<strong>Reconstruction Probability</strong>çš„æ„ä¹‰è¿›è¡Œäº†æ·±å…¥çš„æ¢è®¨ã€‚é¦–å…ˆä½œè€…å¯¹$q_\phi(z|x)$è¿›è¡Œäº†å¯è§†åŒ–ï¼Œåœ¨å›¾ä¸­ä½œè€…å°†æ—¶é—´ç»´åº¦ç”¨é¢œè‰²æ¥è¡¨ç¤ºã€‚å¦‚Figure 11(a) æ‰€ç¤ºï¼Œ$z$å‡ ä¹æ˜¯æŒ‰ç…§$x$å¯¹åº”çš„æ—¶é—´å‘ˆä¸€ä¸ªè¿ç»­çš„æµå½¢åˆ†å¸ƒï¼Œä½œè€…å°†è¿™ç§ç°è±¡ç§°ä¸º<strong>Time Gradient</strong>ã€‚å³ä½¿Donutæ²¡æœ‰æ˜¾å¼çš„ç”¨åˆ°æ—¶é—´ä¿¡æ¯ï¼Œä¸è¿‡å› ä¸ºå®éªŒç”¨åˆ°çš„æ•°æ®åŸºæœ¬æ˜¯å¹³æ»‘çš„ï¼Œæ‰€ä»¥è¯´ç›¸é‚»çš„$x$ä¼šæ¯”è¾ƒç›¸ä¼¼ï¼Œå› æ­¤ç»è¿‡æ˜ å°„åçš„$z$ä¹Ÿä¼šæ¯”è¾ƒç›¸ä¼¼ã€‚ä½œè€…æ®æ­¤æå‡ºDonutçš„ä¸€ä¸ªä¼˜åŠ¿ä¾¿æ˜¯å¯¹äºæ²¡æœ‰è§è¿‡çš„åéªŒåˆ†å¸ƒ$q_\phi(z|x)$ï¼Œåªè¦å…¶ä½äºè®­ç»ƒè¿‡çš„ä¸¤ä¸ªåéªŒä¹‹é—´ï¼Œä¹Ÿä¼šäº§ç”Ÿåˆç†çš„åˆ†å¸ƒã€‚</p><img src="https://i.loli.net/2020/06/25/BHfP5DUZ48ALnma.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>å¯¹äºå¼‚å¸¸çš„æ ·æœ¬$x$ï¼Œå‡è®¾å…¶å¯¹åº”çš„æ­£å¸¸æ¨¡å¼ä¸º$\tilde{x}$ï¼Œä½œè€…è®¤ä¸º$q_\phi(z|x)$ä¼šåœ¨æŸç§ç¨‹åº¦ä¸Šå¯¹æ­£å¸¸çš„$q_\phi(z|\tilde{x})$è¿›è¡Œè¿‘ä¼¼ã€‚å› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è¿›è¡Œè®­ç»ƒçš„ï¼Œéšå˜é‡$z$çš„ç»´åº¦é€šå¸¸æ¥è¯´å°äºæ ·æœ¬$x$ï¼Œè¿™å°±å¯¼è‡´$z$åªä¼šä¿ç•™ä¸€éƒ¨åˆ†ä¸»è¦çš„ä¿¡æ¯ã€‚å¯¹äºå¼‚å¸¸æ ·æœ¬ï¼Œå…¶å¼‚å¸¸æ¨¡å¼åœ¨ç¼–ç æ—¶å°±è¢«ä¸¢æ‰äº†ã€‚ä½œè€…è¿˜æŒ‡å‡ºå¦‚æœ$x$åŒ…å«çš„å¼‚å¸¸å¤ªå¤šï¼Œé‚£ä¹ˆæ¨¡å‹å°†éš¾ä»¥å¯¹$x$è¿›è¡Œè¿˜åŸã€‚</p><img src="https://i.loli.net/2020/06/25/HcX78lUoG4meJq5.png" srcset="/img/loading.gif" style="zoom: 50%;" /><p>åŸºäºä¸Šè¿°è®¨è®ºï¼Œä½œè€…å¯¹ä½¿ç”¨$\mathbb{E}<em>{q_\phi(z|x)}[\log p_\theta(x|z)]$ä½œä¸º<strong>Reconstruction Probability</strong>çš„æ„ä¹‰è¿›è¡Œäº†é˜é‡Šã€‚è®¾è¾“å…¥æ ·æœ¬ä¸º$x$ï¼Œå¦‚æœå…¶åŒ…å«å¼‚å¸¸ï¼Œå‡è®¾å…¶å¯¹åº”çš„æ­£å¸¸æ ·æœ¬ä¸º$\tilde{x}$ï¼Œé‚£ä¹ˆ$q_\phi(z|x)$éƒ¨åˆ†åœ°å’Œ$q_\phi(z|\tilde{x})$ç›¸ä¼¼ã€‚å¦‚æœ$x$å’Œ$\tilde{x}$ç›¸ä¼¼ç¨‹åº¦é«˜ï¼Œé‚£ä¹ˆ$\log p_\theta(x|z)$å°±ä¼šå¾ˆå¤§ï¼ˆå…¶ä¸­$z\sim q_\phi(z|\tilde{x})$ï¼‰ã€‚$\log p_\theta(x|z)$ç±»ä¼¼äºä¸€ä¸ªå¯†åº¦ä¼°è®¡å™¨ï¼Œä»£è¡¨$x$åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸$\tilde{x}$æ¥è¿‘ï¼Œ$\mathbb{E}</em>{q_\phi(z|x)}[\log p_\theta(x|z)]$ç›¸å½“äºå¯¹æ¯ä¸€ä¸ª$z$å¯¹åº”çš„$\log p_\theta(x|z)$ä¹˜ä»¥ä¸€ä¸ªæƒé‡$q_\phi(z|x)$ç„¶åç›¸åŠ ã€‚äºæ˜¯ä½œè€…æå‡ºäº†<strong>Reconstruction Probability</strong>çš„<strong>KDE Interpretation</strong>:åœ¨Donutæ¨¡å‹ä¸­ï¼Œ<strong>Reconstruction Probability</strong> $\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]$å¯ä»¥çœ‹ä½œæ˜¯ä»¥$q_\phi(z|x)$ä¸ºæƒé‡ï¼Œ$\log p_\theta(x|z)$ä¸ºæ ¸çš„æ ¸å¯†åº¦ä¼°è®¡ (Kernel Density Estimation)ã€‚</p><p>ä¸‰ç»´å¯è§†åŒ–å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/GeWufVlUDo4QtO6.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä½œè€…è¿˜å¯¹ç›´æ¥è®¡ç®—$p_\theta(x)=\mathbb{E}_{p_\theta(z)}[p_\theta(x|z)]$è¿›è¡Œäº†è´¨ç–‘ï¼Œå› ä¸ºè¿™ç§æ–¹æ³•ç›´æ¥æ±‚$x$çš„å…ˆéªŒï¼Œä»…ä»…è€ƒè™‘äº†$x$çš„æ€»ä½“æ¨¡å¼ï¼Œè€Œå¿½ç•¥äº†$x$çš„ä¸ªä½“æ¨¡å¼ã€‚</p><h3 id="Find-Good-Posteriors-for-Abnormal-x"><a href="#Find-Good-Posteriors-for-Abnormal-x" class="headerlink" title="Find Good Posteriors for Abnormal $x$"></a>Find Good Posteriors for Abnormal $x$</h3><p>é€šè¿‡ä¸Šé¢çš„è®¨è®ºæˆ‘ä»¬çŸ¥é“äº†Donuté€šè¿‡æ‰¾åˆ°$x$çš„æ­£å¸¸åéªŒæ¥ä¼°è®¡$x$åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸$\tilde{x}$ç›¸ä¼¼ï¼Œåœ¨è¿™ä¸€èŠ‚ä½œè€…è®¨è®ºäº†æ–‡ä¸­ä½¿ç”¨çš„ä¸åŒæŠ€å·§å¯¹æ‰¾åˆ°$x$çš„åéªŒçš„ä½œç”¨ã€‚å¯¹äº<strong>Missing Data Injection</strong>ä½œè€…è®¤ä¸ºè¯¥æŠ€å·§å¢å¼ºäº†<strong>M-ELBO</strong>çš„æ•ˆæœã€‚å¯¹äº<strong>MCMC Imputation</strong>ï¼Œä½œè€…è®¤ä¸ºè¯¥æŠ€å·§ä¸»è¦æ˜¯åœ¨æ£€æµ‹é˜¶æ®µé€šè¿‡ä¸æ–­è¿­ä»£æä¾›äº†æ›´å¥½çš„åéªŒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/8puDRylqZfQkcN6.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ä½œè€…è®¤ä¸ºï¼Œè™½ç„¶å¯¹äºåŒ…å«å¤§é‡å¼‚å¸¸çš„æ ·æœ¬ï¼ŒDonutä¸èƒ½å¾ˆå¥½çš„è¿˜åŸï¼Œä½†åœ¨è¿ç»´åœºæ™¯ä¸­ï¼Œåªè¦å¯¹å¤§æ®µå¼‚å¸¸çš„å¼€å§‹é˜¶æ®µè¿›è¡Œå‡†ç¡®é¢„æµ‹å³å¯ã€‚</p><h3 id="Causes-of-Time-Gradient"><a href="#Causes-of-Time-Gradient" class="headerlink" title="Causes of Time Gradient"></a>Causes of Time Gradient</h3><p>åœ¨è¿™ä¸€èŠ‚ä½œè€…è®¨è®ºäº†<strong>Time Gradient</strong>å‡ºç°çš„åŸå› ã€‚é¦–å…ˆå‡è®¾$x$éƒ½æ˜¯æ­£å¸¸ç‚¹ï¼Œè¿™æ—¶$x$çš„ELBOä¸ºï¼š<br>$$<br>\begin{align}<br>\mathcal{L}(x)&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)+\log p_\theta(z)-\log q_\phi(z|x)]\<br>&amp;=\mathbb{E}[\log p_\theta(x|z)]+\mathbb{E}[\log p_\theta(z)]+\text{H}[z|x]<br>\end{align}<br>$$<br>ç¬¬ä¸€é¡¹è¡¨æ˜åœ¨$z\sim q_\phi(z|x)$ä¸‹å°½å¯èƒ½é‡æ„$x$ã€‚ç¬¬äºŒé¡¹è¡¨æ˜$q_\phi(z|x)$å°½é‡ä¸$z$çš„å…ˆéªŒ$\mathcal{N}(0,I)$æ¥è¿‘ã€‚ç¬¬ä¸‰é¡¹ä¸º$q_\phi(z|x)$çš„ç†µï¼Œè¡¨æ˜$q_\phi(z|x)$åº”å°½é‡åˆ†æ•£ã€‚ç„¶è€Œç¬¬äºŒé¡¹åˆé™åˆ¶äº†è¿™ç§åˆ†æ•£çš„åŒºåŸŸï¼Œå¦‚ Figure 11(c) æ‰€ç¤ºã€‚åŒæ—¶è€ƒè™‘è¿™ä¸‰é¡¹çš„è¯ï¼Œç¬¬ä¸€é¡¹ä½¿å¾—$z$ä¸èƒ½è‡ªç”±åœ°åˆ†æ•£ï¼Œå¯¹äºä¸ç›¸ä¼¼çš„$x$å…¶å¯¹åº”çš„$z$ä¹Ÿæ˜¯ä¸ç›¸ä¼¼çš„ï¼Œå› ä¸ºè¦æœ€å¤§åŒ–$x$çš„é‡æ„æ¦‚ç‡ã€‚ç„¶è€Œå¯¹äºç›¸ä¼¼çš„$x$æ¥è¯´ï¼Œå…¶å¯¹åº”çš„$q_\phi(z|x)$ä¼šå‡ºç°å¾ˆå¤šé‡å¤çš„éƒ¨åˆ†ã€‚å½“è¾¾åˆ°å¹³è¡¡æ—¶ï¼Œ<strong>Time Gradient</strong>å°±å‡ºç°äº†ã€‚</p><img src="https://i.loli.net/2020/06/25/AaC9oNMShBRHFeY.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå½“$x$è¶Šä¸ç›¸ä¼¼ï¼Œ$q_\phi(z|x)$å°±ä¼šç›¸è·è¶Šè¿œï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ç„¶è€Œåœ¨ä¸€å¼€å§‹ï¼Œå‚æ•°ç»è¿‡éšæœºåˆå§‹åŒ–ï¼Œ$q_\phi(z|x)$éƒ½æ˜¯éšæœºæ•£ä¹±çš„ï¼Œå¦‚ Figure 11(b) æ‰€ç¤ºã€‚éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œ$q_\phi(z|x)$å°†ä¼šä¸æ–­ä¼˜åŒ–ã€‚ç”±äºKPIæ•°æ®å¾€å¾€æ˜¯å…‰æ»‘çš„ï¼Œé‚£ä¹ˆåœ¨æ—¶é—´ä¸Šç›¸è·è¶Šè¿œçš„æ ·æœ¬å°±ä¼šè¶Šä¸ç›¸ä¼¼ï¼Œå¯¹åº”çš„$q_\phi(z|x)$ä¹Ÿä¼šç›¸è·æ›´è¿œã€‚è¿™ä¹Ÿè¯´æ˜äº†ï¼Œè®­ç»ƒç»“æŸåï¼Œæ—¶é—´ä¸Šç›¸è·è¶Šè¿œçš„ï¼Œ$q_\phi(z|x)$ä¹Ÿä¼šç›¸è·è¶Šè¿œï¼Œåä¹‹äº¦ç„¶ã€‚åŒæ—¶è¿™ä¹Ÿè¡¨æ˜å­¦ä¹ ç‡çš„è®¾ç½®å¯¹æœ¬æ¨¡å‹çš„ç¨³å®šæ€§æœ‰è‡³å…³é‡è¦çš„ä½œç”¨ã€‚</p><h3 id="Sub-Optimal-Equilibrium"><a href="#Sub-Optimal-Equilibrium" class="headerlink" title="Sub-Optimal Equilibrium"></a>Sub-Optimal Equilibrium</h3><p>ä¸Šé¢æˆ‘ä»¬è®¨è®ºäº†éšç€è®­ç»ƒè¿›è¡Œ$q_\phi(z|x)$çš„æ¼”å˜ï¼Œä½œè€…æå‡ºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°æ¨¡å‹æ”¶æ•›åˆ°æ¬¡ä¼˜çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/udigOl3sJGwSaPz.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ç¬¬ä¸€è¡Œå±•ç¤ºçš„æ˜¯æ”¶æ•›åˆ°æœ€ä¼˜çš„æƒ…å†µï¼Œç¬¬äºŒè¡Œå±•ç¤ºçš„æ˜¯æ”¶æ•›åˆ°æ¬¡ä¼˜çš„æƒ…å†µã€‚ä»ç¬¬äºŒè¡Œçš„ç¬¬ä¸€ä¸ªå›¾ï¼ˆStep 100ï¼‰æ¥çœ‹ï¼Œç´«è‰²çš„ç‚¹å¼€å§‹ç©¿è¿‡ç»¿è‰²çš„ç‚¹ï¼Œéšç€è®­ç»ƒçš„è¿›è¡Œï¼Œç´«è‰²çš„ç‚¹å¼€å§‹å°†ç»¿è‰²çš„ç‚¹æ¨å¼€ã€‚åˆ°Step 5000çš„æ—¶å€™ï¼Œç»¿è‰²çš„ç‚¹å·²ç»è¢«åˆ†æˆäº†ä¸¤åŠã€‚ä¸‹å›¾å±•ç¤ºäº†å¯¹åº”çš„è®­ç»ƒè¯¯å·®å’ŒéªŒè¯è¯¯å·®ï¼š</p><img src="https://i.loli.net/2020/06/25/23zsxwurICV7aTj.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>è¿™æ ·çš„ç°è±¡ä¼šå¯¼è‡´åœ¨ä¸¤åŠç»¿è‰²åŒºåŸŸä¹‹é—´çš„æµ‹è¯•æ ·æœ¬ä¼šè¢«è¯†åˆ«ä¸ºç´«è‰²ï¼Œä»è€Œé™ä½æ€§èƒ½ã€‚ä½œè€…æå‡ºåœ¨$K$è¾ƒå¤§çš„æ—¶å€™è¿™ç§ç°è±¡ä¸å®¹æ˜“å‘ç”Ÿï¼Œä½†è¿™æ—¶è®­ç»ƒçš„æ”¶æ•›åˆä¼šæˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>VAE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Time-Series Anomaly Detection Service at Microsoft</title>
    <link href="/2019/09/22/Time-Series-Anomaly-Detection-Service-at-Microsoft/"/>
    <url>/2019/09/22/Time-Series-Anomaly-Detection-Service-at-Microsoft/</url>
    
    <content type="html"><![CDATA[<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>æœ¬æ–‡å€Ÿé‰´è®¡ç®—æœºè§†è§‰ä¸­çš„æ˜¾è‘—æ€§æ£€æµ‹ï¼Œæå‡ºäº†ä¸€ç§åŸºäºSpectral Residualçš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚</p><p><a href="https://www.kdd.org/kdd2019/accepted-papers/view/time-series-anomaly-detection-service-at-microsoft" target="_blank" rel="noopener">åŸæ–‡</a></p><p>è¿™ç¯‡æ–‡ç« è¿˜æå‡ºäº†å‡ ä¸ªæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹è½åœ°çš„éš¾ç‚¹ï¼š</p><ol><li><strong>Lack of Labels.</strong> åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¼šäº§ç”Ÿå¤§é‡çš„KPIï¼Œè€Œå¾ˆéš¾å¯¹æ¯ä¸ªKPIè¿›è¡Œäººå·¥æ ‡æ³¨ã€‚</li><li><strong>Generalization.</strong> ä¸åŒKPIæ‰€è¡¨ç°å‡ºæ¥çš„æ¨¡å¼ä¹Ÿä¸å°½ç›¸åŒï¼Œå¦‚Figure 1æ‰€ç¤ºã€‚ç°æœ‰æ–¹æ³•å¾ˆéš¾åœ¨æ‰€æœ‰æ¨¡å¼çš„KPIä¸Šéƒ½è¡¨ç°è‰¯å¥½ã€‚</li><li><strong>Efficiency.</strong> åœ¨å®é™…åœºæ™¯ä¸­ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„æ—¶é—´åºåˆ—æ•°æ®ï¼ŒåŒæ—¶å¯¹å¼‚å¸¸æ£€æµ‹ç®—æ³•çš„æ—¶é—´æ•ˆç‡æœ‰è¦æ±‚ã€‚</li></ol><img src="https://i.loli.net/2020/06/25/o21lnTUtcGuwCq6.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h2><ul><li>å°†Visual Saliency Detectionçš„æ–¹æ³•å¼•å…¥äº†æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ã€‚</li><li>ç»“åˆSpectral Residualå’ŒCNNæé«˜äº†å¼‚å¸¸æ£€æµ‹çš„æ•ˆæœã€‚</li><li>ç®—æ³•å…·æœ‰è‰¯å¥½çš„æ—¶é—´æ•ˆç‡å’Œé€šç”¨æ€§ã€‚</li></ul><h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><h3 id="Spectral-Residual"><a href="#Spectral-Residual" class="headerlink" title="Spectral Residual"></a>Spectral Residual</h3><p>SR(Spectral Residual)ç®—æ³•ä¸»è¦åŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼š</p><ol><li>é€šè¿‡å‚…é‡Œå¶å˜æ¢å¾—åˆ°log amplitude spectrumï¼›</li><li>è®¡ç®—spectral residualï¼›</li><li>é€šè¿‡å‚…é‡Œå¶é€†å˜æ¢å›åˆ°æ—¶é—´åŸŸã€‚</li></ol><p>æ›´å½¢å¼åŒ–çš„è¡¨è¿°ä¸ºå¦‚ä¸‹ï¼š</p><p>ç»™å®šä¸€ä¸ªåºåˆ—$\mathbb{x}$ï¼Œåˆ™æœ‰ï¼š</p><p>$$A(f)=Amplitude(\mathscr{F}(\mathbb{x}))$$</p><p>$$P(f)=Phrase(\mathscr{F}(\mathbb{x}))$$</p><p>$$L(f)=\log(A(f))$$</p><p>$$AL(F)=h_1(f)\cdot L(f)$$</p><p>$$R(f)=L(f)-AL(f)$$</p><p>$$S(\mathbb{x})=\parallel\mathscr{F}^{-1}(\exp(R(f)+iP(f)))\parallel$$</p><p>å…¶ä¸­$\mathscr{F}$å’Œ$\mathscr{F}^{-1}$åˆ†åˆ«è¡¨ç¤ºå‚…é‡Œå¶å˜æ¢å’Œå‚…é‡Œå¶é€†å˜æ¢ï¼›$\mathbb{x}\in \mathbb{R}^{n\times 1}$è¡¨ç¤ºè¾“å…¥åºåˆ—ï¼›$A(f)$ä¸ºå¹…åº¦è°±ï¼Œ$P(f)$ä¸ºç›¸ä½è°±ï¼Œ$L(f)$ä¸ºå¯¹æ•°å¹…åº¦è°±ï¼Œ$AL(F)$ä¸ºå‡å€¼æ»¤æ³¢åçš„å¯¹æ•°å¹…åº¦è°±ï¼›$R(f)$ä¸ºspectral residualï¼›$S(\mathbb{x})$ç§°ä¸ºsaliency mapã€‚Figure 4ä¸ºæ–‡ä¸­ç»™å‡ºçš„Saliency Mapç¤ºæ„å›¾ã€‚</p><img src="https://i.loli.net/2020/06/25/OrSlqhBWNdyfEG9.png" srcset="/img/loading.gif" style="zoom:67%;" /><h2 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h2><h3 id="Problem-Definition"><a href="#Problem-Definition" class="headerlink" title="Problem Definition"></a>Problem Definition</h3><blockquote><p>ç»™å®šä¸€ç³»åˆ—å®æ•°å€¼$\mathbb{x}=x_1,x_2,\cdots,x_n$ï¼Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„ä»»åŠ¡æ˜¯äº§ç”Ÿä¸€ä¸ªè¾“å‡ºåºåˆ—$\mathbb{y}=y_1,y_2,\cdots,y_n$å…¶ä¸­$y_i\in{0,1}$è¡¨ç¤º$x_i$æ˜¯å¦ä¸ºå¼‚å¸¸ç‚¹ã€‚</p></blockquote><h3 id="SR"><a href="#SR" class="headerlink" title="SR"></a>SR</h3><p>å¯¹äºç»™å®šåºåˆ—$\mathbb{x}$ï¼Œè®¡ç®—Saliency Map $S(\mathbb{x})$ï¼Œè¾“å‡ºåºåˆ—$O(\mathbb{x})$å®šä¹‰ä¸ºï¼š</p><p>$$O(x_i)=\begin{cases}1,\quad \text{if}\frac{S(x_i)-\overline{S(x_i)}}{\overline{S(x_i)}}&gt;\tau\\0,\quad \text{otherwise}\end{cases}$$</p><p>å…¶ä¸­$S(x_i)$ä¸º$x_i$å¯¹åº”çš„Saliency Mapçš„å€¼ï¼Œ$\overline{S(x_i)}$ä¸º$x_i$é™„è¿‘Saliency Mapå±€éƒ¨å‡å€¼ã€‚</p><hr><p>åœ¨å®é™…æ“ä½œä¸­ï¼ŒFFTæ˜¯åœ¨ä¸€ä¸ªæ»‘åŠ¨çª—å£ä¸­è¿›è¡Œçš„ï¼Œæ–‡ä¸­æåˆ°SRæ–¹æ³•åœ¨ç‚¹ä½äºçª—å£ä¸­å¤®æ—¶æ•ˆæœæ›´å¥½ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œæµ‹è¯•çš„æ—¶å€™ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ–¹æ³•å¯¹å½“å‰ç‚¹$x_n$(ä¹Ÿå°±æ˜¯å½“å‰åºåˆ—æœ€åä¸€ä¸ªç‚¹)ä¹‹åçš„ç‚¹è¿›è¡Œé¢„æµ‹ï¼š</p><p>$$\overline{g}=\frac{1}{m}\sum_{i=1}^m g(x_n,x_{n-i})$$</p><p>$$x_{n+1}=x_{n-m+1}+\overline{g}\cdot m$$</p><p>å…¶ä¸­$g(x_i,x_j)$ä»£è¡¨$x_i$å’Œ$x_j$ä¸¤ç‚¹æ„æˆçš„ç›´çº¿çš„æ¢¯åº¦ï¼›$\overline{g}$ä»£è¡¨æ‰€å¤„ç†çš„ç‚¹çš„å¹³å‡æ¢¯åº¦ï¼›$m$ä¸ºæ‰€å¤„ç†çš„ç‚¹çš„æ•°é‡ã€‚åœ¨æœ¬æ–‡ä¸­è®¾ç½®$m=5$ã€‚æ–‡ä¸­å‘ç°ç¬¬ä¸€ä¸ªé¢„æµ‹çš„å€¼å¾ˆé‡è¦ï¼Œæ‰€ä»¥ç›´æ¥æŠŠ$x_{n+1}$èµ‹å€¼$k$æ¬¡æ·»åŠ åˆ°åºåˆ—çš„æœ«å°¾ã€‚</p><h3 id="SR-CNN"><a href="#SR-CNN" class="headerlink" title="SR-CNN"></a>SR-CNN</h3><p><img src="https://i.loli.net/2020/06/25/9pEWXRD5JM4umHn.png" srcset="/img/loading.gif" alt=""></p><p>æœ¬æ–‡æåˆ°ï¼Œä»…ä»…ä½¿ç”¨ä¸€ä¸ªé˜ˆå€¼æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­å¤ªè¿‡ç®€å•ï¼Œäºæ˜¯æå‡ºä½¿ç”¨ä¸€ä¸ªåˆ¤åˆ«æ¨¡å‹æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­ã€‚ç”±äºè®­ç»ƒæ•°æ®æ²¡æœ‰æ ‡ç­¾ï¼Œæ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å…¬å¼äººå·¥åŠ å…¥å¼‚å¸¸ï¼š</p><p>$$x=(\overline{x}+mean)(1+var)\cdot r+x$$</p><p>å…¶ä¸­$\overline{x}$æ‰€å¤„ç†çš„ç‚¹çš„å±€éƒ¨å‡å€¼ï¼›$mean$å’Œ$var$ä¸ºå½“å‰æ»‘åŠ¨çª—å£ç‚¹çš„å‡å€¼å’Œæ–¹å·®ï¼›$r\sim \mathcal{N}(0,1)$ä¸ºæœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å™ªå£°ã€‚</p><hr><p>å¯¹äºåˆ¤åˆ«æ¨¡å‹ä½¿ç”¨çš„æ˜¯CNNï¼Œä¸»è¦åŒ…å«ä¸¤ä¸ª1ç»´å·ç§¯å±‚(kernel sizeç­‰äºçª—å£å¤§å°$w$)å’Œä¸¤ä¸ªå…¨è¿æ¥å±‚ã€‚ä¸¤ä¸ªå·ç§¯å±‚çš„channel sizeåˆ†åˆ«ä¸º$w$å’Œ$2w$ã€‚</p><h2 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h2><h3 id="Datasets"><a href="#Datasets" class="headerlink" title="Datasets"></a>Datasets</h3><img src="https://i.loli.net/2020/06/25/dquAjtRpNSY8rLo.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>æ‰€ç”¨æ•°æ®é›†åŒ…å«æ¸…åAIOpsç«èµ›æ•°æ®ã€Yahooå’ŒMicrosoftçš„KPIæ•°æ®ã€‚</p><h3 id="Evaluation-Metrics"><a href="#Evaluation-Metrics" class="headerlink" title="Evaluation Metrics"></a>Evaluation Metrics</h3><p>ç®—æ³•å‡†ç¡®ç‡æ–¹é¢ç”¨äº†precisionï¼Œrecallå’Œ$F_1$-scoreã€‚</p><img src="https://i.loli.net/2020/06/25/EbcjA8X5fYa6Glz.png" srcset="/img/loading.gif" style="zoom:67%;" /><p>ç”±äºåœ¨å®é™…åœºæ™¯ä¸­KPIçš„å¼‚å¸¸å¾€å¾€æ˜¯ä»¥ä¸€æ®µä¸€æ®µçš„å½¢å¼å‡ºç°ï¼Œä¸”å¹¶ä¸è¦æ±‚æŸä¸€ä¸ªæ—¶é—´ç‚¹å‡ºç°å¼‚å¸¸ç®—æ³•å°±é©¬ä¸Šæ£€æµ‹å‡ºæ¥ï¼Œåªè¦æ£€æµ‹å‡ºæ¥çš„æ—¶é—´åœ¨ä¸€å®šçš„å®¹å¿èŒƒå›´å†…å³å¯ã€‚æœ¬æ–‡ä½¿ç”¨äº†ä¸€äº›è°ƒæ•´çš„æ‰‹æ®µï¼Œå¦‚Figure 6ã€‚å¯¹äºæŸä¸€æ®µå¼‚å¸¸ï¼Œè®¾æ®µé¦–çš„å¼‚å¸¸ä½äºæ—¶é—´ç‚¹$t_{truth}$ï¼Œé¢„æµ‹ä¸ºå¼‚å¸¸çš„ç»“æœä¸­æ—¶é—´åœ¨$t_{truth}$ä¹‹åä¸”è·$t_{truth}$æœ€è¿‘çš„æ—¶é—´ç‚¹è®¾ä¸º$t_{predict}$ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªé¢„å…ˆè®¾å®šçš„å®¹å¿èŒƒå›´$k$ï¼Œåªè¦$t_{predict}-t_{truth}\leq k+1$é‚£ä¹ˆåœ¨é¢„æµ‹ç»“æœä¸­æ•´æ®µå¼‚å¸¸å°±ä¼šé‡ç½®ä¸º$1$ï¼Œå¦åˆ™å…¨éƒ¨é‡ç½®ä¸º$0$ã€‚</p><h3 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h3><p>å®éªŒéƒ¨åˆ†ä½¿ç”¨äº†ä¸¤ç§è®­ç»ƒæ–¹å¼ï¼Œä¸€ç§æ˜¯cold-startï¼Œå³æŠŠæ‰€æœ‰æ•°æ®éƒ½ç”¨æ¥æµ‹è¯•ï¼Œå¦ä¸€ç§æ˜¯æŠŠæ•°æ®åˆ†ä¸ºè®­ç»ƒæµ‹è¯•ä¸¤éƒ¨åˆ†ï¼Œåœ¨è®­ç»ƒé›†ä¸Šè®­ç»ƒï¼Œæœ€ååœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œæµ‹è¯•ã€‚ä¸¤ç§æ–¹æ³•é€‚ç”¨çš„baselineä¸åŒï¼Œæœ€åç»“æœå¦‚Table 2å’ŒTable 3æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/3L9xe5jJGtnR6AQ.png" srcset="/img/loading.gif" style="zoom: 50%;" /><hr><p>åœ¨SRçš„å‚æ•°è®¾ç½®ä¸Šï¼Œ$h_q(f)$ä¸­çš„$q$ä¸º3ï¼Œå±€éƒ¨å¹³å‡æ‰€ç”¨çš„ç‚¹æ•°ç›®$z$ä¸º21ï¼Œé˜ˆå€¼$\tau$ä¸º3ï¼Œä¼°è®¡ç‚¹çš„æ•°é‡$k$ä¸º5ï¼Œæ»‘åŠ¨çª—å£çš„å¤§å°$w$åœ¨KPIã€Yahooã€Microsoftä¸‰ä¸ªæ•°æ®é›†ä¸Šåˆ†åˆ«ä¸º1440ã€64å’Œ30ã€‚SR-CNNçš„$q$ï¼Œ$z$ï¼Œ$k$ï¼Œ$w$è®¾ç½®ä¸SRç›¸åŒã€‚</p><h3 id="Additional-Experiments-with-DNN"><a href="#Additional-Experiments-with-DNN" class="headerlink" title="Additional Experiments with DNN"></a>Additional Experiments with DNN</h3><p>æ–‡ä¸­è¿˜å¯¹æœ‰ç›‘ç£çš„æƒ…å†µè¿›è¡Œäº†æµ‹è¯•ï¼Œå…·ä½“åšæ³•æ˜¯ä»æ—¶é—´åºåˆ—æå–ç‰¹å¾ï¼Œç„¶åå°†Saliency Mapä¹Ÿä½œä¸ºç‰¹å¾å¼•å…¥ï¼Œæ„é€ ä¸€ä¸ªæœ‰ç›‘ç£çš„Neural Networkè¿›è¡Œæµ‹è¯•ã€‚</p><p>æå–çš„ç‰¹å¾å¦‚Table 5æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/4flipKbc1OtVGg9.png" srcset="/img/loading.gif" style="zoom: 50%;" /><hr><p>ç¥ç»ç½‘ç»œçš„ç»“æ„ä¸ºä¸¤å±‚å…¨è¿æ¥å±‚ï¼Œå¹¶æ·»åŠ äº†Dropout Ratioä¸º0.5çš„Dropout Layerã€‚ä¸¤ä¸ªLayerä½¿ç”¨äº†$L_1=L_2=0.0001$çš„æ­£åˆ™åŒ–ã€‚åŒæ—¶ä¸ºäº†å¤„ç†æ ·æœ¬ä¸å¹³è¡¡çš„æƒ…å†µä½¿ç”¨äº†è¿‡é‡‡æ ·æ¥ä½¿æ­£è´Ÿæ ·æœ¬çš„æ¯”ä¾‹ä¸º$1:2$ã€‚ç»“æ„å¦‚Figure 7æ‰€ç¤ºï¼š</p><img src="https://i.loli.net/2020/06/25/bxeluFBHv2i7Y5m.png" srcset="/img/loading.gif" style="zoom:67%;" /><hr><p>è®­ç»ƒæµ‹è¯•é›†çš„æƒ…å†µå¦‚Table 6æ‰€ç¤ºï¼Œæœ€ç»ˆç»“æœå¦‚Table 7æ‰€ç¤ºï¼ŒP-Ræ›²çº¿å¦‚Figure 8æ‰€ç¤ºã€‚å¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†SRç‰¹å¾çš„DNNæ•ˆæœç”±äºæ²¡æœ‰ä½¿ç”¨SRç‰¹å¾çš„DNNã€‚</p><img src="https://i.loli.net/2020/06/25/E6vapzhCiG9HTPu.png" srcset="/img/loading.gif" style="zoom:67%;" /><img src="https://i.loli.net/2020/06/25/tZAOg74flmE39oI.png" srcset="/img/loading.gif" style="zoom:67%;" />]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
      <category>Anomaly Detection</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Time Series</tag>
      
      <tag>Anomaly Detection</tag>
      
      <tag>Machine Learning</tag>
      
      <tag>Deep Learning</tag>
      
      <tag>Spectral</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
