<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection - Hanzawa の 部屋</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hanzawa の 部屋"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hanzawa の 部屋"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Introduction 本文针对面向区间的KPI异常检测提出了Label Screening方法和Relearning Algorithm. 原文 Contribution  提出了一种Label Screening方法来对区间内不同重要性进行过滤 提出了一种Relearning Algorithm来对FP和TP进行Relearning，在不减少Recall的条件下增大Precisi"><meta property="og:type" content="article"><meta property="og:title" content="ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection"><meta property="og:url" content="http://hanzawa.me/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/"><meta property="og:site_name" content="Hanzawa の 部屋"><meta property="og:description" content="Introduction 本文针对面向区间的KPI异常检测提出了Label Screening方法和Relearning Algorithm. 原文 Contribution  提出了一种Label Screening方法来对区间内不同重要性进行过滤 提出了一种Relearning Algorithm来对FP和TP进行Relearning，在不减少Recall的条件下增大Precisi"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://i.loli.net/2020/06/24/yGMWzdgTf43qImp.png"><meta property="og:image" content="https://i.loli.net/2020/06/24/ZDT5fQNojsXm84q.png"><meta property="og:image" content="https://i.loli.net/2020/06/24/qgvINaFu9JLfM4j.png"><meta property="og:image" content="https://i.loli.net/2020/06/24/LBT59eugKEPymO8.png"><meta property="og:image" content="https://i.loli.net/2020/06/24/LAqNMW1zvs8eP7X.png"><meta property="og:image" content="https://i.loli.net/2020/06/24/YgRwavDIn7izLPX.png"><meta property="og:image" content="https://i.loli.net/2020/06/24/FM3BUhQXtpo7aiu.png"><meta property="article:published_time" content="2019-09-22T14:29:18.000Z"><meta property="article:modified_time" content="2020-06-24T07:48:38.792Z"><meta property="article:author" content="Hanzawa"><meta property="article:tag" content="Time Series"><meta property="article:tag" content="Anomaly Detection"><meta property="article:tag" content="Machine Learning"><meta property="article:tag" content="Deep Learning"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://i.loli.net/2020/06/24/yGMWzdgTf43qImp.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://hanzawa.me/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/"},"headline":"ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection","image":["https://i.loli.net/2020/06/24/yGMWzdgTf43qImp.png","https://i.loli.net/2020/06/24/ZDT5fQNojsXm84q.png","https://i.loli.net/2020/06/24/qgvINaFu9JLfM4j.png","https://i.loli.net/2020/06/24/LBT59eugKEPymO8.png","https://i.loli.net/2020/06/24/LAqNMW1zvs8eP7X.png","https://i.loli.net/2020/06/24/YgRwavDIn7izLPX.png","https://i.loli.net/2020/06/24/FM3BUhQXtpo7aiu.png"],"datePublished":"2019-09-22T14:29:18.000Z","dateModified":"2020-06-24T07:48:38.792Z","author":{"@type":"Person","name":"Hanzawa"},"publisher":{"@type":"Organization","name":"Hanzawa の 部屋","logo":{"@type":"ImageObject"}},"description":"Introduction\r 本文针对面向区间的KPI异常检测提出了Label Screening方法和Relearning Algorithm.\r 原文\r Contribution\r \r 提出了一种Label Screening方法来对区间内不同重要性进行过滤\r 提出了一种Relearning Algorithm来对FP和TP进行Relearning，在不减少Recall的条件下增大Precisi"}</script><link rel="canonical" href="http://hanzawa.me/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Hanzawa の 部屋" type="application/atom+xml">
</head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Hanzawa の 部屋</a></div><div class="navbar-menu"><div class="navbar-end"></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-09-22T14:29:18.000Z" title="2019-9-22 10:29:18 ├F10: PM┤">2019-09-22</time>发表</span><span class="level-item"><time dateTime="2020-06-24T07:48:38.792Z" title="2020-6-24 3:48:38 ├F10: PM┤">2020-06-24</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span> / </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span></div></div><h1 class="title is-3 is-size-4-mobile">ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection</h1><div class="content"><h1 id="introduction">Introduction</h1>
<p>本文针对面向区间的KPI异常检测提出了Label Screening方法和Relearning Algorithm.</p>
<p><a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0957417419304282">原文</a></p>
<h2 id="contribution">Contribution</h2>
<ol type="1">
<li>提出了一种Label Screening方法来对区间内不同重要性进行过滤</li>
<li>提出了一种Relearning Algorithm来对FP和TP进行Relearning，在不减少Recall的条件下增大Precision</li>
</ol>
<h2 id="methodology">Methodology</h2>
<h3 id="overall-structure">Overall Structure</h3>
<p>算法的整体框架如下：</p>
<p><img src="https://i.loli.net/2020/06/24/yGMWzdgTf43qImp.png" /></p>
<h3 id="label-screening-model">Label Screening Model</h3>
<p>预训练的结果被分为<span class="math inline">\(TP_{po},FP_{po},TN_{po},FN_{po}\)</span>四类，<span class="math inline">\(TP_{po}\)</span>和<span class="math inline">\(FN_{po}\)</span>可以被细分如下： <span class="math display">\[
\begin{align}TP_{po}&amp;=TP_{po,withinT}+TP_{po,afterT}\\&amp;=TP_{po,withinT}+TP_{po,afterT,tpl}+TP_{po,after,fnl}\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}FN_{po}&amp;=FN_{po,withinT}+FN_{po,afterT}\\&amp;=FN_{po,withinT,tpl}+FN_{po,,withinT,fnl}+FN_{po,afterT,tpl}+FN_{po,afterT,fnl}\end{align}
\]</span></p>
<p>其中下标<span class="math inline">\({}_{withinT}\)</span>代表在异常片段第一个点<span class="math inline">\(T\)</span>距离内的所有点，下标<span class="math inline">\({}_{afterT}\)</span>代表<span class="math inline">\(T\)</span>距离之后。下标<span class="math inline">\({}_{tpl}\)</span>和<span class="math inline">\({}_{fnl}\)</span>分别代表在异常片段中，包含和不包含<span class="math inline">\(TP_{po,withinT}\)</span>的点。</p>
<p>以TP为例，Point-based的TP包含了在T范围之内的（即在Interval-based的标准中也会被认为是TP的点）和T范围之外的点（即在Interval-based的标准中不认为是TP的点）。而在T范围之外的点又可以细分为该异常片段是否包含<span class="math inline">\(TP_{po,withinT}\)</span>的点（即该点在Interval-based的标准中不会被判定为TP，但该异常片段有其点会被判定为TP）。</p>
<p>类似的，<span class="math inline">\(TP_{io}\)</span>和<span class="math inline">\(FN_{io}\)</span>可以被分解为： <span class="math display">\[
\begin{align}TP_{io}&amp;=TP_{po,withinT}+TP_{po,afterT,tpl}+FN_{po,withinT,tpl}+FN_{po,afterT,tpl}\\&amp;=TP_{po}+FN_{po,withinT,tpl}+FN_{po,afterT,tpl}-TP_{po,afterT,fnl}\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}FN_{io}&amp;=FN_{po,withinT,fnl}+FN_{po,afterT,fnl}+TP_{po,afterT,fnl}\\&amp;=FN_{po}+TP_{po,afterT,fnl}-FN_{po,withinT,tpl}-FN_{po,afterT,tpl}\end{align}
\]</span></p>
<p>文中对该部分的分析可以分为以下几点：</p>
<ol type="1">
<li>在Interval-oriented的标准中，<span class="math inline">\(FN_{po,tpl}\)</span>的点仍会被认为是<span class="math inline">\(TP_{io}\)</span>，而<span class="math inline">\(TP_{po,afterT}\)</span>（不带<span class="math inline">\({}_{tpl}\)</span>）不会被认为是<span class="math inline">\(TP_{io}\)</span>，所以最终<span class="math inline">\(TP_{io}\)</span>由所有<span class="math inline">\(TP_{po}\)</span>加上那些会被认为是<span class="math inline">\(TP_{io}\)</span>的<span class="math inline">\(FN_{po,tpl}\)</span>再去掉不带<span class="math inline">\({}_{tpl}\)</span>的<span class="math inline">\(TP_{po,afterT}\)</span>组成，即公式(6)</li>
<li>同时，根据公式(6)，如果<span class="math inline">\(TP_{po}\)</span>变为<span class="math inline">\(FN_{po,tpl}\)</span>，也不会对最终结果造成影响。但是根据公式(5)和公式(7)，<span class="math inline">\(TP_{po,withinT}\)</span>变成<span class="math inline">\(FN_{po,withinT,fnl}\)</span>会减小<span class="math inline">\(TP_{io}\)</span>同时增大<span class="math inline">\(FN_{io}\)</span></li>
<li>文章指出，虽然<span class="math inline">\(FN_{po,withinT,tpl}\)</span>和<span class="math inline">\(FN_{po,afterT,tpl}\)</span>最后都会被认为是<span class="math inline">\(TP_{io}\)</span>，但作者假设<span class="math inline">\(FN_{po,withinT,tpl}\)</span>更难检测，所以应该保留，而<span class="math inline">\(FN_{po,afterT,tpl}\)</span>应该削减</li>
<li>Label Screening方法去除了<span class="math inline">\(FN_{po,afterT}\)</span>的点</li>
<li>Screened之后的训练集被用来训练DNN主模型，但Label Screening的预测结果也会被保留，和DNN主模型的结果进行组合</li>
</ol>
<p>算法流程如下：</p>
<p><img src="https://i.loli.net/2020/06/24/ZDT5fQNojsXm84q.png" /></p>
<h3 id="relearning-algorithm">Relearning Algorithm</h3>
<p>Relearning Model的输入是DNN主模型预测出来的异常，其中包括TP和FP。Relearning Model采用的是随机森林，其输入的样本通过采样得到： <span class="math display">\[
\begin{align}
\text{relearning}\space&amp;\text{training set}=\\&amp; shuffle\{4C\ast\text{randomof}(TP_{po})\\&amp;+C\cdot\text{randomof}(FP_{po})+C\cdot\text{randomof}(TN_{po})\}
\end{align}
\]</span> 其中<span class="math inline">\(C\)</span>为常数。TN和FP都看作是负例(正常样本)，TP看作是正例。</p>
<p><img src="https://i.loli.net/2020/06/24/qgvINaFu9JLfM4j.png" /></p>
<h3 id="detection">Detection</h3>
<p>对于一个滑动窗口<span class="math inline">\(x_t=\{x_{t-w+1},\cdots,x_t\}\)</span>，异常检测算法的目标是输出检测结果<span class="math inline">\(y_t\in\{0,1\}\)</span>来表示时间<span class="math inline">\(t\)</span>是否发生异常。实际上算法输出的是<span class="math inline">\(p_{y_t}\in[0,1]\)</span>概率值来表示在时间<span class="math inline">\(t\)</span>发生异常的概率。文中三个模型会得到三个输出：<span class="math inline">\(y_{t,ls},y_{t,main},y_{t,re}\)</span>。最终结果为： <span class="math display">\[
y_t=y_{t,ls}\space\&amp;\space y_{t,main}\space\&amp; \space y_{t,re}
\]</span> 在绘制PR曲线时，采用的公式为： <span class="math display">\[
\begin{align}
p_{y_t}(th)=&amp;(1-sig(p_{y_t,ls},th))\cdot(p_{y_t,ls})\\
&amp;+sig(p_{y_t,ls},th)\cdot(1-sig(p_{y_t,main},th))\cdot p_{y_t,main}\\
&amp;+sig(p_{y_t,ls},th)\cdot sig(p_{y_t,main},th)\cdot p_{y_t,re}\\
\end{align}
\]</span></p>
<p><span class="math display">\[
y_t(th)=sig(p_{y_t}(th),th)
\]</span></p>
<p>算法流程如下：</p>
<p><img src="https://i.loli.net/2020/06/24/LBT59eugKEPymO8.png" /></p>
<h2 id="experiments">Experiments</h2>
<h3 id="datasets">Datasets</h3>
<p>清华AIOps数据集，选取了25条KPI。</p>
<h3 id="preprocessing">Preprocessing</h3>
<ol type="1">
<li><strong>Missing Data.</strong> 去除。</li>
<li><strong>Standardization.</strong> Minmax Standardization，Feature Extraction使用的是Standardization后的数据。</li>
<li><strong>Feature Extraction.</strong> 使用了12种特征。</li>
</ol>
<table>
<thead>
<tr class="header">
<th>Group</th>
<th>Feature Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Values</td>
<td>The original values standardized</td>
</tr>
<tr class="even">
<td>Statistical Features</td>
<td>Mean, Standard Deviation, Range, Difference...</td>
</tr>
<tr class="odd">
<td>Fitting Features</td>
<td>EWMA, AR</td>
</tr>
<tr class="even">
<td>Wavelet Features</td>
<td>Db2 wavelet decomposition</td>
</tr>
</tbody>
</table>
<h2 id="results">Results</h2>
<h3 id="aucpr">AUCPR</h3>
<p><img src="https://i.loli.net/2020/06/24/LAqNMW1zvs8eP7X.png" /></p>
<p><img src="https://i.loli.net/2020/06/24/YgRwavDIn7izLPX.png" /></p>
<h3 id="f1">F1</h3>
<p><img src="https://i.loli.net/2020/06/24/FM3BUhQXtpo7aiu.png" /></p>
<h2 id="remark">Remark</h2>
<ol type="1">
<li>这篇文章的Label Screening方法实际上是在处理样本分类难易度的问题，将异常区间内容易的样本去除了</li>
<li>对于时间序列的异常检测问题，我们的目标一般是Point-based的异常标签，一个时间点的特征是有限的。如果用窗口的方式，以<span class="math inline">\(\{x_{t-w+1},\cdots,x_t\}\)</span>作为时间<span class="math inline">\(t\)</span>的输入（当然每个<span class="math inline">\(x_t\)</span>可以有多个Channel），然后把预测结果作为时间<span class="math inline">\(t\)</span>的输出</li>
</ol>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Time-Series/">Time Series</a><a class="link-muted mr-2" rel="tag" href="/tags/Anomaly-Detection/">Anomaly Detection</a><a class="link-muted mr-2" rel="tag" href="/tags/Machine-Learning/">Machine Learning</a><a class="link-muted mr-2" rel="tag" href="/tags/Deep-Learning/">Deep Learning</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Anomaly Detection with Generative Adversarial Networks for Multivariate Time Series</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/"><span class="level-item">Unsupervised Anomaly Detection via Variational Auto-Encoder for Seasonal KPIs in Web Applications</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Hanzawa の 部屋</a><p class="is-size-7"><span>&copy; 2021 Hanzawa</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/main.js" defer></script><!--!--></body></html>