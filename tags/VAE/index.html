<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>æ ‡ç­¾: VAE - Hanzawa ã® éƒ¨å±‹</title><meta property="og:type" content="blog"><meta property="og:title" content="Hanzawa ã® éƒ¨å±‹"><meta property="og:url" content="http://qfxiao.me/"><meta property="og:site_name" content="Hanzawa ã® éƒ¨å±‹"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="Hanzawa"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="http://qfxiao.me/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://qfxiao.me"},"headline":"Hanzawa ã® éƒ¨å±‹","image":["http://qfxiao.me/img/og_image.png"],"author":{"@type":"Person","name":"Hanzawa"},"description":null}</script><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hanzawa ã® éƒ¨å±‹" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">æ ‡ç­¾</a></li><li class="is-active"><a href="#" aria-current="page">VAE</a></li></ul></nav></div></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/"><img class="thumbnail" src="http://qfxiao.me/img/image-20200109102204802.png" alt="Complementary Set Variational Autoencoder for Supervised Anomaly Detection"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-01-09T02:15:03.000Z" title="2020-01-09T02:15:03.000Z">2020-01-09</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">10 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1470 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/">Complementary Set Variational Autoencoder for Supervised Anomaly Detection</a></h1><div class="content"><h1 id="introduction">Introduction</h1>
<p>å¯¹äºå¼‚å¸¸æ£€æµ‹é—®é¢˜ï¼Œå¼‚å¸¸çš„æ¨¡å¼æ˜¯å¤šç§å¤šæ ·çš„ã€‚æœ‰ç›‘ç£æ¨¡å‹èƒ½å¤Ÿè¾ƒå¥½åœ°å¤„ç†è®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„æ¨¡å¼ï¼Œæ— ç›‘ç£æ¨¡å‹èƒ½å¤Ÿå¤„ç†è®­ç»ƒé›†ä¸­æœªå‡ºç°è¿‡çš„æ¨¡å¼ï¼Œä½†å¯¹äºè®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å‹å¹¶æ²¡æœ‰å­¦ä¹ ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§æ—¢èƒ½å­¦ä¹ è®­ç»ƒé›†ä¸­å‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å¼ï¼ŒåŒæ—¶èƒ½å¤„ç†æœªå‡ºç°è¿‡çš„å¼‚å¸¸æ¨¡å¼çš„æ–¹æ³•ã€‚</p>
<h1 id="proposed-model">Proposed Model</h1>
<h2 id="conventional-vae">Conventional VAE</h2>
<p>é¦–å…ˆå›é¡¾ä¸€ä¸‹åŸå§‹çš„VAEã€‚</p>
<p>åŸå§‹VAEä¸­çš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[
\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})=\mathbb{E}_{q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})}[\log p(\boldsymbol{x}|\boldsymbol{z};\boldsymbol{\theta})]-\text{KL}[q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi}\parallel p(\boldsymbol{z}))]
\]</span> åŸæ–‡ä¸­ä½œè€…è¯æ˜äº†<span class="math inline">\(\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\leq\log p(\boldsymbol{x};\boldsymbol{\theta})\)</span>ï¼Œæ‰€ä»¥<span class="math inline">\(\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\)</span>å¯ä»¥çœ‹ä½œæ˜¯æ•°æ®åˆ†å¸ƒ<span class="math inline">\(p(\boldsymbol{x})\)</span>å¯¹æ•°ä¼¼ç„¶çš„ä¸€ä¸ªä¸‹ç•Œã€‚<span class="math inline">\(\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\)</span>åˆè¢«ç§°ä¸ºè¯æ®ä¸‹ç•Œ (ELBO)ã€‚<span class="math inline">\(\mathbb{E}_{q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})}[\log p(\boldsymbol{x}|\boldsymbol{z};\boldsymbol{\theta})]\)</span>ä¸­çš„æœŸæœ›ä¸€èˆ¬ç”¨è’™ç‰¹å¡æ´›æ¥è¿›è¡Œä¼°è®¡ï¼š <span class="math display">\[
\begin{align}
\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\simeq&amp; \frac{1}{L}\sum\limits_l\log p(\boldsymbol{x}|\boldsymbol{z}^{(l)};\boldsymbol{\theta})-\text{KL}[q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi})\parallel p(\boldsymbol{z})],\\
\boldsymbol{z}^{(l)}&amp;\sim q(\boldsymbol{z}|\boldsymbol{x};\boldsymbol{\phi}), \space l\in\{1,2,\cdots,L\}
\end{align}
\]</span> å¯¹äºéšå˜é‡<span class="math inline">\(\boldsymbol{z}\)</span>ï¼Œä¸€èˆ¬å‡è®¾å…ˆéªŒæœä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼ŒåéªŒæœä»å‡å€¼ä¸º<span class="math inline">\(\mu\)</span>ï¼Œæ–¹å·®ä¸º<span class="math inline">\(\sigma^2\)</span>çš„é«˜æ–¯åˆ†å¸ƒï¼Œæ•…KLæ•£åº¦èƒ½ç›´æ¥å†™å‡ºè§£æå¼ï¼š <span class="math display">\[
\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x})\simeq \frac{1}{L}\sum\limits_l\log p(\boldsymbol{x}|\boldsymbol{z}^{(l)};\boldsymbol{\theta})-C(-\frac{1}{2}-\log\sigma+\frac{1}{2}\sigma^2+\frac{1}{2}\mu^2)
\]</span> ä½¿ç”¨VAEæ¥åšå¼‚å¸¸æ£€æµ‹é€šå¸¸æ˜¯åœ¨æ­£å¸¸æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼Œåœ¨æ£€æµ‹é˜¶æ®µï¼Œå¦‚æœæ˜¯å¼‚å¸¸æ ·æœ¬ï¼Œé‚£ä¹ˆVAEä¸èƒ½å¾ˆå¥½åœ°é‡æ„å®ƒï¼Œè¿™æ ·ä¼šå¯¼è‡´è¾ƒå¤§çš„é‡æ„è¯¯å·®ã€‚</p>
<h2 id="prior-distribution-for-anomalies">Prior Distribution for Anomalies</h2>
<p><img src="http://qfxiao.me/img/image-20200109102204802.png" /></p>
<p>åœ¨åŸå§‹VAEå¼‚å¸¸æ£€æµ‹ä¸­ï¼Œæ— è®ºè¾“å…¥æ ·æœ¬<span class="math inline">\(\boldsymbol{x}\)</span>æ˜¯å¦å¼‚å¸¸ï¼ŒVAEéƒ½ä¼šä½¿å¯¹åº”ç¼–ç çš„åéªŒ<span class="math inline">\(p(\boldsymbol{z}|\boldsymbol{x})\)</span>æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸”æ–½åŠ æ ‡å‡†é«˜æ–¯åˆ†å¸ƒçš„çº¦æŸã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œä½œè€…å¯¹å¼‚å¸¸å’Œæ­£å¸¸æ ·æœ¬å¯¹åº”çš„éšå˜é‡çš„å…ˆéªŒåˆ†å¸ƒåšäº†ä¸åŒå‡è®¾ã€‚é¦–å…ˆï¼Œæ­£å¸¸å…ˆéªŒä¾ç„¶æ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼Œè®°ä¸º<span class="math inline">\(p_n(\boldsymbol{z})\)</span>ã€‚è€Œå¯¹äºå¼‚å¸¸å…ˆéªŒï¼Œä½œè€…è®¤ä¸ºå¼‚å¸¸å³ä¸ºâ€œä¸æ­£å¸¸â€ï¼Œå’Œæ­£å¸¸æ˜¯è¡¥é›†çš„å…³ç³»ã€‚ä½œè€…åœ¨æ–‡ä¸­å®šä¹‰å¼‚å¸¸å…ˆéªŒåˆ†å¸ƒ<span class="math inline">\(p_a(\boldsymbol{z})\)</span>ä¸ºï¼š <span class="math display">\[
p_a(\boldsymbol{z})=\frac{1}{Y^\prime}(\max\limits_{\boldsymbol{z}^\prime}p_n(\boldsymbol{z}^\prime)-p_n(\boldsymbol{z}))
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(Y^\prime\)</span>ä¸ºä½¿<span class="math inline">\(p_a(\boldsymbol{z})\)</span>æˆä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„è°ƒèŠ‚å› å­ã€‚å®é™…ä¸Šï¼Œ<span class="math inline">\(Y^\prime\)</span>å¾€å¾€ä¼šæˆä¸ºæ— é™å¤§ï¼Œå› ä¸º<span class="math inline">\(p(\boldsymbol z)\)</span>åœ¨æ•´ä¸ªå®šä¹‰åŸŸä¸Šéƒ½æœ‰å®šä¹‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…åŠ å…¥äº†<span class="math inline">\(p_w(\boldsymbol z)\)</span>ï¼Œä¸€ä¸ªåœ¨æ¯ä¸ªç»´åº¦éƒ½è¶³å¤Ÿå®½çš„è¾…åŠ©åˆ†å¸ƒï¼š</p>
<p><span class="math display">\[
p_a(\boldsymbol z)=\frac{1}{Y}p_w(\boldsymbol z)\left(\max\limits_{\boldsymbol z^\prime}p_n(\boldsymbol z^\prime)-p_n(\boldsymbol z)\right)
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(Y\)</span>ä¸ºæœ‰é™çš„å¸¸æ•°ã€‚åœ¨æ–‡ä¸­<span class="math inline">\(p_n(\boldsymbol z)\)</span>å’Œ<span class="math inline">\(p_w(\boldsymbol z)\)</span>éƒ½ä¸ºé«˜æ–¯åˆ†å¸ƒï¼Œé‚£ä¹ˆ<span class="math inline">\(p_a(\boldsymbol z)\)</span>çš„å…·ä½“å½¢å¼ä¸ºï¼š</p>
<p><span class="math display">\[
p_a(\boldsymbol z)=\frac{1}{Y}\mathcal{N}(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2)\{\max\limits_{\boldsymbol z^\prime}\mathcal N(\boldsymbol z^\prime;\boldsymbol 0,\boldsymbol 1)-\mathcal N(\boldsymbol z;\boldsymbol 0,\boldsymbol 1)\}
\]</span></p>
<p>å…¶ä¸­ï¼š</p>
<p><span class="math display">\[
\max\limits_{\boldsymbol z^\prime}\mathcal N(\boldsymbol z^\prime;\boldsymbol 0,\boldsymbol 1)=\frac{1}{\sqrt{2\pi}}
\]</span></p>
<p><span class="math display">\[
Y=\int_{-\infty}^{\infty}p_a(\boldsymbol z)\mathrm{d}\boldsymbol z=\frac{1}{\sqrt{2\pi}}\left\{1-\frac{1}{\boldsymbol s^2+1}\right\}
\]</span></p>
<p><span class="math inline">\(\boldsymbol s^2\)</span>ä¸ºè¶…å‚æ•°ï¼Œæ§åˆ¶åˆ†å¸ƒçš„å®½åº¦ã€‚ç”¨æ–‡ä¸­çš„å…ˆéªŒæ›¿æ¢VAEåŸå§‹çš„KLæ•£åº¦ï¼Œå¯å†™ä¸ºï¼š</p>
<p><span class="math display">\[
\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]=\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\frac{\mathcal N(\boldsymbol z;\boldsymbol\mu,\boldsymbol\sigma^2)}{\frac{1}{Y}\mathcal N(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2)\left\{\frac{1}{2\pi}-\mathcal N(\boldsymbol z;\boldsymbol0,\boldsymbol 1)\right\}}\mathrm{d}\boldsymbol z
\]</span></p>
<p>å±•å¼€åï¼š</p>
<p><span class="math display">\[
\begin{align}
\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]&amp;=
\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\mathcal{N}(\boldsymbol z;\boldsymbol\mu,\boldsymbol\sigma^2)\mathrm{d}\boldsymbol z\\
&amp;+\log Y\\
&amp;-\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\mathcal{N}(\boldsymbol z;\boldsymbol 0,\boldsymbol s^2)\mathrm{d}\boldsymbol z\\
&amp;-\int_{-\infty}^\infty\mathcal{N}(\boldsymbol z;\boldsymbol \mu,\boldsymbol \sigma^2)\log\left\{\frac{1}{\sqrt{2\pi}}-\mathcal{N}(\boldsymbol z;\boldsymbol 0, \boldsymbol 1)\right\}\mathrm{d}\boldsymbol z
\end{align}
\]</span></p>
<p>ä½¿ç”¨æ³°å‹’å±•å¼€ï¼Œ<span class="math inline">\(\log (x+\frac{1}{2\pi})\simeq-\log 2\pi+2\pi x\)</span>ï¼ŒKLæ•£åº¦å¯ä»¥ç”¨ä¸‹å¼ä¼°è®¡ï¼š</p>
<p><span class="math display">\[
\begin{align}
\text{KL}\left[q(\boldsymbol z|\boldsymbol x;\phi)\parallel p_a(\boldsymbol z)\right]&amp;\simeq\sqrt{\frac{2\pi}{\boldsymbol\sigma^2+1}}\exp\left(\frac{-\boldsymbol\mu^2}{2(\boldsymbol\sigma^2+1)}\right)\\
&amp;+\frac{\boldsymbol\mu^2+\boldsymbol\sigma^2}{2\boldsymbol s^2}-\log\boldsymbol\sigma+\log\boldsymbol s+\log\left(\sqrt{\boldsymbol s^2+1}-1\right)\\
&amp;-\frac{\log(\boldsymbol s^2+1)}{2}+\frac{\log(2\pi)-1}{2}
\end{align}
\]</span></p>
<p>ä¸‹å›¾ä¸ºä¸€ç»´æ—¶<span class="math inline">\(p_n(\boldsymbol z)\)</span>å’Œ<span class="math inline">\(p_a(\boldsymbol z)\)</span>çš„ç¤ºä¾‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200109102255322.png" /></p>
<h3 id="implementation-of-proposed-method">Implementation of proposed method</h3>
<p>æ–‡ä¸­ä½¿ç”¨ç¼–ç å™¨è¾“å‡ºçš„åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(\boldsymbol z;\boldsymbol \mu, \boldsymbol \sigma^2)\)</span>ä¸æ ‡å‡†æ­£æ€åˆ†å¸ƒä¹‹é—´çš„KLæ•£åº¦æ¥ä½œä¸ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨æ¯ä¸€è½®çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒåŠ å…¥ä¸€è½®ä½¿ç”¨Anomaly Priorçš„è®­ç»ƒã€‚</p>
<p><img src="http://qfxiao.me/img/image-20200109102309048.png" /></p>
<h1 id="experiments">Experiments</h1>
<h2 id="mnist">MNIST</h2>
<p>ä½œè€…è®¾è®¡äº†ä¸¤ä¸ªTaskï¼š</p>
<ol type="1">
<li>Task 1. <span class="math inline">\(N\)</span> vs. <span class="math inline">\(\bar{N}\)</span>. å°†æ‰‹å†™æ•°å­—ä¸­çš„ä¸€ä¸ªä½œä¸ºå·²çŸ¥å¼‚å¸¸ï¼Œå…¶ä»–ä½œä¸ºæ­£å¸¸ï¼Œå¹¶åŠ å…¥å‡åŒ€åˆ†å¸ƒä½œä¸ºæœªçŸ¥çš„å¼‚å¸¸ã€‚</li>
<li>Task 2. æ‰‹å†™æ•°å­—è¢«åˆ†ä¸º3ç»„ï¼šå·²çŸ¥å¼‚å¸¸ï¼Œæ­£å¸¸ï¼ŒæœªçŸ¥å¼‚å¸¸ã€‚</li>
</ol>
<p>ç»†èŠ‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200109102402499.png" /></p>
<p>åœ¨å®ç°ä¸Šï¼Œä½¿ç”¨Adamä¼˜åŒ–å™¨ï¼Œ<code>batch_size</code>ä¸º100ï¼Œ<code>epochs</code>ä¸º200ã€‚<code>Encoder</code>å’Œ<code>Decoder</code>éƒ½ç”±ä¸‰å±‚æ„ŸçŸ¥æœºç»„æˆï¼Œè¶…å‚æ•°<span class="math inline">\(s^2\)</span>è®¾ç½®ä¸º400ã€‚è¯„æµ‹æ ‡å‡†ä½¿ç”¨AUC (area under the receiver characteristic curve)ã€‚</p>
<p>ä¸‹è¡¨ä¸ºå®éªŒç»“æœï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200109102343271.png" /></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/"><img class="thumbnail" src="http://qfxiao.me/img/image-20200106141915707.png" alt="Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-01-06T05:09:32.000Z" title="2020-01-06T05:09:32.000Z">2020-01-06</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">18 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2770 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/">Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE</a></h1><div class="content"><h1 id="introduction">Introduction</h1>
<p><a href="https://ieeexplore.ieee.org/abstract/document/8737430/">è®ºæ–‡ğŸ“ƒ</a></p>
<p><a href="https://github.com/yantijin/Buzz">ä»£ç ğŸ“¥</a></p>
<p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§åˆ©ç”¨å¯¹æŠ—è®­ç»ƒæ¥è¿›è¡Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„æ–¹æ³•<em>Buzz</em>ã€‚ä½œè€…è®¤ä¸ºåœ¨ç°å®ä¸­å¤æ‚çš„KPIæ•°æ®å¤§é‡å­˜åœ¨ï¼Œè¿™ç§æ•°æ®é€šå¸¸å¸¦æœ‰éé«˜æ–¯åˆ†å¸ƒçš„å™ªå£°ï¼ŒåŒæ—¶æ•°æ®åˆ†å¸ƒå¤æ‚ï¼Œå¯¼è‡´ä¸€èˆ¬çš„ç”Ÿæˆå¼æ¨¡å‹æ— æ³•å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„å»ºæ¨¡ï¼Œæ‰€ä»¥ä½œè€…æå‡ºäº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„æ¨¡å‹ã€‚åœ¨æ–‡ä¸­ï¼Œä½œè€…çš„åˆ›æ–°ç‚¹ä¸»è¦æœ‰ä¸‰ä¸ªï¼š</p>
<ol type="1">
<li>ä¸ºäº†å¤„ç†å¤æ‚æ•°æ®ï¼Œå°†æ•°æ®ç©ºé—´åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼Œåœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šè¿›è¡Œè·ç¦»çš„åº¦é‡ï¼›</li>
<li>é‡‡ç”¨<em>Wasserstein</em>è·ç¦»åº¦é‡æ¨¡å‹å»ºæ¨¡çš„åˆ†å¸ƒå’ŒçœŸå®åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼›</li>
<li>å»ºç«‹äº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„<em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒVAEä¹‹é—´çš„å…³ç³»ã€‚</li>
</ol>
<p><img src="http://qfxiao.me/img/image-20200106141915707.png" /></p>
<h1 id="background">Background</h1>
<h2 id="anomaly-detection">Anomaly Detection</h2>
<p>å¯¹äºä»»æ„æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼<span class="math inline">\(x_{t-T+1},\cdots,x_t\)</span>ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º<span class="math inline">\(y_t=1\)</span>)ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚<span class="math inline">\(p(y_t=1|x_{t-T+1},\cdots,x_t)\)</span>ã€‚</p>
<h2 id="vae">VAE</h2>
<table>
<thead>
<tr class="header">
<th><strong>Model</strong></th>
<th><strong>Latent</strong></th>
<th><strong>Data</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong><em>Auto-encoder (AE)</em></strong></td>
<td><code>None</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr class="even">
<td><strong><em>Variational Auto-encoder (VAE)</em></strong></td>
<td><code>KL Divergence</code></td>
<td><code>Log Likelihood</code></td>
</tr>
<tr class="odd">
<td><strong><em>Adversarial Auto-encoder (AAE)</em></strong></td>
<td><code>Discriminator</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr class="even">
<td><strong><em>Wasserstein Auto-encoder (WAE)</em></strong></td>
<td><code>MaxMeanDiscrepancy</code> or <code>Discriminator</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr class="odd">
<td><strong><em>AlphaGAN</em></strong></td>
<td><code>Discriminator</code></td>
<td><code>Discriminator</code>+<code>L1Loss</code></td>
</tr>
</tbody>
</table>
<h2 id="gan-and-wgan-gp">GAN and WGAN-GP</h2>
<p>åŸå§‹GANç­‰ä»·äºä¼˜åŒ–ï¼š <span class="math display">\[
\mathbb{E}_{x\sim P_r}\log{\frac{P_r(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}+\mathbb{E}_{x\sim P_g}\log{\frac{P_g(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}
\]</span> æ ¹æ®KLæ•£åº¦å’ŒJSæ•£åº¦çš„å®šä¹‰ï¼š <span class="math display">\[
\text{KL}(P_1\parallel P_2)=\mathbb{E}_{x\sim P_1}\log{\frac{P_1}{P_2}}
\]</span></p>
<p><span class="math display">\[
\text{JS}(P_1\parallel P_2)=\frac{1}{2}\text{KL}(P_1\parallel \frac{P_1+P_2}{2})+\frac{1}{2}\text{KL}(P_2\parallel \frac{P_1+P_2}{2})
\]</span></p>
<p>å¯é‡å†™ä¸ºï¼š <span class="math display">\[
2\text{JS}(P_r\parallel P_g)-2\log 2
\]</span> å½“<span class="math inline">\(P_r\)</span>ä¸<span class="math inline">\(P_g\)</span>çš„æ”¯æ’‘é›†ï¼ˆsupportï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­çš„ä½ç»´æµå½¢ï¼ˆmanifoldï¼‰æ—¶ï¼Œ<span class="math inline">\(P_r\)</span>ä¸<span class="math inline">\(P_g\)</span>é‡å éƒ¨åˆ†æµ‹åº¦ï¼ˆmeasureï¼‰ä¸º0çš„æ¦‚ç‡ä¸º1ã€‚</p>
<ul>
<li>æ”¯æ’‘é›†ï¼ˆsupportï¼‰å…¶å®å°±æ˜¯å‡½æ•°çš„éé›¶éƒ¨åˆ†å­é›†ï¼Œæ¯”å¦‚<code>ReLU</code>å‡½æ•°çš„æ”¯æ’‘é›†å°±æ˜¯[å…¬å¼]ï¼Œä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„æ”¯æ’‘é›†å°±æ˜¯æ‰€æœ‰æ¦‚ç‡å¯†åº¦éé›¶éƒ¨åˆ†çš„é›†åˆã€‚</li>
<li>æµå½¢ï¼ˆmanifoldï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­æ›²çº¿ã€æ›²é¢æ¦‚å¿µçš„æ‹“å¹¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä½ç»´ä¸Šç›´è§‚ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œæ¯”å¦‚æˆ‘ä»¬è¯´ä¸‰ç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªæ›²é¢æ˜¯ä¸€ä¸ªäºŒç»´æµå½¢ï¼Œå› ä¸ºå®ƒçš„æœ¬è´¨ç»´åº¦ï¼ˆintrinsic dimensionï¼‰åªæœ‰2ï¼Œä¸€ä¸ªç‚¹åœ¨è¿™ä¸ªäºŒç»´æµå½¢ä¸Šç§»åŠ¨åªæœ‰ä¸¤ä¸ªæ–¹å‘çš„è‡ªç”±åº¦ã€‚åŒç†ï¼Œä¸‰ç»´ç©ºé—´æˆ–è€…äºŒç»´ç©ºé—´ä¸­çš„ä¸€æ¡æ›²çº¿éƒ½æ˜¯ä¸€ä¸ªä¸€ç»´æµå½¢ã€‚</li>
<li>æµ‹åº¦ï¼ˆmeasureï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­é•¿åº¦ã€é¢ç§¯ã€ä½“ç§¯æ¦‚å¿µçš„æ‹“å¹¿ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œè¶…ä½“ç§¯â€ã€‚</li>
</ul>
<p><em>Wasserstein</em>è·ç¦»å®šä¹‰å¦‚ä¸‹ï¼š <span class="math display">\[
W(P_r,P_g)=\inf\limits_{\gamma\sim\prod(P_r,P_g)}\mathbb{E}_{(x,y)\sim \gamma}\left[\parallel x-y\parallel\right]
\]</span> ä¸‹ç¡®ç•Œ<span class="math inline">\(\inf\)</span>æ²¡æ³•ç›´æ¥æ±‚è§£ï¼Œä¸è¿‡æ ¹æ®ç›¸å…³å®šç†å…¶ç­‰ä»·äºï¼š <span class="math display">\[
W(P_r,P_g)=\frac{1}{K}\sup\limits_{\parallel f\parallel_L\leq K}\mathbb{E}_{x\sim P_r}[f(x)]-\mathbb{E}_{x\sim P_g}[f(x)]
\]</span> <em>Lipschitz</em>è¿ç»­æ˜¯æŒ‡å­˜åœ¨ä¸€ä¸ªå¸¸æ•°<span class="math inline">\(K\geq 0\)</span>ä½¿å¾—å®šä¹‰åŸŸå†…ä»»æ„ä¸¤ä¸ªå…ƒç´ <span class="math inline">\(x_1\)</span>å’Œ<span class="math inline">\(x_2\)</span>éƒ½æ»¡è¶³ï¼š <span class="math display">\[
|f(x_1)-f(x_2)|\leq K|x_1-x_2|
\]</span> WANçš„æŸå¤±å‡½æ•°ï¼š <span class="math display">\[
\mathcal{L}=\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_g}\left[D({\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_r}\left[D(\mathbf{x})\right]
\]</span> WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[
\mathcal{L}=\mathop{\mathbb{E}}\limits_{\tilde{\mathbf{x}}\sim\mathbb{P}_g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits_{\hat{\mathbf{x}}\sim\mathbb{P}_{\hat{\mathbf{x}}}}\left[(\parallel\nabla_{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]
\]</span></p>
<h1 id="proposed-method">Proposed Method</h1>
<p>ä¸‹å›¾ä¸º<em>Buzz</em>çš„æ€»ä½“æµç¨‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200106141958376.png" /></p>
<p>æ•°æ®ä¼šé¦–å…ˆè¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼Œä¹‹åè¿›è¡Œè®­ç»ƒã€‚åœ¨æ£€æµ‹é˜¶æ®µä¼šæ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥åˆ¤å®šå¼‚å¸¸ã€‚</p>
<h2 id="motivation">Motivation</h2>
<p>åœ¨æ–‡ä¸­ï¼Œæœ€å…³é”®çš„ä¸¤ä¸ªåˆ›æ–°ç‚¹åˆ†åˆ«æ˜¯<em>Wasserstein</em>è·ç¦»å’Œå¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œåˆ†åŒºçš„æ–¹æ³•ã€‚</p>
<ul>
<li><p>åœ¨ä½¿ç”¨è·ç¦»åº¦é‡æ–¹é¢ï¼Œ å› ä¸º<em>Wasserstein</em>åœ¨WGANä¸­å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœï¼Œæ˜¯ä¸€ç§é²æ£’çš„è·ç¦»åº¦é‡ï¼Œæ‰€ä»¥ä½œè€…åœ¨æ–‡ä¸­é‡‡ç”¨äº†<em>Wasserstein</em>è·ç¦»æ¥è¡¡é‡ç”Ÿæˆçš„åˆ†å¸ƒå’ŒçœŸå®çš„åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå¹¶ç”±æ­¤å¼•å…¥äº†å¯¹æŠ—è®­ç»ƒï¼›</p></li>
<li><p>åœ¨åˆ†åŒºæ–¹æ³•æ–¹é¢ï¼Œä½œè€…è®¤ä¸ºåŸå§‹æ•°æ®è¿‡äºå¤æ‚ï¼Œæ‰€ä»¥å°†æ•°æ®ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>è¿›è¡Œåˆ’åˆ†ï¼Œç„¶ååœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šä½¿ç”¨<em>Wasserstein</em>åº¦é‡è·ç¦»ï¼Œè€Œæ€»ä½“çš„è·ç¦»ç”±æ¯ä¸ªåˆ†åŒºçš„è·ç¦»çš„æœŸæœ›æ±‚å¾—ã€‚</p></li>
</ul>
<p>ä½œè€…è¿˜å‘ç°ï¼Œå½“åˆ’åˆ†åœ°è¶Šæ¥è¶Šç»†æ—¶ï¼Œæ€»ä½“è·ç¦»æ¥è¿‘äºç‰¹å®šå½¢å¼çš„VAEçš„é‡æ„è¯¯å·®é¡¹ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20200106142008894.png" /></p>
<h2 id="network-structure">Network Structure</h2>
<p>ä¸‹å›¾ä¸ºæ¨¡å‹çš„ç½‘ç»œç»“æ„ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200106142018827.png" /></p>
<h2 id="training">Training</h2>
<h3 id="objective-function">Objective Function</h3>
<p>å…ˆå®šä¹‰ä¸€äº›ç¬¦å·ï¼š</p>
<ul>
<li><span class="math inline">\(b\)</span>å’Œ<span class="math inline">\(s\)</span>åˆ†åˆ«ä¸ºBatchçš„å¤§å°å’Œé‚»å±…çš„å¤§å°ï¼Œæ•°æ®é›†æŒ‰<span class="math inline">\(s\)</span>è¿›è¡Œåˆ‡åˆ†ï¼Œç„¶åéšæœºæ‰“ä¹±ï¼Œæ¯ä¸ªBatchåŒ…å«<span class="math inline">\(b\)</span>ä¸ª<span class="math inline">\(s\)</span>ï¼Œä¹‹å<span class="math inline">\(s/=2,b*=2\)</span>ï¼›</li>
<li><span class="math inline">\(\mathcal{W}=\{w_1,w_2,\cdots,w_b\}\)</span>ä¸ºä¸€ä¸ªBatchï¼Œä¸”æ»¡è¶³æ¯ä¸ª<span class="math inline">\(w_i\)</span>æ˜¯<span class="math inline">\(s\)</span>çš„å€æ•°ï¼›</li>
<li><span class="math inline">\(w\in\mathcal{W}\)</span>çš„é‚»åŸŸé›†(neighborhood set)ä¸ºä¸€ä¸ªæ—¶é—´ä¸Šçš„partitionï¼Œè®°ä¸º<span class="math inline">\(\{w,w+1,\cdots,w+s-1\}\)</span></li>
<li><span class="math inline">\(\mathbf{x}^{(w)},\mathbf{x}^{(w+1)},\cdots,\mathbf{x}^{(w+s-1)}\)</span>ä¸ºåœ¨ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>ä¸Šçš„ä¸€ä¸ªpartitionï¼Œè®°ä¸º<span class="math inline">\(S_w\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{x}^{(w)}\)</span>è¡¨ç¤ºä»¥<span class="math inline">\(w\)</span>ä¸ºç»“å°¾çš„æ—¶é—´çª—å£ã€‚</li>
</ul>
<p><em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒWGAN-GPç±»ä¼¼ï¼Œä½†åšäº†ä¸€äº›æ”¹è¿›ï¼Œç”±ä¸‹é¢å››éƒ¨åˆ†ç»„æˆï¼Œä¸‹é¢åˆ†åˆ«è§£é‡Šã€‚</p>
<p>ç¬¬ä¸€ä¸ªæ˜¯æ¯ä¸€ä¸ªpartitionçš„<span class="math inline">\(\mathbf{z}\)</span>åéªŒçš„KLæ•£åº¦ï¼š <span class="math display">\[
\mathcal{K} = \frac{1}{bs}\sum\limits_{w\in\mathcal{W}}\sum\limits_{i=1}^{s-1}\text{KL}\left[q_\phi(\mathbf{z}|\mathbf{x})\parallel\mathcal{N}(\mathbf{0},\mathbf{1})\right]
\]</span></p>
<p>ç¬¬äºŒä¸ªåœ¨è®­ç»ƒæ—¶æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼š <span class="math display">\[
Z(\lambda) = \frac{\Gamma(W)}{\Gamma(\frac{W}{2})}2\pi^{\frac{W}{2}}\lambda^{-W}
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\Gamma\)</span>æ˜¯<em>Gamma</em>å‡½æ•°ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªæ˜¯<em>Wasserstein</em>è·ç¦»ï¼š <span class="math display">\[
\mathcal{T}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}_{q_\phi(\mathbf{z}|\mathbf{x}^{w+i})}\left[F(\mathbf{x}^{(w+i)})-F(G(\mathbf{z}))\right]
\]</span></p>
<p>ç¬¬å››ä¸ªæ˜¯<em>Gradient Penalty</em>ï¼š</p>
<p><span class="math display">\[
\mathcal{R}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}_{q_\phi(\mathbf{z}|\mathbf{x}^{(w+i)})}\left[\mathbb{E}_{\varepsilon\sim[0,1]}(\parallel\nabla_{\hat{\mathbf{x}}}(\hat{\mathbf{x}})\parallel-\mathbf{1})^2\right]
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\hat{\mathbf{x}}=\varepsilon \mathbf{x}^{w+i}+(1-\varepsilon)G(\mathbf{z})\)</span>ä¸ºç”Ÿæˆæ•°æ®ä¸çœŸå®æ•°æ®çš„æ’å€¼ã€‚</p>
<blockquote>
<p>åŸå§‹çš„WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[
L=\mathop{\mathbb{E}}\limits_{\tilde{\mathbf{x}}\sim\mathbb{P}_g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits_{\hat{\mathbf{x}}\sim\mathbb{P}_{\hat{\mathbf{x}}}}\left[(\parallel\nabla_{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]
\]</span> å…¶ä¸­<span class="math inline">\(\mathbb{P}_g\)</span>ä¸ºç”Ÿæˆå™¨çš„åˆ†å¸ƒï¼Œ<span class="math inline">\(\mathbb{P}_r\)</span>ä¸ºçœŸå®åˆ†å¸ƒï¼Œ<span class="math inline">\(\mathbb{P}_{\hat{\mathbf{x}}}\)</span>ä¸ºçœŸå®æ•°æ®å’Œç”Ÿæˆæ•°æ®æ’å€¼å¾—åˆ°çš„åˆ†å¸ƒã€‚</p>
</blockquote>
<p><span class="math display">\[
\hat{\mathcal{L}}_{Buzz}=-\lambda\sup\limits_F\left[\sum\limits_{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)
\]</span></p>
<h3 id="training-procedure">Training Procedure</h3>
<p><em>Buzz</em>çš„è®­ç»ƒè¿‡ç¨‹ä¸WGAN-GPç±»ä¼¼ï¼Œ</p>
<h2 id="detection">Detection</h2>
<p>æ–‡ä¸­å‡è®¾è§£ç å™¨çš„è¾“å‡ºæœä»å¦‚ä¸‹åˆ†å¸ƒï¼š</p>
<p><span class="math display">\[
p_\theta(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp\{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel\}
\]</span></p>
<p>ä½œè€…å®šä¹‰å¼‚å¸¸åˆ†æ•°ä¸ºï¼š <span class="math display">\[
\mathcal{S}=\log p_\theta(\mathbf{x})-\log p_\theta(\bar{\mathbf{x}})
\]</span> å…¶ä¸­<span class="math inline">\(\bar{\mathbf{x}}\)</span>ä¸ºç»è¿‡MCMCå¡«å……åçš„æ ·æœ¬ã€‚</p>
<p>å¼‚å¸¸åˆ†æ•°ä¹Ÿå¯ä»¥å±•å¼€ä¸ºï¼š <span class="math display">\[
\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\mathbf{x}|\mathbf{z^{(l)}})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]-\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\bar{\mathbf{x}}|\mathbf{z}^{(l)})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]
\]</span></p>
<p>æœ€ç»ˆç®—æ³•æµç¨‹å›¾ä¸ºï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200106142053342.png" /></p>
<h2 id="theoretical-analysis">Theoretical Analysis</h2>
<p>åœ¨ç†è®ºåˆ†æä¸­ï¼Œä½œè€…ä¸»è¦æ˜¯æƒ³å»ºç«‹<span class="math inline">\(\mathcal{L}_{Buzz}\)</span>å’ŒVAEçš„æŸå¤±å‡½æ•°<span class="math inline">\(\mathcal{L}_{vae}\)</span>ä¹‹é—´çš„è”ç³»ï¼ŒæŸå¤±å‡½æ•°<span class="math inline">\(\mathcal{\hat{L}}_{Buzz}\)</span>ä¸ºï¼š</p>
<p><span class="math display">\[
\hat{\mathcal{L}}_{Buzz}=-\lambda\sup\limits_F\left[\sum\limits_{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)
\]</span></p>
<p>ä¸ºäº†ä¾¿äºåˆ†æï¼Œå»æ‰<em>Gradient Penalty</em>çš„éƒ¨åˆ†ï¼Œå…¬å¼å¯ç®€åŒ–ä¸ºï¼š</p>
<p><span class="math display">\[
\mathcal{L}_{Buzz}=-\lambda\mathbb{E}_{p(w)}W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]-\mathcal{K}-\log Z(\lambda)
\]</span></p>
<p>å®é™…ä¸Š<span class="math inline">\(Z(\lambda)=\mathfrak{S}_W\Gamma(W)\lambda^{-W}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathfrak{S}_W\)</span>ä¸º<span class="math inline">\(W\)</span>ç»´å•ä½çƒçš„è¡¨é¢ç§¯ã€‚</p>
<blockquote>
<p><span class="math inline">\(n\)</span>ç»´ç©ºé—´å•ä½çƒè¡¨é¢ç§¯å…¬å¼ï¼š <span class="math display">\[
\omega_n=\frac{2\pi^{\frac{n}{2}}}{\Gamma(\frac{n}{2})}
\]</span></p>
</blockquote>
<p>è€Œ<span class="math inline">\(W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]\)</span>ä¸º<em>Wasserstein</em>è·ç¦»ï¼š <span class="math display">\[
W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]=\sup\limits_{Lip(f)\leq 1}\left\{\int_\mathcal{X}f(\mathbf{x})p(\mathbf{x}|w)\mathrm{d}\mathbf{x}-\int_\mathcal{X}f(\mathbf{y})p(\mathbf{y}|w)\mathrm{d}\mathbf{y}\right\}
\]</span></p>
<h3 id="lemma-1">Lemma 1</h3>
<p>é€šè¿‡è®¾å®šå…·ä½“å½¢å¼çš„åéªŒåˆ†å¸ƒï¼ŒVAEçš„æŸå¤±å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p>
<blockquote>
<p>è®¾<span class="math inline">\(\mathbf{x}\)</span>çš„åéªŒåˆ†å¸ƒ<span class="math inline">\(p(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp\{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel\}\)</span>ï¼Œé‚£ä¹ˆVAEçš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[
\mathcal{L}_{vae}=\lambda\mathbb{E}_{p(w)}\left[\mathbb{E}_{p(\mathbf{x}|w)}\mathbb{E}_{p_G(\mathbf{y}|\mathbf{x})}-\parallel\mathbf{x}-\mathbf{y}\parallel\right]-\mathcal{K}-\log{Z(\lambda)}
\]</span></p>
</blockquote>
<p>åéªŒåˆ†å¸ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªLaplaceåˆ†å¸ƒï¼š</p>
<blockquote>
<p><strong>Laplace Distribution</strong>: <span class="math display">\[
f(x|\theta,\lambda)=\frac{1}{2\lambda}\exp{\left(-\frac{|x-\theta|}{\lambda}\right)}
\]</span></p>
</blockquote>
<p>å¯ä»¥ç›´æ¥æŠŠåéªŒåˆ†å¸ƒå¸¦å…¥VAEçš„æŸå¤±å‡½æ•°å°±å¾—åˆ°äº†ã€‚</p>
<h3 id="lemma-2">Lemma 2</h3>
<p><span class="math inline">\(S_w\)</span>å®šä¹‰ä¸ºæ•°æ®ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>çš„ä¸€ä¸ªpartitionï¼Œè€Œ<span class="math inline">\(S=\{(\mathbf{x}_1,\mathbf{x}_2)|\exist w, \mathbf{x}_1\in S_w,\mathbf{x}_2\in S_w\}\)</span>ã€‚</p>
<blockquote>
<p>å½“<span class="math inline">\(G,\phi,\lambda\)</span>å›ºå®šæ—¶ï¼Œ<span class="math inline">\(S\downarrow\)</span>æœ‰<span class="math inline">\(\mathcal{L}_{Buzz}\downarrow\)</span></p>
</blockquote>
<h3 id="lemma-3">Lemma 3</h3>
<blockquote>
<p><span class="math inline">\(\max\mathcal{L}_{Buzz}\geq\max{\mathcal{L}_{vae}}\)</span>ï¼ŒåŒæ—¶ï¼Œå½“<span class="math inline">\(S\downarrow\text{diag}{\mathcal{X}}\)</span>æ—¶<span class="math inline">\(\max\mathcal{L}_{Buzz}\downarrow\max\mathcal{L}_{vae}\)</span></p>
</blockquote>
<p><img src="http://qfxiao.me/img/image-20200106183833975.png" /></p>
<h3 id="lemma-4">Lemma 4</h3>
<blockquote>
<p>ä»¤<span class="math inline">\(p^\prime_G(\mathbf{y}|\mathbf{x})\)</span>è¡¨ç¤º<span class="math inline">\(\mathbb{E}_{q_{\phi^\prime}}\left[p_G(\mathbf{y}|\mathbf{z})\right]\)</span>ã€‚å¦‚æœ<span class="math inline">\((G,\phi,\lambda)\)</span>æ˜¯ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆå­˜åœ¨<span class="math inline">\((G,\phi^\prime,\lambda)\)</span>ä½¿å¾—ï¼š <span class="math display">\[
\mathbb{E}_{p(\mathbf{x}|w)}\mathbb{E}_{p_G^\prime(\mathbf{y}|\mathbf{x})}\parallel\mathbf{x}-\mathbf{y}\parallel=W^1\left[P(\mathbf{x}|w)\parallel P_G(\mathbf{y}|w)\right]
\]</span> æ­¤æ—¶<span class="math inline">\(\mathcal{L}_{Buzz}-\mathcal{L}_{vae}^\prime=\mathcal{K}^\prime-\mathcal{K}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathcal{L}^\prime,\mathcal{K}^\prime\)</span>åˆ†åˆ«ä¸º<span class="math inline">\((G,\phi^\prime,\lambda)\)</span>æ—¶çš„<span class="math inline">\(\mathcal{L}\)</span>å’Œ<span class="math inline">\(\mathcal{K}\)</span>ã€‚</p>
</blockquote>
<p><span class="math display">\[
\mathcal{L}^\dagger_{Buzz}=\mathbb{E}_{p(\mathbf{x})}\left[\mathbb{E}_{q_{\phi^\prime}(\mathbf{z}|\mathbf{x})}\log_{p_\theta}(\mathbf{x}|\mathbf{z})\right]-\min\limits_{\bar{\phi}\sim\phi^\prime}\bar{\mathcal{K}}
\]</span></p>
<h3 id="lemma-5">Lemma 5</h3>
<p>è¿™é‡Œä¸»è¦æ˜¯æƒ³è¯æ˜</p>
<blockquote>
<p>å¯¹äºå›ºå®šçš„<span class="math inline">\(w\)</span>ï¼Œä»¤ï¼š <span class="math display">\[
\mathcal{F}=\{f|Lip(f)\leq 1\}, \space \mathcal{F}^*=\left\{f|_{S_w}\bigg|Lip(f|_{S_w})\leq 1\right\}
\]</span> æœ‰<span class="math inline">\(\sup_{f\in\mathcal{F}}\mathcal{T}(f)=\sup_{f|_{S_w}\in\mathcal{F}^*}\mathcal{T}^*\left(f|_{S_w}\right)\)</span>ã€‚</p>
</blockquote>
<h3 id="theorem-6">Theorem 6</h3>
<blockquote>
<p><span class="math inline">\(\mathcal{L}_{Buzz}\)</span>çš„å¯¹å¶å½¢å¼ä¸ºï¼š <span class="math display">\[
\mathcal{L}_{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}^*(F)-\mathcal{K}-\log Z(\lambda)
\]</span></p>
</blockquote>
<p>è¿‘ä¼¼çš„<span class="math inline">\(\mathcal{L}_{Buzz}\)</span>çš„å¯¹å¶å½¢å¼ä¸ºï¼š <span class="math display">\[
\bar{\mathcal{L}}_{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}(F)-\mathcal{K}-\log Z(\lambda)
\]</span></p>
<h1 id="experiment">Experiment</h1>
<p><img src="http://qfxiao.me/img/image-20200106142131500.png" /></p>
<p><img src="http://qfxiao.me/img/image-20200106142155978.png" /></p>
<p><img src="http://qfxiao.me/img/image-20200106142212110.png" /></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/"><img class="thumbnail" src="http://qfxiao.me/img/image-20191102233101258.png" alt="Variational Approaches for Auto-Encoding Generative Adversarial Networks"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-02T15:28:53.000Z" title="2019-11-02T15:28:53.000Z">2019-11-02</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/GAN/">GAN</a></span><span class="level-item">18 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2774 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/">Variational Approaches for Auto-Encoding Generative Adversarial Networks</a></h1><div class="content"><h1 id="abstract">Abstract</h1>
<p>æœ¬æ–‡æ­ç¤ºäº†å¯¹æŠ—ç”Ÿæˆç½‘ç»œï¼ˆGenerative Adversarial Networks, GANï¼‰å’Œå˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational Auto-encoders, VAEï¼‰ä¹‹é—´çš„è”ç³»ï¼Œå¹¶æ®æ­¤æå‡ºäº†ä¸€ç§å°†ä¸¤è€…ç»“åˆçš„æ–°æ¨¡å‹ã€‚æ–‡ä¸­ä¸»è¦æ˜¯å°†ä¸å¯è§£çš„ä¼¼ç„¶å‡½æ•°å’ŒæœªçŸ¥çš„åéªŒåˆ†å¸ƒç”¨ä¸€ä¸ªéç¡®å®šçš„åˆ†å¸ƒï¼ˆImmplicit Distributionï¼‰æ›¿ä»£ï¼Œå¹¶åŠ å…¥åˆ¤åˆ«å™¨æ¥ä½¿å¾—è¯¥åˆ†å¸ƒé€¼è¿‘çœŸå®çš„åˆ†å¸ƒã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œä½œè€…å°†VAEä¸­çš„æŸå¤±å‡½æ•°è¿›è¡Œäº†æ›¿æ¢ï¼Œå˜æˆäº†GANä¸­çš„â€œç”Ÿæˆ-åˆ¤åˆ«â€æ¨¡å¼ã€‚</p>
<p><a href="https://arxiv.org/abs/1706.04987">åŸæ–‡</a></p>
<h1 id="contribution">Contribution</h1>
<p>æœ¬æ–‡æœ‰å¦‚ä¸‹è´¡çŒ®ï¼š</p>
<ul>
<li>æœ¬æ–‡æå‡ºå˜åˆ†æ¨æ–­ï¼ˆVariational Inferenceï¼‰ä¹Ÿèƒ½é€šè¿‡å¯¹éç¡®å®šåˆ†å¸ƒçš„ä¼°è®¡åº”ç”¨åœ¨GANä¸­ï¼›</li>
<li>åŸºäºä¼¼ç„¶çš„æ¨¡å‹ï¼ˆLikelihood-based Modelsï¼‰å’Œéä¼¼ç„¶æ¨¡å‹ï¼ˆLikelihood-free Modelsï¼‰èƒ½å¤Ÿé€šè¿‡å¯¹æŠ—å­¦ä¹ ç»“åˆèµ·æ¥ï¼›</li>
<li>ä½œè€…æ ¹æ®æ–‡ä¸­æå‡ºçš„æ–°è§‚ç‚¹ä¿®æ”¹äº†VAEçš„æŸå¤±å‡½æ•°ï¼Œå°†å…¶ç§°ä¹‹ä¸ºAuto-encoding GAN (<span class="math inline">\(\alpha\)</span>-GAN)ï¼Œå¹¶æå‡ºäº†å¯¹åº”çš„å®ç”¨çš„æ”¹è¿›ï¼›</li>
<li>æœ¬æ–‡ä¸ä¼—å¤šState-of-Artæ¨¡å‹è¿›è¡Œäº†å¯¹æ¯”</li>
</ul>
<h1 id="methodology">Methodology</h1>
<h2 id="overcoming-intractability-in-generative-models">Overcoming Intractability in Generative Models</h2>
<h3 id="latent-variable-models">Latent Variable Models</h3>
<p>éšå˜é‡æ¨¡å‹é€šè¿‡éšå˜é‡çš„å½¢å¼æè¿°äº†æ•°æ®çš„äº§ç”Ÿè¿‡ç¨‹ã€‚æœ€ç®€å•çš„å½¢å¼æ˜¯å‡è®¾éšå˜é‡<span class="math inline">\(\mathbf{z}\)</span>æœä»ä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒ<span class="math inline">\(\mathbf{z}\sim p(\mathbf{z})\)</span>ï¼Œè€Œæ•°æ®<span class="math inline">\(\mathbf{x}\)</span>ä»æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p(\mathbf{x}|\mathbf{z})\)</span>æŠ½æ ·äº§ç”Ÿã€‚é€šå¸¸æ¥è¯´æè¿°<span class="math inline">\(p(\mathbf{x}|\mathbf{z})\)</span>çš„æ¨¡å‹ç§°ä¸ºç”Ÿæˆå™¨<span class="math inline">\(\mathcal{G}_\theta(\mathbf{z})\)</span>ï¼Œå¸¦æœ‰å¯ä¼˜åŒ–çš„å‚æ•°<span class="math inline">\(\theta\)</span>ï¼Œè€Œ<span class="math inline">\(\mathbf{z}\)</span>é€šå¸¸å‡è®¾ä¸ºæ­£æ€åˆ†å¸ƒ<span class="math inline">\(\mathbf{z}\sim\mathcal{N}(\mathbf{0},\mathbf{I})\)</span>ã€‚</p>
<p>æ–‡ä¸­åŒºåˆ†äº†ä¸¤ç§éšå˜é‡æ¨¡å‹ï¼Œä¸€ç§æ˜¯<em>Implicit Latent Variable Models</em>ï¼Œä¸€ç§æ˜¯<em>Prescribed Latent Variable Models</em>ã€‚æ–‡ä¸­çš„æè¿°ä¸å¤ªæ¸…æ¥šï¼Œä¸ªäººè®¤ä¸ºä¸¤è€…çš„åŒºåˆ«æ˜¯å‰è€…å›¾æ¨¡å‹ä¸­çš„<span class="math inline">\(\mathbf{x}\)</span>ä¸æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œåœ¨ä¼˜åŒ–çš„æ—¶å€™éœ€è¦ç”¨ä¸€ä¸ªåˆ»ç”»ç”Ÿæˆçš„<span class="math inline">\(\mathbf{x}\)</span>å’ŒçœŸå®çš„<span class="math inline">\(\mathbf{x}\)</span>çš„å·®åˆ«çš„å‡½æ•°<span class="math inline">\(\delta(\mathbf{x}-\mathcal{G}_\theta(\mathbf{z}))\)</span>ï¼Œè€Œåè€…å›¾æ¨¡å‹ä¸­<span class="math inline">\(\mathbf{x}\)</span>æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œè¿™æ ·å¯ä»¥å†™å‡ºä¼¼ç„¶å‡½æ•°ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p>
<p>æ— è®ºæ˜¯GANè¿˜æ˜¯VAEéƒ½éœ€è¦é€šè¿‡è¾¹ç¼˜åˆ†å¸ƒ<span class="math inline">\(p_\theta(\mathbf{x})\)</span>æ¥åˆ»ç”»å»ºæ¨¡çš„å¥½åï¼Œæ¯”å¦‚è¯´æ ¹æ®<span class="math inline">\(p_\theta(\mathbf{x})\)</span>ä¸çœŸå®åˆ†å¸ƒ<span class="math inline">\(p^*_\theta(\mathbf{x})\)</span>ä¹‹é—´çš„KLæ•£åº¦<span class="math inline">\(\text{KL}\left[p_\theta(\mathbf{x})\parallel p_\theta^*(\mathbf{x})\right]\)</span>ã€‚ä½†é€šå¸¸æƒ…å†µä¸‹<span class="math inline">\(p_\theta(\mathbf{x})\)</span>éƒ½æ˜¯ä¸å¯è§£çš„ï¼Œè€ŒGANå’ŒVAEé€šè¿‡ä¸åŒçš„é€”å¾„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 id="generative-adversarial-networks">Generative Adversarial Networks</h3>
<p>GANæ²¡æœ‰ç›´æ¥è®¡ç®—<span class="math inline">\(p_\theta(\mathbf{x})\)</span>ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªåˆ¤åˆ«å™¨æ¥åˆ¤åˆ«æ ·æœ¬æ˜¯ä»<span class="math inline">\(p_\theta(\mathbf{x})\)</span>è¿˜æ˜¯<span class="math inline">\(p_\theta^*(\mathbf{x})\)</span>é‡‡æ ·å¾—åˆ°çš„ï¼Œå¦‚æœåˆ¤åˆ«å™¨æ— æ³•è¿›è¡ŒåŒºåˆ†ï¼Œé‚£æˆ‘ä»¬è®¤ä¸ºæ­¤æ—¶<span class="math inline">\(p_\theta(\mathbf{x})\approx p_\theta^*(\mathbf{x})\)</span>ã€‚</p>
<p>ä»¤éšæœºå˜é‡<span class="math inline">\(y\in\{0,1\}\)</span>ï¼Œ<span class="math inline">\(y=1\)</span>è¡¨ç¤ºæ ·æœ¬<span class="math inline">\(\mathbf{x}\)</span>æ¥è‡ªçœŸå®åˆ†å¸ƒï¼Œ<span class="math inline">\(y=0\)</span>è¡¨ç¤ºæ ·æœ¬<span class="math inline">\(\mathbf{x}\)</span>æ¥è‡ªç”Ÿæˆåˆ†å¸ƒï¼Œè€Œåˆ¤åˆ«å™¨çš„è¾“å‡ºä¸º<span class="math inline">\(\mathbf{x}\)</span>æ¥è‡ªçœŸå®åˆ†å¸ƒçš„æ¦‚ç‡<span class="math inline">\(\mathcal{D}_\phi(\mathbf{x})=p(y=1|\mathbf{x})\)</span>ã€‚GANé€šè¿‡å¯¹æ¥è‡ªçœŸå®åˆ†å¸ƒå’Œç”Ÿæˆåˆ†å¸ƒçš„æ ·æœ¬æ±‚äºŒå…ƒäº¤å‰ç†µæ¥ä½œä¸ºåˆ¤åˆ«å™¨æŸå¤±å‡½æ•°ï¼š <span class="math display">\[
\textbf{Discriminator Loss: }\mathbb{E}_{p^*(\mathbf{x})}[-\log\mathcal{D}_\phi(\mathbf{x})]+\mathbb{E}_{p_\theta(\mathbf{x})}[-\log(1-\mathcal{D}_\phi(\mathbf{x}))]
\]</span></p>
<p>ç”Ÿæˆå™¨å°†æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬åˆ¤å®šä¸ºçœŸçš„æ¦‚ç‡ä½œä¸ºæŸå¤±å‡½æ•°ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªç­‰ä»·çš„ä½†åœ¨å®è·µä¸­è¡¨ç°æ›´å¥½çš„æ›¿ä»£ç‰ˆæœ¬ï¼š</p>
<p><span class="math display">\[
\textbf{Generator Loss: }\mathbb{E}_{p_\theta(\mathbf{x})}[\log(1-\mathcal{D}_\phi(\mathbf{x}))];\textbf{ Alternative Loss: }\mathbf{E}_{p_\theta(\mathbf{x})}[-\log\mathcal{D}_\phi(\mathbf{x})]
\]</span></p>
<h3 id="the-density-ratio-trick">The Density Ratio Trick</h3>
<p>ä»¤<span class="math inline">\(p^*(\mathbf{x})=p(\mathbf{x}|y=1)\)</span>ï¼Œ<span class="math inline">\(p_\theta(\mathbf{x})=p(\mathbf{x}|y=0)\)</span>ã€‚å®šä¹‰<em>Density Ratio</em> <span class="math inline">\(r_\phi(\mathbf{x})\)</span>ä¸ºçœŸå®åˆ†å¸ƒå’Œç”Ÿæˆåˆ†å¸ƒä¹‹é—´çš„æ¯”ä¾‹ï¼š</p>
<p><span class="math display">\[
r_\phi(\mathbf{x})=\frac{p^*(\mathbf{x})}{p_\theta(\mathbf{x})}=\frac{p(\mathbf{x}|y=1)}{p(\mathbf{x}|y=0)}=\frac{p(y=1|\mathbf{x})}{p(y=0|\mathbf{x})}=\frac{\mathcal{D}_\phi(\mathbf{x})}{1-\mathcal{D}_\phi(\mathbf{x})}
\]</span></p>
<p>ä¸Šå¼è¡¨æ˜äº†<em>Density Ratio</em>çš„è®¡ç®—å¯ä»¥ä»…é€šè¿‡ä»ä¸¤ä¸ªåˆ†å¸ƒä¸Šé‡‡æ ·å¾—åˆ°çš„æ ·æœ¬åŠ ä¸Šä¸€ä¸ªäºŒåˆ†ç±»å™¨<span class="math inline">\(\mathcal{D}_\phi(\mathbf{x})\)</span>å®ç°ï¼ˆå‡è®¾<span class="math inline">\(p(y=0)=p(y=1)\)</span>ï¼‰ã€‚æ›´æ·±å…¥çš„è¯´ï¼Œå¯¹äºä¸å¯è§£çš„åˆ†å¸ƒ<span class="math inline">\(p_\theta^*(\mathbf{x})\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—<em>Density Ratio</em>æ¥äº†è§£æˆ‘ä»¬è¿‘ä¼¼çš„åˆ†å¸ƒ<span class="math inline">\(p_\theta(\mathbf{x})\)</span>å’ŒçœŸå®çš„<span class="math inline">\(p_\theta^*(\mathbf{x})\)</span>ä¹‹é—´çš„ç›¸å¯¹æ€§ã€‚è€Œä¸”æˆ‘ä»¬åªéœ€è¦èƒ½å¤Ÿåœ¨ä¸¤ä¸ªåˆ†å¸ƒä¸Šè¿›è¡Œé‡‡æ ·ï¼Œå¹¶ä¸”è®­ç»ƒä¸€ä¸ªåˆ¤åˆ«å™¨å³å¯ã€‚å› ä¸ºåˆ¤åˆ«å™¨æ˜¯ä¸€ä¸ªæ™®é€šçš„åˆ†ç±»å™¨ï¼Œæ‰€ä»¥å¤§é‡çš„ä¸»æµåˆ†ç±»å™¨éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p>
<h3 id="variational-inference">Variational Inference</h3>
<p>ç°åœ¨æ¥çœ‹VAEï¼Œå¦ä¸€ç§è§£å†³ä¸å¯è§£åˆ†å¸ƒçš„æ–¹æ³•æ˜¯è¿‘ä¼¼ã€‚<em>Variational Inference</em>é€šè¿‡å¼•å…¥ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ<span class="math inline">\(q_\eta(\mathbf{z}|\mathbf{x})\)</span>æ¨å‡ºäº†ä¸å¯è§£çš„<span class="math inline">\(\mathbf{x}\)</span>çš„å¯¹æ•°ä¼¼ç„¶çš„ä¸‹ç•Œï¼ˆå¸¸è¢«ç§°ä¸ºè¯æ®ä¸‹ç•ŒELBOï¼‰ï¼š</p>
<p><span class="math display">\[
\log p_\theta(\mathbf{x})=\log\int p_\theta(\mathbb{x}|\mathbb{z})p(\mathbf{z})\text{d}\mathbf{z}\geq \mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log p_\theta(\mathbf{x}|\mathbf{z})\right]-\text{KL}\left[q_\eta(\mathbf{z}|\mathbf{x})\parallel p(\mathbf{z})\right]=\mathcal{F}(\boldsymbol{\theta}, \boldsymbol{\eta})
\]</span></p>
<p>VAEæ˜¯<em>Variational Inference</em>çš„ä¸€ç§å®ç°ï¼Œå˜åˆ†åˆ†å¸ƒé€šè¿‡ä¸€ä¸ªç¥ç»ç½‘ç»œè¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ä¸”å»ºç«‹èµ·äº†å®Œæ•´çš„å¯ä¼˜åŒ–çš„æ¨¡å‹ã€‚</p>
<h3 id="synthetic-likelihood">Synthetic Likelihood</h3>
<p>å½“ä¼¼ç„¶å‡½æ•°æœªçŸ¥ï¼ˆGANä¸­æ²¡æœ‰æ˜¾å¼çš„ä¼¼ç„¶å‡½æ•°ï¼Œè€ŒVAEä¸­æœ‰ï¼‰çš„æ—¶å€™ï¼Œ<em>Variational Inference</em>ä¾¿æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚å¯¹äºæ²¡æœ‰æ˜¾å¼çš„ä¼¼ç„¶å‡½æ•°çš„æƒ…å†µï¼Œä»¥VAEçš„ELBOçš„ç¬¬ä¸€é¡¹ä¸ºä¾‹ï¼Œå‡è®¾<span class="math inline">\(p_\theta(\mathbf{x}|\mathbf{z})\)</span>åˆ†å¸ƒçš„å…·ä½“å½¢å¼æœªçŸ¥ï¼Œæˆ‘ä»¬åªæœ‰ä»<span class="math inline">\(p_\theta(\mathbf{x}|\mathbf{z})\)</span>é‡‡æ ·å¾—åˆ°çš„æ ·æœ¬ï¼Œå¦‚ä½•è®¡ç®—<span class="math inline">\(\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}[\log p_\theta(\mathbf{x}|\mathbf{z})]\)</span>å‘¢ï¼Ÿä¸€ä¸ªæ–¹æ³•æ˜¯ä¹˜ä»¥<span class="math inline">\(p_\theta^*(\mathbf{x})\)</span>å†é™¤ä»¥<span class="math inline">\(p_\theta^*(\mathbf{x})\)</span>ï¼š</p>
<p><span class="math display">\[
\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}[\log p_\theta(\mathbf{x}|\mathbf{z})]=\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{p_\theta(\mathbf{x}|\mathbf{z})}{p^*(\mathbf{x})}\right]+\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}[\log p^*(\mathbf{x})]
\]</span></p>
<p>å…¬å¼(5)ä¸­çš„ç¬¬ä¸€é¡¹åŒ…æ‹¬äº†åˆæˆä¼¼ç„¶<span class="math inline">\(R(\theta)=\frac{p_\theta(\mathbf{x}|\mathbf{z})}{p^*(\mathbf{x})}\)</span>ï¼Œä¼˜åŒ–<span class="math inline">\(R(\theta)\)</span>ç›¸å½“äºä¼˜åŒ–<span class="math inline">\(\log p_\theta(\mathbf{x}|\mathbf{z})\)</span>ã€‚ç¬¬äºŒé¡¹ä¸ç”Ÿæˆç½‘ç»œçš„å‚æ•°<span class="math inline">\(\theta\)</span>æ— å…³ï¼Œæ‰€ä»¥åœ¨ä¼˜åŒ–çš„æ—¶å€™å¯ä»¥å¿½ç•¥ã€‚</p>
<h2 id="a-fusion-of-variational-and-adversarial-learning">A Fusion of Variational and Adversarial Learning</h2>
<p>GANå’ŒVAEåˆ†åˆ«ä»ä¸åŒçš„è§’åº¦è§£å†³äº†ç”Ÿæˆæ¨¡å‹çš„æ¨æ–­é—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹é¢ä»VAEå‡ºå‘ï¼Œè€ƒè™‘å°†ä¸¤è€…ç»“åˆèµ·æ¥ã€‚</p>
<h3 id="implicit-variational-distributions">Implicit Variational Distributions</h3>
<p>å˜åˆ†æ¨æ–­<strong>Variational Inference</strong>çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯ç¡®å®š<span class="math inline">\(q_\eta(\mathbf{z}|\mathbf{x})\)</span>ï¼Œé€šå¸¸çš„åšæ³•å¦‚<strong>Mean-field Variational Inference</strong>ä¼šå‡è®¾ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚åœ¨æœ¬æ–‡ä¸­ä¸å¯¹<span class="math inline">\(q_\eta(\mathbf{z}|\mathbf{x})\)</span>çš„å½¢å¼ä½œå‡è®¾ï¼Œä»…å‡è®¾å…¶ä¸ºä¸€ä¸ªéšå«çš„åˆ†å¸ƒã€‚è¿ç”¨ä¸Šæ–‡æåˆ°çš„<em>Density Ratio Trick</em>ï¼Œæˆ‘ä»¬å¯ä»¥å°†VAEæŸå¤±å‡½æ•°ä¸­çš„ç¬¬äºŒé¡¹æ”¹å†™ä¸ºï¼š</p>
<p><span class="math display">\[
-\text{KL}[q_\eta(\mathbf{z}|\mathbf{x})\parallel p(\mathbf{z})]=\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{p(\mathbf{z})}{q_\eta(\mathbf{z}|\mathbf{x})}\right]\approx\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}{1-\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}\right]
\]</span></p>
<p>æ–‡ä¸­å¼•å…¥äº†ä¸€ä¸ªéšå˜é‡åˆ†ç±»å™¨ï¼ˆLatent Classifierï¼‰<span class="math inline">\(\mathcal{C}_{\boldsymbol{\omega}}(\mathbf{z})\)</span>ï¼Œç”¨æ¥åˆ¤åˆ«<span class="math inline">\(\mathbf{z}\)</span>æ˜¯ä»ç¼–ç ç½‘ç»œè¿˜æ˜¯ä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ï¼ˆçŒœæµ‹è¿™æ ·åšçš„å¥½å¤„æ˜¯ä¸ç”¨å†å¯¹<span class="math inline">\(\mathbf{z}\)</span>çš„åéªŒåšé«˜æ–¯åˆ†å¸ƒçš„å‡è®¾äº†ï¼Œä¹Ÿä¸éœ€è¦åœ¨å˜åˆ†ç½‘ç»œè¾“å‡ºå½¢æˆçš„é«˜æ–¯åˆ†å¸ƒä¸Šé‡‡æ ·å¾—åˆ°<span class="math inline">\(\mathbf{z}\)</span>äº†ï¼Œè¿™æ ·é‡å‚æ•°æŠ€å·§ä¹Ÿçœäº†ï¼‰ã€‚å…·ä½“å®ç°ä¸Šï¼ŒæœŸæœ›å¯ä»¥ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•ï¼ˆé‡‡æ ·å¤šæ¬¡å–å‡å€¼ï¼‰è¿›è¡Œè®¡ç®—ã€‚</p>
<h3 id="likelihood-choice">Likelihood Choice</h3>
<p>å¯¹äºVAEæŸå¤±å‡½æ•°ç¬¬ä¸€é¡¹ï¼Œå¯¹åº”ç”Ÿæˆç½‘ç»œï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¯¹<span class="math inline">\(p(\mathbf{x}|\mathbf{z})\)</span>åˆ†å¸ƒçš„å…·ä½“å½¢å¼åšå‡è®¾ï¼Œ è¿™æ ·å¯¹åº”<em>Likelihood-based</em>çš„æƒ…å†µã€‚æ–‡ä¸­é€‰æ‹©çš„æ˜¯<em>Zero-mean Laplace Distribution</em> <span class="math inline">\(p_\theta(\mathbf{x}|\mathbf{z})\propto\exp(-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1)\)</span>ï¼ˆä¸å°±æ˜¯<span class="math inline">\(L_1\)</span> Losså—ï¼Ÿï¼Ÿï¼Ÿï¼‰ã€‚</p>
<p>å¯¹äº<em>Likelihood-free</em>çš„æƒ…å†µï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ä¸Šé¢æåˆ°çš„<em>Density Ratio Trick</em>ï¼Œè¿™æ—¶éœ€è¦åŠ ä¸€ä¸ªä¸€ä¸ªåˆ¤åˆ«å™¨ã€‚</p>
<p><span class="math display">\[
\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1\right]\space\space\text{  or  }\space\space\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}{1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}\right]
\]</span></p>
<p>å¯¹äºä¸¤ç§é€‰æ‹©ï¼Œå‰è€…å¯¹åº”VAEï¼Œå¥½å¤„æ˜¯ä¸ä¼šå‡ºç°æ¨¡å¼å´©æºƒçš„æƒ…å†µï¼Œåè€…å¯¹åº”GANï¼Œå®¹æ˜“å‡ºç°æ¨¡å¼å´©æºƒçš„æƒ…å†µï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å¯¹æŠ—å­¦ä¹ çš„æ–¹å¼ï¼ˆè¿™æ˜¯ä¼˜ç‚¹ï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œæœ¬æ–‡é€‰æ‹©ä¸¤ç§éƒ½ç”¨ï¼ˆæˆ‘å…¨éƒ½è¦.jpgï¼‰ã€‚</p>
<h3 id="hybrid-loss-functions">Hybrid Loss Functions</h3>
<p>å°†å‰é¢çš„è®¨è®ºç»“åˆèµ·æ¥ï¼Œæœ€åçš„æŸå¤±å‡½æ•°å°±æ˜¯ï¼š</p>
<p><span class="math display">\[
\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\eta})=\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1+\log\frac{\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}{1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}+\log\frac{\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}{1-\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}\right]
\]</span></p>
<p>æœ€åæ¨¡å‹åŒ…å«å››ä¸ªç½‘ç»œï¼šç”Ÿæˆç½‘ç»œ<span class="math inline">\(p_\theta(\mathbf{x}|\mathbf{z})\)</span>ã€æ¨æ–­ç½‘ç»œ<span class="math inline">\(q_\eta(\mathbf{z}|\mathbf{x})\)</span>ä»¥åŠä¸¤ä¸ªåˆ¤åˆ«å™¨<span class="math inline">\(\mathcal{C}_{\boldsymbol{\omega}}\)</span>å’Œ<span class="math inline">\(\mathcal{D}_\phi\)</span>ï¼Œä½œè€…å°†å…¶å‘½åä¸º<span class="math inline">\(\alpha\)</span>-GANã€‚</p>
<p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191106220923748.png" /></p>
<h3 id="improved-techniques">Improved Techniques</h3>
<p>ä½œè€…ä¸ºäº†æ”¹è¿›æ¨¡å‹çš„ç¨³å®šæ€§å’Œæ•ˆç‡ï¼Œå°†ç”Ÿæˆå™¨çš„Lossä¸­çš„<span class="math inline">\(-\log(1-\mathcal{D}_\phi)\)</span>ä¿®æ”¹ä¸ºäº†<span class="math inline">\(\log\mathcal{D}_\phi-\log(1-\mathcal{D}_\phi)\)</span>ï¼Œå¹¶å£°ç§°è¿™æ ·èƒ½æä¾›éé¥±å’Œï¼ˆNon-saturatingï¼‰çš„æ¢¯åº¦ï¼š</p>
<p><span class="math display">\[
\textbf{Generator Loss: } \mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1-\log\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))+\log(1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z})))\right]
\]</span></p>
<p>ä½œè€…è®¤ä¸ºåœ¨ç”Ÿæˆå™¨æŸå¤±å‡½æ•°ä¸­åŠ å…¥<span class="math inline">\(\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1\)</span>èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦é˜²æ­¢æ¨¡å¼å´©æºƒã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…å‘ç°å°†çœŸå®æ ·æœ¬ï¼ˆåŸæ–‡æ˜¯The Samplesï¼‰ä½œä¸ºç”Ÿæˆçš„æ ·æœ¬è¾“å…¥åˆ°åˆ¤åˆ«å™¨ä¸­èƒ½å¤Ÿæå‡æ€§èƒ½ã€‚ä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯æ ¹æ®Jensenä¸ç­‰å¼ï¼š<span class="math inline">\(\log p_\theta(\mathbf{x})=\log\int p_\theta(\mathbf{x}|\mathbf{z})p(\mathbf{z})\text{d}\mathbf{z}\geq \mathbb{E}_{p(\mathbf{z})}[\log p_\theta(\mathbf{x}|\mathbf{z})]\)</span>ï¼Œ</p>
<p>[TODO]</p>
<h2 id="related-work">Related Work</h2>
<p>[TODO]</p>
<p><img src="http://qfxiao.me/img/image-20191102233101258.png" /></p>
<p><img src="http://qfxiao.me/img/image-20191102233151987.png" /></p>
<h1 id="experiments">Experiments</h1>
<p>[TODO]</p>
<h2 id="metrics">Metrics</h2>
<p>æœ¬æ–‡ä½¿ç”¨äº†å‡ ç§ä¸åŒçš„è¯„æµ‹ç”Ÿæˆæ¨¡å‹çš„æ–¹æ³•ï¼š</p>
<ul>
<li><strong>Inception Score: </strong></li>
<li><strong>Multi-scale Structural Similarity (MS-SSIM): </strong></li>
<li><strong>Independent Wasserstein Critic: </strong></li>
</ul>
<h2 id="results-on-colormnist">Results on ColorMNIST</h2>
<p><img src="http://qfxiao.me/img/image-20191102233220700.png" /></p>
<p><img src="http://qfxiao.me/img/image-20191102233244847.png" /></p>
<h2 id="results-on-celeba">Results on CelebA</h2>
<p><img src="http://qfxiao.me/img/image-20191102233303345.png" /></p>
<h2 id="results-on-cifar-10">Results on CIFAR-10</h2>
<p><img src="http://qfxiao.me/img/image-20191102233338213.png" /></p>
<p><img src="http://qfxiao.me/img/image-20191102233350494.png" /></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/10/22/An-Introduction-to-Variational-Autoencoders/"><img class="thumbnail" src="http://qfxiao.me/img/autoencoder23849248011.png" alt="An Introduction to Variational Autoencoders"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-22T07:14:26.000Z" title="2019-10-22T07:14:26.000Z">2019-10-22</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Tutorial/">Tutorial</a></span><span class="level-item">22 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 3277 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/22/An-Introduction-to-Variational-Autoencoders/">An Introduction to Variational Autoencoders</a></h1><div class="content"><h1 id="deep-generative-models">Deep Generative Models</h1>
<p>ç”Ÿæˆæ¨¡å‹æ˜¯æŒ‡ä¸€ç³»åˆ—ç”¨äºéšæœºç”Ÿæˆå¯è§‚æµ‹æ•°æ®çš„æ¨¡å‹ã€‚å‡è®¾åœ¨ä¸€ä¸ªé«˜ç»´ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªéšæœºå‘é‡<span class="math inline">\(\mathbf{X}\)</span>æœä»ä¸€ä¸ªæœªçŸ¥çš„åˆ†å¸ƒ<span class="math inline">\(p_r(x),x\in \mathcal{X}\)</span>ã€‚ç”Ÿæˆæ¨¡å‹å°±æ˜¯æ ¹æ®ä¸€äº›å¯è§‚æµ‹çš„æ ·æœ¬<span class="math inline">\(x^{(1)},x^{(2)},\cdots,x^{(N)}\)</span>æ¥å­¦ä¹ ä¸€ä¸ªå‚æ•°åŒ–çš„æ¨¡å‹<span class="math inline">\(p_\theta(x)\)</span>æ¥è¿‘ä¼¼æœªçŸ¥åˆ†å¸ƒ<span class="math inline">\(p_r(x)\)</span>ã€‚</p>
<p>ç”Ÿæˆæ¨¡å‹ä¸»è¦ç”¨äºå¯†åº¦ä¼°è®¡å’Œæ ·æœ¬ç”Ÿæˆã€‚</p>
<hr />
<p>å¯†åº¦ä¼°è®¡å³ç»™å®šä¸€ç»„æ•°æ®<span class="math inline">\(\mathcal{D}=\{x^{(i)}\},1\leq i\leq N\)</span>ï¼Œå‡è®¾ä»–ä»¬éƒ½æ˜¯ä»ç›¸åŒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°<span class="math inline">\(p_r(x)\)</span>ç‹¬ç«‹äº§ç”Ÿçš„ã€‚å¯†åº¦ä¼°è®¡å°±æ˜¯æ ¹æ®æ•°æ®é›†<span class="math inline">\(\mathcal{D}\)</span>æ¥ä¼°è®¡å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°<span class="math inline">\(p_r(x)\)</span>ã€‚</p>
<p>å¦‚æœå°†ç”Ÿæˆæ¨¡å‹ç”¨äºç›‘ç£å­¦ä¹ ï¼Œé‚£ä¹ˆå°±æ˜¯è¾“å‡ºæ ‡ç­¾çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(y|x)\)</span>ï¼Œæ ¹æ®è´å¶æ–¯å…¬å¼ï¼š</p>
<p><span class="math display">\[p(y|x)=\frac{p(x,y)}{\sum_y p(x,y)}\]</span></p>
<p>é—®é¢˜å°±å˜ä¸ºäº†è”åˆæ¦‚ç‡<span class="math inline">\(p(x,y)\)</span>çš„å¯†åº¦ä¼°è®¡é—®é¢˜ã€‚</p>
<hr />
<p>æ ·æœ¬ç”Ÿæˆå³æ ¹æ®ç»™å®šçš„æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p_\theta(x)\)</span>ç”Ÿæˆä¸€äº›æœä»è¿™ä¸ªåˆ†å¸ƒçš„æ ·æœ¬ï¼Œå³é‡‡æ ·ã€‚åœ¨å«éšå˜é‡çš„ç”Ÿæˆæ¨¡å‹ä¸­ï¼Œç”Ÿæˆ<span class="math inline">\(x\)</span>çš„è¿‡ç¨‹ä¸€èˆ¬åŒ…å«ä¸¤æ­¥ï¼š</p>
<ol type="1">
<li>æ ¹æ®éšå˜é‡çš„åˆ†å¸ƒ<span class="math inline">\(p_\theta(z)\)</span>é‡‡æ ·å¾—åˆ°<span class="math inline">\(z\)</span>ï¼›</li>
<li>æ ¹æ®æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p_\theta(x|z;\theta)\)</span>è¿›è¡Œé‡‡æ ·å¾—åˆ°<span class="math inline">\(x\)</span>ã€‚</li>
</ol>
<p>æ‰€ä»¥åœ¨ç”Ÿæˆæ¨¡å‹ä¸­çš„é‡ç‚¹æ˜¯ä¼°è®¡æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>ã€‚</p>
<h1 id="parameter-estimation-for-hidden-variable-with-em-algorithm">Parameter Estimation for Hidden Variable with EM Algorithm</h1>
<p>å¦‚æœå›¾æ¨¡å‹ä¸­å­˜åœ¨éšå˜é‡ï¼Œå°±éœ€è¦ä½¿ç”¨EMç®—æ³•è¿›è¡Œå‚æ•°ä¼°è®¡ã€‚</p>
<p>åœ¨ä¸€ä¸ªåŒ…å«éšå˜é‡çš„å›¾æ¨¡å‹ä¸­ï¼Œä»¤<span class="math inline">\(\mathbf{X}\)</span>ä¸ºå¯è§‚æµ‹å˜é‡é›†åˆï¼Œ<span class="math inline">\(\mathbf{Z}\)</span>ä¸ºéšå˜é‡é›†åˆï¼Œåˆ™ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>çš„è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p>
<p><span class="math display">\[p(x;\theta)=\sum_z p(x,z;\theta)\]</span></p>
<p>ç»™å®šåŒ…å«<span class="math inline">\(N\)</span>ä¸ªè®­ç»ƒæ ·æœ¬çš„è®­ç»ƒé›†<span class="math inline">\(\mathcal{D}=\{x^{(n)}\},1\leq i\leq N\)</span>ï¼Œåˆ™è®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¸ºï¼š</p>
<p><span class="math display">\[\begin{align}\mathcal{L}(\mathcal{D};\theta)&amp;=\frac{1}{N}\sum_{n=1}^N \log p(x^{(n)};\theta)\\&amp;=\frac{1}{N}\sum_{n=1}^N \log \sum_z p(x^{(n)},z;\theta)\end{align}\]</span></p>
<hr />
<p>è¿™æ—¶ï¼Œåªè¦æœ€å¤§åŒ–æ•´ä¸ªè®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶<span class="math inline">\(\mathcal{L}(\mathcal{D};\theta)\)</span>ï¼Œå³å¯ä¼°è®¡å‡ºæœ€ä¼˜çš„å‚æ•°<span class="math inline">\(\theta^*\)</span>ã€‚ä¸è¿‡åœ¨è®¡ç®—æ¢¯åº¦çš„æ—¶å€™ï¼Œéœ€è¦åœ¨å¯¹æ•°å‡½æ•°å†…éƒ¨è¿›è¡Œæ±‚å’Œæˆ–ç§¯åˆ†è®¡ç®—ã€‚ä¸ºäº†æ›´å¥½çš„è®¡ç®—<span class="math inline">\(\log p(x;\theta)\)</span>ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªé¢å¤–çš„å˜åˆ†å‡½æ•°<span class="math inline">\(q(z)\)</span>ï¼Œ<span class="math inline">\(q(z)\)</span>ä¸ºå®šä¹‰åœ¨éšå˜é‡<span class="math inline">\(z\)</span>ä¸Šçš„åˆ†å¸ƒã€‚æ ·æœ¬<span class="math inline">\(x\)</span>çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p>
<p><span class="math display">\[\begin{align}\log p(x;\theta)&amp;=\log \sum_z q(z)\frac{p(x,z;\theta)}{q(z)}\\&amp;\geq\sum_z q(z)\log \frac{p(x,z;\theta)}{q(z)}\\&amp;\triangleq ELBO(q,x;\theta)\end{align}\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(ELBO(q,x;\theta)\)</span>ä¸ºå¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°<span class="math inline">\(\log p(x;\theta)\)</span>çš„ä¸‹ç•Œï¼Œç§°ä¸ºè¯æ®ä¸‹ç•Œã€‚å…¬å¼ä¸­ä½¿ç”¨äº†Jensenä¸ç­‰å¼(å³å¯¹äºå‡¹å‡½æ•°<span class="math inline">\(g\)</span>ï¼Œæœ‰<span class="math inline">\(g(\mathbb{E}[x])\geq\mathbb{E}[g(X)]\)</span>)ã€‚åœ¨è¿™é‡Œï¼Œ<span class="math inline">\(\frac{p(x,z;\theta)}{q(z)}\)</span>å¯è§†ä¸º<span class="math inline">\(q(z)\)</span>çš„å‡½æ•°ï¼Œè®°ä¸º<span class="math inline">\(f(q(z))\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(f(q(z))\)</span>çš„æœŸæœ›å³<span class="math inline">\(\mathbb{E}[f(q(z))]=\sum_z q(z)f(q(z))=\sum_z q(z)\frac{p(x,z;\theta)}{q(z)}\)</span>ã€‚è€Œæ ¹æ®Jensenä¸ç­‰å¼ï¼Œæœ‰<span class="math inline">\(g(\mathbb{E}[f(q(z))])\geq\mathbb{E}[g(f(q(z)))]\Leftrightarrow g(\sum_z q(z)\frac{p(x,z;\theta)}{q(z)})\geq \sum_z q(z)g(\frac{p(x,z;\theta)}{q(z)})\)</span>ï¼Œåœ¨è¿™é‡Œ<span class="math inline">\(g\)</span>å°±æ˜¯å¯¹æ•°å‡½æ•°ã€‚</p>
<hr />
<p>æ ¹æ®Jensenä¸ç­‰å¼å–ç­‰çš„æ¡ä»¶ï¼š<span class="math inline">\(\frac{p(x,z;\theta)}{q(z)}=c\)</span>ï¼Œ<span class="math inline">\(c\)</span>ä¸ºå¸¸æ•°ï¼Œæœ‰ï¼š</p>
<p><span class="math display">\[\begin{align}\sum_z p(x,z;\theta)&amp;=c\sum_z q(z)\\\Leftrightarrow\sum_z p(x,z;\theta)&amp;=c\cdot1\end{align}\]</span></p>
<p>å› æ­¤ï¼š</p>
<p><span class="math display">\[\begin{align}q(z)&amp;=\frac{p(x,z;\theta)}{\sum_z p(x,z;\theta)}\\&amp;=\frac{p(x,z;\theta)}{p(x;\theta)}\\&amp;=p(z|x;\theta)\end{align}\]</span></p>
<p>æ‰€ä»¥ï¼Œå½“ä¸”ä»…å½“<span class="math inline">\(q(z)=p(z|x;\theta)\)</span>æ—¶ï¼Œ<span class="math inline">\(\log p(x;\theta)=ELBO(q,x;\theta)\)</span>ã€‚</p>
<hr />
<p>äºæ˜¯æœ€å¤§åŒ–å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°<span class="math inline">\(\log p(x;\theta)\)</span>çš„è¿‡ç¨‹å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol type="1">
<li>å…ˆæ‰¾åˆ°è¿‘ä¼¼åˆ†å¸ƒ<span class="math inline">\(q(z)\)</span>ä½¿å¾—<span class="math inline">\(\log p(x;\theta)=ELBO(q,x;\theta)\)</span>ï¼›</li>
<li>å†å¯»æ‰¾å‚æ•°<span class="math inline">\(\theta\)</span>æœ€å¤§åŒ–<span class="math inline">\(ELBO(q,x;\theta)\)</span>ã€‚</li>
</ol>
<p>è¿™å°±æ˜¯æœŸæœ›æœ€å¤§åŒ–(Expectation-Maximum,EM)ç®—æ³•ã€‚</p>
<hr />
<p>EMç®—æ³•é€šè¿‡è¿­ä»£çš„æ–¹æ³•ï¼Œä¸æ–­é‡å¤ç›´åˆ°æ”¶æ•›åˆ°æŸä¸ªå±€éƒ¨æœ€ä¼˜è§£ã€‚åœ¨ç¬¬<span class="math inline">\(t\)</span>æ­¥æ›´æ–°æ—¶ï¼ŒEæ­¥å’ŒMæ­¥åˆ†åˆ«ä¸ºï¼š</p>
<ol type="1">
<li><p>Eæ­¥ï¼šå›ºå®šå‚æ•°<span class="math inline">\(\theta_t\)</span>ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆ†å¸ƒä½¿<span class="math inline">\(ELBO(q,x;\theta_t)\)</span>æœ€å¤§ï¼Œå³ç­‰äº<span class="math inline">\(\log p(x;\theta_t)\)</span>ï¼š<span class="math inline">\(q_{t+1}(z)=\text{arg}_q \max ELBO(q,x;\theta_t)\)</span>ï¼›</p></li>
<li><p>Mæ­¥ï¼šå›ºå®š<span class="math inline">\(q_{t+1}(z)\)</span>ï¼Œæ‰¾åˆ°ä¸€ç»„å‚æ•°ä½¿å¾—è¯æ®ä¸‹ç•Œæœ€å¤§ï¼Œå³ï¼š<span class="math inline">\(\theta_{t+1}=\text{arg}_\theta\max ELBO(q_{t+1},x;\theta)\)</span>ã€‚</p></li>
</ol>
<hr />
<p>å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ä¿¡æ¯è®ºçš„è§†è§’æ¥è¿›è¡Œåˆ†è§£ï¼š</p>
<p><span class="math display">\[\begin{align}\log p(x;\theta)&amp;=\sum_z q(z)\log p(x;\theta)\\&amp;=\sum_z q(z)(\log p(x,z;\theta)-\log p(z|x;\theta))\\&amp;=\sum_z q(z)\log\frac{p(x,z;\theta)}{q(z)}-\sum_z q(z)\log\frac{p(z|x;\theta)}{q(z)}\\&amp;=ELBO(q,x;\theta)+D_{KL}(q(z)\parallel p(z|x;\theta))\end{align}\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(D_{KL}(q(z)\parallel p(z|x;\theta))\)</span></p>
<h1 id="generative-model-with-hidden-variable">Generative Model with Hidden Variable</h1>
<p>å‡è®¾ä¸€ä¸ªç”Ÿæˆæ¨¡å‹åŒ…å«ä¸å¯è§‚æµ‹çš„éšå˜é‡ï¼Œå…¶ä¸­å¯è§‚æµ‹å˜é‡<span class="math inline">\(x\)</span>ä¸ºä¸€ä¸ªé«˜ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ï¼Œè€Œä¸å¯è§‚æµ‹çš„éšå˜é‡<span class="math inline">\(z\)</span>ä¸ºä¸€ä¸ªç›¸å¯¹ä½ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ã€‚</p>
<p>è¿™ä¸ªç”Ÿæˆæ¨¡å‹çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å¯ä»¥è¡¨è¾¾ä¸ºï¼š</p>
<p><span class="math display">\[p(x,z;\theta)=p(x|z;\theta)p(z;\theta)\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(p(z;\theta)\)</span>ä¸ºéšå˜é‡<span class="math inline">\(z\)</span>çš„å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒï¼›<span class="math inline">\(p(x|z;\theta)\)</span>ä¸ºå·²çŸ¥<span class="math inline">\(z\)</span>æ¡ä»¶ä¸‹<span class="math inline">\(x\)</span>çš„æ¦‚ç‡åˆ†å¸ƒã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾<span class="math inline">\(p(z;\theta)\)</span>å’Œ<span class="math inline">\(p(x|z;\theta)\)</span>æœä»æŸç§å¸¦å‚çš„åˆ†å¸ƒæ—ï¼Œå…¶å½¢å¼å·²çŸ¥ï¼Œè€Œå‚æ•°å¯ä»¥é€šè¿‡æœ€å¤§ä¼¼ç„¶æ¥è¿›è¡Œä¼°è®¡ã€‚</p>
<p>ç»™å®šä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œå…¶å¯¹æ•°è¾¹é™…ä¼¼ç„¶<span class="math inline">\(\log p(x;\theta)\)</span>å¯ä»¥åˆ†è§£ä¸ºï¼š</p>
<p><span class="math display">\[\log p(x;\theta)=ELBO(q,x;\theta,\phi)+D_{KL}(q(z;\phi)\parallel p(z|x;\theta))\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(q(z;\phi)\)</span>ä¸ºé¢å¤–å¼•å…¥çš„å˜åˆ†å¯†åº¦å‡½æ•°ï¼Œ<span class="math inline">\(ELBO(q,x;\theta,\phi)\)</span>ä¸ºè¯æ®ä¸‹ç•Œï¼š</p>
<p><span class="math display">\[ELBO(q,x;\theta,\phi)=\mathbb{E}_{z\sim q(z;\phi)}[\log{\frac{p(x,z;\theta)}{q(z;\phi)}}]\]</span></p>
<p>æœ€å¤§åŒ–<span class="math inline">\(\log p(x;\theta)\)</span>å¯ä»¥ç”¨EMç®—æ³•æ¥æ±‚è§£ï¼š</p>
<ul>
<li><strong>E-step:</strong> å¯»æ‰¾ä¸€ä¸ªå¯†åº¦å‡½æ•°<span class="math inline">\(q(z;\phi)\)</span>ä½¿å…¶ç­‰äºæˆ–æ¥è¿‘äºåéªŒå¯†åº¦å‡½æ•°<span class="math inline">\(p(z|x;\theta)\)</span>;</li>
<li><strong>M-step:</strong> ä¿æŒ<span class="math inline">\(q(z;\phi)\)</span>å›ºå®šï¼Œå¯»æ‰¾<span class="math inline">\(\theta\)</span>æ¥æœ€å¤§åŒ–<span class="math inline">\(ELBO(q,x;\theta,\phi)\)</span>ã€‚</li>
</ul>
<p>åœ¨EMç®—æ³•çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œç†è®ºä¸Šæœ€ä¼˜çš„<span class="math inline">\(q(z;\phi)\)</span>ä¸ºéšå˜é‡çš„åéªŒæ¦‚ç‡å¯†åº¦å‡½æ•°<span class="math inline">\(p(z|x;\theta)\)</span>ï¼š</p>
<p><span class="math display">\[p(z|x;\theta)=\frac{p(x|z;\theta)p(z;\theta)}{\int_z p(x|z;\theta)p(z;\theta)\text{d}z}\]</span></p>
<p>åéªŒå¯†åº¦å‡½æ•°<span class="math inline">\(p(z|x;\theta)\)</span>çš„è®¡ç®—æ˜¯ä¸€ä¸ªç»Ÿè®¡æ¨æ–­çš„é—®é¢˜ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹<span class="math inline">\(p(x|z;\theta)\)</span>ä¹Ÿæ¯”è¾ƒéš¾ä»¥è®¡ç®—ã€‚</p>
<h1 id="variational-autoencoder">Variational Autoencoder</h1>
<p>å˜åˆ†è‡ªç¼–ç å™¨(Variational Autoencoder, VAE)çš„ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥åˆ†åˆ«å»ºæ¨¡ä¸¤ä¸ªå¤æ‚çš„æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š</p>
<ol type="1">
<li>ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿå˜åˆ†åˆ†å¸ƒ<span class="math inline">\(q(z;\phi)\)</span>ï¼Œç§°ä¸ºæ¨æ–­ç½‘ç»œã€‚æ¨æ–­ç½‘ç»œçš„è¾“å…¥ä¸º<span class="math inline">\(x\)</span>ï¼Œè¾“å‡ºä¸ºå˜åˆ†åˆ†å¸ƒ<span class="math inline">\(q(z|x;\phi)\)</span>ï¼›</li>
<li>ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿæ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>ï¼Œç§°ä¸ºç”Ÿæˆç½‘ç»œã€‚ç”Ÿæˆç½‘ç»œçš„è¾“å…¥ä¸º<span class="math inline">\(z\)</span>ï¼Œè¾“å‡ºä¸ºæ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>ã€‚</li>
</ol>
<p><img src="http://qfxiao.me/img/autoencoder23849248011.png" /></p>
<p>VAEçš„å›¾æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565532060281.png" /></p>
<h2 id="variational-network">Variational Network</h2>
<p>å‡è®¾<span class="math inline">\(q(z|x;\phi)\)</span>æ˜¯æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼š</p>
<p><span class="math display">\[q(z|x;\phi)=\mathcal{N}(z;\mu_I,\sigma^2_I I)\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\mu_I\)</span>å’Œ<span class="math inline">\(\sigma_I^2\)</span>æ˜¯é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ï¼Œå¯ä»¥é€šè¿‡æ¨æ–­ç½‘ç»œ<span class="math inline">\(f_I(x;\phi)\)</span>æ¥é¢„æµ‹ï¼š</p>
<p><span class="math display">\[
\left[\begin{matrix}\mu_I\\\sigma_I\end{matrix}\right]=f_I(x;\phi)
\]</span> æ¨æ–­ç½‘ç»œ<span class="math inline">\(f_I(x;\phi)\)</span>å¯ä»¥æ˜¯ä¸€èˆ¬çš„å…¨è¿æ¥ç½‘ç»œæˆ–å·ç§¯ç½‘ç»œï¼Œæ¯”å¦‚ä¸€ä¸ªä¸¤å±‚çš„ç¥ç»ç½‘ç»œï¼š</p>
<p><span class="math display">\[\begin{align}h&amp;=\sigma(W^{(1)}x+b^{(1)})\\\mu_I&amp;=W^{(2)}h+b^{(2)}\\\sigma_I&amp;=\text{softplus}(W^{(3)}h+b^{(3)})\end{align}\]</span></p>
<p>å…¶ä¸­æ‰€æœ‰ç½‘ç»œå‚æ•°<span class="math inline">\(\{W^{(1)},W^{(2)},W^{(3)},b^{(1)},b^{(2)},b^{(3)}\}\)</span>å³å¯¹åº”äº†å˜åˆ†å‚æ•°<span class="math inline">\(\phi\)</span>ã€‚</p>
<hr />
<p>æ¨æ–­ç½‘ç»œçš„ç›®æ ‡æ˜¯ä½¿å¾—<span class="math inline">\(q(z|x;\phi)\)</span>æ¥å°½å¯èƒ½æ¥è¿‘çœŸå®çš„åéªŒ<span class="math inline">\(p(z|x;\theta)\)</span>ï¼Œéœ€è¦æ‰¾åˆ°å˜åˆ†å‚æ•°<span class="math inline">\(\phi^*\)</span>æ¥æœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„KLæ•£åº¦ï¼š</p>
<p><span class="math display">\[\phi^*=\text{arg}_\phi\min{D_{KL}(q(z|x;\phi)\parallel p(z|x;\theta))}\]</span></p>
<p>ç”±äº<span class="math inline">\(p(z|x;\theta)\)</span>æœªçŸ¥ï¼Œæ•…KLæ•£åº¦æ— æ³•ç›´æ¥è®¡ç®—ï¼Œä¸è¿‡ç”±äº<span class="math inline">\(D_{KL}(q(z|x;\phi)\parallel p(z|x;\theta))=\log p(x;\theta)-ELBO(q,x;\theta,\phi)\)</span>ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œï¼Œæœ‰ï¼š</p>
<p><span class="math display">\[\phi^*=\text{arg}_\phi\max{ELBO(q,x;\theta,\phi)}\]</span></p>
<h2 id="generative-network">Generative Network</h2>
<p>ç”Ÿæˆæ¨¡å‹çš„è”åˆåˆ†å¸ƒå¯ä»¥åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†ï¼šéšå˜é‡<span class="math inline">\(z\)</span>çš„å…ˆéªŒåˆ†å¸ƒ<span class="math inline">\(p(z;\theta)\)</span>å’Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>ã€‚ä¸ºç®€å•èµ·è§ï¼Œä¸€èˆ¬å‡è®¾éšå˜é‡<span class="math inline">\(z\)</span>çš„å…ˆéªŒåˆ†å¸ƒä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(z|0,I)\)</span>ï¼Œéšå˜é‡æ¯ä¸€ç»´ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>å¯ä»¥é€šè¿‡ç”Ÿæˆç½‘ç»œæ¥å»ºæ¨¡ï¼Œæˆ‘ä»¬åŒæ ·ç”¨å‚æ•°åŒ–çš„åˆ†å¸ƒæ—æ¥è¡¨ç¤ºæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x|z;\theta)\)</span>ï¼Œè¿™äº›åˆ†å¸ƒæ—çš„å‡½æ•°å¯ä»¥ç”¨ç”Ÿæˆç½‘ç»œè®¡ç®—å¾—åˆ°ã€‚æ ¹æ®å˜é‡<span class="math inline">\(x\)</span>çš„ç±»å‹ä¸åŒï¼Œå¯ä»¥å‡è®¾<span class="math inline">\(p(x|z;\theta)\)</span>æœä»ä¸åŒçš„åˆ†å¸ƒæ—ã€‚å¦‚æœ<span class="math inline">\(x\in\{0,1\}^d\)</span>æ˜¯<span class="math inline">\(d\)</span>ç»´çš„äºŒå€¼å‘é‡ï¼Œå¯ä»¥å‡è®¾<span class="math inline">\(\log p(x|z;\theta)\)</span>æœä»å¤šå˜é‡çš„ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œå³ï¼š</p>
<p><span class="math display">\[\begin{align}p(x|z;\theta)&amp;=\prod\limits_{i=1}^d p(x_i|z;\theta)\\&amp;=\prod\limits_{i=1}^d \gamma_i^{x_i}(1-\gamma_i)^{(1-x_i)}\end{align}\]</span></p>
<p>å¦‚æœ<span class="math inline">\(x\in\mathbb{R}^d\)</span>æ˜¯<span class="math inline">\(d\)</span>ç»´çš„è¿ç»­å‘é‡ï¼Œå¯ä»¥å‡è®¾<span class="math inline">\(p(x|z;\theta)\)</span>æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼Œå³ï¼š</p>
<p><span class="math display">\[p(x|z;\theta)=\mathcal{N}(x;\mu_G,\sigma_G^2 I)\]</span></p>
<hr />
<p>ç”Ÿæˆç½‘ç»œçš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ç»„<span class="math inline">\(\theta^*\)</span>æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œ<span class="math inline">\(ELBO(q,x;\theta,\phi)\)</span>ï¼š</p>
<p><span class="math display">\[\theta^*=\text{arg}_\theta\max ELBO(q,x;\theta,\phi)\]</span></p>
<h2 id="model-combination">Model Combination</h2>
<p>æ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œçš„ç›®æ ‡éƒ½æ˜¯æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œå› æ­¤æ€»çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p>
<p><span class="math display">\[\begin{align}\max_{\theta,\phi}ELBO(q,x;\theta,\phi)&amp;=\max_{\theta,\phi}\mathbb{E}_{z\sim q(z;\phi)}[\log\frac{p(x|z;\theta)p(z;\theta)}{q(z;\theta)}]\\&amp;=\max_{\theta,\phi}\mathbb{E}_{z\sim q(z|x;\phi)}[\log p(x|z;\theta)]-D_{KL}(q(z|x;\phi)\parallel p(z;\theta))\end{align}\]</span></p>
<p>å…¶ä¸­å…ˆéªŒåˆ†å¸ƒ<span class="math inline">\(p(z;\theta)=\mathcal{N}(z|0,I)\)</span>ã€‚</p>
<p>å…¬å¼ä¸­<span class="math inline">\(\mathbb{E}_{z\sim q(z|x;\phi)}[\log p(x|z;\theta)]\)</span>ä¸€èˆ¬é€šè¿‡é‡‡æ ·çš„æ–¹å¼è¿›è¡Œè®¡ç®—ï¼Œæœ€åå–å¹³å‡å€¼ã€‚</p>
<h2 id="model-training">Model Training</h2>
<p>ç»™å®šæ•°æ®é›†<span class="math inline">\(\mathcal{D}\)</span>ï¼ŒåŒ…å«<span class="math inline">\(N\)</span>ä¸ªä»æœªçŸ¥æ•°æ®åˆ†å¸ƒä¸­æŠ½å–çš„ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬<span class="math inline">\(x^{(1)},x^{(2)},\cdots,x^{(N)}\)</span>ã€‚å˜åˆ†è‡ªç¼–ç å™¨çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p>
<p><span class="math display">\[\mathcal{J}(\phi,\theta|\mathcal{D})=\sum\limits_{n=1}^N(\frac{1}{M}\sum\limits_{m=1}^M\log p(x^{(n)}|z^{(n,m)};\theta)-D_{KL}(q(z|x^{(n)};\phi)\parallel\mathcal{N}(z;0,I)))\]</span></p>
<p>å¦‚æœé‡‡ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œæ¯æ¬¡ä»æ•°æ®é›†ä¸­é‡‡ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œç„¶åæ ¹æ®<span class="math inline">\(q(z|x;\phi)\)</span>é‡‡ä¸€ä¸ªéšå˜é‡<span class="math inline">\(z\)</span>ï¼Œåˆ™ç›®æ ‡å‡½æ•°å˜ä¸ºï¼š</p>
<p><span class="math display">\[\mathcal{J}(\phi,\theta|x)=\log p(x|z;\theta)-D_{KL}(q(z|x;\phi)\parallel\mathcal{N}(z;0,I))\]</span></p>
<p>å‡è®¾<span class="math inline">\(q(z|x;\phi)\)</span>æ˜¯æ­£æ€åˆ†å¸ƒï¼ŒKLæ•£åº¦å¯ç›´æ¥ç®—å‡ºï¼š</p>
<p><span class="math display">\[D_{KL}(\mathcal{N}(\mu_1,\Sigma_1)\parallel\mathcal(\mu_2,\Sigma_2))\\=\frac{1}{2}(\text{tr}(\sigma_I^2 I)+\mu_I^T\mu_I-d-\log(|\sigma_I^2 I|))\]</span></p>
<hr />
<p>å†å‚æ•°åŒ–æ˜¯å°†ä¸€ä¸ªå‚æ•°ä¸º<span class="math inline">\(u\)</span>çš„å‡½æ•°<span class="math inline">\(f(u)\)</span>ï¼Œé€šè¿‡ä¸€ä¸ªå‡½æ•°<span class="math inline">\(u=g(v)\)</span>ï¼Œè½¬æ¢ä¸ºå‚æ•°ä¸º<span class="math inline">\(v\)</span>çš„å‡½æ•°<span class="math inline">\(\hat{f}(v)=f(g(v))\)</span>ã€‚åœ¨å˜åˆ†è‡ªç¼–ç å™¨ä¸­ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ±‚éšæœºå˜é‡<span class="math inline">\(z\)</span>å…³äº<span class="math inline">\(\phi\)</span>çš„å¯¼æ•°ã€‚ä½†ç”±äºæ˜¯é‡‡æ ·çš„æ–¹å¼ï¼Œæ— æ³•ç›´æ¥åˆ»ç”»<span class="math inline">\(z\)</span>å’Œ<span class="math inline">\(\phi\)</span>ä¹‹é—´çš„å‡½æ•°å…³ç³»ï¼Œå› æ­¤ä¹Ÿæ— æ³•è®¡ç®—å¯¼æ•°ã€‚</p>
<p>å¦‚æœ<span class="math inline">\(z\sim q(z|x;\phi)\)</span>çš„éšæœºæ€§ç‹¬ç«‹äºå‚æ•°<span class="math inline">\(\phi\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å†å‚æ•°åŒ–çš„æ–¹æ³•æ¥è®¡ç®—å¯¼æ•°ã€‚å‡è®¾<span class="math inline">\(q(z|x;\phi)\)</span>ä¸ºæ­£æ€åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(\mu_I,\sigma^2_I I)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mu_I\)</span>å’Œ<span class="math inline">\(\sigma_I\)</span>æ˜¯æ¨æ–­ç½‘ç»œ<span class="math inline">\(f_I(x;\phi)\)</span>çš„è¾“å‡ºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼é‡‡æ ·<span class="math inline">\(z\)</span>ï¼š</p>
<p><span class="math display">\[z=\mu_I+\sigma_I\odot \varepsilon\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\varepsilon\sim\mathcal{N}(0,I)\)</span>ã€‚è¿™æ ·<span class="math inline">\(z\)</span>å’Œ<span class="math inline">\(\mu_I,\sigma_I\)</span>çš„å…³ç³»ä»é‡‡æ ·å…³ç³»å˜ä¸ºå‡½æ•°å…³ç³»ã€‚</p>
<hr />
<p>å¦‚æœè¿›ä¸€æ­¥å‡è®¾<span class="math inline">\(p(x|z;\theta)\)</span>æœä»é«˜æ–¯åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(x|\mu_G,I)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mu_G=f_G(z;\theta)\)</span>æ˜¯ç”Ÿæˆç½‘ç»œçš„è¾“å‡ºï¼Œåˆ™ç›®æ ‡å‡½æ•°å¯ä»¥ç®€åŒ–ä¸ºï¼š</p>
<p><span class="math display">\[\mathcal{J}(\phi,\theta|x)=-\parallel x-\mu_G\parallel^2+D_{KL}(\mathcal{N}(\mu_I,\sigma_I)\parallel\mathcal{N}(0,I))\]</span></p>
<p>å…¶ä¸­ç¬¬ä¸€é¡¹å¯ä»¥è¿‘ä¼¼çœ‹ä½œæ˜¯è¾“å…¥<span class="math inline">\(x\)</span>çš„é‡æ„æ­£ç¡®æ€§ï¼Œç¬¬äºŒé¡¹å¯ä»¥çœ‹ä½œæ˜¯æ­£åˆ™åŒ–é¡¹ã€‚</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/"><img class="thumbnail" src="http://qfxiao.me/img/1571411043958.png" alt="Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-18T15:00:57.000Z" title="2019-10-18T15:00:57.000Z">2019-10-18</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">25 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 3813 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/">Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network</a></h1><div class="content"><h1 id="abstract">Abstract</h1>
<p>æœ¬æ–‡æå‡ºäº†<em>OmniAnomaly</em>ï¼šä¸€ç§é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—çš„éšæœºå¾ªç¯ç¥ç»ç½‘ç»œå¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚è¯¥æ¨¡å‹è¿ç”¨äº†ä¸€ç³»åˆ—æŠ€æœ¯æ¥æ•æ‰å¤šå˜é‡æ—¶é—´åºåˆ—çš„æ­£å¸¸æ¨¡å¼ï¼Œå¹¶åœ¨æ£€æµ‹é˜¶æ®µåŸºäºé‡æ„è¯¯å·®æ¥æ£€æµ‹å¼‚å¸¸ï¼ŒåŒæ—¶æœ¬æ–‡è¿˜æä¾›äº†ä¸€å®šçš„ç†è®ºè§£é‡Šã€‚</p>
<p><a href="https://www.kdd.org/kdd2019/accepted-papers/view/robust-anomaly-detection-for-multivariate-time-series-through-stochastic-re">åŸæ–‡</a></p>
<h1 id="contribution">Contribution</h1>
<ol type="1">
<li>æå‡ºäº†<em>OmniAnomaly</em>ï¼Œä¸€ç§åŸºäºéšæœºå¾ªç¯ç¥ç»ç½‘ç»œçš„å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼›</li>
<li>æå‡ºäº†é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„è§£é‡Šæ–¹æ³•ï¼›</li>
<li>é€šè¿‡å®éªŒè¯æ˜äº†<em>OmniAnomaly</em>ä¸­æ‰€ç”¨çš„å…³é”®æŠ€æœ¯çš„æœ‰æ•ˆæ€§ï¼ŒåŒ…æ‹¬GRUï¼Œplanar NF, stochastic variable connectionå’Œadjusted Peaks-Over-Threshold methodï¼›</li>
<li>é€šè¿‡å¤§é‡çš„å®éªŒæˆ‘ä»¬è¯æ˜äº†<em>OmniAnomaly</em>çš„æœ‰æ•ˆæ€§ï¼›</li>
<li>å‘å¸ƒäº†ä»£ç å’Œæ•°æ®é›†ã€‚</li>
</ol>
<h1 id="background">Background</h1>
<h2 id="linear-gaussian-state-space-model">Linear Gaussian State Space Model</h2>
<p>çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆState Space Model, SSMï¼‰çš„æ¦‚å¿µæ¥è‡ªäºæ§åˆ¶ç†è®ºï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®¨è®ºå…¶åœ¨æ—¶é—´åºåˆ—ä¸­çš„åº”ç”¨ã€‚å…¶å¤§æ¦‚æ€æƒ³æ˜¯æˆ‘ä»¬è®¤ä¸ºæ—¶é—´åºåˆ—åœ¨æ—¶åˆ»<span class="math inline">\(t\)</span>çš„è§‚æµ‹å€¼<span class="math inline">\(z_t\)</span>æ˜¯ä¸€ä¸ªéšå«çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_t\)</span>çš„æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p(z_t|\boldsymbol{l}_t)\)</span>ï¼Œè€Œè¿™ä¸ªéšå«çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_t\)</span>åˆ»ç”»äº†æ—¶é—´åºåˆ—çš„å†…åœ¨è§„å¾‹ï¼ŒåŒæ—¶éšå«çŠ¶æ€ä¼šéšç€æ—¶é—´æ›´æ–°ï¼Œå³æœä»æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p(\boldsymbol{l}_t|\boldsymbol{l}_{t-1})\)</span>ã€‚</p>
<p>åœ¨çº¿æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆLinear State Space Modelï¼‰ä¸­æˆ‘ä»¬ä»¥å¦‚ä¸‹çš„æ–¹å¼åˆ»ç”»éšå«çŠ¶æ€çš„æ›´æ–°ï¼š <span class="math display">\[
\boldsymbol{l}_t=\boldsymbol{F}_t\boldsymbol{l}_{t-1}+\boldsymbol{g}_t\varepsilon_t, \space\space\space\varepsilon_t\sim\mathcal{N}(0,1)
\]</span> <span class="math inline">\(\boldsymbol{F}_t\)</span>ä¸ºç¡®å®šçš„çŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œè€Œ<span class="math inline">\(\boldsymbol{g}_t\varepsilon_t\)</span>åˆ™è¡¨ç¤ºäº†çŠ¶æ€è½¬ç§»çš„éšæœºæ€§ã€‚</p>
<p>è§‚æµ‹å€¼<span class="math inline">\(z_t\)</span>ä»éšå«çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_t\)</span>è®¡ç®—è€Œæ¥ï¼š <span class="math display">\[
\begin{align}
z_t&amp;=y_t+\sigma_t\epsilon_t,\\
y_t&amp;=\boldsymbol{a}_t^\top\boldsymbol{l}_{t-1}+b_t,\\
\epsilon_t&amp;\sim\mathcal{N}(0,1)
\end{align}
\]</span> å…¶ä¸­<span class="math inline">\(\boldsymbol{a}_t\in\mathbb{R}^L,\sigma_t\in \mathbb{R},b_t\in\mathbb{R}\)</span>éƒ½æ˜¯é¢å¤–çš„å‚æ•°ã€‚åˆå§‹çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_0\)</span>åˆ™ä»ä¸€ä¸ªç‹¬ç«‹çš„é«˜æ–¯åˆ†å¸ƒå¾—æ¥ï¼Œå³<span class="math inline">\(\boldsymbol{l}_0\sim N(\boldsymbol\mu_0,\text{diag}(\boldsymbol{\sigma}_0^2))\)</span>ã€‚</p>
<p>ä»¤å‚æ•°é›†åˆ<span class="math inline">\(\Theta_t=(\boldsymbol{\mu}_0,\boldsymbol{\Sigma}_0,\boldsymbol{F}_t,\boldsymbol{g}_t,\boldsymbol{a}_t,b_t,\sigma_t),\forall t&gt;0\)</span>ï¼Œä¸€èˆ¬æ¥è¯´å‚æ•°é›†åˆä¸ä¼šéšç€æ—¶é—´å˜åŒ–ï¼Œå³æ¯ä¸ªæ—¶åˆ»<span class="math inline">\(t\)</span>å…±äº«åŒæ ·çš„å‚æ•°<span class="math inline">\(\Theta_t=\Theta,\forall t&gt;0\)</span>ã€‚å¯¹å‚æ•°çš„ä¼°è®¡å¯ä»¥é‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ï¼š <span class="math display">\[
\begin{align}
\Theta^*_{1:T}&amp;=\arg\max_{\Theta_{1:T}}p(z_{1:T}|\Theta_{1:T}),\\
\end{align}
\]</span> å…¶ä¸­ï¼š <span class="math display">\[
\begin{align}
p(z_{1:T}|\Theta_{1:T})&amp;=p(z_1|\Theta_1)\prod\limits_{t=2}^T p(z_t|z_{1:t-1},\Theta_{1:t})\\
&amp;=\int p(\boldsymbol{l}_0)\left[\prod\limits_{t=1}^T p(z_t|\boldsymbol{l}_t)p(\boldsymbol{l}_t|\boldsymbol{l}_{t-1})\right]\mathrm{d}\boldsymbol{l}_{0:T}
\end{align}
\]</span></p>
<h2 id="planar-normalizing-flow">Planar Normalizing Flow</h2>
<h3 id="normalizing-flows">Normalizing Flows</h3>
<p>VAEé‡‡ç”¨ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ<span class="math inline">\(q_\phi(z|x)\)</span>æ¥è¿‘ä¼¼çœŸå®çš„åéªŒåˆ†å¸ƒ<span class="math inline">\(p(z|x)\)</span>ï¼Œå¹¶æ¨å¯¼å‡º<span class="math inline">\(\log p_\theta(x)\)</span>çš„ä¸‹ç•Œï¼ˆç§°ä¸ºELBOï¼‰æ¥ä½œä¸ºä¼˜åŒ–ç›®æ ‡å‡½æ•°ï¼š <span class="math display">\[
\begin{align}
\log p_\theta(x)&amp;=\log \int p_\theta(x|z)p(z)\mathrm{d}z\\
&amp;=\log\int\frac{q_\phi(z|x)}{q_\phi(z|x)}p_\theta(x|z)p(z)\mathrm{d}z\\
&amp;\geq-D_{KL}[q_\phi(z|x)\parallel p(z)]+\mathbb{E}_q[\log p_\theta(x|z)]
\end{align}
\]</span> <span class="math inline">\(\log p_\theta(x)\)</span>ä¸ELBOå–ç­‰çš„æ¡ä»¶æ˜¯<span class="math inline">\(D_{KL}[q_\phi(z|x)\parallel p(z)]\)</span>ï¼Œè¡¨æ˜å˜åˆ†åˆ†å¸ƒå®Œå…¨åŒ¹é…äº†çœŸå®çš„åéªŒåˆ†å¸ƒã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒçœŸå®çš„åéªŒåˆ†å¸ƒå¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œè€Œæˆ‘ä»¬çš„å˜åˆ†åˆ†å¸ƒé€šå¸¸æ˜¯ä¸€ä¸ªç¡®å®šçš„è¾ƒä¸ºç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚è¿™æ ·å˜åˆ†åˆ†å¸ƒå¯èƒ½å¾ˆéš¾å¯¹çœŸå®åéªŒåˆ†å¸ƒå¾—åˆ°ä¸€ä¸ªå¾ˆå¥½çš„æ‹Ÿåˆã€‚</p>
<p>ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ ‡å‡†åŒ–æµï¼ˆNormalizing Flowsï¼‰ã€‚æ ‡å‡†åŒ–æµæ˜¯ä»ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒå‡ºå‘ï¼Œæ‰§è¡Œä¸€ç³»åˆ—å¯é€†çš„æ˜ å°„ï¼Œå°†åŸå§‹ç®€å•çš„åˆ†å¸ƒè½¬åŒ–ä¸ºä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒã€‚</p>
<p>é¦–å…ˆè€ƒè™‘ä¸€ä¸ªå…‰æ»‘çš„ã€å¯é€†çš„æ˜ å°„<span class="math inline">\(f:\mathbb{R}^d\mapsto \mathbb{R}^d\)</span>ï¼Œè®°<span class="math inline">\(g=f^{-1}\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(g\circ f(\mathbf{z})=\mathbf{z}\)</span>ã€‚ä»¤<span class="math inline">\(\mathbf{z}^\prime=f(\mathbf{z})\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(\mathbf{z}^\prime\)</span>çš„åˆ†å¸ƒä¸ºï¼š <span class="math display">\[
q(\mathbf{z}^\prime)=q(\mathbf{z})\left|\text{det}\frac{\partial f^{-1}}{\partial \mathbf{z}^\prime}\right|=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}
\]</span> å¼ä¸­<span class="math inline">\(q(\mathbf{z}^\prime)=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}\)</span>è¯´æ˜äº†<span class="math inline">\(\mathbf{z}^\prime\)</span>çš„åˆ†å¸ƒç­‰äº<span class="math inline">\(\mathbf{z}\)</span>çš„åˆ†å¸ƒä¹˜ä¸Š<span class="math inline">\(f\)</span>çš„JacobiançŸ©é˜µçš„è¡Œåˆ—å¼çš„å€’æ•°ã€‚é‚£ä¹ˆå¯¹äºæ˜ å°„å¤šæ¬¡çš„æƒ…å†µï¼š <span class="math display">\[
\mathbf{z}_K=f_K\circ\cdots\circ f_2\circ f_1(\mathbf{z}_0)
\]</span> <span class="math inline">\(\mathbf{z}_K\)</span>çš„åˆ†å¸ƒå¯ä»¥é€šè¿‡é“¾å¼è®¡ç®—å¾—åˆ°ï¼š <span class="math display">\[
\ln q_K(\mathbf{z}_K)=\ln q_0(\mathbf{z}_0)-\sum\limits_{k=1}^K\ln\left|\text{det}\frac{\partial f_k}{\partial \mathbf{z}_{k-1}}\right|
\]</span></p>
<h3 id="planar-flows">Planar Flows</h3>
<p>è€ƒè™‘ä¸€ä¸ªå˜æ¢æ—ï¼š <span class="math display">\[
f(\mathbf{z})=\mathbf{z}+\mathbf{u}h(\mathbf{w}^\top\mathbf{z}+b)
\]</span> å…¶ä¸­<span class="math inline">\(\lambda=\{\mathbf{w}\in \mathbb{R}^d,\mathbf{u}\in\mathbb{R}^d,b\in\mathbb{R}\}\)</span>ä¸ºå‚æ•°é›†åˆï¼Œ<span class="math inline">\(h(\cdot)\)</span>ä¸ºå…ƒç´ çº§çš„éçº¿æ€§å‡½æ•°ï¼ˆå¦‚å„ç§æ¿€æ´»å‡½æ•°ï¼‰ã€‚ä»¤<span class="math inline">\(\psi(\mathbf{z})=h^\prime(\mathbf{w}^\top\mathbf{z}+b)\mathbf{w}\)</span>ï¼Œåˆ™<span class="math inline">\(f\)</span>çš„JacobiançŸ©é˜µè¡Œåˆ—å¼ç»å¯¹å€¼ç­‰äºï¼š <span class="math display">\[
\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|=\left|\text{det}(\mathbf{I}+\mathbf{u}\psi(\mathbf{z})^\top)\right|=\left|1+\mathbf{u}^\top\psi(\mathbf{z})\right|
\]</span> ä½†æ˜¯<span class="math inline">\(f\)</span>å¹¶ä¸ä¿è¯æ€»æ˜¯å¯é€†çš„ï¼Œå¦‚<span class="math inline">\(h(x)=\tanh(x)\)</span>æ—¶ï¼Œ<span class="math inline">\(f\)</span>å¯é€†çš„æ¡ä»¶æ˜¯<span class="math inline">\(\mathbf{w}^\top \mathbf{u}\geq-1\)</span>ã€‚</p>
<p>ä¸‹é¢è®¨è®ºå¦‚ä½•ä¿è¯å¯é€†çš„æ¡ä»¶ã€‚è€ƒè™‘å°†<span class="math inline">\(\mathbf{z}\)</span>åˆ†è§£ä¸º<span class="math inline">\(\mathbf{z}=\mathbf{z}_\bot+\mathbf{z}_\parallel\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{z}_\bot\)</span>ä¸<span class="math inline">\(\mathbf{w}\)</span>æ­£äº¤ï¼Œ<span class="math inline">\(\mathbf{z}_\parallel\)</span>ä¸<span class="math inline">\(\mathbf{w}\)</span>å¹³è¡Œï¼Œé‚£ä¹ˆï¼š <span class="math display">\[
f(z)=\mathbf{z}_\bot+\mathbf{z}_\parallel+\mathbf{u}h(\mathbf{w}^\top \mathbf{z}_\parallel +b)
\]</span> å®é™…ä¸Šå¾—åˆ°<span class="math inline">\(\mathbf{z}_\parallel\)</span>ä¹‹åå¯ä»¥å¾ˆå®¹æ˜“çš„å¾—åˆ°<span class="math inline">\(\mathbf{z}_\bot\)</span>ï¼Œä»¤<span class="math inline">\(\mathbf{y}=f(\mathbf{z})\)</span>ï¼Œæœ‰ï¼š <span class="math display">\[
\mathbf{z}_\bot=\mathbf{y}-\mathbf{z}_\parallel-\mathbf{u}h(\mathbf{w}^\top\mathbf{z}_\parallel+b)
\]</span> è€Œ<span class="math inline">\(\mathbf{z}_\parallel\)</span>ä¸<span class="math inline">\(\mathbf{w}\)</span>å¹³è¡Œï¼Œæ˜“çŸ¥<span class="math inline">\(\mathbf{z}_\parallel=\alpha\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\alpha\in\mathbb{R}\)</span>ã€‚</p>
<p>å¯¹å¼(16)ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥<span class="math inline">\(\mathbf{w}^\top\)</span>å¯å¾—ï¼š <span class="math display">\[
\mathbf{w}^\top f(\mathbf{z})=\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)
\]</span> å½“<span class="math inline">\(\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)\)</span>å¯¹äº<span class="math inline">\(\alpha\)</span>æ˜¯éé€’å‡å‡½æ•°çš„æ—¶å€™ï¼Œ<span class="math inline">\(f\)</span>æ˜¯å¯é€†çš„ã€‚å› ä¸º<span class="math inline">\(\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)\)</span>æ˜¯éé€’å‡å‡½æ•°æ—¶æœ‰<span class="math inline">\(1+\mathbf{w}^\top\mathbf{u}h^\prime(\alpha+b)\geq 0\equiv \mathbf{w}^\top \mathbf{u}\geq -\frac{1}{h^\prime(\alpha + b)}\)</span>ï¼Œè€Œ<span class="math inline">\(0\leq h^\prime(\alpha + b) \leq 1\)</span>ï¼ˆ<span class="math inline">\(\tanh\)</span>å‡½æ•°çš„æ€§è´¨ï¼‰ï¼Œæ‰€ä»¥æ€»æ˜¯æœ‰<span class="math inline">\(\mathbf{w}^\top \mathbf{u}\geq-1\)</span>ã€‚</p>
<p>å¯¹äºä»»æ„ä¸€ä¸ª<span class="math inline">\(\mathbf{u}\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ–¹å¼æ„é€ ä¸€ä¸ª<span class="math inline">\(\hat{\mathbf{u}}\)</span>ä½¿å¾—<span class="math inline">\(\mathbf{w}^\top\hat{\mathbf{u}}&gt;-1\)</span>ï¼Œå³ä»¤<span class="math inline">\(\hat{\mathbf{u}}(\mathbf{w},\mathbf{u})=\mathbf{u}+[m(\mathbf{w}^\top\mathbf{u})-(\mathbf{w}^\top\mathbf{u})]\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(m(x)=-1+\log(1+e^x)\)</span>ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20191031162515819.png" /></p>
<h1 id="methodology">Methodology</h1>
<h2 id="problem-statement">Problem Statement</h2>
<p>æœ¬æ–‡é’ˆå¯¹çš„æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—<span class="math inline">\(x=\{x_1,x_2,\cdots,x_N\}\in R^{M\times N}\)</span>ï¼Œ<span class="math inline">\(N\)</span>ä¸ºæ—¶é—´é•¿åº¦ï¼Œå…¶ä¸­æŸä¸€æ—¶åˆ»çš„è§‚æµ‹å€¼<span class="math inline">\(x_t\in R^M\)</span>ä¸ºä¸€ä¸ª<span class="math inline">\(M\)</span>ç»´çš„å‘é‡ã€‚ä½œè€…ä½¿ç”¨<span class="math inline">\(x_{t-T:t}\in R^{M\times(T+1)}\)</span>æ¥è¡¨ç¤º<span class="math inline">\(t-T\)</span>åˆ°<span class="math inline">\(t\)</span>ä¹‹é—´çš„æ—¶é—´åºåˆ—ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20191024112404542.png" /></p>
<h2 id="overall-structure">Overall Structure</h2>
<p>ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571411043958.png" /></p>
<p>é¢„å¤„ç†æ¨¡å—ä¸»è¦æ˜¯å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ä»¥åŠçª—å£åˆ‡åˆ†ã€‚è®­ç»ƒæ¨¡å—åˆ™æ ¹æ®è¾“å…¥çš„æ•°æ®å¯¹æ­£å¸¸æ¨¡å¼è¿›è¡Œæ•æ‰ï¼Œè¾“å‡ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨çº¿æ£€æµ‹æ¨¡å—åˆ™ä¼šå®šæœŸæ‰§è¡Œã€‚</p>
<h2 id="network-architecture">Network Architecture</h2>
<p>æ¨¡å‹çš„æ€»ä½“ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571411093161.png" /></p>
<p>åœ¨qnetä¸­ï¼Œé¦–å…ˆGRUè¢«ç”¨æ¥å»ºæ¨¡æ ·æœ¬çš„æ—¶é—´ä¾èµ–å…³ç³»ï¼Œä¹‹åVAEå°†æ ·æœ¬<span class="math inline">\(\mathbf{x}\)</span>æ˜ å°„åˆ°éšç©ºé—´<span class="math inline">\(\mathbf{z}\)</span>ã€‚æ–‡ä¸­ä½¿ç”¨äº†Linear Gaussian State Space Modelæ¥å»ºæ¨¡éšå˜é‡ä¹‹é—´çš„æ—¶é—´ä¾èµ–å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜ä½¿ç”¨äº†Planar Normalizing Flowæ¥å°†éšå˜é‡æ˜ å°„åˆ°å¤æ‚çš„éé«˜æ–¯åˆ†å¸ƒã€‚åœ¨pnetä¸­ï¼Œéšå˜é‡<span class="math inline">\(\mathbf{z}_{t-T:t}\)</span>è¢«ç”¨æ¥é‡å»º<span class="math inline">\(\mathbf{x}_{t-T:t}\)</span>ï¼Œç›´è§‚ä¸Šæ¥è¯´ï¼Œå¯¹æ ·æœ¬çš„å¥½çš„éšå˜é‡è¡¨ç¤ºå¯ä»¥å¸¦æ¥æ›´å¥½çš„é‡æ„æ•ˆæœã€‚</p>
<p>ä»ç»†èŠ‚ä¸Šæ¥è¯´ï¼Œåœ¨æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œqnetçš„è¾“å…¥ä¸º<span class="math inline">\(\mathbf{x}_t\)</span>å’Œ<span class="math inline">\(\mathbf{e}_{t-1}\)</span>ï¼Œä¸¤è€…ç»è¿‡GRU Cellä¹‹åä¼šäº§ç”Ÿ<span class="math inline">\(t\)</span>æ—¶é—´çš„<span class="math inline">\(\mathbf{e_t}\)</span>ã€‚<span class="math inline">\(\mathbf{e}_t\)</span>æ˜¯GRUæ•æ‰æ—¶é—´ä¾èµ–æ€§çš„å…³é”®ï¼Œå¯ä»¥è®¤ä¸ºå®ƒåŒ…å«äº†<span class="math inline">\(\mathbf{x}_{1:t}\)</span>çš„ä¿¡æ¯ã€‚ä¹‹å<span class="math inline">\(\mathbf{e}_t\)</span>ä¼šå’Œ<span class="math inline">\(\mathbf{z}_{t-1}\)</span>è¿›è¡Œæ‹¼æ¥ï¼Œè¿›å…¥æ ‡å‡†çš„VAEå˜åˆ†ç½‘ç»œç»“æ„ï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„å‚æ•°<span class="math inline">\(\mu_{z_t},\sigma_{z_t}\)</span>é‡‡æ ·å¾—åˆ°éšå˜é‡<span class="math inline">\(\mathbf{z}_t^0\)</span>ï¼Œæ­¤æ—¶éšå˜é‡å¯ä»¥è¯´æ•æ‰äº†æ—¶é—´ä¾èµ–æ€§ã€‚</p>
<p>ç½‘ç»œä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><span class="math display">\[
\begin{align}
e_t&amp;=(1-c_t^e)\circ\text{tanh}(w^ex_t+u^e(r_t^e\circ e_{t-1})+b^e)+c_t^e\circ e_{t-1}\\
\mu_{z_t}&amp;=w^{\mu_z}h^\phi([z_{t-1},e_t])+b^{\mu_z}\\
\sigma_{z_t}&amp;=\text{softplus}(w^{\sigma_z}h^\phi([z_{t-1},e_t])+b^{\sigma_z})+\epsilon^{\sigma_z}
\end{align}
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(r_t^e=\text{sigmoid}(\mathbf{w}^{r^e}\mathbf{x}_t+\mathbf{u}^{r^e}\mathbf{e}_{t-1}+b^{r^e})\)</span>æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ<span class="math inline">\(c_t^e=\text{sigmoid}(\mathbf{w}^{c^e}\mathbf{x}_t+\mathbf{u}^{c^e}\mathbf{e}_{t-1}+b^{c^e})\)</span>æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p>
<p>æ­¤æ—¶<span class="math inline">\(\mathbf{z}_t^0\)</span>æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸ºäº†æ‹Ÿåˆå¤æ‚çš„åéªŒåˆ†å¸ƒï¼Œæˆ‘ä»¬ä½¿ç”¨Planar Normalizing Flowæ¥å¯¹<span class="math inline">\(\mathbf{z}_t^0\)</span>è¿›è¡Œå˜æ¢ï¼Œæœ€åå¾—åˆ°ç»<span class="math inline">\(K\)</span>æ¬¡å˜æ¢åçš„éšæœºå˜é‡<span class="math inline">\(\mathbf{z}_t^K\)</span>ã€‚</p>
<p>åœ¨æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œpnetè¯•å›¾é€šè¿‡<span class="math inline">\(\mathbf{z}_t^K\)</span>æ¥é‡æ„<span class="math inline">\(\mathbf{x}_t\)</span>ã€‚é¦–å…ˆ<span class="math inline">\(\mathbf{z}\)</span>ç©ºé—´ä¸­çš„å˜é‡ä¼šæ ¹æ®Linear Gaussian State Space Modelæ¥è¿›è¡Œâ€œè¿æ¥â€œï¼Œå…¬å¼ä¸º<span class="math inline">\(\mathbf{z}_t=\mathbf{O}_\theta(\mathbf{T}_\theta\mathbf{z}_{t-1}+\mathbf{v}_t)+\boldsymbol{\epsilon}_t\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{O}_\theta\)</span>å’Œ<span class="math inline">\(\mathbf{T}_\theta\)</span>ä¸ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œ<span class="math inline">\(\mathbf{v}_t\)</span>å’Œ<span class="math inline">\(\boldsymbol{\epsilon}_t\)</span>ä¸ºéšæœºå™ªå£°ã€‚ä¹‹å<span class="math inline">\(\mathbf{z}_t\)</span>å’Œ<span class="math inline">\(\mathbf{d}_{t-1}\)</span>ä¼šä½œä¸ºGRUçš„è¾“å…¥ï¼Œäº§ç”Ÿ<span class="math inline">\(\mathbf{d}_t\)</span>ã€‚ä¹‹å<span class="math inline">\(\mathbf{d}_t\)</span>ä¼šç»è¿‡æ ‡å‡†VAEä¸­çš„ç”Ÿæˆç½‘ç»œï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„é«˜æ–¯åˆ†å¸ƒå‚æ•°<span class="math inline">\(\mu_{x_t},\sigma_{x_t}\)</span>é‡‡æ ·å¾—åˆ°é‡æ„åçš„æ ·æœ¬<span class="math inline">\(\mathbf{x}^\prime_t\)</span>ã€‚pnetä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š <span class="math display">\[
\begin{align}
d_t&amp;=(1-c_t^d)\circ\text{tanh}(w^dz_t+u^d(r_t^d\circ d_{t-1})+b^d)+c_t^d\circ d_{t-1}\\
\mu_{x_t}&amp;=w^{\mu_x}h^\theta(d_t)+b^{\mu_x}\\
\sigma_{x_t}&amp;=\text{softplus}(w^{\sigma_x}h^\theta(d_t)+b^{\sigma_x})+\epsilon^{\sigma_x}
\end{align}
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(r_t^d=\text{sigmoid}(\mathbf{w}^{r^d}\mathbf{x}_t+\mathbf{u}^{r^d}\mathbf{d}_{t-1}+b^{r^d})\)</span>æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ<span class="math inline">\(c_t^d=\text{sigmoid}(\mathbf{w}^{c^d}\mathbf{x}_t+\mathbf{u}^{c^d}\mathbf{d}_{t-1}+b^{c^d})\)</span>æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p>
<h2 id="offline-model-training">Offline Model Training</h2>
<p>å’Œä¼ ç»ŸVAEç±»ä¼¼ï¼Œæ¨¡å‹çš„è®­ç»ƒå¯ä»¥é€šè¿‡ä¼˜åŒ–ELBOæ¥å®Œæˆã€‚è®°é•¿åº¦ä¸º<span class="math inline">\(T+1\)</span>çš„è¾“å…¥åºåˆ—ä¸º<span class="math inline">\(\mathbf{x}_{t-T:t}\)</span>ï¼Œéšç©ºé—´å˜é‡é‡‡æ ·æ¬¡æ•°ä¸º<span class="math inline">\(L\)</span>ï¼Œç¬¬<span class="math inline">\(l\)</span>ä¸ªéšç©ºé—´å˜é‡ä¸º<span class="math inline">\(\mathbf{l}^{(l)}_{t-T:t}\)</span>ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p>
<p><span class="math display">\[
\tilde{\mathcal{L}}(\mathbf{x}_{t-T:t})\approx\frac{1}{L}\sum_{t=1}^L[\log(p_\theta(\mathbf{x}_{t-T:t}|\mathbf{z}_{t-T:t}^{(l)}))+\log(p_\theta(\mathbf{z}_{t-T:t}^{(l)}))-\log(q_\phi(\mathbf{z}_{t-T:t}^|\mathbf{x}_{t-T:t}))]
\]</span></p>
<p>ç¬¬ä¸€é¡¹<span class="math inline">\(\log(p_\theta(\mathbf{x}_{t-T:t}|\mathbf{z}_{t-T:t}^{(l)}))\)</span>å¯ä»¥çœ‹ä½œæ˜¯é‡æ„è¯¯å·®ï¼›ç¬¬äºŒé¡¹<span class="math inline">\(\log(p_\theta(\mathbf{z}_{t-T:t}))=\sum_{i=t-T}^t \log(p_\theta(\mathbf{z}_i|\mathbf{z}_{i-1}))\)</span>é€šè¿‡Linear Gaussian State Space Modelè®¡ç®—ï¼›ç¬¬ä¸‰é¡¹<span class="math inline">\(-\log(q_\phi(\mathbf{z}_{t-T:t}|\mathbf{x}_{t-T:t}))=-\sum_{i=t-T}^t\log(q_\phi(\mathbf{z}_i|\mathbf{z}_{i-1},\mathbf{x}_{t-T:i}))\)</span>ä¸ºéšå˜é‡<span class="math inline">\(\mathbf{z}\)</span>åéªŒåˆ†å¸ƒçš„ä¼°è®¡ï¼ŒåŒæ—¶<span class="math inline">\(\mathbf{z}_i\)</span>æ˜¯ç»Planar Normalizing Flowè½¬æ¢è¿‡çš„ã€‚</p>
<h2 id="online-detection">Online Detection</h2>
<p>åœ¨è®­ç»ƒå¥½æ¨¡å‹ä¹‹åï¼Œå°±å¯ä»¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹äº†ã€‚åœ¨æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œæˆ‘ä»¬é€šè¿‡æ ¹æ®é•¿åº¦ä¸º<span class="math inline">\(T+1\)</span>çš„åºåˆ—<span class="math inline">\(\mathbf{x}_{t-T:t}\)</span>æ¥é‡æ„<span class="math inline">\(\mathbf{x}_t\)</span>ï¼Œå¹¶æ ¹æ®é‡æ„æ¦‚ç‡<span class="math inline">\(\log(p_\theta(\mathbf{x}_t|\mathbf{z}_{t-T:t}))\)</span>æ¥åˆ¤å®šå¼‚å¸¸ã€‚å®šä¹‰<span class="math inline">\(\mathbf{x}_t\)</span>å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°<span class="math inline">\(S_t=\log(p_\theta(\mathbf{x}_t|\mathbf{z}_{t-T:t}))\)</span>ï¼Œé«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ ·æœ¬<span class="math inline">\(\mathbf{x}_t\)</span>èƒ½å¤Ÿä»¥å¤§æ¦‚ç‡é‡æ„ï¼ˆå› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è®­ç»ƒï¼Œå¯ä»¥è®¤ä¸ºæ¨¡å‹å»ºæ¨¡çš„æ˜¯æ­£å¸¸æ ·æœ¬çš„åˆ†å¸ƒï¼Œé‡æ„æ¦‚ç‡é«˜å°±ä»£è¡¨ç¬¦åˆæ­£å¸¸åˆ†å¸ƒï¼‰ã€‚ç»™å®šé˜ˆå€¼ä¹‹åä¾¿å¯æ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤å®šã€‚</p>
<h2 id="automatic-threshold-selection">Automatic Threshold Selection</h2>
<p>åœ¨å¼‚å¸¸æ£€æµ‹é˜¶æ®µï¼Œéœ€è¦æ ¹æ®è®¾å®šçš„é˜ˆå€¼å’Œæ¯ä¸ªæ ·æœ¬çš„å¼‚å¸¸åˆ†æ•°æ¥åˆ¤æ–­è¯¥æ ·æœ¬æ˜¯å¦ä¸ºå¼‚å¸¸ï¼Œæ‰€ä»¥é˜ˆå€¼çš„é€‰æ‹©ååˆ†é‡è¦ã€‚æ–‡ä¸­ç”¨åˆ°äº†ä¸€ç§æ ¹æ®<strong>Extreme Value Theory</strong>è‡ªåŠ¨é€‰æ‹©é˜ˆå€¼çš„ç®—æ³•ã€‚å¯¹äºä¸€ä¸ªåˆ†å¸ƒï¼Œå…¶ä¸­çš„æç«¯äº‹ä»¶å¾€å¾€ä½äºåˆ†å¸ƒçš„æœ«å°¾ï¼Œè€ŒExtreme Value Theoryç¬¬ä¸€å®šç†ç»™å‡ºä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ï¼Œè¿™äº›æç«¯äº‹ä»¶çš„åˆ†å¸ƒæœä»ä¸€ä¸ªå¸¦å‚çš„åˆ†å¸ƒæ—ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨å¯¹æ•°æ®åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡æç«¯äº‹ä»¶çš„åˆ†å¸ƒã€‚</p>
<p>é™¤äº†Extreme Value Theoryç¬¬ä¸€å®šç†ä¹‹å¤–ï¼ŒExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼<span class="math inline">\(t\)</span>çš„åˆ†å¸ƒå¯ä»¥ç”¨Generalized Pareto Distributionæ¥æè¿°ã€‚ä½œè€…ä½¿ç”¨äº†åŸºäºExtreme Value Theoryç¬¬äºŒå®šç†çš„Peaks-Over-Thresholdç®—æ³•æ¥è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚å› ä¸ºExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼<span class="math inline">\(t\)</span>çš„åˆ†å¸ƒï¼Œè€Œåœ¨æœ¬æ–‡çš„åœºæ™¯ä¸­æˆ‘ä»¬éœ€è¦åˆ»ç”»çš„å¼‚å¸¸ç‚¹çš„åˆ†å¸ƒåº”è¯¥æ˜¯å°äºä¸€ä¸ªç»™å®šé˜ˆå€¼çš„åˆ†å¸ƒï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹å…¬å¼ã€‚</p>
<p>å¯¹äºç»™å®šçš„æ•°æ®ï¼Œæ¨¡å‹ä¼šç»™å‡ºå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°åºåˆ—<span class="math inline">\(\{S_1,S_2,\cdots,S_{N^\prime}\}\)</span>ï¼Œç»™å®šé¢„å…ˆè®¾å®šçš„é˜ˆå€¼<span class="math inline">\(th\)</span>ï¼Œ<span class="math inline">\(S_i\)</span>æç«¯éƒ¨åˆ†ï¼ˆå³å°äº<span class="math inline">\(th\)</span>çš„éƒ¨åˆ†ï¼‰çš„åˆ†å¸ƒç¬¦åˆGeneralized Pareto Distributionï¼Œå…¬å¼å¦‚ä¸‹ï¼š <span class="math display">\[
\bar{F}(s)=P(th-S&gt;s|S&lt;th)\sim(1+\frac{\gamma s}{\beta})^{-\frac{1}{\gamma}}
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\gamma\)</span>å’Œ<span class="math inline">\(\beta\)</span>ä¸ºåˆ†å¸ƒçš„å½¢çŠ¶å‚æ•°ï¼Œæœ¬æ–‡ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ¥å¯¹å‚æ•°è¿›è¡Œä¼°è®¡ã€‚è®¾å‚æ•°çš„ä¼°è®¡å€¼åˆ†åˆ«ä¸º<span class="math inline">\(\hat{\gamma}\)</span>å’Œ<span class="math inline">\(\hat{\beta}\)</span>ï¼Œæœ€ç»ˆçš„é˜ˆå€¼<span class="math inline">\(th_F\)</span>ç”±æ‹Ÿåˆå¾—åˆ°çš„åˆ†å¸ƒçš„åˆ†ä½æ•°ç¡®å®šï¼š</p>
<p><span class="math display">\[
th_F\simeq th-\frac{\hat{\beta}}{\hat{\gamma}}((\frac{qN^\prime}{N^\prime_{th}})^{-\hat{\gamma}}-1)
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(q\)</span>ä¸ºæœŸæœ›<span class="math inline">\(S&lt;th\)</span>çš„æ¦‚ç‡ï¼Œ<span class="math inline">\(N^\prime\)</span>ä¸ºè§‚æµ‹å€¼çš„æ•°é‡ï¼Œ<span class="math inline">\(N^\prime_{th}\)</span>ä¸º<span class="math inline">\(S_i&lt;th\)</span>çš„ä¸ªæ•°ã€‚</p>
<h2 id="anomaly-interpretation">Anomaly Interpretation</h2>
<p><span class="math display">\[
\log(p_\theta(\mathbf{x}_t|\mathbf{z}_{t-T:t}))=\sum_{i=1}^M\log(p_\theta(x_t^i|\mathbf{z}_{t-T:t}))
\]</span></p>
<h1 id="experiments">Experiments</h1>
<h2 id="datasets-and-metrics">Datasets and Metrics</h2>
<h2 id="overall-performance">Overall Performance</h2>
<p><img src="http://qfxiao.me/img/1571411131954.png" /></p>
<p><img src="http://qfxiao.me/img/1571411148667.png" /></p>
<h2 id="effects-of-major-techniques">Effects of Major Techniques</h2>
<p><img src="http://qfxiao.me/img/1571411161522.png" /></p>
<p><img src="http://qfxiao.me/img/1571411178434.png" /></p>
<h2 id="visualization-on-z-space-representations">Visualization on Z-Space Representations</h2>
<p><img src="http://qfxiao.me/img/1571411190279.png" /></p>
<p><img src="http://qfxiao.me/img/1571411212926.png" /></p>
<p><img src="http://qfxiao.me/img/1571411223173.png" /></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/"><img class="thumbnail" src="http://qfxiao.me/img/1571719738542.png" alt="Unsupervised Anomaly Detection via Variational Auto-Encoder for Seasonal KPIs in Web Applications"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-09-22T12:35:18.000Z" title="2019-09-22T12:35:18.000Z">2019-09-22</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">25 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 3820 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/">Unsupervised Anomaly Detection via Variational Auto-Encoder for Seasonal KPIs in Web Applications</a></h1><div class="content"><h2 id="abstract">Abstract</h2>
<p>æœ¬æ–‡æå‡ºäº†Donutï¼Œä¸€ä¸ªåŸºäºVAEçš„æ— ç›‘ç£æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿã€‚</p>
<p><a href="https://dl.acm.org/citation.cfm?id=3185996">åŸæ–‡</a></p>
<p><img src="http://qfxiao.me/img/1571719484833.png" /></p>
<h2 id="contribution">Contribution</h2>
<ol type="1">
<li>Donutä¸­ä½¿ç”¨åˆ°äº†ä¸‰ä¸ªæŠ€å·§ï¼ŒåŒ…æ‹¬æ”¹è¿›åçš„ELBOã€ç¼ºå¤±æ•°æ®æ³¨å…¥å’ŒMCMCæ’å€¼ï¼›</li>
<li>æå‡ºåŸºäºVAEçš„å¼‚å¸¸æ£€æµ‹è®­ç»ƒæ—¢éœ€è¦æ­£å¸¸æ ·æœ¬ä¹Ÿéœ€è¦å¼‚å¸¸æ ·æœ¬ï¼›</li>
<li>å¯¹Donutæå‡ºäº†åœ¨z-ç©ºé—´ä¸­åŸºäºKDEçš„ç†è®ºè§£é‡Šã€‚</li>
</ol>
<h2 id="background">Background</h2>
<h3 id="anomaly-detection">Anomaly Detection</h3>
<p>å¯¹äºä»»æ„æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼<span class="math inline">\(x_{t-T+1},\cdots,x_t\)</span>ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º<span class="math inline">\(y_t=1\)</span>)ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚<span class="math inline">\(p(y_t=1|x_{t-T+1},\cdots,x_t)\)</span>ã€‚</p>
<h2 id="methodology">Methodology</h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>æœ¬æ–‡çš„ç›®çš„æ˜¯<strong>åŸºäºæ·±åº¦ç”Ÿæˆç½‘ç»œå¼€å‘å…·æœ‰ç†è®ºè§£é‡Šæ€§çš„æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œå¹¶ä¸”åœ¨æœ‰æ ‡ç­¾çš„æƒ…å†µä¸‹èƒ½åˆ©ç”¨æ ‡ç­¾ä¿¡æ¯æå‡æ€§èƒ½</strong>ã€‚æœ¬æ–‡åŸºäºVAEæ¥æ„å»ºæ¨¡å‹ã€‚</p>
<p><img src="http://qfxiao.me/img/1565532060281.png" /></p>
<h3 id="network-structure">Network Structure</h3>
<p>ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565532453958.png" /></p>
<p>ä¸€å…±åŒ…å«äº†é¢„å¤„ç†ã€è®­ç»ƒå’Œæ£€æµ‹ä¸‰ä¸ªéƒ¨åˆ†ã€‚</p>
<p>ä¸‹å›¾ä¸ºæ¨¡å‹çš„æ¦‚ç‡å›¾æ¨¡å‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1565532474201.png" /></p>
<p>å›¾ä¸­åŒå®çº¿çš„æ¡†ä¸ºæœ¬æ–‡æ¨¡å‹æœ‰åˆ«äºä¼ ç»ŸVAEçš„åœ°æ–¹ï¼Œå…¶ä½™åœ°æ–¹å’ŒVAEä¸€æ ·ã€‚å…ˆéªŒæ¦‚ç‡<span class="math inline">\(p_\theta(z)\)</span>é€‰ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(0,I)\)</span>ï¼ŒåéªŒæ¦‚ç‡<span class="math inline">\(x\)</span>å’Œ<span class="math inline">\(z\)</span>éƒ½æ˜¯å¯¹è§’åŒ–é«˜æ–¯åˆ†å¸ƒï¼Œå³<span class="math inline">\(p_\theta(x|z)=\mathcal{N}(\mu_x,\sigma_x^2 I),q_\phi(z|x)=\mathcal{N}(\mu_z,\sigma_z^2 I)\)</span>ã€‚å¦‚Figure 4æ‰€ç¤ºï¼Œæ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œä¸­åˆ†åˆ«éƒ½æœ‰éšå«å±‚<span class="math inline">\(f_\phi(x)\)</span>å’Œ<span class="math inline">\(f_\theta(z)\)</span>å¯¹ç½‘ç»œçš„è¾“å…¥è¿›è¡Œç‰¹å¾æŠ½å–ã€‚é«˜æ–¯åˆ†å¸ƒçš„å‚æ•°å³ä»è¿™äº›æŠ½å–å‡ºæ¥çš„ç‰¹å¾ä¸Šå¾—åˆ°ã€‚å‡å€¼é€šè¿‡çº¿æ€§å±‚å¾—åˆ°ï¼š<span class="math inline">\(\mu_x=W^T_{\mu_x}f_\theta(z)+b_{\mu_x}, \mu_z=W^T_{\mu_z}f_\theta(x)+b_{\mu_z}\)</span>ã€‚æ ‡å‡†å·®é€šè¿‡Soft Pluså±‚åŠ ä¸€ä¸ªé«˜æ–¯å™ªå£°å¾—åˆ°ï¼š<span class="math inline">\(\sigma_x=\text{SoftPlus}[W^T_{\sigma_x}f_\theta(z)+b_{\sigma_x}]+\varepsilonï¼Œ\sigma_x=\text{SoftPlus}[W^T_{\sigma_z}f_\theta(x)+b_{\sigma_z}]+\varepsilon\)</span>ã€‚</p>
<p>æ–‡ä¸­æåˆ°å› ä¸ºKPIçš„å±€éƒ¨æ–¹å·®éå¸¸å°ï¼Œæ‰€ä»¥é‡‡ç”¨ç›´æ¥å»ºæ¨¡<span class="math inline">\(\sigma_x,\sigma_z\)</span>çš„æ–¹å¼è€Œä¸æ˜¯é‡‡ç”¨å¯¹æ•°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸ºäº†ç†è®ºä¸Šçš„è§£é‡Šæ€§ï¼Œæ–‡ä¸­çš„ç¥ç»ç½‘ç»œåªä½¿ç”¨äº†å…¨è¿æ¥å±‚ã€‚</p>
<h3 id="training">Training</h3>
<p>è®­ç»ƒå¯ä»¥ç›´æ¥é‡‡ç”¨ç»å…¸çš„SGVBæ¥ä¼˜åŒ–ELBOï¼š <span class="math display">\[
\begin{align}
\log p_\theta(x)&amp;\geq\log p_\theta(x)-\text{KL}[q_\phi(z|x)\parallel p_\theta(z|x)]\\
&amp;=\mathcal{L}\\
&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x)+\log p_\theta(z|x)-\log q_\phi(z|x)]\\
&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x,z)-\log q_\phi(z|x)]\\
&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)+\log p_\theta(z)-\log q_\phi(z|x)]
\end{align}
\]</span> ä½†æ˜¯åœ¨å®é™…çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè®­ç»ƒæ•°æ®éœ€è¦ä¿è¯éƒ½æ˜¯æ­£å¸¸æ ·æœ¬ï¼Œä½†å®é™…ä¸Šè®­ç»ƒæ ·æœ¬æœ‰å¯èƒ½ä¼šåŒ…å«å¼‚å¸¸æˆ–è€…æ˜¯ç¼ºå¤±å€¼ã€‚ä¸€ç§åšæ³•æ˜¯ç”¨ç¼ºå¤±å€¼å¡«å……çš„ç®—æ³•æ¥å¡«å……è¿™äº›å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼ï¼Œä½†ä½œè€…è®¤ä¸ºä½¿ç”¨ç¼ºå¤±å€¼å¡«å……ç®—æ³•å¹¶ä¸èƒ½å¾ˆå¥½çš„è¿˜åŸæ•°æ®çš„æ­£å¸¸æ¨¡å¼ï¼Œä»è€Œä¿è¯ç®—æ³•çš„æœ‰æ•ˆæ€§ã€‚åœ¨æ–‡ä¸­ä½œè€…é‡‡ç”¨äº†ä¿®æ”¹ELBOçš„æ–¹æ³•ï¼Œå¹¶å°†å…¶ç§°ä¹‹ä¸º<strong>Modified ELBO (M-ELBO)</strong>ï¼Œå…¬å¼å¦‚ä¸‹ï¼š <span class="math display">\[
\tilde{\mathcal{L}}=\mathbb{E}_{q_\phi(z|x)}[\sum\limits_{w=1}^W{\alpha_w\log p_\theta(x_w|z)+\beta\log p_\theta(z)-\log q_\phi(z|x)}]
\]</span> å…¶ä¸­<span class="math inline">\(\alpha_w\)</span>ä¸ºæŒ‡ç¤ºæ ‡è®°ï¼Œ<span class="math inline">\(\alpha_w=1\)</span>ä»£è¡¨ä¸æ˜¯å¼‚å¸¸ä¹Ÿä¸æ˜¯ç¼ºå¤±ã€‚<span class="math inline">\(\beta\)</span>å®šä¹‰ä¸º<span class="math inline">\(\beta=\frac{\sum_{w=1}^W\alpha_w}{W}\)</span>ã€‚</p>
<p>åœ¨<strong>M-ELBO</strong>ä¸­ï¼Œå¼‚å¸¸æˆ–ç¼ºå¤±å€¼å¯¹åº”çš„<span class="math inline">\(\log p_\theta(x_w|z)\)</span>çš„è´¡çŒ®ä¼šè¢«æ’é™¤ï¼ŒåŒæ—¶<span class="math inline">\(\log p_\theta(z)\)</span>åœ¨ä¹˜ä»¥<span class="math inline">\(\beta\)</span>åä¼šç›¸åº”ç¼©å°ã€‚ä½œè€…æ²¡æœ‰ä¿®æ”¹<span class="math inline">\(\log q_\phi(z|x)\)</span>è¿™ä¸€é¡¹çš„åŸå› æœ‰äºŒï¼šä¸€æ˜¯<span class="math inline">\(q_\phi(z|x)\)</span>ä»…ä»…æ˜¯ä»<span class="math inline">\(x\)</span>åˆ°<span class="math inline">\(z\)</span>çš„æ˜ å°„ï¼Œå¹¶ä¸éœ€è¦è€ƒè™‘â€œæ­£å¸¸æ¨¡å¼â€ï¼›äºŒæ˜¯<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[-\log q_\phi(z|x)]\)</span>å°±æ˜¯<span class="math inline">\(q_\phi(z|x)\)</span>çš„ç†µï¼Œè€Œè¿™ä¸ªåœ¨åé¢çš„ç†è®ºåˆ†æä¸­æœ‰ç‰¹åˆ«çš„å«ä¹‰ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ç§è§£å†³æ–¹æ³•å°±æ˜¯æŠŠæ‰€æœ‰åŒ…å«å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼çš„çª—å£å»é™¤ï¼Œè¿™ç§æ–¹æ³•çš„æ€§èƒ½åœ¨å®éªŒä¸­ä¼šè¿›è¡Œè®¨è®ºã€‚</p>
<p>åœ¨æ–‡ä¸­ä½œè€…è¿˜ä½¿ç”¨äº†ä¸€ç§<strong>Missing Data Injection</strong>æŠ€æœ¯ï¼Œå³åœ¨æ¯ä¸ªEpochéšæœºçš„æŒ‰ç…§ä¸€ä¸ªé¢„è®¾æ¯”ä¾‹<span class="math inline">\(\lambda\)</span>å°†æ­£å¸¸çš„æ•°æ®è®¾ä¸ºç¼ºå¤±ã€‚ä½œè€…è®¤ä¸ºè¿™æ ·æœ‰åŠ©äºæ€§èƒ½çš„æå‡ã€‚</p>
<h3 id="detection">Detection</h3>
<p>åœ¨æ£€æµ‹é˜¶æ®µï¼Œå¯¹äºä¸€ä¸ªè¾“å…¥æ ·æœ¬ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡å‹è¾“å‡ºå…¶å¼‚å¸¸çš„æ¦‚ç‡ã€‚å› ä¸ºæˆ‘ä»¬å»ºæ¨¡äº†<span class="math inline">\(p_\theta(x|z)\)</span>ï¼Œä¸€ç§æ–¹æ³•æ˜¯é‡‡æ ·è®¡ç®—<span class="math inline">\(p_\theta(x)=\mathbb{E}_{p_\theta(z)}[p_\theta(x|z)]\)</span>ï¼Œä½†è¿™ç§æ–¹æ³•è®¡ç®—ä»£ä»·ååˆ†æ˜‚è´µã€‚å…¶ä»–çš„ä¸€äº›æ–¹æ¡ˆæœ‰è®¡ç®—<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[p_\theta(x|z)]\)</span>æˆ–<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>ï¼Œå…¶ä¸­åè€…è¢«ç§°ä¸º&quot;<strong>Reconstruction Probability</strong>&quot;ï¼Œä½œè€…ä¾¿é‡‡ç”¨äº†è¿™ç§æ–¹æ¡ˆã€‚</p>
<p>åŒæ—¶ï¼Œä½œè€…è®¤ä¸ºè¾“å…¥çš„æ£€æµ‹æ ·æœ¬çš„ç¼ºå¤±å€¼ä¼šå¯¹ç»“æœé€ æˆè¾ƒå¤§åå·®ï¼Œäºæ˜¯ä½¿ç”¨äº†ä¸€ç§<strong>MCMC-based Missing Data Imputation</strong>çš„æ–¹æ³•æ¥å¯¹æ£€æµ‹æ ·æœ¬çš„ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ã€‚å…·ä½“åšæ³•æ˜¯å°†æµ‹è¯•æ ·æœ¬åˆ†ä¸ºå·²è§‚æµ‹å’Œç¼ºå¤±ä¸¤éƒ¨åˆ†<span class="math inline">\(x=(x_o,x_m)\)</span>ï¼Œç„¶åä½¿ç”¨è®­ç»ƒå¥½çš„VAEè¿›è¡Œé‡æ„å¾—åˆ°<span class="math inline">\((x^\prime_o,x^\prime_m)\)</span>ï¼Œç„¶åç”¨<span class="math inline">\(x^\prime_m\)</span>æ›¿æ¢<span class="math inline">\(x_m\)</span>ï¼Œè¿™æ ·ä¸æ–­å¾ªç¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571719553095.png" /></p>
<p>ä½œè€…ä½¿ç”¨äº†<span class="math inline">\(L\)</span>ä¸ªæ ·æœ¬æ¥è®¡ç®—<strong>Reconstruction Probability</strong>ï¼Œè™½ç„¶å¾—åˆ°çš„è¾“å‡ºæ˜¯é’ˆå¯¹æ•´ä¸ªçª—å£æ¯ä¸ªç‚¹çš„ï¼Œä½†ä½œè€…åªä½¿ç”¨æœ€åä¸€ä¸ªç‚¹ã€‚</p>
<h2 id="experiments">Experiments</h2>
<h3 id="datasets">Datasets</h3>
<p>ä½œè€…é€‰æ‹©äº†ä¸‰æ¡KPIä½œä¸ºæµ‹è¯•æ•°æ®ï¼Œåˆ†åˆ«è®°ä¸º<span class="math inline">\(\mathcal{A}\)</span>ï¼Œ<span class="math inline">\(\mathcal{B}\)</span>ï¼Œ<span class="math inline">\(\mathcal{C}\)</span>ï¼Œå…¶åŸºæœ¬æ•°æ®å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571719583781.png" /></p>
<h3 id="metrics">Metrics</h3>
<p>å› ä¸ºå¼‚å¸¸æ£€æµ‹ç±»åˆ«çš„æä¸å‡è¡¡æ€§ï¼Œä¼ ç»Ÿçš„æ€§èƒ½æŒ‡æ ‡å¹¶ä¸å¤ªåˆé€‚ï¼ˆå¼‚å¸¸æ ·æœ¬æå°‘ï¼Œä¸”å¼‚å¸¸ä¸€èˆ¬å‘ˆè¿ç»­çš„ç‰‡æ®µï¼‰ã€‚ä½œè€…è®¤ä¸ºåœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­è¿ç»´äººå‘˜éœ€è¦å°½é‡æ—©çš„è·çŸ¥å¼‚å¸¸çš„å‘ç”Ÿï¼Œäºæ˜¯æå‡ºäº†æ–°çš„è¯„æµ‹æœºåˆ¶ã€‚</p>
<p><img src="http://qfxiao.me/img/1571719605541.png" /></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¬¬ä¸€è¡Œä¸ºçœŸå®çš„æ ‡ç­¾ï¼Œç¬¬äºŒè¡Œä¸ºé¢„æµ‹çš„å¼‚å¸¸æ¦‚ç‡ï¼Œç¬¬ä¸‰è¡Œä¸ºé¢„æµ‹çš„æ ‡ç­¾ã€‚ç¬¬ä¸€è¡Œä¸­å¼‚å¸¸ç‰‡æ®µè¢«åŠ ç²—è¡¨ç¤ºï¼Œå¯¹äºæ¯ä¸€ä¸ªå¼‚å¸¸ç‰‡æ®µçš„ç¬¬ä¸€ä¸ªä½ç½®<span class="math inline">\({y}_{t^\prime}\)</span>ï¼Œå¦‚æœé¢„æµ‹çš„æ ‡ç­¾ä¸­å­˜åœ¨<span class="math inline">\(\hat{y}_{t}\)</span>æ»¡è¶³<span class="math inline">\(t^\prime&lt;t\)</span>ä¸”<span class="math inline">\(|t-t^\prime|\)</span>å°äºç­‰äºé¢„è®¾çš„é˜ˆå€¼<span class="math inline">\(T\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(y_{t^\prime}\)</span>å¯¹åº”çš„æ•´æ®µå¼‚å¸¸éƒ½è¢«è®¤ä¸ºæ­£ç¡®æ£€æµ‹ï¼Œå¦åˆ™æ•´æ®µå¼‚å¸¸éƒ½è®¤ä¸ºæ²¡æœ‰è¢«æ­£ç¡®æ£€æµ‹ã€‚ç„¶ååœ¨æ­¤åŸºç¡€ä¸Šè®¡ç®—F1-scoreï¼ŒAUCç­‰æŒ‡æ ‡ä½œä¸ºè¯„æµ‹æ‰‹æ®µã€‚</p>
<h2 id="results">Results</h2>
<h3 id="overall-performance">Overall Performance</h3>
<p>ä¸‹å›¾å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š</p>
<p><img src="http://qfxiao.me/img/1571719653801.png" /></p>
<h3 id="effects-of-donut-techniques">Effects of Donut Techniques</h3>
<p>ä¸ºäº†æ¢ç©¶Donutä¸­æ‰€åšçš„å„ç§æ”¹è¿›çš„å®é™…ä½œç”¨ï¼Œä½œè€…åšäº†å¤§é‡å¯¹æ¯”å®éªŒï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571719667067.png" /></p>
<ul>
<li><strong>M-ELBO</strong> ä»å›¾ä¸­å¯ä»¥çœ‹å‡º<strong>M-ELBO</strong>å¯¹æ€§èƒ½æå‡æœ€å¤§ã€‚ä½œè€…åœ¨æ–‡ä¸­æåˆ°ä¸€å¼€å§‹å¹¶æ²¡æœŸæœ›<strong>M-ELBO</strong>èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ï¼Œåªæ˜¯å¸Œæœ›å®ƒèƒ½å¤ŸWorkã€‚è¿™è¡¨æ˜åœ¨VAEçš„è®­ç»ƒä¸­ï¼Œåªä½¿ç”¨æ­£å¸¸æ ·æœ¬æ˜¯ä¸å¤Ÿçš„ï¼Œä¹Ÿéœ€è¦åŠ å…¥éæ­£å¸¸çš„ä¿¡æ¯ï¼›</li>
<li><strong>Missing Data Injection</strong> è¯¥æŠ€å·§çš„ä¸»è¦ä½œç”¨æ˜¯å¢å¼º<strong>M-ELBO</strong>çš„æ•ˆæœã€‚ä»ç»“æœä¸Šæ¥çœ‹ä½œç”¨å¹¶ä¸æ˜¯ååˆ†çš„æ˜¾è‘—ï¼Œåªæ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹è·å¾—äº†å°‘é‡çš„æå‡ï¼›</li>
<li><strong>MCMC Imputation</strong> ä½œè€…è®¤ä¸ºè™½ç„¶è¯¥æŠ€å·§åªåœ¨ä¸€éƒ¨åˆ†æƒ…å†µä¸‹æ˜¾è‘—æå‡äº†æ€§èƒ½ï¼Œä½†æ€»ä½“æ¥è¯´å€¼å¾—ä½¿ç”¨ã€‚</li>
</ul>
<h3 id="impact-of-k">Impact of K</h3>
<p>è¯¥éƒ¨åˆ†ä½œè€…æ¢ç©¶äº†éšå˜é‡<span class="math inline">\(z\)</span>çš„ç»´åº¦<span class="math inline">\(K\)</span>å¯¹æ€§èƒ½çš„å½±å“ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://qfxiao.me/img/1571719682591.png" /></p>
<p>ä»å›¾ä¸Šæ¥çœ‹ï¼Œå¯¹æ•°æ®é›†<span class="math inline">\(\mathcal{A}\)</span>ï¼Œ<span class="math inline">\(\mathcal{B}\)</span>ï¼Œ<span class="math inline">\(\mathcal{C}\)</span>æœ€ä½³çš„<span class="math inline">\(K\)</span>åˆ†åˆ«æ˜¯<span class="math inline">\(5\)</span>ï¼Œ<span class="math inline">\(4\)</span>å’Œ<span class="math inline">\(3\)</span>ï¼Œä½†æ˜¯è®¾å®šè¾ƒå¤§çš„<span class="math inline">\(K\)</span>å¹¶ä¸ä¼šå¯¹æ€§èƒ½æœ‰ä¸¥é‡çš„æŸå®³ã€‚ä½œè€…è¿˜å‘ç°å¯¹äºè¾ƒä¸ºå¹³æ»‘çš„KPIéœ€è¦è¾ƒå¤§çš„<span class="math inline">\(K\)</span>ã€‚</p>
<h2 id="analysis">Analysis</h2>
<h3 id="kde-interpretation">KDE Interpretation</h3>
<p>åœ¨è¿™ä¸€èŠ‚ä½œè€…å¯¹<strong>Reconstruction Probability</strong>çš„æ„ä¹‰è¿›è¡Œäº†æ·±å…¥çš„æ¢è®¨ã€‚é¦–å…ˆä½œè€…å¯¹<span class="math inline">\(q_\phi(z|x)\)</span>è¿›è¡Œäº†å¯è§†åŒ–ï¼Œåœ¨å›¾ä¸­ä½œè€…å°†æ—¶é—´ç»´åº¦ç”¨é¢œè‰²æ¥è¡¨ç¤ºã€‚å¦‚Figure 11(a) æ‰€ç¤ºï¼Œ<span class="math inline">\(z\)</span>å‡ ä¹æ˜¯æŒ‰ç…§<span class="math inline">\(x\)</span>å¯¹åº”çš„æ—¶é—´å‘ˆä¸€ä¸ªè¿ç»­çš„æµå½¢åˆ†å¸ƒï¼Œä½œè€…å°†è¿™ç§ç°è±¡ç§°ä¸º<strong>Time Gradient</strong>ã€‚å³ä½¿Donutæ²¡æœ‰æ˜¾å¼çš„ç”¨åˆ°æ—¶é—´ä¿¡æ¯ï¼Œä¸è¿‡å› ä¸ºå®éªŒç”¨åˆ°çš„æ•°æ®åŸºæœ¬æ˜¯å¹³æ»‘çš„ï¼Œæ‰€ä»¥è¯´ç›¸é‚»çš„<span class="math inline">\(x\)</span>ä¼šæ¯”è¾ƒç›¸ä¼¼ï¼Œå› æ­¤ç»è¿‡æ˜ å°„åçš„<span class="math inline">\(z\)</span>ä¹Ÿä¼šæ¯”è¾ƒç›¸ä¼¼ã€‚ä½œè€…æ®æ­¤æå‡ºDonutçš„ä¸€ä¸ªä¼˜åŠ¿ä¾¿æ˜¯å¯¹äºæ²¡æœ‰è§è¿‡çš„åéªŒåˆ†å¸ƒ<span class="math inline">\(q_\phi(z|x)\)</span>ï¼Œåªè¦å…¶ä½äºè®­ç»ƒè¿‡çš„ä¸¤ä¸ªåéªŒä¹‹é—´ï¼Œä¹Ÿä¼šäº§ç”Ÿåˆç†çš„åˆ†å¸ƒã€‚</p>
<p><img src="http://qfxiao.me/img/1571719693393.png" /></p>
<p>å¯¹äºå¼‚å¸¸çš„æ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œå‡è®¾å…¶å¯¹åº”çš„æ­£å¸¸æ¨¡å¼ä¸º<span class="math inline">\(\tilde{x}\)</span>ï¼Œä½œè€…è®¤ä¸º<span class="math inline">\(q_\phi(z|x)\)</span>ä¼šåœ¨æŸç§ç¨‹åº¦ä¸Šå¯¹æ­£å¸¸çš„<span class="math inline">\(q_\phi(z|\tilde{x})\)</span>è¿›è¡Œè¿‘ä¼¼ã€‚å› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è¿›è¡Œè®­ç»ƒçš„ï¼Œéšå˜é‡<span class="math inline">\(z\)</span>çš„ç»´åº¦é€šå¸¸æ¥è¯´å°äºæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œè¿™å°±å¯¼è‡´<span class="math inline">\(z\)</span>åªä¼šä¿ç•™ä¸€éƒ¨åˆ†ä¸»è¦çš„ä¿¡æ¯ã€‚å¯¹äºå¼‚å¸¸æ ·æœ¬ï¼Œå…¶å¼‚å¸¸æ¨¡å¼åœ¨ç¼–ç æ—¶å°±è¢«ä¸¢æ‰äº†ã€‚ä½œè€…è¿˜æŒ‡å‡ºå¦‚æœ<span class="math inline">\(x\)</span>åŒ…å«çš„å¼‚å¸¸å¤ªå¤šï¼Œé‚£ä¹ˆæ¨¡å‹å°†éš¾ä»¥å¯¹<span class="math inline">\(x\)</span>è¿›è¡Œè¿˜åŸã€‚</p>
<p><img src="http://qfxiao.me/img/1571719738542.png" /></p>
<p>åŸºäºä¸Šè¿°è®¨è®ºï¼Œä½œè€…å¯¹ä½¿ç”¨<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>ä½œä¸º<strong>Reconstruction Probability</strong>çš„æ„ä¹‰è¿›è¡Œäº†é˜é‡Šã€‚è®¾è¾“å…¥æ ·æœ¬ä¸º<span class="math inline">\(x\)</span>ï¼Œå¦‚æœå…¶åŒ…å«å¼‚å¸¸ï¼Œå‡è®¾å…¶å¯¹åº”çš„æ­£å¸¸æ ·æœ¬ä¸º<span class="math inline">\(\tilde{x}\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(q_\phi(z|x)\)</span>éƒ¨åˆ†åœ°å’Œ<span class="math inline">\(q_\phi(z|\tilde{x})\)</span>ç›¸ä¼¼ã€‚å¦‚æœ<span class="math inline">\(x\)</span>å’Œ<span class="math inline">\(\tilde{x}\)</span>ç›¸ä¼¼ç¨‹åº¦é«˜ï¼Œé‚£ä¹ˆ<span class="math inline">\(\log p_\theta(x|z)\)</span>å°±ä¼šå¾ˆå¤§ï¼ˆå…¶ä¸­<span class="math inline">\(z\sim q_\phi(z|\tilde{x})\)</span>ï¼‰ã€‚<span class="math inline">\(\log p_\theta(x|z)\)</span>ç±»ä¼¼äºä¸€ä¸ªå¯†åº¦ä¼°è®¡å™¨ï¼Œä»£è¡¨<span class="math inline">\(x\)</span>åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸<span class="math inline">\(\tilde{x}\)</span>æ¥è¿‘ï¼Œ<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>ç›¸å½“äºå¯¹æ¯ä¸€ä¸ª<span class="math inline">\(z\)</span>å¯¹åº”çš„<span class="math inline">\(\log p_\theta(x|z)\)</span>ä¹˜ä»¥ä¸€ä¸ªæƒé‡<span class="math inline">\(q_\phi(z|x)\)</span>ç„¶åç›¸åŠ ã€‚äºæ˜¯ä½œè€…æå‡ºäº†<strong>Reconstruction Probability</strong>çš„<strong>KDE Interpretation</strong>:åœ¨Donutæ¨¡å‹ä¸­ï¼Œ<strong>Reconstruction Probability</strong> <span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>å¯ä»¥çœ‹ä½œæ˜¯ä»¥<span class="math inline">\(q_\phi(z|x)\)</span>ä¸ºæƒé‡ï¼Œ<span class="math inline">\(\log p_\theta(x|z)\)</span>ä¸ºæ ¸çš„æ ¸å¯†åº¦ä¼°è®¡ (Kernel Density Estimation)ã€‚</p>
<p>ä¸‰ç»´å¯è§†åŒ–å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571736459981.png" /></p>
<p>ä½œè€…è¿˜å¯¹ç›´æ¥è®¡ç®—<span class="math inline">\(p_\theta(x)=\mathbb{E}_{p_\theta(z)}[p_\theta(x|z)]\)</span>è¿›è¡Œäº†è´¨ç–‘ï¼Œå› ä¸ºè¿™ç§æ–¹æ³•ç›´æ¥æ±‚<span class="math inline">\(x\)</span>çš„å…ˆéªŒï¼Œä»…ä»…è€ƒè™‘äº†<span class="math inline">\(x\)</span>çš„æ€»ä½“æ¨¡å¼ï¼Œè€Œå¿½ç•¥äº†<span class="math inline">\(x\)</span>çš„ä¸ªä½“æ¨¡å¼ã€‚</p>
<h3 id="find-good-posteriors-for-abnormal-x">Find Good Posteriors for Abnormal <span class="math inline">\(x\)</span></h3>
<p>é€šè¿‡ä¸Šé¢çš„è®¨è®ºæˆ‘ä»¬çŸ¥é“äº†Donuté€šè¿‡æ‰¾åˆ°<span class="math inline">\(x\)</span>çš„æ­£å¸¸åéªŒæ¥ä¼°è®¡<span class="math inline">\(x\)</span>åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸<span class="math inline">\(\tilde{x}\)</span>ç›¸ä¼¼ï¼Œåœ¨è¿™ä¸€èŠ‚ä½œè€…è®¨è®ºäº†æ–‡ä¸­ä½¿ç”¨çš„ä¸åŒæŠ€å·§å¯¹æ‰¾åˆ°<span class="math inline">\(x\)</span>çš„åéªŒçš„ä½œç”¨ã€‚å¯¹äº<strong>Missing Data Injection</strong>ä½œè€…è®¤ä¸ºè¯¥æŠ€å·§å¢å¼ºäº†<strong>M-ELBO</strong>çš„æ•ˆæœã€‚å¯¹äº<strong>MCMC Imputation</strong>ï¼Œä½œè€…è®¤ä¸ºè¯¥æŠ€å·§ä¸»è¦æ˜¯åœ¨æ£€æµ‹é˜¶æ®µé€šè¿‡ä¸æ–­è¿­ä»£æä¾›äº†æ›´å¥½çš„åéªŒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571736476085.png" /></p>
<p>ä½œè€…è®¤ä¸ºï¼Œè™½ç„¶å¯¹äºåŒ…å«å¤§é‡å¼‚å¸¸çš„æ ·æœ¬ï¼ŒDonutä¸èƒ½å¾ˆå¥½çš„è¿˜åŸï¼Œä½†åœ¨è¿ç»´åœºæ™¯ä¸­ï¼Œåªè¦å¯¹å¤§æ®µå¼‚å¸¸çš„å¼€å§‹é˜¶æ®µè¿›è¡Œå‡†ç¡®é¢„æµ‹å³å¯ã€‚</p>
<h3 id="causes-of-time-gradient">Causes of Time Gradient</h3>
<p>åœ¨è¿™ä¸€èŠ‚ä½œè€…è®¨è®ºäº†<strong>Time Gradient</strong>å‡ºç°çš„åŸå› ã€‚é¦–å…ˆå‡è®¾<span class="math inline">\(x\)</span>éƒ½æ˜¯æ­£å¸¸ç‚¹ï¼Œè¿™æ—¶<span class="math inline">\(x\)</span>çš„ELBOä¸ºï¼š <span class="math display">\[
\begin{align}
\mathcal{L}(x)&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)+\log p_\theta(z)-\log q_\phi(z|x)]\\
&amp;=\mathbb{E}[\log p_\theta(x|z)]+\mathbb{E}[\log p_\theta(z)]+\text{H}[z|x]
\end{align}
\]</span> ç¬¬ä¸€é¡¹è¡¨æ˜åœ¨<span class="math inline">\(z\sim q_\phi(z|x)\)</span>ä¸‹å°½å¯èƒ½é‡æ„<span class="math inline">\(x\)</span>ã€‚ç¬¬äºŒé¡¹è¡¨æ˜<span class="math inline">\(q_\phi(z|x)\)</span>å°½é‡ä¸<span class="math inline">\(z\)</span>çš„å…ˆéªŒ<span class="math inline">\(\mathcal{N}(0,I)\)</span>æ¥è¿‘ã€‚ç¬¬ä¸‰é¡¹ä¸º<span class="math inline">\(q_\phi(z|x)\)</span>çš„ç†µï¼Œè¡¨æ˜<span class="math inline">\(q_\phi(z|x)\)</span>åº”å°½é‡åˆ†æ•£ã€‚ç„¶è€Œç¬¬äºŒé¡¹åˆé™åˆ¶äº†è¿™ç§åˆ†æ•£çš„åŒºåŸŸï¼Œå¦‚ Figure 11(c) æ‰€ç¤ºã€‚åŒæ—¶è€ƒè™‘è¿™ä¸‰é¡¹çš„è¯ï¼Œç¬¬ä¸€é¡¹ä½¿å¾—<span class="math inline">\(z\)</span>ä¸èƒ½è‡ªç”±åœ°åˆ†æ•£ï¼Œå¯¹äºä¸ç›¸ä¼¼çš„<span class="math inline">\(x\)</span>å…¶å¯¹åº”çš„<span class="math inline">\(z\)</span>ä¹Ÿæ˜¯ä¸ç›¸ä¼¼çš„ï¼Œå› ä¸ºè¦æœ€å¤§åŒ–<span class="math inline">\(x\)</span>çš„é‡æ„æ¦‚ç‡ã€‚ç„¶è€Œå¯¹äºç›¸ä¼¼çš„<span class="math inline">\(x\)</span>æ¥è¯´ï¼Œå…¶å¯¹åº”çš„<span class="math inline">\(q_\phi(z|x)\)</span>ä¼šå‡ºç°å¾ˆå¤šé‡å¤çš„éƒ¨åˆ†ã€‚å½“è¾¾åˆ°å¹³è¡¡æ—¶ï¼Œ<strong>Time Gradient</strong>å°±å‡ºç°äº†ã€‚</p>
<p><img src="http://qfxiao.me/img/1571719784233.png" /></p>
<p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå½“<span class="math inline">\(x\)</span>è¶Šä¸ç›¸ä¼¼ï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>å°±ä¼šç›¸è·è¶Šè¿œï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ç„¶è€Œåœ¨ä¸€å¼€å§‹ï¼Œå‚æ•°ç»è¿‡éšæœºåˆå§‹åŒ–ï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>éƒ½æ˜¯éšæœºæ•£ä¹±çš„ï¼Œå¦‚ Figure 11(b) æ‰€ç¤ºã€‚éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>å°†ä¼šä¸æ–­ä¼˜åŒ–ã€‚ç”±äºKPIæ•°æ®å¾€å¾€æ˜¯å…‰æ»‘çš„ï¼Œé‚£ä¹ˆåœ¨æ—¶é—´ä¸Šç›¸è·è¶Šè¿œçš„æ ·æœ¬å°±ä¼šè¶Šä¸ç›¸ä¼¼ï¼Œå¯¹åº”çš„<span class="math inline">\(q_\phi(z|x)\)</span>ä¹Ÿä¼šç›¸è·æ›´è¿œã€‚è¿™ä¹Ÿè¯´æ˜äº†ï¼Œè®­ç»ƒç»“æŸåï¼Œæ—¶é—´ä¸Šç›¸è·è¶Šè¿œçš„ï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>ä¹Ÿä¼šç›¸è·è¶Šè¿œï¼Œåä¹‹äº¦ç„¶ã€‚åŒæ—¶è¿™ä¹Ÿè¡¨æ˜å­¦ä¹ ç‡çš„è®¾ç½®å¯¹æœ¬æ¨¡å‹çš„ç¨³å®šæ€§æœ‰è‡³å…³é‡è¦çš„ä½œç”¨ã€‚</p>
<h3 id="sub-optimal-equilibrium">Sub-Optimal Equilibrium</h3>
<p>ä¸Šé¢æˆ‘ä»¬è®¨è®ºäº†éšç€è®­ç»ƒè¿›è¡Œ<span class="math inline">\(q_\phi(z|x)\)</span>çš„æ¼”å˜ï¼Œä½œè€…æå‡ºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°æ¨¡å‹æ”¶æ•›åˆ°æ¬¡ä¼˜çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571719796266.png" /></p>
<p>ç¬¬ä¸€è¡Œå±•ç¤ºçš„æ˜¯æ”¶æ•›åˆ°æœ€ä¼˜çš„æƒ…å†µï¼Œç¬¬äºŒè¡Œå±•ç¤ºçš„æ˜¯æ”¶æ•›åˆ°æ¬¡ä¼˜çš„æƒ…å†µã€‚ä»ç¬¬äºŒè¡Œçš„ç¬¬ä¸€ä¸ªå›¾ï¼ˆStep 100ï¼‰æ¥çœ‹ï¼Œç´«è‰²çš„ç‚¹å¼€å§‹ç©¿è¿‡ç»¿è‰²çš„ç‚¹ï¼Œéšç€è®­ç»ƒçš„è¿›è¡Œï¼Œç´«è‰²çš„ç‚¹å¼€å§‹å°†ç»¿è‰²çš„ç‚¹æ¨å¼€ã€‚åˆ°Step 5000çš„æ—¶å€™ï¼Œç»¿è‰²çš„ç‚¹å·²ç»è¢«åˆ†æˆäº†ä¸¤åŠã€‚ä¸‹å›¾å±•ç¤ºäº†å¯¹åº”çš„è®­ç»ƒè¯¯å·®å’ŒéªŒè¯è¯¯å·®ï¼š</p>
<p><img src="http://qfxiao.me/img/1571719807778.png" /></p>
<p>è¿™æ ·çš„ç°è±¡ä¼šå¯¼è‡´åœ¨ä¸¤åŠç»¿è‰²åŒºåŸŸä¹‹é—´çš„æµ‹è¯•æ ·æœ¬ä¼šè¢«è¯†åˆ«ä¸ºç´«è‰²ï¼Œä»è€Œé™ä½æ€§èƒ½ã€‚ä½œè€…æå‡ºåœ¨<span class="math inline">\(K\)</span>è¾ƒå¤§çš„æ—¶å€™è¿™ç§ç°è±¡ä¸å®¹æ˜“å‘ç”Ÿï¼Œä½†è¿™æ—¶è®­ç»ƒçš„æ”¶æ•›åˆä¼šæˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚</p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block line-height-inherit">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">17</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags"><p class="title">12</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">é“¾æ¥</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†ç±»</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Research/"><span class="level-start"><span class="level-item">Research</span></span><span class="level-end"><span class="level-item tag">16</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Research/Anomaly-Detection/"><span class="level-start"><span class="level-item">Anomaly Detection</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/GAN/"><span class="level-start"><span class="level-item">GAN</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/Misc/"><span class="level-start"><span class="level-item">Misc</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/RNN/"><span class="level-start"><span class="level-item">RNN</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/Time-Series-Imputation/"><span class="level-start"><span class="level-item">Time Series Imputation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/Tutorial/"><span class="level-start"><span class="level-item">Tutorial</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Technical-Notes/"><span class="level-start"><span class="level-item">Technical Notes</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Technical-Notes/Misc/"><span class="level-start"><span class="level-item">Misc</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><a class="media-left" href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200301230011495.png" alt="Discovering Physical Concepts with Neural Networks"></p></a><div class="media-content size-small"><p><time dateTime="2020-03-01T14:55:02.000Z">2020-03-01</time></p><p class="title is-6"><a class="link-muted" href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/">Discovering Physical Concepts with Neural Networks</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Misc/">Misc</a></p></div></article><article class="media"><a class="media-left" href="/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200109102830713.png" alt="Transfer Anomaly Detection by Inferring Latent Domain Representations"></p></a><div class="media-content size-small"><p><time dateTime="2020-02-27T12:02:18.000Z">2020-02-27</time></p><p class="title is-6"><a class="link-muted" href="/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/">Transfer Anomaly Detection by Inferring Latent Domain Representations</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></p></div></article><article class="media"><a class="media-left" href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200113104953902.png" alt="Deep Anomaly Detection with Deviation Networks"></p></a><div class="media-content size-small"><p><time dateTime="2020-02-24T02:45:08.000Z">2020-02-24</time></p><p class="title is-6"><a class="link-muted" href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/">Deep Anomaly Detection with Deviation Networks</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></p></div></article><article class="media"><a class="media-left" href="/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200131113557592.png" alt="Geant4 å®‰è£…æ•™ç¨‹ä¸è°ƒè¯•ç¯å¢ƒé…ç½®"></p></a><div class="media-content size-small"><p><time dateTime="2020-01-31T03:25:59.000Z">2020-01-31</time></p><p class="title is-6"><a class="link-muted" href="/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/">Geant4 å®‰è£…æ•™ç¨‹ä¸è°ƒè¯•ç¯å¢ƒé…ç½®</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Technical-Notes/">Technical Notes</a> / <a class="link-muted" href="/categories/Technical-Notes/Misc/">Misc</a></p></div></article><article class="media"><a class="media-left" href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200109102204802.png" alt="Complementary Set Variational Autoencoder for Supervised Anomaly Detection"></p></a><div class="media-content size-small"><p><time dateTime="2020-01-09T02:15:03.000Z">2020-01-09</time></p><p class="title is-6"><a class="link-muted" href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/">Complementary Set Variational Autoencoder for Supervised Anomaly Detection</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">å½’æ¡£</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">ä¸‰æœˆ 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">äºŒæœˆ 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">ä¸€æœˆ 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">åä¸€æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">åæœˆ 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">ä¹æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">æ ‡ç­¾</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Anomaly-Detection/"><span class="tag">Anomaly Detection</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Deep-Learning/"><span class="tag">Deep Learning</span><span class="tag is-grey-lightest">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Flow-based-Model/"><span class="tag">Flow-based Model</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GAN/"><span class="tag">GAN</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RNN/"><span class="tag">RNN</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spectral/"><span class="tag">Spectral</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Statistics/"><span class="tag">Statistics</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Time-Series/"><span class="tag">Time Series</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Transfer-Learning/"><span class="tag">Transfer Learning</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VAE/"><span class="tag">VAE</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Variational-Inference/"><span class="tag">Variational Inference</span><span class="tag is-grey-lightest">2</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">è®¢é˜…æ›´æ–°</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="è®¢é˜…"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hanzawa ã® éƒ¨å±‹" height="28"></a><p class="size-small"><span>&copy; 2020 Hanzawa</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://qfxiao.me',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><script>window.addEventListener("load", function () {
            MathJax.Hub.Config({
                'HTML-CSS': {
                    matchFontHeight: false
                },
                SVG: {
                    matchFontHeight: false
                },
                CommonHTML: {
                    matchFontHeight: false
                },
                tex2jax: {
                    inlineMath: [
                        ['$','$'],
                        ['\\(','\\)']
                    ]
                }
            });
        });</script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>