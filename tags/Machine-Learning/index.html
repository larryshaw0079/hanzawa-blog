<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>æ ‡ç­¾: Machine Learning - Hanzawa ã® éƒ¨å±‹</title><meta property="og:type" content="blog"><meta property="og:title" content="Hanzawa ã® éƒ¨å±‹"><meta property="og:url" content="http://qfxiao.me/"><meta property="og:site_name" content="Hanzawa ã® éƒ¨å±‹"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="Hanzawa"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="http://qfxiao.me/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://qfxiao.me"},"headline":"Hanzawa ã® éƒ¨å±‹","image":["http://qfxiao.me/img/og_image.png"],"author":{"@type":"Person","name":"Hanzawa"},"description":null}</script><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hanzawa ã® éƒ¨å±‹" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">æ ‡ç­¾</a></li><li class="is-active"><a href="#" aria-current="page">Machine Learning</a></li></ul></nav></div></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/"><img class="thumbnail" src="http://qfxiao.me/img/image-20200106141915707.png" alt="Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-01-06T05:09:32.000Z" title="2020-01-06T05:09:32.000Z">2020-01-06</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">18 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2770 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/">Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE</a></h1><div class="content"><h1 id="introduction">Introduction</h1>
<p><a href="https://ieeexplore.ieee.org/abstract/document/8737430/">è®ºæ–‡ğŸ“ƒ</a></p>
<p><a href="https://github.com/yantijin/Buzz">ä»£ç ğŸ“¥</a></p>
<p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§åˆ©ç”¨å¯¹æŠ—è®­ç»ƒæ¥è¿›è¡Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„æ–¹æ³•<em>Buzz</em>ã€‚ä½œè€…è®¤ä¸ºåœ¨ç°å®ä¸­å¤æ‚çš„KPIæ•°æ®å¤§é‡å­˜åœ¨ï¼Œè¿™ç§æ•°æ®é€šå¸¸å¸¦æœ‰éé«˜æ–¯åˆ†å¸ƒçš„å™ªå£°ï¼ŒåŒæ—¶æ•°æ®åˆ†å¸ƒå¤æ‚ï¼Œå¯¼è‡´ä¸€èˆ¬çš„ç”Ÿæˆå¼æ¨¡å‹æ— æ³•å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„å»ºæ¨¡ï¼Œæ‰€ä»¥ä½œè€…æå‡ºäº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„æ¨¡å‹ã€‚åœ¨æ–‡ä¸­ï¼Œä½œè€…çš„åˆ›æ–°ç‚¹ä¸»è¦æœ‰ä¸‰ä¸ªï¼š</p>
<ol type="1">
<li>ä¸ºäº†å¤„ç†å¤æ‚æ•°æ®ï¼Œå°†æ•°æ®ç©ºé—´åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼Œåœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šè¿›è¡Œè·ç¦»çš„åº¦é‡ï¼›</li>
<li>é‡‡ç”¨<em>Wasserstein</em>è·ç¦»åº¦é‡æ¨¡å‹å»ºæ¨¡çš„åˆ†å¸ƒå’ŒçœŸå®åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼›</li>
<li>å»ºç«‹äº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„<em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒVAEä¹‹é—´çš„å…³ç³»ã€‚</li>
</ol>
<p><img src="http://qfxiao.me/img/image-20200106141915707.png" /></p>
<h1 id="background">Background</h1>
<h2 id="anomaly-detection">Anomaly Detection</h2>
<p>å¯¹äºä»»æ„æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼<span class="math inline">\(x_{t-T+1},\cdots,x_t\)</span>ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º<span class="math inline">\(y_t=1\)</span>)ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚<span class="math inline">\(p(y_t=1|x_{t-T+1},\cdots,x_t)\)</span>ã€‚</p>
<h2 id="vae">VAE</h2>
<table>
<thead>
<tr class="header">
<th><strong>Model</strong></th>
<th><strong>Latent</strong></th>
<th><strong>Data</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong><em>Auto-encoder (AE)</em></strong></td>
<td><code>None</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr class="even">
<td><strong><em>Variational Auto-encoder (VAE)</em></strong></td>
<td><code>KL Divergence</code></td>
<td><code>Log Likelihood</code></td>
</tr>
<tr class="odd">
<td><strong><em>Adversarial Auto-encoder (AAE)</em></strong></td>
<td><code>Discriminator</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr class="even">
<td><strong><em>Wasserstein Auto-encoder (WAE)</em></strong></td>
<td><code>MaxMeanDiscrepancy</code> or <code>Discriminator</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr class="odd">
<td><strong><em>AlphaGAN</em></strong></td>
<td><code>Discriminator</code></td>
<td><code>Discriminator</code>+<code>L1Loss</code></td>
</tr>
</tbody>
</table>
<h2 id="gan-and-wgan-gp">GAN and WGAN-GP</h2>
<p>åŸå§‹GANç­‰ä»·äºä¼˜åŒ–ï¼š <span class="math display">\[
\mathbb{E}_{x\sim P_r}\log{\frac{P_r(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}+\mathbb{E}_{x\sim P_g}\log{\frac{P_g(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}
\]</span> æ ¹æ®KLæ•£åº¦å’ŒJSæ•£åº¦çš„å®šä¹‰ï¼š <span class="math display">\[
\text{KL}(P_1\parallel P_2)=\mathbb{E}_{x\sim P_1}\log{\frac{P_1}{P_2}}
\]</span></p>
<p><span class="math display">\[
\text{JS}(P_1\parallel P_2)=\frac{1}{2}\text{KL}(P_1\parallel \frac{P_1+P_2}{2})+\frac{1}{2}\text{KL}(P_2\parallel \frac{P_1+P_2}{2})
\]</span></p>
<p>å¯é‡å†™ä¸ºï¼š <span class="math display">\[
2\text{JS}(P_r\parallel P_g)-2\log 2
\]</span> å½“<span class="math inline">\(P_r\)</span>ä¸<span class="math inline">\(P_g\)</span>çš„æ”¯æ’‘é›†ï¼ˆsupportï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­çš„ä½ç»´æµå½¢ï¼ˆmanifoldï¼‰æ—¶ï¼Œ<span class="math inline">\(P_r\)</span>ä¸<span class="math inline">\(P_g\)</span>é‡å éƒ¨åˆ†æµ‹åº¦ï¼ˆmeasureï¼‰ä¸º0çš„æ¦‚ç‡ä¸º1ã€‚</p>
<ul>
<li>æ”¯æ’‘é›†ï¼ˆsupportï¼‰å…¶å®å°±æ˜¯å‡½æ•°çš„éé›¶éƒ¨åˆ†å­é›†ï¼Œæ¯”å¦‚<code>ReLU</code>å‡½æ•°çš„æ”¯æ’‘é›†å°±æ˜¯[å…¬å¼]ï¼Œä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„æ”¯æ’‘é›†å°±æ˜¯æ‰€æœ‰æ¦‚ç‡å¯†åº¦éé›¶éƒ¨åˆ†çš„é›†åˆã€‚</li>
<li>æµå½¢ï¼ˆmanifoldï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­æ›²çº¿ã€æ›²é¢æ¦‚å¿µçš„æ‹“å¹¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä½ç»´ä¸Šç›´è§‚ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œæ¯”å¦‚æˆ‘ä»¬è¯´ä¸‰ç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªæ›²é¢æ˜¯ä¸€ä¸ªäºŒç»´æµå½¢ï¼Œå› ä¸ºå®ƒçš„æœ¬è´¨ç»´åº¦ï¼ˆintrinsic dimensionï¼‰åªæœ‰2ï¼Œä¸€ä¸ªç‚¹åœ¨è¿™ä¸ªäºŒç»´æµå½¢ä¸Šç§»åŠ¨åªæœ‰ä¸¤ä¸ªæ–¹å‘çš„è‡ªç”±åº¦ã€‚åŒç†ï¼Œä¸‰ç»´ç©ºé—´æˆ–è€…äºŒç»´ç©ºé—´ä¸­çš„ä¸€æ¡æ›²çº¿éƒ½æ˜¯ä¸€ä¸ªä¸€ç»´æµå½¢ã€‚</li>
<li>æµ‹åº¦ï¼ˆmeasureï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­é•¿åº¦ã€é¢ç§¯ã€ä½“ç§¯æ¦‚å¿µçš„æ‹“å¹¿ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œè¶…ä½“ç§¯â€ã€‚</li>
</ul>
<p><em>Wasserstein</em>è·ç¦»å®šä¹‰å¦‚ä¸‹ï¼š <span class="math display">\[
W(P_r,P_g)=\inf\limits_{\gamma\sim\prod(P_r,P_g)}\mathbb{E}_{(x,y)\sim \gamma}\left[\parallel x-y\parallel\right]
\]</span> ä¸‹ç¡®ç•Œ<span class="math inline">\(\inf\)</span>æ²¡æ³•ç›´æ¥æ±‚è§£ï¼Œä¸è¿‡æ ¹æ®ç›¸å…³å®šç†å…¶ç­‰ä»·äºï¼š <span class="math display">\[
W(P_r,P_g)=\frac{1}{K}\sup\limits_{\parallel f\parallel_L\leq K}\mathbb{E}_{x\sim P_r}[f(x)]-\mathbb{E}_{x\sim P_g}[f(x)]
\]</span> <em>Lipschitz</em>è¿ç»­æ˜¯æŒ‡å­˜åœ¨ä¸€ä¸ªå¸¸æ•°<span class="math inline">\(K\geq 0\)</span>ä½¿å¾—å®šä¹‰åŸŸå†…ä»»æ„ä¸¤ä¸ªå…ƒç´ <span class="math inline">\(x_1\)</span>å’Œ<span class="math inline">\(x_2\)</span>éƒ½æ»¡è¶³ï¼š <span class="math display">\[
|f(x_1)-f(x_2)|\leq K|x_1-x_2|
\]</span> WANçš„æŸå¤±å‡½æ•°ï¼š <span class="math display">\[
\mathcal{L}=\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_g}\left[D({\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_r}\left[D(\mathbf{x})\right]
\]</span> WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[
\mathcal{L}=\mathop{\mathbb{E}}\limits_{\tilde{\mathbf{x}}\sim\mathbb{P}_g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits_{\hat{\mathbf{x}}\sim\mathbb{P}_{\hat{\mathbf{x}}}}\left[(\parallel\nabla_{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]
\]</span></p>
<h1 id="proposed-method">Proposed Method</h1>
<p>ä¸‹å›¾ä¸º<em>Buzz</em>çš„æ€»ä½“æµç¨‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200106141958376.png" /></p>
<p>æ•°æ®ä¼šé¦–å…ˆè¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼Œä¹‹åè¿›è¡Œè®­ç»ƒã€‚åœ¨æ£€æµ‹é˜¶æ®µä¼šæ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥åˆ¤å®šå¼‚å¸¸ã€‚</p>
<h2 id="motivation">Motivation</h2>
<p>åœ¨æ–‡ä¸­ï¼Œæœ€å…³é”®çš„ä¸¤ä¸ªåˆ›æ–°ç‚¹åˆ†åˆ«æ˜¯<em>Wasserstein</em>è·ç¦»å’Œå¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œåˆ†åŒºçš„æ–¹æ³•ã€‚</p>
<ul>
<li><p>åœ¨ä½¿ç”¨è·ç¦»åº¦é‡æ–¹é¢ï¼Œ å› ä¸º<em>Wasserstein</em>åœ¨WGANä¸­å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœï¼Œæ˜¯ä¸€ç§é²æ£’çš„è·ç¦»åº¦é‡ï¼Œæ‰€ä»¥ä½œè€…åœ¨æ–‡ä¸­é‡‡ç”¨äº†<em>Wasserstein</em>è·ç¦»æ¥è¡¡é‡ç”Ÿæˆçš„åˆ†å¸ƒå’ŒçœŸå®çš„åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå¹¶ç”±æ­¤å¼•å…¥äº†å¯¹æŠ—è®­ç»ƒï¼›</p></li>
<li><p>åœ¨åˆ†åŒºæ–¹æ³•æ–¹é¢ï¼Œä½œè€…è®¤ä¸ºåŸå§‹æ•°æ®è¿‡äºå¤æ‚ï¼Œæ‰€ä»¥å°†æ•°æ®ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>è¿›è¡Œåˆ’åˆ†ï¼Œç„¶ååœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šä½¿ç”¨<em>Wasserstein</em>åº¦é‡è·ç¦»ï¼Œè€Œæ€»ä½“çš„è·ç¦»ç”±æ¯ä¸ªåˆ†åŒºçš„è·ç¦»çš„æœŸæœ›æ±‚å¾—ã€‚</p></li>
</ul>
<p>ä½œè€…è¿˜å‘ç°ï¼Œå½“åˆ’åˆ†åœ°è¶Šæ¥è¶Šç»†æ—¶ï¼Œæ€»ä½“è·ç¦»æ¥è¿‘äºç‰¹å®šå½¢å¼çš„VAEçš„é‡æ„è¯¯å·®é¡¹ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20200106142008894.png" /></p>
<h2 id="network-structure">Network Structure</h2>
<p>ä¸‹å›¾ä¸ºæ¨¡å‹çš„ç½‘ç»œç»“æ„ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200106142018827.png" /></p>
<h2 id="training">Training</h2>
<h3 id="objective-function">Objective Function</h3>
<p>å…ˆå®šä¹‰ä¸€äº›ç¬¦å·ï¼š</p>
<ul>
<li><span class="math inline">\(b\)</span>å’Œ<span class="math inline">\(s\)</span>åˆ†åˆ«ä¸ºBatchçš„å¤§å°å’Œé‚»å±…çš„å¤§å°ï¼Œæ•°æ®é›†æŒ‰<span class="math inline">\(s\)</span>è¿›è¡Œåˆ‡åˆ†ï¼Œç„¶åéšæœºæ‰“ä¹±ï¼Œæ¯ä¸ªBatchåŒ…å«<span class="math inline">\(b\)</span>ä¸ª<span class="math inline">\(s\)</span>ï¼Œä¹‹å<span class="math inline">\(s/=2,b*=2\)</span>ï¼›</li>
<li><span class="math inline">\(\mathcal{W}=\{w_1,w_2,\cdots,w_b\}\)</span>ä¸ºä¸€ä¸ªBatchï¼Œä¸”æ»¡è¶³æ¯ä¸ª<span class="math inline">\(w_i\)</span>æ˜¯<span class="math inline">\(s\)</span>çš„å€æ•°ï¼›</li>
<li><span class="math inline">\(w\in\mathcal{W}\)</span>çš„é‚»åŸŸé›†(neighborhood set)ä¸ºä¸€ä¸ªæ—¶é—´ä¸Šçš„partitionï¼Œè®°ä¸º<span class="math inline">\(\{w,w+1,\cdots,w+s-1\}\)</span></li>
<li><span class="math inline">\(\mathbf{x}^{(w)},\mathbf{x}^{(w+1)},\cdots,\mathbf{x}^{(w+s-1)}\)</span>ä¸ºåœ¨ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>ä¸Šçš„ä¸€ä¸ªpartitionï¼Œè®°ä¸º<span class="math inline">\(S_w\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{x}^{(w)}\)</span>è¡¨ç¤ºä»¥<span class="math inline">\(w\)</span>ä¸ºç»“å°¾çš„æ—¶é—´çª—å£ã€‚</li>
</ul>
<p><em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒWGAN-GPç±»ä¼¼ï¼Œä½†åšäº†ä¸€äº›æ”¹è¿›ï¼Œç”±ä¸‹é¢å››éƒ¨åˆ†ç»„æˆï¼Œä¸‹é¢åˆ†åˆ«è§£é‡Šã€‚</p>
<p>ç¬¬ä¸€ä¸ªæ˜¯æ¯ä¸€ä¸ªpartitionçš„<span class="math inline">\(\mathbf{z}\)</span>åéªŒçš„KLæ•£åº¦ï¼š <span class="math display">\[
\mathcal{K} = \frac{1}{bs}\sum\limits_{w\in\mathcal{W}}\sum\limits_{i=1}^{s-1}\text{KL}\left[q_\phi(\mathbf{z}|\mathbf{x})\parallel\mathcal{N}(\mathbf{0},\mathbf{1})\right]
\]</span></p>
<p>ç¬¬äºŒä¸ªåœ¨è®­ç»ƒæ—¶æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼š <span class="math display">\[
Z(\lambda) = \frac{\Gamma(W)}{\Gamma(\frac{W}{2})}2\pi^{\frac{W}{2}}\lambda^{-W}
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\Gamma\)</span>æ˜¯<em>Gamma</em>å‡½æ•°ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªæ˜¯<em>Wasserstein</em>è·ç¦»ï¼š <span class="math display">\[
\mathcal{T}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}_{q_\phi(\mathbf{z}|\mathbf{x}^{w+i})}\left[F(\mathbf{x}^{(w+i)})-F(G(\mathbf{z}))\right]
\]</span></p>
<p>ç¬¬å››ä¸ªæ˜¯<em>Gradient Penalty</em>ï¼š</p>
<p><span class="math display">\[
\mathcal{R}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}_{q_\phi(\mathbf{z}|\mathbf{x}^{(w+i)})}\left[\mathbb{E}_{\varepsilon\sim[0,1]}(\parallel\nabla_{\hat{\mathbf{x}}}(\hat{\mathbf{x}})\parallel-\mathbf{1})^2\right]
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\hat{\mathbf{x}}=\varepsilon \mathbf{x}^{w+i}+(1-\varepsilon)G(\mathbf{z})\)</span>ä¸ºç”Ÿæˆæ•°æ®ä¸çœŸå®æ•°æ®çš„æ’å€¼ã€‚</p>
<blockquote>
<p>åŸå§‹çš„WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[
L=\mathop{\mathbb{E}}\limits_{\tilde{\mathbf{x}}\sim\mathbb{P}_g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}_r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits_{\hat{\mathbf{x}}\sim\mathbb{P}_{\hat{\mathbf{x}}}}\left[(\parallel\nabla_{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]
\]</span> å…¶ä¸­<span class="math inline">\(\mathbb{P}_g\)</span>ä¸ºç”Ÿæˆå™¨çš„åˆ†å¸ƒï¼Œ<span class="math inline">\(\mathbb{P}_r\)</span>ä¸ºçœŸå®åˆ†å¸ƒï¼Œ<span class="math inline">\(\mathbb{P}_{\hat{\mathbf{x}}}\)</span>ä¸ºçœŸå®æ•°æ®å’Œç”Ÿæˆæ•°æ®æ’å€¼å¾—åˆ°çš„åˆ†å¸ƒã€‚</p>
</blockquote>
<p><span class="math display">\[
\hat{\mathcal{L}}_{Buzz}=-\lambda\sup\limits_F\left[\sum\limits_{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)
\]</span></p>
<h3 id="training-procedure">Training Procedure</h3>
<p><em>Buzz</em>çš„è®­ç»ƒè¿‡ç¨‹ä¸WGAN-GPç±»ä¼¼ï¼Œ</p>
<h2 id="detection">Detection</h2>
<p>æ–‡ä¸­å‡è®¾è§£ç å™¨çš„è¾“å‡ºæœä»å¦‚ä¸‹åˆ†å¸ƒï¼š</p>
<p><span class="math display">\[
p_\theta(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp\{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel\}
\]</span></p>
<p>ä½œè€…å®šä¹‰å¼‚å¸¸åˆ†æ•°ä¸ºï¼š <span class="math display">\[
\mathcal{S}=\log p_\theta(\mathbf{x})-\log p_\theta(\bar{\mathbf{x}})
\]</span> å…¶ä¸­<span class="math inline">\(\bar{\mathbf{x}}\)</span>ä¸ºç»è¿‡MCMCå¡«å……åçš„æ ·æœ¬ã€‚</p>
<p>å¼‚å¸¸åˆ†æ•°ä¹Ÿå¯ä»¥å±•å¼€ä¸ºï¼š <span class="math display">\[
\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\mathbf{x}|\mathbf{z^{(l)}})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]-\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\bar{\mathbf{x}}|\mathbf{z}^{(l)})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]
\]</span></p>
<p>æœ€ç»ˆç®—æ³•æµç¨‹å›¾ä¸ºï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200106142053342.png" /></p>
<h2 id="theoretical-analysis">Theoretical Analysis</h2>
<p>åœ¨ç†è®ºåˆ†æä¸­ï¼Œä½œè€…ä¸»è¦æ˜¯æƒ³å»ºç«‹<span class="math inline">\(\mathcal{L}_{Buzz}\)</span>å’ŒVAEçš„æŸå¤±å‡½æ•°<span class="math inline">\(\mathcal{L}_{vae}\)</span>ä¹‹é—´çš„è”ç³»ï¼ŒæŸå¤±å‡½æ•°<span class="math inline">\(\mathcal{\hat{L}}_{Buzz}\)</span>ä¸ºï¼š</p>
<p><span class="math display">\[
\hat{\mathcal{L}}_{Buzz}=-\lambda\sup\limits_F\left[\sum\limits_{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)
\]</span></p>
<p>ä¸ºäº†ä¾¿äºåˆ†æï¼Œå»æ‰<em>Gradient Penalty</em>çš„éƒ¨åˆ†ï¼Œå…¬å¼å¯ç®€åŒ–ä¸ºï¼š</p>
<p><span class="math display">\[
\mathcal{L}_{Buzz}=-\lambda\mathbb{E}_{p(w)}W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]-\mathcal{K}-\log Z(\lambda)
\]</span></p>
<p>å®é™…ä¸Š<span class="math inline">\(Z(\lambda)=\mathfrak{S}_W\Gamma(W)\lambda^{-W}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathfrak{S}_W\)</span>ä¸º<span class="math inline">\(W\)</span>ç»´å•ä½çƒçš„è¡¨é¢ç§¯ã€‚</p>
<blockquote>
<p><span class="math inline">\(n\)</span>ç»´ç©ºé—´å•ä½çƒè¡¨é¢ç§¯å…¬å¼ï¼š <span class="math display">\[
\omega_n=\frac{2\pi^{\frac{n}{2}}}{\Gamma(\frac{n}{2})}
\]</span></p>
</blockquote>
<p>è€Œ<span class="math inline">\(W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]\)</span>ä¸º<em>Wasserstein</em>è·ç¦»ï¼š <span class="math display">\[
W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]=\sup\limits_{Lip(f)\leq 1}\left\{\int_\mathcal{X}f(\mathbf{x})p(\mathbf{x}|w)\mathrm{d}\mathbf{x}-\int_\mathcal{X}f(\mathbf{y})p(\mathbf{y}|w)\mathrm{d}\mathbf{y}\right\}
\]</span></p>
<h3 id="lemma-1">Lemma 1</h3>
<p>é€šè¿‡è®¾å®šå…·ä½“å½¢å¼çš„åéªŒåˆ†å¸ƒï¼ŒVAEçš„æŸå¤±å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p>
<blockquote>
<p>è®¾<span class="math inline">\(\mathbf{x}\)</span>çš„åéªŒåˆ†å¸ƒ<span class="math inline">\(p(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp\{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel\}\)</span>ï¼Œé‚£ä¹ˆVAEçš„æŸå¤±å‡½æ•°ä¸ºï¼š <span class="math display">\[
\mathcal{L}_{vae}=\lambda\mathbb{E}_{p(w)}\left[\mathbb{E}_{p(\mathbf{x}|w)}\mathbb{E}_{p_G(\mathbf{y}|\mathbf{x})}-\parallel\mathbf{x}-\mathbf{y}\parallel\right]-\mathcal{K}-\log{Z(\lambda)}
\]</span></p>
</blockquote>
<p>åéªŒåˆ†å¸ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªLaplaceåˆ†å¸ƒï¼š</p>
<blockquote>
<p><strong>Laplace Distribution</strong>: <span class="math display">\[
f(x|\theta,\lambda)=\frac{1}{2\lambda}\exp{\left(-\frac{|x-\theta|}{\lambda}\right)}
\]</span></p>
</blockquote>
<p>å¯ä»¥ç›´æ¥æŠŠåéªŒåˆ†å¸ƒå¸¦å…¥VAEçš„æŸå¤±å‡½æ•°å°±å¾—åˆ°äº†ã€‚</p>
<h3 id="lemma-2">Lemma 2</h3>
<p><span class="math inline">\(S_w\)</span>å®šä¹‰ä¸ºæ•°æ®ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>çš„ä¸€ä¸ªpartitionï¼Œè€Œ<span class="math inline">\(S=\{(\mathbf{x}_1,\mathbf{x}_2)|\exist w, \mathbf{x}_1\in S_w,\mathbf{x}_2\in S_w\}\)</span>ã€‚</p>
<blockquote>
<p>å½“<span class="math inline">\(G,\phi,\lambda\)</span>å›ºå®šæ—¶ï¼Œ<span class="math inline">\(S\downarrow\)</span>æœ‰<span class="math inline">\(\mathcal{L}_{Buzz}\downarrow\)</span></p>
</blockquote>
<h3 id="lemma-3">Lemma 3</h3>
<blockquote>
<p><span class="math inline">\(\max\mathcal{L}_{Buzz}\geq\max{\mathcal{L}_{vae}}\)</span>ï¼ŒåŒæ—¶ï¼Œå½“<span class="math inline">\(S\downarrow\text{diag}{\mathcal{X}}\)</span>æ—¶<span class="math inline">\(\max\mathcal{L}_{Buzz}\downarrow\max\mathcal{L}_{vae}\)</span></p>
</blockquote>
<p><img src="http://qfxiao.me/img/image-20200106183833975.png" /></p>
<h3 id="lemma-4">Lemma 4</h3>
<blockquote>
<p>ä»¤<span class="math inline">\(p^\prime_G(\mathbf{y}|\mathbf{x})\)</span>è¡¨ç¤º<span class="math inline">\(\mathbb{E}_{q_{\phi^\prime}}\left[p_G(\mathbf{y}|\mathbf{z})\right]\)</span>ã€‚å¦‚æœ<span class="math inline">\((G,\phi,\lambda)\)</span>æ˜¯ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆå­˜åœ¨<span class="math inline">\((G,\phi^\prime,\lambda)\)</span>ä½¿å¾—ï¼š <span class="math display">\[
\mathbb{E}_{p(\mathbf{x}|w)}\mathbb{E}_{p_G^\prime(\mathbf{y}|\mathbf{x})}\parallel\mathbf{x}-\mathbf{y}\parallel=W^1\left[P(\mathbf{x}|w)\parallel P_G(\mathbf{y}|w)\right]
\]</span> æ­¤æ—¶<span class="math inline">\(\mathcal{L}_{Buzz}-\mathcal{L}_{vae}^\prime=\mathcal{K}^\prime-\mathcal{K}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathcal{L}^\prime,\mathcal{K}^\prime\)</span>åˆ†åˆ«ä¸º<span class="math inline">\((G,\phi^\prime,\lambda)\)</span>æ—¶çš„<span class="math inline">\(\mathcal{L}\)</span>å’Œ<span class="math inline">\(\mathcal{K}\)</span>ã€‚</p>
</blockquote>
<p><span class="math display">\[
\mathcal{L}^\dagger_{Buzz}=\mathbb{E}_{p(\mathbf{x})}\left[\mathbb{E}_{q_{\phi^\prime}(\mathbf{z}|\mathbf{x})}\log_{p_\theta}(\mathbf{x}|\mathbf{z})\right]-\min\limits_{\bar{\phi}\sim\phi^\prime}\bar{\mathcal{K}}
\]</span></p>
<h3 id="lemma-5">Lemma 5</h3>
<p>è¿™é‡Œä¸»è¦æ˜¯æƒ³è¯æ˜</p>
<blockquote>
<p>å¯¹äºå›ºå®šçš„<span class="math inline">\(w\)</span>ï¼Œä»¤ï¼š <span class="math display">\[
\mathcal{F}=\{f|Lip(f)\leq 1\}, \space \mathcal{F}^*=\left\{f|_{S_w}\bigg|Lip(f|_{S_w})\leq 1\right\}
\]</span> æœ‰<span class="math inline">\(\sup_{f\in\mathcal{F}}\mathcal{T}(f)=\sup_{f|_{S_w}\in\mathcal{F}^*}\mathcal{T}^*\left(f|_{S_w}\right)\)</span>ã€‚</p>
</blockquote>
<h3 id="theorem-6">Theorem 6</h3>
<blockquote>
<p><span class="math inline">\(\mathcal{L}_{Buzz}\)</span>çš„å¯¹å¶å½¢å¼ä¸ºï¼š <span class="math display">\[
\mathcal{L}_{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}^*(F)-\mathcal{K}-\log Z(\lambda)
\]</span></p>
</blockquote>
<p>è¿‘ä¼¼çš„<span class="math inline">\(\mathcal{L}_{Buzz}\)</span>çš„å¯¹å¶å½¢å¼ä¸ºï¼š <span class="math display">\[
\bar{\mathcal{L}}_{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}(F)-\mathcal{K}-\log Z(\lambda)
\]</span></p>
<h1 id="experiment">Experiment</h1>
<p><img src="http://qfxiao.me/img/image-20200106142131500.png" /></p>
<p><img src="http://qfxiao.me/img/image-20200106142155978.png" /></p>
<p><img src="http://qfxiao.me/img/image-20200106142212110.png" /></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/10/29/Anomaly-Detection-in-Streams-with-Extreme-Value-Theory/"><img class="thumbnail" src="http://qfxiao.me/img/image-20191029114054583.png" alt="Anomaly Detection in Streams with Extreme Value Theory"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-29T03:36:22.000Z" title="2019-10-29T03:36:22.000Z">2019-10-29</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">18 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2650 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/29/Anomaly-Detection-in-Streams-with-Extreme-Value-Theory/">Anomaly Detection in Streams with Extreme Value Theory</a></h1><div class="content"><h1 id="introduction">Introduction</h1>
<p>æœ¬æ–‡åŸºäº<strong>Extreme Value Theory</strong>æå‡ºäº†ä¸€ç§ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®é˜ˆå€¼ä¹Ÿä¸éœ€è¦å¯¹æ•°æ®åˆ†å¸ƒä½œä»»ä½•å‡è®¾çš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæœ¬æ–¹æ³•å¯ä»¥ç”¨åœ¨é€šç”¨çš„è‡ªåŠ¨é˜ˆå€¼é€‰æ‹©çš„åœºåˆä¸­ã€‚</p>
<p><a href="https://www.kdd.org/kdd2017/papers/view/anomaly-detection-in-streams-with-extreme-value-theory">åŸæ–‡</a></p>
<h1 id="background">Background</h1>
<p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚é˜ˆå€¼çš„é€‰æ‹©å¯ä»¥é€šè¿‡å®éªŒçš„æ–¹æ³•æˆ–è€…å¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œå‡è®¾çš„æ–¹æ³•æ¥å¾—åˆ°ï¼Œä¸è¿‡è¿™æ ·åšé€šå¸¸ä¸å‡†ç¡®ã€‚å€ŸåŠ©<strong>Extreme Value Theory</strong>æˆ‘ä»¬å¯ä»¥åœ¨ä¸éœ€è¦å¯¹åŸå§‹æ•°æ®çš„åˆ†å¸ƒä½œå¾ˆå¼ºçš„å‡è®¾çš„æƒ…å†µä¸‹ï¼Œæ¨æ–­æˆ‘ä»¬æƒ³è¦çš„æç«¯äº‹ä»¶çš„åˆ†å¸ƒï¼ˆåœ¨å¼‚å¸¸æ£€æµ‹ä¸­å°±æ˜¯å¼‚å¸¸å€¼ï¼‰ã€‚</p>
<p>ä¸‹é¢ç»™å‡ºä¸€äº›æ•°å­¦ç¬¦å·ï¼Œ<span class="math inline">\(X\)</span>ä¸ºéšæœºå˜é‡ï¼Œ<span class="math inline">\(F\)</span>ä¸ºç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œå³<span class="math inline">\(F(x)=\mathbb{P}(X\leq x)\)</span>ã€‚è®°<span class="math inline">\(F\)</span>çš„â€œæœ«å°¾â€åˆ†å¸ƒ<span class="math inline">\(\bar{F}(x)=1-F(x)=\mathbb{P}(X&gt;x)\)</span>ã€‚å¯¹äºä¸€ä¸ªéšæœºå˜é‡<span class="math inline">\(X\)</span>å’Œç»™å®šçš„æ¦‚ç‡<span class="math inline">\(q\)</span>ï¼Œè®°<span class="math inline">\(z_q\)</span>ä¸ºåœ¨<span class="math inline">\(1-q\)</span>æ°´å¹³çš„åˆ†ä½æ•°ï¼Œå³<span class="math inline">\(z_q\)</span>ä¸ºæ»¡è¶³<span class="math inline">\(\mathbb{P}(X\leq z_q)\geq 1-q\)</span>æœ€å°çš„å€¼ã€‚</p>
<h2 id="extreme-value-distributions">Extreme Value Distributions</h2>
<p><strong>Extreme Value Theory</strong>ä¸»è¦æ˜¯ä¸ºäº†æ‰¾å‡ºæç«¯äº‹ä»¶å‘ç”Ÿçš„è§„å¾‹ï¼Œæœ‰å­¦è€…è¯æ˜ï¼Œåœ¨å¾ˆå¼±çš„æ¡ä»¶ä¸‹ï¼Œæ‰€æœ‰æç«¯äº‹ä»¶éƒ½æœä»ä¸€ä¸ªç‰¹å®šçš„åˆ†å¸ƒï¼Œè€Œä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ã€‚å…·ä½“å½¢å¼å¦‚ä¸‹ï¼š</p>
<p><span class="math display">\[
G_\gamma:x\mapsto \exp(-(1+\gamma x)^{-\frac{1}{\gamma}}), \space\space\space\space\space\gamma\in\mathbb{R}, \space\space\space\space\space 1+\gamma x&gt;0
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\gamma\)</span>ç§°ä¸º<strong>Extreme Value Index</strong>ï¼Œç”±åŸå§‹åˆ†å¸ƒå†³å®šã€‚</p>
<p>æ›´ä¸¥è°¨çš„è¯´æ³•æ˜¯Fisher-Tippett-Gnedenkoå®šç†ï¼ˆæå€¼ç†è®ºç¬¬ä¸€å®šç†ï¼‰ï¼š</p>
<blockquote>
<p><strong>THEOREM: </strong>(Fisher-Tippett-Gnedenko). ä»¤<span class="math inline">\(X_1,X_2,\cdots,X_n,\cdots\)</span>ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡åºåˆ—ï¼Œ<span class="math inline">\(M_n=\max \{X_1,\cdots,X_n\}\)</span>ã€‚å¦‚æœå®æ•°å¯¹åºåˆ—<span class="math inline">\((a_n,b_n)\)</span>å­˜åœ¨ä¸”æ»¡è¶³<span class="math inline">\(a_n&gt;0\)</span>å’Œ<span class="math inline">\(\lim\limits_{n\rightarrow \infty}P\left(\frac{M_n-b_n}{a_n}\leq x\right)=F(x)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(F\)</span>ä¸ºéé€€åŒ–åˆ†å¸ƒå‡½æ•°ï¼Œé‚£ä¹ˆ<span class="math inline">\(F\)</span>å±äºGumbelã€FrÃ©chetæˆ–Weibullåˆ†å¸ƒæ—ï¼ˆæˆ–æ€»ç§°Generalized Extreme Value Distributionï¼‰ä¸­çš„ä¸€ç§ã€‚</p>
</blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªåç›´è§‰çš„ç»“è®ºï¼Œä½†æ˜¯æƒ³åˆ°å½“äº‹ä»¶å‘ç”Ÿå˜å¾—æç«¯æ—¶ï¼Œå³<span class="math inline">\(\mathbb{P}(X&gt;x)\rightarrow 0\)</span>ï¼Œ<span class="math inline">\(\bar{F}(x)=\mathbb{P}(X&gt;x)\)</span>åˆ†å¸ƒçš„å½¢çŠ¶å…¶å®å¹¶æ²¡æœ‰å¾ˆå¤šç§é€‰æ‹©ã€‚Table 1å±•ç¤ºäº†å‡ ç§ä¸åŒåˆ†å¸ƒå¯¹åº”çš„<span class="math inline">\(\gamma\)</span>ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191029162343219.png" /></p>
<p>Figure 1å±•ç¤ºäº†å‡ ç§ä¸åŒ<span class="math inline">\(\gamma\)</span>æƒ…å†µä¸‹çš„â€œæœ«å°¾â€åˆ†å¸ƒï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191029113903386.png" /></p>
<h2 id="power-of-evt">Power of EVT</h2>
<p>æ ¹æ®<strong>Extreme Value Theory</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸå§‹åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹è®¡ç®—æç«¯äº‹ä»¶çš„æ¦‚ç‡ã€‚ä½†æ˜¯<span class="math inline">\(\bar{G}_\gamma\)</span>åˆ†å¸ƒä¸­å‚æ•°<span class="math inline">\(\gamma\)</span>æ˜¯æœªçŸ¥çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§é«˜æ•ˆçš„æ–¹æ³•æ¥è¿›è¡Œä¼°è®¡ã€‚<strong>The Peaks-Over-Threshold</strong> (POT) æ–¹æ³•æ˜¯æœ¬æ–‡ä»‹ç»çš„ä¸€ç§æ–¹æ³•ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20191029162456947.png" /></p>
<h2 id="peaks-over-threshold-approach">Peaks-Over-Threshold Approach</h2>
<p>POTæ–¹æ³•ä¾èµ–äºPickands-Balkema-De Haanå®šç†ï¼ˆæå€¼ç†è®ºç¬¬äºŒå®šç†ï¼‰ï¼Œç»´åŸºç™¾ç§‘ç‰ˆï¼š</p>
<blockquote>
<p>è€ƒè™‘ä¸€ä¸ªæœªçŸ¥åˆ†å¸ƒ<span class="math inline">\(F\)</span>å’Œéšæœºå˜é‡<span class="math inline">\(X\)</span>ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡<span class="math inline">\(X\)</span>åœ¨è¶…è¿‡ç¡®å®šé˜ˆå€¼<span class="math inline">\(u\)</span>ä¸‹çš„æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(F_u\)</span>ï¼Œå®šä¹‰ä¸ºï¼š <span class="math display">\[
F_u(y)=P(X-u\leq y|X&gt;u)=\frac{F(u+y)-F(u)}{1-F(u)}
\]</span> å…¶ä¸­<span class="math inline">\(0\leq y\leq x_F-u\)</span>ï¼Œ<span class="math inline">\(x_F\)</span>ä¸º<span class="math inline">\(F\)</span>çš„å³ç«¯ç‚¹ã€‚<span class="math inline">\(F_u\)</span>æè¿°äº†è¶…è¿‡ç‰¹å¾é˜ˆå€¼<span class="math inline">\(u\)</span>çš„åˆ†å¸ƒï¼Œç§°ä¸º<strong>Conditional Excess Distribution Function</strong>ã€‚</p>
<p><strong>STATEMENT: </strong>(Pickands-Balkema-De Haan). è®¾<span class="math inline">\((X_1,X_2,\cdots)\)</span>ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒéšæœºå˜é‡åºåˆ—ï¼Œ<span class="math inline">\(F_u\)</span>ä¸ºç›¸åº”çš„Conditional Excess Distribution Functionã€‚å¯¹äºä¸€å¤§ç±»çš„<span class="math inline">\(F\)</span>å’Œå¾ˆå¤§çš„<span class="math inline">\(u\)</span>ï¼Œ<span class="math inline">\(F_u\)</span>èƒ½å¤Ÿå¾ˆå¥½çš„è¢«Generalized Pareto Distributionæ‰€æ‹Ÿåˆï¼š <span class="math display">\[
F_u(y)\rightarrow G_{k,\sigma}(y),\space\space \text{as } u\rightarrow \infty
\]</span> å…¶ä¸­ï¼š <span class="math display">\[
G_{k,\sigma}(y)=
\begin{cases}
1-(1+ky/\sigma)^{-1/k}, &amp;\text{if }k\neq 0\\
1-e^{-y/\sigma}, &amp;\text{if }k=0
\end{cases}
\]</span> å½“<span class="math inline">\(k\geq 0\)</span>æ—¶<span class="math inline">\(\sigma&gt;0, y\geq 0\)</span>ï¼Œ<span class="math inline">\(k&lt;0\)</span>æ—¶<span class="math inline">\(0\leq y\leq -\sigma/k\)</span>ã€‚</p>
</blockquote>
<p>è®ºæ–‡ä¸­ç»™å‡ºçš„å®šç†å¦‚ä¸‹ï¼š</p>
<blockquote>
<p><strong>THEOREM: </strong>(Pickands-Balkema-De Haan). ç´¯ç§¯æ¦‚ç‡å¯†åº¦å‡½æ•°<span class="math inline">\(F\in\mathcal{D}_\gamma\)</span>å½“ä¸”ä»…å½“å‡½æ•°<span class="math inline">\(\sigma\)</span>å­˜åœ¨æ—¶ï¼Œå¯¹æ‰€æœ‰<span class="math inline">\(x\in\mathbb{R}\)</span>åœ¨<span class="math inline">\(1+\gamma x&gt;0\)</span>çš„æ¡ä»¶ä¸‹æœ‰ï¼š <span class="math display">\[
\frac{\bar{F}(t+\sigma(t)x)}{\bar{F}(t)}\mathop{\rightarrow}\limits_{t\rightarrow\tau}(1+\gamma x)^{-\frac{1}{\gamma}}
\]</span></p>
</blockquote>
<p>ä¸Šå¼å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š <span class="math display">\[
\bar{F}_t(x)=\mathbb{P}(X-t&gt;x|X&gt;t)\mathop{\sim}\limits_{t\rightarrow\tau}\left(1+\frac{\gamma x}{\sigma(t)}\right)^{-\frac{1}{\gamma}}
\]</span> è¯¥å¼è¡¨æ˜<span class="math inline">\(X\)</span>è¶…è¿‡é˜ˆå€¼<span class="math inline">\(t\)</span>çš„æ¦‚ç‡ï¼ˆå†™ä¸º<span class="math inline">\(X-t\)</span>ï¼‰æœä»<strong>Generalized Pareto Distribution</strong> (GPD)ï¼Œå‚æ•°ä¸º<span class="math inline">\(\gamma\)</span>å’Œ<span class="math inline">\(\sigma\)</span>ã€‚POTä¸»è¦æ˜¯æ‹ŸåˆGPDè€Œä¸æ˜¯EVTåˆ†å¸ƒã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è¦ä¼°è®¡å‚æ•°<span class="math inline">\(\hat{\gamma}\)</span>å’Œ<span class="math inline">\(\hat{\sigma}\)</span>ï¼Œåˆ†ä½æ•°å¯ä»¥é€šè¿‡ä¸‹å¼è®¡ç®—å¾—åˆ°ï¼š <span class="math display">\[
z_q\simeq t+\frac{\hat{\sigma}}{\hat{\gamma}}\left(\left(\frac{qn}{N_t}\right)^{-\hat{\gamma}}-1\right)
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(t\)</span>æ˜¯ä¸€ä¸ªâ€œå¾ˆé«˜â€çš„é˜ˆå€¼ï¼Œ<span class="math inline">\(q\)</span>æ˜¯ç»™å®šçš„æ¦‚ç‡å€¼ï¼Œ<span class="math inline">\(n\)</span>æ˜¯æ‰€æœ‰è§‚æµ‹æ ·æœ¬çš„æ•°é‡ï¼Œ<span class="math inline">\(N_t\)</span>æ˜¯peaksçš„æ•°é‡ï¼Œå³<span class="math inline">\(X_i&gt;t\)</span>çš„æ•°é‡ã€‚ä¸ºäº†è¿›è¡Œé«˜æ•ˆçš„å‚æ•°ä¼°è®¡ï¼Œæ–‡ä¸­ä½¿ç”¨äº†æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p>
<h2 id="maximum-likelihood-estimation">Maximum Likelihood Estimation</h2>
<p>è®¾<span class="math inline">\(X_1,\cdots,X_n\)</span>ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°è®°ä¸º<span class="math inline">\(f_\theta\)</span>ï¼Œ<span class="math inline">\(\theta\)</span>ä¸ºåˆ†å¸ƒä¸­çš„å‚æ•°ï¼Œé‚£ä¹ˆä¼¼ç„¶å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p>
<p><span class="math display">\[
\mathcal{L}(X_1,\cdots,X_n;\theta)=\prod\limits_{i=1}^n f_\theta(X_i)
\]</span></p>
<p>åœ¨æå¤§ä¼¼ç„¶ä¼°è®¡ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°åˆé€‚çš„å‚æ•°ä½¿å¾—ä¼¼ç„¶å‡½æ•°æœ€å¤§åŒ–ã€‚åœ¨æˆ‘ä»¬çš„é—®é¢˜ä¸­ï¼Œä¼¼ç„¶å‡½æ•°å¦‚ä¸‹ï¼š <span class="math display">\[
\log\mathcal{L}(\gamma,\sigma)=-N_t\log\sigma-\left(1+\frac{1}{\gamma}\right)\sum\limits_{i=1}^{N_t}\log\left(1+\frac{\gamma}{\sigma}Y_i\right)
\]</span> å…¶ä¸­<span class="math inline">\(Y_i&gt;0\)</span>è¡¨ç¤º<span class="math inline">\(X_i\)</span>è¶…è¿‡é˜ˆå€¼<span class="math inline">\(t\)</span>çš„éƒ¨åˆ†ã€‚</p>
<p>æ–‡ä¸­ä½¿ç”¨äº†<strong>Grimshaw's Trick</strong>æ¥å°†å«ä¸¤ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜è½¬æ¢ä¸ºåªå«ä¸€ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜ã€‚è®°<span class="math inline">\(\ell(\gamma,\sigma)=\log\mathcal{L}(\gamma,\sigma)\)</span>ï¼Œå¯¹äºæ‰€æœ‰æå€¼æ¥è¯´æœ‰<span class="math inline">\(\nabla \ell(\gamma, \sigma)=0\)</span>ã€‚Grimshaw's Trickè¡¨æ˜å¯¹äºæ»¡è¶³<span class="math inline">\(\nabla \ell(\gamma, \sigma)=0\)</span>çš„ä¸€å¯¹<span class="math inline">\((\gamma^*,\sigma^*)\)</span>ï¼Œ<span class="math inline">\(x^*=\frac{\gamma^*}{\sigma^*}\)</span>ä¸ºç­‰å¼<span class="math inline">\(u(X)v(X)=1\)</span>çš„è§£ï¼Œå…¶ä¸­ï¼š <span class="math display">\[
\begin{align}
u(x)&amp;=\frac{1}{N_t}\sum\limits_{i=1}^{N_t}\frac{1}{1+xY_i}\\
v(x)&amp;=1+\frac{1}{N_t}\sum\limits_{i=1}^{N_t}\log(1+xY_i)
\end{align}
\]</span> åœ¨æ‰¾åˆ°æ»¡è¶³è¯¥ç­‰å¼çš„è§£<span class="math inline">\(x^*\)</span>åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<span class="math inline">\(\gamma^*=v(x^*)-1\)</span>å’Œ<span class="math inline">\(\sigma^*=\gamma^*/x^*\)</span>ï¼Œäºæ˜¯é—®é¢˜å°±å˜æˆäº†å¦‚ä½•å¯»æ‰¾æ–¹ç¨‹çš„æ‰€æœ‰æ ¹ã€‚</p>
<p>å› ä¸º<span class="math inline">\(\log\)</span>çš„å­˜åœ¨ï¼Œæ‰€ä»¥æœ‰<span class="math inline">\(1+xY_i&gt;0\)</span>ã€‚è€Œ<span class="math inline">\(Y_i\)</span>æ˜¯æ­£æ•°ï¼Œæ‰€ä»¥<span class="math inline">\(x^*\)</span>çš„èŒƒå›´ä¸€å®šåœ¨<span class="math inline">\(\left(-\frac{1}{Y^M},+\infty\right)\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(Y^M=\max Y_i\)</span>ã€‚</p>
<p>Grimshawï¼ˆä½œè€…å‚è€ƒçš„ä¸€ç¯‡<a href="https://www.tandfonline.com/doi/abs/10.1080/00401706.1993.10485040">è®ºæ–‡</a>ï¼‰è¿˜ç»™å‡ºäº†ä¸€ä¸ªä¸Šç•Œï¼š <span class="math display">\[
x^*_{\text{max}}=2\frac{\bar{Y}-Y^m}{(Y^m)^2}
\]</span> å…¶ä¸­<span class="math inline">\(Y^m=\min Y_i\)</span>ï¼Œ<span class="math inline">\(\bar{Y}\)</span>ä¸º<span class="math inline">\(Y_i\)</span>çš„å‡å€¼ã€‚è¯¦ç»†çš„ä¼˜åŒ–æ–¹æ³•ä¼šåœ¨ä¸‹æ–‡è®¨è®ºã€‚</p>
<p>èƒŒæ™¯éƒ¨åˆ†åˆ°æ­¤ç»“æŸï¼Œæ¥ä¸‹æ¥çš„éƒ¨åˆ†å°±æ˜¯ä½œè€…æå‡ºçš„æ–°æ–¹æ³•ã€‚</p>
<h1 id="methodology">Methodology</h1>
<p>Extreme Value Theoryç»™å‡ºäº†åœ¨å¯¹åŸå§‹åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡ä½¿å¾—<span class="math inline">\(\mathbb{P}(X&gt;z_q)&lt;q\)</span>çš„<span class="math inline">\(z_q\)</span>çš„æ–¹æ³•ã€‚</p>
<p>æœ¬æ–‡æ®æ­¤æå‡ºäº†æ—¶é—´åºåˆ—æµçš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•ã€‚é¦–å…ˆæ ¹æ®å·²çŸ¥çš„è§‚æµ‹å€¼<span class="math inline">\(X_1,\cdots,X_n\)</span>å¾—åˆ°é˜ˆå€¼<span class="math inline">\(z_q\)</span>ï¼Œç„¶åæ ¹æ®æ•°æ®çš„ç‰¹æ€§è¿ç”¨ä¸¤ç§ä¸åŒæ–¹æ³•æ¥æ›´æ–°<span class="math inline">\(z_q\)</span>ã€‚å¯¹äºå¹³ç¨³æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨SPOTï¼›å¯¹äºéå¹³ç¨³æ—¶é—´åºåˆ—ï¼Œä½¿ç”¨DSPOTã€‚</p>
<h2 id="initialization-step">Initialization Step</h2>
<p>åœ¨è¿›è¡Œå¼‚å¸¸æ£€æµ‹ä¹‹å‰ï¼Œéœ€è¦æ ¹æ®å·²æœ‰çš„è§‚æµ‹æ•°æ®è¿›è¡Œ<span class="math inline">\(z_q\)</span>çš„ä¼°è®¡ã€‚ç»™å®š<span class="math inline">\(n\)</span>ä¸ªè§‚æµ‹å€¼<span class="math inline">\(X_1,\cdots,X_n\)</span>å’Œä¸€ä¸ªå›ºå®šçš„æ¦‚ç‡å€¼<span class="math inline">\(q\)</span>ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¼°è®¡é˜ˆå€¼<span class="math inline">\(z_q\)</span>ä½¿å¾—<span class="math inline">\(\mathbb{P}(X&gt;z_q)&lt;q\)</span>ã€‚å…¶ä¸»è¦æµç¨‹æ˜¯é¦–å…ˆè®¾å®šä¸€ä¸ªè¾ƒå¤§çš„é˜ˆå€¼<span class="math inline">\(t\)</span>ï¼Œç„¶åé€šè¿‡æ‹ŸåˆGPDåˆ†å¸ƒæ¥è®¡ç®—<span class="math inline">\(z_q\)</span>ã€‚è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191029114030518.png" /></p>
<p>ç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191029114001461.png" /></p>
<p><span class="math inline">\(Y_t\)</span>ä»£è¡¨å¤§äº<span class="math inline">\(t\)</span>çš„è§‚æµ‹å€¼çš„é›†åˆï¼ŒGPDåˆ†å¸ƒçš„æ‹Ÿåˆä½¿ç”¨äº†å‰æ–‡æåˆ°çš„Grimshaw's Trickã€‚</p>
<h2 id="finding-anomalies-in-a-stream">Finding Anomalies in a Stream</h2>
<p>é€šè¿‡Initialization Stepä½¿ç”¨POTç®—æ³•å¾—åˆ°çš„<span class="math inline">\(z_q\)</span>ï¼Œæˆ‘ä»¬å®šä¹‰å…¶ä¸º&quot;Normality Bound&quot;ï¼Œç”¨äºåé¢çš„æ£€æµ‹ã€‚åœ¨åé¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®æ–°å¾—åˆ°çš„è§‚æµ‹å€¼æ¥æ›´æ–°<span class="math inline">\(z_q\)</span>ã€‚</p>
<h3 id="stationary-case">Stationary Case</h3>
<p>æˆ‘ä»¬é¦–å…ˆæ¥è®¨è®ºæ—¶é—´åºåˆ—æ²¡æœ‰æ—¶é—´ä¾èµ–æ€§çš„æƒ…å†µï¼ˆ<span class="math inline">\(X_1,\cdots,X_n\)</span>ä¹‹é—´ç‹¬ç«‹åŒåˆ†å¸ƒï¼‰ã€‚é€šè¿‡POTç®—æ³•å¯¹æ‰€æœ‰è§‚æµ‹å€¼å¾—åˆ°<span class="math inline">\(z_q\)</span>ä¹‹åï¼ŒStreaming POT (SPOT) ç®—æ³•ä¼šæ£€æŸ¥<span class="math inline">\(X_n\)</span>ä¹‹åçš„å€¼ï¼ˆæ•°æ®æµåœºæ™¯ï¼Œ<span class="math inline">\(X_1,\cdots,X_n\)</span>æ˜¯å†å²æ•°æ®ï¼Œè¿˜ä¼šæœ‰æ–°çš„æ•°æ®è¿›æ¥ï¼‰ï¼Œå¦‚æœå¤§äº<span class="math inline">\(z_q\)</span>ï¼Œåˆ™å°†<span class="math inline">\(X_i\)</span>åŠ å…¥å¼‚å¸¸ç‚¹é›†åˆä¸­ï¼›å¦‚æœå¤§äº<span class="math inline">\(t\)</span>ä½†å°äº<span class="math inline">\(z_q\)</span>ï¼Œåˆ™å°†<span class="math inline">\(X_i\)</span>åŠ å…¥è§‚æµ‹å€¼é›†åˆä¸­ï¼Œæ›´æ–°<span class="math inline">\(z_q\)</span>ï¼›å…¶ä»–æƒ…å†µæˆ‘ä»¬<span class="math inline">\(X_i\)</span>æ˜¯æ­£å¸¸æƒ…å†µã€‚ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191029114020571.png" /></p>
<h3 id="drifting-case">Drifting Case</h3>
<p>SPOTç®—æ³•åªé€‚ç”¨äºå¹³ç¨³åˆ†å¸ƒçš„æƒ…å†µï¼Œä½†åœ¨ç°å®ç”Ÿæ´»ä¸­è¿™æ ·çš„å‡è®¾è¿‡å¼ºäº†ã€‚äºæ˜¯ä½œè€…æå‡ºäº†èƒ½å¤„ç†æ—¶é—´ä¾èµ–æ€§çš„Streaming POT with Drift (DSPOT) ç®—æ³•ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20191029114054583.png" /></p>
<p>åœ¨DSPOTä¸­ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨<span class="math inline">\(X_i\)</span>çš„ç»å¯¹å€¼ï¼Œè€Œæ˜¯ç”¨ç›¸å¯¹å€¼<span class="math inline">\(X^\prime_i=X_i-M_i\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(M_i\)</span>æ˜¯<span class="math inline">\(i\)</span>æ—¶åˆ»çš„å±€éƒ¨ç‰¹å¾ï¼Œå¦‚Figure 4æ‰€ç¤ºã€‚æœ€ç®€å•çš„å®ç°æ˜¯ä½¿ç”¨å±€éƒ¨å‡å€¼ï¼Œå³<span class="math inline">\(M_i=(1/d)\cdot\sum\limits_{k=1}^d X_{i-k}^*\)</span>ï¼Œ<span class="math inline">\(X_{i-1}^*,\cdots,X_{i-d}^*\)</span>æ˜¯é•¿åº¦ä¸º<span class="math inline">\(d\)</span>çš„çª—å£ã€‚æˆ‘ä»¬å‡è®¾<span class="math inline">\(X^\prime_i\)</span>æœä»å¹³ç¨³åˆ†å¸ƒçš„å‡è®¾ã€‚</p>
<p>ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191029114113201.png" /></p>
<h2 id="numerical-optimization">Numerical Optimization</h2>
<p>ç°åœ¨å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯ä¼˜åŒ–äº†ï¼Œå‰æ–‡å·²ç»æåˆ°å¯¹GPDçš„æ‹Ÿåˆå·²ç»è¢«ä¼˜åŒ–æˆä¸€ä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜ï¼Œä¸‹é¢å°†ä¼šè¯¦ç»†è®¨è®ºä¼˜åŒ–ç®—æ³•ã€‚</p>
<h3 id="reduction-of-the-optimal-parameters-search">Reduction of the Optimal Parameters Search</h3>
<p>å‰æ–‡å·²ç»å¾—åˆ°äº†ä¸€ä¸ªåˆæ­¥çš„<span class="math inline">\(x^*\)</span>çš„Boundï¼Œå³<span class="math inline">\(x^*&gt;-\frac{1}{Y^M}\)</span>å’Œ<span class="math inline">\(x^*\leq 2\frac{\bar{Y}-Y^m}{(Y^m)^2}\)</span>ï¼Œä¸‹é¢å°†ç»™å‡ºä¸€ä¸ªæ›´ä¸¥æ ¼çš„Boundã€‚</p>
<blockquote>
<p><strong>PROPOSITION: </strong>å¦‚æœ<span class="math inline">\(x^*\)</span>æ˜¯<span class="math inline">\(u(x)v(x)=1\)</span>çš„è§£ï¼Œé‚£ä¹ˆï¼š <span class="math display">\[
x^*\leq 0 \text{ or } x^*\geq 2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m}
\]</span></p>
</blockquote>
<p>è¯æ˜è§è®ºæ–‡åŸæ–‡ã€‚</p>
<p>è¿™æ ·<span class="math inline">\(x^*\)</span>çš„èŒƒå›´å°±è¿›ä¸€æ­¥ç¼©å°äº†ï¼Œäºæ˜¯æœ‰<span class="math inline">\(u(x)v(X)=1\)</span>çš„è§£<span class="math inline">\(x^*\)</span>åœ¨ä»¥ä¸‹èŒƒå›´ä¹‹å†…ï¼š <span class="math display">\[
\left(-\frac{1}{Y^M},0\right]\text{ and }\left[2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m},2\frac{\bar{Y}-Y^m}{(Y^m)^2}\right]
\]</span></p>
<h3 id="how-can-we-maximize-the-likelihood-function">How Can We Maximize the Likelihood Function?</h3>
<p>æ¥ä¸‹æ¥æ˜¯ä¼˜åŒ–çš„å…·ä½“å®ç°é—®é¢˜ã€‚æ–‡ä¸­é¦–å…ˆè®¾å®šäº†ä¸€ä¸ªå¾ˆå°çš„å€¼<span class="math inline">\(\epsilon&gt;0\space(\sim 10^{-8})\)</span>ï¼Œç„¶ååœ¨ä¸‹é¢çš„èŒƒå›´å†…å¯»æ‰¾å‡½æ•°<span class="math inline">\(w:x\mapsto u(x)v(x)-1\)</span>çš„æ ¹ï¼š <span class="math display">\[
\left[-\frac{1}{Y^M}+\epsilon,-\epsilon\right]\text{ and }\left[2\frac{\bar{Y}-Y^m}{\bar{Y}Y^m},2\frac{\bar{Y}-Y^m}{(Y^m)^2}\right]
\]</span> ä½œè€…æ²¡æœ‰ä½¿ç”¨ç°æœ‰çš„å¯»æ‰¾å‡½æ•°æ ¹çš„ç®—æ³•ï¼Œè€Œæ˜¯è½¬æ¢ä¸ºå¦‚ä¸‹ä¼˜åŒ–é—®é¢˜ï¼š <span class="math display">\[
\min\limits_{x_1,\cdots,x_k\in I}\sum\limits_{i=1}^k w(x_k)^2
\]</span> å…¶ä¸­<span class="math inline">\(I\)</span>å°±æ˜¯<span class="math inline">\(x^*\)</span>çš„Boundã€‚è¯¥é—®é¢˜æ˜¯ä¸€ä¸ªå¾ˆå…¸å‹çš„ä¼˜åŒ–é—®é¢˜ï¼Œå¯ä»¥è¢«å¾ˆå¤šæˆç†Ÿçš„ç®—æ³•æ‰€è§£å†³ã€‚</p>
<h3 id="initial-threshold">Initial Threshold</h3>
<p>åœ¨ç®—æ³•çš„Initialization Stepï¼Œéœ€è¦äº‹å…ˆè®¾å®šä¸€ä¸ªé˜ˆå€¼<span class="math inline">\(t\)</span>ï¼Œå¦‚æœè®¾å®šçš„å¤ªå¤§ï¼Œé‚£ä¹ˆ<span class="math inline">\(Y_t\)</span>çš„æ•°é‡å°±ä¼šå¾ˆå°‘ã€‚ä½œè€…ç»™å‡ºçš„å»ºè®®æ˜¯ä¿è¯<span class="math inline">\(t&lt;z_q\)</span>ï¼Œå³<span class="math inline">\(t\)</span>å¯¹åº”çš„æ¦‚ç‡å€¼åº”è¯¥å°äº<span class="math inline">\(1-q\)</span>ã€‚</p>
<h1 id="experiments">Experiments</h1>
<p>åœ¨å®éªŒéƒ¨åˆ†ï¼Œä½œè€…åœ¨åˆæˆæ•°æ®å’ŒçœŸå®æ•°æ®ä¸Šè¯•éªŒäº†SPOTç®—æ³•å’ŒDSPOTç®—æ³•çš„æœ‰æ•ˆæ€§ã€‚</p>
<h2 id="dspot-reliability">(D)SPOT Reliability</h2>
<p>ä½œè€…é¦–å…ˆåœ¨åˆæˆæ•°æ®ä¸ŠéªŒè¯SPOTçš„æœ‰æ•ˆæ€§ã€‚å…·ä½“åšæ³•æ˜¯ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒç”Ÿæˆæ•°æ®ï¼ˆé«˜æ–¯åˆ†å¸ƒçš„åˆ†ä½æ•°èƒ½å¤Ÿç›´æ¥è®¡ç®—ï¼‰ï¼Œç„¶åå°†SPOTå¾—å‡ºçš„<span class="math inline">\(z_q\)</span>å’Œç†è®ºå€¼è¿›è¡Œå¯¹æ¯”ã€‚è¯¯å·®å®šä¹‰å¦‚ä¸‹ï¼š <span class="math display">\[
\text{error rate}=\left|\frac{z^{\text{SPOT}}-z^{\text{th}}}{z^{\text{th}}}\right|
\]</span> ä¸‹å›¾æ˜¯é‡‡ç”¨ä¸åŒæ•°é‡è§‚æµ‹å€¼çš„ç»“æœï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191029114230661.png" /></p>
<h2 id="finding-anomalies-with-spot">Finding Anomalies with SPOT</h2>
<p>åœ¨è¿™ä¸€èŠ‚ä½œè€…åœ¨çœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒä»¥éªŒè¯SPOTç®—æ³•çš„æœ‰æ•ˆæ€§ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191029114255259.png" /></p>
<p>åœ¨æ–‡ä¸­ä½œè€…è¯´ç®—æ³•çš„True Positiveè¾¾åˆ°äº†<span class="math inline">\(86\%\)</span>ï¼ŒFalse Positiveå°äº<span class="math inline">\(4\%\)</span>ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20191029114316348.png" /></p>
<h2 id="finding-anomalies-with-dspot">Finding Anomalies with DSPOT</h2>
<p>åœ¨è¿™ä¸€èŠ‚ä½œè€…ä½¿ç”¨DSPOTåœ¨çœŸå®æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒã€‚çª—å£å¤§å°<span class="math inline">\(d=450\)</span>ï¼Œé¢„è®¾çš„é£é™©æ¦‚ç‡å€¼<span class="math inline">\(q=10^{-3}\)</span>ã€‚ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191029114340936.png" /></p>
<p>åœ¨å›¾ä¸­å¯ä»¥çœ‹å‡ºåœ¨<span class="math inline">\(8000\)</span> Minutesä¹‹åä¸Šç•Œæ˜¾è‘—æé«˜ï¼Œä½œè€…åˆ†æäº†åŸå› ï¼Œè®¤ä¸ºæ˜¯å› ä¸ºè¶…è¿‡é˜ˆå€¼<span class="math inline">\(t\)</span>çš„ç‚¹<span class="math inline">\(Y_t\)</span>çš„å­˜å‚¨æ˜¯å…¨å±€çš„ï¼Œåœ¨å‰<span class="math inline">\(8000\)</span> Minutesç®—æ³•å­˜å‚¨äº†å¾ˆå¤šè¾ƒé«˜çš„<span class="math inline">\(Y_t\)</span>å€¼ï¼Œè€Œåœ¨<span class="math inline">\(8000\)</span> Minutesä¹‹åï¼ŒçœŸå®æ•°æ®çš„è¶‹åŠ¿å¼€å§‹ä¸‹é™ï¼Œä½†ç®—æ³•ä»æ˜¯æ ¹æ®å…¨å±€çš„<span class="math inline">\(Y_t\)</span>æ¥è¿›è¡Œ<span class="math inline">\(z_q\)</span>çš„è®¡ç®—ï¼ˆè¿™ä¸€æ®µæ²¡æœ‰ç‰¹åˆ«æ˜ç™½ï¼‰ã€‚ä½œè€…ç»™å‡ºçš„ä¿®æ­£æ–¹æ³•æ˜¯åªä¿å­˜å›ºå®šæ•°é‡çš„Peaksã€‚</p>
<p>ä¸‹å›¾æ˜¯ä½œè€…åœ¨è‚¡ç¥¨æ•°æ®ä¸Šå¾—åˆ°çš„å®éªŒç»“æœï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191029114356004.png" /></p>
<h2 id="performances">Performances</h2>
<p>ä½œè€…è¿˜éªŒè¯äº†ç®—æ³•çš„æ—¶é—´æ•ˆç‡ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20191029114419226.png" /></p>
<p>è¡¨ä¸­Tä»£è¡¨çš„æ˜¯æ¯ä¸ªIterationçš„æ—¶é—´ï¼ŒMä»£è¡¨çš„æ˜¯Peaksçš„æ¯”ä¾‹ï¼Œ&quot;bi-&quot;å‰ç¼€ä»£è¡¨çš„æ˜¯åŒæ—¶è®¡ç®—ä¸Šç•Œå’Œä¸‹ç•Œã€‚</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/"><img class="thumbnail" src="http://qfxiao.me/img/1571411043958.png" alt="Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-18T15:00:57.000Z" title="2019-10-18T15:00:57.000Z">2019-10-18</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">25 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 3813 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/">Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network</a></h1><div class="content"><h1 id="abstract">Abstract</h1>
<p>æœ¬æ–‡æå‡ºäº†<em>OmniAnomaly</em>ï¼šä¸€ç§é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—çš„éšæœºå¾ªç¯ç¥ç»ç½‘ç»œå¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚è¯¥æ¨¡å‹è¿ç”¨äº†ä¸€ç³»åˆ—æŠ€æœ¯æ¥æ•æ‰å¤šå˜é‡æ—¶é—´åºåˆ—çš„æ­£å¸¸æ¨¡å¼ï¼Œå¹¶åœ¨æ£€æµ‹é˜¶æ®µåŸºäºé‡æ„è¯¯å·®æ¥æ£€æµ‹å¼‚å¸¸ï¼ŒåŒæ—¶æœ¬æ–‡è¿˜æä¾›äº†ä¸€å®šçš„ç†è®ºè§£é‡Šã€‚</p>
<p><a href="https://www.kdd.org/kdd2019/accepted-papers/view/robust-anomaly-detection-for-multivariate-time-series-through-stochastic-re">åŸæ–‡</a></p>
<h1 id="contribution">Contribution</h1>
<ol type="1">
<li>æå‡ºäº†<em>OmniAnomaly</em>ï¼Œä¸€ç§åŸºäºéšæœºå¾ªç¯ç¥ç»ç½‘ç»œçš„å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼›</li>
<li>æå‡ºäº†é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„è§£é‡Šæ–¹æ³•ï¼›</li>
<li>é€šè¿‡å®éªŒè¯æ˜äº†<em>OmniAnomaly</em>ä¸­æ‰€ç”¨çš„å…³é”®æŠ€æœ¯çš„æœ‰æ•ˆæ€§ï¼ŒåŒ…æ‹¬GRUï¼Œplanar NF, stochastic variable connectionå’Œadjusted Peaks-Over-Threshold methodï¼›</li>
<li>é€šè¿‡å¤§é‡çš„å®éªŒæˆ‘ä»¬è¯æ˜äº†<em>OmniAnomaly</em>çš„æœ‰æ•ˆæ€§ï¼›</li>
<li>å‘å¸ƒäº†ä»£ç å’Œæ•°æ®é›†ã€‚</li>
</ol>
<h1 id="background">Background</h1>
<h2 id="linear-gaussian-state-space-model">Linear Gaussian State Space Model</h2>
<p>çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆState Space Model, SSMï¼‰çš„æ¦‚å¿µæ¥è‡ªäºæ§åˆ¶ç†è®ºï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®¨è®ºå…¶åœ¨æ—¶é—´åºåˆ—ä¸­çš„åº”ç”¨ã€‚å…¶å¤§æ¦‚æ€æƒ³æ˜¯æˆ‘ä»¬è®¤ä¸ºæ—¶é—´åºåˆ—åœ¨æ—¶åˆ»<span class="math inline">\(t\)</span>çš„è§‚æµ‹å€¼<span class="math inline">\(z_t\)</span>æ˜¯ä¸€ä¸ªéšå«çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_t\)</span>çš„æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p(z_t|\boldsymbol{l}_t)\)</span>ï¼Œè€Œè¿™ä¸ªéšå«çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_t\)</span>åˆ»ç”»äº†æ—¶é—´åºåˆ—çš„å†…åœ¨è§„å¾‹ï¼ŒåŒæ—¶éšå«çŠ¶æ€ä¼šéšç€æ—¶é—´æ›´æ–°ï¼Œå³æœä»æ¡ä»¶åˆ†å¸ƒ<span class="math inline">\(p(\boldsymbol{l}_t|\boldsymbol{l}_{t-1})\)</span>ã€‚</p>
<p>åœ¨çº¿æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆLinear State Space Modelï¼‰ä¸­æˆ‘ä»¬ä»¥å¦‚ä¸‹çš„æ–¹å¼åˆ»ç”»éšå«çŠ¶æ€çš„æ›´æ–°ï¼š <span class="math display">\[
\boldsymbol{l}_t=\boldsymbol{F}_t\boldsymbol{l}_{t-1}+\boldsymbol{g}_t\varepsilon_t, \space\space\space\varepsilon_t\sim\mathcal{N}(0,1)
\]</span> <span class="math inline">\(\boldsymbol{F}_t\)</span>ä¸ºç¡®å®šçš„çŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œè€Œ<span class="math inline">\(\boldsymbol{g}_t\varepsilon_t\)</span>åˆ™è¡¨ç¤ºäº†çŠ¶æ€è½¬ç§»çš„éšæœºæ€§ã€‚</p>
<p>è§‚æµ‹å€¼<span class="math inline">\(z_t\)</span>ä»éšå«çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_t\)</span>è®¡ç®—è€Œæ¥ï¼š <span class="math display">\[
\begin{align}
z_t&amp;=y_t+\sigma_t\epsilon_t,\\
y_t&amp;=\boldsymbol{a}_t^\top\boldsymbol{l}_{t-1}+b_t,\\
\epsilon_t&amp;\sim\mathcal{N}(0,1)
\end{align}
\]</span> å…¶ä¸­<span class="math inline">\(\boldsymbol{a}_t\in\mathbb{R}^L,\sigma_t\in \mathbb{R},b_t\in\mathbb{R}\)</span>éƒ½æ˜¯é¢å¤–çš„å‚æ•°ã€‚åˆå§‹çŠ¶æ€<span class="math inline">\(\boldsymbol{l}_0\)</span>åˆ™ä»ä¸€ä¸ªç‹¬ç«‹çš„é«˜æ–¯åˆ†å¸ƒå¾—æ¥ï¼Œå³<span class="math inline">\(\boldsymbol{l}_0\sim N(\boldsymbol\mu_0,\text{diag}(\boldsymbol{\sigma}_0^2))\)</span>ã€‚</p>
<p>ä»¤å‚æ•°é›†åˆ<span class="math inline">\(\Theta_t=(\boldsymbol{\mu}_0,\boldsymbol{\Sigma}_0,\boldsymbol{F}_t,\boldsymbol{g}_t,\boldsymbol{a}_t,b_t,\sigma_t),\forall t&gt;0\)</span>ï¼Œä¸€èˆ¬æ¥è¯´å‚æ•°é›†åˆä¸ä¼šéšç€æ—¶é—´å˜åŒ–ï¼Œå³æ¯ä¸ªæ—¶åˆ»<span class="math inline">\(t\)</span>å…±äº«åŒæ ·çš„å‚æ•°<span class="math inline">\(\Theta_t=\Theta,\forall t&gt;0\)</span>ã€‚å¯¹å‚æ•°çš„ä¼°è®¡å¯ä»¥é‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ï¼š <span class="math display">\[
\begin{align}
\Theta^*_{1:T}&amp;=\arg\max_{\Theta_{1:T}}p(z_{1:T}|\Theta_{1:T}),\\
\end{align}
\]</span> å…¶ä¸­ï¼š <span class="math display">\[
\begin{align}
p(z_{1:T}|\Theta_{1:T})&amp;=p(z_1|\Theta_1)\prod\limits_{t=2}^T p(z_t|z_{1:t-1},\Theta_{1:t})\\
&amp;=\int p(\boldsymbol{l}_0)\left[\prod\limits_{t=1}^T p(z_t|\boldsymbol{l}_t)p(\boldsymbol{l}_t|\boldsymbol{l}_{t-1})\right]\mathrm{d}\boldsymbol{l}_{0:T}
\end{align}
\]</span></p>
<h2 id="planar-normalizing-flow">Planar Normalizing Flow</h2>
<h3 id="normalizing-flows">Normalizing Flows</h3>
<p>VAEé‡‡ç”¨ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ<span class="math inline">\(q_\phi(z|x)\)</span>æ¥è¿‘ä¼¼çœŸå®çš„åéªŒåˆ†å¸ƒ<span class="math inline">\(p(z|x)\)</span>ï¼Œå¹¶æ¨å¯¼å‡º<span class="math inline">\(\log p_\theta(x)\)</span>çš„ä¸‹ç•Œï¼ˆç§°ä¸ºELBOï¼‰æ¥ä½œä¸ºä¼˜åŒ–ç›®æ ‡å‡½æ•°ï¼š <span class="math display">\[
\begin{align}
\log p_\theta(x)&amp;=\log \int p_\theta(x|z)p(z)\mathrm{d}z\\
&amp;=\log\int\frac{q_\phi(z|x)}{q_\phi(z|x)}p_\theta(x|z)p(z)\mathrm{d}z\\
&amp;\geq-D_{KL}[q_\phi(z|x)\parallel p(z)]+\mathbb{E}_q[\log p_\theta(x|z)]
\end{align}
\]</span> <span class="math inline">\(\log p_\theta(x)\)</span>ä¸ELBOå–ç­‰çš„æ¡ä»¶æ˜¯<span class="math inline">\(D_{KL}[q_\phi(z|x)\parallel p(z)]\)</span>ï¼Œè¡¨æ˜å˜åˆ†åˆ†å¸ƒå®Œå…¨åŒ¹é…äº†çœŸå®çš„åéªŒåˆ†å¸ƒã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒçœŸå®çš„åéªŒåˆ†å¸ƒå¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œè€Œæˆ‘ä»¬çš„å˜åˆ†åˆ†å¸ƒé€šå¸¸æ˜¯ä¸€ä¸ªç¡®å®šçš„è¾ƒä¸ºç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚è¿™æ ·å˜åˆ†åˆ†å¸ƒå¯èƒ½å¾ˆéš¾å¯¹çœŸå®åéªŒåˆ†å¸ƒå¾—åˆ°ä¸€ä¸ªå¾ˆå¥½çš„æ‹Ÿåˆã€‚</p>
<p>ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ ‡å‡†åŒ–æµï¼ˆNormalizing Flowsï¼‰ã€‚æ ‡å‡†åŒ–æµæ˜¯ä»ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒå‡ºå‘ï¼Œæ‰§è¡Œä¸€ç³»åˆ—å¯é€†çš„æ˜ å°„ï¼Œå°†åŸå§‹ç®€å•çš„åˆ†å¸ƒè½¬åŒ–ä¸ºä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒã€‚</p>
<p>é¦–å…ˆè€ƒè™‘ä¸€ä¸ªå…‰æ»‘çš„ã€å¯é€†çš„æ˜ å°„<span class="math inline">\(f:\mathbb{R}^d\mapsto \mathbb{R}^d\)</span>ï¼Œè®°<span class="math inline">\(g=f^{-1}\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(g\circ f(\mathbf{z})=\mathbf{z}\)</span>ã€‚ä»¤<span class="math inline">\(\mathbf{z}^\prime=f(\mathbf{z})\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(\mathbf{z}^\prime\)</span>çš„åˆ†å¸ƒä¸ºï¼š <span class="math display">\[
q(\mathbf{z}^\prime)=q(\mathbf{z})\left|\text{det}\frac{\partial f^{-1}}{\partial \mathbf{z}^\prime}\right|=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}
\]</span> å¼ä¸­<span class="math inline">\(q(\mathbf{z}^\prime)=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}\)</span>è¯´æ˜äº†<span class="math inline">\(\mathbf{z}^\prime\)</span>çš„åˆ†å¸ƒç­‰äº<span class="math inline">\(\mathbf{z}\)</span>çš„åˆ†å¸ƒä¹˜ä¸Š<span class="math inline">\(f\)</span>çš„JacobiançŸ©é˜µçš„è¡Œåˆ—å¼çš„å€’æ•°ã€‚é‚£ä¹ˆå¯¹äºæ˜ å°„å¤šæ¬¡çš„æƒ…å†µï¼š <span class="math display">\[
\mathbf{z}_K=f_K\circ\cdots\circ f_2\circ f_1(\mathbf{z}_0)
\]</span> <span class="math inline">\(\mathbf{z}_K\)</span>çš„åˆ†å¸ƒå¯ä»¥é€šè¿‡é“¾å¼è®¡ç®—å¾—åˆ°ï¼š <span class="math display">\[
\ln q_K(\mathbf{z}_K)=\ln q_0(\mathbf{z}_0)-\sum\limits_{k=1}^K\ln\left|\text{det}\frac{\partial f_k}{\partial \mathbf{z}_{k-1}}\right|
\]</span></p>
<h3 id="planar-flows">Planar Flows</h3>
<p>è€ƒè™‘ä¸€ä¸ªå˜æ¢æ—ï¼š <span class="math display">\[
f(\mathbf{z})=\mathbf{z}+\mathbf{u}h(\mathbf{w}^\top\mathbf{z}+b)
\]</span> å…¶ä¸­<span class="math inline">\(\lambda=\{\mathbf{w}\in \mathbb{R}^d,\mathbf{u}\in\mathbb{R}^d,b\in\mathbb{R}\}\)</span>ä¸ºå‚æ•°é›†åˆï¼Œ<span class="math inline">\(h(\cdot)\)</span>ä¸ºå…ƒç´ çº§çš„éçº¿æ€§å‡½æ•°ï¼ˆå¦‚å„ç§æ¿€æ´»å‡½æ•°ï¼‰ã€‚ä»¤<span class="math inline">\(\psi(\mathbf{z})=h^\prime(\mathbf{w}^\top\mathbf{z}+b)\mathbf{w}\)</span>ï¼Œåˆ™<span class="math inline">\(f\)</span>çš„JacobiançŸ©é˜µè¡Œåˆ—å¼ç»å¯¹å€¼ç­‰äºï¼š <span class="math display">\[
\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|=\left|\text{det}(\mathbf{I}+\mathbf{u}\psi(\mathbf{z})^\top)\right|=\left|1+\mathbf{u}^\top\psi(\mathbf{z})\right|
\]</span> ä½†æ˜¯<span class="math inline">\(f\)</span>å¹¶ä¸ä¿è¯æ€»æ˜¯å¯é€†çš„ï¼Œå¦‚<span class="math inline">\(h(x)=\tanh(x)\)</span>æ—¶ï¼Œ<span class="math inline">\(f\)</span>å¯é€†çš„æ¡ä»¶æ˜¯<span class="math inline">\(\mathbf{w}^\top \mathbf{u}\geq-1\)</span>ã€‚</p>
<p>ä¸‹é¢è®¨è®ºå¦‚ä½•ä¿è¯å¯é€†çš„æ¡ä»¶ã€‚è€ƒè™‘å°†<span class="math inline">\(\mathbf{z}\)</span>åˆ†è§£ä¸º<span class="math inline">\(\mathbf{z}=\mathbf{z}_\bot+\mathbf{z}_\parallel\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{z}_\bot\)</span>ä¸<span class="math inline">\(\mathbf{w}\)</span>æ­£äº¤ï¼Œ<span class="math inline">\(\mathbf{z}_\parallel\)</span>ä¸<span class="math inline">\(\mathbf{w}\)</span>å¹³è¡Œï¼Œé‚£ä¹ˆï¼š <span class="math display">\[
f(z)=\mathbf{z}_\bot+\mathbf{z}_\parallel+\mathbf{u}h(\mathbf{w}^\top \mathbf{z}_\parallel +b)
\]</span> å®é™…ä¸Šå¾—åˆ°<span class="math inline">\(\mathbf{z}_\parallel\)</span>ä¹‹åå¯ä»¥å¾ˆå®¹æ˜“çš„å¾—åˆ°<span class="math inline">\(\mathbf{z}_\bot\)</span>ï¼Œä»¤<span class="math inline">\(\mathbf{y}=f(\mathbf{z})\)</span>ï¼Œæœ‰ï¼š <span class="math display">\[
\mathbf{z}_\bot=\mathbf{y}-\mathbf{z}_\parallel-\mathbf{u}h(\mathbf{w}^\top\mathbf{z}_\parallel+b)
\]</span> è€Œ<span class="math inline">\(\mathbf{z}_\parallel\)</span>ä¸<span class="math inline">\(\mathbf{w}\)</span>å¹³è¡Œï¼Œæ˜“çŸ¥<span class="math inline">\(\mathbf{z}_\parallel=\alpha\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\alpha\in\mathbb{R}\)</span>ã€‚</p>
<p>å¯¹å¼(16)ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥<span class="math inline">\(\mathbf{w}^\top\)</span>å¯å¾—ï¼š <span class="math display">\[
\mathbf{w}^\top f(\mathbf{z})=\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)
\]</span> å½“<span class="math inline">\(\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)\)</span>å¯¹äº<span class="math inline">\(\alpha\)</span>æ˜¯éé€’å‡å‡½æ•°çš„æ—¶å€™ï¼Œ<span class="math inline">\(f\)</span>æ˜¯å¯é€†çš„ã€‚å› ä¸º<span class="math inline">\(\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)\)</span>æ˜¯éé€’å‡å‡½æ•°æ—¶æœ‰<span class="math inline">\(1+\mathbf{w}^\top\mathbf{u}h^\prime(\alpha+b)\geq 0\equiv \mathbf{w}^\top \mathbf{u}\geq -\frac{1}{h^\prime(\alpha + b)}\)</span>ï¼Œè€Œ<span class="math inline">\(0\leq h^\prime(\alpha + b) \leq 1\)</span>ï¼ˆ<span class="math inline">\(\tanh\)</span>å‡½æ•°çš„æ€§è´¨ï¼‰ï¼Œæ‰€ä»¥æ€»æ˜¯æœ‰<span class="math inline">\(\mathbf{w}^\top \mathbf{u}\geq-1\)</span>ã€‚</p>
<p>å¯¹äºä»»æ„ä¸€ä¸ª<span class="math inline">\(\mathbf{u}\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ–¹å¼æ„é€ ä¸€ä¸ª<span class="math inline">\(\hat{\mathbf{u}}\)</span>ä½¿å¾—<span class="math inline">\(\mathbf{w}^\top\hat{\mathbf{u}}&gt;-1\)</span>ï¼Œå³ä»¤<span class="math inline">\(\hat{\mathbf{u}}(\mathbf{w},\mathbf{u})=\mathbf{u}+[m(\mathbf{w}^\top\mathbf{u})-(\mathbf{w}^\top\mathbf{u})]\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(m(x)=-1+\log(1+e^x)\)</span>ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20191031162515819.png" /></p>
<h1 id="methodology">Methodology</h1>
<h2 id="problem-statement">Problem Statement</h2>
<p>æœ¬æ–‡é’ˆå¯¹çš„æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—<span class="math inline">\(x=\{x_1,x_2,\cdots,x_N\}\in R^{M\times N}\)</span>ï¼Œ<span class="math inline">\(N\)</span>ä¸ºæ—¶é—´é•¿åº¦ï¼Œå…¶ä¸­æŸä¸€æ—¶åˆ»çš„è§‚æµ‹å€¼<span class="math inline">\(x_t\in R^M\)</span>ä¸ºä¸€ä¸ª<span class="math inline">\(M\)</span>ç»´çš„å‘é‡ã€‚ä½œè€…ä½¿ç”¨<span class="math inline">\(x_{t-T:t}\in R^{M\times(T+1)}\)</span>æ¥è¡¨ç¤º<span class="math inline">\(t-T\)</span>åˆ°<span class="math inline">\(t\)</span>ä¹‹é—´çš„æ—¶é—´åºåˆ—ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20191024112404542.png" /></p>
<h2 id="overall-structure">Overall Structure</h2>
<p>ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571411043958.png" /></p>
<p>é¢„å¤„ç†æ¨¡å—ä¸»è¦æ˜¯å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ä»¥åŠçª—å£åˆ‡åˆ†ã€‚è®­ç»ƒæ¨¡å—åˆ™æ ¹æ®è¾“å…¥çš„æ•°æ®å¯¹æ­£å¸¸æ¨¡å¼è¿›è¡Œæ•æ‰ï¼Œè¾“å‡ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨çº¿æ£€æµ‹æ¨¡å—åˆ™ä¼šå®šæœŸæ‰§è¡Œã€‚</p>
<h2 id="network-architecture">Network Architecture</h2>
<p>æ¨¡å‹çš„æ€»ä½“ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571411093161.png" /></p>
<p>åœ¨qnetä¸­ï¼Œé¦–å…ˆGRUè¢«ç”¨æ¥å»ºæ¨¡æ ·æœ¬çš„æ—¶é—´ä¾èµ–å…³ç³»ï¼Œä¹‹åVAEå°†æ ·æœ¬<span class="math inline">\(\mathbf{x}\)</span>æ˜ å°„åˆ°éšç©ºé—´<span class="math inline">\(\mathbf{z}\)</span>ã€‚æ–‡ä¸­ä½¿ç”¨äº†Linear Gaussian State Space Modelæ¥å»ºæ¨¡éšå˜é‡ä¹‹é—´çš„æ—¶é—´ä¾èµ–å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜ä½¿ç”¨äº†Planar Normalizing Flowæ¥å°†éšå˜é‡æ˜ å°„åˆ°å¤æ‚çš„éé«˜æ–¯åˆ†å¸ƒã€‚åœ¨pnetä¸­ï¼Œéšå˜é‡<span class="math inline">\(\mathbf{z}_{t-T:t}\)</span>è¢«ç”¨æ¥é‡å»º<span class="math inline">\(\mathbf{x}_{t-T:t}\)</span>ï¼Œç›´è§‚ä¸Šæ¥è¯´ï¼Œå¯¹æ ·æœ¬çš„å¥½çš„éšå˜é‡è¡¨ç¤ºå¯ä»¥å¸¦æ¥æ›´å¥½çš„é‡æ„æ•ˆæœã€‚</p>
<p>ä»ç»†èŠ‚ä¸Šæ¥è¯´ï¼Œåœ¨æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œqnetçš„è¾“å…¥ä¸º<span class="math inline">\(\mathbf{x}_t\)</span>å’Œ<span class="math inline">\(\mathbf{e}_{t-1}\)</span>ï¼Œä¸¤è€…ç»è¿‡GRU Cellä¹‹åä¼šäº§ç”Ÿ<span class="math inline">\(t\)</span>æ—¶é—´çš„<span class="math inline">\(\mathbf{e_t}\)</span>ã€‚<span class="math inline">\(\mathbf{e}_t\)</span>æ˜¯GRUæ•æ‰æ—¶é—´ä¾èµ–æ€§çš„å…³é”®ï¼Œå¯ä»¥è®¤ä¸ºå®ƒåŒ…å«äº†<span class="math inline">\(\mathbf{x}_{1:t}\)</span>çš„ä¿¡æ¯ã€‚ä¹‹å<span class="math inline">\(\mathbf{e}_t\)</span>ä¼šå’Œ<span class="math inline">\(\mathbf{z}_{t-1}\)</span>è¿›è¡Œæ‹¼æ¥ï¼Œè¿›å…¥æ ‡å‡†çš„VAEå˜åˆ†ç½‘ç»œç»“æ„ï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„å‚æ•°<span class="math inline">\(\mu_{z_t},\sigma_{z_t}\)</span>é‡‡æ ·å¾—åˆ°éšå˜é‡<span class="math inline">\(\mathbf{z}_t^0\)</span>ï¼Œæ­¤æ—¶éšå˜é‡å¯ä»¥è¯´æ•æ‰äº†æ—¶é—´ä¾èµ–æ€§ã€‚</p>
<p>ç½‘ç»œä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><span class="math display">\[
\begin{align}
e_t&amp;=(1-c_t^e)\circ\text{tanh}(w^ex_t+u^e(r_t^e\circ e_{t-1})+b^e)+c_t^e\circ e_{t-1}\\
\mu_{z_t}&amp;=w^{\mu_z}h^\phi([z_{t-1},e_t])+b^{\mu_z}\\
\sigma_{z_t}&amp;=\text{softplus}(w^{\sigma_z}h^\phi([z_{t-1},e_t])+b^{\sigma_z})+\epsilon^{\sigma_z}
\end{align}
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(r_t^e=\text{sigmoid}(\mathbf{w}^{r^e}\mathbf{x}_t+\mathbf{u}^{r^e}\mathbf{e}_{t-1}+b^{r^e})\)</span>æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ<span class="math inline">\(c_t^e=\text{sigmoid}(\mathbf{w}^{c^e}\mathbf{x}_t+\mathbf{u}^{c^e}\mathbf{e}_{t-1}+b^{c^e})\)</span>æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p>
<p>æ­¤æ—¶<span class="math inline">\(\mathbf{z}_t^0\)</span>æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸ºäº†æ‹Ÿåˆå¤æ‚çš„åéªŒåˆ†å¸ƒï¼Œæˆ‘ä»¬ä½¿ç”¨Planar Normalizing Flowæ¥å¯¹<span class="math inline">\(\mathbf{z}_t^0\)</span>è¿›è¡Œå˜æ¢ï¼Œæœ€åå¾—åˆ°ç»<span class="math inline">\(K\)</span>æ¬¡å˜æ¢åçš„éšæœºå˜é‡<span class="math inline">\(\mathbf{z}_t^K\)</span>ã€‚</p>
<p>åœ¨æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œpnetè¯•å›¾é€šè¿‡<span class="math inline">\(\mathbf{z}_t^K\)</span>æ¥é‡æ„<span class="math inline">\(\mathbf{x}_t\)</span>ã€‚é¦–å…ˆ<span class="math inline">\(\mathbf{z}\)</span>ç©ºé—´ä¸­çš„å˜é‡ä¼šæ ¹æ®Linear Gaussian State Space Modelæ¥è¿›è¡Œâ€œè¿æ¥â€œï¼Œå…¬å¼ä¸º<span class="math inline">\(\mathbf{z}_t=\mathbf{O}_\theta(\mathbf{T}_\theta\mathbf{z}_{t-1}+\mathbf{v}_t)+\boldsymbol{\epsilon}_t\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{O}_\theta\)</span>å’Œ<span class="math inline">\(\mathbf{T}_\theta\)</span>ä¸ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œ<span class="math inline">\(\mathbf{v}_t\)</span>å’Œ<span class="math inline">\(\boldsymbol{\epsilon}_t\)</span>ä¸ºéšæœºå™ªå£°ã€‚ä¹‹å<span class="math inline">\(\mathbf{z}_t\)</span>å’Œ<span class="math inline">\(\mathbf{d}_{t-1}\)</span>ä¼šä½œä¸ºGRUçš„è¾“å…¥ï¼Œäº§ç”Ÿ<span class="math inline">\(\mathbf{d}_t\)</span>ã€‚ä¹‹å<span class="math inline">\(\mathbf{d}_t\)</span>ä¼šç»è¿‡æ ‡å‡†VAEä¸­çš„ç”Ÿæˆç½‘ç»œï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„é«˜æ–¯åˆ†å¸ƒå‚æ•°<span class="math inline">\(\mu_{x_t},\sigma_{x_t}\)</span>é‡‡æ ·å¾—åˆ°é‡æ„åçš„æ ·æœ¬<span class="math inline">\(\mathbf{x}^\prime_t\)</span>ã€‚pnetä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š <span class="math display">\[
\begin{align}
d_t&amp;=(1-c_t^d)\circ\text{tanh}(w^dz_t+u^d(r_t^d\circ d_{t-1})+b^d)+c_t^d\circ d_{t-1}\\
\mu_{x_t}&amp;=w^{\mu_x}h^\theta(d_t)+b^{\mu_x}\\
\sigma_{x_t}&amp;=\text{softplus}(w^{\sigma_x}h^\theta(d_t)+b^{\sigma_x})+\epsilon^{\sigma_x}
\end{align}
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(r_t^d=\text{sigmoid}(\mathbf{w}^{r^d}\mathbf{x}_t+\mathbf{u}^{r^d}\mathbf{d}_{t-1}+b^{r^d})\)</span>æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ<span class="math inline">\(c_t^d=\text{sigmoid}(\mathbf{w}^{c^d}\mathbf{x}_t+\mathbf{u}^{c^d}\mathbf{d}_{t-1}+b^{c^d})\)</span>æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p>
<h2 id="offline-model-training">Offline Model Training</h2>
<p>å’Œä¼ ç»ŸVAEç±»ä¼¼ï¼Œæ¨¡å‹çš„è®­ç»ƒå¯ä»¥é€šè¿‡ä¼˜åŒ–ELBOæ¥å®Œæˆã€‚è®°é•¿åº¦ä¸º<span class="math inline">\(T+1\)</span>çš„è¾“å…¥åºåˆ—ä¸º<span class="math inline">\(\mathbf{x}_{t-T:t}\)</span>ï¼Œéšç©ºé—´å˜é‡é‡‡æ ·æ¬¡æ•°ä¸º<span class="math inline">\(L\)</span>ï¼Œç¬¬<span class="math inline">\(l\)</span>ä¸ªéšç©ºé—´å˜é‡ä¸º<span class="math inline">\(\mathbf{l}^{(l)}_{t-T:t}\)</span>ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p>
<p><span class="math display">\[
\tilde{\mathcal{L}}(\mathbf{x}_{t-T:t})\approx\frac{1}{L}\sum_{t=1}^L[\log(p_\theta(\mathbf{x}_{t-T:t}|\mathbf{z}_{t-T:t}^{(l)}))+\log(p_\theta(\mathbf{z}_{t-T:t}^{(l)}))-\log(q_\phi(\mathbf{z}_{t-T:t}^|\mathbf{x}_{t-T:t}))]
\]</span></p>
<p>ç¬¬ä¸€é¡¹<span class="math inline">\(\log(p_\theta(\mathbf{x}_{t-T:t}|\mathbf{z}_{t-T:t}^{(l)}))\)</span>å¯ä»¥çœ‹ä½œæ˜¯é‡æ„è¯¯å·®ï¼›ç¬¬äºŒé¡¹<span class="math inline">\(\log(p_\theta(\mathbf{z}_{t-T:t}))=\sum_{i=t-T}^t \log(p_\theta(\mathbf{z}_i|\mathbf{z}_{i-1}))\)</span>é€šè¿‡Linear Gaussian State Space Modelè®¡ç®—ï¼›ç¬¬ä¸‰é¡¹<span class="math inline">\(-\log(q_\phi(\mathbf{z}_{t-T:t}|\mathbf{x}_{t-T:t}))=-\sum_{i=t-T}^t\log(q_\phi(\mathbf{z}_i|\mathbf{z}_{i-1},\mathbf{x}_{t-T:i}))\)</span>ä¸ºéšå˜é‡<span class="math inline">\(\mathbf{z}\)</span>åéªŒåˆ†å¸ƒçš„ä¼°è®¡ï¼ŒåŒæ—¶<span class="math inline">\(\mathbf{z}_i\)</span>æ˜¯ç»Planar Normalizing Flowè½¬æ¢è¿‡çš„ã€‚</p>
<h2 id="online-detection">Online Detection</h2>
<p>åœ¨è®­ç»ƒå¥½æ¨¡å‹ä¹‹åï¼Œå°±å¯ä»¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹äº†ã€‚åœ¨æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œæˆ‘ä»¬é€šè¿‡æ ¹æ®é•¿åº¦ä¸º<span class="math inline">\(T+1\)</span>çš„åºåˆ—<span class="math inline">\(\mathbf{x}_{t-T:t}\)</span>æ¥é‡æ„<span class="math inline">\(\mathbf{x}_t\)</span>ï¼Œå¹¶æ ¹æ®é‡æ„æ¦‚ç‡<span class="math inline">\(\log(p_\theta(\mathbf{x}_t|\mathbf{z}_{t-T:t}))\)</span>æ¥åˆ¤å®šå¼‚å¸¸ã€‚å®šä¹‰<span class="math inline">\(\mathbf{x}_t\)</span>å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°<span class="math inline">\(S_t=\log(p_\theta(\mathbf{x}_t|\mathbf{z}_{t-T:t}))\)</span>ï¼Œé«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ ·æœ¬<span class="math inline">\(\mathbf{x}_t\)</span>èƒ½å¤Ÿä»¥å¤§æ¦‚ç‡é‡æ„ï¼ˆå› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è®­ç»ƒï¼Œå¯ä»¥è®¤ä¸ºæ¨¡å‹å»ºæ¨¡çš„æ˜¯æ­£å¸¸æ ·æœ¬çš„åˆ†å¸ƒï¼Œé‡æ„æ¦‚ç‡é«˜å°±ä»£è¡¨ç¬¦åˆæ­£å¸¸åˆ†å¸ƒï¼‰ã€‚ç»™å®šé˜ˆå€¼ä¹‹åä¾¿å¯æ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤å®šã€‚</p>
<h2 id="automatic-threshold-selection">Automatic Threshold Selection</h2>
<p>åœ¨å¼‚å¸¸æ£€æµ‹é˜¶æ®µï¼Œéœ€è¦æ ¹æ®è®¾å®šçš„é˜ˆå€¼å’Œæ¯ä¸ªæ ·æœ¬çš„å¼‚å¸¸åˆ†æ•°æ¥åˆ¤æ–­è¯¥æ ·æœ¬æ˜¯å¦ä¸ºå¼‚å¸¸ï¼Œæ‰€ä»¥é˜ˆå€¼çš„é€‰æ‹©ååˆ†é‡è¦ã€‚æ–‡ä¸­ç”¨åˆ°äº†ä¸€ç§æ ¹æ®<strong>Extreme Value Theory</strong>è‡ªåŠ¨é€‰æ‹©é˜ˆå€¼çš„ç®—æ³•ã€‚å¯¹äºä¸€ä¸ªåˆ†å¸ƒï¼Œå…¶ä¸­çš„æç«¯äº‹ä»¶å¾€å¾€ä½äºåˆ†å¸ƒçš„æœ«å°¾ï¼Œè€ŒExtreme Value Theoryç¬¬ä¸€å®šç†ç»™å‡ºä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ï¼Œè¿™äº›æç«¯äº‹ä»¶çš„åˆ†å¸ƒæœä»ä¸€ä¸ªå¸¦å‚çš„åˆ†å¸ƒæ—ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨å¯¹æ•°æ®åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡æç«¯äº‹ä»¶çš„åˆ†å¸ƒã€‚</p>
<p>é™¤äº†Extreme Value Theoryç¬¬ä¸€å®šç†ä¹‹å¤–ï¼ŒExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼<span class="math inline">\(t\)</span>çš„åˆ†å¸ƒå¯ä»¥ç”¨Generalized Pareto Distributionæ¥æè¿°ã€‚ä½œè€…ä½¿ç”¨äº†åŸºäºExtreme Value Theoryç¬¬äºŒå®šç†çš„Peaks-Over-Thresholdç®—æ³•æ¥è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚å› ä¸ºExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼<span class="math inline">\(t\)</span>çš„åˆ†å¸ƒï¼Œè€Œåœ¨æœ¬æ–‡çš„åœºæ™¯ä¸­æˆ‘ä»¬éœ€è¦åˆ»ç”»çš„å¼‚å¸¸ç‚¹çš„åˆ†å¸ƒåº”è¯¥æ˜¯å°äºä¸€ä¸ªç»™å®šé˜ˆå€¼çš„åˆ†å¸ƒï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹å…¬å¼ã€‚</p>
<p>å¯¹äºç»™å®šçš„æ•°æ®ï¼Œæ¨¡å‹ä¼šç»™å‡ºå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°åºåˆ—<span class="math inline">\(\{S_1,S_2,\cdots,S_{N^\prime}\}\)</span>ï¼Œç»™å®šé¢„å…ˆè®¾å®šçš„é˜ˆå€¼<span class="math inline">\(th\)</span>ï¼Œ<span class="math inline">\(S_i\)</span>æç«¯éƒ¨åˆ†ï¼ˆå³å°äº<span class="math inline">\(th\)</span>çš„éƒ¨åˆ†ï¼‰çš„åˆ†å¸ƒç¬¦åˆGeneralized Pareto Distributionï¼Œå…¬å¼å¦‚ä¸‹ï¼š <span class="math display">\[
\bar{F}(s)=P(th-S&gt;s|S&lt;th)\sim(1+\frac{\gamma s}{\beta})^{-\frac{1}{\gamma}}
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\gamma\)</span>å’Œ<span class="math inline">\(\beta\)</span>ä¸ºåˆ†å¸ƒçš„å½¢çŠ¶å‚æ•°ï¼Œæœ¬æ–‡ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ¥å¯¹å‚æ•°è¿›è¡Œä¼°è®¡ã€‚è®¾å‚æ•°çš„ä¼°è®¡å€¼åˆ†åˆ«ä¸º<span class="math inline">\(\hat{\gamma}\)</span>å’Œ<span class="math inline">\(\hat{\beta}\)</span>ï¼Œæœ€ç»ˆçš„é˜ˆå€¼<span class="math inline">\(th_F\)</span>ç”±æ‹Ÿåˆå¾—åˆ°çš„åˆ†å¸ƒçš„åˆ†ä½æ•°ç¡®å®šï¼š</p>
<p><span class="math display">\[
th_F\simeq th-\frac{\hat{\beta}}{\hat{\gamma}}((\frac{qN^\prime}{N^\prime_{th}})^{-\hat{\gamma}}-1)
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(q\)</span>ä¸ºæœŸæœ›<span class="math inline">\(S&lt;th\)</span>çš„æ¦‚ç‡ï¼Œ<span class="math inline">\(N^\prime\)</span>ä¸ºè§‚æµ‹å€¼çš„æ•°é‡ï¼Œ<span class="math inline">\(N^\prime_{th}\)</span>ä¸º<span class="math inline">\(S_i&lt;th\)</span>çš„ä¸ªæ•°ã€‚</p>
<h2 id="anomaly-interpretation">Anomaly Interpretation</h2>
<p><span class="math display">\[
\log(p_\theta(\mathbf{x}_t|\mathbf{z}_{t-T:t}))=\sum_{i=1}^M\log(p_\theta(x_t^i|\mathbf{z}_{t-T:t}))
\]</span></p>
<h1 id="experiments">Experiments</h1>
<h2 id="datasets-and-metrics">Datasets and Metrics</h2>
<h2 id="overall-performance">Overall Performance</h2>
<p><img src="http://qfxiao.me/img/1571411131954.png" /></p>
<p><img src="http://qfxiao.me/img/1571411148667.png" /></p>
<h2 id="effects-of-major-techniques">Effects of Major Techniques</h2>
<p><img src="http://qfxiao.me/img/1571411161522.png" /></p>
<p><img src="http://qfxiao.me/img/1571411178434.png" /></p>
<h2 id="visualization-on-z-space-representations">Visualization on Z-Space Representations</h2>
<p><img src="http://qfxiao.me/img/1571411190279.png" /></p>
<p><img src="http://qfxiao.me/img/1571411212926.png" /></p>
<p><img src="http://qfxiao.me/img/1571411223173.png" /></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/"><img class="thumbnail" src="http://qfxiao.me/img/1565783729478.png" alt="Anomaly Detection with Generative Adversarial Networks for Multivariate Time Series"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-09-22T14:32:18.000Z" title="2019-09-22T14:32:18.000Z">2019-09-22</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">10 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1568 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/">Anomaly Detection with Generative Adversarial Networks for Multivariate Time Series</a></h1><div class="content"><h1 id="introduction">Introduction</h1>
<p>è¿™ç¯‡æ–‡ç« æå‡ºäº†ä¸€ä¸ªåŸºäºGANçš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¨¡å‹ã€‚</p>
<p><a href="https://arxiv.org/abs/1809.04758">åŸæ–‡</a></p>
<h2 id="contribution">Contribution</h2>
<ol type="1">
<li>æå‡ºäº†åŸºäºGANçš„æ—¶é—´åºåˆ—æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹æ¨¡å‹</li>
<li>æˆ‘ä»¬ä½¿ç”¨åŸºäºLSTMçš„GANæ¥å¯¹å¤šå˜é‡æ—¶é—´åºåˆ—è¿›è¡Œå»ºæ¨¡</li>
<li>ç»“åˆä½¿ç”¨äº†Residual Losså’ŒDiscrimination Lossæ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­</li>
</ol>
<h2 id="background">Background</h2>
<h3 id="generative-adversarial-networks">Generative Adversarial Networks</h3>
<h4 id="gans-in-a-nutshell-an-extremely-simple-explanation">GANs In a Nutshell, an extremely simple explanation</h4>
<ul>
<li>æˆ‘ä»¬æƒ³è¦ä»ä¸€ä¸ªå¤æ‚çš„ã€é«˜ç»´çš„æ•°æ®åˆ†å¸ƒ<span class="math inline">\(p_r(x)\)</span>ä¸Šé‡‡æ ·å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ç‚¹ï¼Œç„¶è€Œ<span class="math inline">\(p_r(x)\)</span>æ— æ³•ç›´æ¥æ±‚å¾—</li>
<li>ä»£æ›¿æ–¹æ³•ï¼šä»ä¸€ä¸ªç®€å•çš„ã€å·²çŸ¥çš„åˆ†å¸ƒ<span class="math inline">\(p_z(z)\)</span>ä¸Šé‡‡æ ·ï¼Œç„¶åå­¦ä¹ ä¸€ä¸ªTransformation <span class="math inline">\(G(z): z\rightarrow x\)</span>æ¥å°†<span class="math inline">\(z\)</span>æ˜ å°„åˆ°<span class="math inline">\(x\)</span></li>
</ul>
<p><img src="http://qfxiao.me/img/1565836885697.png" /></p>
<h4 id="training-two-player-game">Training: Two-player Game</h4>
<ul>
<li><strong>Generator Network: </strong> ä»éšæœºåˆ†å¸ƒ<span class="math inline">\(p_z(z)\)</span>é‡‡æ ·<span class="math inline">\(z\)</span>ï¼Œé€šè¿‡æ˜ å°„ç”Ÿæˆæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œè¿™ä¸ªç”Ÿæˆçš„æ ·æœ¬è¦å°½é‡â€œçœŸå®â€ã€‚æ€ä¹ˆâ€œçœŸå®â€ï¼Ÿä¼˜åŒ–ç”Ÿæˆå™¨å‚æ•°<span class="math inline">\(\theta_G\)</span>æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†å³å¯</li>
<li><strong>Discriminator Network: </strong>æ¥å—ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œåˆ¤æ–­å…¶æ˜¯ç”Ÿæˆçš„æ ·æœ¬è¿˜æ˜¯çœŸå®çš„æ ·æœ¬ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œæˆ‘ä»¬æ˜¯çŸ¥é“ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x\)</span>åˆ°åº•æ˜¯ç”Ÿæˆçš„è¿˜æ˜¯çœŸå®çš„ï¼Œæ‰€ä»¥ä¼˜åŒ–åˆ¤åˆ«å™¨å‚æ•°<span class="math inline">\(\theta_D\)</span>æœ€å°åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†ï¼Œæœ€å¤§åŒ–å¯¹çœŸå®æ ·æœ¬çš„è¯„åˆ†ï¼ˆå³æœ€å¤§åŒ–åˆ†è¾¨çœŸå®æ ·æœ¬çš„èƒ½åŠ›ï¼‰</li>
</ul>
<p><img src="http://qfxiao.me/img/1565836982707.png" /></p>
<p>å½¢å¼åŒ–çš„æ¥è®²ï¼Œä¼˜åŒ–å‡½æ•°å¦‚ä¸‹ï¼š</p>
<p><span class="math display">\[\min\limits_{\theta_G}\max\limits_{\theta_D}V(G,D)=\mathbb{E}_{x\sim p_{data}(x)\log(\underbrace{D_{\theta{D}}(x)}_{åˆ¤åˆ«å™¨å¯¹çœŸå®æ ·æœ¬çš„è¯„åˆ†})}+\mathbb{E}_{z\sim p_z(z)}\log(1-\underbrace{D_{\theta_d}(G_{\theta_G}(z))}_{åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†})\]</span></p>
<p>è®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1565837745003.png" /></p>
<h3 id="long-short-time-memory-networks">Long Short Time Memory Networks</h3>
<h4 id="vanilla-recurrent-neural-networks">Vanilla Recurrent Neural Networks</h4>
<p>æ™®é€šçš„ç¥ç»ç½‘ç»œï¼š</p>
<p><img src="http://images0.cnblogs.com/blog2015/680781/201508/021735264703915.png" /></p>
<p>æ¦‚æ‹¬çš„æ¥è®²ï¼Œå¯ä»¥æ¶µç›–ä¸ºä¸€ä¸ªå…¬å¼<span class="math inline">\(\hat{\mathbf{y}}=f(\mathbf{x})\)</span>ã€‚å¯¹äºä¸€ä¸ªæ ·æœ¬<span class="math inline">\(\mathbf{x}\)</span>ï¼Œé€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œæ˜ å°„ï¼Œè¾“å‡º<span class="math inline">\(\mathbf{y}\)</span>ã€‚</p>
<p>å¯¹äºRNNï¼Œæˆ‘ä»¬å¤„ç†çš„æ˜¯åºåˆ—æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰æ ·æœ¬ä¹‹é—´å¹¶ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚å¯¹äºä¸€ä¸ªåºåˆ—ä¸­çš„ä¸€ä¸ªæ ·æœ¬<span class="math inline">\(x_t\in\{x_1,x_2,\cdots,x_n\}\)</span>ï¼Œå°†å…¶è¾“å…¥åˆ°ç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œä¸ºäº†å»ºæ¨¡<span class="math inline">\(x_t\)</span>ä¹‹å‰çš„å­åºåˆ—å¯¹<span class="math inline">\(x_t\)</span>çš„å½±å“å…³ç³»ï¼Œéœ€è¦å°†è¿™ä¸ªå­åºåˆ—çš„ä¿¡æ¯ä¹Ÿè¾“å…¥åˆ°ç¥ç»ç½‘ç»œä¸­ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿä¸ºæ¯ä¸€ä¸ªæ ·æœ¬ç‚¹ä¿å­˜ä¸€ä¸ªStateã€‚å³å®šä¹‰<span class="math inline">\(h_t=g(\hat{y_t})=g(f(x_t))\)</span>ï¼Œå¯¹äºå½“å‰æ ·æœ¬ç‚¹ï¼Œ<span class="math inline">\(\hat{y_t}=f(x_t,h_{t-1})\)</span>ã€‚ä¹Ÿå°±æ˜¯è¯´ç¥ç»ç½‘ç»œçš„è¾“å…¥ä¸ä»…åŒ…å«äº†å½“å‰æ ·æœ¬ç‚¹çš„ç‰¹å¾ï¼Œä¹ŸåŒ…å«äº†ä¸Šä¸€ä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€(ä¸Šä¸€ä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€åˆéšå«äº†ä¸Šä¸Šä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€...)ï¼Œå°±åƒæ˜¯ä¸ºç½‘ç»œåŠ ä¸Šäº†çŸ­æœŸè®°å¿†ã€‚</p>
<p><img src="https://adventuresinmachinelearning.com/wp-content/uploads/2017/09/Recurrent-neural-network.png" /></p>
<p><img src="http://qfxiao.me/img/1565838639451.png" /></p>
<p><img src="http://qfxiao.me/img/1565838658532.png" /></p>
<h4 id="gradient-flow-of-vanilla-rnn">Gradient Flow of Vanilla RNN</h4>
<p>ä¸‹é¢æ¥è¿›è¡Œä¸€äº›å½¢å¼åŒ–çš„å®šä¹‰ï¼Œå‡è®¾åœ¨æ—¶åˆ»<span class="math inline">\(t\)</span>ç½‘ç»œè¾“å…¥ç‰¹å¾ä¸º<span class="math inline">\(x_t\)</span>ï¼Œè¾“å‡ºéšå«çŠ¶æ€ä¸º<span class="math inline">\(h_{t}\)</span>ï¼Œå…¶ä¸ä»…å’Œå½“å‰è¾“å…¥<span class="math inline">\(x_t\)</span>æœ‰å…³ï¼Œè¿˜å’Œä¸Šä¸€ä¸ªéšå«çŠ¶æ€<span class="math inline">\(h_{t-1}\)</span>æœ‰å…³ï¼š</p>
<ul>
<li>å½“å‰æ—¶åˆ»æ€»çš„å‡€è¾“å…¥<span class="math inline">\(z_t=Uh_{t-1}+Wx_t+b\)</span></li>
<li>å½“å‰æ—¶åˆ»è¾“å‡ºéšå«çŠ¶æ€<span class="math inline">\(h_t=f(z_t)\)</span></li>
<li>å½“å‰æ—¶åˆ»è¾“å‡º<span class="math inline">\(\hat{y}_t=Vh_t\)</span></li>
</ul>
<p>RNNçš„æ¢¯åº¦æ›´æ–°å…¬å¼(æ¨å¯¼è¿‡ç¨‹æ¯”è¾ƒå¤æ‚)ï¼š</p>
<p><span class="math display">\[\frac{\partial{\mathcal{L}}}{\partial U}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t \delta_{t,k}\mathbf{h}_{k-1}^T\]</span></p>
<p><span class="math display">\[\frac{\partial{\mathcal{L}}}{\partial{W}}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t \delta_{t,k}x_k^T\]</span></p>
<p><span class="math display">\[\frac{\partial\mathcal{L}}{\partial{b}}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t\delta_{t,k}\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\delta_{t,k}=\frac{\partial{\mathcal{L}}}{\partial{z_k}}=\text{diag}(f^\prime(z_k))U^T\delta_{t,k+1}\)</span>å®šä¹‰ä¸ºç¬¬<span class="math inline">\(t\)</span>æ—¶åˆ»çš„æŸå¤±å¯¹ç¬¬<span class="math inline">\(k\)</span>æ—¶åˆ»éšè—ç¥ç»å±‚çš„å‡€è¾“å…¥<span class="math inline">\(z_k\)</span>çš„å¯¼æ•°ï¼Œä¸”<span class="math inline">\(z_k=Uh_{k-1}+Wx_k+b,1\leq k&lt;t\)</span>ã€‚</p>
<p>RNNçš„æ¢¯åº¦æµå‘å¦‚ä¸‹å›¾çº¢ç®­å¤´æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565838776226.png" /></p>
<p>RNNä¼šé‡åˆ°æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚æ ¹æ®å‰é¢çš„å…¬å¼ï¼Œ<span class="math inline">\(\delta_{t,k}\)</span>å®é™…ä¸Šæ˜¯é€’å½’å®šä¹‰çš„ï¼Œå±•å¼€å¾—åˆ°ï¼š</p>
<p><span class="math display">\[\delta_{t,k}=\prod\limits_{\tau=k}^{t-1}(\text{diag}(f^\prime(z_\tau))U^T)\delta_{t,t}\]</span></p>
<p>å¦‚æœå®šä¹‰<span class="math inline">\(\gamma\cong\parallel\text{diag}(f^\prime(z_\tau))U^T\parallel\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(\delta_{t,k}\cong\gamma^{t-k}\delta_{t,t}\)</span>ã€‚åœ¨<span class="math inline">\(t-k\)</span>å¾ˆå¤§æ—¶ï¼Œ<span class="math inline">\(\gamma&lt;1\)</span>ä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼Œ<span class="math inline">\(\gamma&gt;1\)</span>æ—¶ä¼šå¯¼è‡´æ¢¯åº¦çˆ†ç‚¸ã€‚</p>
<p><img src="http://qfxiao.me/img/1565839064829.png" /></p>
<p><img src="http://qfxiao.me/img/1565839083693.png" /></p>
<h4 id="long-short-time-memory">Long Short Time Memory</h4>
<p>LSTMæ˜¯ä¸€ç§è§£å†³RNNæ¢¯åº¦æ¶ˆå¤±é—®é¢˜çš„æ”¹è¿›ç‰ˆæœ¬ï¼š</p>
<p><img src="http://qfxiao.me/img/1565839135232.png" /></p>
<p>åœ¨LSTMä¸­ï¼Œç»´æŠ¤äº†ä¸¤ä¸ªStateï¼Œ<span class="math inline">\(c_t\)</span>å’Œ<span class="math inline">\(h_t\)</span>ã€‚å…¶ä¸­<span class="math inline">\(c_t\)</span>ç”±é—å¿˜é—¨<span class="math inline">\(f\)</span>ä¸ä¸Šä¸€ä¸ª<span class="math inline">\(c_{t-1}\)</span>ç›¸ä¹˜(ä»£è¡¨ç»§æ‰¿ä¸Šä¸€ä¸ªCellçš„ä¿¡æ¯å¹¶åŠ ä»¥ä¸€å®šç¨‹åº¦çš„é—å¿˜)ï¼ŒåŠ ä¸Šè¾“å‡ºé—¨<span class="math inline">\(i\)</span>ä¸Gate Gate <span class="math inline">\(g\)</span>ç›¸ä¹˜(Gate Gateä»£è¡¨å½“å‰çš„å€™é€‰çŠ¶æ€ï¼Œè¾“å‡ºé—¨<span class="math inline">\(i\)</span>æ§åˆ¶å½“å‰å€™é€‰çŠ¶æ€æœ‰å¤šå°‘ä¿¡æ¯éœ€è¦ä¿å­˜)ã€‚æœ€åï¼Œè¾“å‡ºé—¨<span class="math inline">\(o\)</span>æ§åˆ¶å½“å‰æ—¶åˆ»çš„Cell State <span class="math inline">\(c_t\)</span>æœ‰å¤šå°‘ä¿¡æ¯éœ€è¦è¾“å‡ºç»™å¤–éƒ¨çŠ¶æ€<span class="math inline">\(h_t\)</span>ã€‚</p>
<p>ä¸‰ä¸ªé—¨çš„è®¡ç®—æ–¹å¼ä¸ºï¼š</p>
<p><span class="math display">\[i_t=\sigma(W_ix_t+U_ih_{t-1}+b_i)\]</span></p>
<p><span class="math display">\[f_t=\sigma(W_fx_t+U_fh_{t-1}+b_f)\]</span></p>
<p><span class="math display">\[o_t=\sigma(W_ox_t+U_oh_{t-1}+b_o)\]</span></p>
<p><img src="http://qfxiao.me/img/1565839263008.png" /></p>
<p><img src="http://qfxiao.me/img/1565839279246.png" /></p>
<h2 id="methodology">Methodology</h2>
<p>æ€»ä½“æ¡†æ¶å›¾å¦‚Fig 1æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565783729478.png" /></p>
<h3 id="gan-with-lstm-rnn">GAN with LSTM-RNN</h3>
<p>ç½‘ç»œç»“æ„ä¸Šç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨éƒ½æ˜¯LSTMï¼Œä¼˜åŒ–å‡½æ•°å’Œæ™®é€šGANä¸€æ ·ï¼š</p>
<p><span class="math display">\[\min\limits_G\max\limits_D V(D,G)=\mathbb{E}_{x\sim p_{data}(x)}[\log D(x)]+\mathbb{E}_{z\sim p_z(z)}[\log (1-D(G(z)))]\]</span></p>
<h3 id="gan-based-anomaly-score">GAN-based Anomaly Score</h3>
<p>åœ¨æµ‹è¯•é˜¶æ®µï¼Œéœ€è¦ä½¿ç”¨æ¢¯åº¦ä¼˜åŒ–å¯»æ‰¾ä¸€ä¸ªä½¿å¾—<span class="math inline">\(G_{rnn}(z)\)</span>æœ€æ¥è¿‘<span class="math inline">\(X^{test}\)</span>çš„<span class="math inline">\(z^k\)</span>ï¼š</p>
<p><span class="math display">\[\min\limits_{Z^k}Error(X^{test},G_{rnn}(Z^k))=1-Similarity(X^{test},G_{rnn}(Z^k))\]</span></p>
<p>æœ¬æ–‡å®šä¹‰äº†ä¸¤ç§Anomaly Scoreï¼Œä¸€ç§æ˜¯Residual Lossï¼š</p>
<p><span class="math display">\[Res(X^{test}_t)=\sum\limits_{i=1}^n|x^{test,i}_t-G_{rnn}(Z^{k,i}_t)|\]</span></p>
<p>ä¸€ç§æ˜¯Discrimination Lossï¼Œå³åˆ¤åˆ«å™¨çš„è¾“å‡º<span class="math inline">\(D_{rnn}(x_t^{test})\)</span>ã€‚</p>
<p>æ€»çš„Anomaly Scoreï¼š</p>
<p><span class="math display">\[S^{test}_t=\lambda Res(X^{test}_t)+(1-\lambda)D_{rnn}(x^{test}_t)\]</span></p>
<h3 id="anomaly-detection-framework">Anomaly Detection Framework</h3>
<p>æ¨¡å‹çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1565784946781.png" /></p>
<p>ç”±äºæœ¬æ–‡æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—é¢„æµ‹ï¼Œè€Œä¸”æ—¶é—´åºåˆ—çš„é•¿åº¦æœ‰å¯èƒ½æ¯”è¾ƒé•¿ï¼Œä½œè€…ä½¿ç”¨äº†æ»‘åŠ¨çª—å£å’ŒPCAæ¥è¿›è¡Œé¢„å¤„ç†ã€‚</p>
<h2 id="experiments">Experiments</h2>
<p><img src="http://qfxiao.me/img/1565847175265.png" /></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/"><img class="thumbnail" src="http://qfxiao.me/img/1567780227803.png" alt="ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-09-22T14:29:18.000Z" title="2019-09-22T14:29:18.000Z">2019-09-22</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">9 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1312 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/">ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection</a></h1><div class="content"><h1 id="introduction">Introduction</h1>
<p>æœ¬æ–‡é’ˆå¯¹é¢å‘åŒºé—´çš„KPIå¼‚å¸¸æ£€æµ‹æå‡ºäº†Label Screeningæ–¹æ³•å’ŒRelearning Algorithm.</p>
<p><a href="https://www.sciencedirect.com/science/article/pii/S0957417419304282">åŸæ–‡</a></p>
<h2 id="contribution">Contribution</h2>
<ol type="1">
<li>æå‡ºäº†ä¸€ç§Label Screeningæ–¹æ³•æ¥å¯¹åŒºé—´å†…ä¸åŒé‡è¦æ€§è¿›è¡Œè¿‡æ»¤</li>
<li>æå‡ºäº†ä¸€ç§Relearning Algorithmæ¥å¯¹FPå’ŒTPè¿›è¡ŒRelearningï¼Œåœ¨ä¸å‡å°‘Recallçš„æ¡ä»¶ä¸‹å¢å¤§Precision</li>
</ol>
<h2 id="methodology">Methodology</h2>
<h3 id="overall-structure">Overall Structure</h3>
<p>ç®—æ³•çš„æ•´ä½“æ¡†æ¶å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191025152359346.png" /></p>
<h3 id="label-screening-model">Label Screening Model</h3>
<p>é¢„è®­ç»ƒçš„ç»“æœè¢«åˆ†ä¸º<span class="math inline">\(TP_{po},FP_{po},TN_{po},FN_{po}\)</span>å››ç±»ï¼Œ<span class="math inline">\(TP_{po}\)</span>å’Œ<span class="math inline">\(FN_{po}\)</span>å¯ä»¥è¢«ç»†åˆ†å¦‚ä¸‹ï¼š <span class="math display">\[
\begin{align}TP_{po}&amp;=TP_{po,withinT}+TP_{po,afterT}\\&amp;=TP_{po,withinT}+TP_{po,afterT,tpl}+TP_{po,after,fnl}\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}FN_{po}&amp;=FN_{po,withinT}+FN_{po,afterT}\\&amp;=FN_{po,withinT,tpl}+FN_{po,,withinT,fnl}+FN_{po,afterT,tpl}+FN_{po,afterT,fnl}\end{align}
\]</span></p>
<p>å…¶ä¸­ä¸‹æ ‡<span class="math inline">\({}_{withinT}\)</span>ä»£è¡¨åœ¨å¼‚å¸¸ç‰‡æ®µç¬¬ä¸€ä¸ªç‚¹<span class="math inline">\(T\)</span>è·ç¦»å†…çš„æ‰€æœ‰ç‚¹ï¼Œä¸‹æ ‡<span class="math inline">\({}_{afterT}\)</span>ä»£è¡¨<span class="math inline">\(T\)</span>è·ç¦»ä¹‹åã€‚ä¸‹æ ‡<span class="math inline">\({}_{tpl}\)</span>å’Œ<span class="math inline">\({}_{fnl}\)</span>åˆ†åˆ«ä»£è¡¨åœ¨å¼‚å¸¸ç‰‡æ®µä¸­ï¼ŒåŒ…å«å’Œä¸åŒ…å«<span class="math inline">\(TP_{po,withinT}\)</span>çš„ç‚¹ã€‚</p>
<p>ä»¥TPä¸ºä¾‹ï¼ŒPoint-basedçš„TPåŒ…å«äº†åœ¨TèŒƒå›´ä¹‹å†…çš„ï¼ˆå³åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯TPçš„ç‚¹ï¼‰å’ŒTèŒƒå›´ä¹‹å¤–çš„ç‚¹ï¼ˆå³åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¸è®¤ä¸ºæ˜¯TPçš„ç‚¹ï¼‰ã€‚è€Œåœ¨TèŒƒå›´ä¹‹å¤–çš„ç‚¹åˆå¯ä»¥ç»†åˆ†ä¸ºè¯¥å¼‚å¸¸ç‰‡æ®µæ˜¯å¦åŒ…å«<span class="math inline">\(TP_{po,withinT}\)</span>çš„ç‚¹ï¼ˆå³è¯¥ç‚¹åœ¨Interval-basedçš„æ ‡å‡†ä¸­ä¸ä¼šè¢«åˆ¤å®šä¸ºTPï¼Œä½†è¯¥å¼‚å¸¸ç‰‡æ®µæœ‰å…¶ç‚¹ä¼šè¢«åˆ¤å®šä¸ºTPï¼‰ã€‚</p>
<p>ç±»ä¼¼çš„ï¼Œ<span class="math inline">\(TP_{io}\)</span>å’Œ<span class="math inline">\(FN_{io}\)</span>å¯ä»¥è¢«åˆ†è§£ä¸ºï¼š <span class="math display">\[
\begin{align}TP_{io}&amp;=TP_{po,withinT}+TP_{po,afterT,tpl}+FN_{po,withinT,tpl}+FN_{po,afterT,tpl}\\&amp;=TP_{po}+FN_{po,withinT,tpl}+FN_{po,afterT,tpl}-TP_{po,afterT,fnl}\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}FN_{io}&amp;=FN_{po,withinT,fnl}+FN_{po,afterT,fnl}+TP_{po,afterT,fnl}\\&amp;=FN_{po}+TP_{po,afterT,fnl}-FN_{po,withinT,tpl}-FN_{po,afterT,tpl}\end{align}
\]</span></p>
<p>æ–‡ä¸­å¯¹è¯¥éƒ¨åˆ†çš„åˆ†æå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol type="1">
<li>åœ¨Interval-orientedçš„æ ‡å‡†ä¸­ï¼Œ<span class="math inline">\(FN_{po,tpl}\)</span>çš„ç‚¹ä»ä¼šè¢«è®¤ä¸ºæ˜¯<span class="math inline">\(TP_{io}\)</span>ï¼Œè€Œ<span class="math inline">\(TP_{po,afterT}\)</span>ï¼ˆä¸å¸¦<span class="math inline">\({}_{tpl}\)</span>ï¼‰ä¸ä¼šè¢«è®¤ä¸ºæ˜¯<span class="math inline">\(TP_{io}\)</span>ï¼Œæ‰€ä»¥æœ€ç»ˆ<span class="math inline">\(TP_{io}\)</span>ç”±æ‰€æœ‰<span class="math inline">\(TP_{po}\)</span>åŠ ä¸Šé‚£äº›ä¼šè¢«è®¤ä¸ºæ˜¯<span class="math inline">\(TP_{io}\)</span>çš„<span class="math inline">\(FN_{po,tpl}\)</span>å†å»æ‰ä¸å¸¦<span class="math inline">\({}_{tpl}\)</span>çš„<span class="math inline">\(TP_{po,afterT}\)</span>ç»„æˆï¼Œå³å…¬å¼(6)</li>
<li>åŒæ—¶ï¼Œæ ¹æ®å…¬å¼(6)ï¼Œå¦‚æœ<span class="math inline">\(TP_{po}\)</span>å˜ä¸º<span class="math inline">\(FN_{po,tpl}\)</span>ï¼Œä¹Ÿä¸ä¼šå¯¹æœ€ç»ˆç»“æœé€ æˆå½±å“ã€‚ä½†æ˜¯æ ¹æ®å…¬å¼(5)å’Œå…¬å¼(7)ï¼Œ<span class="math inline">\(TP_{po,withinT}\)</span>å˜æˆ<span class="math inline">\(FN_{po,withinT,fnl}\)</span>ä¼šå‡å°<span class="math inline">\(TP_{io}\)</span>åŒæ—¶å¢å¤§<span class="math inline">\(FN_{io}\)</span></li>
<li>æ–‡ç« æŒ‡å‡ºï¼Œè™½ç„¶<span class="math inline">\(FN_{po,withinT,tpl}\)</span>å’Œ<span class="math inline">\(FN_{po,afterT,tpl}\)</span>æœ€åéƒ½ä¼šè¢«è®¤ä¸ºæ˜¯<span class="math inline">\(TP_{io}\)</span>ï¼Œä½†ä½œè€…å‡è®¾<span class="math inline">\(FN_{po,withinT,tpl}\)</span>æ›´éš¾æ£€æµ‹ï¼Œæ‰€ä»¥åº”è¯¥ä¿ç•™ï¼Œè€Œ<span class="math inline">\(FN_{po,afterT,tpl}\)</span>åº”è¯¥å‰Šå‡</li>
<li>Label Screeningæ–¹æ³•å»é™¤äº†<span class="math inline">\(FN_{po,afterT}\)</span>çš„ç‚¹</li>
<li>Screenedä¹‹åçš„è®­ç»ƒé›†è¢«ç”¨æ¥è®­ç»ƒDNNä¸»æ¨¡å‹ï¼Œä½†Label Screeningçš„é¢„æµ‹ç»“æœä¹Ÿä¼šè¢«ä¿ç•™ï¼Œå’ŒDNNä¸»æ¨¡å‹çš„ç»“æœè¿›è¡Œç»„åˆ</li>
</ol>
<p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1567780638004.png" /></p>
<h3 id="relearning-algorithm">Relearning Algorithm</h3>
<p>Relearning Modelçš„è¾“å…¥æ˜¯DNNä¸»æ¨¡å‹é¢„æµ‹å‡ºæ¥çš„å¼‚å¸¸ï¼Œå…¶ä¸­åŒ…æ‹¬TPå’ŒFPã€‚Relearning Modelé‡‡ç”¨çš„æ˜¯éšæœºæ£®æ—ï¼Œå…¶è¾“å…¥çš„æ ·æœ¬é€šè¿‡é‡‡æ ·å¾—åˆ°ï¼š <span class="math display">\[
\begin{align}
\text{relearning}\space&amp;\text{training set}=\\&amp; shuffle\{4C\ast\text{randomof}(TP_{po})\\&amp;+C\cdot\text{randomof}(FP_{po})+C\cdot\text{randomof}(TN_{po})\}
\end{align}
\]</span> å…¶ä¸­<span class="math inline">\(C\)</span>ä¸ºå¸¸æ•°ã€‚TNå’ŒFPéƒ½çœ‹ä½œæ˜¯è´Ÿä¾‹(æ­£å¸¸æ ·æœ¬)ï¼ŒTPçœ‹ä½œæ˜¯æ­£ä¾‹ã€‚</p>
<p><img src="http://qfxiao.me/img/1567868588559.png" /></p>
<h3 id="detection">Detection</h3>
<p>å¯¹äºä¸€ä¸ªæ»‘åŠ¨çª—å£<span class="math inline">\(x_t=\{x_{t-w+1},\cdots,x_t\}\)</span>ï¼Œå¼‚å¸¸æ£€æµ‹ç®—æ³•çš„ç›®æ ‡æ˜¯è¾“å‡ºæ£€æµ‹ç»“æœ<span class="math inline">\(y_t\in\{0,1\}\)</span>æ¥è¡¨ç¤ºæ—¶é—´<span class="math inline">\(t\)</span>æ˜¯å¦å‘ç”Ÿå¼‚å¸¸ã€‚å®é™…ä¸Šç®—æ³•è¾“å‡ºçš„æ˜¯<span class="math inline">\(p_{y_t}\in[0,1]\)</span>æ¦‚ç‡å€¼æ¥è¡¨ç¤ºåœ¨æ—¶é—´<span class="math inline">\(t\)</span>å‘ç”Ÿå¼‚å¸¸çš„æ¦‚ç‡ã€‚æ–‡ä¸­ä¸‰ä¸ªæ¨¡å‹ä¼šå¾—åˆ°ä¸‰ä¸ªè¾“å‡ºï¼š<span class="math inline">\(y_{t,ls},y_{t,main},y_{t,re}\)</span>ã€‚æœ€ç»ˆç»“æœä¸ºï¼š <span class="math display">\[
y_t=y_{t,ls}\space\&amp;\space y_{t,main}\space\&amp; \space y_{t,re}
\]</span> åœ¨ç»˜åˆ¶PRæ›²çº¿æ—¶ï¼Œé‡‡ç”¨çš„å…¬å¼ä¸ºï¼š <span class="math display">\[
\begin{align}
p_{y_t}(th)=&amp;(1-sig(p_{y_t,ls},th))\cdot(p_{y_t,ls})\\
&amp;+sig(p_{y_t,ls},th)\cdot(1-sig(p_{y_t,main},th))\cdot p_{y_t,main}\\
&amp;+sig(p_{y_t,ls},th)\cdot sig(p_{y_t,main},th)\cdot p_{y_t,re}\\
\end{align}
\]</span></p>
<p><span class="math display">\[
y_t(th)=sig(p_{y_t}(th),th)
\]</span></p>
<p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1567933937509.png" /></p>
<h2 id="experiments">Experiments</h2>
<h3 id="datasets">Datasets</h3>
<p>æ¸…åAIOpsæ•°æ®é›†ï¼Œé€‰å–äº†25æ¡KPIã€‚</p>
<h3 id="preprocessing">Preprocessing</h3>
<ol type="1">
<li><strong>Missing Data.</strong> å»é™¤ã€‚</li>
<li><strong>Standardization.</strong> Minmax Standardizationï¼ŒFeature Extractionä½¿ç”¨çš„æ˜¯Standardizationåçš„æ•°æ®ã€‚</li>
<li><strong>Feature Extraction.</strong> ä½¿ç”¨äº†12ç§ç‰¹å¾ã€‚</li>
</ol>
<table>
<thead>
<tr class="header">
<th>Group</th>
<th>Feature Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Values</td>
<td>The original values standardized</td>
</tr>
<tr class="even">
<td>Statistical Features</td>
<td>Mean, Standard Deviation, Range, Difference...</td>
</tr>
<tr class="odd">
<td>Fitting Features</td>
<td>EWMA, AR</td>
</tr>
<tr class="even">
<td>Wavelet Features</td>
<td>Db2 wavelet decomposition</td>
</tr>
</tbody>
</table>
<h2 id="results">Results</h2>
<h3 id="aucpr">AUCPR</h3>
<p><img src="http://qfxiao.me/img/1567780198147.png" /></p>
<p><img src="http://qfxiao.me/img/1567780227803.png" /></p>
<h3 id="f1">F1</h3>
<p><img src="http://qfxiao.me/img/1567780241121.png" /></p>
<h2 id="remark">Remark</h2>
<ol type="1">
<li>è¿™ç¯‡æ–‡ç« çš„Label Screeningæ–¹æ³•å®é™…ä¸Šæ˜¯åœ¨å¤„ç†æ ·æœ¬åˆ†ç±»éš¾æ˜“åº¦çš„é—®é¢˜ï¼Œå°†å¼‚å¸¸åŒºé—´å†…å®¹æ˜“çš„æ ·æœ¬å»é™¤äº†</li>
<li>å¯¹äºæ—¶é—´åºåˆ—çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¸€èˆ¬æ˜¯Point-basedçš„å¼‚å¸¸æ ‡ç­¾ï¼Œä¸€ä¸ªæ—¶é—´ç‚¹çš„ç‰¹å¾æ˜¯æœ‰é™çš„ã€‚å¦‚æœç”¨çª—å£çš„æ–¹å¼ï¼Œä»¥<span class="math inline">\(\{x_{t-w+1},\cdots,x_t\}\)</span>ä½œä¸ºæ—¶é—´<span class="math inline">\(t\)</span>çš„è¾“å…¥ï¼ˆå½“ç„¶æ¯ä¸ª<span class="math inline">\(x_t\)</span>å¯ä»¥æœ‰å¤šä¸ªChannelï¼‰ï¼Œç„¶åæŠŠé¢„æµ‹ç»“æœä½œä¸ºæ—¶é—´<span class="math inline">\(t\)</span>çš„è¾“å‡º</li>
</ol>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/"><img class="thumbnail" src="http://qfxiao.me/img/1571719738542.png" alt="Unsupervised Anomaly Detection via Variational Auto-Encoder for Seasonal KPIs in Web Applications"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-09-22T12:35:18.000Z" title="2019-09-22T12:35:18.000Z">2019-09-22</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">25 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 3820 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/">Unsupervised Anomaly Detection via Variational Auto-Encoder for Seasonal KPIs in Web Applications</a></h1><div class="content"><h2 id="abstract">Abstract</h2>
<p>æœ¬æ–‡æå‡ºäº†Donutï¼Œä¸€ä¸ªåŸºäºVAEçš„æ— ç›‘ç£æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿã€‚</p>
<p><a href="https://dl.acm.org/citation.cfm?id=3185996">åŸæ–‡</a></p>
<p><img src="http://qfxiao.me/img/1571719484833.png" /></p>
<h2 id="contribution">Contribution</h2>
<ol type="1">
<li>Donutä¸­ä½¿ç”¨åˆ°äº†ä¸‰ä¸ªæŠ€å·§ï¼ŒåŒ…æ‹¬æ”¹è¿›åçš„ELBOã€ç¼ºå¤±æ•°æ®æ³¨å…¥å’ŒMCMCæ’å€¼ï¼›</li>
<li>æå‡ºåŸºäºVAEçš„å¼‚å¸¸æ£€æµ‹è®­ç»ƒæ—¢éœ€è¦æ­£å¸¸æ ·æœ¬ä¹Ÿéœ€è¦å¼‚å¸¸æ ·æœ¬ï¼›</li>
<li>å¯¹Donutæå‡ºäº†åœ¨z-ç©ºé—´ä¸­åŸºäºKDEçš„ç†è®ºè§£é‡Šã€‚</li>
</ol>
<h2 id="background">Background</h2>
<h3 id="anomaly-detection">Anomaly Detection</h3>
<p>å¯¹äºä»»æ„æ—¶é—´<span class="math inline">\(t\)</span>ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼<span class="math inline">\(x_{t-T+1},\cdots,x_t\)</span>ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º<span class="math inline">\(y_t=1\)</span>)ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚<span class="math inline">\(p(y_t=1|x_{t-T+1},\cdots,x_t)\)</span>ã€‚</p>
<h2 id="methodology">Methodology</h2>
<h3 id="problem-statement">Problem Statement</h3>
<p>æœ¬æ–‡çš„ç›®çš„æ˜¯<strong>åŸºäºæ·±åº¦ç”Ÿæˆç½‘ç»œå¼€å‘å…·æœ‰ç†è®ºè§£é‡Šæ€§çš„æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œå¹¶ä¸”åœ¨æœ‰æ ‡ç­¾çš„æƒ…å†µä¸‹èƒ½åˆ©ç”¨æ ‡ç­¾ä¿¡æ¯æå‡æ€§èƒ½</strong>ã€‚æœ¬æ–‡åŸºäºVAEæ¥æ„å»ºæ¨¡å‹ã€‚</p>
<p><img src="http://qfxiao.me/img/1565532060281.png" /></p>
<h3 id="network-structure">Network Structure</h3>
<p>ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565532453958.png" /></p>
<p>ä¸€å…±åŒ…å«äº†é¢„å¤„ç†ã€è®­ç»ƒå’Œæ£€æµ‹ä¸‰ä¸ªéƒ¨åˆ†ã€‚</p>
<p>ä¸‹å›¾ä¸ºæ¨¡å‹çš„æ¦‚ç‡å›¾æ¨¡å‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1565532474201.png" /></p>
<p>å›¾ä¸­åŒå®çº¿çš„æ¡†ä¸ºæœ¬æ–‡æ¨¡å‹æœ‰åˆ«äºä¼ ç»ŸVAEçš„åœ°æ–¹ï¼Œå…¶ä½™åœ°æ–¹å’ŒVAEä¸€æ ·ã€‚å…ˆéªŒæ¦‚ç‡<span class="math inline">\(p_\theta(z)\)</span>é€‰ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ<span class="math inline">\(\mathcal{N}(0,I)\)</span>ï¼ŒåéªŒæ¦‚ç‡<span class="math inline">\(x\)</span>å’Œ<span class="math inline">\(z\)</span>éƒ½æ˜¯å¯¹è§’åŒ–é«˜æ–¯åˆ†å¸ƒï¼Œå³<span class="math inline">\(p_\theta(x|z)=\mathcal{N}(\mu_x,\sigma_x^2 I),q_\phi(z|x)=\mathcal{N}(\mu_z,\sigma_z^2 I)\)</span>ã€‚å¦‚Figure 4æ‰€ç¤ºï¼Œæ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œä¸­åˆ†åˆ«éƒ½æœ‰éšå«å±‚<span class="math inline">\(f_\phi(x)\)</span>å’Œ<span class="math inline">\(f_\theta(z)\)</span>å¯¹ç½‘ç»œçš„è¾“å…¥è¿›è¡Œç‰¹å¾æŠ½å–ã€‚é«˜æ–¯åˆ†å¸ƒçš„å‚æ•°å³ä»è¿™äº›æŠ½å–å‡ºæ¥çš„ç‰¹å¾ä¸Šå¾—åˆ°ã€‚å‡å€¼é€šè¿‡çº¿æ€§å±‚å¾—åˆ°ï¼š<span class="math inline">\(\mu_x=W^T_{\mu_x}f_\theta(z)+b_{\mu_x}, \mu_z=W^T_{\mu_z}f_\theta(x)+b_{\mu_z}\)</span>ã€‚æ ‡å‡†å·®é€šè¿‡Soft Pluså±‚åŠ ä¸€ä¸ªé«˜æ–¯å™ªå£°å¾—åˆ°ï¼š<span class="math inline">\(\sigma_x=\text{SoftPlus}[W^T_{\sigma_x}f_\theta(z)+b_{\sigma_x}]+\varepsilonï¼Œ\sigma_x=\text{SoftPlus}[W^T_{\sigma_z}f_\theta(x)+b_{\sigma_z}]+\varepsilon\)</span>ã€‚</p>
<p>æ–‡ä¸­æåˆ°å› ä¸ºKPIçš„å±€éƒ¨æ–¹å·®éå¸¸å°ï¼Œæ‰€ä»¥é‡‡ç”¨ç›´æ¥å»ºæ¨¡<span class="math inline">\(\sigma_x,\sigma_z\)</span>çš„æ–¹å¼è€Œä¸æ˜¯é‡‡ç”¨å¯¹æ•°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸ºäº†ç†è®ºä¸Šçš„è§£é‡Šæ€§ï¼Œæ–‡ä¸­çš„ç¥ç»ç½‘ç»œåªä½¿ç”¨äº†å…¨è¿æ¥å±‚ã€‚</p>
<h3 id="training">Training</h3>
<p>è®­ç»ƒå¯ä»¥ç›´æ¥é‡‡ç”¨ç»å…¸çš„SGVBæ¥ä¼˜åŒ–ELBOï¼š <span class="math display">\[
\begin{align}
\log p_\theta(x)&amp;\geq\log p_\theta(x)-\text{KL}[q_\phi(z|x)\parallel p_\theta(z|x)]\\
&amp;=\mathcal{L}\\
&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x)+\log p_\theta(z|x)-\log q_\phi(z|x)]\\
&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x,z)-\log q_\phi(z|x)]\\
&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)+\log p_\theta(z)-\log q_\phi(z|x)]
\end{align}
\]</span> ä½†æ˜¯åœ¨å®é™…çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè®­ç»ƒæ•°æ®éœ€è¦ä¿è¯éƒ½æ˜¯æ­£å¸¸æ ·æœ¬ï¼Œä½†å®é™…ä¸Šè®­ç»ƒæ ·æœ¬æœ‰å¯èƒ½ä¼šåŒ…å«å¼‚å¸¸æˆ–è€…æ˜¯ç¼ºå¤±å€¼ã€‚ä¸€ç§åšæ³•æ˜¯ç”¨ç¼ºå¤±å€¼å¡«å……çš„ç®—æ³•æ¥å¡«å……è¿™äº›å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼ï¼Œä½†ä½œè€…è®¤ä¸ºä½¿ç”¨ç¼ºå¤±å€¼å¡«å……ç®—æ³•å¹¶ä¸èƒ½å¾ˆå¥½çš„è¿˜åŸæ•°æ®çš„æ­£å¸¸æ¨¡å¼ï¼Œä»è€Œä¿è¯ç®—æ³•çš„æœ‰æ•ˆæ€§ã€‚åœ¨æ–‡ä¸­ä½œè€…é‡‡ç”¨äº†ä¿®æ”¹ELBOçš„æ–¹æ³•ï¼Œå¹¶å°†å…¶ç§°ä¹‹ä¸º<strong>Modified ELBO (M-ELBO)</strong>ï¼Œå…¬å¼å¦‚ä¸‹ï¼š <span class="math display">\[
\tilde{\mathcal{L}}=\mathbb{E}_{q_\phi(z|x)}[\sum\limits_{w=1}^W{\alpha_w\log p_\theta(x_w|z)+\beta\log p_\theta(z)-\log q_\phi(z|x)}]
\]</span> å…¶ä¸­<span class="math inline">\(\alpha_w\)</span>ä¸ºæŒ‡ç¤ºæ ‡è®°ï¼Œ<span class="math inline">\(\alpha_w=1\)</span>ä»£è¡¨ä¸æ˜¯å¼‚å¸¸ä¹Ÿä¸æ˜¯ç¼ºå¤±ã€‚<span class="math inline">\(\beta\)</span>å®šä¹‰ä¸º<span class="math inline">\(\beta=\frac{\sum_{w=1}^W\alpha_w}{W}\)</span>ã€‚</p>
<p>åœ¨<strong>M-ELBO</strong>ä¸­ï¼Œå¼‚å¸¸æˆ–ç¼ºå¤±å€¼å¯¹åº”çš„<span class="math inline">\(\log p_\theta(x_w|z)\)</span>çš„è´¡çŒ®ä¼šè¢«æ’é™¤ï¼ŒåŒæ—¶<span class="math inline">\(\log p_\theta(z)\)</span>åœ¨ä¹˜ä»¥<span class="math inline">\(\beta\)</span>åä¼šç›¸åº”ç¼©å°ã€‚ä½œè€…æ²¡æœ‰ä¿®æ”¹<span class="math inline">\(\log q_\phi(z|x)\)</span>è¿™ä¸€é¡¹çš„åŸå› æœ‰äºŒï¼šä¸€æ˜¯<span class="math inline">\(q_\phi(z|x)\)</span>ä»…ä»…æ˜¯ä»<span class="math inline">\(x\)</span>åˆ°<span class="math inline">\(z\)</span>çš„æ˜ å°„ï¼Œå¹¶ä¸éœ€è¦è€ƒè™‘â€œæ­£å¸¸æ¨¡å¼â€ï¼›äºŒæ˜¯<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[-\log q_\phi(z|x)]\)</span>å°±æ˜¯<span class="math inline">\(q_\phi(z|x)\)</span>çš„ç†µï¼Œè€Œè¿™ä¸ªåœ¨åé¢çš„ç†è®ºåˆ†æä¸­æœ‰ç‰¹åˆ«çš„å«ä¹‰ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ç§è§£å†³æ–¹æ³•å°±æ˜¯æŠŠæ‰€æœ‰åŒ…å«å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼çš„çª—å£å»é™¤ï¼Œè¿™ç§æ–¹æ³•çš„æ€§èƒ½åœ¨å®éªŒä¸­ä¼šè¿›è¡Œè®¨è®ºã€‚</p>
<p>åœ¨æ–‡ä¸­ä½œè€…è¿˜ä½¿ç”¨äº†ä¸€ç§<strong>Missing Data Injection</strong>æŠ€æœ¯ï¼Œå³åœ¨æ¯ä¸ªEpochéšæœºçš„æŒ‰ç…§ä¸€ä¸ªé¢„è®¾æ¯”ä¾‹<span class="math inline">\(\lambda\)</span>å°†æ­£å¸¸çš„æ•°æ®è®¾ä¸ºç¼ºå¤±ã€‚ä½œè€…è®¤ä¸ºè¿™æ ·æœ‰åŠ©äºæ€§èƒ½çš„æå‡ã€‚</p>
<h3 id="detection">Detection</h3>
<p>åœ¨æ£€æµ‹é˜¶æ®µï¼Œå¯¹äºä¸€ä¸ªè¾“å…¥æ ·æœ¬ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡å‹è¾“å‡ºå…¶å¼‚å¸¸çš„æ¦‚ç‡ã€‚å› ä¸ºæˆ‘ä»¬å»ºæ¨¡äº†<span class="math inline">\(p_\theta(x|z)\)</span>ï¼Œä¸€ç§æ–¹æ³•æ˜¯é‡‡æ ·è®¡ç®—<span class="math inline">\(p_\theta(x)=\mathbb{E}_{p_\theta(z)}[p_\theta(x|z)]\)</span>ï¼Œä½†è¿™ç§æ–¹æ³•è®¡ç®—ä»£ä»·ååˆ†æ˜‚è´µã€‚å…¶ä»–çš„ä¸€äº›æ–¹æ¡ˆæœ‰è®¡ç®—<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[p_\theta(x|z)]\)</span>æˆ–<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>ï¼Œå…¶ä¸­åè€…è¢«ç§°ä¸º&quot;<strong>Reconstruction Probability</strong>&quot;ï¼Œä½œè€…ä¾¿é‡‡ç”¨äº†è¿™ç§æ–¹æ¡ˆã€‚</p>
<p>åŒæ—¶ï¼Œä½œè€…è®¤ä¸ºè¾“å…¥çš„æ£€æµ‹æ ·æœ¬çš„ç¼ºå¤±å€¼ä¼šå¯¹ç»“æœé€ æˆè¾ƒå¤§åå·®ï¼Œäºæ˜¯ä½¿ç”¨äº†ä¸€ç§<strong>MCMC-based Missing Data Imputation</strong>çš„æ–¹æ³•æ¥å¯¹æ£€æµ‹æ ·æœ¬çš„ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ã€‚å…·ä½“åšæ³•æ˜¯å°†æµ‹è¯•æ ·æœ¬åˆ†ä¸ºå·²è§‚æµ‹å’Œç¼ºå¤±ä¸¤éƒ¨åˆ†<span class="math inline">\(x=(x_o,x_m)\)</span>ï¼Œç„¶åä½¿ç”¨è®­ç»ƒå¥½çš„VAEè¿›è¡Œé‡æ„å¾—åˆ°<span class="math inline">\((x^\prime_o,x^\prime_m)\)</span>ï¼Œç„¶åç”¨<span class="math inline">\(x^\prime_m\)</span>æ›¿æ¢<span class="math inline">\(x_m\)</span>ï¼Œè¿™æ ·ä¸æ–­å¾ªç¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571719553095.png" /></p>
<p>ä½œè€…ä½¿ç”¨äº†<span class="math inline">\(L\)</span>ä¸ªæ ·æœ¬æ¥è®¡ç®—<strong>Reconstruction Probability</strong>ï¼Œè™½ç„¶å¾—åˆ°çš„è¾“å‡ºæ˜¯é’ˆå¯¹æ•´ä¸ªçª—å£æ¯ä¸ªç‚¹çš„ï¼Œä½†ä½œè€…åªä½¿ç”¨æœ€åä¸€ä¸ªç‚¹ã€‚</p>
<h2 id="experiments">Experiments</h2>
<h3 id="datasets">Datasets</h3>
<p>ä½œè€…é€‰æ‹©äº†ä¸‰æ¡KPIä½œä¸ºæµ‹è¯•æ•°æ®ï¼Œåˆ†åˆ«è®°ä¸º<span class="math inline">\(\mathcal{A}\)</span>ï¼Œ<span class="math inline">\(\mathcal{B}\)</span>ï¼Œ<span class="math inline">\(\mathcal{C}\)</span>ï¼Œå…¶åŸºæœ¬æ•°æ®å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571719583781.png" /></p>
<h3 id="metrics">Metrics</h3>
<p>å› ä¸ºå¼‚å¸¸æ£€æµ‹ç±»åˆ«çš„æä¸å‡è¡¡æ€§ï¼Œä¼ ç»Ÿçš„æ€§èƒ½æŒ‡æ ‡å¹¶ä¸å¤ªåˆé€‚ï¼ˆå¼‚å¸¸æ ·æœ¬æå°‘ï¼Œä¸”å¼‚å¸¸ä¸€èˆ¬å‘ˆè¿ç»­çš„ç‰‡æ®µï¼‰ã€‚ä½œè€…è®¤ä¸ºåœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­è¿ç»´äººå‘˜éœ€è¦å°½é‡æ—©çš„è·çŸ¥å¼‚å¸¸çš„å‘ç”Ÿï¼Œäºæ˜¯æå‡ºäº†æ–°çš„è¯„æµ‹æœºåˆ¶ã€‚</p>
<p><img src="http://qfxiao.me/img/1571719605541.png" /></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¬¬ä¸€è¡Œä¸ºçœŸå®çš„æ ‡ç­¾ï¼Œç¬¬äºŒè¡Œä¸ºé¢„æµ‹çš„å¼‚å¸¸æ¦‚ç‡ï¼Œç¬¬ä¸‰è¡Œä¸ºé¢„æµ‹çš„æ ‡ç­¾ã€‚ç¬¬ä¸€è¡Œä¸­å¼‚å¸¸ç‰‡æ®µè¢«åŠ ç²—è¡¨ç¤ºï¼Œå¯¹äºæ¯ä¸€ä¸ªå¼‚å¸¸ç‰‡æ®µçš„ç¬¬ä¸€ä¸ªä½ç½®<span class="math inline">\({y}_{t^\prime}\)</span>ï¼Œå¦‚æœé¢„æµ‹çš„æ ‡ç­¾ä¸­å­˜åœ¨<span class="math inline">\(\hat{y}_{t}\)</span>æ»¡è¶³<span class="math inline">\(t^\prime&lt;t\)</span>ä¸”<span class="math inline">\(|t-t^\prime|\)</span>å°äºç­‰äºé¢„è®¾çš„é˜ˆå€¼<span class="math inline">\(T\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(y_{t^\prime}\)</span>å¯¹åº”çš„æ•´æ®µå¼‚å¸¸éƒ½è¢«è®¤ä¸ºæ­£ç¡®æ£€æµ‹ï¼Œå¦åˆ™æ•´æ®µå¼‚å¸¸éƒ½è®¤ä¸ºæ²¡æœ‰è¢«æ­£ç¡®æ£€æµ‹ã€‚ç„¶ååœ¨æ­¤åŸºç¡€ä¸Šè®¡ç®—F1-scoreï¼ŒAUCç­‰æŒ‡æ ‡ä½œä¸ºè¯„æµ‹æ‰‹æ®µã€‚</p>
<h2 id="results">Results</h2>
<h3 id="overall-performance">Overall Performance</h3>
<p>ä¸‹å›¾å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š</p>
<p><img src="http://qfxiao.me/img/1571719653801.png" /></p>
<h3 id="effects-of-donut-techniques">Effects of Donut Techniques</h3>
<p>ä¸ºäº†æ¢ç©¶Donutä¸­æ‰€åšçš„å„ç§æ”¹è¿›çš„å®é™…ä½œç”¨ï¼Œä½œè€…åšäº†å¤§é‡å¯¹æ¯”å®éªŒï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571719667067.png" /></p>
<ul>
<li><strong>M-ELBO</strong> ä»å›¾ä¸­å¯ä»¥çœ‹å‡º<strong>M-ELBO</strong>å¯¹æ€§èƒ½æå‡æœ€å¤§ã€‚ä½œè€…åœ¨æ–‡ä¸­æåˆ°ä¸€å¼€å§‹å¹¶æ²¡æœŸæœ›<strong>M-ELBO</strong>èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ï¼Œåªæ˜¯å¸Œæœ›å®ƒèƒ½å¤ŸWorkã€‚è¿™è¡¨æ˜åœ¨VAEçš„è®­ç»ƒä¸­ï¼Œåªä½¿ç”¨æ­£å¸¸æ ·æœ¬æ˜¯ä¸å¤Ÿçš„ï¼Œä¹Ÿéœ€è¦åŠ å…¥éæ­£å¸¸çš„ä¿¡æ¯ï¼›</li>
<li><strong>Missing Data Injection</strong> è¯¥æŠ€å·§çš„ä¸»è¦ä½œç”¨æ˜¯å¢å¼º<strong>M-ELBO</strong>çš„æ•ˆæœã€‚ä»ç»“æœä¸Šæ¥çœ‹ä½œç”¨å¹¶ä¸æ˜¯ååˆ†çš„æ˜¾è‘—ï¼Œåªæ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹è·å¾—äº†å°‘é‡çš„æå‡ï¼›</li>
<li><strong>MCMC Imputation</strong> ä½œè€…è®¤ä¸ºè™½ç„¶è¯¥æŠ€å·§åªåœ¨ä¸€éƒ¨åˆ†æƒ…å†µä¸‹æ˜¾è‘—æå‡äº†æ€§èƒ½ï¼Œä½†æ€»ä½“æ¥è¯´å€¼å¾—ä½¿ç”¨ã€‚</li>
</ul>
<h3 id="impact-of-k">Impact of K</h3>
<p>è¯¥éƒ¨åˆ†ä½œè€…æ¢ç©¶äº†éšå˜é‡<span class="math inline">\(z\)</span>çš„ç»´åº¦<span class="math inline">\(K\)</span>å¯¹æ€§èƒ½çš„å½±å“ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://qfxiao.me/img/1571719682591.png" /></p>
<p>ä»å›¾ä¸Šæ¥çœ‹ï¼Œå¯¹æ•°æ®é›†<span class="math inline">\(\mathcal{A}\)</span>ï¼Œ<span class="math inline">\(\mathcal{B}\)</span>ï¼Œ<span class="math inline">\(\mathcal{C}\)</span>æœ€ä½³çš„<span class="math inline">\(K\)</span>åˆ†åˆ«æ˜¯<span class="math inline">\(5\)</span>ï¼Œ<span class="math inline">\(4\)</span>å’Œ<span class="math inline">\(3\)</span>ï¼Œä½†æ˜¯è®¾å®šè¾ƒå¤§çš„<span class="math inline">\(K\)</span>å¹¶ä¸ä¼šå¯¹æ€§èƒ½æœ‰ä¸¥é‡çš„æŸå®³ã€‚ä½œè€…è¿˜å‘ç°å¯¹äºè¾ƒä¸ºå¹³æ»‘çš„KPIéœ€è¦è¾ƒå¤§çš„<span class="math inline">\(K\)</span>ã€‚</p>
<h2 id="analysis">Analysis</h2>
<h3 id="kde-interpretation">KDE Interpretation</h3>
<p>åœ¨è¿™ä¸€èŠ‚ä½œè€…å¯¹<strong>Reconstruction Probability</strong>çš„æ„ä¹‰è¿›è¡Œäº†æ·±å…¥çš„æ¢è®¨ã€‚é¦–å…ˆä½œè€…å¯¹<span class="math inline">\(q_\phi(z|x)\)</span>è¿›è¡Œäº†å¯è§†åŒ–ï¼Œåœ¨å›¾ä¸­ä½œè€…å°†æ—¶é—´ç»´åº¦ç”¨é¢œè‰²æ¥è¡¨ç¤ºã€‚å¦‚Figure 11(a) æ‰€ç¤ºï¼Œ<span class="math inline">\(z\)</span>å‡ ä¹æ˜¯æŒ‰ç…§<span class="math inline">\(x\)</span>å¯¹åº”çš„æ—¶é—´å‘ˆä¸€ä¸ªè¿ç»­çš„æµå½¢åˆ†å¸ƒï¼Œä½œè€…å°†è¿™ç§ç°è±¡ç§°ä¸º<strong>Time Gradient</strong>ã€‚å³ä½¿Donutæ²¡æœ‰æ˜¾å¼çš„ç”¨åˆ°æ—¶é—´ä¿¡æ¯ï¼Œä¸è¿‡å› ä¸ºå®éªŒç”¨åˆ°çš„æ•°æ®åŸºæœ¬æ˜¯å¹³æ»‘çš„ï¼Œæ‰€ä»¥è¯´ç›¸é‚»çš„<span class="math inline">\(x\)</span>ä¼šæ¯”è¾ƒç›¸ä¼¼ï¼Œå› æ­¤ç»è¿‡æ˜ å°„åçš„<span class="math inline">\(z\)</span>ä¹Ÿä¼šæ¯”è¾ƒç›¸ä¼¼ã€‚ä½œè€…æ®æ­¤æå‡ºDonutçš„ä¸€ä¸ªä¼˜åŠ¿ä¾¿æ˜¯å¯¹äºæ²¡æœ‰è§è¿‡çš„åéªŒåˆ†å¸ƒ<span class="math inline">\(q_\phi(z|x)\)</span>ï¼Œåªè¦å…¶ä½äºè®­ç»ƒè¿‡çš„ä¸¤ä¸ªåéªŒä¹‹é—´ï¼Œä¹Ÿä¼šäº§ç”Ÿåˆç†çš„åˆ†å¸ƒã€‚</p>
<p><img src="http://qfxiao.me/img/1571719693393.png" /></p>
<p>å¯¹äºå¼‚å¸¸çš„æ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œå‡è®¾å…¶å¯¹åº”çš„æ­£å¸¸æ¨¡å¼ä¸º<span class="math inline">\(\tilde{x}\)</span>ï¼Œä½œè€…è®¤ä¸º<span class="math inline">\(q_\phi(z|x)\)</span>ä¼šåœ¨æŸç§ç¨‹åº¦ä¸Šå¯¹æ­£å¸¸çš„<span class="math inline">\(q_\phi(z|\tilde{x})\)</span>è¿›è¡Œè¿‘ä¼¼ã€‚å› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è¿›è¡Œè®­ç»ƒçš„ï¼Œéšå˜é‡<span class="math inline">\(z\)</span>çš„ç»´åº¦é€šå¸¸æ¥è¯´å°äºæ ·æœ¬<span class="math inline">\(x\)</span>ï¼Œè¿™å°±å¯¼è‡´<span class="math inline">\(z\)</span>åªä¼šä¿ç•™ä¸€éƒ¨åˆ†ä¸»è¦çš„ä¿¡æ¯ã€‚å¯¹äºå¼‚å¸¸æ ·æœ¬ï¼Œå…¶å¼‚å¸¸æ¨¡å¼åœ¨ç¼–ç æ—¶å°±è¢«ä¸¢æ‰äº†ã€‚ä½œè€…è¿˜æŒ‡å‡ºå¦‚æœ<span class="math inline">\(x\)</span>åŒ…å«çš„å¼‚å¸¸å¤ªå¤šï¼Œé‚£ä¹ˆæ¨¡å‹å°†éš¾ä»¥å¯¹<span class="math inline">\(x\)</span>è¿›è¡Œè¿˜åŸã€‚</p>
<p><img src="http://qfxiao.me/img/1571719738542.png" /></p>
<p>åŸºäºä¸Šè¿°è®¨è®ºï¼Œä½œè€…å¯¹ä½¿ç”¨<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>ä½œä¸º<strong>Reconstruction Probability</strong>çš„æ„ä¹‰è¿›è¡Œäº†é˜é‡Šã€‚è®¾è¾“å…¥æ ·æœ¬ä¸º<span class="math inline">\(x\)</span>ï¼Œå¦‚æœå…¶åŒ…å«å¼‚å¸¸ï¼Œå‡è®¾å…¶å¯¹åº”çš„æ­£å¸¸æ ·æœ¬ä¸º<span class="math inline">\(\tilde{x}\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(q_\phi(z|x)\)</span>éƒ¨åˆ†åœ°å’Œ<span class="math inline">\(q_\phi(z|\tilde{x})\)</span>ç›¸ä¼¼ã€‚å¦‚æœ<span class="math inline">\(x\)</span>å’Œ<span class="math inline">\(\tilde{x}\)</span>ç›¸ä¼¼ç¨‹åº¦é«˜ï¼Œé‚£ä¹ˆ<span class="math inline">\(\log p_\theta(x|z)\)</span>å°±ä¼šå¾ˆå¤§ï¼ˆå…¶ä¸­<span class="math inline">\(z\sim q_\phi(z|\tilde{x})\)</span>ï¼‰ã€‚<span class="math inline">\(\log p_\theta(x|z)\)</span>ç±»ä¼¼äºä¸€ä¸ªå¯†åº¦ä¼°è®¡å™¨ï¼Œä»£è¡¨<span class="math inline">\(x\)</span>åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸<span class="math inline">\(\tilde{x}\)</span>æ¥è¿‘ï¼Œ<span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>ç›¸å½“äºå¯¹æ¯ä¸€ä¸ª<span class="math inline">\(z\)</span>å¯¹åº”çš„<span class="math inline">\(\log p_\theta(x|z)\)</span>ä¹˜ä»¥ä¸€ä¸ªæƒé‡<span class="math inline">\(q_\phi(z|x)\)</span>ç„¶åç›¸åŠ ã€‚äºæ˜¯ä½œè€…æå‡ºäº†<strong>Reconstruction Probability</strong>çš„<strong>KDE Interpretation</strong>:åœ¨Donutæ¨¡å‹ä¸­ï¼Œ<strong>Reconstruction Probability</strong> <span class="math inline">\(\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)]\)</span>å¯ä»¥çœ‹ä½œæ˜¯ä»¥<span class="math inline">\(q_\phi(z|x)\)</span>ä¸ºæƒé‡ï¼Œ<span class="math inline">\(\log p_\theta(x|z)\)</span>ä¸ºæ ¸çš„æ ¸å¯†åº¦ä¼°è®¡ (Kernel Density Estimation)ã€‚</p>
<p>ä¸‰ç»´å¯è§†åŒ–å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571736459981.png" /></p>
<p>ä½œè€…è¿˜å¯¹ç›´æ¥è®¡ç®—<span class="math inline">\(p_\theta(x)=\mathbb{E}_{p_\theta(z)}[p_\theta(x|z)]\)</span>è¿›è¡Œäº†è´¨ç–‘ï¼Œå› ä¸ºè¿™ç§æ–¹æ³•ç›´æ¥æ±‚<span class="math inline">\(x\)</span>çš„å…ˆéªŒï¼Œä»…ä»…è€ƒè™‘äº†<span class="math inline">\(x\)</span>çš„æ€»ä½“æ¨¡å¼ï¼Œè€Œå¿½ç•¥äº†<span class="math inline">\(x\)</span>çš„ä¸ªä½“æ¨¡å¼ã€‚</p>
<h3 id="find-good-posteriors-for-abnormal-x">Find Good Posteriors for Abnormal <span class="math inline">\(x\)</span></h3>
<p>é€šè¿‡ä¸Šé¢çš„è®¨è®ºæˆ‘ä»¬çŸ¥é“äº†Donuté€šè¿‡æ‰¾åˆ°<span class="math inline">\(x\)</span>çš„æ­£å¸¸åéªŒæ¥ä¼°è®¡<span class="math inline">\(x\)</span>åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸<span class="math inline">\(\tilde{x}\)</span>ç›¸ä¼¼ï¼Œåœ¨è¿™ä¸€èŠ‚ä½œè€…è®¨è®ºäº†æ–‡ä¸­ä½¿ç”¨çš„ä¸åŒæŠ€å·§å¯¹æ‰¾åˆ°<span class="math inline">\(x\)</span>çš„åéªŒçš„ä½œç”¨ã€‚å¯¹äº<strong>Missing Data Injection</strong>ä½œè€…è®¤ä¸ºè¯¥æŠ€å·§å¢å¼ºäº†<strong>M-ELBO</strong>çš„æ•ˆæœã€‚å¯¹äº<strong>MCMC Imputation</strong>ï¼Œä½œè€…è®¤ä¸ºè¯¥æŠ€å·§ä¸»è¦æ˜¯åœ¨æ£€æµ‹é˜¶æ®µé€šè¿‡ä¸æ–­è¿­ä»£æä¾›äº†æ›´å¥½çš„åéªŒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571736476085.png" /></p>
<p>ä½œè€…è®¤ä¸ºï¼Œè™½ç„¶å¯¹äºåŒ…å«å¤§é‡å¼‚å¸¸çš„æ ·æœ¬ï¼ŒDonutä¸èƒ½å¾ˆå¥½çš„è¿˜åŸï¼Œä½†åœ¨è¿ç»´åœºæ™¯ä¸­ï¼Œåªè¦å¯¹å¤§æ®µå¼‚å¸¸çš„å¼€å§‹é˜¶æ®µè¿›è¡Œå‡†ç¡®é¢„æµ‹å³å¯ã€‚</p>
<h3 id="causes-of-time-gradient">Causes of Time Gradient</h3>
<p>åœ¨è¿™ä¸€èŠ‚ä½œè€…è®¨è®ºäº†<strong>Time Gradient</strong>å‡ºç°çš„åŸå› ã€‚é¦–å…ˆå‡è®¾<span class="math inline">\(x\)</span>éƒ½æ˜¯æ­£å¸¸ç‚¹ï¼Œè¿™æ—¶<span class="math inline">\(x\)</span>çš„ELBOä¸ºï¼š <span class="math display">\[
\begin{align}
\mathcal{L}(x)&amp;=\mathbb{E}_{q_\phi(z|x)}[\log p_\theta(x|z)+\log p_\theta(z)-\log q_\phi(z|x)]\\
&amp;=\mathbb{E}[\log p_\theta(x|z)]+\mathbb{E}[\log p_\theta(z)]+\text{H}[z|x]
\end{align}
\]</span> ç¬¬ä¸€é¡¹è¡¨æ˜åœ¨<span class="math inline">\(z\sim q_\phi(z|x)\)</span>ä¸‹å°½å¯èƒ½é‡æ„<span class="math inline">\(x\)</span>ã€‚ç¬¬äºŒé¡¹è¡¨æ˜<span class="math inline">\(q_\phi(z|x)\)</span>å°½é‡ä¸<span class="math inline">\(z\)</span>çš„å…ˆéªŒ<span class="math inline">\(\mathcal{N}(0,I)\)</span>æ¥è¿‘ã€‚ç¬¬ä¸‰é¡¹ä¸º<span class="math inline">\(q_\phi(z|x)\)</span>çš„ç†µï¼Œè¡¨æ˜<span class="math inline">\(q_\phi(z|x)\)</span>åº”å°½é‡åˆ†æ•£ã€‚ç„¶è€Œç¬¬äºŒé¡¹åˆé™åˆ¶äº†è¿™ç§åˆ†æ•£çš„åŒºåŸŸï¼Œå¦‚ Figure 11(c) æ‰€ç¤ºã€‚åŒæ—¶è€ƒè™‘è¿™ä¸‰é¡¹çš„è¯ï¼Œç¬¬ä¸€é¡¹ä½¿å¾—<span class="math inline">\(z\)</span>ä¸èƒ½è‡ªç”±åœ°åˆ†æ•£ï¼Œå¯¹äºä¸ç›¸ä¼¼çš„<span class="math inline">\(x\)</span>å…¶å¯¹åº”çš„<span class="math inline">\(z\)</span>ä¹Ÿæ˜¯ä¸ç›¸ä¼¼çš„ï¼Œå› ä¸ºè¦æœ€å¤§åŒ–<span class="math inline">\(x\)</span>çš„é‡æ„æ¦‚ç‡ã€‚ç„¶è€Œå¯¹äºç›¸ä¼¼çš„<span class="math inline">\(x\)</span>æ¥è¯´ï¼Œå…¶å¯¹åº”çš„<span class="math inline">\(q_\phi(z|x)\)</span>ä¼šå‡ºç°å¾ˆå¤šé‡å¤çš„éƒ¨åˆ†ã€‚å½“è¾¾åˆ°å¹³è¡¡æ—¶ï¼Œ<strong>Time Gradient</strong>å°±å‡ºç°äº†ã€‚</p>
<p><img src="http://qfxiao.me/img/1571719784233.png" /></p>
<p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå½“<span class="math inline">\(x\)</span>è¶Šä¸ç›¸ä¼¼ï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>å°±ä¼šç›¸è·è¶Šè¿œï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ç„¶è€Œåœ¨ä¸€å¼€å§‹ï¼Œå‚æ•°ç»è¿‡éšæœºåˆå§‹åŒ–ï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>éƒ½æ˜¯éšæœºæ•£ä¹±çš„ï¼Œå¦‚ Figure 11(b) æ‰€ç¤ºã€‚éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>å°†ä¼šä¸æ–­ä¼˜åŒ–ã€‚ç”±äºKPIæ•°æ®å¾€å¾€æ˜¯å…‰æ»‘çš„ï¼Œé‚£ä¹ˆåœ¨æ—¶é—´ä¸Šç›¸è·è¶Šè¿œçš„æ ·æœ¬å°±ä¼šè¶Šä¸ç›¸ä¼¼ï¼Œå¯¹åº”çš„<span class="math inline">\(q_\phi(z|x)\)</span>ä¹Ÿä¼šç›¸è·æ›´è¿œã€‚è¿™ä¹Ÿè¯´æ˜äº†ï¼Œè®­ç»ƒç»“æŸåï¼Œæ—¶é—´ä¸Šç›¸è·è¶Šè¿œçš„ï¼Œ<span class="math inline">\(q_\phi(z|x)\)</span>ä¹Ÿä¼šç›¸è·è¶Šè¿œï¼Œåä¹‹äº¦ç„¶ã€‚åŒæ—¶è¿™ä¹Ÿè¡¨æ˜å­¦ä¹ ç‡çš„è®¾ç½®å¯¹æœ¬æ¨¡å‹çš„ç¨³å®šæ€§æœ‰è‡³å…³é‡è¦çš„ä½œç”¨ã€‚</p>
<h3 id="sub-optimal-equilibrium">Sub-Optimal Equilibrium</h3>
<p>ä¸Šé¢æˆ‘ä»¬è®¨è®ºäº†éšç€è®­ç»ƒè¿›è¡Œ<span class="math inline">\(q_\phi(z|x)\)</span>çš„æ¼”å˜ï¼Œä½œè€…æå‡ºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°æ¨¡å‹æ”¶æ•›åˆ°æ¬¡ä¼˜çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571719796266.png" /></p>
<p>ç¬¬ä¸€è¡Œå±•ç¤ºçš„æ˜¯æ”¶æ•›åˆ°æœ€ä¼˜çš„æƒ…å†µï¼Œç¬¬äºŒè¡Œå±•ç¤ºçš„æ˜¯æ”¶æ•›åˆ°æ¬¡ä¼˜çš„æƒ…å†µã€‚ä»ç¬¬äºŒè¡Œçš„ç¬¬ä¸€ä¸ªå›¾ï¼ˆStep 100ï¼‰æ¥çœ‹ï¼Œç´«è‰²çš„ç‚¹å¼€å§‹ç©¿è¿‡ç»¿è‰²çš„ç‚¹ï¼Œéšç€è®­ç»ƒçš„è¿›è¡Œï¼Œç´«è‰²çš„ç‚¹å¼€å§‹å°†ç»¿è‰²çš„ç‚¹æ¨å¼€ã€‚åˆ°Step 5000çš„æ—¶å€™ï¼Œç»¿è‰²çš„ç‚¹å·²ç»è¢«åˆ†æˆäº†ä¸¤åŠã€‚ä¸‹å›¾å±•ç¤ºäº†å¯¹åº”çš„è®­ç»ƒè¯¯å·®å’ŒéªŒè¯è¯¯å·®ï¼š</p>
<p><img src="http://qfxiao.me/img/1571719807778.png" /></p>
<p>è¿™æ ·çš„ç°è±¡ä¼šå¯¼è‡´åœ¨ä¸¤åŠç»¿è‰²åŒºåŸŸä¹‹é—´çš„æµ‹è¯•æ ·æœ¬ä¼šè¢«è¯†åˆ«ä¸ºç´«è‰²ï¼Œä»è€Œé™ä½æ€§èƒ½ã€‚ä½œè€…æå‡ºåœ¨<span class="math inline">\(K\)</span>è¾ƒå¤§çš„æ—¶å€™è¿™ç§ç°è±¡ä¸å®¹æ˜“å‘ç”Ÿï¼Œä½†è¿™æ—¶è®­ç»ƒçš„æ”¶æ•›åˆä¼šæˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/09/22/Time-Series-Anomaly-Detection-Service-at-Microsoft/"><img class="thumbnail" src="http://qfxiao.me/img/1565427857981.png" alt="Time-Series Anomaly Detection Service at Microsoft"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-09-22T12:33:18.000Z" title="2019-09-22T12:33:18.000Z">2019-09-22</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">11 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1677 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/09/22/Time-Series-Anomaly-Detection-Service-at-Microsoft/">Time-Series Anomaly Detection Service at Microsoft</a></h1><div class="content"><h2 id="abstract">Abstract</h2>
<p>æœ¬æ–‡å€Ÿé‰´è®¡ç®—æœºè§†è§‰ä¸­çš„æ˜¾è‘—æ€§æ£€æµ‹ï¼Œæå‡ºäº†ä¸€ç§åŸºäºSpectral Residualçš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚</p>
<p><a href="https://www.kdd.org/kdd2019/accepted-papers/view/time-series-anomaly-detection-service-at-microsoft">åŸæ–‡</a></p>
<p>è¿™ç¯‡æ–‡ç« è¿˜æå‡ºäº†å‡ ä¸ªæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹è½åœ°çš„éš¾ç‚¹ï¼š</p>
<ol type="1">
<li><strong>Lack of Labels.</strong> åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¼šäº§ç”Ÿå¤§é‡çš„KPIï¼Œè€Œå¾ˆéš¾å¯¹æ¯ä¸ªKPIè¿›è¡Œäººå·¥æ ‡æ³¨ã€‚</li>
<li><strong>Generalization.</strong> ä¸åŒKPIæ‰€è¡¨ç°å‡ºæ¥çš„æ¨¡å¼ä¹Ÿä¸å°½ç›¸åŒï¼Œå¦‚Figure 1æ‰€ç¤ºã€‚ç°æœ‰æ–¹æ³•å¾ˆéš¾åœ¨æ‰€æœ‰æ¨¡å¼çš„KPIä¸Šéƒ½è¡¨ç°è‰¯å¥½ã€‚</li>
<li><strong>Efficiency.</strong> åœ¨å®é™…åœºæ™¯ä¸­ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„æ—¶é—´åºåˆ—æ•°æ®ï¼ŒåŒæ—¶å¯¹å¼‚å¸¸æ£€æµ‹ç®—æ³•çš„æ—¶é—´æ•ˆç‡æœ‰è¦æ±‚ã€‚</li>
</ol>
<p><img src="http://qfxiao.me/img/1565414991291.png" /></p>
<h2 id="contribution">Contribution</h2>
<ul>
<li>å°†Visual Saliency Detectionçš„æ–¹æ³•å¼•å…¥äº†æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ã€‚</li>
<li>ç»“åˆSpectral Residualå’ŒCNNæé«˜äº†å¼‚å¸¸æ£€æµ‹çš„æ•ˆæœã€‚</li>
<li>ç®—æ³•å…·æœ‰è‰¯å¥½çš„æ—¶é—´æ•ˆç‡å’Œé€šç”¨æ€§ã€‚</li>
</ul>
<h2 id="background">Background</h2>
<h3 id="spectral-residual">Spectral Residual</h3>
<p>SR(Spectral Residual)ç®—æ³•ä¸»è¦åŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<ol type="1">
<li>é€šè¿‡å‚…é‡Œå¶å˜æ¢å¾—åˆ°log amplitude spectrumï¼›</li>
<li>è®¡ç®—spectral residualï¼›</li>
<li>é€šè¿‡å‚…é‡Œå¶é€†å˜æ¢å›åˆ°æ—¶é—´åŸŸã€‚</li>
</ol>
<p>æ›´å½¢å¼åŒ–çš„è¡¨è¿°ä¸ºå¦‚ä¸‹ï¼š</p>
<p>ç»™å®šä¸€ä¸ªåºåˆ—<span class="math inline">\(\mathbb{x}\)</span>ï¼Œåˆ™æœ‰ï¼š</p>
<p><span class="math display">\[A(f)=Amplitude(\mathscr{F}(\mathbb{x}))\]</span></p>
<p><span class="math display">\[P(f)=Phrase(\mathscr{F}(\mathbb{x}))\]</span></p>
<p><span class="math display">\[L(f)=\log(A(f))\]</span></p>
<p><span class="math display">\[AL(F)=h_1(f)\cdot L(f)\]</span></p>
<p><span class="math display">\[R(f)=L(f)-AL(f)\]</span></p>
<p><span class="math display">\[S(\mathbb{x})=\parallel\mathscr{F}^{-1}(\exp(R(f)+iP(f)))\parallel\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\mathscr{F}\)</span>å’Œ<span class="math inline">\(\mathscr{F}^{-1}\)</span>åˆ†åˆ«è¡¨ç¤ºå‚…é‡Œå¶å˜æ¢å’Œå‚…é‡Œå¶é€†å˜æ¢ï¼›<span class="math inline">\(\mathbb{x}\in \mathbb{R}^{n\times 1}\)</span>è¡¨ç¤ºè¾“å…¥åºåˆ—ï¼›<span class="math inline">\(A(f)\)</span>ä¸ºå¹…åº¦è°±ï¼Œ<span class="math inline">\(P(f)\)</span>ä¸ºç›¸ä½è°±ï¼Œ<span class="math inline">\(L(f)\)</span>ä¸ºå¯¹æ•°å¹…åº¦è°±ï¼Œ<span class="math inline">\(AL(F)\)</span>ä¸ºå‡å€¼æ»¤æ³¢åçš„å¯¹æ•°å¹…åº¦è°±ï¼›<span class="math inline">\(R(f)\)</span>ä¸ºspectral residualï¼›<span class="math inline">\(S(\mathbb{x})\)</span>ç§°ä¸ºsaliency mapã€‚Figure 4ä¸ºæ–‡ä¸­ç»™å‡ºçš„Saliency Mapç¤ºæ„å›¾ã€‚</p>
<p><img src="http://qfxiao.me/img/1565425536516.png" /></p>
<h2 id="methodology">Methodology</h2>
<h3 id="problem-definition">Problem Definition</h3>
<blockquote>
<p>ç»™å®šä¸€ç³»åˆ—å®æ•°å€¼<span class="math inline">\(\mathbb{x}=x_1,x_2,\cdots,x_n\)</span>ï¼Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„ä»»åŠ¡æ˜¯äº§ç”Ÿä¸€ä¸ªè¾“å‡ºåºåˆ—<span class="math inline">\(\mathbb{y}=y_1,y_2,\cdots,y_n\)</span>å…¶ä¸­<span class="math inline">\(y_i\in\{0,1\}\)</span>è¡¨ç¤º<span class="math inline">\(x_i\)</span>æ˜¯å¦ä¸ºå¼‚å¸¸ç‚¹ã€‚</p>
</blockquote>
<h3 id="sr">SR</h3>
<p>å¯¹äºç»™å®šåºåˆ—<span class="math inline">\(\mathbb{x}\)</span>ï¼Œè®¡ç®—Saliency Map <span class="math inline">\(S(\mathbb{x})\)</span>ï¼Œè¾“å‡ºåºåˆ—<span class="math inline">\(O(\mathbb{x})\)</span>å®šä¹‰ä¸ºï¼š</p>
<p><span class="math display">\[O(x_i)=\begin{cases}1,\quad \text{if}\frac{S(x_i)-\overline{S(x_i)}}{\overline{S(x_i)}}&gt;\tau\\\\0,\quad \text{otherwise}\end{cases}\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(S(x_i)\)</span>ä¸º<span class="math inline">\(x_i\)</span>å¯¹åº”çš„Saliency Mapçš„å€¼ï¼Œ<span class="math inline">\(\overline{S(x_i)}\)</span>ä¸º<span class="math inline">\(x_i\)</span>é™„è¿‘Saliency Mapå±€éƒ¨å‡å€¼ã€‚</p>
<hr />
<p>åœ¨å®é™…æ“ä½œä¸­ï¼ŒFFTæ˜¯åœ¨ä¸€ä¸ªæ»‘åŠ¨çª—å£ä¸­è¿›è¡Œçš„ï¼Œæ–‡ä¸­æåˆ°SRæ–¹æ³•åœ¨ç‚¹ä½äºçª—å£ä¸­å¤®æ—¶æ•ˆæœæ›´å¥½ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œæµ‹è¯•çš„æ—¶å€™ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ–¹æ³•å¯¹å½“å‰ç‚¹<span class="math inline">\(x_n\)</span>(ä¹Ÿå°±æ˜¯å½“å‰åºåˆ—æœ€åä¸€ä¸ªç‚¹)ä¹‹åçš„ç‚¹è¿›è¡Œé¢„æµ‹ï¼š</p>
<p><span class="math display">\[\overline{g}=\frac{1}{m}\sum_{i=1}^m g(x_n,x_{n-i})\]</span></p>
<p><span class="math display">\[x_{n+1}=x_{n-m+1}+\overline{g}\cdot m\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(g(x_i,x_j)\)</span>ä»£è¡¨<span class="math inline">\(x_i\)</span>å’Œ<span class="math inline">\(x_j\)</span>ä¸¤ç‚¹æ„æˆçš„ç›´çº¿çš„æ¢¯åº¦ï¼›<span class="math inline">\(\overline{g}\)</span>ä»£è¡¨æ‰€å¤„ç†çš„ç‚¹çš„å¹³å‡æ¢¯åº¦ï¼›<span class="math inline">\(m\)</span>ä¸ºæ‰€å¤„ç†çš„ç‚¹çš„æ•°é‡ã€‚åœ¨æœ¬æ–‡ä¸­è®¾ç½®<span class="math inline">\(m=5\)</span>ã€‚æ–‡ä¸­å‘ç°ç¬¬ä¸€ä¸ªé¢„æµ‹çš„å€¼å¾ˆé‡è¦ï¼Œæ‰€ä»¥ç›´æ¥æŠŠ<span class="math inline">\(x_{n+1}\)</span>èµ‹å€¼<span class="math inline">\(k\)</span>æ¬¡æ·»åŠ åˆ°åºåˆ—çš„æœ«å°¾ã€‚</p>
<h3 id="sr-cnn">SR-CNN</h3>
<p><img src="http://qfxiao.me/img/1565427857981.png" /></p>
<p>æœ¬æ–‡æåˆ°ï¼Œä»…ä»…ä½¿ç”¨ä¸€ä¸ªé˜ˆå€¼æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­å¤ªè¿‡ç®€å•ï¼Œäºæ˜¯æå‡ºä½¿ç”¨ä¸€ä¸ªåˆ¤åˆ«æ¨¡å‹æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­ã€‚ç”±äºè®­ç»ƒæ•°æ®æ²¡æœ‰æ ‡ç­¾ï¼Œæ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å…¬å¼äººå·¥åŠ å…¥å¼‚å¸¸ï¼š</p>
<p><span class="math display">\[x=(\overline{x}+mean)(1+var)\cdot r+x\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\overline{x}\)</span>æ‰€å¤„ç†çš„ç‚¹çš„å±€éƒ¨å‡å€¼ï¼›<span class="math inline">\(mean\)</span>å’Œ<span class="math inline">\(var\)</span>ä¸ºå½“å‰æ»‘åŠ¨çª—å£ç‚¹çš„å‡å€¼å’Œæ–¹å·®ï¼›<span class="math inline">\(r\sim \mathcal{N}(0,1)\)</span>ä¸ºæœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å™ªå£°ã€‚</p>
<hr />
<p>å¯¹äºåˆ¤åˆ«æ¨¡å‹ä½¿ç”¨çš„æ˜¯CNNï¼Œä¸»è¦åŒ…å«ä¸¤ä¸ª1ç»´å·ç§¯å±‚(kernel sizeç­‰äºçª—å£å¤§å°<span class="math inline">\(w\)</span>)å’Œä¸¤ä¸ªå…¨è¿æ¥å±‚ã€‚ä¸¤ä¸ªå·ç§¯å±‚çš„channel sizeåˆ†åˆ«ä¸º<span class="math inline">\(w\)</span>å’Œ<span class="math inline">\(2w\)</span>ã€‚</p>
<h2 id="experiments">Experiments</h2>
<h3 id="datasets">Datasets</h3>
<p><img src="http://qfxiao.me/img/1565445958030.png" /></p>
<p>æ‰€ç”¨æ•°æ®é›†åŒ…å«æ¸…åAIOpsç«èµ›æ•°æ®ã€Yahooå’ŒMicrosoftçš„KPIæ•°æ®ã€‚</p>
<h3 id="evaluation-metrics">Evaluation Metrics</h3>
<p>ç®—æ³•å‡†ç¡®ç‡æ–¹é¢ç”¨äº†precisionï¼Œrecallå’Œ<span class="math inline">\(F_1\)</span>-scoreã€‚</p>
<p><img src="http://qfxiao.me/img/1565449295457.png" /></p>
<p>ç”±äºåœ¨å®é™…åœºæ™¯ä¸­KPIçš„å¼‚å¸¸å¾€å¾€æ˜¯ä»¥ä¸€æ®µä¸€æ®µçš„å½¢å¼å‡ºç°ï¼Œä¸”å¹¶ä¸è¦æ±‚æŸä¸€ä¸ªæ—¶é—´ç‚¹å‡ºç°å¼‚å¸¸ç®—æ³•å°±é©¬ä¸Šæ£€æµ‹å‡ºæ¥ï¼Œåªè¦æ£€æµ‹å‡ºæ¥çš„æ—¶é—´åœ¨ä¸€å®šçš„å®¹å¿èŒƒå›´å†…å³å¯ã€‚æœ¬æ–‡ä½¿ç”¨äº†ä¸€äº›è°ƒæ•´çš„æ‰‹æ®µï¼Œå¦‚Figure 6ã€‚å¯¹äºæŸä¸€æ®µå¼‚å¸¸ï¼Œè®¾æ®µé¦–çš„å¼‚å¸¸ä½äºæ—¶é—´ç‚¹<span class="math inline">\(t_{truth}\)</span>ï¼Œé¢„æµ‹ä¸ºå¼‚å¸¸çš„ç»“æœä¸­æ—¶é—´åœ¨<span class="math inline">\(t_{truth}\)</span>ä¹‹åä¸”è·<span class="math inline">\(t_{truth}\)</span>æœ€è¿‘çš„æ—¶é—´ç‚¹è®¾ä¸º<span class="math inline">\(t_{predict}\)</span>ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªé¢„å…ˆè®¾å®šçš„å®¹å¿èŒƒå›´<span class="math inline">\(k\)</span>ï¼Œåªè¦<span class="math inline">\(t_{predict}-t_{truth}\leq k+1\)</span>é‚£ä¹ˆåœ¨é¢„æµ‹ç»“æœä¸­æ•´æ®µå¼‚å¸¸å°±ä¼šé‡ç½®ä¸º<span class="math inline">\(1\)</span>ï¼Œå¦åˆ™å…¨éƒ¨é‡ç½®ä¸º<span class="math inline">\(0\)</span>ã€‚</p>
<h3 id="results">Results</h3>
<p>å®éªŒéƒ¨åˆ†ä½¿ç”¨äº†ä¸¤ç§è®­ç»ƒæ–¹å¼ï¼Œä¸€ç§æ˜¯cold-startï¼Œå³æŠŠæ‰€æœ‰æ•°æ®éƒ½ç”¨æ¥æµ‹è¯•ï¼Œå¦ä¸€ç§æ˜¯æŠŠæ•°æ®åˆ†ä¸ºè®­ç»ƒæµ‹è¯•ä¸¤éƒ¨åˆ†ï¼Œåœ¨è®­ç»ƒé›†ä¸Šè®­ç»ƒï¼Œæœ€ååœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œæµ‹è¯•ã€‚ä¸¤ç§æ–¹æ³•é€‚ç”¨çš„baselineä¸åŒï¼Œæœ€åç»“æœå¦‚Table 2å’ŒTable 3æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565500578722.png" /></p>
<hr />
<p>åœ¨SRçš„å‚æ•°è®¾ç½®ä¸Šï¼Œ<span class="math inline">\(h_q(f)\)</span>ä¸­çš„<span class="math inline">\(q\)</span>ä¸º3ï¼Œå±€éƒ¨å¹³å‡æ‰€ç”¨çš„ç‚¹æ•°ç›®<span class="math inline">\(z\)</span>ä¸º21ï¼Œé˜ˆå€¼<span class="math inline">\(\tau\)</span>ä¸º3ï¼Œä¼°è®¡ç‚¹çš„æ•°é‡<span class="math inline">\(k\)</span>ä¸º5ï¼Œæ»‘åŠ¨çª—å£çš„å¤§å°<span class="math inline">\(w\)</span>åœ¨KPIã€Yahooã€Microsoftä¸‰ä¸ªæ•°æ®é›†ä¸Šåˆ†åˆ«ä¸º1440ã€64å’Œ30ã€‚SR-CNNçš„<span class="math inline">\(q\)</span>ï¼Œ<span class="math inline">\(z\)</span>ï¼Œ<span class="math inline">\(k\)</span>ï¼Œ<span class="math inline">\(w\)</span>è®¾ç½®ä¸SRç›¸åŒã€‚</p>
<h3 id="additional-experiments-with-dnn">Additional Experiments with DNN</h3>
<p>æ–‡ä¸­è¿˜å¯¹æœ‰ç›‘ç£çš„æƒ…å†µè¿›è¡Œäº†æµ‹è¯•ï¼Œå…·ä½“åšæ³•æ˜¯ä»æ—¶é—´åºåˆ—æå–ç‰¹å¾ï¼Œç„¶åå°†Saliency Mapä¹Ÿä½œä¸ºç‰¹å¾å¼•å…¥ï¼Œæ„é€ ä¸€ä¸ªæœ‰ç›‘ç£çš„Neural Networkè¿›è¡Œæµ‹è¯•ã€‚</p>
<p>æå–çš„ç‰¹å¾å¦‚Table 5æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565502099432.png" /></p>
<hr />
<p>ç¥ç»ç½‘ç»œçš„ç»“æ„ä¸ºä¸¤å±‚å…¨è¿æ¥å±‚ï¼Œå¹¶æ·»åŠ äº†Dropout Ratioä¸º0.5çš„Dropout Layerã€‚ä¸¤ä¸ªLayerä½¿ç”¨äº†<span class="math inline">\(L_1=L_2=0.0001\)</span>çš„æ­£åˆ™åŒ–ã€‚åŒæ—¶ä¸ºäº†å¤„ç†æ ·æœ¬ä¸å¹³è¡¡çš„æƒ…å†µä½¿ç”¨äº†è¿‡é‡‡æ ·æ¥ä½¿æ­£è´Ÿæ ·æœ¬çš„æ¯”ä¾‹ä¸º<span class="math inline">\(1:2\)</span>ã€‚ç»“æ„å¦‚Figure 7æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565502126919.png" /></p>
<hr />
<p>è®­ç»ƒæµ‹è¯•é›†çš„æƒ…å†µå¦‚Table 6æ‰€ç¤ºï¼Œæœ€ç»ˆç»“æœå¦‚Table 7æ‰€ç¤ºï¼ŒP-Ræ›²çº¿å¦‚Figure 8æ‰€ç¤ºã€‚å¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†SRç‰¹å¾çš„DNNæ•ˆæœç”±äºæ²¡æœ‰ä½¿ç”¨SRç‰¹å¾çš„DNNã€‚</p>
<p><img src="http://qfxiao.me/img/1565502349310.png" /></p>
<p><img src="http://qfxiao.me/img/1565502360013.png" /></p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block line-height-inherit">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">17</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags"><p class="title">12</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">é“¾æ¥</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†ç±»</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Research/"><span class="level-start"><span class="level-item">Research</span></span><span class="level-end"><span class="level-item tag">16</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Research/Anomaly-Detection/"><span class="level-start"><span class="level-item">Anomaly Detection</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/GAN/"><span class="level-start"><span class="level-item">GAN</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/Misc/"><span class="level-start"><span class="level-item">Misc</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/RNN/"><span class="level-start"><span class="level-item">RNN</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/Time-Series-Imputation/"><span class="level-start"><span class="level-item">Time Series Imputation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/Tutorial/"><span class="level-start"><span class="level-item">Tutorial</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Technical-Notes/"><span class="level-start"><span class="level-item">Technical Notes</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Technical-Notes/Misc/"><span class="level-start"><span class="level-item">Misc</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><a class="media-left" href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200301230011495.png" alt="Discovering Physical Concepts with Neural Networks"></p></a><div class="media-content size-small"><p><time dateTime="2020-03-01T14:55:02.000Z">2020-03-01</time></p><p class="title is-6"><a class="link-muted" href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/">Discovering Physical Concepts with Neural Networks</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Misc/">Misc</a></p></div></article><article class="media"><a class="media-left" href="/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200109102830713.png" alt="Transfer Anomaly Detection by Inferring Latent Domain Representations"></p></a><div class="media-content size-small"><p><time dateTime="2020-02-27T12:02:18.000Z">2020-02-27</time></p><p class="title is-6"><a class="link-muted" href="/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/">Transfer Anomaly Detection by Inferring Latent Domain Representations</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></p></div></article><article class="media"><a class="media-left" href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200113104953902.png" alt="Deep Anomaly Detection with Deviation Networks"></p></a><div class="media-content size-small"><p><time dateTime="2020-02-24T02:45:08.000Z">2020-02-24</time></p><p class="title is-6"><a class="link-muted" href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/">Deep Anomaly Detection with Deviation Networks</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></p></div></article><article class="media"><a class="media-left" href="/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200131113557592.png" alt="Geant4 å®‰è£…æ•™ç¨‹ä¸è°ƒè¯•ç¯å¢ƒé…ç½®"></p></a><div class="media-content size-small"><p><time dateTime="2020-01-31T03:25:59.000Z">2020-01-31</time></p><p class="title is-6"><a class="link-muted" href="/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/">Geant4 å®‰è£…æ•™ç¨‹ä¸è°ƒè¯•ç¯å¢ƒé…ç½®</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Technical-Notes/">Technical Notes</a> / <a class="link-muted" href="/categories/Technical-Notes/Misc/">Misc</a></p></div></article><article class="media"><a class="media-left" href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200109102204802.png" alt="Complementary Set Variational Autoencoder for Supervised Anomaly Detection"></p></a><div class="media-content size-small"><p><time dateTime="2020-01-09T02:15:03.000Z">2020-01-09</time></p><p class="title is-6"><a class="link-muted" href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/">Complementary Set Variational Autoencoder for Supervised Anomaly Detection</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">å½’æ¡£</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">ä¸‰æœˆ 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">äºŒæœˆ 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">ä¸€æœˆ 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">åä¸€æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">åæœˆ 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">ä¹æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">æ ‡ç­¾</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Anomaly-Detection/"><span class="tag">Anomaly Detection</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Deep-Learning/"><span class="tag">Deep Learning</span><span class="tag is-grey-lightest">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Flow-based-Model/"><span class="tag">Flow-based Model</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GAN/"><span class="tag">GAN</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RNN/"><span class="tag">RNN</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spectral/"><span class="tag">Spectral</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Statistics/"><span class="tag">Statistics</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Time-Series/"><span class="tag">Time Series</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Transfer-Learning/"><span class="tag">Transfer Learning</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VAE/"><span class="tag">VAE</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Variational-Inference/"><span class="tag">Variational Inference</span><span class="tag is-grey-lightest">2</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">è®¢é˜…æ›´æ–°</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="è®¢é˜…"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hanzawa ã® éƒ¨å±‹" height="28"></a><p class="size-small"><span>&copy; 2020 Hanzawa</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://qfxiao.me',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><script>window.addEventListener("load", function () {
            MathJax.Hub.Config({
                'HTML-CSS': {
                    matchFontHeight: false
                },
                SVG: {
                    matchFontHeight: false
                },
                CommonHTML: {
                    matchFontHeight: false
                },
                tex2jax: {
                    inlineMath: [
                        ['$','$'],
                        ['\\(','\\)']
                    ]
                }
            });
        });</script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>