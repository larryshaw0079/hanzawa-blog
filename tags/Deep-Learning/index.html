<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>æ ‡ç­¾: Deep Learning - Hanzawa ã® éƒ¨å±‹</title><meta property="og:type" content="blog"><meta property="og:title" content="Hanzawa ã® éƒ¨å±‹"><meta property="og:url" content="http://qfxiao.me/"><meta property="og:site_name" content="Hanzawa ã® éƒ¨å±‹"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="Hanzawa"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="http://qfxiao.me/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://qfxiao.me"},"headline":"Hanzawa ã® éƒ¨å±‹","image":["http://qfxiao.me/img/og_image.png"],"author":{"@type":"Person","name":"Hanzawa"},"description":null}</script><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hanzawa ã® éƒ¨å±‹" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">æ ‡ç­¾</a></li><li class="is-active"><a href="#" aria-current="page">Deep Learning</a></li></ul></nav></div></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/"><img class="thumbnail" src="http://qfxiao.me/img/image-20200301230011495.png" alt="Discovering Physical Concepts with Neural Networks"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-03-01T14:55:02.000Z" title="2020-03-01T14:55:02.000Z">2020-03-01</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Misc/">Misc</a></span><span class="level-item">13 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2019 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/">Discovering Physical Concepts with Neural Networks</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>å¦‚é¢˜ç›®æ‰€ç¤ºï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥å‘æ˜ç‰©ç†æ¦‚å¿µã€‚å…¶æ€è·¯æ˜¯ä»å®éªŒæ•°æ®å­¦åˆ°è¡¨ç¤ºï¼Œç„¶åç”¨å­¦åˆ°çš„è¡¨ç¤ºæ¥å›ç­”ç‰©ç†é—®é¢˜ï¼Œç”±æ­¤ç‰©ç†æ¦‚å¿µå¯ä»¥ä»å­¦åˆ°çš„è¡¨ç¤ºæ¥æå–å‡ºã€‚ä½œè€…è¿›è¡Œäº†4ä¸ªå®éªŒï¼š</p>
<ol>
<li>åœ¨é˜»å°¼æŒ¯åŠ¨å®éªŒä¸­ï¼Œæ¨¡å‹å­¦åˆ°äº†ç›¸å…³çš„ç‰©ç†å‚æ•°ï¼›</li>
<li>åœ¨è§’åŠ¨é‡å®ˆæ’å®éªŒä¸­ï¼Œæ¨¡å‹é¢„æµ‹äº†è´¨ç‚¹çš„è¿åŠ¨ï¼›</li>
<li>ç»™å®šé‡å­ç³»ç»Ÿçš„è§‚æµ‹æ•°æ®ï¼Œæ¨¡å‹æ­£ç¡®çš„è¯†åˆ«å‡ºäº†é‡å­çŠ¶æ€çš„è‡ªç”±åº¦ï¼›</li>
<li>ç»™å®šä»åœ°çƒè§‚æµ‹çš„å¤ªé˜³å’Œç«æ˜Ÿçš„ä½ç½®æ—¶é—´åºåˆ—æ•°æ®ï¼Œæ¨¡å‹å‘ç°äº†æ—¥å¿ƒè¯´æ¨¡å‹ã€‚</li>
</ol>
<h1 id="Preliminaries"><a href="#Preliminaries" class="headerlink" title="Preliminaries"></a>Preliminaries</h1><p>ä½œè€…åœ¨é™„å½•ä¸­å¯¹ç¥ç»ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†è¿›è¡Œäº†ä»‹ç»ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œåªæˆªå–äº†ä¸€äº›ç›¸å¯¹å‰æ²¿çš„å†…å®¹ã€‚</p>
<img src="http://qfxiao.me/img/image-20200301230151518.png" style="zoom:67%;" />

<h2 id="Variational-Autoencoders"><a href="#Variational-Autoencoders" class="headerlink" title="Variational Autoencoders"></a>Variational Autoencoders</h2><p>æœ¬æ–‡ç”¨åˆ°çš„æ¨¡å‹åŸºç¡€æ˜¯VAEï¼š</p>
<img src="http://qfxiao.me/img/image-20200301230200451.png" style="zoom:67%;" />

<h3 id="Representation-Learning"><a href="#Representation-Learning" class="headerlink" title="Representation Learning"></a>Representation Learning</h3><p><em>Representation learning</em>çš„ä¸»è¦ç›®æ ‡æ˜¯å°†æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªéšå‘é‡ (encoder)ï¼Œä¸ºäº†ä¿è¯éšå‘é‡åŒ…å«äº†æ‰€æœ‰ç›¸å…³ä¿¡æ¯ï¼Œ é‚£ä¹ˆåº”è¯¥èƒ½å¤Ÿä»éšå‘é‡è¿˜åŸåŸæ•°æ® (decoder)ã€‚ä¼ ç»Ÿçš„Autoencoderæ˜¯è¿™ä¸ªæ€æƒ³çš„æœ€ç®€å•å®ç°ï¼Œè€ŒVAEåˆ™å°†AEå’Œ<em>Variational Inference</em>ç»“åˆäº†èµ·æ¥ï¼Œæ˜¯ä¸€ç§ç»å…¸çš„ç”Ÿæˆå¼æ¨¡å‹ã€‚ç°åœ¨å¾ˆå¤šç ”ç©¶å…³æ³¨<em>Disentangled Representation Learning</em>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿæ— ç›‘ç£åœ°å­¦ä¹ æ•°æ®ï¼Œä»ä¸­å­¦åˆ°æœ‰æ„ä¹‰çš„è¡¨ç¤ºã€‚</p>
<h3 id="boldsymbol-beta-VAE"><a href="#boldsymbol-beta-VAE" class="headerlink" title="$\boldsymbol \beta$-VAE"></a>$\boldsymbol \beta$-VAE</h3><p>$\beta$-VAEæ˜¯ä¸€ç§ç‰¹æ®Šçš„VAEï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç»å…¸çš„<em>Disentangled Representation Learning</em>æ¨¡å‹ï¼Œå®ƒå’ŒVAEä¸»è¦çš„åŒºåˆ«æ˜¯å¯¹KLæ•£åº¦ä¸€é¡¹åŠ ä¸Šäº†æƒé‡$\beta$è¿›è¡Œè°ƒèŠ‚ï¼š<br>$$<br>C_\beta(x)=-\left[\mathbb{E}_{z\sim p_\phi(z|x)}\log p_\theta(x|z)\right] + \beta D_\text{KL}\left[p_\phi(z|x)\parallel h(z)\right]<br>$$<br>å¦‚æœå‡è®¾$p_\phi(z|x)=\mathcal{N}(\mu,\sigma)$ï¼Œé‚£ä¹ˆæŸå¤±å‡½æ•°å¯ä»¥è¿›è¡Œç®€åŒ–ï¼š<br>$$<br>C_\beta(x)=\parallel \hat{x} - x \parallel^2_2-\frac{\beta}{2}\left(\sum\limits_i\log(\sigma_i^2)-\mu_i^2-\sigma_i^2\right)+C<br>$$</p>
<h1 id="Network-Structure"><a href="#Network-Structure" class="headerlink" title="Network Structure"></a>Network Structure</h1><h2 id="Network-Structure-SciNet"><a href="#Network-Structure-SciNet" class="headerlink" title="Network Structure: SciNet"></a>Network Structure: <em>SciNet</em></h2><p>æ¨¡ä»¿ç‰©ç†å­¦å®¶å»ºæ¨¡ç‰©ç†é—®é¢˜çš„è¿‡ç¨‹ï¼Œä½œè€…æå‡ºäº†<em>SciNet</em>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://qfxiao.me/img/image-20200301225708559.png" style="zoom:67%;" />

<p>ç‰©ç†å­¦å®¶åœ¨å»ºæ¨¡ç‰©ç†é—®é¢˜çš„æ—¶å€™ï¼Œå¾€å¾€æ˜¯ä»ä¸€äº›å®éªŒæ•°æ®å‡ºå‘ï¼Œæ ¹æ®ç‰©ç†å¸¸è¯†æå–æ›´åŠ ç²¾ç»ƒçš„è¡¨ç¤ºï¼Œç„¶åç”¨å­¦åˆ°çš„è¡¨ç¤ºæ¥å›ç­”ç‰©ç†é—®é¢˜ã€‚</p>
<p>å¯¹äºå•çº¯çš„è¾“å…¥è¾“å‡ºé—®é¢˜ï¼Œ<em>SciNet</em>å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ˜ å°„ï¼Œ$F:\mathcal{O}\times\mathcal{Q}\rightarrow\mathcal{A}$ã€‚$\mathcal{O}$æ˜¯å¯èƒ½çš„å®éªŒæ•°æ®é›†åˆï¼Œ$\mathcal{Q}$æ˜¯å¯èƒ½çš„é—®é¢˜é›†åˆï¼Œ$\mathcal{A}$æ˜¯å¯èƒ½çš„ç­”æ¡ˆé›†åˆã€‚å¯ä»¥å°†å…¶åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼šç¼–ç è¿‡ç¨‹$E:\mathcal{O}\rightarrow\mathcal{R}$ä»å®éªŒæ•°æ®å­¦åˆ°è¡¨ç¤ºï¼Œè§£ç è¿‡ç¨‹$D:\mathcal{R}\times \mathcal{Q}\rightarrow \mathcal{A}$æ ¹æ®ç»™å®šçš„é—®é¢˜ä»è¡¨ç¤ºæ¥å›ç­”é—®é¢˜ã€‚ç”±æ­¤ï¼Œ$F(o,q)=D(E(o),q)$ã€‚åœ¨å®ç°æ–¹é¢ï¼Œ<em>SciNet</em>é‡‡ç”¨çš„æ˜¯å…¨è¿æ¥ç½‘ç»œã€‚</p>
<h2 id="Training-and-Testing-SciNet"><a href="#Training-and-Testing-SciNet" class="headerlink" title="Training and Testing SciNet"></a>Training and Testing <em>SciNet</em></h2><p>ç”¨æ¥è®­ç»ƒçš„æ•°æ®å½¢å¼ä¸º$(o,q,a_{cor}(o,q))$ï¼Œè§‚æµ‹$o$å’Œé—®é¢˜$q$åˆ†åˆ«ä»è§‚æµ‹é›†$\mathcal{O}$å’Œé—®é¢˜é›†$\mathcal{Q}$é€‰å‡ºï¼Œ$a_{cor}(o,q)$ä¸ºå¯¹åº”çš„æ­£ç¡®ç­”æ¡ˆã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å‡†ç¡®åº¦å°½é‡é«˜ï¼Œå¹¶ä¸”å­¦åˆ°<em>minimal uncorrelated representations</em>ã€‚ä¸ºæ­¤ï¼Œä½œè€…é‡‡ç”¨<em>disentangling variational autoencoder</em>ä½œä¸ºæ¨¡å‹ã€‚</p>
<h1 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h1><p>åœ¨æ–‡ä¸­ï¼Œä½œè€…è¿›è¡Œäº†4ä¸ªå®éªŒæ¥éªŒè¯æ¨¡å‹çš„æœ‰æ•ˆæ€§ã€‚</p>
<h2 id="Damped-Pendulum"><a href="#Damped-Pendulum" class="headerlink" title="Damped Pendulum"></a>Damped Pendulum</h2><p>é˜»å°¼æŒ¯åŠ¨å®éªŒï¼š</p>
<ul>
<li><p>ä»»åŠ¡ï¼šé¢„æµ‹ä¸€ç»´é˜»å°¼æŒ¯åŠ¨åœ¨ä¸åŒæ—¶é—´çš„ä½ç½®ã€‚</p>
</li>
<li><p>ç‰©ç†æ¨¡å‹ï¼š$-kx-b\dot{x}=m\ddot{x}$ï¼Œ$k$ä¸ºå¼¹æ€§æ¨¡é‡ï¼Œ$b$ä¸ºé˜»å°¼ç³»æ•°ï¼Œé€šè§£ä¸º$x(t)=A_0e^{-\frac{b}{2m}t}\cos(\omega t+\delta_0), \space \omega=\sqrt{\frac{k}{m}}\sqrt{1-\frac{b^2}{4mk}}$</p>
</li>
<li><p>è§‚æµ‹æ•°æ®ï¼šä½ç½®æ—¶é—´åºåˆ—æ•°æ®$o=[x(t_i)]_{i\in{1,\cdots,50}}\in\mathbb{R}^{50}$ï¼Œæ—¶é—´é—´éš”ç›¸ç­‰ï¼Œè´¨é‡$m=1\text{kg}$ï¼ŒæŒ¯å¹…$A_0=1\text{m}$ï¼Œç›¸ä½$\delta_0=0$ï¼Œå¼¹æ€§æ¨¡é‡$k\in[5,10]\text{kg}/\text{s}^2$ï¼Œé˜»å°¼ç³»æ•°$b\in[0.5,1]\text{kg}/\text{s}$ã€‚</p>
</li>
<li><p>é—®é¢˜ï¼šé¢„æµ‹$q=t_\text{pred}\in\mathbb{R}$</p>
</li>
</ul>
<p><img src="http://qfxiao.me/img/image-20200301225805576.png" alt=""></p>
<p>éšå˜é‡å¤§å°è®¾ç½®ä¸º3ï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://qfxiao.me/img/image-20200301225838353.png" style="zoom:67%;" />

<p>(b)ä¸­çš„ä¸‰å¹…å›¾åˆ†åˆ«æ˜¯å­¦åˆ°çš„ä¸‰ä¸ªéšå˜é‡å’Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„å‚æ•°$k$å’Œ$b$çš„å…³ç³»å›¾ã€‚ç¬¬ä¸€å¹…å›¾ä¸­å˜é‡$1$ä¸$b$å‡ ä¹å®Œå…¨çº¿æ€§ç›¸å…³ï¼Œä¸$k$åŸºäºçº¿æ€§æ— å…³ï¼Œå˜é‡$2$åªå’Œ$k$ç›¸å…³ã€‚å˜é‡$3$å‡ ä¹ä¸ºä¸€ä¸ªå¸¸æ•°ï¼Œæ•…ä¸æä¾›é¢å¤–çš„ä¿¡æ¯ã€‚ç”±æ­¤ä½œè€…è®¤ä¸º<em>SciNet</em>å­¦åˆ°äº†æˆ‘ä»¬å…³å¿ƒçš„ä¸¤ä¸ªå‚æ•°çš„çŸ¥è¯†ã€‚</p>
<h2 id="Conservation-of-Angular-Momentum"><a href="#Conservation-of-Angular-Momentum" class="headerlink" title="Conservation of Angular Momentum"></a>Conservation of Angular Momentum</h2><p>è§’åŠ¨é‡å®ˆæ’å®éªŒï¼š</p>
<ul>
<li>ä»»åŠ¡ï¼šé¢„æµ‹ä¸€ä¸ªç”±é•¿åº¦ä¸º$r$çš„ç»³å­æ†ç»‘ç€çš„æ—‹è½¬è´¨ç‚¹åœ¨ä½ç½®$(0,r)$ç»ä¸€ä¸ªè‡ªç”±è´¨ç‚¹æ’å‡»åçš„ä½ç½®</li>
<li>ç‰©ç†æ¨¡å‹ï¼šç»™å®šæ’å‡»ä¹‹å‰çš„è§’åŠ¨é‡ï¼Œè‡ªç”±è´¨ç‚¹æ’å‡»ä¹‹åçš„é€Ÿåº¦ï¼Œæ—‹è½¬è´¨ç‚¹åœ¨æ’å‡»ä¹‹ååœ¨æ—¶é—´$t_\text{pred}^\prime$çš„ä½ç½®å¯ä»¥ç”±è§’åŠ¨é‡å®ˆæ’å®šå¾‹ç»™å‡ºï¼š</li>
</ul>
<p>$$<br>J=m_\text{rot}r^2\omega-rm_\text{free}(\mathbf{v}_\text{free})_x=m_\text{rot}r^2\omega^\prime-rm_\text{free}(\mathbf{v}^\prime_\text{free})_x=J^\prime<br>$$</p>
<ul>
<li>è§‚æµ‹æ•°æ®ï¼šåœ¨æ’å‡»ä¹‹å‰ä¸¤ä¸ªè´¨ç‚¹çš„ä½ç½®æ•°æ®$o=[(t_i^\text{rot},q_\text{rot}(t_i^\text{rot})),(t_i^\text{free},q_\text{free}(t_i^\text{free}))]_{i\in{1,\cdots,5}}$ï¼Œè´¨é‡ä¸ºå›ºå®šå€¼ï¼ŒåŠå¾„$r$ä¹Ÿä¸ºå›ºå®šå€¼ã€‚æ•°æ®æ·»åŠ é«˜æ–¯å™ªå£°ã€‚</li>
<li>é—®é¢˜ï¼šé¢„æµ‹æ’å‡»ä¹‹åè‡ªç”±è´¨ç‚¹åœ¨æ—¶é—´$t_\text{pred}^\prime$çš„ä½ç½®</li>
</ul>
<p><img src="http://qfxiao.me/img/image-20200301225858626.png" alt=""></p>
<p>å®éªŒå®¤æ„å›¾å¦‚ä¸‹ï¼š</p>
<img src="http://qfxiao.me/img/image-20200301225917614.png" style="zoom:67%;" />

<p>å®éªŒç»“æœè¡¨æ˜<em>SciNet</em>èƒ½å¤Ÿæ­£ç¡®é¢„æµ‹è´¨ç‚¹æ’å‡»ä¹‹åçš„ä½ç½®ï¼ŒåŒæ—¶å¯¹å™ªéŸ³é²æ£’ã€‚æ ¹æ®(b)ï¼Œéšå˜é‡å’Œè§’åŠ¨é‡å­˜åœ¨çº¿æ€§ç›¸å…³å…³ç³»ï¼Œä½œè€…è®¤ä¸º<em>SciNet</em>å­¦åˆ°äº†å®ˆæ’çš„åŠ¨é‡è¿™ä¸€æ¦‚å¿µã€‚</p>
<h2 id="Representation-of-Qubits"><a href="#Representation-of-Qubits" class="headerlink" title="Representation of Qubits"></a>Representation of Qubits</h2><p>é‡å­æ¯”ç‰¹å®éªŒï¼š</p>
<ul>
<li>ä»»åŠ¡ï¼šé¢„æµ‹åœ¨$n=1,2$çš„çº¯$n$é‡å­ä½çŠ¶æ€$\psi\in\mathbb{C}^{2^n}$ä¸‹ä»»ä½•äºŒè¿›åˆ¶æŠ•å½±æµ‹é‡$\omega\in\mathbb{C}^{2^n}$çš„æµ‹é‡æ¦‚ç‡ã€‚</li>
<li>ç‰©ç†æ¨¡å‹ï¼šåœ¨æ‰§è¡Œæµ‹é‡$\omega\in\mathbb{C}^{2^n}$çš„çŠ¶æ€$\psi\in\mathbb{C}^{2^n}$ä¸‹æµ‹é‡0çš„æ¦‚ç‡$p(\omega,\psi)$ç”±$p(\omega,\psi)=|\left&lt;\omega,\psi\right&gt;|^2$ç»™å®š</li>
<li>è§‚æµ‹æ•°æ®ï¼šçŠ¶æ€$\psi: o=[p(\alpha_i,\psi)]<em>{i\in{i,\cdots,n_1}}$çš„æ“ä½œå‚æ•°åŒ–ï¼šè¡¨ç¤ºä¸€ç»„å›ºå®šçš„éšæœºäºŒå…ƒå°„å½±æµ‹é‡å€¼$\mathcal{M}_1={\alpha_1,\cdots,\alpha</em>{n_1}}$ï¼ˆä¸€ä¸ªé‡å­ä½$n_1 = 10$ï¼Œä¸¤ä¸ªé‡å­ä½$n_1 = 30$ï¼‰</li>
<li>é—®é¢˜ï¼šå¯¹äºå›ºå®šçš„ä¸€ç»„éšæœºäºŒå…ƒå°„å½±æµ‹é‡$\mathcal{M}<em>2={\beta_1,\cdots,\beta</em>{n_2}}$ï¼Œæµ‹é‡$\omega:q=[p(\beta_i,\omega)]_{i\in{1,\cdots,n_2}}$çš„Operationalå‚æ•°åŒ–ï¼ˆä¸€ä¸ªé‡å­ä½$n_2 = 10$ï¼Œä¸¤ä¸ªé‡å­ä½$n_2 = 30$ï¼‰</li>
</ul>
<p><img src="http://qfxiao.me/img/image-20200301225929696.png" alt=""></p>
<p>å®éªŒç»“æœå¦‚ä¸‹ï¼š</p>
<img src="http://qfxiao.me/img/image-20200301225958663.png" style="zoom:67%;" />

<p>é€šè¿‡å®éªŒå‘ç°ï¼Œ<em>SciNet</em>å¯ä»¥åœ¨ä¸æä¾›å…ˆéªŒç‰©ç†çŸ¥è¯†çš„æ¡ä»¶ä¸‹ç¡®å®šè¡¨è¿°çŠ¶æ€$\psi$æœ€å°çš„å‚æ•°æ•°é‡ã€‚åŒæ—¶ï¼Œ<em>SciNet</em>è¿˜èƒ½åˆ†è¾¨<em>tomographically complete</em>å’Œ<em>tomographically incomplete</em>ã€‚</p>
<h2 id="Heliocentric-Model-of-the-Solar-System"><a href="#Heliocentric-Model-of-the-Solar-System" class="headerlink" title="Heliocentric Model of the Solar System"></a>Heliocentric Model of the Solar System</h2><p>æ—¥å¿ƒè¯´æ¨¡å‹ï¼š</p>
<ul>
<li>é—®é¢˜ï¼šåœ¨ç»™å®šåˆå§‹æ¡ä»¶ä¸‹é¢„æµ‹ç›¸å¯¹ä¸åœ°çƒçš„å¤ªé˜³å’Œç«æ˜Ÿçš„è§’åº¦$\theta_M(t)$å’Œ$\theta_S(t)$</li>
<li>ç‰©ç†æ¨¡å‹ï¼šåœ°çƒå’Œç«æ˜Ÿå›´ç»•å¤ªé˜³ä»¥ä¸€å®šè§’é€Ÿåº¦åšè¿‘ä¼¼åœ†å‘¨è¿åŠ¨</li>
<li>è§‚æµ‹æ•°æ®ï¼šç»™å®šåˆå§‹è§’åº¦ï¼Œéšæœºé€‰æ‹©å‘¨å‘¨æœŸçš„å“¥ç™½å°¼çš„è§‚æµ‹æ•°æ®</li>
</ul>
<p><img src="http://qfxiao.me/img/image-20200301230035141.png" alt=""></p>
<p>æ¨¡å‹çš„å®ç°ç¨æœ‰å˜åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://qfxiao.me/img/image-20200301230011495.png" style="zoom:67%;" />

<p>è¿™æ ·ï¼Œå¯¹äºä¸åŒæ—¶é—´éƒ½å¯¹åº”ä¸€ä¸ªéšå˜é‡$r(t_i)$ï¼Œè€Œä¸”éšå˜é‡æ˜¯æ—¶é—´ä¾èµ–çš„ï¼Œå¯¹äºä¸€ä¸ªéšå˜é‡$r(t_i)$æœ‰ä¸€ä¸ªè§£ç å™¨æ¥è¾“å‡ºç­”æ¡ˆã€‚</p>
<img src="http://qfxiao.me/img/image-20200301230101709.png" style="zoom:67%;" />

<p>å®éªŒç»“æœè¡¨ç¤ºï¼Œ<em>SciNet</em>ä¸ä»…æ­£ç¡®é¢„æµ‹äº†å¤ªé˜³å’Œç«æ˜Ÿç›¸å¯¹åœ°çƒçš„è§’åº¦ï¼ŒåŒæ—¶éšå˜é‡æ­ç¤ºäº†ç«æ˜Ÿå’Œåœ°çƒç›¸å¯¹å¤ªé˜³çš„è§’åº¦ã€‚</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/"><img class="thumbnail" src="http://qfxiao.me/img/image-20200113104953902.png" alt="Deep Anomaly Detection with Deviation Networks"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-02-24T02:45:08.000Z" title="2020-02-24T02:45:08.000Z">2020-02-24</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">15 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2216 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/">Deep Anomaly Detection with Deviation Networks</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æœ¬æ–‡å…³æ³¨<code>Deep Anomaly Detection</code>ï¼Œä¹Ÿå°±æ˜¯ç”¨æ·±åº¦å­¦ä¹ çš„æ–¹æ³•æ¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€‚æ–‡ä¸­æåˆ°ç°æœ‰çš„<code>Deep Anomaly Detection</code>å­˜åœ¨ä¸¤ä¸ªå¼Šç«¯ï¼šä¸€ä¸ªæ˜¯é‡‡ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•æ¥è¿›è¡Œç‰¹å¾å­¦ä¹ ï¼Œç„¶åé€šè¿‡ä¸‹æ¸¸ä»»åŠ¡å¾—åˆ°<code>Anomaly Score</code>ï¼Œç›¸æ¯”æ–‡ä¸­End-to-Endçš„<code>Anomaly Score</code>å­¦ä¹ ï¼Œå­˜åœ¨ä¼˜åŒ–ä¸å……åˆ†çš„é£é™©ï¼›å¦ä¸€ä¸ªæ˜¯ç°æœ‰çš„æ–¹æ³•ä¸»è¦æ˜¯æ— ç›‘ç£å­¦ä¹ ï¼Œæ— æ³•åˆ©ç”¨å·²çŸ¥çš„ä¿¡æ¯ï¼ˆå¦‚å°‘é‡æ ‡ç­¾ï¼‰ã€‚ä¸ºæ­¤ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œæ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p>
<p>æœ¬æ–‡çš„ä¸»è¦è´¡çŒ®å¦‚ä¸‹ï¼š</p>
<ul>
<li>æå‡ºäº†ä¸€ç§ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œç›´æ¥å­¦ä¹ <code>Anomaly Score</code>å¹¶ä¸”å¯ä»¥åˆ©ç”¨å·²çŸ¥ä¿¡æ¯ï¼›</li>
<li>åŸºäºæå‡ºçš„æ¡†æ¶ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ç§å®ä¾‹æ–¹æ³• (DevNet)ã€‚</li>
</ul>
<img src="http://qfxiao.me/img/image-20200113104938784.png" style="zoom:67%;" />

<h1 id="Proposed-Model"><a href="#Proposed-Model" class="headerlink" title="Proposed Model"></a>Proposed Model</h1><h2 id="End-To-End-Anomaly-Score-Learning"><a href="#End-To-End-Anomaly-Score-Learning" class="headerlink" title="End-To-End Anomaly Score Learning"></a>End-To-End Anomaly Score Learning</h2><h3 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h3><p>ä¸ºäº†åŒºåˆ«äºä¼ ç»Ÿçš„ä¸¤é˜¶æ®µå¼‚å¸¸æ£€æµ‹ï¼ˆå…ˆå­¦ä¹ ç‰¹å¾è¡¨ç¤ºï¼Œç„¶ååœ¨å­¦åˆ°çš„ç‰¹å¾ä¸Šå®šä¹‰ä¸€ä¸ª<code>anomaly measure</code>æ¥å¾—åˆ°<code>anomaly score</code>ï¼‰ï¼Œä½œè€…å¯¹ç«¯åˆ°ç«¯çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜é‡æ–°è¿›è¡Œå½¢å¼åŒ–ã€‚</p>
<p>ç»™å®š$N+K$ä¸ªæ ·æœ¬$\mathcal{X}={\boldsymbol x_1,\boldsymbol x_2,\cdots,\boldsymbol x_N,\boldsymbol x_{N+1},\cdots,\boldsymbol x_{N+K}}$ï¼Œå…¶ä¸­$\boldsymbol x_i\in\mathbb{R}^D$ï¼Œæ— æ ‡ç­¾æ ·æœ¬é›†$\mathcal{U}={\boldsymbol x_1,\boldsymbol x_2,\cdots,\boldsymbol x_N}$ï¼Œæœ‰æ ‡ç­¾æ ·æœ¬é›†$\mathcal{K}={\boldsymbol x_{N+1},\cdots,\boldsymbol x_{N+K}}$ï¼Œä¸”$K\ll N$ã€‚å¼‚å¸¸æ£€æµ‹çš„ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ª<code>anomaly scoring function</code>$\phi:\mathcal{X}\mapsto\mathbb{R}$ä½¿å¾—$\phi(\boldsymbol x_i)&gt;\phi(\boldsymbol x_j)$ï¼Œå…¶ä¸­$\boldsymbol x_i$ä¸ºå¼‚å¸¸æ ·æœ¬ï¼Œ$\boldsymbol x_j$ä¸ºæ­£å¸¸æ ·æœ¬ã€‚</p>
<h3 id="The-Proposed-Framework"><a href="#The-Proposed-Framework" class="headerlink" title="The Proposed Framework"></a>The Proposed Framework</h3><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ–‡ä¸­æå‡ºäº†ä¸€ç§é€šç”¨å¼‚å¸¸æ£€æµ‹æ¡†æ¶ï¼Œæ¨¡å‹æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p>æ¨¡å‹æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="http://qfxiao.me/img/image-20200113104953902.png" style="zoom:50%;" />

<p>ä¸»è¦åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li><em>anomaly scoring network</em>. å›¾ä¸­å·¦è¾¹çš„éƒ¨åˆ†ï¼Œä¸€ä¸ªå‡½æ•°$\phi$ï¼Œè¾“å…¥æ ·æœ¬$\mathbf{x}$ï¼Œè¾“å‡º<code>anomaly score</code></li>
<li><em>reference score generator</em>. å›¾ä¸­å³è¾¹çš„éƒ¨åˆ†ã€‚åªæœ‰ä¸€ä¸ª<em>anomaly scoring network</em>å¹¶ä¸èƒ½è¿›è¡Œè®­ç»ƒï¼Œéœ€è¦è®­ç»ƒçš„ç›®æ ‡ã€‚ä¸ºæ­¤åŠ å…¥<em>reference score generator</em>ï¼Œè¾“å…¥ä¸ºéšæœºé€‰æ‹©çš„$l$ä¸ªæ­£å¸¸æ ·æœ¬ï¼Œè¾“å‡º<code>reference score</code>ï¼ˆè¿™$l$ä¸ªæ­£å¸¸æ ·æœ¬<code>anomaly score</code>çš„å‡å€¼ï¼Œè®°ä¸º$\mu_\mathcal{R}$ï¼‰</li>
<li><em>deviation loss</em>. $\phi(\mathbf{x})$ï¼Œ$\mu_\mathcal{R}$åŠå¯¹åº”çš„æ ‡å‡†å·®$\sigma_\mathcal{R}$ä½œä¸º<code>deviation loss</code>å‡½æ•°çš„è¾“å…¥ã€‚å› ä¸º$\mu_\mathcal{R}$å’Œ$\sigma_\mathcal{R}$å¯¹åº”æ­£å¸¸æ ·æœ¬é›†çš„å‡å€¼å’Œæ–¹å·®ï¼Œé‚£ä¹ˆå¼‚å¸¸æ ·æœ¬çš„<code>anomaly score</code>åº”è¯¥å’Œ$\mu_\mathcal{R}$å·®åˆ«æ¯”è¾ƒå¤§ï¼Œè€Œæ­£å¸¸æ ·æœ¬åˆ™åº”è¯¥æ¥è¿‘$\mu_\mathcal{R}$ã€‚</li>
</ol>
<h2 id="Deviation-Networks"><a href="#Deviation-Networks" class="headerlink" title="Deviation Networks"></a>Deviation Networks</h2><p>ä¸‹é¢æ˜¯ä¸Šè¿°ä¸‰ä¸ªéƒ¨ä»¶çš„å…·ä½“å®ç°ã€‚</p>
<h3 id="End-To-End-Anomaly-Scoring-Network"><a href="#End-To-End-Anomaly-Scoring-Network" class="headerlink" title="End-To-End Anomaly Scoring Network"></a>End-To-End Anomaly Scoring Network</h3><p>è®°$\mathcal{Q}\in\mathbb{R}^M$ä¸ºä¸­é—´è¡¨ç¤ºç©ºé—´ï¼Œ<code>anomaly scoring network</code>$\phi(\cdot;\Theta):\mathcal{X}\mapsto\mathbb{R}$å¯ä»¥å®šä¹‰ä¸ºæ•°æ®è¡¨ç¤ºå­¦ä¹ $\psi(\cdot;\Theta_t):\mathcal{X}\mapsto\mathcal{Q}$å’Œå¼‚å¸¸åˆ†æ•°å­¦ä¹ $\eta(\cdot;\Theta_s):\mathcal{Q}\mapsto\mathbb{R}$ä¸¤é˜¶æ®µçš„ç»„åˆï¼Œå…¶ä¸­$\Theta={\Theta_t,\Theta_s}$ã€‚</p>
<p>$\psi(\cdot;\Theta_t)$å¯ä»¥ç”¨ä¸€ä¸ª$H$å±‚ç¥ç»ç½‘ç»œæ¥å®ç°ï¼š<br>$$<br>\mathrm{q}=\psi(\mathbf{x};\Theta_t)<br>$$<br>å…¶ä¸­$\mathbf{x}\in\mathcal{X}$ï¼Œ$\mathrm{q}\in\mathcal{Q}$ã€‚</p>
<p>$\eta(\cdot;\Theta_s)$å¯ä»¥ç”¨ä¸€ä¸ªå•å±‚çš„ç¥ç»ç½‘ç»œæ¥å®ç°ï¼š<br>$$<br>\eta(\mathrm q;\Theta_s)=\sum\limits_{i=1}^M w_i^oq_i+w_{M+1}^o<br>$$<br>å…¶ä¸­$\mathrm q\in\mathcal Q$ï¼Œ$\Theta_s={\mathbf{w}^o}$ã€‚</p>
<p>æ‰€ä»¥æœ‰ï¼š<br>$$<br>\phi(\mathbf{x};\Theta)=\eta(\psi(\mathbf{x};\Theta_t);\Theta_s)<br>$$</p>
<h3 id="Gaussian-Prior-based-Reference-Scores"><a href="#Gaussian-Prior-based-Reference-Scores" class="headerlink" title="Gaussian Prior-based Reference Scores"></a>Gaussian Prior-based Reference Scores</h3><p>æœ‰ä¸¤ç§æ–¹æ³•æ¥è·å¾—$\mu_\mathcal{R}$ï¼Œä¸€ç§æ˜¯data-drivenï¼Œä¸€ç§æ˜¯prior-drivenã€‚å¦‚æœæ˜¯data-drivençš„è¯åˆ™é‡‡ç”¨å¦ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œæ–‡ä¸­è¡¨ç¤ºä¸ºäº†æ›´å¥½çš„è§£é‡Šæ€§å’Œè®¡ç®—æ•ˆç‡ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ˜¯prior-drivenã€‚<br>$$<br>\begin{align}<br>r_1,r_2,\cdots,r_l\sim \mathcal{N}(\mu,\sigma^2),\<br>\mu_\mathcal{R}=\frac{1}{l}\sum\limits_{i=1}^l r_i<br>\end{align}<br>$$<br>åœ¨æ–‡ä¸­ï¼Œé‡‡ç”¨çš„prioræ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒã€‚</p>
<h2 id="Z-Score-Based-Deviation-Loss"><a href="#Z-Score-Based-Deviation-Loss" class="headerlink" title="Z-Score Based Deviation Loss"></a>Z-Score Based Deviation Loss</h2><p><em>anomaly scoring network</em>çš„ä¼˜åŒ–ç›®æ ‡å¯ä»¥å®šä¹‰ä¸ºZ-Scoreçš„æ–¹å¼ï¼š<br>$$<br>dev(\boldsymbol x)=\frac{\phi(\boldsymbol x;\Theta)-\mu_{\mathcal{R}}}{\sigma_{\mathcal{R}}}<br>$$<br>$dev(\boldsymbol x)$å¯ä»¥çœ‹ä½œæ˜¯æ ·æœ¬åç¦»æ ‡å‡†çš„ç¨‹åº¦ï¼Œè€Œæˆ‘ä»¬è‚¯å®šå¸Œæœ›å¼‚å¸¸æ ·æœ¬åç¦»æ ‡å‡†è¶Šå¤§ï¼Œæ­£å¸¸æ ·æœ¬è¶Šæ¥è¿‘æ ‡å‡†ã€‚æ–‡ä¸­é‡‡ç”¨çš„æŸå¤±å‡½æ•°æ˜¯<code>Contrastive Loss</code>ï¼š<br>$$<br>L(\phi(\boldsymbol x;\Theta),\mu_\mathcal{R},\sigma_\mathcal{R})=(1-y)|dev(\boldsymbol x)| + y \max(0, a - dev(\boldsymbol x))<br>$$<br><code>Contrastive Loss</code>çš„ç›´è§‚è§£é‡Šå¯ä»¥çœ‹ä¸‹å›¾ï¼š</p>
<img src="http://qfxiao.me/img/contrastive_2020_2_24.png" style="zoom:50%;" />

<p>å¯¹äºè´Ÿä¾‹ï¼ˆæ­£å¸¸ï¼‰ï¼Œä¼˜åŒ–è¿‡ç¨‹å°†ä»–ä»¬å°½é‡å‘åŸç‚¹é è¿‘ï¼Œå¯¹äºæ­£ä¾‹ï¼ˆå¼‚å¸¸ï¼‰ï¼Œä¼˜åŒ–è¿‡ç¨‹å°†ä»–ä»¬æ‹‰å‘è¾¹ç•Œã€‚</p>
<h2 id="The-DevNet-Algorithm"><a href="#The-DevNet-Algorithm" class="headerlink" title="The DevNet Algorithm"></a>The DevNet Algorithm</h2><p><code>DevNet</code>çš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200113105040134.png" alt=""></p>
<h2 id="Interpretability-of-Anomaly-Scores"><a href="#Interpretability-of-Anomaly-Scores" class="headerlink" title="Interpretability of Anomaly Scores"></a>Interpretability of Anomaly Scores</h2><p>å› ä¸º<em>reference score generator</em>é€‰æ‹©çš„æ˜¯ç¡®å®šçš„é«˜æ–¯åˆ†å¸ƒï¼Œäºæ˜¯å¯ä»¥ç”¨æ¦‚ç‡è®ºç»™å‡ºä¸€äº›è§£é‡Šæ€§ã€‚ä½œè€…ç»™å‡ºäº†ä¸€ä¸ªç»“è®ºï¼Œ</p>
<blockquote>
<p><strong>PROPOSITION</strong>ï¼š è®¾$\boldsymbol x\in\mathcal{X}$ï¼Œ$z_p$ä¸º$\mathcal{N}(\mu,\sigma^2)$çš„åˆ†ä½æ•°ï¼Œé‚£ä¹ˆ$\phi(\boldsymbol x)$åœ¨åŒºé—´$\mu\pm z_p\sigma$çš„æ¦‚ç‡ä¸º$2(1-p)$ã€‚</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œå‡è®¾$p=0.95$ï¼Œé‚£ä¹ˆ$z_{0.95}=1.96$ï¼Œè¡¨ç¤ºå¼‚å¸¸åˆ†æ•°é«˜äº1.96çš„æ ·æœ¬å°†ä»¥0.95çš„ç½®ä¿¡åº¦ä¸ºå¼‚å¸¸ã€‚</p>
<h1 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h1><p>å®éªŒç”¨åˆ°äº†9ä¸ªæ•°æ®é›†ï¼Œ4ä¸ªBaseline (REPENï¼ŒDSVDDï¼ŒFSNETï¼ŒiForest)ï¼Œä»¥åŠROCå’ŒPRæ›²çº¿ä¸¤ç§è¯„æµ‹æ ‡å‡†ã€‚</p>
<h2 id="Effectiveness-in-Real-world-Data-Sets"><a href="#Effectiveness-in-Real-world-Data-Sets" class="headerlink" title="Effectiveness in Real-world Data Sets"></a>Effectiveness in Real-world Data Sets</h2><h3 id="Experiment-Settings"><a href="#Experiment-Settings" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h3><p>è¿™ä¸€ä¸ªå®éªŒä¸»è¦æ˜¯ä¸ºäº†éªŒè¯ç®—æ³•åœ¨çœŸå®åœºæ™¯ä¸‹çš„æ•ˆæœï¼Œå³å¤§é‡æ— æ ‡ç­¾æ•°æ®å’Œæå°‘é‡æ ‡ç­¾æ•°æ®ã€‚è®­ç»ƒé›†åŒ…å«ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯æ— æ ‡ç­¾æ•°æ®$\mathcal{U}$,åŒ…å«$2%$çš„å¼‚å¸¸æ ·æœ¬ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æœ‰æ ‡ç­¾æ•°æ®$\mathcal{K}$ï¼Œç”±éšæœºé‡‡æ ·$0.005%-1%$çš„è®­ç»ƒæ•°æ®å’Œ$0.08%-6%$çš„å¼‚å¸¸æ ·æœ¬ç»„æˆã€‚</p>
<h3 id="Findings"><a href="#Findings" class="headerlink" title="Findings"></a>Findings</h3><p>å®éªŒç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200113110000432.png" alt=""></p>
<p>ä»ç»“æœä¸Šçœ‹æ¥ï¼Œæœ¬æ–‡æå‡ºçš„æ–¹æ³•åœ¨æ‰€æœ‰æ•°æ®é›†ä¸Šéƒ½æ¯”Baselineå¥½ï¼Œè¯´æ˜<code>DevNet</code>ç«¯åˆ°ç«¯ç›´æ¥ä¼˜åŒ–<code>Anomaly Score</code>çš„æ–¹å¼æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<h2 id="Data-Efficiency"><a href="#Data-Efficiency" class="headerlink" title="Data Efficiency"></a>Data Efficiency</h2><h3 id="Experiment-Settings-1"><a href="#Experiment-Settings-1" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h3><p>è¿™ä¸€ä¸ªå®éªŒä¸»è¦æ˜¯ä¸ºäº†æ¢ç©¶åŸºäºæ·±åº¦çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„<em>data efficiency</em>ã€‚å’Œä¸Šä¸€ä¸ªå®éªŒä¸€æ ·ï¼Œæ— æ ‡ç­¾æ•°æ®é›†åŒ…å«$2%$çš„å¼‚å¸¸ï¼Œè€Œæœ‰æ ‡ç­¾çš„å¼‚å¸¸æ•°é‡ä»$5$åˆ°$120$ä¸ç­‰ã€‚æœ¬å®éªŒè¯•å›¾å›ç­”ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li><code>DevNet</code>çš„<em>data efficiency</em>å¦‚ä½•ï¼Ÿ</li>
<li>åŸºäºæ·±åº¦çš„æ–¹æ³•åœ¨å¤šå¤§ç¨‹åº¦ä¸Šèƒ½å¤Ÿåˆ©ç”¨æ ‡ç­¾ä¿¡æ¯ï¼Ÿ</li>
</ul>
<h3 id="Findings-1"><a href="#Findings-1" class="headerlink" title="Findings"></a>Findings</h3><p>åœ¨å‡ ä¸ªåŸºäºæ·±åº¦çš„Baselineä¸­ï¼Œ<code>DevNet</code>çš„æ•ˆæœæ˜¯æœ€å¥½çš„ï¼ŒåŒæ—¶åœ¨æœ‰æ ‡ç­¾å¼‚å¸¸éå¸¸æœ‰é™çš„æƒ…å†µä¸‹ï¼Œ<code>DevNet</code>ä¹Ÿèƒ½å¾ˆå¥½çš„åˆ©ç”¨æ ‡ç­¾ä¿¡æ¯ï¼Œè¾¾åˆ°æ›´å¥½çš„æ•ˆæœã€‚</p>
<p><img src="http://qfxiao.me/img/image-20200113110017195.png" alt=""></p>
<h2 id="Robustness-w-r-t-Anomaly-Contamination"><a href="#Robustness-w-r-t-Anomaly-Contamination" class="headerlink" title="Robustness w.r.t. Anomaly Contamination"></a>Robustness w.r.t. Anomaly Contamination</h2><h3 id="Experiment-Settings-2"><a href="#Experiment-Settings-2" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h3><p>åœ¨ç¬¬ä¸€ä¸ªå®éªŒä¸­ï¼Œæ— æ ‡ç­¾æ•°æ®é›†$\mathcal{U}$åŒ…å«çš„æ˜¯å›ºå®šçš„å¼‚å¸¸æ¯”ä¾‹$2%$ï¼Œè€Œåœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½œè€…æµ‹è¯•äº†ä»$0%$åˆ°$20%$ä¹‹é—´ä¸åŒå¼‚å¸¸æ¯”ä¾‹æ¥æµ‹è¯•ç®—æ³•çš„é²æ£’æ€§ï¼ˆå³ä½¿$\mathcal{U}$ä¸­åŒ…å«å¼‚å¸¸ï¼Œç”±äºæ²¡æœ‰æ ‡ç­¾ï¼Œåœ¨è®­ç»ƒçš„æ—¶å€™ä»ç„¶å‡è®¾éƒ½ä¸ºæ­£å¸¸æ¥è¿›è¡Œè®­ç»ƒï¼‰ã€‚æœ¬å®éªŒè¯•å›¾å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>åŸºäºæ·±åº¦çš„å¼‚å¸¸æ£€æµ‹æ–¹æ³•çš„é²æ£’æ€§å¦‚ä½•ï¼Ÿ</li>
<li>å½“è®­ç»ƒé›†ä¸­å¼‚å¸¸æ±¡æŸ“çš„æ¯”ä¾‹è¾ƒé«˜çš„æ—¶å€™åŸºäºæ·±åº¦çš„æ–¹æ³•èƒ½å¦æ‰“è´¥æ— ç›‘ç£çš„æ–¹æ³•ï¼Ÿ</li>
</ul>
<h3 id="Findings-2"><a href="#Findings-2" class="headerlink" title="Findings"></a>Findings</h3><p>ä¸‹å›¾ä¸ºå®éªŒç»“æœï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200113110035878.png" alt=""></p>
<p>ä»ç»“æœä¸Šæ¥çœ‹ï¼Œ<code>DevNet</code>æ¯”å…¶ä»–åŸºäºæ·±åº¦çš„æ–¹æ³•é²æ£’æ€§æ›´å¥½ï¼ŒåŒæ—¶åœ¨é«˜å¼‚å¸¸æ±¡æŸ“çš„æƒ…å†µä¸‹ä»ç„¶æ¯”çº¯æ— ç›‘ç£æ–¹æ³•æ•ˆæœè¦å¥½ã€‚</p>
<h2 id="Ablation-Study"><a href="#Ablation-Study" class="headerlink" title="Ablation Study"></a>Ablation Study</h2><p>æœ¬å®éªŒè®¾ç½®äº†<code>DevNet</code>çš„ä¸‰ä¸ªå˜ä½“ï¼ˆé»˜è®¤çš„<code>DevNet-Def</code>ä¸ºå•å±‚éšå±‚åŠ ä¸Šä¸€ä¸ªè¾“å‡ºå±‚ï¼‰æ¥è¿›è¡Œæ¶ˆèå®éªŒï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li><code>DevNet-Rep</code>ï¼Œå»æ‰äº†<em>anomaly scoring network</em>ç½‘ç»œçš„è¾“å‡ºå±‚ï¼Œå¯¹åº”<em>end-to-end learning of anomaly scores</em>å’Œ<em>deviation loss</em>ï¼›</li>
<li><code>DevNet-Linear</code>ï¼Œå»æ‰äº†ç½‘ç»œä¸­çš„éçº¿æ€§å±‚ï¼Œå¯¹åº”<em>learning of non-linear features</em>ï¼›</li>
<li><code>DevNet-3HL</code>ï¼Œéšå±‚æ•°é‡ä¸º3å±‚ã€‚</li>
</ul>
<p>å¯¹æ¯”ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200113110048598.png" alt=""></p>
<p>é€šè¿‡å®éªŒå¯ä»¥å‘ç°ï¼Œ<code>DevNet-Rep</code>è¯´æ˜äº†<em>end-to-end learning of anomaly scores</em>å’Œ<em>deviation loss</em>çš„æœ‰æ•ˆæ€§ï¼Œè€Œ<code>DevNet-Linear</code>è¯´æ˜äº†<em>learning of non-linear features</em>çš„é‡è¦æ€§ã€‚<code>DevNet-3HL</code>è¯´æ˜äº†åŠ æ·±ç½‘ç»œå¹¶ä¸æ€»èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ã€‚</p>
<h2 id="Scalability-Test"><a href="#Scalability-Test" class="headerlink" title="Scalability Test"></a>Scalability Test</h2><p>è¿™ä¸€ä¸ªå®éªŒä½¿ç”¨åˆæˆçš„æ•°æ®æ¥æµ‹è¯•ç®—æ³•å¯¹å¤§è§„æ¨¡æ•°æ®çš„å¤„ç†èƒ½åŠ›ï¼Œåˆ†åˆ«ä»<em>Data Size</em>å’Œ<em>Data Dimensionality</em>ä¸¤æ–¹é¢æ¥æµ‹è¯•ã€‚ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200113110113423.png" alt=""></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œ<code>DevNet</code>å¯¹<em>Data Size</em>å¹¶ä¸æ•æ„Ÿï¼ŒåŒæ—¶ï¼Œé¢å¯¹é«˜ç»´æ•°æ®ï¼Œ<code>DevNet</code>ä¹Ÿæ²¡æœ‰è¡¨ç°å‡ºåŠ£åŠ¿ã€‚</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/01/08/Time-Series-Anomaly-Detection-Paper-List/"><img class="thumbnail" src="http://qfxiao.me/img/1571569717718.png" alt="Time Series Anomaly Detection Paper List"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-01-08T02:27:58.000Z" title="2020-01-08T02:27:58.000Z">2020-01-08</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">19 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2792 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/01/08/Time-Series-Anomaly-Detection-Paper-List/">Time Series Anomaly Detection Paper List</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹åœ¨å¾ˆå¤šé¢†åŸŸä¾‹å¦‚è¿ç»´ã€é‡‘èã€äº¤é€šéƒ½æ‰®æ¼”è€…é‡è¦çš„è§’è‰²ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ç»™å®šæ—¶é—´åºåˆ—$X={\mathbf{x}_1,\mathbf{x}_2,\cdots,\mathbf{x}_n}\in\mathbb{R}^{m\times n}$ï¼Œå¼‚å¸¸æ£€æµ‹çš„ä»»åŠ¡æ˜¯è¾“å‡ºå¼‚å¸¸æ ‡ç­¾$y={y_1,y_2,\cdots,y_n}\in\mathbb{R}^n$ï¼Œå…¶ä¸­$y_t=1$ä»£è¡¨$\mathbf{x}_t$ä¸ºå¼‚å¸¸ï¼Œ$y_t=0$ä»£è¡¨$\mathbf{x}_t$æ­£å¸¸</p>
</blockquote>
<p>æœ¬æ–‡ç½—åˆ—äº†ä¸€äº›æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹é¢†åŸŸå€¼å¾—è¯»çš„ä¸€äº›æ–‡ç« ï¼ŒModelä¸€ç« ä¸»è¦æŒ‰æ—¶é—´åºåˆ—ã€é€šç”¨å’Œå›¾çš„å¼‚å¸¸æ£€æµ‹åˆ†ç±»ï¼ŒRelatedä¸»è¦æ˜¯ä¸€äº›éå¼‚å¸¸æ£€æµ‹ã€ä½†æ˜¯èƒ½å¤Ÿè§£å†³å¼‚å¸¸æ£€æµ‹ç ”ç©¶ä¸­çš„ä¸€äº›é—®é¢˜çš„æ–‡ç« ã€‚</p>
<p><img src="http://qfxiao.me/img/1571569717718.png" alt=""></p>
<h1 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h1><h2 id="Time-Series"><a href="#Time-Series" class="headerlink" title="Time Series"></a>Time Series</h2><h3 id="Statistical"><a href="#Statistical" class="headerlink" title="Statistical"></a>Statistical</h3><p>ä¸»è¦åŒ…æ‹¬åå‘ç»Ÿè®¡æ–¹æ³•çš„æ¨¡å‹ï¼š</p>
<table>
<thead>
<tr>
<th><strong>Title</strong></th>
<th><strong>Conf/Journal</strong></th>
<th><strong>Description</strong></th>
<th><strong>Links</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Temporal Anomaly Detection: Calibrating the Surprise</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1705.10085">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Non-Parametric Outliers Detection in Multiple Time Series A Case Study: Power Grid Data Analysis</td>
<td></td>
<td></td>
<td><a href="https://aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/16315">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Anomaly Detection in Streams with Extreme Value Theory</td>
<td>KDD17</td>
<td>æå‡ºäº†ä»¥Extreme Value Theoryä¸ºåŸºç¡€çš„æ—¶åºå¼‚å¸¸æ£€æµ‹å’Œå‚æ•°é€‰æ‹©æ–¹æ³•</td>
<td><a href="https://www.kdd.org/kdd2017/papers/view/anomaly-detection-in-streams-with-extreme-value-theory">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Semi-Markov Switching Vector Autoregressive Model-Based Anomaly Detection in Aviation Systems</td>
<td></td>
<td></td>
<td><a href="https://www.kdd.org/kdd2016/subtopic/view/semi-markov-switching-vector-autoregressive-model-based-anomaly-detection-i">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Stochastic Online Anomaly Analysis for Streaming Time Series</td>
<td></td>
<td></td>
<td><a href="https://www.ijcai.org/proceedings/2017/445">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Unsupervised Real-time Anomaly Detection for Streaming Data</td>
<td></td>
<td></td>
<td><a href="https://www.sciencedirect.com/science/article/pii/S0925231217309864">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Automatic Anomaly Detection in the Cloud Via Statistical Learning</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/abs/1704.07706">ğŸ“ƒPaper</a></td>
</tr>
</tbody></table>
<h3 id="Classic-Machine-Learning"><a href="#Classic-Machine-Learning" class="headerlink" title="Classic Machine Learning"></a>Classic Machine Learning</h3><table>
<thead>
<tr>
<th><strong>Title</strong></th>
<th><strong>Conf/Journal</strong></th>
<th><strong>Description</strong></th>
<th><strong>Links</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Semi-supervised Anomaly Detection with an Application to Water Analytics</td>
<td></td>
<td></td>
<td><a href="https://people.cs.kuleuven.be/~vincent.vercruyssen/publications/2018/ICDM_conference_manuscript.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>DILOF: Effective and Memory Efficient Local Outlier Detection in Data Streams</td>
<td></td>
<td></td>
<td><a href="https://www.kdd.org/kdd2018/accepted-papers/view/dsilof-effective-and-memory-efficient-local-outlier-detection-in-data-strea">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Robust Random Cut Forest Based Anomaly Detection On Streams</td>
<td>ICML16</td>
<td>å­¤ç«‹æ£®æ—çš„æ”¹è¿›ç‰ˆæœ¬æ¥åšæ—¶åºå¼‚å¸¸æ£€æµ‹</td>
<td><a href="http://proceedings.mlr.press/v48/guha16.pdf">ğŸ“ƒPaper</a> <a href="https://github.com/kLabUM/rrcf">ğŸ“¥Code</a></td>
</tr>
<tr>
<td>Anomaly Detection for an E-commerce Pricing System</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1902.09566">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>An Adaptive Approach for Anomaly Detector Selection and Fine-Tuning in Time Series</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1907.07843">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Opprentice: Towards Practical and Automatic Anomaly Detection Through Machine Learning</td>
<td>IMC15</td>
<td>ä»¥éšæœºæ£®æ—ä¸ºåŸºç¡€çš„æ—¶åºå¼‚å¸¸æ£€æµ‹</td>
<td><a href="http://netman.cs.tsinghua.edu.cn/wp-content/uploads/2015/11/liu_imc15_Opprentice.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Variational Inference for On-line Anomaly Detection in High-Dimensional Time Series</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1602.07109">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>A Self-Learning and Online Algorithm for Time SeriesAnomaly Detection, with Application in CPU Manufacturing</td>
<td></td>
<td></td>
<td><a href="https://dl.acm.org/citation.cfm?id=2983344">ğŸ“ƒPaper</a></td>
</tr>
</tbody></table>
<h3 id="VAE"><a href="#VAE" class="headerlink" title="VAE"></a>VAE</h3><table>
<thead>
<tr>
<th><strong>Title</strong></th>
<th><strong>Conf/Journal</strong></th>
<th><strong>Description</strong></th>
<th><strong>Links</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Unsupervised Anomaly Detection via Variational Auto-Encoder for Seasonal KPIs in Web Applications</td>
<td>WWW18</td>
<td>æ™®é€šVAE</td>
<td><a href="https://arxiv.org/pdf/1802.03903">ğŸ“ƒPaper</a> <a href="https://github.com/haowen-xu/donut">ğŸ“¥Code</a> <a href="http://qfxiao.me/2019/09/22/Unsupervised-Anomaly-Detection-via-Variational-Auto-Encoder-for-Seasonal-KPIs-in-Web-Applications/">âœBlog</a></td>
</tr>
<tr>
<td>Robust and Unsupervised KPI Anomaly Detection Based on Conditional Variational Autoencoder</td>
<td>IPCCC18</td>
<td>æ¡ä»¶VAE</td>
<td><a href="https://ieeexplore.ieee.org/document/8710885">ğŸ“ƒPaper</a> <a href="https://github.com/yantijin/Buzz">ğŸ“¥Code</a></td>
</tr>
<tr>
<td>Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE</td>
<td>INFOCOM19</td>
<td>VAEåŠ å¯¹æŠ—è®­ç»ƒ</td>
<td><a href="https://ieeexplore.ieee.org/abstract/document/8737430/">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Multidimensional Time Series Anomaly Detection: A GRU-based Gaussian Mixture Variational Autoencoder Approach</td>
<td></td>
<td></td>
<td><a href="http://proceedings.mlr.press/v95/guo18a/guo18a.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network</td>
<td>KDD19</td>
<td>å¤šå˜é‡åŸºäºVAEå’ŒRNNçš„æ—¶åºå¼‚å¸¸æ£€æµ‹</td>
<td><a href="https://www.kdd.org/kdd2019/accepted-papers/view/robust-anomaly-detection-for-multivariate-time-series-through-stochastic-re">ğŸ“ƒPaper</a> <a href="https://github.com/smallcowbaby/OmniAnomaly">ğŸ“¥Code</a></td>
</tr>
<tr>
<td>A Multimodal Anomaly Detector for Robot-Assisted Feeding Using an LSTM-based Variational Autoencoder</td>
<td></td>
<td></td>
<td><a href="http://ieeexplore.ieee.org/document/8279425/">ğŸ“ƒPaper</a></td>
</tr>
</tbody></table>
<h3 id="RNN"><a href="#RNN" class="headerlink" title="RNN"></a>RNN</h3><table>
<thead>
<tr>
<th><strong>Title</strong></th>
<th><strong>Conf/Journal</strong></th>
<th><strong>Description</strong></th>
<th><strong>Links</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Detecting Spacecraft Anomalies Using LSTMs and Nonparametric Dynamic Thresholding</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1802.04431">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>BINet: Multivariate Business Process Anomaly Detection Using Deep Learning</td>
<td></td>
<td></td>
<td><a href="https://link.springer.com/chapter/10.1007/978-3-319-98648-7_16">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Outlier Detection for Time Series with Recurrent Autoencoder Ensembles</td>
<td></td>
<td></td>
<td><a href="https://www.ijcai.org/proceedings/2019/0378.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>LSTM-based Encoder-Decoder for Multi-sensor Anomaly Detection</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1607.00148">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Detecting Anomalies in Space using Multivariate Convolutional LSTM with Mixtures of Probabilistic PCA</td>
<td>KDD19</td>
<td></td>
<td><a href="https://dl.acm.org/doi/10.1145/3292500.3330776">ğŸ“ƒPaper</a></td>
</tr>
</tbody></table>
<h3 id="GAN"><a href="#GAN" class="headerlink" title="GAN"></a>GAN</h3><table>
<thead>
<tr>
<th><strong>Title</strong></th>
<th><strong>Conf/Journal</strong></th>
<th><strong>Description</strong></th>
<th><strong>Links</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Anomaly Detection with Generative Adversarial Networks for Multivariate Time Series</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1809.04758">ğŸ“ƒPaper</a> <a href="http://larryshaw0079.coding.me/blog/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/">ğŸ“¥Blog</a></td>
</tr>
<tr>
<td>MAD-GAN: Multivariate Anomaly Detection for Time Series Data with Generative Adversarial Networks</td>
<td>ICANN19</td>
<td>æ™®é€šGANåšæ—¶åºå¼‚å¸¸æ£€æµ‹ï¼Œæ²¡æœ‰ç¼–ç ç»“æ„</td>
<td><a href="https://arxiv.org/pdf/1901.04997">ğŸ“ƒPaper</a> <a href="https://github.com/LiDan456/MAD-GANs">ğŸ“¥Code</a></td>
</tr>
<tr>
<td>BeatGAN: Anomalous Rhythm Detection using Adversarially Generated Time Series</td>
<td>IJCAI19</td>
<td>ECGå¼‚å¸¸æ£€æµ‹ï¼Œæ²¡æœ‰éšå˜é‡çº¦æŸ</td>
<td><a href="https://www.ijcai.org/proceedings/2019/616">ğŸ“ƒPaper</a></td>
</tr>
</tbody></table>
<h3 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h3><table>
<thead>
<tr>
<th><strong>Title</strong></th>
<th><strong>Conf/Journal</strong></th>
<th><strong>Description</strong></th>
<th><strong>Links</strong></th>
</tr>
</thead>
<tbody><tr>
<td>A Deep Neural Network for Unsupervised Anomaly Detection and Diagnosis in Multivariate Time Series Data</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1811.08055">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>ALSR: An Adaptive Label Screening and Relearning Approach for Interval-Oriented Anomaly Detection</td>
<td>Expert Systems With Applications</td>
<td>æœ‰ç›‘ç£KPIå¼‚å¸¸æ£€æµ‹ï¼Œä½¿ç”¨ä¸¤é˜¶æ®µè®­ç»ƒæ¥æå‡æ€§èƒ½</td>
<td><a href="https://www.sciencedirect.com/science/article/pii/S0957417419304282">ğŸ“ƒPaper</a> <a href="http://larryshaw0079.coding.me/blog/2019/09/22/ALSR-An-adaptive-label-screening-and-relearning-approach-for-interval-oriented-anomaly-detection/">âœBlog</a></td>
</tr>
<tr>
<td>Time-Series Anomaly Detection Service at Microsoft</td>
<td>KDD19</td>
<td>å°†è§†è§‰å¼‚å¸¸æ£€æµ‹ä¸­çš„è°±æ®‹å·®åº”ç”¨åˆ°äº†æ—¶åºå¼‚å¸¸æ£€æµ‹</td>
<td><a href="https://arxiv.org/pdf/1906.03821">ğŸ“ƒPaper</a> <a href="https://github.com/microsoft/anomalydetector">ğŸ“¥Code</a> <a href="http://larryshaw0079.coding.me/blog/2019/09/22/Time-Series-Anomaly-Detection-Service-at-Microsoft/">âœBlog</a></td>
</tr>
<tr>
<td>Outlier Detection for Multidimensional Time Series using Deep Neural Networks</td>
<td></td>
<td></td>
<td><a href="https://ieeexplore.ieee.org/document/8411269">ğŸ“ƒPaper</a></td>
</tr>
</tbody></table>
<h2 id="General"><a href="#General" class="headerlink" title="General"></a>General</h2><h3 id="Survey"><a href="#Survey" class="headerlink" title="Survey"></a>Survey</h3><ul>
<li><em>Deep Learning for Anomaly Detection: A Survey</em> <a href="https://arxiv.org/abs/1901.03407">[Paper]</a></li>
</ul>
<h3 id="Classic-Machine-Learning-1"><a href="#Classic-Machine-Learning-1" class="headerlink" title="Classic Machine Learning"></a>Classic Machine Learning</h3><table>
<thead>
<tr>
<th><strong>Title</strong></th>
<th><strong>Conf/Journal</strong></th>
<th><strong>Description</strong></th>
<th><strong>Links</strong></th>
</tr>
</thead>
<tbody><tr>
<td>LOF: Identifying Density-Based Local Outliers</td>
<td></td>
<td></td>
<td><a href="https://dl.acm.org/citation.cfm?id=335388">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Isolation Forest</td>
<td></td>
<td></td>
<td><a href="https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Extended Isolation Forest</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1811.02141">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Hidden Markov Anomaly Detection</td>
<td></td>
<td></td>
<td><a href="http://proceedings.mlr.press/v37/goernitz15.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Linear-Time Outlier Detection via Sensitivity</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1605.00519">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Reverse Nearest Neighbors in Unsupervised Distance-Based Outlier Detection</td>
<td></td>
<td></td>
<td><a href="http://ieeexplore.ieee.org/document/6948273">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Theoretical Foundations and Algorithms for Outlier Ensembles</td>
<td></td>
<td></td>
<td><a href="https://www.kdd.org/exploration_files/Article4.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>R1SVM: A Randomised Nonlinear Approach to Large-Scale Anomaly Detection</td>
<td></td>
<td></td>
<td><a href="https://www.aaai.org/ocs/index.php/AAAI/AAAI15/paper/view/9343">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Random Gradient Descent Tree: A Combinatorial Approach for SVM with Outliers</td>
<td></td>
<td></td>
<td><a href="https://www.aaai.org/ocs/index.php/AAAI/AAAI15/paper/view/9477">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Sparse Gaussian Markov Random Field Mixtures for Anomaly Detection</td>
<td></td>
<td></td>
<td><a href="https://ieeexplore.ieee.org/document/7837932/">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Sequential Ensemble Learning for Outlier Detection: A Bias-Variance Perspective</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1609.05528">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Sparse Modeling-Based Sequential Ensemble Learning for Effective Outlier Detection in High-Dimensional Numeric Data</td>
<td></td>
<td></td>
<td><a href="https://aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/16648">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Contextual Spatial Outlier Detection with Metric Learning</td>
<td></td>
<td></td>
<td><a href="https://www.kdd.org/kdd2017/papers/view/contextual-spatial-outlier-detection-with-metric-learning">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Human-Assisted Online Anomaly Detection with Normal Outlier Retraining</td>
<td></td>
<td></td>
<td><a href="https://www.andrew.cmu.edu/user/lakoglu/odd/accepted_papers/ODD_v50_paper_11.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Efficient Anomaly Detection via Matrix Sketching</td>
<td></td>
<td></td>
<td><a href="https://papers.nips.cc/paper/8030-efficient-anomaly-detection-via-matrix-sketching.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Dual-Regularized Multi-View Outlier Detection</td>
<td></td>
<td></td>
<td><a href="https://www.ijcai.org/Proceedings/15/Papers/572.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Deep Anomaly Detection Using Geometric Transformations</td>
<td></td>
<td></td>
<td><a href="https://papers.nips.cc/paper/8183-deep-anomaly-detection-using-geometric-transformations.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Multi-view Anomaly Detection via Robust Probabilistic Latent Variable Models</td>
<td></td>
<td></td>
<td><a href="https://papers.nips.cc/paper/6456-multi-view-anomaly-detection-via-robust-probabilistic-latent-variable-models.pdf">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Partial Multi-View Outlier Detection Based on Collective Learning</td>
<td></td>
<td></td>
<td><a href="https://aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/17166">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Multi-View Anomaly Detection: Neighborhood in Locality Matters</td>
<td></td>
<td></td>
<td><a href="https://www.aaai.org/ojs/index.php/AAAI/article/view/4418">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Latent Discriminant Subspace Representations for Multi-View Outlier Detection</td>
<td></td>
<td></td>
<td><a href="https://aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/17401">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Anomaly Detection with Partially Observed Anomalies</td>
<td></td>
<td></td>
<td><a href="https://dl.acm.org/citation.cfm?id=3184558.3186580">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>One-Class Active Learning for Outlier Detection with Multiple Subspaces</td>
<td></td>
<td></td>
<td><a href="https://dl.acm.org/citation.cfm?id=3357873">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Statistical Analysis of Nearest Neighbor Methods for Anomaly Detection</td>
<td>NIPS19</td>
<td></td>
<td><a href="http://papers.nips.cc/paper/9274-statistical-analysis-of-nearest-neighbor-methods-for-anomaly-detection">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>SNIPER: Few-shot Learning for Anomaly Detection to Minimize False-negative Rate with Ensured True-positive Rate</td>
<td>ICASSP19</td>
<td></td>
<td><a href="https://ieeexplore.ieee.org/document/8683667">ğŸ“ƒPaper</a></td>
</tr>
</tbody></table>
<h3 id="AE-VAE"><a href="#AE-VAE" class="headerlink" title="AE/VAE"></a>AE/VAE</h3><table>
<thead>
<tr>
<th><strong>Title</strong></th>
<th><strong>Conf/Journal</strong></th>
<th><strong>Description</strong></th>
<th><strong>Links</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Estimation of Dimensions Contributing to Detected Anomalies with Variational Autoencoders</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1811.04576">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Anomaly Detection with Robust Deep Autoencoders</td>
<td></td>
<td></td>
<td><a href="https://www.kdd.org/kdd2017/papers/view/anomaly-detection-with-robust-deep-auto-encoders">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Complementary Set Variational Autoencoder for Supervised Anomaly Detection</td>
<td></td>
<td></td>
<td><a href="https://ieeexplore.ieee.org/document/8462181">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>A Two-class Hyper-spherical Autoencoder for Supervised Anomaly Detection</td>
<td></td>
<td></td>
<td><a href="https://ieeexplore.ieee.org/document/8683790">ğŸ“ƒPaper</a></td>
</tr>
</tbody></table>
<h3 id="GAN-1"><a href="#GAN-1" class="headerlink" title="GAN"></a>GAN</h3><table>
<thead>
<tr>
<th><strong>Title</strong></th>
<th><strong>Conf/Journal</strong></th>
<th><strong>Description</strong></th>
<th><strong>Links</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Adversarially Learned Anomaly Detection</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1812.02288">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>AMAD: Adversarial Multiscale Anomaly Detection on High-Dimensional and Time-Evolving Categorical Data</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1907.06582">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Adversarially Learned One-Class Classifier for Novelty Detection</td>
<td></td>
<td></td>
<td><a href="http://openaccess.thecvf.com/content_cvpr_2018/papers/Sabokrou_Adversarially_Learned_One-Class_CVPR_2018_paper.pdf">ğŸ“ƒPaper</a> <a href="https://github.com/khalooei/ALOCC-CVPR2018">ğŸ“¥Code</a></td>
</tr>
<tr>
<td>Generative Probabilistic Novelty Detection with Adversarial Autoencoders</td>
<td></td>
<td></td>
<td><a href="https://papers.nips.cc/paper/7915-generative-probabilistic-novelty-detection-with-adversarial-autoencoders.pdf">ğŸ“ƒPaper</a> <a href="https://github.com/podgorskiy/GPND">ğŸ“¥Code</a></td>
</tr>
<tr>
<td>OCGAN: One-class Novelty Detection Using GANs with Constrained Latent Representations</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1903.08550">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Fence GAN: Towards Better Anomaly Detection</td>
<td>Arxiv</td>
<td></td>
<td><a href="https://arxiv.org/abs/1904.01209">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Anomaly Detection via Minimum Likelihood Generative Adversarial Networks</td>
<td>Arxiv</td>
<td></td>
<td><a href="https://arxiv.org/abs/1808.00200">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>DOPING: Generative Data Augmentation for Unsupervised Anomaly Detection with GAN</td>
<td>ICDM18</td>
<td></td>
<td><a href="https://ieeexplore.ieee.org/document/8594955">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Learning Competitive and Discriminative Reconstructions for Anomaly Detection</td>
<td>AAAI19</td>
<td></td>
<td><a href="https://www.aaai.org/ojs/index.php/AAAI/article/view/4451">ğŸ“ƒPaper</a></td>
</tr>
</tbody></table>
<h3 id="Miscellaneous-1"><a href="#Miscellaneous-1" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h3><table>
<thead>
<tr>
<th><strong>Title</strong></th>
<th><strong>Conf/Journal</strong></th>
<th><strong>Description</strong></th>
<th><strong>Links</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Deep Structured Energy Based Models for Anomaly Detection</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1605.07717">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Anomaly Detection using One-Class Neural Networks</td>
<td></td>
<td></td>
<td><a href="https://arxiv.org/pdf/1802.06360">ğŸ“ƒPaper</a> <a href="https://github.com/raghavchalapathy/oc-nn">ğŸ“¥Code</a></td>
</tr>
<tr>
<td>High-dimensional and large-scale anomaly detection using a linear one-class SVM with deep learning</td>
<td></td>
<td></td>
<td><a href="https://www.sciencedirect.com/science/article/pii/S0031320316300267">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Deep Autoencoding Gaussian Mixture Model for Unsupervised Anomaly Detection</td>
<td></td>
<td></td>
<td><a href="https://openreview.net/pdf?id=BJJLHbb0-">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Deep Anomaly Detection with Outlier Exposure</td>
<td></td>
<td></td>
<td><a href="https://openreview.net/forum?id=HyxCxhRcY7">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Are Generative Deep Models for Novelty Detection Truly Better?</td>
<td>KDD18 Workshop</td>
<td></td>
<td><a href="https://arxiv.org/abs/1807.05027">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Probabilistic-Mismatch Anomaly Detection: Do oneâ€™s Medications Match with the Diagnoses?</td>
<td>ICDM16</td>
<td></td>
<td><a href="https://ieeexplore.ieee.org/document/7837890">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Deep Anomaly Detection with Deviation Networks</td>
<td>KDD19</td>
<td></td>
<td><a href="https://dl.acm.org/doi/10.1145/3292500.3330871">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Weakly-supervised Deep Anomaly Detection with Pairwise Relation Learning</td>
<td>AAAI20</td>
<td></td>
<td><a href="https://arxiv.org/abs/1910.13601">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Transfer Anomaly Detection by Inferring Latent Domain Representations</td>
<td>NIPS19</td>
<td></td>
<td><a href="http://papers.nips.cc/paper/8517-transfer-anomaly-detection-by-inferring-latent-domain-representations">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Multi-view Anomaly Detection via Robust Probabilistic Latent Variable Models</td>
<td>NIPS16</td>
<td></td>
<td><a href="http://papers.nips.cc/paper/6456-multi-view-anomaly-detection-via-robust-probabilistic-latent-variable-models">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>Continual Learning for Anomaly Detection with Variational Autoencoder</td>
<td>ICASSP19</td>
<td></td>
<td><a href="https://ieeexplore.ieee.org/document/8682702">ğŸ“ƒPaper</a></td>
</tr>
<tr>
<td>AdaFlow: Domain-adaptive Density Estimator with Application to Anomaly Detection and Unpaired Cross-domain Translation</td>
<td>ICASSP19</td>
<td></td>
<td><a href="https://ieeexplore.ieee.org/document/8683072">ğŸ“ƒPaper</a></td>
</tr>
</tbody></table>
<h2 id="Graph"><a href="#Graph" class="headerlink" title="Graph"></a>Graph</h2><ul>
<li><em>AddGraph: Anomaly Detection in Dynamic Graph Using Attention-based Temporal GCN</em> <a href="https://www.ijcai.org/proceedings/2019/614">[Paper]</a></li>
<li><em>Outlier Detection in Graph Streams</em> <a href="https://ieeexplore.ieee.org/document/5767885">[Paper]</a></li>
<li><em>NetWalk: A Flexible Deep Embedding Approach for Anomaly Detection in Dynamic Networks</em> <a href="https://www.kdd.org/kdd2018/accepted-papers/view/netwalk-a-flexible-deep-embedding-approach-for-anomaly-detection-in-dynamic">[Paper]</a></li>
<li><em>Anomaly Detection in Dynamic Networks using Multi-view Time-Series Hypersphere Learning</em> <a href="https://dl.acm.org/citation.cfm?id=3132964">[Paper]</a></li>
</ul>
<h1 id="Related"><a href="#Related" class="headerlink" title="Related"></a>Related</h1><p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯ä¸€äº›éå¼‚å¸¸æ£€æµ‹æ–‡ç« ï¼Œä½†æ˜¯å¯ä»¥ç”¨æ¥è§£å†³å¼‚å¸¸æ£€æµ‹ä¸­çš„é—®é¢˜çš„ç›¸å…³æ–‡ç« ã€‚</p>
<h2 id="Infrastructure"><a href="#Infrastructure" class="headerlink" title="Infrastructure"></a>Infrastructure</h2><h3 id="GAN-2"><a href="#GAN-2" class="headerlink" title="GAN"></a>GAN</h3><ul>
<li><em>Generative Adversarial Networks</em> <a href="https://arxiv.org/abs/1406.2661">[Paper]</a></li>
</ul>
<h4 id="VAE-amp-GAN-Combination"><a href="#VAE-amp-GAN-Combination" class="headerlink" title="VAE &amp; GAN Combination"></a>VAE &amp; GAN Combination</h4><ul>
<li><em>Variational Approaches for Auto-Encoding Generative Adversarial Networks</em> <a href="https://arxiv.org/abs/1706.04987">[Paper]</a></li>
<li><em>Adversarial Variational Bayes: Unifying Variational Autoencoders and Generative Adversarial Networks</em> <a href="https://arxiv.org/abs/1701.04722">[Paper]</a></li>
<li><em>On Unifying Deep Generative Models</em> <a href="https://arxiv.org/abs/1706.00550">[Paper]</a></li>
</ul>
<h4 id="Bidirectional-GANs"><a href="#Bidirectional-GANs" class="headerlink" title="Bidirectional GANs"></a>Bidirectional GANs</h4><ul>
<li><em>Adversarial Feature Learning</em> [[Paper]](Adversarial Feature Learning)</li>
<li><em>Adversarially Learned Inference</em> <a href="https://arxiv.org/abs/1606.00704">[Paper]</a></li>
<li><em>It Takes (Only) Two: Adversarial Generator-Encoder Networks</em> <a href="https://arxiv.org/abs/1704.02304">[Paper]</a></li>
</ul>
<h3 id="VAE-1"><a href="#VAE-1" class="headerlink" title="VAE"></a>VAE</h3><ul>
<li><em>Auto-Encoding Variational Bayes</em> <a href="https://arxiv.org/abs/1312.6114">[Paper]</a></li>
</ul>
<h2 id="Class-Imbalance"><a href="#Class-Imbalance" class="headerlink" title="Class Imbalance"></a>Class Imbalance</h2><ul>
<li><em>Focal Loss for Dense Object Detection</em> <a href="https://arxiv.org/abs/1708.02002">[Paper]</a></li>
<li><em>Gradient Harmonized Single-stage Detector</em> <a href="https://arxiv.org/abs/1811.05181">[Paper]</a></li>
</ul>
<h2 id="Stochastic-Temporal-Modeling"><a href="#Stochastic-Temporal-Modeling" class="headerlink" title="Stochastic Temporal Modeling"></a>Stochastic Temporal Modeling</h2><ul>
<li><em>Sequential Neural Models with Stochastic Layers</em> <a href="https://arxiv.org/abs/1605.07571">[Paper]</a></li>
<li><em>A Recurrent Latent Variable Model for Sequential Data</em> <a href="https://papers.nips.cc/paper/5653-a-recurrent-latent-variable-model-for-sequential-data">[Paper]</a></li>
<li><em>Deep State Space Models for Time Series Forecasting</em> <a href="https://papers.nips.cc/paper/8004-deep-state-space-models-for-time-series-forecasting">[Paper]</a></li>
<li><em>Bayesian Recurrent Neural Networks</em> <a href="https://arxiv.org/abs/1704.02798">[Paper]</a></li>
</ul>
<h2 id="Detection-without-Closed-form-Likelihood"><a href="#Detection-without-Closed-form-Likelihood" class="headerlink" title="Detection without Closed-form Likelihood"></a>Detection without Closed-form Likelihood</h2><h3 id="Reconstruction"><a href="#Reconstruction" class="headerlink" title="Reconstruction"></a>Reconstruction</h3><ul>
<li><em>Adversarially Learned One-Class Classifier for Novelty Detection</em> <a href="https://arxiv.org/abs/1802.09088">[Paper]</a></li>
<li><em>Generative Adversarial Network Based Novelty Detection Using Minimized Reconstruction Error</em> <a href="https://link.springer.com/article/10.1631/FITEE.1700786">[Paper]</a></li>
<li><em>Learning Discriminative Reconstructions for Unsupervised Outlier Removal</em> <a href="https://ieeexplore.ieee.org/document/7410534">[Paper]</a></li>
</ul>
<h3 id="Discriminator"><a href="#Discriminator" class="headerlink" title="Discriminator"></a>Discriminator</h3><ul>
<li><em>A Lipschitz-constrained Anomaly Discriminator Framework</em> <a href="https://arxiv.org/abs/1905.10710">[Paper]</a></li>
</ul>
<h3 id="Out-of-distribution"><a href="#Out-of-distribution" class="headerlink" title="Out-of-distribution"></a>Out-of-distribution</h3><ul>
<li><em>Enhancing The Reliability of Out-of-distribution Image Detection in Neural Networks</em> <a href="https://arxiv.org/abs/1706.02690">[Paper]</a></li>
<li><em>Learning Confidence for Out-of-Distribution Detection in Neural Networks</em> <a href="https://arxiv.org/abs/1802.04865">[Paper]</a></li>
<li><em>A Baseline for Detecting Misclassified and Out-of-Distribution Examples in Neural Networks</em> <a href="https://arxiv.org/abs/1610.02136">[Paper]</a></li>
<li><em>A Simple Unified Framework for Detecting Out-of-Distribution Samples and Adversarial Attacks</em> <a href="https://arxiv.org/abs/1807.03888">[Paper]</a></li>
</ul>
<h2 id="GANs-for-Incomplete-Data"><a href="#GANs-for-Incomplete-Data" class="headerlink" title="GANs for Incomplete Data"></a>GANs for Incomplete Data</h2><ul>
<li><em>AmbientGAN: Generative Models From Lossy Measurements</em> <a href="https://openreview.net/forum?id=Hy7fDog0b">[Paper]</a></li>
<li><em>MisGAN: Learning from Incomplete Data with Generative Adversarial Networks</em> <a href="https://openreview.net/forum?id=S1lDV3RcKm">[Paper]</a></li>
</ul>
<h1 id="Dataset"><a href="#Dataset" class="headerlink" title="Dataset"></a>Dataset</h1><p>è¯¦è§<a href="http://qfxiao.me/2020/02/03/Datasets-for-Time-Series-Anomaly-Detection/ã€‚">http://qfxiao.me/2020/02/03/Datasets-for-Time-Series-Anomaly-Detection/ã€‚</a></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/"><img class="thumbnail" src="http://qfxiao.me/img/image-20200106141915707.png" alt="Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-01-06T05:09:32.000Z" title="2020-01-06T05:09:32.000Z">2020-01-06</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">18 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2770 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/01/06/Unsupervised-Anomaly-Detection-for-Intricate-KPIs-via-Adversarial-Training-of-VAE/">Unsupervised Anomaly Detection for Intricate KPIs via Adversarial Training of VAE</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p><a href="https://ieeexplore.ieee.org/abstract/document/8737430/">è®ºæ–‡ğŸ“ƒ</a></p>
<p><a href="https://github.com/yantijin/Buzz">ä»£ç ğŸ“¥</a></p>
<p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§åˆ©ç”¨å¯¹æŠ—è®­ç»ƒæ¥è¿›è¡Œæ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„æ–¹æ³•<em>Buzz</em>ã€‚ä½œè€…è®¤ä¸ºåœ¨ç°å®ä¸­å¤æ‚çš„KPIæ•°æ®å¤§é‡å­˜åœ¨ï¼Œè¿™ç§æ•°æ®é€šå¸¸å¸¦æœ‰éé«˜æ–¯åˆ†å¸ƒçš„å™ªå£°ï¼ŒåŒæ—¶æ•°æ®åˆ†å¸ƒå¤æ‚ï¼Œå¯¼è‡´ä¸€èˆ¬çš„ç”Ÿæˆå¼æ¨¡å‹æ— æ³•å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„å»ºæ¨¡ï¼Œæ‰€ä»¥ä½œè€…æå‡ºäº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„æ¨¡å‹ã€‚åœ¨æ–‡ä¸­ï¼Œä½œè€…çš„åˆ›æ–°ç‚¹ä¸»è¦æœ‰ä¸‰ä¸ªï¼š</p>
<ol>
<li>ä¸ºäº†å¤„ç†å¤æ‚æ•°æ®ï¼Œå°†æ•°æ®ç©ºé—´åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼Œåœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šè¿›è¡Œè·ç¦»çš„åº¦é‡ï¼›</li>
<li>é‡‡ç”¨<em>Wasserstein</em>è·ç¦»åº¦é‡æ¨¡å‹å»ºæ¨¡çš„åˆ†å¸ƒå’ŒçœŸå®åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼›</li>
<li>å»ºç«‹äº†åŸºäºå¯¹æŠ—è®­ç»ƒçš„<em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒVAEä¹‹é—´çš„å…³ç³»ã€‚</li>
</ol>
<p><img src="http://qfxiao.me/img/image-20200106141915707.png" alt=""></p>
<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><h2 id="Anomaly-Detection"><a href="#Anomaly-Detection" class="headerlink" title="Anomaly Detection"></a>Anomaly Detection</h2><p>å¯¹äºä»»æ„æ—¶é—´$t$ï¼Œç»™å®šå†å²è§‚å¯Ÿå€¼$x_{t-T+1},\cdots,x_t$ï¼Œç¡®å®šå¼‚å¸¸æ˜¯å¦å‘ç”Ÿ(è®°ä¸º$y_t=1$)ã€‚é€šå¸¸æ¥æ”¶å¼‚å¸¸æ£€æµ‹ç®—æ³•ç»™å‡ºçš„æ˜¯å‘ç”Ÿå¼‚å¸¸çš„å¯èƒ½æ€§ï¼Œå¦‚$p(y_t=1|x_{t-T+1},\cdots,x_t)$ã€‚</p>
<h2 id="VAE"><a href="#VAE" class="headerlink" title="VAE"></a>VAE</h2><table>
<thead>
<tr>
<th><strong>Model</strong></th>
<th><strong>Latent</strong></th>
<th><strong>Data</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong><em>Auto-encoder (AE)</em></strong></td>
<td><code>None</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr>
<td><strong><em>Variational Auto-encoder (VAE)</em></strong></td>
<td><code>KL Divergence</code></td>
<td><code>Log Likelihood</code></td>
</tr>
<tr>
<td><strong><em>Adversarial Auto-encoder (AAE)</em></strong></td>
<td><code>Discriminator</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr>
<td><strong><em>Wasserstein Auto-encoder (WAE)</em></strong></td>
<td><code>MaxMeanDiscrepancy</code> or <code>Discriminator</code></td>
<td><code>L1Loss</code></td>
</tr>
<tr>
<td><strong><em>AlphaGAN</em></strong></td>
<td><code>Discriminator</code></td>
<td><code>Discriminator</code>+<code>L1Loss</code></td>
</tr>
</tbody></table>
<h2 id="GAN-and-WGAN-GP"><a href="#GAN-and-WGAN-GP" class="headerlink" title="GAN and WGAN-GP"></a>GAN and WGAN-GP</h2><p>åŸå§‹GANç­‰ä»·äºä¼˜åŒ–ï¼š<br>$$<br>\mathbb{E}<em>{x\sim P_r}\log{\frac{P_r(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}+\mathbb{E}</em>{x\sim P_g}\log{\frac{P_g(x)}{\frac{1}{2}\left[P_r(x)+P_g(x)\right]}}<br>$$<br>æ ¹æ®KLæ•£åº¦å’ŒJSæ•£åº¦çš„å®šä¹‰ï¼š<br>$$<br>\text{KL}(P_1\parallel P_2)=\mathbb{E}_{x\sim P_1}\log{\frac{P_1}{P_2}}<br>$$</p>
<p>$$<br>\text{JS}(P_1\parallel P_2)=\frac{1}{2}\text{KL}(P_1\parallel \frac{P_1+P_2}{2})+\frac{1}{2}\text{KL}(P_2\parallel \frac{P_1+P_2}{2})<br>$$</p>
<p>å¯é‡å†™ä¸ºï¼š<br>$$<br>2\text{JS}(P_r\parallel P_g)-2\log 2<br>$$<br>å½“$P_r$ä¸$P_g$çš„æ”¯æ’‘é›†ï¼ˆsupportï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­çš„ä½ç»´æµå½¢ï¼ˆmanifoldï¼‰æ—¶ï¼Œ$P_r$ä¸$P_g$é‡å éƒ¨åˆ†æµ‹åº¦ï¼ˆmeasureï¼‰ä¸º0çš„æ¦‚ç‡ä¸º1ã€‚</p>
<ul>
<li>æ”¯æ’‘é›†ï¼ˆsupportï¼‰å…¶å®å°±æ˜¯å‡½æ•°çš„éé›¶éƒ¨åˆ†å­é›†ï¼Œæ¯”å¦‚<code>ReLU</code>å‡½æ•°çš„æ”¯æ’‘é›†å°±æ˜¯[å…¬å¼]ï¼Œä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„æ”¯æ’‘é›†å°±æ˜¯æ‰€æœ‰æ¦‚ç‡å¯†åº¦éé›¶éƒ¨åˆ†çš„é›†åˆã€‚</li>
<li>æµå½¢ï¼ˆmanifoldï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­æ›²çº¿ã€æ›²é¢æ¦‚å¿µçš„æ‹“å¹¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä½ç»´ä¸Šç›´è§‚ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œæ¯”å¦‚æˆ‘ä»¬è¯´ä¸‰ç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªæ›²é¢æ˜¯ä¸€ä¸ªäºŒç»´æµå½¢ï¼Œå› ä¸ºå®ƒçš„æœ¬è´¨ç»´åº¦ï¼ˆintrinsic dimensionï¼‰åªæœ‰2ï¼Œä¸€ä¸ªç‚¹åœ¨è¿™ä¸ªäºŒç»´æµå½¢ä¸Šç§»åŠ¨åªæœ‰ä¸¤ä¸ªæ–¹å‘çš„è‡ªç”±åº¦ã€‚åŒç†ï¼Œä¸‰ç»´ç©ºé—´æˆ–è€…äºŒç»´ç©ºé—´ä¸­çš„ä¸€æ¡æ›²çº¿éƒ½æ˜¯ä¸€ä¸ªä¸€ç»´æµå½¢ã€‚</li>
<li>æµ‹åº¦ï¼ˆmeasureï¼‰æ˜¯é«˜ç»´ç©ºé—´ä¸­é•¿åº¦ã€é¢ç§¯ã€ä½“ç§¯æ¦‚å¿µçš„æ‹“å¹¿ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œè¶…ä½“ç§¯â€ã€‚</li>
</ul>
<p><em>Wasserstein</em>è·ç¦»å®šä¹‰å¦‚ä¸‹ï¼š<br>$$<br>W(P_r,P_g)=\inf\limits_{\gamma\sim\prod(P_r,P_g)}\mathbb{E}<em>{(x,y)\sim \gamma}\left[\parallel x-y\parallel\right]<br>$$<br>ä¸‹ç¡®ç•Œ$\inf$æ²¡æ³•ç›´æ¥æ±‚è§£ï¼Œä¸è¿‡æ ¹æ®ç›¸å…³å®šç†å…¶ç­‰ä»·äºï¼š<br>$$<br>W(P_r,P_g)=\frac{1}{K}\sup\limits</em>{\parallel f\parallel_L\leq K}\mathbb{E}<em>{x\sim P_r}[f(x)]-\mathbb{E}</em>{x\sim P_g}[f(x)]<br>$$<br><em>Lipschitz</em>è¿ç»­æ˜¯æŒ‡å­˜åœ¨ä¸€ä¸ªå¸¸æ•°$K\geq 0$ä½¿å¾—å®šä¹‰åŸŸå†…ä»»æ„ä¸¤ä¸ªå…ƒç´ $x_1$å’Œ$x_2$éƒ½æ»¡è¶³ï¼š<br>$$<br>|f(x_1)-f(x_2)|\leq K|x_1-x_2|<br>$$<br>WANçš„æŸå¤±å‡½æ•°ï¼š<br>$$<br>\mathcal{L}=\mathop{\mathbb{E}}\limits_{\mathbf{x}\sim\mathbb{P}<em>g}\left[D({\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits</em>{\mathbf{x}\sim\mathbb{P}<em>r}\left[D(\mathbf{x})\right]<br>$$<br>WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>\mathcal{L}=\mathop{\mathbb{E}}\limits</em>{\tilde{\mathbf{x}}\sim\mathbb{P}<em>g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits</em>{\mathbf{x}\sim\mathbb{P}<em>r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits</em>{\hat{\mathbf{x}}\sim\mathbb{P}<em>{\hat{\mathbf{x}}}}\left[(\parallel\nabla</em>{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]<br>$$</p>
<h1 id="Proposed-Method"><a href="#Proposed-Method" class="headerlink" title="Proposed Method"></a>Proposed Method</h1><p>ä¸‹å›¾ä¸º<em>Buzz</em>çš„æ€»ä½“æµç¨‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200106141958376.png" alt=""></p>
<p>æ•°æ®ä¼šé¦–å…ˆè¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼Œä¹‹åè¿›è¡Œè®­ç»ƒã€‚åœ¨æ£€æµ‹é˜¶æ®µä¼šæ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥åˆ¤å®šå¼‚å¸¸ã€‚</p>
<h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2><p>åœ¨æ–‡ä¸­ï¼Œæœ€å…³é”®çš„ä¸¤ä¸ªåˆ›æ–°ç‚¹åˆ†åˆ«æ˜¯<em>Wasserstein</em>è·ç¦»å’Œå¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œåˆ†åŒºçš„æ–¹æ³•ã€‚</p>
<ul>
<li><p>åœ¨ä½¿ç”¨è·ç¦»åº¦é‡æ–¹é¢ï¼Œ å› ä¸º<em>Wasserstein</em>åœ¨WGANä¸­å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœï¼Œæ˜¯ä¸€ç§é²æ£’çš„è·ç¦»åº¦é‡ï¼Œæ‰€ä»¥ä½œè€…åœ¨æ–‡ä¸­é‡‡ç”¨äº†<em>Wasserstein</em>è·ç¦»æ¥è¡¡é‡ç”Ÿæˆçš„åˆ†å¸ƒå’ŒçœŸå®çš„åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå¹¶ç”±æ­¤å¼•å…¥äº†å¯¹æŠ—è®­ç»ƒï¼›</p>
</li>
<li><p>åœ¨åˆ†åŒºæ–¹æ³•æ–¹é¢ï¼Œä½œè€…è®¤ä¸ºåŸå§‹æ•°æ®è¿‡äºå¤æ‚ï¼Œæ‰€ä»¥å°†æ•°æ®ç©ºé—´$\mathcal{X}$è¿›è¡Œåˆ’åˆ†ï¼Œç„¶ååœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šä½¿ç”¨<em>Wasserstein</em>åº¦é‡è·ç¦»ï¼Œè€Œæ€»ä½“çš„è·ç¦»ç”±æ¯ä¸ªåˆ†åŒºçš„è·ç¦»çš„æœŸæœ›æ±‚å¾—ã€‚</p>
</li>
</ul>
<p>ä½œè€…è¿˜å‘ç°ï¼Œå½“åˆ’åˆ†åœ°è¶Šæ¥è¶Šç»†æ—¶ï¼Œæ€»ä½“è·ç¦»æ¥è¿‘äºç‰¹å®šå½¢å¼çš„VAEçš„é‡æ„è¯¯å·®é¡¹ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20200106142008894.png" alt=""></p>
<h2 id="Network-Structure"><a href="#Network-Structure" class="headerlink" title="Network Structure"></a>Network Structure</h2><p>ä¸‹å›¾ä¸ºæ¨¡å‹çš„ç½‘ç»œç»“æ„ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200106142018827.png" alt=""></p>
<h2 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h2><h3 id="Objective-Function"><a href="#Objective-Function" class="headerlink" title="Objective Function"></a>Objective Function</h3><p>å…ˆå®šä¹‰ä¸€äº›ç¬¦å·ï¼š</p>
<ul>
<li>$b$å’Œ$s$åˆ†åˆ«ä¸ºBatchçš„å¤§å°å’Œé‚»å±…çš„å¤§å°ï¼Œæ•°æ®é›†æŒ‰$s$è¿›è¡Œåˆ‡åˆ†ï¼Œç„¶åéšæœºæ‰“ä¹±ï¼Œæ¯ä¸ªBatchåŒ…å«$b$ä¸ª$s$ï¼Œä¹‹å$s/=2,b*=2$ï¼›</li>
<li>$\mathcal{W}={w_1,w_2,\cdots,w_b}$ä¸ºä¸€ä¸ªBatchï¼Œä¸”æ»¡è¶³æ¯ä¸ª$w_i$æ˜¯$s$çš„å€æ•°ï¼›</li>
<li>$w\in\mathcal{W}$çš„é‚»åŸŸé›†(neighborhood set)ä¸ºä¸€ä¸ªæ—¶é—´ä¸Šçš„partitionï¼Œè®°ä¸º${w,w+1,\cdots,w+s-1}$</li>
<li>$\mathbf{x}^{(w)},\mathbf{x}^{(w+1)},\cdots,\mathbf{x}^{(w+s-1)}$ä¸ºåœ¨ç©ºé—´$\mathcal{X}$ä¸Šçš„ä¸€ä¸ªpartitionï¼Œè®°ä¸º$S_w$ï¼Œå…¶ä¸­$\mathbf{x}^{(w)}$è¡¨ç¤ºä»¥$w$ä¸ºç»“å°¾çš„æ—¶é—´çª—å£ã€‚</li>
</ul>
<p><em>Buzz</em>çš„æŸå¤±å‡½æ•°å’ŒWGAN-GPç±»ä¼¼ï¼Œä½†åšäº†ä¸€äº›æ”¹è¿›ï¼Œç”±ä¸‹é¢å››éƒ¨åˆ†ç»„æˆï¼Œä¸‹é¢åˆ†åˆ«è§£é‡Šã€‚</p>
<p>ç¬¬ä¸€ä¸ªæ˜¯æ¯ä¸€ä¸ªpartitionçš„$\mathbf{z}$åéªŒçš„KLæ•£åº¦ï¼š<br>$$<br>\mathcal{K} = \frac{1}{bs}\sum\limits_{w\in\mathcal{W}}\sum\limits_{i=1}^{s-1}\text{KL}\left[q_\phi(\mathbf{z}|\mathbf{x})\parallel\mathcal{N}(\mathbf{0},\mathbf{1})\right]<br>$$</p>
<p>ç¬¬äºŒä¸ªåœ¨è®­ç»ƒæ—¶æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼š<br>$$<br>Z(\lambda) = \frac{\Gamma(W)}{\Gamma(\frac{W}{2})}2\pi^{\frac{W}{2}}\lambda^{-W}<br>$$</p>
<p>å…¶ä¸­$\Gamma$æ˜¯<em>Gamma</em>å‡½æ•°ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªæ˜¯<em>Wasserstein</em>è·ç¦»ï¼š<br>$$<br>\mathcal{T}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}_{q_\phi(\mathbf{z}|\mathbf{x}^{w+i})}\left[F(\mathbf{x}^{(w+i)})-F(G(\mathbf{z}))\right]<br>$$</p>
<p>ç¬¬å››ä¸ªæ˜¯<em>Gradient Penalty</em>ï¼š</p>
<p>$$<br>\mathcal{R}(F,w)=\frac{1}{bs}\sum\limits_{i=1}^{s-1}\mathbb{E}<em>{q_\phi(\mathbf{z}|\mathbf{x}^{(w+i)})}\left[\mathbb{E}</em>{\varepsilon\sim[0,1]}(\parallel\nabla_{\hat{\mathbf{x}}}(\hat{\mathbf{x}})\parallel-\mathbf{1})^2\right]<br>$$</p>
<p>å…¶ä¸­$\hat{\mathbf{x}}=\varepsilon \mathbf{x}^{w+i}+(1-\varepsilon)G(\mathbf{z})$ä¸ºç”Ÿæˆæ•°æ®ä¸çœŸå®æ•°æ®çš„æ’å€¼ã€‚</p>
<blockquote>
<p>åŸå§‹çš„WGAN-GPçš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>L=\mathop{\mathbb{E}}\limits_{\tilde{\mathbf{x}}\sim\mathbb{P}<em>g}\left[D(\tilde{\mathbf{x}})\right]-\mathop{\mathbb{E}}\limits</em>{\mathbf{x}\sim\mathbb{P}<em>r}\left[D(\mathbf{x})\right] + \lambda\mathop{\mathbb{E}}\limits</em>{\hat{\mathbf{x}}\sim\mathbb{P}<em>{\hat{\mathbf{x}}}}\left[(\parallel\nabla</em>{\hat{\mathbf{x}}}D(\hat{\mathbf{x}})\parallel_2-1)^2\right]<br>$$<br>å…¶ä¸­$\mathbb{P}<em>g$ä¸ºç”Ÿæˆå™¨çš„åˆ†å¸ƒï¼Œ$\mathbb{P}_r$ä¸ºçœŸå®åˆ†å¸ƒï¼Œ$\mathbb{P}</em>{\hat{\mathbf{x}}}$ä¸ºçœŸå®æ•°æ®å’Œç”Ÿæˆæ•°æ®æ’å€¼å¾—åˆ°çš„åˆ†å¸ƒã€‚</p>
</blockquote>
<p>$$<br>\hat{\mathcal{L}}<em>{Buzz}=-\lambda\sup\limits_F\left[\sum\limits</em>{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)<br>$$</p>
<h3 id="Training-Procedure"><a href="#Training-Procedure" class="headerlink" title="Training Procedure"></a>Training Procedure</h3><p><em>Buzz</em>çš„è®­ç»ƒè¿‡ç¨‹ä¸WGAN-GPç±»ä¼¼ï¼Œ</p>
<h2 id="Detection"><a href="#Detection" class="headerlink" title="Detection"></a>Detection</h2><p>æ–‡ä¸­å‡è®¾è§£ç å™¨çš„è¾“å‡ºæœä»å¦‚ä¸‹åˆ†å¸ƒï¼š</p>
<p>$$<br>p_\theta(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel}<br>$$</p>
<p>ä½œè€…å®šä¹‰å¼‚å¸¸åˆ†æ•°ä¸ºï¼š<br>$$<br>\mathcal{S}=\log p_\theta(\mathbf{x})-\log p_\theta(\bar{\mathbf{x}})<br>$$<br>å…¶ä¸­$\bar{\mathbf{x}}$ä¸ºç»è¿‡MCMCå¡«å……åçš„æ ·æœ¬ã€‚</p>
<p>å¼‚å¸¸åˆ†æ•°ä¹Ÿå¯ä»¥å±•å¼€ä¸ºï¼š<br>$$<br>\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\mathbf{x}|\mathbf{z^{(l)}})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]-\log\frac{1}{L}\sum\limits_{l=1}^L\left[\frac{p_\theta(\bar{\mathbf{x}}|\mathbf{z}^{(l)})p_\theta(\mathbf{z}^{(l)})}{q_\phi(\mathbf{z}^{(l)}|\bar{\mathbf{x}})}\right]<br>$$</p>
<p>æœ€ç»ˆç®—æ³•æµç¨‹å›¾ä¸ºï¼š</p>
<p><img src="http://qfxiao.me/img/image-20200106142053342.png" alt=""></p>
<h2 id="Theoretical-Analysis"><a href="#Theoretical-Analysis" class="headerlink" title="Theoretical Analysis"></a>Theoretical Analysis</h2><p>åœ¨ç†è®ºåˆ†æä¸­ï¼Œä½œè€…ä¸»è¦æ˜¯æƒ³å»ºç«‹$\mathcal{L}<em>{Buzz}$å’ŒVAEçš„æŸå¤±å‡½æ•°$\mathcal{L}</em>{vae}$ä¹‹é—´çš„è”ç³»ï¼ŒæŸå¤±å‡½æ•°$\mathcal{\hat{L}}_{Buzz}$ä¸ºï¼š</p>
<p>$$<br>\hat{\mathcal{L}}<em>{Buzz}=-\lambda\sup\limits_F\left[\sum\limits</em>{w\in\mathcal{W}}(\left|\mathcal{T}(F,w)\right|-\eta\mathcal{R}(F,w))\right]-\mathcal{K}-\log Z(\lambda)<br>$$</p>
<p>ä¸ºäº†ä¾¿äºåˆ†æï¼Œå»æ‰<em>Gradient Penalty</em>çš„éƒ¨åˆ†ï¼Œå…¬å¼å¯ç®€åŒ–ä¸ºï¼š</p>
<p>$$<br>\mathcal{L}<em>{Buzz}=-\lambda\mathbb{E}</em>{p(w)}W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]-\mathcal{K}-\log Z(\lambda)<br>$$</p>
<p>å®é™…ä¸Š$Z(\lambda)=\mathfrak{S}_W\Gamma(W)\lambda^{-W}$ï¼Œå…¶ä¸­$\mathfrak{S}_W$ä¸º$W$ç»´å•ä½çƒçš„è¡¨é¢ç§¯ã€‚</p>
<blockquote>
<p>$n$ç»´ç©ºé—´å•ä½çƒè¡¨é¢ç§¯å…¬å¼ï¼š<br>$$<br>\omega_n=\frac{2\pi^{\frac{n}{2}}}{\Gamma(\frac{n}{2})}<br>$$</p>
</blockquote>
<p>è€Œ$W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]$ä¸º<em>Wasserstein</em>è·ç¦»ï¼š<br>$$<br>W^1\left[P(\mathbf{x}|w)\parallel P(\mathbf{y}|w)\right]=\sup\limits_{Lip(f)\leq 1}\left{\int_\mathcal{X}f(\mathbf{x})p(\mathbf{x}|w)\mathrm{d}\mathbf{x}-\int_\mathcal{X}f(\mathbf{y})p(\mathbf{y}|w)\mathrm{d}\mathbf{y}\right}<br>$$</p>
<h3 id="Lemma-1"><a href="#Lemma-1" class="headerlink" title="Lemma 1"></a>Lemma 1</h3><p>é€šè¿‡è®¾å®šå…·ä½“å½¢å¼çš„åéªŒåˆ†å¸ƒï¼ŒVAEçš„æŸå¤±å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p>
<blockquote>
<p>è®¾$\mathbf{x}$çš„åéªŒåˆ†å¸ƒ$p(\mathbf{x}|\mathbf{z})=\frac{1}{Z(\lambda)}\exp{-\lambda\parallel\mathbf{x}-G(\mathbf{z})\parallel}$ï¼Œé‚£ä¹ˆVAEçš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>$$<br>\mathcal{L}<em>{vae}=\lambda\mathbb{E}</em>{p(w)}\left[\mathbb{E}<em>{p(\mathbf{x}|w)}\mathbb{E}</em>{p_G(\mathbf{y}|\mathbf{x})}-\parallel\mathbf{x}-\mathbf{y}\parallel\right]-\mathcal{K}-\log{Z(\lambda)}<br>$$</p>
</blockquote>
<p>åéªŒåˆ†å¸ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªLaplaceåˆ†å¸ƒï¼š</p>
<blockquote>
<p><strong>Laplace Distribution</strong>:<br>$$<br>f(x|\theta,\lambda)=\frac{1}{2\lambda}\exp{\left(-\frac{|x-\theta|}{\lambda}\right)}<br>$$</p>
</blockquote>
<p>å¯ä»¥ç›´æ¥æŠŠåéªŒåˆ†å¸ƒå¸¦å…¥VAEçš„æŸå¤±å‡½æ•°å°±å¾—åˆ°äº†ã€‚</p>
<h3 id="Lemma-2"><a href="#Lemma-2" class="headerlink" title="Lemma 2"></a>Lemma 2</h3><p>$S_w$å®šä¹‰ä¸ºæ•°æ®ç©ºé—´$\mathcal{X}$çš„ä¸€ä¸ªpartitionï¼Œè€Œ$S={(\mathbf{x}_1,\mathbf{x}_2)|\exist w, \mathbf{x}_1\in S_w,\mathbf{x}_2\in S_w}$ã€‚</p>
<blockquote>
<p>å½“$G,\phi,\lambda$å›ºå®šæ—¶ï¼Œ$S\downarrow$æœ‰$\mathcal{L}_{Buzz}\downarrow$</p>
</blockquote>
<h3 id="Lemma-3"><a href="#Lemma-3" class="headerlink" title="Lemma 3"></a>Lemma 3</h3><blockquote>
<p>$\max\mathcal{L}<em>{Buzz}\geq\max{\mathcal{L}</em>{vae}}$ï¼ŒåŒæ—¶ï¼Œå½“$S\downarrow\text{diag}{\mathcal{X}}$æ—¶$\max\mathcal{L}<em>{Buzz}\downarrow\max\mathcal{L}</em>{vae}$</p>
</blockquote>
<p><img src="http://qfxiao.me/img/image-20200106183833975.png" alt=""></p>
<h3 id="Lemma-4"><a href="#Lemma-4" class="headerlink" title="Lemma 4"></a>Lemma 4</h3><blockquote>
<p>ä»¤$p^\prime_G(\mathbf{y}|\mathbf{x})$è¡¨ç¤º$\mathbb{E}<em>{q</em>{\phi^\prime}}\left[p_G(\mathbf{y}|\mathbf{z})\right]$ã€‚å¦‚æœ$(G,\phi,\lambda)$æ˜¯ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆå­˜åœ¨$(G,\phi^\prime,\lambda)$ä½¿å¾—ï¼š<br>$$<br>\mathbb{E}<em>{p(\mathbf{x}|w)}\mathbb{E}</em>{p_G^\prime(\mathbf{y}|\mathbf{x})}\parallel\mathbf{x}-\mathbf{y}\parallel=W^1\left[P(\mathbf{x}|w)\parallel P_G(\mathbf{y}|w)\right]<br>$$<br>æ­¤æ—¶$\mathcal{L}<em>{Buzz}-\mathcal{L}</em>{vae}^\prime=\mathcal{K}^\prime-\mathcal{K}$ï¼Œå…¶ä¸­$\mathcal{L}^\prime,\mathcal{K}^\prime$åˆ†åˆ«ä¸º$(G,\phi^\prime,\lambda)$æ—¶çš„$\mathcal{L}$å’Œ$\mathcal{K}$ã€‚</p>
</blockquote>
<p>$$<br>\mathcal{L}^\dagger_{Buzz}=\mathbb{E}<em>{p(\mathbf{x})}\left[\mathbb{E}</em>{q_{\phi^\prime}(\mathbf{z}|\mathbf{x})}\log_{p_\theta}(\mathbf{x}|\mathbf{z})\right]-\min\limits_{\bar{\phi}\sim\phi^\prime}\bar{\mathcal{K}}<br>$$</p>
<h3 id="Lemma-5"><a href="#Lemma-5" class="headerlink" title="Lemma 5"></a>Lemma 5</h3><p>è¿™é‡Œä¸»è¦æ˜¯æƒ³è¯æ˜</p>
<blockquote>
<p>å¯¹äºå›ºå®šçš„$w$ï¼Œä»¤ï¼š<br>$$<br>\mathcal{F}={f|Lip(f)\leq 1}, \space \mathcal{F}^<em>=\left{f|<em>{S_w}\bigg|Lip(f|</em>{S_w})\leq 1\right}<br>$$<br>æœ‰$\sup_{f\in\mathcal{F}}\mathcal{T}(f)=\sup_{f|_{S_w}\in\mathcal{F}^</em>}\mathcal{T}^*\left(f|_{S_w}\right)$ã€‚</p>
</blockquote>
<h3 id="Theorem-6"><a href="#Theorem-6" class="headerlink" title="Theorem 6"></a>Theorem 6</h3><blockquote>
<p>$\mathcal{L}<em>{Buzz}$çš„å¯¹å¶å½¢å¼ä¸ºï¼š<br>$$<br>\mathcal{L}</em>{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}^*(F)-\mathcal{K}-\log Z(\lambda)<br>$$</p>
</blockquote>
<p>è¿‘ä¼¼çš„$\mathcal{L}<em>{Buzz}$çš„å¯¹å¶å½¢å¼ä¸ºï¼š<br>$$<br>\bar{\mathcal{L}}</em>{Buzz}=-\lambda\sup\limits_{Lip(F;S)\leq 1}\mathbb{E}_{p(w)}\mathcal{T}(F)-\mathcal{K}-\log Z(\lambda)<br>$$</p>
<h1 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h1><p><img src="http://qfxiao.me/img/image-20200106142131500.png" alt=""></p>
<p><img src="http://qfxiao.me/img/image-20200106142155978.png" alt=""></p>
<p><img src="http://qfxiao.me/img/image-20200106142212110.png" alt=""></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/"><img class="thumbnail" src="http://qfxiao.me/img/image-20191102233101258.png" alt="Variational Approaches for Auto-Encoding Generative Adversarial Networks"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-11-02T15:28:53.000Z" title="2019-11-02T15:28:53.000Z">2019-11-02</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/GAN/">GAN</a></span><span class="level-item">18 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2774 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/11/02/Variational-Approaches-for-Auto-Encoding-Generative-Adversarial-Networks/">Variational Approaches for Auto-Encoding Generative Adversarial Networks</a></h1><div class="content"><h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>æœ¬æ–‡æ­ç¤ºäº†å¯¹æŠ—ç”Ÿæˆç½‘ç»œï¼ˆGenerative Adversarial Networks, GANï¼‰å’Œå˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational Auto-encoders, VAEï¼‰ä¹‹é—´çš„è”ç³»ï¼Œå¹¶æ®æ­¤æå‡ºäº†ä¸€ç§å°†ä¸¤è€…ç»“åˆçš„æ–°æ¨¡å‹ã€‚æ–‡ä¸­ä¸»è¦æ˜¯å°†ä¸å¯è§£çš„ä¼¼ç„¶å‡½æ•°å’ŒæœªçŸ¥çš„åéªŒåˆ†å¸ƒç”¨ä¸€ä¸ªéç¡®å®šçš„åˆ†å¸ƒï¼ˆImmplicit Distributionï¼‰æ›¿ä»£ï¼Œå¹¶åŠ å…¥åˆ¤åˆ«å™¨æ¥ä½¿å¾—è¯¥åˆ†å¸ƒé€¼è¿‘çœŸå®çš„åˆ†å¸ƒã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œä½œè€…å°†VAEä¸­çš„æŸå¤±å‡½æ•°è¿›è¡Œäº†æ›¿æ¢ï¼Œå˜æˆäº†GANä¸­çš„â€œç”Ÿæˆ-åˆ¤åˆ«â€æ¨¡å¼ã€‚</p>
<p><a href="https://arxiv.org/abs/1706.04987">åŸæ–‡</a></p>
<h1 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h1><p>æœ¬æ–‡æœ‰å¦‚ä¸‹è´¡çŒ®ï¼š</p>
<ul>
<li>æœ¬æ–‡æå‡ºå˜åˆ†æ¨æ–­ï¼ˆVariational Inferenceï¼‰ä¹Ÿèƒ½é€šè¿‡å¯¹éç¡®å®šåˆ†å¸ƒçš„ä¼°è®¡åº”ç”¨åœ¨GANä¸­ï¼›</li>
<li>åŸºäºä¼¼ç„¶çš„æ¨¡å‹ï¼ˆLikelihood-based Modelsï¼‰å’Œéä¼¼ç„¶æ¨¡å‹ï¼ˆLikelihood-free Modelsï¼‰èƒ½å¤Ÿé€šè¿‡å¯¹æŠ—å­¦ä¹ ç»“åˆèµ·æ¥ï¼›</li>
<li>ä½œè€…æ ¹æ®æ–‡ä¸­æå‡ºçš„æ–°è§‚ç‚¹ä¿®æ”¹äº†VAEçš„æŸå¤±å‡½æ•°ï¼Œå°†å…¶ç§°ä¹‹ä¸ºAuto-encoding GAN ($\alpha$-GAN)ï¼Œå¹¶æå‡ºäº†å¯¹åº”çš„å®ç”¨çš„æ”¹è¿›ï¼›</li>
<li>æœ¬æ–‡ä¸ä¼—å¤šState-of-Artæ¨¡å‹è¿›è¡Œäº†å¯¹æ¯”</li>
</ul>
<h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Overcoming-Intractability-in-Generative-Models"><a href="#Overcoming-Intractability-in-Generative-Models" class="headerlink" title="Overcoming Intractability in Generative Models"></a>Overcoming Intractability in Generative Models</h2><h3 id="Latent-Variable-Models"><a href="#Latent-Variable-Models" class="headerlink" title="Latent Variable Models"></a>Latent Variable Models</h3><p>éšå˜é‡æ¨¡å‹é€šè¿‡éšå˜é‡çš„å½¢å¼æè¿°äº†æ•°æ®çš„äº§ç”Ÿè¿‡ç¨‹ã€‚æœ€ç®€å•çš„å½¢å¼æ˜¯å‡è®¾éšå˜é‡$\mathbf{z}$æœä»ä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒ$\mathbf{z}\sim p(\mathbf{z})$ï¼Œè€Œæ•°æ®$\mathbf{x}$ä»æ¡ä»¶åˆ†å¸ƒ$p(\mathbf{x}|\mathbf{z})$æŠ½æ ·äº§ç”Ÿã€‚é€šå¸¸æ¥è¯´æè¿°$p(\mathbf{x}|\mathbf{z})$çš„æ¨¡å‹ç§°ä¸ºç”Ÿæˆå™¨$\mathcal{G}_\theta(\mathbf{z})$ï¼Œå¸¦æœ‰å¯ä¼˜åŒ–çš„å‚æ•°$\theta$ï¼Œè€Œ$\mathbf{z}$é€šå¸¸å‡è®¾ä¸ºæ­£æ€åˆ†å¸ƒ$\mathbf{z}\sim\mathcal{N}(\mathbf{0},\mathbf{I})$ã€‚</p>
<p>æ–‡ä¸­åŒºåˆ†äº†ä¸¤ç§éšå˜é‡æ¨¡å‹ï¼Œä¸€ç§æ˜¯<em>Implicit Latent Variable Models</em>ï¼Œä¸€ç§æ˜¯<em>Prescribed Latent Variable Models</em>ã€‚æ–‡ä¸­çš„æè¿°ä¸å¤ªæ¸…æ¥šï¼Œä¸ªäººè®¤ä¸ºä¸¤è€…çš„åŒºåˆ«æ˜¯å‰è€…å›¾æ¨¡å‹ä¸­çš„$\mathbf{x}$ä¸æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œåœ¨ä¼˜åŒ–çš„æ—¶å€™éœ€è¦ç”¨ä¸€ä¸ªåˆ»ç”»ç”Ÿæˆçš„$\mathbf{x}$å’ŒçœŸå®çš„$\mathbf{x}$çš„å·®åˆ«çš„å‡½æ•°$\delta(\mathbf{x}-\mathcal{G}_\theta(\mathbf{z}))$ï¼Œè€Œåè€…å›¾æ¨¡å‹ä¸­$\mathbf{x}$æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œè¿™æ ·å¯ä»¥å†™å‡ºä¼¼ç„¶å‡½æ•°ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p>
<p>æ— è®ºæ˜¯GANè¿˜æ˜¯VAEéƒ½éœ€è¦é€šè¿‡è¾¹ç¼˜åˆ†å¸ƒ$p_\theta(\mathbf{x})$æ¥åˆ»ç”»å»ºæ¨¡çš„å¥½åï¼Œæ¯”å¦‚è¯´æ ¹æ®$p_\theta(\mathbf{x})$ä¸çœŸå®åˆ†å¸ƒ$p^<em>_\theta(\mathbf{x})$ä¹‹é—´çš„KLæ•£åº¦$\text{KL}\left[p_\theta(\mathbf{x})\parallel p_\theta^</em>(\mathbf{x})\right]$ã€‚ä½†é€šå¸¸æƒ…å†µä¸‹$p_\theta(\mathbf{x})$éƒ½æ˜¯ä¸å¯è§£çš„ï¼Œè€ŒGANå’ŒVAEé€šè¿‡ä¸åŒçš„é€”å¾„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 id="Generative-Adversarial-Networks"><a href="#Generative-Adversarial-Networks" class="headerlink" title="Generative Adversarial Networks"></a>Generative Adversarial Networks</h3><p>GANæ²¡æœ‰ç›´æ¥è®¡ç®—$p_\theta(\mathbf{x})$ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªåˆ¤åˆ«å™¨æ¥åˆ¤åˆ«æ ·æœ¬æ˜¯ä»$p_\theta(\mathbf{x})$è¿˜æ˜¯$p_\theta^<em>(\mathbf{x})$é‡‡æ ·å¾—åˆ°çš„ï¼Œå¦‚æœåˆ¤åˆ«å™¨æ— æ³•è¿›è¡ŒåŒºåˆ†ï¼Œé‚£æˆ‘ä»¬è®¤ä¸ºæ­¤æ—¶$p_\theta(\mathbf{x})\approx p_\theta^</em>(\mathbf{x})$ã€‚</p>
<p>ä»¤éšæœºå˜é‡$y\in{0,1}$ï¼Œ$y=1$è¡¨ç¤ºæ ·æœ¬$\mathbf{x}$æ¥è‡ªçœŸå®åˆ†å¸ƒï¼Œ$y=0$è¡¨ç¤ºæ ·æœ¬$\mathbf{x}$æ¥è‡ªç”Ÿæˆåˆ†å¸ƒï¼Œè€Œåˆ¤åˆ«å™¨çš„è¾“å‡ºä¸º$\mathbf{x}$æ¥è‡ªçœŸå®åˆ†å¸ƒçš„æ¦‚ç‡$\mathcal{D}<em>\phi(\mathbf{x})=p(y=1|\mathbf{x})$ã€‚GANé€šè¿‡å¯¹æ¥è‡ªçœŸå®åˆ†å¸ƒå’Œç”Ÿæˆåˆ†å¸ƒçš„æ ·æœ¬æ±‚äºŒå…ƒäº¤å‰ç†µæ¥ä½œä¸ºåˆ¤åˆ«å™¨æŸå¤±å‡½æ•°ï¼š<br>$$<br>\textbf{Discriminator Loss: }\mathbb{E}</em>{p^*(\mathbf{x})}[-\log\mathcal{D}<em>\phi(\mathbf{x})]+\mathbb{E}</em>{p_\theta(\mathbf{x})}[-\log(1-\mathcal{D}_\phi(\mathbf{x}))]<br>$$</p>
<p>ç”Ÿæˆå™¨å°†æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬åˆ¤å®šä¸ºçœŸçš„æ¦‚ç‡ä½œä¸ºæŸå¤±å‡½æ•°ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªç­‰ä»·çš„ä½†åœ¨å®è·µä¸­è¡¨ç°æ›´å¥½çš„æ›¿ä»£ç‰ˆæœ¬ï¼š</p>
<p>$$<br>\textbf{Generator Loss: }\mathbb{E}<em>{p_\theta(\mathbf{x})}[\log(1-\mathcal{D}_\phi(\mathbf{x}))];\textbf{ Alternative Loss: }\mathbf{E}</em>{p_\theta(\mathbf{x})}[-\log\mathcal{D}_\phi(\mathbf{x})]<br>$$</p>
<h3 id="The-Density-Ratio-Trick"><a href="#The-Density-Ratio-Trick" class="headerlink" title="The Density Ratio Trick"></a>The Density Ratio Trick</h3><p>ä»¤$p^<em>(\mathbf{x})=p(\mathbf{x}|y=1)$ï¼Œ$p_\theta(\mathbf{x})=p(\mathbf{x}|y=0)$ã€‚å®šä¹‰*Density Ratio</em> $r_\phi(\mathbf{x})$ä¸ºçœŸå®åˆ†å¸ƒå’Œç”Ÿæˆåˆ†å¸ƒä¹‹é—´çš„æ¯”ä¾‹ï¼š</p>
<p>$$<br>r_\phi(\mathbf{x})=\frac{p^*(\mathbf{x})}{p_\theta(\mathbf{x})}=\frac{p(\mathbf{x}|y=1)}{p(\mathbf{x}|y=0)}=\frac{p(y=1|\mathbf{x})}{p(y=0|\mathbf{x})}=\frac{\mathcal{D}_\phi(\mathbf{x})}{1-\mathcal{D}_\phi(\mathbf{x})}<br>$$</p>
<p>ä¸Šå¼è¡¨æ˜äº†<em>Density Ratio*çš„è®¡ç®—å¯ä»¥ä»…é€šè¿‡ä»ä¸¤ä¸ªåˆ†å¸ƒä¸Šé‡‡æ ·å¾—åˆ°çš„æ ·æœ¬åŠ ä¸Šä¸€ä¸ªäºŒåˆ†ç±»å™¨$\mathcal{D}_\phi(\mathbf{x})$å®ç°ï¼ˆå‡è®¾$p(y=0)=p(y=1)$ï¼‰ã€‚æ›´æ·±å…¥çš„è¯´ï¼Œå¯¹äºä¸å¯è§£çš„åˆ†å¸ƒ$p_\theta^</em>(\mathbf{x})$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—<em>Density Ratio*æ¥äº†è§£æˆ‘ä»¬è¿‘ä¼¼çš„åˆ†å¸ƒ$p_\theta(\mathbf{x})$å’ŒçœŸå®çš„$p_\theta^</em>(\mathbf{x})$ä¹‹é—´çš„ç›¸å¯¹æ€§ã€‚è€Œä¸”æˆ‘ä»¬åªéœ€è¦èƒ½å¤Ÿåœ¨ä¸¤ä¸ªåˆ†å¸ƒä¸Šè¿›è¡Œé‡‡æ ·ï¼Œå¹¶ä¸”è®­ç»ƒä¸€ä¸ªåˆ¤åˆ«å™¨å³å¯ã€‚å› ä¸ºåˆ¤åˆ«å™¨æ˜¯ä¸€ä¸ªæ™®é€šçš„åˆ†ç±»å™¨ï¼Œæ‰€ä»¥å¤§é‡çš„ä¸»æµåˆ†ç±»å™¨éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p>
<h3 id="Variational-Inference"><a href="#Variational-Inference" class="headerlink" title="Variational Inference"></a>Variational Inference</h3><p>ç°åœ¨æ¥çœ‹VAEï¼Œå¦ä¸€ç§è§£å†³ä¸å¯è§£åˆ†å¸ƒçš„æ–¹æ³•æ˜¯è¿‘ä¼¼ã€‚<em>Variational Inference</em>é€šè¿‡å¼•å…¥ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ$q_\eta(\mathbf{z}|\mathbf{x})$æ¨å‡ºäº†ä¸å¯è§£çš„$\mathbf{x}$çš„å¯¹æ•°ä¼¼ç„¶çš„ä¸‹ç•Œï¼ˆå¸¸è¢«ç§°ä¸ºè¯æ®ä¸‹ç•ŒELBOï¼‰ï¼š</p>
<p>$$<br>\log p_\theta(\mathbf{x})=\log\int p_\theta(\mathbb{x}|\mathbb{z})p(\mathbf{z})\text{d}\mathbf{z}\geq \mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log p_\theta(\mathbf{x}|\mathbf{z})\right]-\text{KL}\left[q_\eta(\mathbf{z}|\mathbf{x})\parallel p(\mathbf{z})\right]=\mathcal{F}(\boldsymbol{\theta}, \boldsymbol{\eta})<br>$$</p>
<p>VAEæ˜¯<em>Variational Inference</em>çš„ä¸€ç§å®ç°ï¼Œå˜åˆ†åˆ†å¸ƒé€šè¿‡ä¸€ä¸ªç¥ç»ç½‘ç»œè¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ä¸”å»ºç«‹èµ·äº†å®Œæ•´çš„å¯ä¼˜åŒ–çš„æ¨¡å‹ã€‚</p>
<h3 id="Synthetic-Likelihood"><a href="#Synthetic-Likelihood" class="headerlink" title="Synthetic Likelihood"></a>Synthetic Likelihood</h3><p>å½“ä¼¼ç„¶å‡½æ•°æœªçŸ¥ï¼ˆGANä¸­æ²¡æœ‰æ˜¾å¼çš„ä¼¼ç„¶å‡½æ•°ï¼Œè€ŒVAEä¸­æœ‰ï¼‰çš„æ—¶å€™ï¼Œ<em>Variational Inference*ä¾¿æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚å¯¹äºæ²¡æœ‰æ˜¾å¼çš„ä¼¼ç„¶å‡½æ•°çš„æƒ…å†µï¼Œä»¥VAEçš„ELBOçš„ç¬¬ä¸€é¡¹ä¸ºä¾‹ï¼Œå‡è®¾$p_\theta(\mathbf{x}|\mathbf{z})$åˆ†å¸ƒçš„å…·ä½“å½¢å¼æœªçŸ¥ï¼Œæˆ‘ä»¬åªæœ‰ä»$p_\theta(\mathbf{x}|\mathbf{z})$é‡‡æ ·å¾—åˆ°çš„æ ·æœ¬ï¼Œå¦‚ä½•è®¡ç®—$\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}[\log p_\theta(\mathbf{x}|\mathbf{z})]$å‘¢ï¼Ÿä¸€ä¸ªæ–¹æ³•æ˜¯ä¹˜ä»¥$p_\theta^</em>(\mathbf{x})$å†é™¤ä»¥$p_\theta^*(\mathbf{x})$ï¼š</p>
<p>$$<br>\mathbb{E}<em>{q_\eta(\mathbf{z}|\mathbf{x})}[\log p_\theta(\mathbf{x}|\mathbf{z})]=\mathbb{E}</em>{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{p_\theta(\mathbf{x}|\mathbf{z})}{p^<em>(\mathbf{x})}\right]+\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}[\log p^</em>(\mathbf{x})]<br>$$</p>
<p>å…¬å¼(5)ä¸­çš„ç¬¬ä¸€é¡¹åŒ…æ‹¬äº†åˆæˆä¼¼ç„¶$R(\theta)=\frac{p_\theta(\mathbf{x}|\mathbf{z})}{p^*(\mathbf{x})}$ï¼Œä¼˜åŒ–$R(\theta)$ç›¸å½“äºä¼˜åŒ–$\log p_\theta(\mathbf{x}|\mathbf{z})$ã€‚ç¬¬äºŒé¡¹ä¸ç”Ÿæˆç½‘ç»œçš„å‚æ•°$\theta$æ— å…³ï¼Œæ‰€ä»¥åœ¨ä¼˜åŒ–çš„æ—¶å€™å¯ä»¥å¿½ç•¥ã€‚</p>
<h2 id="A-Fusion-of-Variational-and-Adversarial-Learning"><a href="#A-Fusion-of-Variational-and-Adversarial-Learning" class="headerlink" title="A Fusion of Variational and Adversarial Learning"></a>A Fusion of Variational and Adversarial Learning</h2><p>GANå’ŒVAEåˆ†åˆ«ä»ä¸åŒçš„è§’åº¦è§£å†³äº†ç”Ÿæˆæ¨¡å‹çš„æ¨æ–­é—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹é¢ä»VAEå‡ºå‘ï¼Œè€ƒè™‘å°†ä¸¤è€…ç»“åˆèµ·æ¥ã€‚</p>
<h3 id="Implicit-Variational-Distributions"><a href="#Implicit-Variational-Distributions" class="headerlink" title="Implicit Variational Distributions"></a>Implicit Variational Distributions</h3><p>å˜åˆ†æ¨æ–­<strong>Variational Inference</strong>çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯ç¡®å®š$q_\eta(\mathbf{z}|\mathbf{x})$ï¼Œé€šå¸¸çš„åšæ³•å¦‚<strong>Mean-field Variational Inference</strong>ä¼šå‡è®¾ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚åœ¨æœ¬æ–‡ä¸­ä¸å¯¹$q_\eta(\mathbf{z}|\mathbf{x})$çš„å½¢å¼ä½œå‡è®¾ï¼Œä»…å‡è®¾å…¶ä¸ºä¸€ä¸ªéšå«çš„åˆ†å¸ƒã€‚è¿ç”¨ä¸Šæ–‡æåˆ°çš„<em>Density Ratio Trick</em>ï¼Œæˆ‘ä»¬å¯ä»¥å°†VAEæŸå¤±å‡½æ•°ä¸­çš„ç¬¬äºŒé¡¹æ”¹å†™ä¸ºï¼š</p>
<p>$$<br>-\text{KL}[q_\eta(\mathbf{z}|\mathbf{x})\parallel p(\mathbf{z})]=\mathbb{E}<em>{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{p(\mathbf{z})}{q_\eta(\mathbf{z}|\mathbf{x})}\right]\approx\mathbb{E}</em>{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}{1-\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}\right]<br>$$</p>
<p>æ–‡ä¸­å¼•å…¥äº†ä¸€ä¸ªéšå˜é‡åˆ†ç±»å™¨ï¼ˆLatent Classifierï¼‰$\mathcal{C}_{\boldsymbol{\omega}}(\mathbf{z})$ï¼Œç”¨æ¥åˆ¤åˆ«$\mathbf{z}$æ˜¯ä»ç¼–ç ç½‘ç»œè¿˜æ˜¯ä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ï¼ˆçŒœæµ‹è¿™æ ·åšçš„å¥½å¤„æ˜¯ä¸ç”¨å†å¯¹$\mathbf{z}$çš„åéªŒåšé«˜æ–¯åˆ†å¸ƒçš„å‡è®¾äº†ï¼Œä¹Ÿä¸éœ€è¦åœ¨å˜åˆ†ç½‘ç»œè¾“å‡ºå½¢æˆçš„é«˜æ–¯åˆ†å¸ƒä¸Šé‡‡æ ·å¾—åˆ°$\mathbf{z}$äº†ï¼Œè¿™æ ·é‡å‚æ•°æŠ€å·§ä¹Ÿçœäº†ï¼‰ã€‚å…·ä½“å®ç°ä¸Šï¼ŒæœŸæœ›å¯ä»¥ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•ï¼ˆé‡‡æ ·å¤šæ¬¡å–å‡å€¼ï¼‰è¿›è¡Œè®¡ç®—ã€‚</p>
<h3 id="Likelihood-Choice"><a href="#Likelihood-Choice" class="headerlink" title="Likelihood Choice"></a>Likelihood Choice</h3><p>å¯¹äºVAEæŸå¤±å‡½æ•°ç¬¬ä¸€é¡¹ï¼Œå¯¹åº”ç”Ÿæˆç½‘ç»œï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¯¹$p(\mathbf{x}|\mathbf{z})$åˆ†å¸ƒçš„å…·ä½“å½¢å¼åšå‡è®¾ï¼Œ è¿™æ ·å¯¹åº”<em>Likelihood-based<em>çš„æƒ…å†µã€‚æ–‡ä¸­é€‰æ‹©çš„æ˜¯</em>Zero-mean Laplace Distribution</em> $p_\theta(\mathbf{x}|\mathbf{z})\propto\exp(-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1)$ï¼ˆä¸å°±æ˜¯$L_1$ Losså—ï¼Ÿï¼Ÿï¼Ÿï¼‰ã€‚</p>
<p>å¯¹äº<em>Likelihood-free</em>çš„æƒ…å†µï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨ä¸Šé¢æåˆ°çš„<em>Density Ratio Trick</em>ï¼Œè¿™æ—¶éœ€è¦åŠ ä¸€ä¸ªä¸€ä¸ªåˆ¤åˆ«å™¨ã€‚</p>
<p>$$<br>\mathbb{E}<em>{q_\eta(\mathbf{z}|\mathbf{x})}\left[-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1\right]\space\space\text{  or  }\space\space\mathbb{E}</em>{q_\eta(\mathbf{z}|\mathbf{x})}\left[\log\frac{\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}{1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}\right]<br>$$</p>
<p>å¯¹äºä¸¤ç§é€‰æ‹©ï¼Œå‰è€…å¯¹åº”VAEï¼Œå¥½å¤„æ˜¯ä¸ä¼šå‡ºç°æ¨¡å¼å´©æºƒçš„æƒ…å†µï¼Œåè€…å¯¹åº”GANï¼Œå®¹æ˜“å‡ºç°æ¨¡å¼å´©æºƒçš„æƒ…å†µï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å¯¹æŠ—å­¦ä¹ çš„æ–¹å¼ï¼ˆè¿™æ˜¯ä¼˜ç‚¹ï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œæœ¬æ–‡é€‰æ‹©ä¸¤ç§éƒ½ç”¨ï¼ˆæˆ‘å…¨éƒ½è¦.jpgï¼‰ã€‚</p>
<h3 id="Hybrid-Loss-Functions"><a href="#Hybrid-Loss-Functions" class="headerlink" title="Hybrid Loss Functions"></a>Hybrid Loss Functions</h3><p>å°†å‰é¢çš„è®¨è®ºç»“åˆèµ·æ¥ï¼Œæœ€åçš„æŸå¤±å‡½æ•°å°±æ˜¯ï¼š</p>
<p>$$<br>\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\eta})=\mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[-\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1+\log\frac{\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}{1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))}+\log\frac{\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}{1-\mathcal{C}_\boldsymbol{\omega}(\mathbf{z})}\right]<br>$$</p>
<p>æœ€åæ¨¡å‹åŒ…å«å››ä¸ªç½‘ç»œï¼šç”Ÿæˆç½‘ç»œ$p_\theta(\mathbf{x}|\mathbf{z})$ã€æ¨æ–­ç½‘ç»œ$q_\eta(\mathbf{z}|\mathbf{x})$ä»¥åŠä¸¤ä¸ªåˆ¤åˆ«å™¨$\mathcal{C}_{\boldsymbol{\omega}}$å’Œ$\mathcal{D}_\phi$ï¼Œä½œè€…å°†å…¶å‘½åä¸º$\alpha$-GANã€‚</p>
<p>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/image-20191106220923748.png" alt=""></p>
<h3 id="Improved-Techniques"><a href="#Improved-Techniques" class="headerlink" title="Improved Techniques"></a>Improved Techniques</h3><p>ä½œè€…ä¸ºäº†æ”¹è¿›æ¨¡å‹çš„ç¨³å®šæ€§å’Œæ•ˆç‡ï¼Œå°†ç”Ÿæˆå™¨çš„Lossä¸­çš„$-\log(1-\mathcal{D}_\phi)$ä¿®æ”¹ä¸ºäº†$\log\mathcal{D}_\phi-\log(1-\mathcal{D}_\phi)$ï¼Œå¹¶å£°ç§°è¿™æ ·èƒ½æä¾›éé¥±å’Œï¼ˆNon-saturatingï¼‰çš„æ¢¯åº¦ï¼š</p>
<p>$$<br>\textbf{Generator Loss: } \mathbb{E}_{q_\eta(\mathbf{z}|\mathbf{x})}\left[\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1-\log\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z}))+\log(1-\mathcal{D}_\phi(\mathcal{G}_\theta(\mathbf{z})))\right]<br>$$</p>
<p>ä½œè€…è®¤ä¸ºåœ¨ç”Ÿæˆå™¨æŸå¤±å‡½æ•°ä¸­åŠ å…¥$\lambda\parallel\mathbf{x}-\mathcal{G}_\theta(\mathbf{z})\parallel_1$èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦é˜²æ­¢æ¨¡å¼å´©æºƒã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…å‘ç°å°†çœŸå®æ ·æœ¬ï¼ˆåŸæ–‡æ˜¯The Samplesï¼‰ä½œä¸ºç”Ÿæˆçš„æ ·æœ¬è¾“å…¥åˆ°åˆ¤åˆ«å™¨ä¸­èƒ½å¤Ÿæå‡æ€§èƒ½ã€‚ä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯æ ¹æ®Jensenä¸ç­‰å¼ï¼š$\log p_\theta(\mathbf{x})=\log\int p_\theta(\mathbf{x}|\mathbf{z})p(\mathbf{z})\text{d}\mathbf{z}\geq \mathbb{E}_{p(\mathbf{z})}[\log p_\theta(\mathbf{x}|\mathbf{z})]$ï¼Œ</p>
<p>[TODO]</p>
<h2 id="Related-Work"><a href="#Related-Work" class="headerlink" title="Related Work"></a>Related Work</h2><p>[TODO]</p>
<p><img src="http://qfxiao.me/img/image-20191102233101258.png" alt=""></p>
<p><img src="http://qfxiao.me/img/image-20191102233151987.png" alt=""></p>
<h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><p>[TODO]</p>
<h2 id="Metrics"><a href="#Metrics" class="headerlink" title="Metrics"></a>Metrics</h2><p>æœ¬æ–‡ä½¿ç”¨äº†å‡ ç§ä¸åŒçš„è¯„æµ‹ç”Ÿæˆæ¨¡å‹çš„æ–¹æ³•ï¼š</p>
<ul>
<li>*<em>Inception Score: *</em></li>
<li>*<em>Multi-scale Structural Similarity (MS-SSIM): *</em></li>
<li>*<em>Independent Wasserstein Critic: *</em></li>
</ul>
<h2 id="Results-on-ColorMNIST"><a href="#Results-on-ColorMNIST" class="headerlink" title="Results on ColorMNIST"></a>Results on ColorMNIST</h2><p><img src="http://qfxiao.me/img/image-20191102233220700.png" alt=""></p>
<p><img src="http://qfxiao.me/img/image-20191102233244847.png" alt=""></p>
<h2 id="Results-on-CelebA"><a href="#Results-on-CelebA" class="headerlink" title="Results on CelebA"></a>Results on CelebA</h2><p><img src="http://qfxiao.me/img/image-20191102233303345.png" alt=""></p>
<h2 id="Results-on-CIFAR-10"><a href="#Results-on-CIFAR-10" class="headerlink" title="Results on CIFAR-10"></a>Results on CIFAR-10</h2><p><img src="http://qfxiao.me/img/image-20191102233338213.png" alt=""></p>
<p><img src="http://qfxiao.me/img/image-20191102233350494.png" alt=""></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/10/22/An-Introduction-to-Variational-Autoencoders/"><img class="thumbnail" src="http://qfxiao.me/img/autoencoder23849248011.png" alt="An Introduction to Variational Autoencoders"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-22T07:14:26.000Z" title="2019-10-22T07:14:26.000Z">2019-10-22</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Tutorial/">Tutorial</a></span><span class="level-item">22 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 3277 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/22/An-Introduction-to-Variational-Autoencoders/">An Introduction to Variational Autoencoders</a></h1><div class="content"><h1 id="Deep-Generative-Models"><a href="#Deep-Generative-Models" class="headerlink" title="Deep Generative Models"></a>Deep Generative Models</h1><p>ç”Ÿæˆæ¨¡å‹æ˜¯æŒ‡ä¸€ç³»åˆ—ç”¨äºéšæœºç”Ÿæˆå¯è§‚æµ‹æ•°æ®çš„æ¨¡å‹ã€‚å‡è®¾åœ¨ä¸€ä¸ªé«˜ç»´ç©ºé—´$\mathcal{X}$ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªéšæœºå‘é‡$\mathbf{X}$æœä»ä¸€ä¸ªæœªçŸ¥çš„åˆ†å¸ƒ$p_r(x),x\in \mathcal{X}$ã€‚ç”Ÿæˆæ¨¡å‹å°±æ˜¯æ ¹æ®ä¸€äº›å¯è§‚æµ‹çš„æ ·æœ¬$x^{(1)},x^{(2)},\cdots,x^{(N)}$æ¥å­¦ä¹ ä¸€ä¸ªå‚æ•°åŒ–çš„æ¨¡å‹$p_\theta(x)$æ¥è¿‘ä¼¼æœªçŸ¥åˆ†å¸ƒ$p_r(x)$ã€‚</p>
<p>ç”Ÿæˆæ¨¡å‹ä¸»è¦ç”¨äºå¯†åº¦ä¼°è®¡å’Œæ ·æœ¬ç”Ÿæˆã€‚</p>
<hr>
<p>å¯†åº¦ä¼°è®¡å³ç»™å®šä¸€ç»„æ•°æ®$\mathcal{D}={x^{(i)}},1\leq i\leq N$ï¼Œå‡è®¾ä»–ä»¬éƒ½æ˜¯ä»ç›¸åŒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°$p_r(x)$ç‹¬ç«‹äº§ç”Ÿçš„ã€‚å¯†åº¦ä¼°è®¡å°±æ˜¯æ ¹æ®æ•°æ®é›†$\mathcal{D}$æ¥ä¼°è®¡å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°$p_r(x)$ã€‚</p>
<p>å¦‚æœå°†ç”Ÿæˆæ¨¡å‹ç”¨äºç›‘ç£å­¦ä¹ ï¼Œé‚£ä¹ˆå°±æ˜¯è¾“å‡ºæ ‡ç­¾çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(y|x)$ï¼Œæ ¹æ®è´å¶æ–¯å…¬å¼ï¼š</p>
<p>$$p(y|x)=\frac{p(x,y)}{\sum_y p(x,y)}$$</p>
<p>é—®é¢˜å°±å˜ä¸ºäº†è”åˆæ¦‚ç‡$p(x,y)$çš„å¯†åº¦ä¼°è®¡é—®é¢˜ã€‚</p>
<hr>
<p>æ ·æœ¬ç”Ÿæˆå³æ ¹æ®ç»™å®šçš„æ¦‚ç‡åˆ†å¸ƒ$p_\theta(x)$ç”Ÿæˆä¸€äº›æœä»è¿™ä¸ªåˆ†å¸ƒçš„æ ·æœ¬ï¼Œå³é‡‡æ ·ã€‚åœ¨å«éšå˜é‡çš„ç”Ÿæˆæ¨¡å‹ä¸­ï¼Œç”Ÿæˆ$x$çš„è¿‡ç¨‹ä¸€èˆ¬åŒ…å«ä¸¤æ­¥ï¼š</p>
<ol>
<li>æ ¹æ®éšå˜é‡çš„åˆ†å¸ƒ$p_\theta(z)$é‡‡æ ·å¾—åˆ°$z$ï¼›</li>
<li>æ ¹æ®æ¡ä»¶åˆ†å¸ƒ$p_\theta(x|z;\theta)$è¿›è¡Œé‡‡æ ·å¾—åˆ°$x$ã€‚</li>
</ol>
<p>æ‰€ä»¥åœ¨ç”Ÿæˆæ¨¡å‹ä¸­çš„é‡ç‚¹æ˜¯ä¼°è®¡æ¡ä»¶åˆ†å¸ƒ$p(x|z;\theta)$ã€‚</p>
<h1 id="Parameter-Estimation-for-Hidden-Variable-with-EM-Algorithm"><a href="#Parameter-Estimation-for-Hidden-Variable-with-EM-Algorithm" class="headerlink" title="Parameter Estimation for Hidden Variable with EM Algorithm"></a>Parameter Estimation for Hidden Variable with EM Algorithm</h1><p>å¦‚æœå›¾æ¨¡å‹ä¸­å­˜åœ¨éšå˜é‡ï¼Œå°±éœ€è¦ä½¿ç”¨EMç®—æ³•è¿›è¡Œå‚æ•°ä¼°è®¡ã€‚</p>
<p>åœ¨ä¸€ä¸ªåŒ…å«éšå˜é‡çš„å›¾æ¨¡å‹ä¸­ï¼Œä»¤$\mathbf{X}$ä¸ºå¯è§‚æµ‹å˜é‡é›†åˆï¼Œ$\mathbf{Z}$ä¸ºéšå˜é‡é›†åˆï¼Œåˆ™ä¸€ä¸ªæ ·æœ¬$x$çš„è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p>
<p>$$p(x;\theta)=\sum_z p(x,z;\theta)$$</p>
<p>ç»™å®šåŒ…å«$N$ä¸ªè®­ç»ƒæ ·æœ¬çš„è®­ç»ƒé›†$\mathcal{D}={x^{(n)}},1\leq i\leq N$ï¼Œåˆ™è®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¸ºï¼š</p>
<p>$$\begin{align}\mathcal{L}(\mathcal{D};\theta)&amp;=\frac{1}{N}\sum_{n=1}^N \log p(x^{(n)};\theta)\&amp;=\frac{1}{N}\sum_{n=1}^N \log \sum_z p(x^{(n)},z;\theta)\end{align}$$</p>
<hr>
<p>è¿™æ—¶ï¼Œåªè¦æœ€å¤§åŒ–æ•´ä¸ªè®­ç»ƒé›†çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶$\mathcal{L}(\mathcal{D};\theta)$ï¼Œå³å¯ä¼°è®¡å‡ºæœ€ä¼˜çš„å‚æ•°$\theta^*$ã€‚ä¸è¿‡åœ¨è®¡ç®—æ¢¯åº¦çš„æ—¶å€™ï¼Œéœ€è¦åœ¨å¯¹æ•°å‡½æ•°å†…éƒ¨è¿›è¡Œæ±‚å’Œæˆ–ç§¯åˆ†è®¡ç®—ã€‚ä¸ºäº†æ›´å¥½çš„è®¡ç®—$\log p(x;\theta)$ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªé¢å¤–çš„å˜åˆ†å‡½æ•°$q(z)$ï¼Œ$q(z)$ä¸ºå®šä¹‰åœ¨éšå˜é‡$z$ä¸Šçš„åˆ†å¸ƒã€‚æ ·æœ¬$x$çš„å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p>
<p>$$\begin{align}\log p(x;\theta)&amp;=\log \sum_z q(z)\frac{p(x,z;\theta)}{q(z)}\&amp;\geq\sum_z q(z)\log \frac{p(x,z;\theta)}{q(z)}\&amp;\triangleq ELBO(q,x;\theta)\end{align}$$</p>
<p>å…¶ä¸­$ELBO(q,x;\theta)$ä¸ºå¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°$\log p(x;\theta)$çš„ä¸‹ç•Œï¼Œç§°ä¸ºè¯æ®ä¸‹ç•Œã€‚å…¬å¼ä¸­ä½¿ç”¨äº†Jensenä¸ç­‰å¼(å³å¯¹äºå‡¹å‡½æ•°$g$ï¼Œæœ‰$g(\mathbb{E}[x])\geq\mathbb{E}[g(X)]$)ã€‚åœ¨è¿™é‡Œï¼Œ$\frac{p(x,z;\theta)}{q(z)}$å¯è§†ä¸º$q(z)$çš„å‡½æ•°ï¼Œè®°ä¸º$f(q(z))$ï¼Œé‚£ä¹ˆ$f(q(z))$çš„æœŸæœ›å³$\mathbb{E}[f(q(z))]=\sum_z q(z)f(q(z))=\sum_z q(z)\frac{p(x,z;\theta)}{q(z)}$ã€‚è€Œæ ¹æ®Jensenä¸ç­‰å¼ï¼Œæœ‰$g(\mathbb{E}[f(q(z))])\geq\mathbb{E}[g(f(q(z)))]\Leftrightarrow g(\sum_z q(z)\frac{p(x,z;\theta)}{q(z)})\geq \sum_z q(z)g(\frac{p(x,z;\theta)}{q(z)})$ï¼Œåœ¨è¿™é‡Œ$g$å°±æ˜¯å¯¹æ•°å‡½æ•°ã€‚</p>
<hr>
<p>æ ¹æ®Jensenä¸ç­‰å¼å–ç­‰çš„æ¡ä»¶ï¼š$\frac{p(x,z;\theta)}{q(z)}=c$ï¼Œ$c$ä¸ºå¸¸æ•°ï¼Œæœ‰ï¼š</p>
<p>$$\begin{align}\sum_z p(x,z;\theta)&amp;=c\sum_z q(z)\\Leftrightarrow\sum_z p(x,z;\theta)&amp;=c\cdot1\end{align}$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$\begin{align}q(z)&amp;=\frac{p(x,z;\theta)}{\sum_z p(x,z;\theta)}\&amp;=\frac{p(x,z;\theta)}{p(x;\theta)}\&amp;=p(z|x;\theta)\end{align}$$</p>
<p>æ‰€ä»¥ï¼Œå½“ä¸”ä»…å½“$q(z)=p(z|x;\theta)$æ—¶ï¼Œ$\log p(x;\theta)=ELBO(q,x;\theta)$ã€‚</p>
<hr>
<p>äºæ˜¯æœ€å¤§åŒ–å¯¹æ•°è¾¹é™…ä¼¼ç„¶å‡½æ•°$\log p(x;\theta)$çš„è¿‡ç¨‹å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>å…ˆæ‰¾åˆ°è¿‘ä¼¼åˆ†å¸ƒ$q(z)$ä½¿å¾—$\log p(x;\theta)=ELBO(q,x;\theta)$ï¼›</li>
<li>å†å¯»æ‰¾å‚æ•°$\theta$æœ€å¤§åŒ–$ELBO(q,x;\theta)$ã€‚</li>
</ol>
<p>è¿™å°±æ˜¯æœŸæœ›æœ€å¤§åŒ–(Expectation-Maximum,EM)ç®—æ³•ã€‚</p>
<hr>
<p>EMç®—æ³•é€šè¿‡è¿­ä»£çš„æ–¹æ³•ï¼Œä¸æ–­é‡å¤ç›´åˆ°æ”¶æ•›åˆ°æŸä¸ªå±€éƒ¨æœ€ä¼˜è§£ã€‚åœ¨ç¬¬$t$æ­¥æ›´æ–°æ—¶ï¼ŒEæ­¥å’ŒMæ­¥åˆ†åˆ«ä¸ºï¼š</p>
<ol>
<li><p>Eæ­¥ï¼šå›ºå®šå‚æ•°$\theta_t$ï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆ†å¸ƒä½¿$ELBO(q,x;\theta_t)$æœ€å¤§ï¼Œå³ç­‰äº$\log p(x;\theta_t)$ï¼š$q_{t+1}(z)=\text{arg}_q \max ELBO(q,x;\theta_t)$ï¼›</p>
</li>
<li><p>Mæ­¥ï¼šå›ºå®š$q_{t+1}(z)$ï¼Œæ‰¾åˆ°ä¸€ç»„å‚æ•°ä½¿å¾—è¯æ®ä¸‹ç•Œæœ€å¤§ï¼Œå³ï¼š$\theta_{t+1}=\text{arg}<em>\theta\max ELBO(q</em>{t+1},x;\theta)$ã€‚</p>
</li>
</ol>
<hr>
<p>å¯¹æ•°è¾¹é™…ä¼¼ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ä¿¡æ¯è®ºçš„è§†è§’æ¥è¿›è¡Œåˆ†è§£ï¼š</p>
<p>$$\begin{align}\log p(x;\theta)&amp;=\sum_z q(z)\log p(x;\theta)\&amp;=\sum_z q(z)(\log p(x,z;\theta)-\log p(z|x;\theta))\&amp;=\sum_z q(z)\log\frac{p(x,z;\theta)}{q(z)}-\sum_z q(z)\log\frac{p(z|x;\theta)}{q(z)}\&amp;=ELBO(q,x;\theta)+D_{KL}(q(z)\parallel p(z|x;\theta))\end{align}$$</p>
<p>å…¶ä¸­$D_{KL}(q(z)\parallel p(z|x;\theta))$</p>
<h1 id="Generative-Model-with-Hidden-Variable"><a href="#Generative-Model-with-Hidden-Variable" class="headerlink" title="Generative Model with Hidden Variable"></a>Generative Model with Hidden Variable</h1><p>å‡è®¾ä¸€ä¸ªç”Ÿæˆæ¨¡å‹åŒ…å«ä¸å¯è§‚æµ‹çš„éšå˜é‡ï¼Œå…¶ä¸­å¯è§‚æµ‹å˜é‡$x$ä¸ºä¸€ä¸ªé«˜ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ï¼Œè€Œä¸å¯è§‚æµ‹çš„éšå˜é‡$z$ä¸ºä¸€ä¸ªç›¸å¯¹ä½ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡ã€‚</p>
<p>è¿™ä¸ªç”Ÿæˆæ¨¡å‹çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å¯ä»¥è¡¨è¾¾ä¸ºï¼š</p>
<p>$$p(x,z;\theta)=p(x|z;\theta)p(z;\theta)$$</p>
<p>å…¶ä¸­$p(z;\theta)$ä¸ºéšå˜é‡$z$çš„å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒï¼›$p(x|z;\theta)$ä¸ºå·²çŸ¥$z$æ¡ä»¶ä¸‹$x$çš„æ¦‚ç‡åˆ†å¸ƒã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾$p(z;\theta)$å’Œ$p(x|z;\theta)$æœä»æŸç§å¸¦å‚çš„åˆ†å¸ƒæ—ï¼Œå…¶å½¢å¼å·²çŸ¥ï¼Œè€Œå‚æ•°å¯ä»¥é€šè¿‡æœ€å¤§ä¼¼ç„¶æ¥è¿›è¡Œä¼°è®¡ã€‚</p>
<p>ç»™å®šä¸€ä¸ªæ ·æœ¬$x$ï¼Œå…¶å¯¹æ•°è¾¹é™…ä¼¼ç„¶$\log p(x;\theta)$å¯ä»¥åˆ†è§£ä¸ºï¼š</p>
<p>$$\log p(x;\theta)=ELBO(q,x;\theta,\phi)+D_{KL}(q(z;\phi)\parallel p(z|x;\theta))$$</p>
<p>å…¶ä¸­$q(z;\phi)$ä¸ºé¢å¤–å¼•å…¥çš„å˜åˆ†å¯†åº¦å‡½æ•°ï¼Œ$ELBO(q,x;\theta,\phi)$ä¸ºè¯æ®ä¸‹ç•Œï¼š</p>
<p>$$ELBO(q,x;\theta,\phi)=\mathbb{E}_{z\sim q(z;\phi)}[\log{\frac{p(x,z;\theta)}{q(z;\phi)}}]$$</p>
<p>æœ€å¤§åŒ–$\log p(x;\theta)$å¯ä»¥ç”¨EMç®—æ³•æ¥æ±‚è§£ï¼š</p>
<ul>
<li><strong>E-step:</strong> å¯»æ‰¾ä¸€ä¸ªå¯†åº¦å‡½æ•°$q(z;\phi)$ä½¿å…¶ç­‰äºæˆ–æ¥è¿‘äºåéªŒå¯†åº¦å‡½æ•°$p(z|x;\theta)$;</li>
<li><strong>M-step:</strong> ä¿æŒ$q(z;\phi)$å›ºå®šï¼Œå¯»æ‰¾$\theta$æ¥æœ€å¤§åŒ–$ELBO(q,x;\theta,\phi)$ã€‚</li>
</ul>
<p>åœ¨EMç®—æ³•çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œç†è®ºä¸Šæœ€ä¼˜çš„$q(z;\phi)$ä¸ºéšå˜é‡çš„åéªŒæ¦‚ç‡å¯†åº¦å‡½æ•°$p(z|x;\theta)$ï¼š</p>
<p>$$p(z|x;\theta)=\frac{p(x|z;\theta)p(z;\theta)}{\int_z p(x|z;\theta)p(z;\theta)\text{d}z}$$</p>
<p>åéªŒå¯†åº¦å‡½æ•°$p(z|x;\theta)$çš„è®¡ç®—æ˜¯ä¸€ä¸ªç»Ÿè®¡æ¨æ–­çš„é—®é¢˜ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹$p(x|z;\theta)$ä¹Ÿæ¯”è¾ƒéš¾ä»¥è®¡ç®—ã€‚</p>
<h1 id="Variational-Autoencoder"><a href="#Variational-Autoencoder" class="headerlink" title="Variational Autoencoder"></a>Variational Autoencoder</h1><p>å˜åˆ†è‡ªç¼–ç å™¨(Variational Autoencoder, VAE)çš„ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥åˆ†åˆ«å»ºæ¨¡ä¸¤ä¸ªå¤æ‚çš„æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š</p>
<ol>
<li><p>ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿå˜åˆ†åˆ†å¸ƒ$q(z;\phi)$ï¼Œç§°ä¸ºæ¨æ–­ç½‘ç»œã€‚æ¨æ–­ç½‘ç»œçš„è¾“å…¥ä¸º$x$ï¼Œè¾“å‡ºä¸ºå˜åˆ†åˆ†å¸ƒ$q(z|x;\phi)$ï¼›</p>
</li>
<li><p>ç”¨ç¥ç»ç½‘ç»œæ¥äº§ç”Ÿæ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ï¼Œç§°ä¸ºç”Ÿæˆç½‘ç»œã€‚ç”Ÿæˆç½‘ç»œçš„è¾“å…¥ä¸º$z$ï¼Œè¾“å‡ºä¸ºæ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ã€‚</p>
<p><img src="http://qfxiao.me/img/autoencoder23849248011.png" alt=""></p>
</li>
</ol>
<p>VAEçš„å›¾æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565532060281.png" alt=""></p>
<h2 id="Variational-Network"><a href="#Variational-Network" class="headerlink" title="Variational Network"></a>Variational Network</h2><p>å‡è®¾$q(z|x;\phi)$æ˜¯æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼š</p>
<p>$$q(z|x;\phi)=\mathcal{N}(z;\mu_I,\sigma^2_I I)$$</p>
<p>å…¶ä¸­$\mu_I$å’Œ$\sigma_I^2$æ˜¯é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ï¼Œå¯ä»¥é€šè¿‡æ¨æ–­ç½‘ç»œ$f_I(x;\phi)$æ¥é¢„æµ‹ï¼š</p>
<p>$$<br>\left[\begin{matrix}\mu_I\\sigma_I\end{matrix}\right]=f_I(x;\phi)<br>$$<br>æ¨æ–­ç½‘ç»œ$f_I(x;\phi)$å¯ä»¥æ˜¯ä¸€èˆ¬çš„å…¨è¿æ¥ç½‘ç»œæˆ–å·ç§¯ç½‘ç»œï¼Œæ¯”å¦‚ä¸€ä¸ªä¸¤å±‚çš„ç¥ç»ç½‘ç»œï¼š</p>
<p>$$\begin{align}h&amp;=\sigma(W^{(1)}x+b^{(1)})\\mu_I&amp;=W^{(2)}h+b^{(2)}\\sigma_I&amp;=\text{softplus}(W^{(3)}h+b^{(3)})\end{align}$$</p>
<p>å…¶ä¸­æ‰€æœ‰ç½‘ç»œå‚æ•°${W^{(1)},W^{(2)},W^{(3)},b^{(1)},b^{(2)},b^{(3)}}$å³å¯¹åº”äº†å˜åˆ†å‚æ•°$\phi$ã€‚</p>
<hr>
<p>æ¨æ–­ç½‘ç»œçš„ç›®æ ‡æ˜¯ä½¿å¾—$q(z|x;\phi)$æ¥å°½å¯èƒ½æ¥è¿‘çœŸå®çš„åéªŒ$p(z|x;\theta)$ï¼Œéœ€è¦æ‰¾åˆ°å˜åˆ†å‚æ•°$\phi^*$æ¥æœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„KLæ•£åº¦ï¼š</p>
<p>$$\phi^*=\text{arg}<em>\phi\min{D</em>{KL}(q(z|x;\phi)\parallel p(z|x;\theta))}$$</p>
<p>ç”±äº$p(z|x;\theta)$æœªçŸ¥ï¼Œæ•…KLæ•£åº¦æ— æ³•ç›´æ¥è®¡ç®—ï¼Œä¸è¿‡ç”±äº$D_{KL}(q(z|x;\phi)\parallel p(z|x;\theta))=\log p(x;\theta)-ELBO(q,x;\theta,\phi)$ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œï¼Œæœ‰ï¼š</p>
<p>$$\phi^*=\text{arg}_\phi\max{ELBO(q,x;\theta,\phi)}$$</p>
<h2 id="Generative-Network"><a href="#Generative-Network" class="headerlink" title="Generative Network"></a>Generative Network</h2><p>ç”Ÿæˆæ¨¡å‹çš„è”åˆåˆ†å¸ƒå¯ä»¥åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†ï¼šéšå˜é‡$z$çš„å…ˆéªŒåˆ†å¸ƒ$p(z;\theta)$å’Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ã€‚ä¸ºç®€å•èµ·è§ï¼Œä¸€èˆ¬å‡è®¾éšå˜é‡$z$çš„å…ˆéªŒåˆ†å¸ƒä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ$\mathcal{N}(z|0,I)$ï¼Œéšå˜é‡æ¯ä¸€ç»´ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$å¯ä»¥é€šè¿‡ç”Ÿæˆç½‘ç»œæ¥å»ºæ¨¡ï¼Œæˆ‘ä»¬åŒæ ·ç”¨å‚æ•°åŒ–çš„åˆ†å¸ƒæ—æ¥è¡¨ç¤ºæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$p(x|z;\theta)$ï¼Œè¿™äº›åˆ†å¸ƒæ—çš„å‡½æ•°å¯ä»¥ç”¨ç”Ÿæˆç½‘ç»œè®¡ç®—å¾—åˆ°ã€‚æ ¹æ®å˜é‡$x$çš„ç±»å‹ä¸åŒï¼Œå¯ä»¥å‡è®¾$p(x|z;\theta)$æœä»ä¸åŒçš„åˆ†å¸ƒæ—ã€‚å¦‚æœ$x\in{0,1}^d$æ˜¯$d$ç»´çš„äºŒå€¼å‘é‡ï¼Œå¯ä»¥å‡è®¾$\log p(x|z;\theta)$æœä»å¤šå˜é‡çš„ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œå³ï¼š</p>
<p>$$\begin{align}p(x|z;\theta)&amp;=\prod\limits_{i=1}^d p(x_i|z;\theta)\&amp;=\prod\limits_{i=1}^d \gamma_i^{x_i}(1-\gamma_i)^{(1-x_i)}\end{align}$$</p>
<p>å¦‚æœ$x\in\mathbb{R}^d$æ˜¯$d$ç»´çš„è¿ç»­å‘é‡ï¼Œå¯ä»¥å‡è®¾$p(x|z;\theta)$æœä»å¯¹è§’åŒ–åæ–¹å·®çš„é«˜æ–¯åˆ†å¸ƒï¼Œå³ï¼š</p>
<p>$$p(x|z;\theta)=\mathcal{N}(x;\mu_G,\sigma_G^2 I)$$</p>
<hr>
<p>ç”Ÿæˆç½‘ç»œçš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ç»„$\theta^*$æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œ$ELBO(q,x;\theta,\phi)$ï¼š</p>
<p>$$\theta^*=\text{arg}_\theta\max ELBO(q,x;\theta,\phi)$$</p>
<h2 id="Model-Combination"><a href="#Model-Combination" class="headerlink" title="Model Combination"></a>Model Combination</h2><p>æ¨æ–­ç½‘ç»œå’Œç”Ÿæˆç½‘ç»œçš„ç›®æ ‡éƒ½æ˜¯æœ€å¤§åŒ–è¯æ®ä¸‹ç•Œå› æ­¤æ€»çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p>
<p>$$\begin{align}\max_{\theta,\phi}ELBO(q,x;\theta,\phi)&amp;=\max_{\theta,\phi}\mathbb{E}<em>{z\sim q(z;\phi)}[\log\frac{p(x|z;\theta)p(z;\theta)}{q(z;\theta)}]\&amp;=\max</em>{\theta,\phi}\mathbb{E}<em>{z\sim q(z|x;\phi)}[\log p(x|z;\theta)]-D</em>{KL}(q(z|x;\phi)\parallel p(z;\theta))\end{align}$$</p>
<p>å…¶ä¸­å…ˆéªŒåˆ†å¸ƒ$p(z;\theta)=\mathcal{N}(z|0,I)$ã€‚</p>
<p>å…¬å¼ä¸­$\mathbb{E}_{z\sim q(z|x;\phi)}[\log p(x|z;\theta)]$ä¸€èˆ¬é€šè¿‡é‡‡æ ·çš„æ–¹å¼è¿›è¡Œè®¡ç®—ï¼Œæœ€åå–å¹³å‡å€¼ã€‚</p>
<h2 id="Model-Training"><a href="#Model-Training" class="headerlink" title="Model Training"></a>Model Training</h2><p>ç»™å®šæ•°æ®é›†$\mathcal{D}$ï¼ŒåŒ…å«$N$ä¸ªä»æœªçŸ¥æ•°æ®åˆ†å¸ƒä¸­æŠ½å–çš„ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬$x^{(1)},x^{(2)},\cdots,x^{(N)}$ã€‚å˜åˆ†è‡ªç¼–ç å™¨çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p>
<p>$$\mathcal{J}(\phi,\theta|\mathcal{D})=\sum\limits_{n=1}^N(\frac{1}{M}\sum\limits_{m=1}^M\log p(x^{(n)}|z^{(n,m)};\theta)-D_{KL}(q(z|x^{(n)};\phi)\parallel\mathcal{N}(z;0,I)))$$</p>
<p>å¦‚æœé‡‡ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œæ¯æ¬¡ä»æ•°æ®é›†ä¸­é‡‡ä¸€ä¸ªæ ·æœ¬$x$ï¼Œç„¶åæ ¹æ®$q(z|x;\phi)$é‡‡ä¸€ä¸ªéšå˜é‡$z$ï¼Œåˆ™ç›®æ ‡å‡½æ•°å˜ä¸ºï¼š</p>
<p>$$\mathcal{J}(\phi,\theta|x)=\log p(x|z;\theta)-D_{KL}(q(z|x;\phi)\parallel\mathcal{N}(z;0,I))$$</p>
<p>å‡è®¾$q(z|x;\phi)$æ˜¯æ­£æ€åˆ†å¸ƒï¼ŒKLæ•£åº¦å¯ç›´æ¥ç®—å‡ºï¼š</p>
<p>$$D_{KL}(\mathcal{N}(\mu_1,\Sigma_1)\parallel\mathcal(\mu_2,\Sigma_2))\=\frac{1}{2}(\text{tr}(\sigma_I^2 I)+\mu_I^T\mu_I-d-\log(|\sigma_I^2 I|))$$</p>
<hr>
<p>å†å‚æ•°åŒ–æ˜¯å°†ä¸€ä¸ªå‚æ•°ä¸º$u$çš„å‡½æ•°$f(u)$ï¼Œé€šè¿‡ä¸€ä¸ªå‡½æ•°$u=g(v)$ï¼Œè½¬æ¢ä¸ºå‚æ•°ä¸º$v$çš„å‡½æ•°$\hat{f}(v)=f(g(v))$ã€‚åœ¨å˜åˆ†è‡ªç¼–ç å™¨ä¸­ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•æ±‚éšæœºå˜é‡$z$å…³äº$\phi$çš„å¯¼æ•°ã€‚ä½†ç”±äºæ˜¯é‡‡æ ·çš„æ–¹å¼ï¼Œæ— æ³•ç›´æ¥åˆ»ç”»$z$å’Œ$\phi$ä¹‹é—´çš„å‡½æ•°å…³ç³»ï¼Œå› æ­¤ä¹Ÿæ— æ³•è®¡ç®—å¯¼æ•°ã€‚</p>
<p>å¦‚æœ$z\sim q(z|x;\phi)$çš„éšæœºæ€§ç‹¬ç«‹äºå‚æ•°$\phi$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å†å‚æ•°åŒ–çš„æ–¹æ³•æ¥è®¡ç®—å¯¼æ•°ã€‚å‡è®¾$q(z|x;\phi)$ä¸ºæ­£æ€åˆ†å¸ƒ$\mathcal{N}(\mu_I,\sigma^2_I I)$ï¼Œå…¶ä¸­$\mu_I$å’Œ$\sigma_I$æ˜¯æ¨æ–­ç½‘ç»œ$f_I(x;\phi)$çš„è¾“å‡ºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼é‡‡æ ·$z$ï¼š</p>
<p>$$z=\mu_I+\sigma_I\odot \varepsilon$$</p>
<p>å…¶ä¸­$\varepsilon\sim\mathcal{N}(0,I)$ã€‚è¿™æ ·$z$å’Œ$\mu_I,\sigma_I$çš„å…³ç³»ä»é‡‡æ ·å…³ç³»å˜ä¸ºå‡½æ•°å…³ç³»ã€‚</p>
<hr>
<p>å¦‚æœè¿›ä¸€æ­¥å‡è®¾$p(x|z;\theta)$æœä»é«˜æ–¯åˆ†å¸ƒ$\mathcal{N}(x|\mu_G,I)$ï¼Œå…¶ä¸­$\mu_G=f_G(z;\theta)$æ˜¯ç”Ÿæˆç½‘ç»œçš„è¾“å‡ºï¼Œåˆ™ç›®æ ‡å‡½æ•°å¯ä»¥ç®€åŒ–ä¸ºï¼š</p>
<p>$$\mathcal{J}(\phi,\theta|x)=-\parallel x-\mu_G\parallel^2+D_{KL}(\mathcal{N}(\mu_I,\sigma_I)\parallel\mathcal{N}(0,I))$$</p>
<p>å…¶ä¸­ç¬¬ä¸€é¡¹å¯ä»¥è¿‘ä¼¼çœ‹ä½œæ˜¯è¾“å…¥$x$çš„é‡æ„æ­£ç¡®æ€§ï¼Œç¬¬äºŒé¡¹å¯ä»¥çœ‹ä½œæ˜¯æ­£åˆ™åŒ–é¡¹ã€‚</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/10/18/Recurrent-Neural-Networks-for-Multivariate-Time-Series-with-Missing-Values/"><img class="thumbnail" src="http://qfxiao.me/img/1571412138245.png" alt="Recurrent Neural Networks for Multivariate Time Series with Missing Values"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-18T15:17:07.000Z" title="2019-10-18T15:17:07.000Z">2019-10-18</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/RNN/">RNN</a></span><span class="level-item">9 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1309 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/18/Recurrent-Neural-Networks-for-Multivariate-Time-Series-with-Missing-Values/">Recurrent Neural Networks for Multivariate Time Series with Missing Values</a></h1><div class="content"><h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>æ–‡ä¸­æå‡ºäº†ä¸€ç§å¯ä»¥å¤„ç†å¸¦ç¼ºå¤±å€¼å¤šä¸ºæ—¶é—´åºåˆ—çš„GRUæ¨¡å‹ï¼š<strong>GRU-D</strong>ã€‚æœ¬æ¨¡å‹ä¸ä»…å¯ä»¥æ•æ‰æ—¶é—´åºåˆ—ä¸­çš„é•¿æœŸä¾èµ–æ¨¡å¼ï¼Œå¹¶ä¸”è¿˜èƒ½åˆ©ç”¨æ—¶é—´åºåˆ—ä¸­çš„ç¼ºå¤±æ¨¡å¼æ¥è¾¾åˆ°æ›´å¥½çš„æ—¶é—´åºåˆ—é¢„æµ‹æ•ˆæœã€‚</p>
<p><a href="https://www.nature.com/articles/s41598-018-24271-9">åŸæ–‡</a></p>
<h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Notations"><a href="#Notations" class="headerlink" title="Notations"></a>Notations</h2><p>è®°åŒ…å«$D$ä¸ªå˜é‡çš„å¤šå˜é‡æ—¶é—´åºåˆ—ä¸º$X=(x_1,x_2,\cdots,x_T)^T\in\mathbb{R}^{T\times D}$ï¼Œå…¶ä¸­å¯¹äºæ¯ä¸ª$t\in{1,2,\cdots,T},x_t\in\mathbb{R}^D$è¡¨ç¤ºæ—¶é—´åºåˆ—åœ¨æ—¶é—´$t$çš„è§‚æµ‹å€¼ï¼Œ$x_t^d$è¡¨ç¤º$x_t$çš„ç¬¬$d$ä¸ªæˆåˆ†ã€‚è®°$s_t\in\mathbb{R}$ä¸º$t$æ—¶åˆ»çš„æ—¶é—´æˆ³ï¼Œå¹¶å‡è®¾ç¬¬ä¸€ä¸ªè§‚æµ‹å€¼çš„æ—¶é—´æˆ³ä¸º$0$ã€‚å¯¹äºåŒ…å«ç¼ºå¤±å€¼çš„æ—¶é—´åºåˆ—ï¼Œæˆ‘ä»¬ç”¨<strong>Masking Vector</strong> $m_t\in{0,1}$è¿›è¡Œæ ‡è®°ï¼ŒåŒæ—¶å¯¹æ¯ä¸ª$x_t^d$ç»´æŠ¤è·ç¦»ä¸Šä¸€ä¸ªè§‚æµ‹å€¼çš„<strong>Time Interval</strong> $\delta_t^d\in\mathbb{R}$ï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>m_t^d=\begin{cases}1, &amp;\text{if }x_t^d\text{ is observed}\0, &amp;\text{otherwise}\end{cases}<br>$$</p>
<p>$$<br>\delta_t^d=\begin{cases}s_t-s_{t-1}+\delta_{t-1}^d, &amp;t&gt;1,m_{t-1}^d=0\s_t-s_{t-1}, &amp;t&gt;1, m_{t-1}^d=1\0, &amp;t=1\end{cases}<br>$$</p>
<p>ä¸‹å›¾æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1571476968374.png" alt=""></p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨æ—¶é—´åºåˆ—çš„åˆ†ç±»é—®é¢˜ï¼Œå³ç»™å®šæ•°æ®é›†$\mathcal{D}={(X_n,s_n,M_n)}_{n=1}^N$ï¼Œæˆ‘ä»¬è¦å¯¹æ¯ä¸ªæ ·æœ¬çš„ç±»åˆ«è¿›è¡Œé¢„æµ‹$l_n\in{1,\cdots,L}$ã€‚</p>
<h2 id="GRU-RNN-for-Time-Series-Classification"><a href="#GRU-RNN-for-Time-Series-Classification" class="headerlink" title="GRU-RNN for Time Series Classification"></a>GRU-RNN for Time Series Classification</h2><p>GRUæ˜¯ä¸€ç§æ”¹è¿›ç‰ˆæœ¬çš„RNNï¼Œå…¶æœ€å¤§ä¸åŒæ˜¯åŠ å…¥äº†é—¨æ§æœºåˆ¶ã€‚GRUå•å…ƒçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/GRU49241911247.png" alt=""></p>
<p>GRUåŒ…å«äº†é‡ç½®é—¨å’Œæ›´æ–°é—¨ï¼Œå…¶ä¸­é‡ç½®é—¨$R_t$è´Ÿè´£æ§åˆ¶ä¸Šä¸€æ—¶é—´çš„éšçŠ¶æ€$h_{t-1}$æœ‰å¤šå°‘éƒ¨åˆ†éœ€è¦ä¿ç•™ï¼Œè€Œæ›´æ–°é—¨åˆ™å†³å®šç”±$R_t$è®¡ç®—å‡ºæ¥çš„å€™é€‰éšçŠ¶æ€$\tilde{h}<em>t$æœ‰å¤šå°‘éƒ¨åˆ†éœ€è¦ä¿ç•™ã€‚æœ€åå½“å‰æ—¶é—´çš„éšçŠ¶æ€ç”±$h</em>{t-1}$å’Œ$\tilde{h}<em>t$å…±åŒç®—å‡ºã€‚GRUçš„çŠ¶æ€æ›´æ–°å…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\begin{align}<br>R_t&amp;=\sigma(W_rx_t+U_rh</em>{t-1}+b_r)\<br>Z_t&amp;=\sigma(W_zx_t+U_zh_{t-1}+b_z)\<br>\tilde{h}<em>t&amp;=\text{tanh}(Wx_t+U(R_t\odot h</em>{t-1})+b)\<br>h_t&amp;=(1-Z_t)\odot h_{t-1}+Z_t\odot \tilde{h}_t<br>\end{align}<br>$$<br>æ–‡ä¸­æå‡ºäº†ä¸€äº›å¤„ç†ç¼ºå¤±å€¼çš„ç®€å•æ–¹æ³•ï¼š</p>
<ol>
<li>ç›´æ¥ç”¨å‡å€¼æ›¿ä»£ï¼š$x_t^d\leftarrow m_t^dx_t^d+(1-m_t^d)\tilde{x}^d$ï¼Œå…¶ä¸­$\tilde{x}^d=\frac{\sum_{n=1}^N\sum_{t=1}^{T_n}m_{t,n}^d x_{t,n}^d}{\sum_{n=1}^N\sum_{t=1}^{T_n}m_{t,n}^d\tilde{x}^d}$ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Mean</strong>ï¼›</li>
<li>ç”¨ä¸Šä¸€ä¸ªè§‚æµ‹å€¼æ›¿ä»£ï¼š$x_t^d\leftarrow m_t^d x_t^d+(1-m_t^d)x_{t^\prime}^d$ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Forward</strong>ï¼›</li>
<li>ä¸å¡«å……ï¼Œå°†æ˜¯å¦ç¼ºå¤±ï¼Œè·ç¦»ä¸Šä¸€ä¸ªè§‚æµ‹å€¼çš„æ—¶é—´ä½œä¸ºé¢å¤–ä¿¡æ¯è¾“å…¥ï¼š$x_t^{(n)}\leftarrow[x_t^{(n)};m_t^{(n)};\delta_t^{(n)}]$ã€‚è¿™ç§æ–¹æ³•ç§°ä¸º<strong>GRU-Simple</strong>ã€‚</li>
</ol>
<h3 id="GRU-D-Model-with-Trainable-Decays"><a href="#GRU-D-Model-with-Trainable-Decays" class="headerlink" title="GRU-D: Model with Trainable Decays"></a>GRU-D: Model with Trainable Decays</h3><p>æ–‡ä¸­æå‡ºäº†æ—¶é—´åºåˆ—ç¼ºå¤±å€¼çš„ä¸¤ä¸ªæ€§è´¨ï¼šä¸€ä¸ªæ˜¯åœ¨ä¸Šä¸€ä¸ªè§‚æµ‹å€¼è·ç¦»å¾ˆè¿œçš„æƒ…å†µä¸‹ç¼ºå¤±å€¼å€¾å‘äºæ¥è¿‘ä¸€ä¸ªé»˜è®¤çš„å€¼ï¼Œç¬¬äºŒä¸ªæ˜¯ç¼ºå¤±å€¼çš„å½±å“ä¼šéšç€æ—¶é—´å‡å¼±ã€‚ä¸ºäº†ä½“ç°ä¸Šè¿°ä¸¤ç‚¹ï¼Œæ–‡ä¸­æå‡ºäº†GPU-Dæ¨¡å‹ï¼Œæ¨¡å‹æ¡†æ¶å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1571412138245.png" alt=""></p>
<p>åœ¨æ¨¡å‹ä¸­ï¼Œ<strong>Decay Rates</strong>è¢«è®¾å®šä¸ºä¸€ä¸ªå¸¦å‚æ•°çš„å‡½æ•°å’ŒGRUä¸€èµ·è®­ç»ƒï¼š<br>$$<br>\gamma_t=\exp{-\max(0,W_\gamma\delta_t+b_\gamma)}<br>$$</p>
<p>$$<br>\hat{x}<em>t^d=m_t^dx_t^d+(1-m_t^d)(\gamma</em>{x_t}^dx_{t^\prime}^d+(1-\gamma_{x_t}^d)\tilde{x}^d)<br>$$<br>å…¶ä¸­$x_{t^\prime}^d$æ˜¯ç¬¬$d$ä¸ªå˜é‡çš„ä¸Šä¸€ä¸ªè§‚æµ‹å€¼ï¼Œ$\tilde{x}^d$æ˜¯ç¬¬$d$ä¸ªå˜é‡çš„ç»éªŒå‡å€¼ã€‚è¿™æ ·$\hat{x}_t^d$å°±ä»£è¡¨ç»è¿‡<strong>Input Decay</strong>çš„è¾“å…¥ã€‚</p>
<p>æ–‡ä¸­æåˆ°åªç”¨<strong>Input Decay</strong>æ˜¯ä¸å¤Ÿçš„ï¼Œé™¤æ­¤ä¹‹å¤–ä½œè€…è¿˜ä½¿ç”¨äº†<strong>Hidden State Decay</strong>ï¼Œå³å¯¹$h_{t-1}$è¿›è¡ŒDecayï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\hat{h}<em>{t-1}=\gamma</em>{h_t}\odot h_{t-1}<br>$$<br>ç”¨Decayä¹‹åçš„$\hat{x}<em>t$å’Œ$\hat{h}</em>{t-1}$æ›¿æ¢åŸå§‹çš„GRUå…¬å¼å°±å¾—åˆ°äº†GRU-Dæ¨¡å‹ï¼š<br>$$<br>\begin{align}<br>R_t&amp;=\sigma(W_r\hat{x}<em>t-U_r\hat{h}</em>{t-1}+V_rm_t+b_r)\<br>Z_t&amp;=\sigma(W_z\hat{x}<em>t+U_z\hat{h}</em>{t-1}+V_zm_t+b_z)\<br>\tilde{h}<em>t&amp;=\text{tanh}(W\hat{x}_t+U(R_t\odot \hat{h}</em>{t-1})+Vm_t+b)\<br>h_t&amp;=(1-z_t)\odot \hat{h}_{t-1}+z_t\odot\tilde{h}_t<br>\end{align}<br>$$</p>
<h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Baseline-Imputation-Methods"><a href="#Baseline-Imputation-Methods" class="headerlink" title="Baseline Imputation Methods"></a>Baseline Imputation Methods</h2><p>ä¸‹å›¾ä¸ºæ–‡ä¸­æ¯”è¾ƒä¸­ç”¨åˆ°çš„Baselineï¼š</p>
<p><img src="http://qfxiao.me/img/1571673314402.png" alt=""></p>
<h2 id="Baseline-Prediction-Methods"><a href="#Baseline-Prediction-Methods" class="headerlink" title="Baseline Prediction Methods"></a>Baseline Prediction Methods</h2><p>ä¸‹å›¾ä¸ºæ–‡ä¸­ç”¨åˆ°çš„ç”¨æ¥é¢„æµ‹çš„Baselineï¼š</p>
<p><img src="http://qfxiao.me/img/1571673403956.png" alt=""></p>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>æ–‡ä¸­ç”¨åˆ°çš„æ•°æ®é›†å¦‚ä¸‹ï¼š</p>
<ul>
<li><em>Gesture phase segmentation dataset (Gesture)</em>. </li>
<li><em>PhysioNet Challenge 2012 dataset (PhysioNet)</em>.</li>
<li><em>MIMIC-â…¢ dataset (MIMIC-â…¢)</em>. </li>
</ul>
<p>ä¸‹å›¾å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨äººå·¥åˆæˆæ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š</p>
<p><img src="http://qfxiao.me/img/1571412162954.png" alt=""></p>
<p>ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ¨¡å‹åœ¨é¢„æµ‹ä»»åŠ¡è¡¨ç°çš„å¯¹æ¯”ï¼š</p>
<p><img src="http://qfxiao.me/img/1571412183650.png" alt=""></p>
<p>ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ–¹æ³•åœ¨MIMIC-â…¢å’ŒPhysioNetæ•°æ®é›†ä¸Šçš„å¤šä»»åŠ¡è¡¨ç°ï¼š</p>
<p><img src="http://qfxiao.me/img/1571412196724.png" alt=""></p>
<p>ä¸‹å›¾åˆ†åˆ«å±•ç¤ºäº†æ¨¡å‹å­¦åˆ°çš„<strong>Input Decay</strong>å’Œ<strong>Hidden State Decay</strong>ï¼š</p>
<p><img src="http://qfxiao.me/img/1571412221428.png" alt=""></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/"><img class="thumbnail" src="http://qfxiao.me/img/1571411043958.png" alt="Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-18T15:00:57.000Z" title="2019-10-18T15:00:57.000Z">2019-10-18</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">25 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 3813 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/18/Robust-Anomaly-Detection-for-Multivariate-Time-Series-through-Stochastic-Recurrent-Neural-Network/">Robust Anomaly Detection for Multivariate Time Series through Stochastic Recurrent Neural Network</a></h1><div class="content"><h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>æœ¬æ–‡æå‡ºäº†<em>OmniAnomaly</em>ï¼šä¸€ç§é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—çš„éšæœºå¾ªç¯ç¥ç»ç½‘ç»œå¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚è¯¥æ¨¡å‹è¿ç”¨äº†ä¸€ç³»åˆ—æŠ€æœ¯æ¥æ•æ‰å¤šå˜é‡æ—¶é—´åºåˆ—çš„æ­£å¸¸æ¨¡å¼ï¼Œå¹¶åœ¨æ£€æµ‹é˜¶æ®µåŸºäºé‡æ„è¯¯å·®æ¥æ£€æµ‹å¼‚å¸¸ï¼ŒåŒæ—¶æœ¬æ–‡è¿˜æä¾›äº†ä¸€å®šçš„ç†è®ºè§£é‡Šã€‚</p>
<p><a href="https://www.kdd.org/kdd2019/accepted-papers/view/robust-anomaly-detection-for-multivariate-time-series-through-stochastic-re">åŸæ–‡</a></p>
<h1 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h1><ol>
<li>æå‡ºäº†<em>OmniAnomaly</em>ï¼Œä¸€ç§åŸºäºéšæœºå¾ªç¯ç¥ç»ç½‘ç»œçš„å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼›</li>
<li>æå‡ºäº†é’ˆå¯¹å¤šå˜é‡æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹çš„è§£é‡Šæ–¹æ³•ï¼›</li>
<li>é€šè¿‡å®éªŒè¯æ˜äº†<em>OmniAnomaly</em>ä¸­æ‰€ç”¨çš„å…³é”®æŠ€æœ¯çš„æœ‰æ•ˆæ€§ï¼ŒåŒ…æ‹¬GRUï¼Œplanar NF, stochastic variable connectionå’Œadjusted Peaks-Over-Threshold methodï¼›</li>
<li>é€šè¿‡å¤§é‡çš„å®éªŒæˆ‘ä»¬è¯æ˜äº†<em>OmniAnomaly</em>çš„æœ‰æ•ˆæ€§ï¼›</li>
<li>å‘å¸ƒäº†ä»£ç å’Œæ•°æ®é›†ã€‚</li>
</ol>
<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><h2 id="Linear-Gaussian-State-Space-Model"><a href="#Linear-Gaussian-State-Space-Model" class="headerlink" title="Linear Gaussian State Space Model"></a>Linear Gaussian State Space Model</h2><p>çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆState Space Model, SSMï¼‰çš„æ¦‚å¿µæ¥è‡ªäºæ§åˆ¶ç†è®ºï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®¨è®ºå…¶åœ¨æ—¶é—´åºåˆ—ä¸­çš„åº”ç”¨ã€‚å…¶å¤§æ¦‚æ€æƒ³æ˜¯æˆ‘ä»¬è®¤ä¸ºæ—¶é—´åºåˆ—åœ¨æ—¶åˆ»$t$çš„è§‚æµ‹å€¼$z_t$æ˜¯ä¸€ä¸ªéšå«çŠ¶æ€$\boldsymbol{l}<em>t$çš„æ¡ä»¶åˆ†å¸ƒ$p(z_t|\boldsymbol{l}_t)$ï¼Œè€Œè¿™ä¸ªéšå«çŠ¶æ€$\boldsymbol{l}_t$åˆ»ç”»äº†æ—¶é—´åºåˆ—çš„å†…åœ¨è§„å¾‹ï¼ŒåŒæ—¶éšå«çŠ¶æ€ä¼šéšç€æ—¶é—´æ›´æ–°ï¼Œå³æœä»æ¡ä»¶åˆ†å¸ƒ$p(\boldsymbol{l}_t|\boldsymbol{l}</em>{t-1})$ã€‚</p>
<p>åœ¨çº¿æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆLinear State Space Modelï¼‰ä¸­æˆ‘ä»¬ä»¥å¦‚ä¸‹çš„æ–¹å¼åˆ»ç”»éšå«çŠ¶æ€çš„æ›´æ–°ï¼š<br>$$<br>\boldsymbol{l}<em>t=\boldsymbol{F}_t\boldsymbol{l}</em>{t-1}+\boldsymbol{g}_t\varepsilon_t, \space\space\space\varepsilon_t\sim\mathcal{N}(0,1)<br>$$<br>$\boldsymbol{F}_t$ä¸ºç¡®å®šçš„çŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œè€Œ$\boldsymbol{g}_t\varepsilon_t$åˆ™è¡¨ç¤ºäº†çŠ¶æ€è½¬ç§»çš„éšæœºæ€§ã€‚</p>
<p>è§‚æµ‹å€¼$z_t$ä»éšå«çŠ¶æ€$\boldsymbol{l}<em>t$è®¡ç®—è€Œæ¥ï¼š<br>$$<br>\begin{align}<br>z_t&amp;=y_t+\sigma_t\epsilon_t,\<br>y_t&amp;=\boldsymbol{a}_t^\top\boldsymbol{l}</em>{t-1}+b_t,\<br>\epsilon_t&amp;\sim\mathcal{N}(0,1)<br>\end{align}<br>$$<br>å…¶ä¸­$\boldsymbol{a}_t\in\mathbb{R}^L,\sigma_t\in \mathbb{R},b_t\in\mathbb{R}$éƒ½æ˜¯é¢å¤–çš„å‚æ•°ã€‚åˆå§‹çŠ¶æ€$\boldsymbol{l}_0$åˆ™ä»ä¸€ä¸ªç‹¬ç«‹çš„é«˜æ–¯åˆ†å¸ƒå¾—æ¥ï¼Œå³$\boldsymbol{l}_0\sim N(\boldsymbol\mu_0,\text{diag}(\boldsymbol{\sigma}_0^2))$ã€‚</p>
<p>ä»¤å‚æ•°é›†åˆ$\Theta_t=(\boldsymbol{\mu}<em>0,\boldsymbol{\Sigma}_0,\boldsymbol{F}_t,\boldsymbol{g}_t,\boldsymbol{a}_t,b_t,\sigma_t),\forall t&gt;0$ï¼Œä¸€èˆ¬æ¥è¯´å‚æ•°é›†åˆä¸ä¼šéšç€æ—¶é—´å˜åŒ–ï¼Œå³æ¯ä¸ªæ—¶åˆ»$t$å…±äº«åŒæ ·çš„å‚æ•°$\Theta_t=\Theta,\forall t&gt;0$ã€‚å¯¹å‚æ•°çš„ä¼°è®¡å¯ä»¥é‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ï¼š<br>$$<br>\begin{align}<br>\Theta^*</em>{1:T}&amp;=\arg\max_{\Theta_{1:T}}p(z_{1:T}|\Theta_{1:T}),\<br>\end{align}<br>$$<br>å…¶ä¸­ï¼š<br>$$<br>\begin{align}<br>p(z_{1:T}|\Theta_{1:T})&amp;=p(z_1|\Theta_1)\prod\limits_{t=2}^T p(z_t|z_{1:t-1},\Theta_{1:t})\<br>&amp;=\int p(\boldsymbol{l}<em>0)\left[\prod\limits</em>{t=1}^T p(z_t|\boldsymbol{l}<em>t)p(\boldsymbol{l}_t|\boldsymbol{l}</em>{t-1})\right]\mathrm{d}\boldsymbol{l}_{0:T}<br>\end{align}<br>$$</p>
<h2 id="Planar-Normalizing-Flow"><a href="#Planar-Normalizing-Flow" class="headerlink" title="Planar Normalizing Flow"></a>Planar Normalizing Flow</h2><h3 id="Normalizing-Flows"><a href="#Normalizing-Flows" class="headerlink" title="Normalizing Flows"></a>Normalizing Flows</h3><p>VAEé‡‡ç”¨ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ$q_\phi(z|x)$æ¥è¿‘ä¼¼çœŸå®çš„åéªŒåˆ†å¸ƒ$p(z|x)$ï¼Œå¹¶æ¨å¯¼å‡º$\log p_\theta(x)$çš„ä¸‹ç•Œï¼ˆç§°ä¸ºELBOï¼‰æ¥ä½œä¸ºä¼˜åŒ–ç›®æ ‡å‡½æ•°ï¼š<br>$$<br>\begin{align}<br>\log p_\theta(x)&amp;=\log \int p_\theta(x|z)p(z)\mathrm{d}z\<br>&amp;=\log\int\frac{q_\phi(z|x)}{q_\phi(z|x)}p_\theta(x|z)p(z)\mathrm{d}z\<br>&amp;\geq-D_{KL}[q_\phi(z|x)\parallel p(z)]+\mathbb{E}<em>q[\log p_\theta(x|z)]<br>\end{align}<br>$$<br>$\log p_\theta(x)$ä¸ELBOå–ç­‰çš„æ¡ä»¶æ˜¯$D</em>{KL}[q_\phi(z|x)\parallel p(z)]$ï¼Œè¡¨æ˜å˜åˆ†åˆ†å¸ƒå®Œå…¨åŒ¹é…äº†çœŸå®çš„åéªŒåˆ†å¸ƒã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒçœŸå®çš„åéªŒåˆ†å¸ƒå¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œè€Œæˆ‘ä»¬çš„å˜åˆ†åˆ†å¸ƒé€šå¸¸æ˜¯ä¸€ä¸ªç¡®å®šçš„è¾ƒä¸ºç®€å•çš„åˆ†å¸ƒï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚è¿™æ ·å˜åˆ†åˆ†å¸ƒå¯èƒ½å¾ˆéš¾å¯¹çœŸå®åéªŒåˆ†å¸ƒå¾—åˆ°ä¸€ä¸ªå¾ˆå¥½çš„æ‹Ÿåˆã€‚</p>
<p>ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ ‡å‡†åŒ–æµï¼ˆNormalizing Flowsï¼‰ã€‚æ ‡å‡†åŒ–æµæ˜¯ä»ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒå‡ºå‘ï¼Œæ‰§è¡Œä¸€ç³»åˆ—å¯é€†çš„æ˜ å°„ï¼Œå°†åŸå§‹ç®€å•çš„åˆ†å¸ƒè½¬åŒ–ä¸ºä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒã€‚</p>
<p>é¦–å…ˆè€ƒè™‘ä¸€ä¸ªå…‰æ»‘çš„ã€å¯é€†çš„æ˜ å°„$f:\mathbb{R}^d\mapsto \mathbb{R}^d$ï¼Œè®°$g=f^{-1}$ï¼Œé‚£ä¹ˆ$g\circ f(\mathbf{z})=\mathbf{z}$ã€‚ä»¤$\mathbf{z}^\prime=f(\mathbf{z})$ï¼Œé‚£ä¹ˆ$\mathbf{z}^\prime$çš„åˆ†å¸ƒä¸ºï¼š<br>$$<br>q(\mathbf{z}^\prime)=q(\mathbf{z})\left|\text{det}\frac{\partial f^{-1}}{\partial \mathbf{z}^\prime}\right|=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}<br>$$<br>å¼ä¸­$q(\mathbf{z}^\prime)=q(z)\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|^{-1}$è¯´æ˜äº†$\mathbf{z}^\prime$çš„åˆ†å¸ƒç­‰äº$\mathbf{z}$çš„åˆ†å¸ƒä¹˜ä¸Š$f$çš„JacobiançŸ©é˜µçš„è¡Œåˆ—å¼çš„å€’æ•°ã€‚é‚£ä¹ˆå¯¹äºæ˜ å°„å¤šæ¬¡çš„æƒ…å†µï¼š<br>$$<br>\mathbf{z}<em>K=f_K\circ\cdots\circ f_2\circ f_1(\mathbf{z}_0)<br>$$<br>$\mathbf{z}_K$çš„åˆ†å¸ƒå¯ä»¥é€šè¿‡é“¾å¼è®¡ç®—å¾—åˆ°ï¼š<br>$$<br>\ln q_K(\mathbf{z}_K)=\ln q_0(\mathbf{z}_0)-\sum\limits</em>{k=1}^K\ln\left|\text{det}\frac{\partial f_k}{\partial \mathbf{z}_{k-1}}\right|<br>$$</p>
<h3 id="Planar-Flows"><a href="#Planar-Flows" class="headerlink" title="Planar Flows"></a>Planar Flows</h3><p>è€ƒè™‘ä¸€ä¸ªå˜æ¢æ—ï¼š<br>$$<br>f(\mathbf{z})=\mathbf{z}+\mathbf{u}h(\mathbf{w}^\top\mathbf{z}+b)<br>$$<br>å…¶ä¸­$\lambda={\mathbf{w}\in \mathbb{R}^d,\mathbf{u}\in\mathbb{R}^d,b\in\mathbb{R}}$ä¸ºå‚æ•°é›†åˆï¼Œ$h(\cdot)$ä¸ºå…ƒç´ çº§çš„éçº¿æ€§å‡½æ•°ï¼ˆå¦‚å„ç§æ¿€æ´»å‡½æ•°ï¼‰ã€‚ä»¤$\psi(\mathbf{z})=h^\prime(\mathbf{w}^\top\mathbf{z}+b)\mathbf{w}$ï¼Œåˆ™$f$çš„JacobiançŸ©é˜µè¡Œåˆ—å¼ç»å¯¹å€¼ç­‰äºï¼š<br>$$<br>\left|\text{det}\frac{\partial f}{\partial \mathbf{z}}\right|=\left|\text{det}(\mathbf{I}+\mathbf{u}\psi(\mathbf{z})^\top)\right|=\left|1+\mathbf{u}^\top\psi(\mathbf{z})\right|<br>$$<br>ä½†æ˜¯$f$å¹¶ä¸ä¿è¯æ€»æ˜¯å¯é€†çš„ï¼Œå¦‚$h(x)=\tanh(x)$æ—¶ï¼Œ$f$å¯é€†çš„æ¡ä»¶æ˜¯$\mathbf{w}^\top \mathbf{u}\geq-1$ã€‚</p>
<p>ä¸‹é¢è®¨è®ºå¦‚ä½•ä¿è¯å¯é€†çš„æ¡ä»¶ã€‚è€ƒè™‘å°†$\mathbf{z}$åˆ†è§£ä¸º$\mathbf{z}=\mathbf{z}_\bot+\mathbf{z}_\parallel$ï¼Œå…¶ä¸­$\mathbf{z}_\bot$ä¸$\mathbf{w}$æ­£äº¤ï¼Œ$\mathbf{z}_\parallel$ä¸$\mathbf{w}$å¹³è¡Œï¼Œé‚£ä¹ˆï¼š<br>$$<br>f(z)=\mathbf{z}_\bot+\mathbf{z}_\parallel+\mathbf{u}h(\mathbf{w}^\top \mathbf{z}_\parallel +b)<br>$$<br>å®é™…ä¸Šå¾—åˆ°$\mathbf{z}_\parallel$ä¹‹åå¯ä»¥å¾ˆå®¹æ˜“çš„å¾—åˆ°$\mathbf{z}_\bot$ï¼Œä»¤$\mathbf{y}=f(\mathbf{z})$ï¼Œæœ‰ï¼š<br>$$<br>\mathbf{z}_\bot=\mathbf{y}-\mathbf{z}_\parallel-\mathbf{u}h(\mathbf{w}^\top\mathbf{z}_\parallel+b)<br>$$<br>è€Œ$\mathbf{z}_\parallel$ä¸$\mathbf{w}$å¹³è¡Œï¼Œæ˜“çŸ¥$\mathbf{z}_\parallel=\alpha\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}$ï¼Œå…¶ä¸­$\alpha\in\mathbb{R}$ã€‚</p>
<p>å¯¹å¼(16)ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥$\mathbf{w}^\top$å¯å¾—ï¼š<br>$$<br>\mathbf{w}^\top f(\mathbf{z})=\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)<br>$$<br>å½“$\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)$å¯¹äº$\alpha$æ˜¯éé€’å‡å‡½æ•°çš„æ—¶å€™ï¼Œ$f$æ˜¯å¯é€†çš„ã€‚å› ä¸º$\alpha+\mathbf{w}^\top\mathbf{u} h(\alpha+b)$æ˜¯éé€’å‡å‡½æ•°æ—¶æœ‰$1+\mathbf{w}^\top\mathbf{u}h^\prime(\alpha+b)\geq 0\equiv \mathbf{w}^\top \mathbf{u}\geq -\frac{1}{h^\prime(\alpha + b)}$ï¼Œè€Œ$0\leq h^\prime(\alpha + b) \leq 1$ï¼ˆ$\tanh$å‡½æ•°çš„æ€§è´¨ï¼‰ï¼Œæ‰€ä»¥æ€»æ˜¯æœ‰$\mathbf{w}^\top \mathbf{u}\geq-1$ã€‚</p>
<p>å¯¹äºä»»æ„ä¸€ä¸ª$\mathbf{u}$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ–¹å¼æ„é€ ä¸€ä¸ª$\hat{\mathbf{u}}$ä½¿å¾—$\mathbf{w}^\top\hat{\mathbf{u}}&gt;-1$ï¼Œå³ä»¤$\hat{\mathbf{u}}(\mathbf{w},\mathbf{u})=\mathbf{u}+[m(\mathbf{w}^\top\mathbf{u})-(\mathbf{w}^\top\mathbf{u})]\frac{\mathbf{w}}{\parallel\mathbf{w}\parallel^2}$ï¼Œå…¶ä¸­$m(x)=-1+\log(1+e^x)$ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20191031162515819.png" alt=""></p>
<h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h2><p>æœ¬æ–‡é’ˆå¯¹çš„æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—$x={x_1,x_2,\cdots,x_N}\in R^{M\times N}$ï¼Œ$N$ä¸ºæ—¶é—´é•¿åº¦ï¼Œå…¶ä¸­æŸä¸€æ—¶åˆ»çš„è§‚æµ‹å€¼$x_t\in R^M$ä¸ºä¸€ä¸ª$M$ç»´çš„å‘é‡ã€‚ä½œè€…ä½¿ç”¨$x_{t-T:t}\in R^{M\times(T+1)}$æ¥è¡¨ç¤º$t-T$åˆ°$t$ä¹‹é—´çš„æ—¶é—´åºåˆ—ã€‚</p>
<p><img src="http://qfxiao.me/img/image-20191024112404542.png" alt=""></p>
<h2 id="Overall-Structure"><a href="#Overall-Structure" class="headerlink" title="Overall Structure"></a>Overall Structure</h2><p>ç®—æ³•çš„æ€»ä½“æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571411043958.png" alt=""></p>
<p>é¢„å¤„ç†æ¨¡å—ä¸»è¦æ˜¯å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ä»¥åŠçª—å£åˆ‡åˆ†ã€‚è®­ç»ƒæ¨¡å—åˆ™æ ¹æ®è¾“å…¥çš„æ•°æ®å¯¹æ­£å¸¸æ¨¡å¼è¿›è¡Œæ•æ‰ï¼Œè¾“å‡ºå¼‚å¸¸åˆ†æ•°ã€‚åœ¨çº¿æ£€æµ‹æ¨¡å—åˆ™ä¼šå®šæœŸæ‰§è¡Œã€‚</p>
<h2 id="Network-Architecture"><a href="#Network-Architecture" class="headerlink" title="Network Architecture"></a>Network Architecture</h2><p>æ¨¡å‹çš„æ€»ä½“ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571411093161.png" alt=""></p>
<p>åœ¨qnetä¸­ï¼Œé¦–å…ˆGRUè¢«ç”¨æ¥å»ºæ¨¡æ ·æœ¬çš„æ—¶é—´ä¾èµ–å…³ç³»ï¼Œä¹‹åVAEå°†æ ·æœ¬$\mathbf{x}$æ˜ å°„åˆ°éšç©ºé—´$\mathbf{z}$ã€‚æ–‡ä¸­ä½¿ç”¨äº†Linear Gaussian State Space Modelæ¥å»ºæ¨¡éšå˜é‡ä¹‹é—´çš„æ—¶é—´ä¾èµ–å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…è¿˜ä½¿ç”¨äº†Planar Normalizing Flowæ¥å°†éšå˜é‡æ˜ å°„åˆ°å¤æ‚çš„éé«˜æ–¯åˆ†å¸ƒã€‚åœ¨pnetä¸­ï¼Œéšå˜é‡$\mathbf{z}<em>{t-T:t}$è¢«ç”¨æ¥é‡å»º$\mathbf{x}</em>{t-T:t}$ï¼Œç›´è§‚ä¸Šæ¥è¯´ï¼Œå¯¹æ ·æœ¬çš„å¥½çš„éšå˜é‡è¡¨ç¤ºå¯ä»¥å¸¦æ¥æ›´å¥½çš„é‡æ„æ•ˆæœã€‚</p>
<p>ä»ç»†èŠ‚ä¸Šæ¥è¯´ï¼Œåœ¨æ—¶é—´$t$ï¼Œqnetçš„è¾“å…¥ä¸º$\mathbf{x}<em>t$å’Œ$\mathbf{e}</em>{t-1}$ï¼Œä¸¤è€…ç»è¿‡GRU Cellä¹‹åä¼šäº§ç”Ÿ$t$æ—¶é—´çš„$\mathbf{e_t}$ã€‚$\mathbf{e}<em>t$æ˜¯GRUæ•æ‰æ—¶é—´ä¾èµ–æ€§çš„å…³é”®ï¼Œå¯ä»¥è®¤ä¸ºå®ƒåŒ…å«äº†$\mathbf{x}</em>{1:t}$çš„ä¿¡æ¯ã€‚ä¹‹å$\mathbf{e}<em>t$ä¼šå’Œ$\mathbf{z}</em>{t-1}$è¿›è¡Œæ‹¼æ¥ï¼Œè¿›å…¥æ ‡å‡†çš„VAEå˜åˆ†ç½‘ç»œç»“æ„ï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„å‚æ•°$\mu_{z_t},\sigma_{z_t}$é‡‡æ ·å¾—åˆ°éšå˜é‡$\mathbf{z}_t^0$ï¼Œæ­¤æ—¶éšå˜é‡å¯ä»¥è¯´æ•æ‰äº†æ—¶é—´ä¾èµ–æ€§ã€‚</p>
<p>ç½‘ç»œä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>$$<br>\begin{align}<br>e_t&amp;=(1-c_t^e)\circ\text{tanh}(w^ex_t+u^e(r_t^e\circ e_{t-1})+b^e)+c_t^e\circ e_{t-1}\<br>\mu_{z_t}&amp;=w^{\mu_z}h^\phi([z_{t-1},e_t])+b^{\mu_z}\<br>\sigma_{z_t}&amp;=\text{softplus}(w^{\sigma_z}h^\phi([z_{t-1},e_t])+b^{\sigma_z})+\epsilon^{\sigma_z}<br>\end{align}<br>$$</p>
<p>å…¶ä¸­$r_t^e=\text{sigmoid}(\mathbf{w}^{r^e}\mathbf{x}<em>t+\mathbf{u}^{r^e}\mathbf{e}</em>{t-1}+b^{r^e})$æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ$c_t^e=\text{sigmoid}(\mathbf{w}^{c^e}\mathbf{x}<em>t+\mathbf{u}^{c^e}\mathbf{e}</em>{t-1}+b^{c^e})$æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p>
<p>æ­¤æ—¶$\mathbf{z}_t^0$æœä»é«˜æ–¯åˆ†å¸ƒï¼Œä¸ºäº†æ‹Ÿåˆå¤æ‚çš„åéªŒåˆ†å¸ƒï¼Œæˆ‘ä»¬ä½¿ç”¨Planar Normalizing Flowæ¥å¯¹$\mathbf{z}_t^0$è¿›è¡Œå˜æ¢ï¼Œæœ€åå¾—åˆ°ç»$K$æ¬¡å˜æ¢åçš„éšæœºå˜é‡$\mathbf{z}_t^K$ã€‚</p>
<p>åœ¨æ—¶é—´$t$ï¼Œpnetè¯•å›¾é€šè¿‡$\mathbf{z}<em>t^K$æ¥é‡æ„$\mathbf{x}_t$ã€‚é¦–å…ˆ$\mathbf{z}$ç©ºé—´ä¸­çš„å˜é‡ä¼šæ ¹æ®Linear Gaussian State Space Modelæ¥è¿›è¡Œâ€œè¿æ¥â€œï¼Œå…¬å¼ä¸º$\mathbf{z}_t=\mathbf{O}_\theta(\mathbf{T}_\theta\mathbf{z}</em>{t-1}+\mathbf{v}<em>t)+\boldsymbol{\epsilon}_t$ï¼Œå…¶ä¸­$\mathbf{O}_\theta$å’Œ$\mathbf{T}_\theta$ä¸ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œ$\mathbf{v}_t$å’Œ$\boldsymbol{\epsilon}_t$ä¸ºéšæœºå™ªå£°ã€‚ä¹‹å$\mathbf{z}_t$å’Œ$\mathbf{d}</em>{t-1}$ä¼šä½œä¸ºGRUçš„è¾“å…¥ï¼Œäº§ç”Ÿ$\mathbf{d}<em>t$ã€‚ä¹‹å$\mathbf{d}_t$ä¼šç»è¿‡æ ‡å‡†VAEä¸­çš„ç”Ÿæˆç½‘ç»œï¼Œé€šè¿‡ç½‘ç»œè¾“å‡ºçš„é«˜æ–¯åˆ†å¸ƒå‚æ•°$\mu</em>{x_t},\sigma_{x_t}$é‡‡æ ·å¾—åˆ°é‡æ„åçš„æ ·æœ¬$\mathbf{x}^\prime_t$ã€‚pnetä¸­æ¶‰åŠåˆ°çš„å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š<br>$$<br>\begin{align}<br>d_t&amp;=(1-c_t^d)\circ\text{tanh}(w^dz_t+u^d(r_t^d\circ d_{t-1})+b^d)+c_t^d\circ d_{t-1}\<br>\mu_{x_t}&amp;=w^{\mu_x}h^\theta(d_t)+b^{\mu_x}\<br>\sigma_{x_t}&amp;=\text{softplus}(w^{\sigma_x}h^\theta(d_t)+b^{\sigma_x})+\epsilon^{\sigma_x}<br>\end{align}<br>$$</p>
<p>å…¶ä¸­$r_t^d=\text{sigmoid}(\mathbf{w}^{r^d}\mathbf{x}<em>t+\mathbf{u}^{r^d}\mathbf{d}</em>{t-1}+b^{r^d})$æ˜¯GRUä¸­çš„é‡ç½®é—¨ï¼Œ$c_t^d=\text{sigmoid}(\mathbf{w}^{c^d}\mathbf{x}<em>t+\mathbf{u}^{c^d}\mathbf{d}</em>{t-1}+b^{c^d})$æ˜¯GRUä¸­çš„æ›´æ–°é—¨ã€‚</p>
<h2 id="Offline-Model-Training"><a href="#Offline-Model-Training" class="headerlink" title="Offline Model Training"></a>Offline Model Training</h2><p>å’Œä¼ ç»ŸVAEç±»ä¼¼ï¼Œæ¨¡å‹çš„è®­ç»ƒå¯ä»¥é€šè¿‡ä¼˜åŒ–ELBOæ¥å®Œæˆã€‚è®°é•¿åº¦ä¸º$T+1$çš„è¾“å…¥åºåˆ—ä¸º$\mathbf{x}<em>{t-T:t}$ï¼Œéšç©ºé—´å˜é‡é‡‡æ ·æ¬¡æ•°ä¸º$L$ï¼Œç¬¬$l$ä¸ªéšç©ºé—´å˜é‡ä¸º$\mathbf{l}^{(l)}</em>{t-T:t}$ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p>
<p>$$<br>\tilde{\mathcal{L}}(\mathbf{x}<em>{t-T:t})\approx\frac{1}{L}\sum</em>{t=1}^L[\log(p_\theta(\mathbf{x}<em>{t-T:t}|\mathbf{z}</em>{t-T:t}^{(l)}))+\log(p_\theta(\mathbf{z}<em>{t-T:t}^{(l)}))-\log(q_\phi(\mathbf{z}</em>{t-T:t}^|\mathbf{x}_{t-T:t}))]<br>$$</p>
<p>ç¬¬ä¸€é¡¹$\log(p_\theta(\mathbf{x}<em>{t-T:t}|\mathbf{z}</em>{t-T:t}^{(l)}))$å¯ä»¥çœ‹ä½œæ˜¯é‡æ„è¯¯å·®ï¼›ç¬¬äºŒé¡¹$\log(p_\theta(\mathbf{z}<em>{t-T:t}))=\sum</em>{i=t-T}^t \log(p_\theta(\mathbf{z}<em>i|\mathbf{z}</em>{i-1}))$é€šè¿‡Linear Gaussian State Space Modelè®¡ç®—ï¼›ç¬¬ä¸‰é¡¹$-\log(q_\phi(\mathbf{z}<em>{t-T:t}|\mathbf{x}</em>{t-T:t}))=-\sum_{i=t-T}^t\log(q_\phi(\mathbf{z}<em>i|\mathbf{z}</em>{i-1},\mathbf{x}_{t-T:i}))$ä¸ºéšå˜é‡$\mathbf{z}$åéªŒåˆ†å¸ƒçš„ä¼°è®¡ï¼ŒåŒæ—¶$\mathbf{z}_i$æ˜¯ç»Planar Normalizing Flowè½¬æ¢è¿‡çš„ã€‚</p>
<h2 id="Online-Detection"><a href="#Online-Detection" class="headerlink" title="Online Detection"></a>Online Detection</h2><p>åœ¨è®­ç»ƒå¥½æ¨¡å‹ä¹‹åï¼Œå°±å¯ä»¥è¿›è¡Œå¼‚å¸¸æ£€æµ‹äº†ã€‚åœ¨æ—¶é—´$t$ï¼Œæˆ‘ä»¬é€šè¿‡æ ¹æ®é•¿åº¦ä¸º$T+1$çš„åºåˆ—$\mathbf{x}<em>{t-T:t}$æ¥é‡æ„$\mathbf{x}_t$ï¼Œå¹¶æ ¹æ®é‡æ„æ¦‚ç‡$\log(p_\theta(\mathbf{x}_t|\mathbf{z}</em>{t-T:t}))$æ¥åˆ¤å®šå¼‚å¸¸ã€‚å®šä¹‰$\mathbf{x}<em>t$å¯¹åº”çš„å¼‚å¸¸åˆ†æ•°$S_t=\log(p_\theta(\mathbf{x}_t|\mathbf{z}</em>{t-T:t}))$ï¼Œé«˜å¼‚å¸¸åˆ†æ•°ä»£è¡¨æ ·æœ¬$\mathbf{x}_t$èƒ½å¤Ÿä»¥å¤§æ¦‚ç‡é‡æ„ï¼ˆå› ä¸ºæ¨¡å‹æ˜¯ç”¨æ­£å¸¸æ ·æœ¬è®­ç»ƒï¼Œå¯ä»¥è®¤ä¸ºæ¨¡å‹å»ºæ¨¡çš„æ˜¯æ­£å¸¸æ ·æœ¬çš„åˆ†å¸ƒï¼Œé‡æ„æ¦‚ç‡é«˜å°±ä»£è¡¨ç¬¦åˆæ­£å¸¸åˆ†å¸ƒï¼‰ã€‚ç»™å®šé˜ˆå€¼ä¹‹åä¾¿å¯æ ¹æ®å¼‚å¸¸åˆ†æ•°æ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤å®šã€‚</p>
<h2 id="Automatic-Threshold-Selection"><a href="#Automatic-Threshold-Selection" class="headerlink" title="Automatic Threshold Selection"></a>Automatic Threshold Selection</h2><p>åœ¨å¼‚å¸¸æ£€æµ‹é˜¶æ®µï¼Œéœ€è¦æ ¹æ®è®¾å®šçš„é˜ˆå€¼å’Œæ¯ä¸ªæ ·æœ¬çš„å¼‚å¸¸åˆ†æ•°æ¥åˆ¤æ–­è¯¥æ ·æœ¬æ˜¯å¦ä¸ºå¼‚å¸¸ï¼Œæ‰€ä»¥é˜ˆå€¼çš„é€‰æ‹©ååˆ†é‡è¦ã€‚æ–‡ä¸­ç”¨åˆ°äº†ä¸€ç§æ ¹æ®<strong>Extreme Value Theory</strong>è‡ªåŠ¨é€‰æ‹©é˜ˆå€¼çš„ç®—æ³•ã€‚å¯¹äºä¸€ä¸ªåˆ†å¸ƒï¼Œå…¶ä¸­çš„æç«¯äº‹ä»¶å¾€å¾€ä½äºåˆ†å¸ƒçš„æœ«å°¾ï¼Œè€ŒExtreme Value Theoryç¬¬ä¸€å®šç†ç»™å‡ºä¸ç®¡åŸå§‹åˆ†å¸ƒå¦‚ä½•ï¼Œè¿™äº›æç«¯äº‹ä»¶çš„åˆ†å¸ƒæœä»ä¸€ä¸ªå¸¦å‚çš„åˆ†å¸ƒæ—ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨å¯¹æ•°æ®åˆ†å¸ƒæœªçŸ¥çš„æƒ…å†µä¸‹ä¼°è®¡æç«¯äº‹ä»¶çš„åˆ†å¸ƒã€‚</p>
<p>é™¤äº†Extreme Value Theoryç¬¬ä¸€å®šç†ä¹‹å¤–ï¼ŒExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼$t$çš„åˆ†å¸ƒå¯ä»¥ç”¨Generalized Pareto Distributionæ¥æè¿°ã€‚ä½œè€…ä½¿ç”¨äº†åŸºäºExtreme Value Theoryç¬¬äºŒå®šç†çš„Peaks-Over-Thresholdç®—æ³•æ¥è¿›è¡Œé˜ˆå€¼çš„é€‰æ‹©ã€‚å› ä¸ºExtreme Value Theoryç¬¬äºŒå®šç†ç»™å‡ºéšæœºå˜é‡å¤§äºç‰¹å®šé˜ˆå€¼$t$çš„åˆ†å¸ƒï¼Œè€Œåœ¨æœ¬æ–‡çš„åœºæ™¯ä¸­æˆ‘ä»¬éœ€è¦åˆ»ç”»çš„å¼‚å¸¸ç‚¹çš„åˆ†å¸ƒåº”è¯¥æ˜¯å°äºä¸€ä¸ªç»™å®šé˜ˆå€¼çš„åˆ†å¸ƒï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹å…¬å¼ã€‚</p>
<p>å¯¹äºç»™å®šçš„æ•°æ®ï¼Œæ¨¡å‹ä¼šç»™å‡ºå¯¹åº”çš„å¼‚å¸¸åˆ†æ•°åºåˆ—${S_1,S_2,\cdots,S_{N^\prime}}$ï¼Œç»™å®šé¢„å…ˆè®¾å®šçš„é˜ˆå€¼$th$ï¼Œ$S_i$æç«¯éƒ¨åˆ†ï¼ˆå³å°äº$th$çš„éƒ¨åˆ†ï¼‰çš„åˆ†å¸ƒç¬¦åˆGeneralized Pareto Distributionï¼Œå…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>\bar{F}(s)=P(th-S&gt;s|S&lt;th)\sim(1+\frac{\gamma s}{\beta})^{-\frac{1}{\gamma}}<br>$$</p>
<p>å…¶ä¸­$\gamma$å’Œ$\beta$ä¸ºåˆ†å¸ƒçš„å½¢çŠ¶å‚æ•°ï¼Œæœ¬æ–‡ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ¥å¯¹å‚æ•°è¿›è¡Œä¼°è®¡ã€‚è®¾å‚æ•°çš„ä¼°è®¡å€¼åˆ†åˆ«ä¸º$\hat{\gamma}$å’Œ$\hat{\beta}$ï¼Œæœ€ç»ˆçš„é˜ˆå€¼$th_F$ç”±æ‹Ÿåˆå¾—åˆ°çš„åˆ†å¸ƒçš„åˆ†ä½æ•°ç¡®å®šï¼š</p>
<p>$$<br>th_F\simeq th-\frac{\hat{\beta}}{\hat{\gamma}}((\frac{qN^\prime}{N^\prime_{th}})^{-\hat{\gamma}}-1)<br>$$</p>
<p>å…¶ä¸­$q$ä¸ºæœŸæœ›$S&lt;th$çš„æ¦‚ç‡ï¼Œ$N^\prime$ä¸ºè§‚æµ‹å€¼çš„æ•°é‡ï¼Œ$N^\prime_{th}$ä¸º$S_i&lt;th$çš„ä¸ªæ•°ã€‚</p>
<h2 id="Anomaly-Interpretation"><a href="#Anomaly-Interpretation" class="headerlink" title="Anomaly Interpretation"></a>Anomaly Interpretation</h2><p>$$<br>\log(p_\theta(\mathbf{x}<em>t|\mathbf{z}</em>{t-T:t}))=\sum_{i=1}^M\log(p_\theta(x_t^i|\mathbf{z}_{t-T:t}))<br>$$</p>
<h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Datasets-and-Metrics"><a href="#Datasets-and-Metrics" class="headerlink" title="Datasets and Metrics"></a>Datasets and Metrics</h2><h2 id="Overall-Performance"><a href="#Overall-Performance" class="headerlink" title="Overall Performance"></a>Overall Performance</h2><p><img src="http://qfxiao.me/img/1571411131954.png" alt=""></p>
<p><img src="http://qfxiao.me/img/1571411148667.png" alt=""></p>
<h2 id="Effects-of-Major-Techniques"><a href="#Effects-of-Major-Techniques" class="headerlink" title="Effects of Major Techniques"></a>Effects of Major Techniques</h2><p><img src="http://qfxiao.me/img/1571411161522.png" alt=""></p>
<p><img src="http://qfxiao.me/img/1571411178434.png" alt=""></p>
<h2 id="Visualization-on-Z-Space-Representations"><a href="#Visualization-on-Z-Space-Representations" class="headerlink" title="Visualization on Z-Space Representations"></a>Visualization on Z-Space Representations</h2><p><img src="http://qfxiao.me/img/1571411190279.png" alt=""></p>
<p><img src="http://qfxiao.me/img/1571411212926.png" alt=""></p>
<p><img src="http://qfxiao.me/img/1571411223173.png" alt=""></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/10/16/GAIN-Missing-Data-Imputation-using-Generative-Adversarial-Nets/"><img class="thumbnail" src="http://qfxiao.me/img/1571228929894.png" alt="GAIN: Missing Data Imputation using Generative Adversarial Nets"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-16T12:19:10.000Z" title="2019-10-16T12:19:10.000Z">2019-10-16</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Time-Series-Imputation/">Time Series Imputation</a></span><span class="level-item">11 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1656 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/16/GAIN-Missing-Data-Imputation-using-Generative-Adversarial-Nets/">GAIN: Missing Data Imputation using Generative Adversarial Nets</a></h1><div class="content"><h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>æœ¬æ–‡åŸºäºGANæå‡ºäº†ä¸€ç§æ—¶é—´åºåˆ—ç¼ºå¤±å€¼å¡«å……ï¼ˆTime Series Imputationï¼‰çš„æ–¹æ³•ã€‚å…¶ä¸»è¦çš„æ€è·¯ä¸ºç”Ÿæˆå™¨$G$ä»éšç©ºé—´$Z$ç”Ÿæˆå®Œæ•´çš„æ ·æœ¬ï¼Œè€Œåˆ¤åˆ«å™¨$D$åˆ™è¾“å‡ºæ ·æœ¬ä¸­ä¸åŒéƒ¨åˆ†ä¸ºçœŸå®çš„æ¦‚ç‡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½œè€…æå‡ºäº†ä½¿ç”¨Hint Vectoræ¥æ­ç¤ºåŸå§‹æ•°æ®ä¸­ç¼ºå¤±éƒ¨åˆ†çš„ä¿¡æ¯ï¼Œæ¥ä¼˜åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚</p>
<p><a href="https://arxiv.org/abs/1806.02920">åŸæ–‡</a></p>
<h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="Problem-Formulation"><a href="#Problem-Formulation" class="headerlink" title="Problem Formulation"></a>Problem Formulation</h2><p>è€ƒè™‘ä¸€ä¸ª$d$ç»´çš„ç©ºé—´$\mathcal{X}=\mathcal{X}_1\times \cdots\times \mathcal{X}_d$ï¼Œè®¾$\mathbf{X}=(X_1,\cdots,X_d)$ç»´ç©ºé—´$\mathcal{X}$ä¸Šçš„éšæœºå‘é‡ï¼ˆå³ç†æƒ³çš„å®Œæ•´çš„æ—¶é—´åºåˆ—ï¼‰ï¼Œè®°å…¶åˆ†å¸ƒä¸º$P(\mathbf{X})$ã€‚è®¾$\mathbf{M}=(M_1,\cdots,M_d)$ä¸ºMaskå‘é‡è¡¨ç¤º$\mathbf{X}$ä¸­è¢«è§‚å¯Ÿåˆ°çš„éƒ¨åˆ†ã€‚ï¼ˆå³æ ‡è¯†æ—¶é—´åºåˆ—å“ªäº›éƒ¨åˆ†æœ‰ç¼ºå¤±ï¼‰ï¼Œå–å€¼ä¸º${0,1}^d$ã€‚</p>
<p>å¯¹äºæ¯ä¸€ä¸ª$i\in{1,\cdots,d}$ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°ç©ºé—´$\tilde{\mathcal{X}}=\mathcal{X}\cup{<em>}$ï¼Œå…¶ä¸­$</em>$è¡¨ç¤ºä¸å±äºä»»æ„$\mathcal{X}<em>i$çš„ä¸€ä¸ªç‚¹ã€‚ä»¤$\tilde{\mathcal{X}}=\tilde{\mathcal{X}_1}\times\cdots\times\tilde{\mathcal{X}_d}$ï¼ŒåŒæ—¶å®šä¹‰ä¸€ä¸ªæ–°çš„éšæœºå˜é‡ï¼ˆå³æˆ‘ä»¬è§‚æµ‹åˆ°çš„å«æœ‰ç¼ºå¤±å€¼çš„æ—¶é—´åºåˆ—ï¼‰$\tilde{\mathbf{X}}=(\tilde{X}_1,\cdots,\tilde{X}_d)\in \tilde{\mathcal{X}}$ï¼š<br>$$<br>\tilde{X}_i=\begin{cases}X_i,&amp;\text{if } M_i=1\*,&amp;\text{otherwise}\end{cases}<br>$$<br>å‡è®¾æ•°æ®é›†çš„å½¢å¼ä¸º$\mathcal{D}={(\tilde{x}^i,m^i)}^n</em>{i=1}$ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ä»$P(\mathbf{X}|\tilde{\mathbf{X}}=\tilde{x}^i)$ä¸Šé‡‡æ ·æ¥å¯¹ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ã€‚</p>
<h2 id="Model-Architecture"><a href="#Model-Architecture" class="headerlink" title="Model Architecture"></a>Model Architecture</h2><p>æ¨¡å‹çš„æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1571228929894.png" alt=""></p>
<h3 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h3><p>ç”Ÿæˆå™¨çš„è¾“å…¥æœ‰ä¸‰é¡¹ï¼š$\tilde{\mathbf{X}}$ï¼Œ$\mathbf{M}$å’Œéšæœºå™ªå£°$\mathbf{Z}$ï¼Œè¾“å‡ºè®¾ä¸º$\bar{\mathbf{X}}$ã€‚è®¾ç”Ÿæˆå™¨ä¸ºæ˜ å°„$G: \tilde{\mathcal{X}}\times{0,1}^d\times[0,1]^d\rightarrow \mathcal{X}$ï¼Œè€Œ$\mathbf{Z}$ä¸º$d$ç»´çš„é«˜æ–¯å™ªå£°ã€‚ç”Ÿæˆå™¨çš„è¾“å‡ºå’Œå¡«å……åçš„æ—¶é—´åºåˆ—å®šä¹‰ä¸ºï¼š<br>$$<br>\begin{align}<br>\bar{\mathbf{X}}&amp;=G(\tilde{\mathbf{X}},\mathbf{M},(1-\mathbf{M})\odot\mathbf{Z})\<br>\hat{\mathbf{X}}&amp;=\mathbf{M}\odot\tilde{\mathbf{X}}+(1-\mathbf{M})\odot\bar{\mathbf{X}}<br>\end{align}<br>$$<br>$\bar{\mathbf{X}}$å³ä¸ºç”Ÿæˆå™¨çš„ç›´æ¥è¾“å‡ºï¼Œå› ä¸ºå…¶å®æœ‰äº›éƒ¨åˆ†æ²¡æœ‰ç¼ºå¤±ï¼Œç”Ÿæˆå™¨è¿˜æ˜¯ä¼šä¸ºæ¯ä¸ªéƒ¨åˆ†è¾“å‡ºå€¼ã€‚</p>
<p>$\hat{\mathbf{X}}$ä¸ºå¡«å……åçš„æ—¶é—´åºåˆ—ï¼Œå¯¹äºç¼ºå¤±çš„éƒ¨åˆ†é‡‡ç”¨ç”Ÿæˆå™¨çš„è¾“å‡ºè¿›è¡Œå¡«å……ã€‚</p>
<h3 id="Discriminator"><a href="#Discriminator" class="headerlink" title="Discriminator"></a>Discriminator</h3><p>å’ŒåŸå§‹çš„GANä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ¤æ–­æ•´ä¸ªæ ·æœ¬æ˜¯çœŸå®çš„æˆ–è€…æ˜¯ç”Ÿæˆçš„ï¼Œè€Œæ˜¯éœ€è¦åˆ¤æ–­æ ·æœ¬çš„é‚£äº›éƒ¨åˆ†æ˜¯çœŸå®çš„æˆ–è€…æ˜¯ç”Ÿæˆçš„ï¼Œæ‰€ä»¥åˆ¤åˆ«å™¨ä¸ºæ˜ å°„$D: \mathcal{X}\rightarrow[0,1]^d$ã€‚åˆ¤åˆ«å™¨çš„å…·ä½“ç›®æ ‡å‡½æ•°å°†åœ¨åé¢è®¨è®ºã€‚</p>
<h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a>Hint</h3><p>Hintæ˜¯ä¸€ç§æç¤ºæœºå€¼ï¼Œæ˜¯ä¸€ä¸ªå’Œ$\mathbf{X}$ç›¸åŒç»´åº¦çš„éšæœºå˜é‡$\mathbf{H}$ï¼Œå…¶åˆ†å¸ƒä¾èµ–äº$\mathbf{M}$ã€‚$\mathbf{H}$æ˜¯ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰çš„ï¼Œç›¸å½“äºä¸€ç§ä¸å®Œæ•´çš„$\mathbf{M}$ï¼Œç”¨æ¥ä½œä¸ºåˆ¤åˆ«å™¨çš„é¢å¤–è¾“å…¥ã€‚</p>
<h3 id="Objective"><a href="#Objective" class="headerlink" title="Objective"></a>Objective</h3><p>æˆ‘ä»¬è®­ç»ƒåˆ¤åˆ«å™¨æœ€å¤§åŒ–æ­£ç¡®é¢„æµ‹$\mathbf{M}$çš„æ¦‚ç‡ï¼Œè€Œç”Ÿæˆå™¨æœ€å°åŒ–åˆ¤åˆ«å™¨æ­£ç¡®é¢„æµ‹$\mathbf{M}$çš„æ¦‚ç‡ï¼Œç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š<br>$$<br>\begin{align}<br>V(D,G)=&amp;\mathbb{E}<em>{\hat{X},M,H}[\mathbf{M}^T\log D(\hat{\mathbf{X}},\mathbf{H})\&amp;+(1-\mathbf{M})^T\log(1-D(\hat{\mathbf{X}},\mathbf{H}))]<br>\end{align}<br>$$<br>æŒ‰ç…§æ ‡å‡†çš„GANå¯ä»¥å°†ä¼˜åŒ–å‡½æ•°å†™æˆä»¥ä¸‹çš„å½¢å¼ï¼š<br>$$<br>\min_G\max_D V(D,G)<br>$$<br>åœ¨è¿™é‡Œåˆ¤åˆ«å™¨çš„ä»»åŠ¡å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªäºŒåˆ†ç±»ï¼Œè€Œç›®æ ‡å‡½æ•°å°±æ˜¯äºŒå€¼äº¤å‰ç†µçš„å®šä¹‰ï¼Œå› æ­¤å¯ä»¥å†™ä¸ºï¼š<br>$$<br>\mathcal{L}(a,b)=\sum\limits</em>{i=1}^d[a_i\log(b_i)+(1-a_i)\log(1-b_i)]<br>$$<br>$\mathbf{M}$å¯ä»¥çœ‹ä½œGround Truthï¼Œè®°$\hat{\mathbf{M}}=D(\hat{\mathbf{X},\mathbf{H}})$ï¼Œå³åˆ¤åˆ«å™¨è¾“å‡ºçš„é¢„æµ‹ï¼Œå› æ­¤ä¼˜åŒ–å‡½æ•°å¯ä»¥ç®€è®°ä¸ºï¼š<br>$$<br>\min_G\max_D\mathbb{E}[\mathcal{L}(\mathbf{M},\hat{\mathbf{M}})]<br>$$</p>
<h2 id="GAIN-Algorithm"><a href="#GAIN-Algorithm" class="headerlink" title="GAIN Algorithm"></a>GAIN Algorithm</h2><p>ä¸‹é¢è®¨è®ºGAINç®—æ³•çš„è®­ç»ƒæµç¨‹ã€‚</p>
<p>æœ¬æ–‡é€šè¿‡ç†è®ºè®¨è®ºï¼Œç»™å‡ºäº†ç”ŸæˆHint Vectorçš„ä¸€ä¸ªæ–¹æ³•ï¼Œé¦–å…ˆå®šä¹‰éšæœºå˜é‡$\mathbf{B}=(B_1,\cdots,B_d)\in{0,1}^d$ï¼Œ$\mathbf{B}$é€šè¿‡ä»${1,\cdots,d}$éšæœºå‡åŒ€é‡‡æ ·ä¸€ä¸ª$k$ï¼Œç„¶åç”±ä¸‹åˆ—å…¬å¼å¾—åˆ°ï¼š<br>$$<br>B_j=\begin{cases}1, &amp;\text{if }j\neq k\0, &amp;\text{if }j=k\end{cases}<br>$$<br>å®šä¹‰ç©ºé—´$\mathcal{H}={0,0.5,1}^d$ï¼ŒHint Vectorä¸º$\mathbf{H}=\mathbf{B}\odot\mathbf{M}+0.5(1-\mathbf{B})\in\mathcal{H}$ã€‚</p>
<p>åˆ¤åˆ«å™¨çš„è®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼šå›ºå®šç”Ÿæˆå™¨$G$ï¼Œå¯¹ä¸€ä¸ªå¤§å°ä¸º$k_D$çš„mini-batchï¼Œç‹¬ç«‹åŒåˆ†å¸ƒé‡‡æ ·$k_D$ä¸ª$z$å’Œ$b$ï¼Œç”¨æ¥è®¡ç®—$\mathbf{Z}$å’Œ$\mathbf{B}$ã€‚åˆ¤åˆ«å™¨çš„æŸå¤±å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š<br>$$<br>\mathcal{L}<em>D(m,\hat{m},b)=\sum\limits</em>{i:b_i=0}[m_i\log(\hat{m}<em>i)+(1-m_i)\log(1-\hat{m}_i)]<br>$$<br>åˆ¤åˆ«å™¨çš„ä¼˜åŒ–å‡½æ•°ä¸ºï¼š<br>$$<br>\min_D-\sum\limits</em>{j=1}^{k_D}\mathcal{L}_D(m(j),\hat{m}(j),b(j))<br>$$<br>å…¶ä¸­$\hat{m}(j)=D(\hat{x}(j),m(j))$ã€‚</p>
<p>åœ¨ä¼˜åŒ–äº†åˆ¤åˆ«å™¨ä¹‹åï¼Œéœ€è¦ä¼˜åŒ–ç”Ÿæˆå™¨ï¼Œå¯¹ä¸€ä¸ªå¤§å°ä¸º$k_G$çš„mini-batchï¼Œç”Ÿæˆå™¨çš„æŸå¤±å‡½æ•°åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯åœ¨ç¼ºå¤±éƒ¨åˆ†çš„æŸå¤±ï¼š</p>
<p>$$<br>\mathcal{L}<em>G(m,\hat{m},b)=-\sum\limits</em>{i:b_i=0}(1-m_i)\log(\hat{m}<em>i)<br>$$<br>ä¸€ä¸ªæ˜¯æœªç¼ºå¤±éƒ¨åˆ†çš„æŸå¤±ï¼š<br>$$<br>\mathcal{L}_M(x,x^\prime)=\sum\limits</em>{i=1}^d m_iL_M(x_i,x_i^\prime)<br>$$<br>å…¶ä¸­ï¼š<br>$$<br>L_M(x_i,x_i^\prime)=\begin{cases}(x_i^\prime-x_i)^2, &amp;\text{if }x_i\text{ is continuours},\-x_i\log(x_i^\prime), &amp;\text{if }x_i\text{ is binary}.\end{cases}<br>$$<br>æœ€ç»ˆçš„ä¼˜åŒ–å‡½æ•°ä¸ºï¼š<br>$$<br>\min_G\sum\limits_{j=1}^{k_G}\mathcal{L}_G(m(j),\hat{m}(j),b(j))+\alpha\mathcal{L}_M(\tilde{x}(j),\hat{x}(j))<br>$$<br>ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1571228999385.png" alt=""></p>
<h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><p>ä¸‹è¡¨ä¸ºåœ¨5ä¸ªä¸åŒæ•°æ®é›†ä¸Šå®éªŒï¼Œä¸å…¶ä»–5ç§æ–¹æ³•å¯¹æ¯”çš„ç»“æœï¼š</p>
<p><img src="http://qfxiao.me/img/1571229028097.png" alt=""></p>
<p>ä¸Šå›¾ä¸ºGAINã€MissForestå’ŒAutoencoderä¸‰ç§æ¨¡å‹åœ¨ä¸åŒç¼ºå¤±æ¯”ä¾‹ã€æ ·æœ¬æ•°é‡ã€ç‰¹å¾ç»´åº¦ä¸‹çš„å¯¹æ¯”æ›²çº¿å›¾ã€‚</p>
<p>ä¸‹è¡¨ä¸ºä½¿ç”¨ä¸åŒæ¨¡å‹å¯¹æ—¶é—´åºåˆ—è¿›è¡Œå¡«å……ä¹‹åï¼Œä½¿ç”¨é€»è¾‘å›å½’è¿›è¡Œå›å½’ä»»åŠ¡çš„æ€§èƒ½ï¼š</p>
<p><img src="http://qfxiao.me/img/1571229051484.png" alt=""></p>
<p>ä¸‹å›¾ä¸ºGAINã€MissForestå’ŒAutoencoderä¸‰ç§æ¨¡å‹åœ¨ä¸åŒç¼ºå¤±æ¯”ä¾‹ä¸‹çš„AUROCæ›²çº¿å›¾ï¼š</p>
<p><img src="http://qfxiao.me/img/1571229066600.png" alt=""></p>
<p>ä¸‹è¡¨å±•ç¤ºçš„æ˜¯ä½œè€…å¯¹æ—¶é—´åºåˆ—å¡«å……ç®—æ³•ä¿æŒç‰¹å¾-æ ‡ç­¾å…³ç³»çš„èƒ½åŠ›ã€‚ä½œè€…åˆ†åˆ«ç”¨å®Œæ•´çš„æ•°æ®å’Œå¡«å……åçš„æ•°æ®ç”¨é€»è¾‘å›å½’æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œå°†ä¸¤è€…çš„æƒé‡æ±‚ç»å¯¹å€¼å’Œå‡æ–¹æ ¹çš„ç»“æœã€‚</p>
<p><img src="http://qfxiao.me/img/1571229079632.png" alt=""></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/"><img class="thumbnail" src="http://qfxiao.me/img/1565783729478.png" alt="Anomaly Detection with Generative Adversarial Networks for Multivariate Time Series"></a></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-09-22T14:32:18.000Z" title="2019-09-22T14:32:18.000Z">2019-09-22</time><span class="level-item"><a class="link-muted" href="/categories/Research/">Research</a><span>Â /Â </span><a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></span><span class="level-item">10 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 1568 ä¸ªå­—)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/09/22/Anomaly-Detection-with-Generative-Adversarial-Networks-for-Multivariate-Time-Series/">Anomaly Detection with Generative Adversarial Networks for Multivariate Time Series</a></h1><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>è¿™ç¯‡æ–‡ç« æå‡ºäº†ä¸€ä¸ªåŸºäºGANçš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹æ¨¡å‹ã€‚</p>
<p><a href="https://arxiv.org/abs/1809.04758">åŸæ–‡</a></p>
<h2 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h2><ol>
<li>æå‡ºäº†åŸºäºGANçš„æ—¶é—´åºåˆ—æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹æ¨¡å‹</li>
<li>æˆ‘ä»¬ä½¿ç”¨åŸºäºLSTMçš„GANæ¥å¯¹å¤šå˜é‡æ—¶é—´åºåˆ—è¿›è¡Œå»ºæ¨¡</li>
<li>ç»“åˆä½¿ç”¨äº†Residual Losså’ŒDiscrimination Lossæ¥è¿›è¡Œå¼‚å¸¸çš„åˆ¤æ–­</li>
</ol>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><h3 id="Generative-Adversarial-Networks"><a href="#Generative-Adversarial-Networks" class="headerlink" title="Generative Adversarial Networks"></a>Generative Adversarial Networks</h3><h4 id="GANs-In-a-Nutshell-an-extremely-simple-explanation"><a href="#GANs-In-a-Nutshell-an-extremely-simple-explanation" class="headerlink" title="GANs In a Nutshell, an extremely simple explanation"></a>GANs In a Nutshell, an extremely simple explanation</h4><ul>
<li>æˆ‘ä»¬æƒ³è¦ä»ä¸€ä¸ªå¤æ‚çš„ã€é«˜ç»´çš„æ•°æ®åˆ†å¸ƒ$p_r(x)$ä¸Šé‡‡æ ·å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ç‚¹ï¼Œç„¶è€Œ$p_r(x)$æ— æ³•ç›´æ¥æ±‚å¾—</li>
<li>ä»£æ›¿æ–¹æ³•ï¼šä»ä¸€ä¸ªç®€å•çš„ã€å·²çŸ¥çš„åˆ†å¸ƒ$p_z(z)$ä¸Šé‡‡æ ·ï¼Œç„¶åå­¦ä¹ ä¸€ä¸ªTransformation $G(z): z\rightarrow x$æ¥å°†$z$æ˜ å°„åˆ°$x$</li>
</ul>
<p><img src="http://qfxiao.me/img/1565836885697.png" alt=""></p>
<h4 id="Training-Two-player-Game"><a href="#Training-Two-player-Game" class="headerlink" title="Training: Two-player Game"></a>Training: Two-player Game</h4><ul>
<li>*<em>Generator Network: *</em> ä»éšæœºåˆ†å¸ƒ$p_z(z)$é‡‡æ ·$z$ï¼Œé€šè¿‡æ˜ å°„ç”Ÿæˆæ ·æœ¬$x$ï¼Œè¿™ä¸ªç”Ÿæˆçš„æ ·æœ¬è¦å°½é‡â€œçœŸå®â€ã€‚æ€ä¹ˆâ€œçœŸå®â€ï¼Ÿä¼˜åŒ–ç”Ÿæˆå™¨å‚æ•°$\theta_G$æœ€å¤§åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†å³å¯</li>
<li>*<em>Discriminator Network: *</em>æ¥å—ä¸€ä¸ªæ ·æœ¬$x$ï¼Œåˆ¤æ–­å…¶æ˜¯ç”Ÿæˆçš„æ ·æœ¬è¿˜æ˜¯çœŸå®çš„æ ·æœ¬ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œæˆ‘ä»¬æ˜¯çŸ¥é“ä¸€ä¸ªæ ·æœ¬$x$åˆ°åº•æ˜¯ç”Ÿæˆçš„è¿˜æ˜¯çœŸå®çš„ï¼Œæ‰€ä»¥ä¼˜åŒ–åˆ¤åˆ«å™¨å‚æ•°$\theta_D$æœ€å°åŒ–åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†ï¼Œæœ€å¤§åŒ–å¯¹çœŸå®æ ·æœ¬çš„è¯„åˆ†ï¼ˆå³æœ€å¤§åŒ–åˆ†è¾¨çœŸå®æ ·æœ¬çš„èƒ½åŠ›ï¼‰</li>
</ul>
<p><img src="http://qfxiao.me/img/1565836982707.png" alt=""></p>
<p>å½¢å¼åŒ–çš„æ¥è®²ï¼Œä¼˜åŒ–å‡½æ•°å¦‚ä¸‹ï¼š</p>
<p>$$\min\limits_{\theta_G}\max\limits_{\theta_D}V(G,D)=\mathbb{E}<em>{x\sim p</em>{data}(x)\log(\underbrace{D_{\theta{D}}(x)}<em>{åˆ¤åˆ«å™¨å¯¹çœŸå®æ ·æœ¬çš„è¯„åˆ†})}+\mathbb{E}</em>{z\sim p_z(z)}\log(1-\underbrace{D_{\theta_d}(G_{\theta_G}(z))}_{åˆ¤åˆ«å™¨å¯¹ç”Ÿæˆæ ·æœ¬çš„è¯„åˆ†})$$</p>
<p>è®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1565837745003.png" alt=""></p>
<h3 id="Long-Short-Time-Memory-Networks"><a href="#Long-Short-Time-Memory-Networks" class="headerlink" title="Long Short Time Memory Networks"></a>Long Short Time Memory Networks</h3><h4 id="Vanilla-Recurrent-Neural-Networks"><a href="#Vanilla-Recurrent-Neural-Networks" class="headerlink" title="Vanilla Recurrent Neural Networks"></a>Vanilla Recurrent Neural Networks</h4><p>æ™®é€šçš„ç¥ç»ç½‘ç»œï¼š</p>
<p><img src="http://images0.cnblogs.com/blog2015/680781/201508/021735264703915.png" alt=""></p>
<p>æ¦‚æ‹¬çš„æ¥è®²ï¼Œå¯ä»¥æ¶µç›–ä¸ºä¸€ä¸ªå…¬å¼$\hat{\mathbf{y}}=f(\mathbf{x})$ã€‚å¯¹äºä¸€ä¸ªæ ·æœ¬$\mathbf{x}$ï¼Œé€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œæ˜ å°„ï¼Œè¾“å‡º$\mathbf{y}$ã€‚</p>
<p>å¯¹äºRNNï¼Œæˆ‘ä»¬å¤„ç†çš„æ˜¯åºåˆ—æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰æ ·æœ¬ä¹‹é—´å¹¶ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚å¯¹äºä¸€ä¸ªåºåˆ—ä¸­çš„ä¸€ä¸ªæ ·æœ¬$x_t\in{x_1,x_2,\cdots,x_n}$ï¼Œå°†å…¶è¾“å…¥åˆ°ç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œä¸ºäº†å»ºæ¨¡$x_t$ä¹‹å‰çš„å­åºåˆ—å¯¹$x_t$çš„å½±å“å…³ç³»ï¼Œéœ€è¦å°†è¿™ä¸ªå­åºåˆ—çš„ä¿¡æ¯ä¹Ÿè¾“å…¥åˆ°ç¥ç»ç½‘ç»œä¸­ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿä¸ºæ¯ä¸€ä¸ªæ ·æœ¬ç‚¹ä¿å­˜ä¸€ä¸ªStateã€‚å³å®šä¹‰$h_t=g(\hat{y_t})=g(f(x_t))$ï¼Œå¯¹äºå½“å‰æ ·æœ¬ç‚¹ï¼Œ$\hat{y_t}=f(x_t,h_{t-1})$ã€‚ä¹Ÿå°±æ˜¯è¯´ç¥ç»ç½‘ç»œçš„è¾“å…¥ä¸ä»…åŒ…å«äº†å½“å‰æ ·æœ¬ç‚¹çš„ç‰¹å¾ï¼Œä¹ŸåŒ…å«äº†ä¸Šä¸€ä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€(ä¸Šä¸€ä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€åˆéšå«äº†ä¸Šä¸Šä¸ªæ ·æœ¬ç‚¹çš„â€œçŠ¶æ€â€â€¦)ï¼Œå°±åƒæ˜¯ä¸ºç½‘ç»œåŠ ä¸Šäº†çŸ­æœŸè®°å¿†ã€‚</p>
<p><img src="https://adventuresinmachinelearning.com/wp-content/uploads/2017/09/Recurrent-neural-network.png" alt=""></p>
<p><img src="http://qfxiao.me/img/1565838639451.png" alt=""></p>
<p><img src="http://qfxiao.me/img/1565838658532.png" alt=""></p>
<h4 id="Gradient-Flow-of-Vanilla-RNN"><a href="#Gradient-Flow-of-Vanilla-RNN" class="headerlink" title="Gradient Flow of Vanilla RNN"></a>Gradient Flow of Vanilla RNN</h4><p>ä¸‹é¢æ¥è¿›è¡Œä¸€äº›å½¢å¼åŒ–çš„å®šä¹‰ï¼Œå‡è®¾åœ¨æ—¶åˆ»$t$ç½‘ç»œè¾“å…¥ç‰¹å¾ä¸º$x_t$ï¼Œè¾“å‡ºéšå«çŠ¶æ€ä¸º$h_{t}$ï¼Œå…¶ä¸ä»…å’Œå½“å‰è¾“å…¥$x_t$æœ‰å…³ï¼Œè¿˜å’Œä¸Šä¸€ä¸ªéšå«çŠ¶æ€$h_{t-1}$æœ‰å…³ï¼š</p>
<ul>
<li>å½“å‰æ—¶åˆ»æ€»çš„å‡€è¾“å…¥$z_t=Uh_{t-1}+Wx_t+b$</li>
<li>å½“å‰æ—¶åˆ»è¾“å‡ºéšå«çŠ¶æ€$h_t=f(z_t)$</li>
<li>å½“å‰æ—¶åˆ»è¾“å‡º$\hat{y}_t=Vh_t$</li>
</ul>
<p>RNNçš„æ¢¯åº¦æ›´æ–°å…¬å¼(æ¨å¯¼è¿‡ç¨‹æ¯”è¾ƒå¤æ‚)ï¼š</p>
<p>$$\frac{\partial{\mathcal{L}}}{\partial U}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t \delta_{t,k}\mathbf{h}_{k-1}^T$$</p>
<p>$$\frac{\partial{\mathcal{L}}}{\partial{W}}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t \delta_{t,k}x_k^T$$</p>
<p>$$\frac{\partial\mathcal{L}}{\partial{b}}=\sum\limits_{t=1}^T\sum\limits_{k=1}^t\delta_{t,k}$$</p>
<p>å…¶ä¸­$\delta_{t,k}=\frac{\partial{\mathcal{L}}}{\partial{z_k}}=\text{diag}(f^\prime(z_k))U^T\delta_{t,k+1}$å®šä¹‰ä¸ºç¬¬$t$æ—¶åˆ»çš„æŸå¤±å¯¹ç¬¬$k$æ—¶åˆ»éšè—ç¥ç»å±‚çš„å‡€è¾“å…¥$z_k$çš„å¯¼æ•°ï¼Œä¸”$z_k=Uh_{k-1}+Wx_k+b,1\leq k&lt;t$ã€‚</p>
<p>RNNçš„æ¢¯åº¦æµå‘å¦‚ä¸‹å›¾çº¢ç®­å¤´æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565838776226.png" alt=""></p>
<p>RNNä¼šé‡åˆ°æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚æ ¹æ®å‰é¢çš„å…¬å¼ï¼Œ$\delta_{t,k}$å®é™…ä¸Šæ˜¯é€’å½’å®šä¹‰çš„ï¼Œå±•å¼€å¾—åˆ°ï¼š</p>
<p>$$\delta_{t,k}=\prod\limits_{\tau=k}^{t-1}(\text{diag}(f^\prime(z_\tau))U^T)\delta_{t,t}$$</p>
<p>å¦‚æœå®šä¹‰$\gamma\cong\parallel\text{diag}(f^\prime(z_\tau))U^T\parallel$ï¼Œé‚£ä¹ˆ$\delta_{t,k}\cong\gamma^{t-k}\delta_{t,t}$ã€‚åœ¨$t-k$å¾ˆå¤§æ—¶ï¼Œ$\gamma&lt;1$ä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼Œ$\gamma&gt;1$æ—¶ä¼šå¯¼è‡´æ¢¯åº¦çˆ†ç‚¸ã€‚</p>
<p><img src="http://qfxiao.me/img/1565839064829.png" alt=""></p>
<p><img src="http://qfxiao.me/img/1565839083693.png" alt=""></p>
<h4 id="Long-Short-Time-Memory"><a href="#Long-Short-Time-Memory" class="headerlink" title="Long Short Time Memory"></a>Long Short Time Memory</h4><p>LSTMæ˜¯ä¸€ç§è§£å†³RNNæ¢¯åº¦æ¶ˆå¤±é—®é¢˜çš„æ”¹è¿›ç‰ˆæœ¬ï¼š</p>
<p><img src="http://qfxiao.me/img/1565839135232.png" alt=""></p>
<p>åœ¨LSTMä¸­ï¼Œç»´æŠ¤äº†ä¸¤ä¸ªStateï¼Œ$c_t$å’Œ$h_t$ã€‚å…¶ä¸­$c_t$ç”±é—å¿˜é—¨$f$ä¸ä¸Šä¸€ä¸ª$c_{t-1}$ç›¸ä¹˜(ä»£è¡¨ç»§æ‰¿ä¸Šä¸€ä¸ªCellçš„ä¿¡æ¯å¹¶åŠ ä»¥ä¸€å®šç¨‹åº¦çš„é—å¿˜)ï¼ŒåŠ ä¸Šè¾“å‡ºé—¨$i$ä¸Gate Gate $g$ç›¸ä¹˜(Gate Gateä»£è¡¨å½“å‰çš„å€™é€‰çŠ¶æ€ï¼Œè¾“å‡ºé—¨$i$æ§åˆ¶å½“å‰å€™é€‰çŠ¶æ€æœ‰å¤šå°‘ä¿¡æ¯éœ€è¦ä¿å­˜)ã€‚æœ€åï¼Œè¾“å‡ºé—¨$o$æ§åˆ¶å½“å‰æ—¶åˆ»çš„Cell State $c_t$æœ‰å¤šå°‘ä¿¡æ¯éœ€è¦è¾“å‡ºç»™å¤–éƒ¨çŠ¶æ€$h_t$ã€‚</p>
<p>ä¸‰ä¸ªé—¨çš„è®¡ç®—æ–¹å¼ä¸ºï¼š </p>
<p>$$i_t=\sigma(W_ix_t+U_ih_{t-1}+b_i)$$</p>
<p>$$f_t=\sigma(W_fx_t+U_fh_{t-1}+b_f)$$</p>
<p>$$o_t=\sigma(W_ox_t+U_oh_{t-1}+b_o)$$</p>
<p><img src="http://qfxiao.me/img/1565839263008.png" alt=""></p>
<p><img src="http://qfxiao.me/img/1565839279246.png" alt=""></p>
<h2 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h2><p>æ€»ä½“æ¡†æ¶å›¾å¦‚Fig 1æ‰€ç¤ºï¼š</p>
<p><img src="http://qfxiao.me/img/1565783729478.png" alt=""></p>
<h3 id="GAN-with-LSTM-RNN"><a href="#GAN-with-LSTM-RNN" class="headerlink" title="GAN with LSTM-RNN"></a>GAN with LSTM-RNN</h3><p>ç½‘ç»œç»“æ„ä¸Šç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨éƒ½æ˜¯LSTMï¼Œä¼˜åŒ–å‡½æ•°å’Œæ™®é€šGANä¸€æ ·ï¼š</p>
<p>$$\min\limits_G\max\limits_D V(D,G)=\mathbb{E}<em>{x\sim p</em>{data}(x)}[\log D(x)]+\mathbb{E}_{z\sim p_z(z)}[\log (1-D(G(z)))]$$</p>
<h3 id="GAN-based-Anomaly-Score"><a href="#GAN-based-Anomaly-Score" class="headerlink" title="GAN-based Anomaly Score"></a>GAN-based Anomaly Score</h3><p>åœ¨æµ‹è¯•é˜¶æ®µï¼Œéœ€è¦ä½¿ç”¨æ¢¯åº¦ä¼˜åŒ–å¯»æ‰¾ä¸€ä¸ªä½¿å¾—$G_{rnn}(z)$æœ€æ¥è¿‘$X^{test}$çš„$z^k$ï¼š</p>
<p>$$\min\limits_{Z^k}Error(X^{test},G_{rnn}(Z^k))=1-Similarity(X^{test},G_{rnn}(Z^k))$$</p>
<p>æœ¬æ–‡å®šä¹‰äº†ä¸¤ç§Anomaly Scoreï¼Œä¸€ç§æ˜¯Residual Lossï¼š</p>
<p>$$Res(X^{test}<em>t)=\sum\limits</em>{i=1}^n|x^{test,i}<em>t-G</em>{rnn}(Z^{k,i}_t)|$$</p>
<p>ä¸€ç§æ˜¯Discrimination Lossï¼Œå³åˆ¤åˆ«å™¨çš„è¾“å‡º$D_{rnn}(x_t^{test})$ã€‚</p>
<p>æ€»çš„Anomaly Scoreï¼š</p>
<p>$$S^{test}<em>t=\lambda Res(X^{test}_t)+(1-\lambda)D</em>{rnn}(x^{test}_t)$$</p>
<h3 id="Anomaly-Detection-Framework"><a href="#Anomaly-Detection-Framework" class="headerlink" title="Anomaly Detection Framework"></a>Anomaly Detection Framework</h3><p>æ¨¡å‹çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="http://qfxiao.me/img/1565784946781.png" alt=""></p>
<p>ç”±äºæœ¬æ–‡æ˜¯å¤šå˜é‡æ—¶é—´åºåˆ—é¢„æµ‹ï¼Œè€Œä¸”æ—¶é—´åºåˆ—çš„é•¿åº¦æœ‰å¯èƒ½æ¯”è¾ƒé•¿ï¼Œä½œè€…ä½¿ç”¨äº†æ»‘åŠ¨çª—å£å’ŒPCAæ¥è¿›è¡Œé¢„å¤„ç†ã€‚</p>
<h2 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h2><p><img src="http://qfxiao.me/img/1565847175265.png" alt=""></p>
</div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/tags/Deep-Learning/page/0/">ä¸Šä¸€é¡µ</a></div><div class="pagination-next"><a href="/tags/Deep-Learning/page/2/">ä¸‹ä¸€é¡µ</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/tags/Deep-Learning/">1</a></li><li><a class="pagination-link" href="/tags/Deep-Learning/page/2/">2</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block line-height-inherit">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">17</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags"><p class="title">12</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">é“¾æ¥</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†ç±»</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Research/"><span class="level-start"><span class="level-item">Research</span></span><span class="level-end"><span class="level-item tag">16</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Research/Anomaly-Detection/"><span class="level-start"><span class="level-item">Anomaly Detection</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/GAN/"><span class="level-start"><span class="level-item">GAN</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/Misc/"><span class="level-start"><span class="level-item">Misc</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/RNN/"><span class="level-start"><span class="level-item">RNN</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/Time-Series-Imputation/"><span class="level-start"><span class="level-item">Time Series Imputation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Research/Tutorial/"><span class="level-start"><span class="level-item">Tutorial</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/Technical-Notes/"><span class="level-start"><span class="level-item">Technical Notes</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/Technical-Notes/Misc/"><span class="level-start"><span class="level-item">Misc</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><a class="media-left" href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200301230011495.png" alt="Discovering Physical Concepts with Neural Networks"></p></a><div class="media-content size-small"><p><time dateTime="2020-03-01T14:55:02.000Z">2020-03-01</time></p><p class="title is-6"><a class="link-muted" href="/2020/03/01/Discovering-Physical-Concepts-with-Neural-Networks/">Discovering Physical Concepts with Neural Networks</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Misc/">Misc</a></p></div></article><article class="media"><a class="media-left" href="/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200109102830713.png" alt="Transfer Anomaly Detection by Inferring Latent Domain Representations"></p></a><div class="media-content size-small"><p><time dateTime="2020-02-27T12:02:18.000Z">2020-02-27</time></p><p class="title is-6"><a class="link-muted" href="/2020/02/27/Transfer-Anomaly-Detection-by-Inferring-Latent-Domain-Representations/">Transfer Anomaly Detection by Inferring Latent Domain Representations</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></p></div></article><article class="media"><a class="media-left" href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200113104953902.png" alt="Deep Anomaly Detection with Deviation Networks"></p></a><div class="media-content size-small"><p><time dateTime="2020-02-24T02:45:08.000Z">2020-02-24</time></p><p class="title is-6"><a class="link-muted" href="/2020/02/24/Deep-Anomaly-Detection-with-Deviation-Networks/">Deep Anomaly Detection with Deviation Networks</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></p></div></article><article class="media"><a class="media-left" href="/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200131113557592.png" alt="Geant4 å®‰è£…æ•™ç¨‹ä¸è°ƒè¯•ç¯å¢ƒé…ç½®"></p></a><div class="media-content size-small"><p><time dateTime="2020-01-31T03:25:59.000Z">2020-01-31</time></p><p class="title is-6"><a class="link-muted" href="/2020/01/31/Geant4-%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/">Geant4 å®‰è£…æ•™ç¨‹ä¸è°ƒè¯•ç¯å¢ƒé…ç½®</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Technical-Notes/">Technical Notes</a> / <a class="link-muted" href="/categories/Technical-Notes/Misc/">Misc</a></p></div></article><article class="media"><a class="media-left" href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/"><p class="image is-64x64"><img class="thumbnail" src="http://qfxiao.me/img/image-20200109102204802.png" alt="Complementary Set Variational Autoencoder for Supervised Anomaly Detection"></p></a><div class="media-content size-small"><p><time dateTime="2020-01-09T02:15:03.000Z">2020-01-09</time></p><p class="title is-6"><a class="link-muted" href="/2020/01/09/Complementary-Set-Variational-Autoencoder-for-Supervised-Anomaly-Detection/">Complementary Set Variational Autoencoder for Supervised Anomaly Detection</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Research/">Research</a> / <a class="link-muted" href="/categories/Research/Anomaly-Detection/">Anomaly Detection</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">å½’æ¡£</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">ä¸‰æœˆ 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">äºŒæœˆ 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">ä¸€æœˆ 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">åä¸€æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">åæœˆ 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">ä¹æœˆ 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">æ ‡ç­¾</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Anomaly-Detection/"><span class="tag">Anomaly Detection</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Deep-Learning/"><span class="tag">Deep Learning</span><span class="tag is-grey-lightest">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Flow-based-Model/"><span class="tag">Flow-based Model</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GAN/"><span class="tag">GAN</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RNN/"><span class="tag">RNN</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spectral/"><span class="tag">Spectral</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Statistics/"><span class="tag">Statistics</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Time-Series/"><span class="tag">Time Series</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Transfer-Learning/"><span class="tag">Transfer Learning</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VAE/"><span class="tag">VAE</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Variational-Inference/"><span class="tag">Variational Inference</span><span class="tag is-grey-lightest">2</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">è®¢é˜…æ›´æ–°</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="è®¢é˜…"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hanzawa ã® éƒ¨å±‹" height="28"></a><p class="size-small"><span>&copy; 2020 Hanzawa</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://qfxiao.me',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><script>window.addEventListener("load", function () {
            MathJax.Hub.Config({
                'HTML-CSS': {
                    matchFontHeight: false
                },
                SVG: {
                    matchFontHeight: false
                },
                CommonHTML: {
                    matchFontHeight: false
                },
                tex2jax: {
                    inlineMath: [
                        ['$','$'],
                        ['\\(','\\)']
                    ]
                }
            });
        });</script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>